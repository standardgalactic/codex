




Christian Ah-Soon, Jim Brogden, Dallas Marks, Gabriel Orthous, Heather Sinkwitz
SAP® BusinessObjects™ Web Intelligence®
The Comprehensive Guide
4th edition 2017










Imprint

            This e-book is a publication many contributed to, specifically:
         
Editor   Will JobstAcquisitions Editor   Hareem ShafiCover Design   Graham GearyPhoto Credit   Shutterstock.com/31334059/© SJ Travel Photo and VideoProduction E-Book   Marissa FritzTypesetting E-Book   Satz-Pro (Germany)
We hope that you liked this e-book. Please share your feedback with us and read the
            Service Pages to find out how to contact us.
         
The Library of Congress has cataloged the printed edition as follows:
            Names: Brogden, Jim, 1972- author.
            Title: SAP BusinessObjects Web intelligence : the comprehensive guide / Jim
            Brogden [and three others].
            Description: 4th edition. | Bonn ; Boston : Rheinwerk Publishing, [2017] |
            Includes index.
            Identifiers: LCCN 2017018371 | ISBN 9781493215478 (alk. paper)
            Subjects: LCSH: BusinessObjects. | Business intelligence--Data processing. |
            Management information systems.
            Classification: LCC HD38.7 .S265 2017 | DDC 658.4/038028553--dc23
            LC record available at https://lccn.loc.gov/2017018371
ISBN 978-1-4932-1547-8 (print)ISBN 978-1-4932-1548-5 (e-book)ISBN 978-1-4932-1549-2 (print and e-book)
© 2017 by Rheinwerk Publishing Inc., Boston (MA)4th edition 2017
         

















Dear Reader,
We're getting the band back together.
The esteemed Jim Brogden, Dallas Marks, Gabriel Orthous, and Heather Sinkwitz have
            returned to share their expertise in a fourth edition of the best-selling SAP BusinessObjects Web Intelligence, joined by inimitable new author Christian Ah-Soon. Together, this team has delivered
            a comprehensive guide to one of the industry's most powerful business intelligence
            reporting tools.
         
Whether you've just started working with Web Intelligence or you're an expert looking
            to refresh your skills, I am confident this book will deliver vital insights and help
            you  develop impressive reports.
         
What did you think about SAP BusinessObjects Web Intelligence? Your comments and suggestions are the most useful tools to help us make our books
            the best they can be.
         
Please feel free to contact me and share any praise or criticism you may have.
Thank you for purchasing a book from SAP PRESS!
 
Will JobstEditor, SAP PRESS
         
Rheinwerk PublishingBoston, MA
         
willj@rheinwerk-publishing.comwww.sap-press.com









Notes on Usage
This e-book is protected by copyright. By purchasing this e-book, you have agreed to accept and adhere to the copyrights.
            You are entitled to use this e-book for personal purposes. You may print and copy
            it, too, but also only for personal use. Sharing an electronic or printed copy with
            others, however, is not permitted, neither as a whole nor in parts. Of course, making
            them available on the Internet or in a company network is illegal as well.
         
For detailed and legally binding usage conditions, please refer to the section Legal Notes.
         
This e-book copy contains a digital watermark, a signature that indicates which person may use this copy:
         

 
Notes on the Screen Presentation
You are reading this e-book in a file format (EPUB or Mobi) that makes the book content
            adaptable to the display options of your reading device and to your personal needs.
            That's a great thing; but unfortunately not every device displays the content in the
            same way and the rendering of features such as pictures and tables or hyphenation
            can lead to difficulties. This e-book was optimized for the presentation on as many
            common reading devices as possible.
         
If you want to zoom in on a figure (especially in iBooks on the iPad), tap the respective
            figure once. By tapping once again, you return to the previous screen. You can find
            more recommendations on the customization of the screen layout on the Service Pages.
         









Table of Contents

Dear Reader
Notes on Usage
Table of Contents
1   Introduction to SAP BusinessObjects Web Intelligence
1.1   Features of Web Intelligence 4.2
1.1.1   Core Product Functionality
1.1.2   Reading Mode versus Design Mode
1.2   Web Intelligence Clients
1.2.1   Web Intelligence HTML
1.2.2   Web Intelligence Java Applet
1.2.3   Web Intelligence Rich Client
1.2.4   Web Intelligence Interactive Viewer
1.3   Web Intelligence Preferences
1.3.1   Setting the View and Modify Selection Types
1.3.2   Locale When Viewing a Document
1.3.3   Drill Option Preferences
1.3.4   Saving to Microsoft Excel Priority
1.3.5   Document Orientation Setting
1.4   What's New in Web Intelligence 4.2 SP 3 and SP 4
1.5   Summary
2   Creating New Documents and Queries
2.1   Creating a Web Intelligence Document from a Universe
2.2   The Query Panel in Web Intelligence
2.2.1   Creating the Query
2.2.2   Setting Query Properties
2.2.3   Previewing Data
2.2.4   Evaluating Generated SQL Script
2.2.5   Running the Query
2.3   Query Filters
2.3.1   Predefined Filters
2.3.2   Custom Filters
2.3.3   Quick Filters
2.3.4   Nested Conditions
2.4   Prompted Queries
2.4.1   Creating a Prompted Filter
2.4.2   Running the Query
2.4.3   Data Source Prompts
2.5   Saving Your Document in the BI Platform Repository
2.5.1   Save Document Dialog Box in Applet
2.5.2   Save Dialog Box in HTML
2.5.3   Using Refresh on Open Option
2.6   Other Data Sources
2.6.1   Excel as a Data Source
2.6.2   Free-Hand SQL as a Data Source
2.6.3   Text Files as a Data Source
2.6.4   Web Services as a Data Source
2.6.5   Analysis Views as a Data Source
2.7   Document Options
2.8   Summary
3   Creating a Report in Web Intelligence
3.1   Adding Data to Report Elements
3.1.1   Populating a Cross Table
3.1.2   Populating a Chart
3.2   Sections and Breaks
3.2.1   Setting a Section
3.2.2   Grouping Data with Breaks
3.2.3   Adding Custom Groups
3.3   Outline Navigation
3.3.1   Putting Outline into Action
3.3.2   Folding at Different Levels
3.4   Enhanced Sorting and Ranking
3.4.1   Sorting
3.4.2   Ranking
3.5   Conditional Formatting
3.6   Headers, Footers, and Background Images
3.7   Summary
4   The Web Intelligence Report Panel
4.1   The Web Intelligence Reporting Interface
4.2   Reporting Toolbars
4.2.1   Overview of the Function Tabs in Design Mode
4.2.2   Report Property Tab: File
4.2.3   Report Property Tab: Properties
4.2.4   Report Element Tab
4.2.5   Format (or Formatting) Tab
4.2.6   Data Access Tab
4.2.7   Analysis Tab
4.2.8   Page Setup Tab
4.3   The Side Panel
4.4   Report Panel
4.4.1   Working with Report Tabs
4.4.2   Formula Bar
4.4.3   Page Features
4.4.4   Status Bar
4.5   Report Property Categories
4.5.1   Report Elements
4.5.2   Relative Position and Object Alignment
4.5.3   Formatting
4.5.4   Data Access
4.5.5   Analysis
4.5.6   Page Setup and Layouts
4.6   Summary
5   Displaying Data with Tables
5.1   Using Tables
5.1.1   Adding Report Elements While Designing Reports
5.1.2   Manage Table Properties
5.1.3   Grouping
5.1.4   Freeze Header Rows and Columns
5.2   Table Types
5.2.1   Horizontal Table
5.2.2   Vertical Table
5.2.3   Cross Table
5.2.4   Form Table
5.3   Converting Table Formats and Types
5.4   Blank Cells, Predefined Cells, and Comment Cells
5.4.1   Blank Cells
5.4.2   Predefined Cells
5.4.3   Comment Cells
5.5   Summary
6   Displaying Data with Charts
6.1   Adding Charts to a Report
6.1.1   Converting Chart Types
6.1.2   Modifying an Existing Chart
6.2   Chart Types
6.2.1   Column Charts
6.2.2   Line Charts
6.2.3   Pie Charts
6.2.4   Bar Charts
6.2.5   Point Charts
6.2.6   Geographic Charts
6.2.7   Box Plots
6.2.8   Radar Charts
6.2.9   Map Charts
6.2.10   Tag Cloud
6.2.11   Waterfall
6.2.12   Gauge
6.2.13   Tile
6.3   Chart Properties
6.3.1   Customizing Charts
6.3.2   Useful Chart Properties
6.4   Zone Formatting
6.5   Custom Elements
6.5.1   Using a Custom Element
6.5.2   Custom Element Properties
6.6   Summary
7   Making an Impact with Charts
7.1   Properties That Enhance the Display of Data
7.1.1   Modifying Chart Properties
7.1.2   Global Configurable Options
7.1.3   Title Category Options
7.1.4   Legend Category Options
7.1.5   Category Axis Options
7.1.6   Value Axis Options
7.1.7   Plot Area Options
7.2   Hierarchical Charting with Relational Data
7.3   Reports Functioning as Dashboards
7.4   Formatting Tips
7.4.1   Measure Formatting
7.4.2   Region Color and Value Axis Stacking
7.5   Custom Color Enhancements
7.6   Summary
8   Report Properties, Tools, and Formatting
8.1   Formatting Report Properties
8.2   Document Summary
8.3   Navigation (Report) Map
8.4   Input Controls
8.4.1   Document Input Controls
8.4.2   Grouping Input Controls: Cascading Filters
8.5   Web Services Publisher
8.6   Available Objects (Design Mode Only)
8.7   Document Structures and Filters
8.8   Data
8.9   Style Sheet Modification
8.10   High Precision Numbers
8.11   Geolocalizing a Dimension
8.11.1   Geolocalize by Name
8.11.2   Geolocalize by Latitude and Longitude
8.12   Summary
9   Filtering Data in the Query Panel and Report Panel
9.1   Filtering in the Query Panel
9.1.1   Predefined Filters
9.1.2   User-Defined Filters
9.1.3   Filtering with Wild Cards
9.1.4   Nested Query Filters
9.1.5   Value(s) from List
9.1.6   Prompted Filters
9.2   Complex Filtering Options
9.2.1   Database Ranking
9.2.2   Subqueries
9.2.3   Dynamic Default Value for UNX Prompts
9.2.4   Filtering through BI Sets
9.3   Filtering in the Report Panel
9.3.1   Simple Filtering with the Filter Bar
9.3.2   Report Element Filters
9.3.3   Filtering with Input Controls
9.3.4   Input Control Groups
9.4   Conditionally Hiding Report Elements
9.5   Element Linking
9.5.1   Adding Element Linking
9.5.2   The Impact of Element Linking
9.6   Summary
10   Scope of Analysis and Drill Functionality
10.1   Setting the Scope of Analysis in the Query Panel
10.2   Drill-Down Setup in the Report Panel
10.3   Drilling on Tables
10.3.1   Drilling on Dimensions
10.3.2   Drilling on Measures
10.4   Drilling on Charts
10.4.1   Dimensions on Chart Axis
10.4.2   Dimensions on Legends
10.4.3   Measures on Chart Bars and Markers
10.5   Taking a Snapshot
10.6   Drill Options
10.6.1   Document Settings for Drill Functionality
10.6.2   User Settings for Drill Functionality
10.7   Summary
11   Using Formulas and Variables
11.1   Formulas and Variables
11.1.1   Converting In-Place Objects into Formulas
11.1.2   Exploring the Formula Editor
11.1.3   Creating Variables
11.2   Custom Grouping
11.3   Reporting Functions and Operators
11.3.1   Newest Functions
11.3.2   Aggregate Functions
11.3.3   Character Functions
11.3.4   Date and Time Functions
11.3.5   Document Functions
11.3.6   Data Provider Functions
11.3.7   Miscellaneous Functions
11.3.8   Logical Functions
11.3.9   Numeric Functions
11.3.10   Set Functions
11.3.11   Operators
11.4   Formula Syntax
11.4.1   Primary Formula Syntax Rules
11.4.2   If/Then/Else Syntax
11.4.3   Saving a Variable
11.4.4   Modifying a Variable
11.5   Input, Output, and Calculation Contexts
11.5.1   Aggregates in Context Formulas
11.5.2   Report Structure Operator and Keyword Combinations
11.5.3   Context Operators
11.6   References
11.6.1   Creating a Reference
11.6.2   Using a Reference
11.6.3   Reference Error Code
11.7   Summary
12   Advanced Query Panel Functionalities
12.1   Cascading and Optional Prompts
12.1.1   Defining a Cascading List of Values in the Universe Design Tool
12.1.2   Using a Cascading List of Values as a Prompted Filter
12.1.3   Refreshing a Report with a Prompted List of Values
12.1.4   Optional Prompts
12.2   Saving Prompts Answers in BI Variants
12.2.1   Creating a BI Variant
12.2.2   Using BI Variants
12.2.3   Managing BI Variants
12.3   Querying Multidimensional Data Sources
12.3.1   Multidimensional Metadata
12.3.2   Member Selector
12.3.3   Member Selector: Members Tab
12.3.4   Member Selector: Metadata Tab
12.3.5   Member Selector: Prompt Tab
12.3.6   Member Selector: Summary Pane
12.3.7   Displaying Hierarchies
12.4   Editing Auto-Generated SQL Scripts
12.5   Support of Query Stripping
12.6   Partial Results, Purged Data, and Cancelled Queries
12.6.1   Retrieving Partial Results
12.6.2   Purging Data
12.6.3   Cancelling a Query
12.7   Summary
13   Access to SAP BW and SAP HANA
13.1   SAP BW and SAP HANA Access Overview
13.1.1   SAP HANA and SAP BW
13.1.2   SAP HANA as a Platform
13.2   SAP BEx Query through Direct Access
13.2.1   Creating a Document in SAP BEx Direct Access
13.2.2   Answering SAP BEx Query Variables
13.3   SAP BEx Query through Multidimensional Universe
13.3.1   Multidimensional Universe
13.3.2   Creating a Document from Multidimensional Universes
13.3.3   Answering SAP BEx Query Variables
13.4   SAP BW through Relational Universe
13.4.1   Relational Universe in the Information Design Tool (UNX)
13.4.2   Relational Universe in the Universe Design Tool (UNV)
13.4.3   Creating a Document from a Relational Universe
13.5   SAP HANA Direct Access
13.5.1   Creating a Document in SAP HANA Direct Access
13.5.2   Answering SAP HANA Input Parameters and Variables
13.6   SAP HANA Online Mode
13.6.1   Creating a Document in Online Mode
13.6.2   Answering SAP HANA Variables and Input Parameters
13.6.3   Partial Result
13.6.4   Switching to SAP HANA Direct Access
13.7   SAP HANA View through Relational Universe
13.7.1   Relational Universe
13.7.2   Answering SAP HANA Variables
13.8   SAP HANA through Free-Hand SQL
13.9   Summary
14   Using Multiple Queries and Data Sources
14.1   Setting Up a Combined Query
14.1.1   Union
14.1.2   Intersection
14.1.3   Minus
14.1.4   Remove a Combined Query
14.2   Adding a New Query
14.2.1   Adding Queries and New Data Providers
14.2.2   Including New Result Data
14.2.3   Options to Display Available Objects
14.2.4   Adding New Data Source in SAP HANA Online Mode
14.3   Managing Queries
14.4   Running Multiple Queries
14.4.1   Refreshing Documents Containing Multiple Queries
14.4.2   Prompts
14.4.3   Multiple Queries Parallel Refresh
14.5   Merging Dimensions
14.5.1   Creating a Merged Dimension
14.5.2   Merging Geo-Localized Dimensions
14.5.3   Additional Options for Merged Dimensions
14.5.4   Modifying Merged Dimensions
14.6   Merging Variables
14.6.1   How to Merge Variables
14.6.2   Merging Geo-Localized Variable
14.7   Changing Source
14.7.1   Change Source Strategies
14.7.2   Change Source Workflow
14.7.3   Bulk Change Source
14.7.4   Change Source Excel, Text, and Free-Hand SQL
14.8   Summary
15   Adding Hyperlinks in Web Intelligence Documents
15.1   Linking to Document with the HTML Client
15.1.1   Adding a Hyperlink to a Web Intelligence Document
15.1.2   Setting Hyperlink Properties
15.1.3   Adding a Hyperlink to Prompted Documents
15.2   Linking to the Web Page URL
15.2.1   Adding Hyperlinks to Web Pages
15.2.2   Adding a Hyperlink to a Web Intelligence Document Using Its URL
15.2.3   Getting Document OpenDocument URL
15.2.4   Adding Hyperlinks to the SAP BusinessObjects Dashboard
15.3   OpenDocument Syntax
15.3.1   Document Identifier Parameters
15.3.2   Input Parameters
15.3.3   Output Parameters
15.4   Summary
16   Working in the BI Launch Pad
16.1   Navigating in BI Launch Pad
16.1.1   Header Panel
16.1.2   List Panel
16.1.3   Tabs
16.2   Setting BI Launch Pad Preferences
16.2.1   General Preferences
16.2.2   Locales and Time Zone Preferences
16.2.3   Changing Your Password
16.3   Organizing in Folders and Categories
16.3.1   Folders
16.3.2   Categories
16.3.3   Organizing Objects
16.4   Deleting Documents and the Recycle Bin
16.5   Viewing, Printing, and Saving Objects in BI Launch Pad
16.5.1   Web Intelligence Viewer Toolbar
16.5.2   Additional Menu Options
16.6   Summary
17   Using Web Intelligence with SAP BusinessObjects BI Workspaces
17.1   Introducing BI Workspaces
17.1.1   BI Workspaces Toolbar
17.1.2   BI Workspaces Module Library
17.1.3   Setting BI Workspaces Preferences in the BI Launch Pad
17.1.4   Setting Web Intelligence Preferences in the BI Launch Pad
17.2   Working with Modules
17.2.1   Text Modules
17.2.2   Compound Modules
17.3   Working with Web Intelligence Report Parts
17.4   Using a BI Workspace as the Default Home Tab
17.5   Printing BI Workspaces
17.6   Content Linking
17.7   Summary
18   Interaction from a User's Perspective
18.1   Creating Shortcuts and Hyperlinks
18.1.1   Shortcuts
18.1.2   Hyperlinks
18.2   Searching within the BI Launch Pad
18.2.1   Running the Search
18.2.2   Searchable Object Types
18.2.3   Search Techniques
18.3   Sorting and Filtering Content
18.4   Creating Discussions
18.4.1   Notes
18.4.2   Discussion Threads
18.5   Commenting Documents
18.5.1   Adding Comments
18.5.2   Managing Comments
18.5.3   Comments Function
18.6   Tracking Data Changes
18.6.1   Setting Reference Data
18.6.2   Formatting Changed Data
18.6.3   Displaying Tracked Data
18.6.4   Advanced Tracking Techniques
18.7   Summary
19   Sharing Web Intelligence Content
19.1   Sharing Document Content through Shared Elements
19.1.1   Creating Shared Elements
19.1.2   Using Shared Elements in Web Intelligence Documents
19.1.3   Identifying Document Shared Elements
19.1.4   Updating and Unlinking Shared Elements
19.1.5   Managing Shared Elements
19.2   Using the Send Feature in BI Launch Pad
19.2.1   BI Platform Inbox
19.2.2   Email
19.2.3   FTP Location
19.2.4   File Location
19.2.5   Using Placeholders
19.3   Exporting a Web Intelligence Report
19.3.1   Exporting Document Data or Query Data
19.3.2   Exporting in Web Intelligence Applet or Rich Client
19.3.3   Exporting in Web Intelligence HTML
19.4   Scheduling a Web Intelligence Report
19.4.1   Scheduling in BI Launch Pad
19.4.2   Viewing Latest Instance
19.4.3   Viewing History
19.5   Summary
20   Report Scheduling and Distribution with Publications
20.1   Publication Roles
20.1.1   The SAP BusinessObjects Administrator
20.1.2   The Web Intelligence Report Designer
20.1.3   The Publication Designer
20.1.4   The Publication Recipient
20.2   Creating a Publication
20.2.1   Naming the Publication
20.2.2   Choosing the Source Documents
20.2.3   Choosing Enterprise Recipients
20.2.4   Choosing Dynamic Recipients
20.2.5   Setting Publication Properties
20.2.6   Testing the Publication
20.3   Mobile Publications
20.4   Summary
21   Web Intelligence Rich Client
21.1   How Web Intelligence Rich Client Is Different
21.1.1   Working in Offline Mode
21.1.2   Working in Connected Mode
21.1.3   Working in Standalone Mode
21.2   Data Provider Options
21.2.1   Import a Universe from the Repository
21.2.2   Query Panel in Web Intelligence Rich Client
21.3   Working with Web Intelligence Reports
21.3.1   Opening Documents from the Repository
21.3.2   Saving Reports Locally
21.3.3   Exporting Reports to Repository
21.3.4   Printing from Web Intelligence Rich Client
21.3.5   Sending Reports as Email Attachments
21.4   Setting Preferences in Web Intelligence Rich Client
21.5   Summary
22   Web Intelligence Interactive Viewer
22.1   New BI Launch Pad and Web Intelligence Interactive Viewer Overview
22.2   Navigating in the New BI Launch Pad
22.2.1   BI Launch Pad Interface
22.2.2   Document Contextual Menu
22.3   Viewing a Document
22.3.1   Web Intelligence Interactive Viewer Interface
22.3.2   The Fading Toolbar
22.3.3   Navigating in a Document
22.3.4   Expanding and Collapsing Hierarchies
22.3.5   Comments
22.3.6   Listing Document Properties
22.4   Refreshing a Document
22.4.1   Prompts
22.4.2   BI Variants
22.5   Filtering a Report
22.5.1   Listing Prompts Values
22.5.2   Document and Report Input Controls
22.5.3   Drill Filters
22.5.4   Element Linking
22.6   Sorting or Ranking Data in a Report
22.7   Scheduling a Document
22.8   Saving and Exporting to XLS and to PDF
22.9   Setting Web Intelligence Preferences
22.10   Logging Out
22.11   Summary
23   Connecting SAP BusinessObjects Live Office to Web Intelligence and Universes
23.1   Introduction to SAP BusinessObjects Live Office
23.1.1   Integration with Web Intelligence Documents
23.1.2   Live Office Ribbon Menu
23.1.3   Accessing the Live Office Insert Wizard
23.2   Creating Queries from Universes
23.2.1   Selecting the Universe
23.2.2   Creating the Query
23.2.3   Running the Query
23.2.4   Displaying the Summary
23.3   Retrieving Web Intelligence Content
23.3.1   Selecting the Web Intelligence Document
23.3.2   Selecting Document Content
23.3.3   Displaying the Summary
23.4   Editing Added Content
23.5   Setting Preferences
23.5.1   Application Options
23.5.2   Data Refresh Options
23.5.3   Object Properties
23.6   Summary
24   Mobile Business Intelligence
24.1   Introducing SAP BusinessObjects Mobile
24.2   Designing Reports for Mobile Viewing
24.2.1   Mobile Categories
24.2.2   Mobile versus MobileDesigned
24.3   Mobile-Only Analytic Types
24.3.1   Query and Formula Design
24.3.2   Creating Sparklines
24.3.3   Creating Bullet Graphs
24.3.4   Creating Micro Bar Charts
24.3.5   Creating Scorecards
24.4   Report Linking
24.5   Input Controls
24.6   Mobile Thumbnails
24.7   Summary
A   Converting Desktop Intelligence Reports to Web Intelligence Documents
A.1   Planning Your Conversion to Web Intelligence
A.1.1   Analyze Existing Desktop Intelligence Document Usage
A.1.2   Identify Users with Desktop Intelligence Installed
A.1.3   Publish Locally Saved Desktop Intelligence Documents to the Repository
A.1.4   Prioritize, Consolidate, and Eliminate
A.1.5   Customize the Conversion Plan and Roadmap
A.1.6   Perform Document Conversion
A.1.7   Execute Post-Conversion Analysis and Validation
A.1.8   Manually Create Unconverted Documents
A.1.9   Educate Users on Web Intelligence
A.2   Running the Report Conversion Tool
A.2.1   Report Conversion Tool Workflow
A.2.2   Freehand SQL Conversion
A.3   Desktop Intelligence Compatibility Pack
A.4   Summary
B   Web Intelligence Security Rights
B.1   SAP BusinessObjects BI Platform Security Model
B.2   Web Intelligence Application Rights
B.2.1   Data: Enable Data Tracking
B.2.2   Data: Enable Formatting of Changed Data
B.2.3   Desktop Interface: Enable Local Data Providers
B.2.4   Desktop Interface: Enable Web Intelligence Desktop
B.2.5   Desktop Interface: Export Documents
B.2.6   Desktop Interface: Import Documents
B.2.7   Desktop Interface: Install from BI Launch Pad
B.2.8   Desktop Interface: Print Documents
B.2.9   Desktop Interface: Remove Document Security
B.2.10   Desktop Interface: Save Document for All Users
B.2.11   Desktop Interface: Save Documents Locally
B.2.12   Desktop Interface: Send by Mail
B.2.13   Disable Export to BI On Demand for this User
B.2.14   Disable Import from BI On Demand for this User
B.2.15   Documents: Disable Automatic Refresh on Open
B.2.16   Documents: Enable Auto-Save
B.2.17   Documents: Enable Creation
B.2.18   General: Edit My Preferences
B.2.19   General: Enable Right-Click Menus
B.2.20   Interfaces: Enable Rich Internet Application
B.2.21   Interfaces: Enable Web Viewing Interface
B.2.22   Left Pane: Enable Document Structure and Filters
B.2.23   Left Pane: Enable Document Summary
B.2.24   Query Script: Enable Editing (SQL, MDX, ...)
B.2.25   Query Script: Enable Viewing (SQL , MDX, ...)
B.2.26   Reporting: Create and Edit Breaks
B.2.27   Reporting: Create and Edit Conditional Formatting Rules
B.2.28   Reporting: Create and Edit Input Controls
B.2.29   Reporting: Create and Edit Predefined Calculations
B.2.30   Reporting: Create and Edit Report Filters and Consume Input Controls
B.2.31   Reporting: Create and Edit Sorts
B.2.32   Reporting: Create Formulas and Variables
B.2.33   Reporting: Enable Formatting
B.2.34   Reporting: Enable Merged Dimensions
B.2.35   Reporting: Insert and Remove Reports, Tables, Charts, and Cells
B.2.36   Sharing: Publish Shared Elements
B.2.37   Sharing: Insert Shared Elements
B.3   Web Intelligence Document Rights
B.3.1   Edit Query
B.3.2   Export the Report's Data
B.3.3   Publish Shared Elements
B.3.4   Refresh List of Values
B.3.5   Refresh the Report's Data
B.3.6   Save as CSV
B.3.7   Save as Excel or Text
B.3.8   Save as PDF
B.3.9   Use Lists of Values
B.3.10   View SQL
B.4   Mandatory Rights for Common Workflows
B.4.1   Viewing a Web Intelligence Document
B.4.2   Creating a Web Intelligence Document
B.4.3   Saving a Web Intelligence Document
B.4.4   Refreshing a Web Intelligence Document
B.4.5   Editing a Web Intelligence Document
B.4.6   Scheduling a Document
B.5   Security Reports
C   The Authors
Index
Service Pages
Legal Notes









1    Introduction to SAP BusinessObjects Web IntelligenceThe SAP BusinessObjects Business Intelligence 4.2 delivers the most complete BI platform yet, with several important improvements frequently requested by business users. Building on the progress achieved in the 4.0 and 4.1 releases, Web Intelligence in SAP BusinessObjects BI 4.2 continues to strengthen an already powerful enterprise reporting platform with key enhancements that will take your reports to an all new level.The industry's most powerful business intelligence ad hoc query and analysis reporting tool is now stronger than ever with the release of SAP BusinessObjects BI 4.2. On the surface, the interface may seem exactly the same as in versions 4.0 and 4.1. But take a closer look and you'll find even more functionality to help you get the most out of your SAP HANA investments, perform better geographic analysis with new map components, and provide an even more intuitive tool to business users to drill into business data in reporting documents. SAP BusinessObjects Web Intelligence 4.2 (which we refer to as Web Intelligence) comes with a new collection of geocharts for natively creating maps in reporting documents. Combining this important new visual capability with the growing number of chart styles truly gives users more capabilities than ever before and further blurs the lines among reports, data stories, and dashboards.Web Intelligence delivers an ideal self-service reporting experience with the capability to connect directly to live data in an SAP HANA view with SAP HANA Online, utilize the SAP Business Explorer (SAP BEx) queries, access analysis views generated from SAP BusinessObjects Analysis workspaces for multidimensional reports, or access traditional relational databases through SAP BusinessObjects universes. Connecting directly to SAP's revolutionary high-performance analytical appliance, SAP HANA, with Web Intelligence allows you to bypass the need for a universe to connect to SAP HANA before creating reports. In version 4.2, perhaps the most requested data source since Desktop Intelligence was retired—behold Freehand SQL. Users can now leverage the countless reporting features of Web Intelligence to create highly formatted reports by writing their own SQL scripts rather than using a traditional universe.Web Intelligence provides business users with the tools to make better decisions and offer deeper insight into company data. The major benefits include the ability to drill, pivot, chart, track changes, publish, schedule, and share business information online and within a single online portal. The combination of an enhanced Report Panel, seamless connectivity to an extensive list of data sources, and the capability to contain vast amounts of data makes Web Intelligence the premier tool of choice for analyzing data.This chapter introduces you to the key features and core functionality of the Web Intelligence reporting tool.
1.1    Features of Web Intelligence 4.2
Web Intelligence has been known for many years by report developers as "WebI" (pronounced "webby"). It's best known as a highly intuitive, web-based query and analysis tool that provides business users with the capability to create and modify queries without having to write a single line of SQL. But if writing SQL is your thing, Web Intelligence is your tool.
Because Web Intelligence reduces the complexity of report building, business users have unprecedented opportunities to analyze and leverage company information. Self-service business intelligence has become a reality in Web Intelligence 4.2, which boasts an enhanced Report Panel designed for more intuitive report development and data interaction. Reporting documents are published and shared through the BI Launch Pad portal, a convenient and efficient way of distributing reports to users across the enterprise.
This means that report viewers of every skill level can easily leverage Web Intelligence to analyze and interact with data to solve business problems. In the coming chapters, we discuss in great detail all of the features this tool provides.
In the following sections, we discuss the core product functionality of Web Intelligence, including its six primary functions (query, report, analyze, share, customize, and integrate).
1.1.1    Core Product Functionality
The primary function of Web Intelligence is two-fold: to provide the capability to query a set of data without any knowledge of the SQL language, and to interactively analyze data to further restrict, expand, and modify the way information is displayed and delivered. After data is retrieved, formatting can be easily applied to present results in a variety of customized formats.
The data retrieved with Web Intelligence is displayed in the report section by using components known in the tool as Report Elements. The Report Element component templates included are:


                    Tables: The most common methods of displaying data are with vertical and cross tables, also known as pivots.
                

                    Cell: Blank cells commonly used for titles and pre-defined calculations, such as last refresh date and page numbers.
                

                    Charts: 34 different chart types include three geographic charts introduced to Web Intelligence in SAP BusinessObjects BI 4.2.
                

After refreshing a report query's results, you can easily visualize the data by inserting report elements and result objects into your reports.
You can quickly organize reports by inserting breaks or sections to group the data displayed in a table. You'll also be able to restrict each block of data to a customized result set by applying block-level or report-level filters with just a few clicks of the mouse. An extensive set of shortcut icons are provided in the ribbon toolbar to assist with frequently used customizations. These icons are located at the top of the screen in the Web Intelligence design mode and are grouped into three toolbars.
When you're ready to share your work, you can easily publish your documents to the BI Launch Pad. Users across the enterprise will then have the opportunity to view and interact with your reports by logging on to the BI Launch Pad through a web browser without any installation requirements.
Extended interaction is available to users by right-clicking on a report or report element for on-the-fly modification and customization in design mode.
Let's consider the primary functions of Web Intelligence:


QueryBuilding queries in Web Intelligence is easier than in previous versions of this software. Through its intuitive and common interface, you can easily query any data source as follows, without knowledge of its underlying data structures or technical language (SQL, MDX):
                    

                            Query relational, multidimensional or linked universes created with Universe Design Tool or Information Design Tool.
                        

                            Use web services, text files, and Microsoft Excel spreadsheets as data sources.
                        

                            Get easy, direct access to InfoCubes through SAP BEx queries.
                        

                            Connect directly to an SAP HANA view or live data with SAP HANA online mode.
                        

                            Select a relational connection as a data source and write your own query by using the free-hand SQL option when creating a new Web Intelligence document.
                        

                    Although it is simple to use, you can create complex statements (combined queries, prompted queries, subqueries, ranking, etc.). Furthermore, you can use parallel query processing for faster refresh times in documents with multiple queries.
                

ReportOver the course of this book, you'll learn to create everything from simple reports to complex analysis documents with multiple report tabs. You can unlock the full potential of Web Intelligence 4.2 by using the built-in editing and formatting features available for presenting data quickly and accurately. Reporting with Web Intelligence is also very flexible and intuitive. Never again will your reporting solution cause the bottleneck in your BI solution. Add maps to reports for a geographical view of your data and create highly formatted views of data from practically any data source. Reporting features include the following:
                    

                            Powerful charting engine for creating highly customized visual reports.
                        

                            Geographical charting components for displaying data with maps.
                        

                            Enhanced reporting styles.
                        

                            Add hyperlinks and element links to report objects.
                        

                            Add references to specific cells.
                        

                            Export your data to different file formats (PDF, XLS, TXT, CSV).
                        



AnalyzeWeb Intelligence 4.2 enables you to provide deep analysis, deliver valuable analytical reports to the user community, and become a more insightful analyst and subject matter expert (SME) with your clients' data. You can perform detailed, specific analyses with an extensive set of options, as follows:
                    

                            Learn how to use drill filters, report filters, and block filters to filter your report.
                        

                            Set up input controls and input control groups for more intuitive on-the-fly analysis.
                        

                            Discover the extensive list of out-of-the-box report functions and contexts available for creating precise variables and formulas.
                        

                            When multiple queries are included in a single document, you can merge dimensions or variables from multiple data sources to synchronize them.
                        

                            Analyze hierarchical datasets sourced from multidimensional data sources (SAP BEx queries, SAP HANA, multidimensional universes, etc.).
                        



ShareFor collaborative analysis, Web Intelligence can leverage several capabilities proposed by the BI platform:
                    

                            Save your Web Intelligence documents to the BI Launch Pad portal. You can organize them within the default folder structure, within a folder-like structure known as categories, or through BI workspaces (previously known as the Dashboard Builder).
                        

                            Schedule a document refresh and distribute your documents to different destinations like BI platform user inboxes, external emails, file systems, or FTP.
                        

                            They can also be broadcasted and personalized to many recipients (either internal or external to the BI platform) through publications.
                        

                            Discuss documents with others users by leaving comments.
                        

                    Web Intelligence also supports the ability to share report parts with other users through shared elements.
                

CustomizeHave you ever wanted to create professional Web Intelligence report dashboards that are customized to fit the color and style of your client? With SAP BusinessObjects BI 4.2, this can be achieved easier and more proficiently than ever before. Build fresh, innovative, interactive, and data-rich documents that meet any organization's style requirements while also delivering powerful BI.
                    Web Intelligence offers flexibility to developers, partners, and OEM through a full software development kit, which includes the following services:
                    

                            Web Intelligence REST Web Services, to programmatically perform any workflow.
                        

                            Web Intelligence extension, to extend Web Intelligence user interface.
                        

                            Web Intelligence custom elements (see Chapter 6, Section 6.5, for more information).
                        

                            Web Intelligence custom formulae, to add your own calculation in Web Intelligence formula language.
                        

                    This complete toolkit is used by the development community to customize, administer, and automate any Web Intelligence workflows.
                

IntegrateWeb Intelligence integrates with the whole SAP landscape. As the most used analytical product of the BI platform, it is supported by tools such as the SAP BusinessObjects BI Launch Pad, Promotion Management, Upgrade Management Tool, and the Translation Management Tool.
                    From data sources point of view, it can query a variety of SAP data sources such as SAP BW, SAP HANA views, SAP BusinessObjects Analysis for online analytical processing queries, and universes created with Information Design Tool or Universe Design Tool.
                    Finally, you can leverage Web Intelligence content from SAP Live Office (see Chapter 23), SAP Mobile (see Chapter 24), SAP Business Objects BI Launch Pad workspaces or generate web services for use as consumable data sources by other SAP products, such as SAP BusinessObjects Dashboards. There are also other methods to share your Web Intelligence documents.
                

These areas describe the capabilities of Web Intelligence and are the focus of this book. Throughout the next chapters, we discuss every aspect of building and editing reports.
1.1.2    Reading Mode versus Design Mode
How you will use the Web Intelligence capabilities will depend on your profile. Web Intelligence has the following two main modes that corresponds to the two main workflows:


                    The Design mode is intended for power users who can create, edit, and manage documents. The Design mode gives you access to the full Web Intelligence core product functionalities described in previous section, as follows:
                    

                            Creating and editing queries
                        

                            Creating the document and the reports
                        

                            Formatting your dataset into tables, charts and setting their properties
                        

                            Creating input controls, filters, element linking
                        

                            Creating formulas, variables and references for advanced analysis
                        

                            Sharing report elements as shared elements
                        



                    As shown in Figure 1.1, the Design mode offers an exhaustive interface that gives you access to the full Web Intelligence capabilities.
                


Figure 1.1    Example Web Intelligence Report in Design Mode


                    The Reading mode is used for accessing and refreshing documents and content created by power users and report designers. Most report consumers will only need to read or view reports; however, in order to make better informed decisions as business users, you can refresh the data to get up to date datasets and document comments. While reading reports, users will have the opportunity to drill, filter, and export results to PDF, Excel, text or CSV files.
                    The Reading mode proposes a simplified interface that contains only the capabilities available in this mode. Figure 1.2 shows a custom-formatted Web Intelligence report with element link filters and a comment added to a bar chart in the BI Launch Pad.
                

The BI Launch Pad is the centralized web portal designed to provide access to all your BI content securely and within a single platform. Both Design and Reading modes are available in BI Launch Pad, which lets you view, refresh, create, modify, save, share, and analyze valuable company data from a single location within browser.

Figure 1.2    Example Web Intelligence Report in Reading Mode
Through security rights (see Appendix B), your administrator defines the actions you can access in Web Intelligence when you connect to the SAP BusinessObjects BI platform. This includes the Design or Reading mode, and also your access to the Web Intelligence clients, described in the following section.









1.2    Web Intelligence Clients
Web Intelligence encompasses the different Web Intelligence clients and the various deployment modes. Web Intelligence allows you to conveniently create and modify reports through an Internet browser or by working locally with Web Intelligence Rich Client with standalone and disconnected capabilities.
You don't have to install SAP BusinessObjects BI 4.2 software to experience the benefits of Web Intelligence. With just a web browser, you can log on to the BI Launch Pad to view, create, edit, analyze, schedule, or interact with Web Intelligence reporting documents. All of the functions, tools, and data delivery elements are at your fingertips with just a few clicks and the proper credentials to access the SAP BusinessObjects BI platform.
In SAP BusinessObjects BI 4.2 SP 4, Web Intelligence comes in four different clients:


                Web Intelligence HTML
            

                Web Intelligence Java Applet
            

                Web Intelligence Rich Client
            

                Web Intelligence Interactive Viewer
            

As described in the following section, they can be used in both reading and design mode (Section 1.1.2), except the Web Intelligence Interactive Viewer, since it does not support authoring workflows.
1.2.1    Web Intelligence HTML
The architecture of SAP BusinessObjects BI 4.2 lets Web Intelligence reports operate purely in a web browser. This delivery style significantly reduces deployment costs, making it easier for companies of all sizes to use the SAP BusinessObjects reporting suite. Web Intelligence plays an important role in extending analysis across the enterprise and to a large audience of casual users, power users, and executives.
It wasn't long ago that the Web Intelligence HTML version had minimal functionality in web browser access, and the Java Applet was the viewer of choice by nearly every type of user. However, because the HTML viewer doesn't rely on a third-party plug-in, and doesn't require any downloads, many users find it easier to maintain and faster at delivering reports than the Java Applet. With the decline of Java, the HTML client has become more and more popular. In SAP BusinessObjects BI 4.2 SP 3 and SP 4, the HTML client has been greatly improved to achieve functional parity with the Java Applet, both for Reading and Design mode.
Even if the HTML is almost at parity with the Java Applet, some features are still not yet available in the HTML, the most important being the Data Manager and the right-to-left display interface. In addition, some features are still exclusive to the Web Intelligence Rich Client, like the query creation from Web Services.
From a user interface point of view, both viewers have the same look and feel and are practically equal. Except in some rare cases, you can easily switch from one to the other without seeing the difference. In this book, screenshots are mainly taken from Java Applet version, but they could have been taken from the HTML one without any difference.
1.2.2    Web Intelligence Java Applet
The Java Applet viewer, previously known as the Rich Internet Application (RIA), requires the installation of the Java Runtime Environment plug-in. You can access it from the BI Launch Pad.
It maintains a functional advantage over the HTML viewer, but by the slimmest of margins. Originally touted as the viewer of choice for advanced report designers, its fraternal twin, the HTML viewer, has almost the same functional coverage and an almost indiscernible appearance.
Historically, the Java Applet had much more features than the HTML. But over the time, it has become more and more difficult to maintain due to the following reasons:


                    Java is no longer supported by some browsers.
                

                    It's recommended to have your Java run time up to date with latest version and latest security patches.
                

                    Starting the Java Applet takes longer since the Java Applet must be fully downloaded first.
                

The Java Applet can only be accessed from the BI Launch Pad. To work around this limitation, you can use the Web Intelligence Rich Client, which shares the same component as the Java Applet, but proposes additional features and deployment modes.
1.2.3    Web Intelligence Rich Client
Since the addition of the Web Intelligence Rich Client, analysis has been extended to power users who need to analyze data when disconnected from the Centralized Management Server (CMS) or SAP Enterprise Portal. When you are connected to the CMS, you can export or publish documents directly to the enterprise system for online analysis. Once published, reports created in Web Intelligence Rich Client are easily shared with other enterprise users through standard group security permissions.
The Web Intelligence Rich Client is the full client version of Web Intelligence. It is installed on your Windows desktop machine and you do not need to open a browser to work with it.
This portable version of Web Intelligence provides report developers with the capability to disconnect from the CMS and work outside the BI Launch Pad. Web Intelligence Rich Client also lets you use a local data sources; for example, you can import an Excel spreadsheet as a local data source to create Web Intelligence documents.
Working in offline mode allows report developers to disconnect from the CMS and work locally with saved Web Intelligence documents rather than through a browser. This functionality facilitates the frequently requested task of saving and editing Web Intelligence documents outside of the BI Launch Pad portal.
Some users prefer the Web Intelligence Rich Client for the following reasons:


                    It's based on the Java Applet version, but has additional features in comparison.
                

                    Users prefer to start it directly from their Windows Start menu, rather than from a browser, especially for offline and standalone modes.
                

The Web Intelligence Rich Client can work in different modes, as follows:


                    Connected: The connected mode is the nominal use-case where you connect to your corporate SAP BusinessObjects BI platform repository and work on the documents in the public folders or your folders. You must have a connection to a network and authenticate to the SAP Business Objects BI platform repository before accessing your documents.
                

                    Offline: In this mode, if you have once connected to a BI platform repository and retrieved locally some documents, you can work on them without access to the SAP BusinessObjects BI platform repository. The documents and security are maintained in a local cache where you authenticate before accessing to the documents. This mode is helpful when you are travelling and you temporarily have no access to a network.
                

                    Standalone: In this mode, you work only on your local file system. You do not need to be connected to an SAP BusinessObjects BI platform repository and you can only work on local, non-secured documents.
                

The Web Intelligence Rich Client specificities are described in Chapter 21.
1.2.4    Web Intelligence Interactive Viewer
With the new increase of mobile and simplified interfaces, the Web Intelligence HTML, Java applet and Rich Client interfaces are sometimes considered to be too powerful and difficult to comprehend.
A first step towards modernizing Web Intelligence user interface has been made in SAP BusinessObjects BI 4.2 SP 4, which contains a new simplified interface based on HTML5. In SAP BusinessObjects BI 4.2 SP 4, this new Interactive Viewer proposes only viewer workflows; it does not allow document authoring. Its main objective is to reach viewer population with viewing capabilities, but it also has some additional interaction capabilities that are not available in the other viewers.
This user interface rejuvenation comes with a new BI Launch Pad that follows the same simplification and rejuvenation principles and objectives.
The new Web Intelligence Interactive Viewer is fully described in Chapter 22. As described in this chapter, you can access the Web Intelligence Interactive Viewer through a different URL, whereas the choice of Web Intelligence clients in BI Launch Pad is done in Web Intelligence preferences.









1.3    Web Intelligence Preferences
A number of configurable settings are available to enhance the user experience when reading and interacting with Web Intelligence reports in the BI Launch Pad.
To adjust settings for reading and designing reporting documents, begin by clicking on the Preferences link located in the upper-right corner of the BI Launch Pad (see Figure 1.3).

Figure 1.3    Preferences Link in the BI Launch Pad
Depending on your security permissions, the Preferences page allows you to modify several general settings and the default settings for viewing/reading and modifying/designing reporting documents.
Figure 1.4 shows the Web Intelligence preferences that you can adjust locally in a web browser. In addition to these Web Intelligence preferences, you can adjust the following seven other preference groups with settings in the BI Launch Pad:


General


Change Enterprise Password


Locales and Time Zone


Analysis edition for OLAP


Web Intelligence


BI workspaces


Crystal Reports



Figure 1.4    Web Intelligence Preferences
Web Intelligence settings consist of the following:


View


Modify


Select a default universe (optional)
            

When viewing a document


Drill options


Start drill session


Select a priority for saving to MS Excel


Let's explore these settings further.
1.3.1    Setting the View and Modify Selection Types
Depending on whether you're a casual user who needs only to read and print reports or a report designer who requires access to the Query Panel, the selections made to view and modify reports play an important role in the features that will be available to you.
Let's examine the selection types available for both View and Modify:


HTML (no download required)The HTML setting provides a fully functional HTML panel that allows users to read and design reporting documents with all of the features in the Report Panel. The biggest advantage of using the web setting to read and design documents is the ability to link to a document. This feature is covered in detail in Chapter 15. Extensive improvements have been made with this viewer, and it now contains most of the functionality in the Java Applet viewer.
                

Applet (download required)The Applet setting is the selection used for creating queries with Web Intelligence in the BI Launch Pad and advanced interactive reports by using the Java plug-in. This setting was once used almost exclusively by power users and advanced report consumers, but now in SAP BusinessObjects BI 4.2, the HTML viewer has become the preferred viewer type by many report developers.
                    The disadvantage of this setting is that linking to another document isn't available, and the full OpenDocument syntax is required to link to another published report, document, or dashboard.
                

Desktop (Rich Client, Windows only, installation required)This selection is used to automatically launch Web Intelligence Rich Client when reports are viewed or modified.
                

PDFThe PDF option is unique to the View preference list and has very little interactive functionality. The primary feature of this viewing format is to open the Web Intelligence report in a PDF for easy distribution. After the document opens, you can print or save the PDF report. PDF reports can be easily shared with users across the enterprise, emailed, posted to an FTP site, or published to the SAP BusinessObjects BI 4.2 platform.
                

There is one setting that is unique to the Modify list and that's the ability to browse for a default universe. This feature is available so a specific universe can be assigned as the default universe when new reports are created.
The next set of properties describes how to set the viewing locale and time zone for reports and the BI Launch Pad. This feature is an important descriptive value, showing accurate times for when reports were last saved and refreshed.
1.3.2    Locale When Viewing a Document
Web Intelligence consider the following several locale-specific properties:


Product LocaleThis locale defines how the user interface (menu, buttons, etc.) must be displayed. By default, it uses the browser's locale, but you can set it to another language during installation.
                

Preferred Viewing LocaleThis locale defines how business intelligence content must be displayed. This covers translated universes and documents, multilingual datasources, and more. The default setting uses the locale of your browser, but you can select one of the 130 supported locales.
                

Current Time ZoneThe default setting uses the time zone of the web server used by SAP BusinessObjects Enterprise, but you can set another one.
                

Locale Used to Format the dataThis locale defines how numeric data (date, time, etc.) are formatted. You can select the document locale or the preferred viewing locale.
                

Product locale, preferred viewing locale, and current time zone can be set in Locales and Time Zone preferences section, which is shown in Figure 1.5.

Figure 1.5    Locales and Time Zone Preferences
The locale used to format the data can be defined in Web Intelligence preferences section, as shown in Figure 1.2.
1.3.3    Drill Option Preferences
In addition to providing drill filters in drill mode, many data tables and charts let you drill down with a single click. This type of drilling is available when drill mode is activated, and the dimension objects have been added to a hierarchy in the universe.
As shown in Figure 1.6, three settings are available for selection under Drill options when setting Web Intelligence preferences:


Prompt when drill requires additional data


Synchronize drill on report blocks


Hide Drill toolbar on startup

Figure 1.6    Drill Options Settings and Drill Session Start Type


Any combination of these settings can be selected. We recommend that you select Prompt when drill requires additional data and Synchronize drill on report blocks. You can also show or hide the drill toolbar when opening a report.
You also have the choice of defining where a drill session starts: On duplicate report or On existing report. The default selection is On existing report.
1.3.4    Saving to Microsoft Excel Priority
The next setting in Web Intelligence preferences is to assign the priority for saving reports to Excel: either the formatting of the documents or easy data processing in Excel (the default setting).

Note
Be sure to click the Save button or the Save and Close button in the lower-right corner of the Preferences window to complete your changes. Refresh your browser to ensure that all preference changes are enabled and integrated into your session.

1.3.5    Document Orientation Setting
The default document orientation setting is to display data to read from left to right. But now in SAP BusinessObjects BI 4.2, you have the option to change the orientation from right to left. Universally this is handled in the administrator settings but it can also be applied here in the Web Intelligence user preferences.
Adjusting the Web Intelligence preferences based on your needs ensures that you optimize the features for viewing, modifying, and creating reports. Let's explore the reporting and analysis environments next.









1.4    What's New in Web Intelligence 4.2 SP 3 and SP 4
Many of the new features introduced to Web Intelligence in version 4.2 have already been described and will be covered in much deeper detail in the coming chapters.
This book is based on the Web Intelligence released in May 2017 with version SAP BusinessObjects BI 4.2 SP 4. Still, it remains valid if you have previous versions. To whet your appetite of what's in store for you with SAP BusinessObjects BI 4.2, Table 1.1 provides a listing of the new enhancements and features, sorted by their version release.




                        Version
                    

                        New Web Intelligence Features
                    





                        SAP BusinessObjects BI 4.2
                    



                                Geo map (see Chapter 6, Section 6.2.6 and Chapter 8, Section 8.11)
                            

                                Custom elements (see Chapter 6, Section 6.5)
                            

                                High precision decimal (Chapter 8, Section 8.6)
                            

                                Direct access to SAP HANA views (see Chapter 13, Section 13.5)
                            

                                Online mode for SAP HANA views (see Chapter 13, Section 13.6)
                            

                                Support of multidimensional universe created on SAP BEx query (see Chapter 13, Section 13.3)
                            

                                Parallel queries (see Chapter 14, Section 14.4)
                            

                                Document comment (see Chapter 18, Section 18.5)
                            

                                Shared elements (see Chapter 19, Section 19.1)
                            





                        SAP BusinessObjects BI 4.2 SP 3
                    



                                HTML/Java parity: Excel, SAP BEx data sources, complex filters in Query Panel, conditional formatting, format number, Change source, Export As
                            

                                Geo map based on latitudes and longitudes (see Chapter 8, Section 8.11)
                            

                                Display objects per data sources (see Chapter 8, Section 8.6)
                            

                                Input control group (see Chapter 9, Section 9.3.4)
                            

                                Support of set for query filters (see Chapter 9, Section 9.2.4)
                            

                                New function: MemberAtDepth (see Chapter 11, Section 11.3.1)
                            

                                References as variable types (see Chapter 11, Section 11.6)
                            

                                Set variables dialog box for SAP HANA direct access (See Chapter 13, Section 13.5)
                            

                                Parallel queries for SAP BW (see Chapter 14, Section 14.4)
                            

                                Merged variables (see Chapter 14, Section 14.6)
                            

                                New data sources supported in change source (see Chapter 14, Section 14.7)
                            

                                Cell and block comments (see Chapter 18, Section 18.5)
                            

                                Shared elements enhancements (see Chapter 19, Section 19.1)
                            

                                New publication delivery rules (see Chapter 20, Section 20.2.5)
                            

                                Image resolution option when exporting to PDF or Excel (see Chapter 19, Section 19.3)
                            





                        SAP BusinessObjects BI 4.2 SP 4
                    



                                HTML/Java parity: Free-hand and right to left content display
                            

                                New charts: gauges, speedometers and tiles (see Chapter 6, Section 6.2)
                            

                                New charts attributes (see Chapter 6)
                            

                                Exclude prompts from BI variants (see Chapter 12, Section 12.2)
                            

                                Variable, reference and group description (see Chapter 11)
                            

                                New functions: DatesBetween, TimeBetween (see Chapter 11, Section 11.3.1)
                            

                                New arguments for function PromptSummary (see Chapter 11, Section 11.3.1)
                            

                                Flatten SAP BW hierarchy (see Chapter 13, Section 13.2)
                            

                                Navigation paths for drilling through SAP HANA Online mode (see Chapter 13, Section 13.6)
                            

                                New Change Source utility (see Chapter 14, Section 14.7)
                            

                                Web Intelligence Interactive Viewer (see Chapter 22)
                            

                                Free-hand SQL security right (see Appendix B, Section B.1)
                            

                                New BI repository reporting samples (see Appendix B, Section B.5)
                            





Table 1.1    Features Released in SAP BusinessObjects BI 4.2

SAP BusinessObjects BI 4.2 SP 2
The public version of SAP BusinessObjects BI 4.2 is the same as SAP BusinessObjects BI 4.2 SP 2. SAP BusinessObjects BI 4.2 was the beta version, and the SAP BusinessObjects BI 4.2 SP 1 was the ramp-up version. For convenience, we'll simply use SAP BusinessObjects BI 4.2 in this book to name this first public version of SAP BusinessObjects BI 4.2.










1.5    Summary
Web Intelligence provides an extensive set of mature features that combine complex query building with detailed analytical reporting capabilities. This best-in-class reporting tool introduced in 1997 has evolved to become the standard ad hoc analysis and reporting tool for many businesses around the world. With version 4.2, you can easily source reports from SAP BEx queries, directly from SAP HANA views, Free-hand SQL, patented semantic layer universes, and many others.
The core functionality of Web Intelligence contains an extensive list of valuable data analysis features. Report building becomes much easier for business users because they can develop complex queries visually without knowledge of the underlying SQL. The ability to query multiple data sources in the same document and link the results by merging dimensions is an extremely valuable analytical report development feature. The addition of parallel processing and ability to merge dimensions to variables extends the tool to new heights.
Web Intelligence reports can be easily viewed and analyzed by using only a web browser connected to the BI Launch Pad. Reporting documents can be shared with selected users across the enterprise and then scheduled to be refreshed and delivered to a user inbox or external email address.
You can take analysis offline with Web Intelligence Rich Client. Report developers can save Web Intelligence documents locally and analyze data without being connected to the BI platform repository. The next chapter describes how to create your first document and query in SAP BusinessObjects BI 4.2 SP 4.








2    Creating New Documents and QueriesCreate queries graphically with the highly intuitive and enhanced Query Panel in Web Intelligence. Use the Result Objects pane and Query Filters pane to access the data you need from universes, Excel or text files, free-hand SQL, analysis views or web services, and then create and share powerful analysis documents with business users.This chapter takes you through the first steps of creating a Web Intelligence document from within the BI Launch Pad portal. It describes a simple workflow starting from a relational universe and describes how to create a query from it through the Query Panel, and filter the retrieved dataset with filters and prompts.All these steps are easily done through Web Intelligence Query Panel which provides business users with an intuitive interface for retrieving and filtering data. Queries are created graphically by selecting objects (database fields) to query or to filter. This collection of objects is translated a generated SQL statement sent to the database.Specific versions of this Query Panel are also available for other data sources: Excel and text files, Free-Hand SQL, web service and analysis views. Query Panel's advanced capabilities, like accessing SAP data sources, multi-dimensional universes, query stripping or multi-queries are covered in Chapter 12 to Chapter 14.Whatever your data source, you can set some useful options to your document.
2.1    Creating a Web Intelligence Document from a Universe
The portal interface in SAP BusinessObjects BI 4.2 provides two ways to launch the Web Intelligence query and analysis tool in the BI Launch Pad. After logging on to the BI Launch Pad and going to the Home tab, you'll notice a column on the right-hand side of the page with six application shortcuts. These links are beneath the My Applications heading.
Figure 2.1 shows the shortcut icons for these six applications in the BI Launch Pad:


Module


Analysis Edition for OLAP


Information Steward


Crystal Reports for Enterprise


BI Workspace


Web Intelligence



Figure 2.1    Launching Web Intelligence from BI Launch Pad
An alternate method of launching Web Intelligence from within the BI Launch Pad is by clicking on the Applications link located in the top menu of the page. Links to the same six applications as previously described will appear but in a different order.
Figure 2.2 shows the result of clicking on the Applications menu link and selecting Web Intelligence from the list provided.

Figure 2.2    Launching Web Intelligence from the Applications Menu Link
An alternate method of launching Web Intelligence is to click its icon in the bottom of the pane in the right side.
If you have set Web Intelligence Java Applet as your preferred client (see Chapter 1, Section 1.3.2), then it opens after the security warning and the splash screen. Otherwise, if you have selected the Web Intelligence HTML client, then the HTML version opens almost immediately.
In both cases, Web Intelligence displays to a blank screen with all of the shortcut icons disabled except for two choices:


                Create a new document ([Ctrl)+[N))
            

                Open (retrieve) a document from the server ([Ctrl)+[O))
            

From the Web Intelligence tab itself, you have additional options to interact with the document by clicking on one of three small icons located beside the document name. This is where you can enlarge the screen by opening the document in a new window or simply close the Web Intelligence application. There are three clickable icon options on the Web Intelligence tab:


Open in a new window


Pin (or unpin) this tab


Close


Figure 2.3 shows the options available after launching the Web Intelligence application and before a document is created or opened.
Click on the Blank Document icon to create a new Web Intelligence document.

Figure 2.3    Options Available before Creating or Opening a Document
As shown in Figure 2.4, the Create a Document dialog box opens and proposes you to create a blank document based on seven possible data sources:


Universe 


Excel 


BEx 


SAP HANA 


SAP HANA Online 


Analysis View (this data source is not supported in Web Intelligence HTML)
            

Free-hand SQL 


The No data source option allows you to start creating a document without any data source.

Figure 2.4    Selecting a Data Source for a New Document in Web Intelligence Java
In addition of the data sources supported in HTML and Java Applet, two additional data sources can be used to create Web Intelligence documents while working in the Web Intelligence Rich Client (see Figure 2.5): Text and Web Services.

Figure 2.5    Data Source Types Available in Web Intelligence Rich Client
As this is the most common data source, to introduce you the Query Panel, we'll first describe the workflow to create a new document from a universe; other data sources being presented in Section 2.6.
The patented SAP BusinessObjects semantic layer known as the universe remains the primary method for connecting reporting documents to traditional data warehouses and relational databases. Historically, universes were created in the tool named Designer, renamed into Universe Design Tool in SAP BusinessObjects BI 4.0. SAP BusinessObjects 4.0 also introduced the Information Design Tool, a new universe creation tool that creates a new universe format (UNX). This new universe format can be created from multiple sources and from multidimensional sources.
The objects in your universes should be consistently named with business terms to provide users with the simplest and most intuitive approach to retrieving the data they need.

Additional Reference
For more details on universes, you can refer to Universe Design with SAP BusinessObjects BI: The Comprehensive Guide (SAP PRESS, 2014, www.sap-press.com/3412).

But little has changed from a user's perspective when it comes to connecting to a universe to query a database. Database fields, known in the universe as objects, are used in the Query Panel to retrieve data and to restrict the results to return only the information needed.
After selecting Universe as the data source for a new document, you're presented with a list of available universes that you have permission to access. Click on a universe in the list, and click on Select to proceed. Figure 2.6 shows an example list of available universes that can be used as a data source.

Figure 2.6    Universe Selection
After you make your universe selection, the Web Intelligence tool will be launched and opened to the Query Panel. Before you can begin analyzing information and creating reports, you need to retrieve information from your data source. The Query Panel is your window for accessing that data.









2.2    The Query Panel in Web Intelligence
The Query Panel in Web Intelligence provides an intuitive interface for selecting objects and retrieving results from universes.
Specific versions of this Query Panel are available to query other data sources and are described in:


Section 2.6 for Excel and text files, Free-Hand SQL, web services and analysis views.
            

Chapter 12 for multidimensional data sources, text files and web services.
            

Chapter 13 for SAP BW and SAP HANA data sources.
            

Figure 2.7 shows a glimpse of the full Query Panel at the beginning of the query-building process after you have selected a relational universe as the data source. Query Panel advanced capabilities, including querying a multidimensional universe, are described in Chapter 12.

Figure 2.7    Universe Query Panel
As seen in Figure 2.7, the Query Panel consists of five major panes; you can display/hide four of them with the icons in the toolbar. These panes are:


Universe outline (toggled with the   icon)Contains the objects available in the connected data source.
            

Result ObjectsRetrieves data from the database when you drag and drop objects from the Universe outline pane to this pane to begin creating a query.
            

Query Filters (toggled with the   icon)Restricts the results returned from the data source.
            

Data Preview (toggled with the   icon) Displays a preview of the result set based on the objects included in the Result Objects pane.
            

Scope of Analysis (toggled with the   icon)Shows the hierarchy and drill path of the objects in the universe.
            


Note
The Scope of Analysis and Data Preview panes can't be displayed at the same time. Toggle between these sections by using the shortcut icons in the toolbar.

2.2.1    Creating the Query
The Universe outline pane is located on the left side of the document and shows you the database fields or objects that can be retrieved or used to filter the query.
The purpose of the Universe outline pane is to provide the list of objects available in the connected data source to be used as result objects or filters in the query. This pane contains the classes and objects that were previously set up in the universe. The terminology used for object aliasing in universe design begins to play an important role in the Query Panel when deciding which objects to include in the query.
A relational universe contains the objects described in Table 2.1.




                            Icon
                        

                            Object
                        

                            Description
                        








                            Dimension


                            A dimension is an object you want to query about in your data source. It can be a product, a service, a customer—any metadata for which you store data in your data source.
                        






                            Dimension Attribute (also named detail)
                        

                            A dimension attribute is always associated with a dimension. It provides descriptive data about this dimension. For example, a Customer dimension may have an Address attribute.
                        






                            Measure


                            A measure is mainly a numeric data on which aggregation functions can be applied. A measure is aggregated by the set of dimensions composing the query.
                        






                            Measure Attribute (also named detail)
                        

                            An measure attribute is always associated with a measure. It provides descriptive data about this measure. For example, a Sales measure may have a Sales Percentage attribute.
                        






                            Filter


                            A filter is a condition object that limits the data returned by the query.
                        






                            Folder (also named class)
                        

                            A folder is a container intended to logically organize the other objects. A folder can contain sub-folders.
                        



Table 2.1    Objects in Relational Universe Outline
Universe created with Information Design Tool (UNX file format) may contain views. Views are defined as sub-set of the universe objects. If your universe contains a large number of objects, you can display only this sub-set of objects and focus on them. As shown in Figure 2.8, in the drop-down menu available on top of the Universe outline pane, you can select:


                    The universe master view, containing all objects of the universe, organized in their folders
                

                    A view among the ones that have been defined in the universe
                

Display by Navigation Paths to display the objects by navigation path (see Chapter 14, Section 14.2.3)
                


Figure 2.8    Selecting Views to Display in the Universe Outline
To define your query to your data source, select objects from the Universe outline pane and drag and drop them into the Result Objects pane. You can also drag and drop a folder; which will add all objects of the folder in the Result Objects pane, as shown in Figure 2.9.

Figure 2.9    Selected Objects in the Query Panel
In the Result Objects pane, you can organize your query:


                    Select an object and drag and drop it to change its place in the query
                

                    Select an object and click the Delete icon to remove it from the query
                

                    Click the Delete All icons to remove all objects from the query
                

2.2.2    Setting Query Properties
Query properties are used to set properties for eight different categories in the current query. You can access the properties by clicking on the Query Properties icon located at the top of the Query Panel, which opens the Query Properties dialog box, shown in Figure 2.10.

Figure 2.10    Query Properties
Let's examine these properties:


NameThis property allows you to revise the name of any query in the document or Query Panel. This setting becomes very useful when multiple queries are added to a single Web Intelligence document (see Chapter 14).
                

UniverseThis property is read only and displays the name of the current universe.
                

LimitsYou can apply the Max rows retrieved and Max retrieval time (s) settings to restrict the result size and retrieval duration of the query (in seconds) by clicking on the checkbox beside the desired setting and then revising the associated number to your preference.
                

SampleSampling enables you to retrieve a fixed or random sample of the data when querying databases that support it. Random sampling is applied by default unless Fixed is selected. Sampling is disabled if your database doesn't support sampling.
                

DataThis property provides the option to retrieve duplicate rows or unique rows when refreshing. Both settings are unchecked by default. To optimize the query, you can also select the Enable query stripping option (see Chapter 12, Section 12.6).
                

SecurityThis section provides the option to allow other users to edit all queries and is checked by default. If unchecked, only the report developer can make revisions to the current document.
                

Prompt OrderThis section allows you to change the order of the prompts if multiple prompted filter objects exist in the Query Filters pane.
                

ContextThis setting provides the option to reset contexts upon refreshing (unchecked by default). A checkbox is provided to clear contexts before the next refresh.
                


Tip
Choosing to display the objects by hierarchies gives you an opportunity to see the relationship of the dimension objects in the universe. This is useful when setting up drillable report filters with cascading values.

Understanding the properties available in the Query Panel is important for effectively producing queries with a desired outcome, such as limiting the number of rows retrieved by a query or defining the order of prompted filters.
2.2.3    Previewing Data
The Data Preview panel can be helpful because it lets you preview a sample of the data based on the existing result objects and query filters before actually running a query.
Previewing data allows you to control the content of your query on a small dataset, preventing you to run the complete query that can take long and allowing you to do some adjustment to the query while you're still in the Query Panel.
To view a preview of the data, open the Data Preview panel, and click on the Refresh icon located in the upper-right corner of the panel. A sample of the result data will be displayed inside the panel, as shown in Figure 2.11.

Figure 2.11    Data Preview
Filter Preview Data
While reviewing data in the Data Preview panel, you have the option to further restrict the result set by creating a query filter for a specific value. To do this, right-click on a value in the panel and select Create simple filter. This selection will add the object and value to the Query Filters panel. Click on Refresh in the Data Preview panel again to preview the updated data set.
Figure 2.12 shows the Data Preview panel if you right-clicked on Los Angeles in the City column. Select the Create simple filter: City equal to Los Angeles option to dynamically create a custom filter object in the Query Filters panel.

Figure 2.12    Creating Simple Filters from the Data Preview Section
Using Search to Filter Data Preview Values
If you're looking for a specific value in a data set but are unable to locate it in the Data Preview panel, click in the search window located beneath the panel, and begin entering your term or phrase. The box will search through every row in the panel and immediately filter the results. Searching begins when a single letter or number is entered, and every column in each row is searched.
Figure 2.13 shows the letters "Trou" entered in the search bar with the Lines column selected. The data in the Data Preview panel filters the results immediately, and the rows with sweaters are easily located.

Figure 2.13    Dynamically Filtering Preview Data
By previewing a sample of the data set, you can identify areas to improve the query and further refine the information set to be retrieved from the data source.
2.2.4    Evaluating Generated SQL Script
After a query has been created, you have the opportunity to review script generated by the Query Panel. You can view the SQL script generated from the query by clicking on the View Script shortcut icon at the top of the Query Panel. Two options are available in the Query Script viewer to either view or edit the query script:


                    Use the query script generated by your query.
                

                    Use custom query script. The script becomes editable when you select the Use custom query script option (see Chapter 12, Section 12.5).
                

Figure 2.14 shows the options available when viewing the script of the query. The default selection is the Use the query script generated by your query radio button.

Figure 2.14    View Query Script Generated by the Query Panel
2.2.5    Running the Query
Once you have created your query, you have to run it to retrieve dataset. To do so, click the Run Query button in the top right side of the Query Panel. The Query Panel closes; a progress bar displays while the query is sent to the data source and the dataset is fetched.
After a query has been refreshed in Web Intelligence, the data is stored in memory in an unseen microcube. A microcube is a data storage structure in each report, used store the query results behind the scenes. Users can present any combination of the data with any type of data block or chart type, while keeping the ability to drill down and apply report-level or block-level filters.
The microcube allows you to analyze data using different dimensions in separate report tabs and report blocks, while revealing only the data that you request. This is done by storing the result data of each document for the last query that was successfully executed. Until the data becomes visible in a report, it remains stored behind the scenes in the microcube. The style, format, and presentation of the data is controlled by the report designer, so they may most effectively display data to solve business problems.
As described in next chapters, microcube can be used for complex calculations on the data it stores. At this point, the data, ready to be formatted and presented in a report, is displayed in the report as a simple table. You can then create your document with all the powerful filtering and visualization features available in Web Intelligence.
The Report Panel is displayed after a query has been refreshed allowing you to organize and format your document, as described in next chapters. To return to editing the query, you can in Design mode:


                    Click on the Data Access tab, select the Data Providers tab, and then click on Edit Query.
                

                    Click the Edit button in the toolbar, as shown in Figure 2.15.
                    
Figure 2.15    The Edit Icon


This reopens the Query Panel with the query you have created in the first place. You can now add, remove or rearrange objects to and from the query, or add filters to restrict the dataset fetched from the database, as described next.









2.3    Query Filters
Query filters are used to generate the Where clause for the SQL script that is submitted to the data source. These objects work very closely with the Result Objects pane to provide a simple and intuitive interface for retrieving and restricting data from the data source. More details on query filters can be found in Chapter 10, Section 10.1 and Chapter 12, Section 12.1.
Query filters allow you to minimize the amount of data returned from the query by restricting the results to specific criteria. For example, you can add the Month dimension to the Query Filters pane and set it to July, and then add the Year dimension and set it to 2014. Doing this will retrieve all the values for the objects included in the Result Objects pane for July 2014. Query filters offer you the following benefits:


                Ability to return only the data you need to fulfill reporting requirements
            

                Ability to restrict confidential data from being displayed in reports or being returned to the microcube


                Ability to retrieve manageable result sets that can be exported to Excel, exported as a PDF, or printed
            

Filters are identified by two major categories: predefined filters (or conditions) and custom filters.
2.3.1    Predefined Filters
Predefined filters are created by a developer or administrator and saved in the universe as conditions. These predefined conditions are easily recognizable in the Query Panel because a yellow filter icon appears to the left of the condition name.
An example of a very simple predefined filter is the This Year condition predefined in the demo eFashion universe. The following line of code was added to the Where section in the properties of the condition to create the filter:
Calendar_year_lookup.Yr = '2006'
A more accurate and user-friendly name for this object would be Year 2006 rather than This Year to minimize any potential confusion in the future.
Predefined filters are created in the universe and can contain a variety of complex SQL formulas. By creating predefined filters, users can easily and intuitively constrain their queries to return specific data sets without having to create their own filters.

Condition Segments
Universe developers can create conditions containing any of the following segments:


Case statementsProvide If/Else/Then logic to a condition or object.
                    

And/or logicMultiple filters can be applied within a single condition.
                    

In listAllows a condition to be created for many items in a list.
                    


To add a predefined filter into your query, you can:


                    Select it from the Universe outline and drag and drop it into the Query Filters pane
                

                    Double-click it
                

2.3.2    Custom Filters
Custom filters are conditions created by report developers. These types of filters are created when dimension objects are dragged and dropped into the Query Filters pane, an operator is chosen, and a value is entered or selected.
After a dimension object has been added to the Query Filters pane, you can choose how to set up the filter. This includes modifying the operator and assignment type, and configuring the filter properties.
A dimension object can be set up as a filter with one of the following five types:


ConstantManually enters a custom value.
                

Value(s) from listProvides a list of values for one or more selections.
                

PromptPrompts the user to enter or select a value when the query is refreshed.
                

Object from this queryProvides the capability to select a predefined object or variable as the dimension value (although you can't use the In list or Not in list operators).
                

Result from another queryAllows filters to be created using a result object retrieved by a different query within the same document.
                

The default operator when a dimension is added to the Query Filters pane is In list, and the default assignment type is Constant.

Figure 2.16    Filter Operator Selection
As shown in Figure 2.16, the operators available when creating a condition are as follows:


In list Retrieves the data for one or more selected or entered values.
Example: City IN ('Austin','Boston','Chicago','Dallas')


Not in listRestricts the query from returning data for one or more selected or entered values.
Example: City NOT IN ('Austin','Boston','Chicago','Dallas')


Equal to (=)Obtains data equal to a selected or entered value.
Example: Lines = Sweaters


Not equal to (<>)Obtains data not equal to a selected or entered value.
Example: Lines <> Jackets


Greater than (>)Retrieves only the data greater than an entered value.
Example: Sales revenue > 1500


Greater than or Equal to (>=)Retrieves only the data greater than or equal to a selected or entered value.
Example: Sales revenue >= 1500


Less than (<)Retrieves only the data less than a selected or entered value.
Example: Sales revenue < 1500


Less than or Equal to (<=)Retrieves only the data less than or equal to a selected or entered value.
Example: Sales revenue <= 1500


BetweenRetrieves only the data between two values.
Example: Sales revenue Between 1500 and 2000


Not Between Retrieves only the data not between two values.
Example: Sales revenue Not Between 1500 and 2000


Is nullRetrieves only the values that don't have data (i.e., have a null value).
Example: Lines Is null


Is not null Retrieves only the values that have data.
Example: Lines Is not null


Matches patternRetrieves the data that matches the pattern of a selected or entered value. This operator is translated as Like when the SQL script is generated. In the example, rows for all objects where the lines begin with S will be returned:
Example: Lines Matches pattern 'S%'
                


Note
The wild card character (%) is used to represent an indefinite number of characters. The underscore symbol (_) is used to represent a single character. An example of using three underscore wild card characters is a formula written as City = 'Bos___' used with the Matches pattern operator. The result returns Boston.



Different from patternRetrieves the data that doesn't match the pattern of a selected or entered value. This operator is translated as Not Like when the SQL script is generated. The following example returns all the rows where the value in the lines object does not begin with S:
Example: Lines Different from pattern 'S%'


BothRetrieves data that corresponds to two values; if the Both filter is used with a dimension object, an intersection is generated.
                

ExceptRetrieves the data for other values in the dimension while restricting a selected or entered value; a minus query is generated when this operator is used.
                

2.3.3    Quick Filters
Quick filters are created when you select a dimensional object from the Result Objects pane and click on the Filter icon located in the upper-right corner of the pane. This procedure opens the Add Quick Filter dialog box, where you can quickly define the new condition or filter.
Figure 2.17 shows the Add Quick Filter dialog box that opens when a quick filter is added for the Lines object. The operator is set to Equal To if a single value is selected, but if multiple values are selected from the displayed values, the operator will be set to In List. You can modify the operator of the object after the new filter has been created and added to the Query Filters pane.

Figure 2.17    Adding a Quick Filter to a Result Object
2.3.4    Nested Conditions
Query filter conditions can be grouped by using AND and OR to perform extended business logic with conditions.
Figure 2.18 shows a Query Filters pane with filters and predefined filters organized into nested conditions. These conditions are grouped to provide a more customized filtering technique.

Figure 2.18    Nested Query Filter Conditions
You can group filters by following these steps:


                    Drop an object or predefined condition to the very bottom of the condition that you want to group it with.
                

                    By default, the objects will appear in an AND group.
                

                    If OR is required, double-click on the new AND group operator, and the group operator will become OR.
                

The example in will return only the values associated with last year's Christmas period or the holiday period for this year.
Query filters minimize or completely eliminate returning unnecessary information. You can apply a combination of custom and predefined filters that accurately restricts information. You can also add prompted filters to documents that require user input when opening or refreshing reports.









2.4    Prompted Queries
The filter described in previous section allows you to narrow down the scope of data to analyze among your dataset. But in your everyday work, you may need to query different side of your business activity. Instead of modifying the filters for each analysis to run, Web Intelligence supports prompts that provide interactivity to your documents.
As their name indicates, prompts (also called parameters in SAP system) allows you to easily modify a filters values before running the query. Before being sent to the data source, the query is updated with the values provided by the user when answering the prompts.
2.4.1    Creating a Prompted Filter
To create a prompted filter, follow these steps:


                    In the Query Panel, after you have added an object in the Query Filters pane, click on the Properties button   located to the right of the filter object to reveal five filter condition types, as shown in Figure 2.19.
                    
Figure 2.19    Choosing Prompt as Filter Type


                    Select Prompt as the condition type. A default label is entered as the prompt question: "Enter <object name>:".
                

                    Click on the Prompt Properties button   located immediately to the left to open the Prompt Properties dialog box shown in Figure 2.20 where you can set up the properties for the prompted condition.
                    
Figure 2.20    Prompt Filter Properties


                    Modify the available prompt properties accordingly to how you want to display the prompt at refresh time. For the moment, let's simply modify the Prompt text and add a different text than the default one. This prompt text lets you create customized and appropriate messages for business users when they are prompted to enter or select values.
                

                    Click OK to close the Prompt Properties dialog box and continue to add objects to your query.
                

2.4.2    Running the Query
When you have completed your query, it is time to run it.
Because you have added a prompt to your query, the Prompts dialog box opens before the query is sent to the data source. As shown in Figure 2.21, this dialog box gathers all prompts defined in the query and that can be answered before running the query.

Figure 2.21    Answering Prompts
The Prompts Summary displays the prompt text set when defining the prompt. To answer the prompt, you can either:


                    Double-click a city name in the list of values proposed to you. The selected city will then be displayed in the Selected Value(s) text field.
                

                    Type a city name in the Type a value text field and click the > button to move this name in the Selected Value(s) text field. This is possible since when we have defined the prompt, we have kept the Select only from list checkbox unselected. However, typing another city name will likely return no result if the data source contains no data for this city.
                

The OK button remains disabled until you have properly answered the required prompts. When this is the case, you can click it to run the query. The query is updated to take into consideration the value you have selected and filter the dataset with your answer to the prompt.
More details on prompts can be found in Chapter 9.
2.4.3    Data Source Prompts
In addition to the prompts that can be created in the query, some prompts may exist in your data sources. These prompts may require you to maintain several values before the dataset can be retrieved from this data source. Let's look at these prompts now:


Universe contextWhen querying a relational universe creating in Universe Design Tool or Information Design Tool, the objects you have selected may return several possible answers. The Universe context prompt will require you to resolve these differences.
                    Contexts are resolved in the Query Contexts dialog box as shown in Figure 2.22. They are prompted to you before the universe or user-defined prompts.
                


Figure 2.22    Context Selection Prompt


                    With more complex cases, you may have more than two contexts to resolve in the Query Contexts dialog box. Here, select a context defined a path in the data schema to answer the query. This path might also prompt you for other context choices and impact the other prompts you need to answer for the query.
                



Universe promptsUniverse prompts are also defined in the relational or multidimensional universe. These prompts are created by your universe designer to ask you for a value that will be used to filter the dataset. Such prompts are typically put in place to reduce the size of the dataset, avoiding database stress. You answer them also in the same Prompts dialog box, as described in Section 2.4.2.
                

SAP variables and input parameters (SAP HANA, SAP BW)SAP systems (SAP BW or SAP HANA) may also expose some specific prompts named variables and input parameters. These prompts can modify the objects you can query in the Query Panel. Chapter 13 describes how you answer them.
                

After you have created and refreshed your document, remember to save, so you don't have to recreate it next time you need to run the same query.









2.5    Saving Your Document in the BI Platform Repository
To avoid you to recreate your query and document, you can save your document into the BI platform repository.
In the BI platform, you can save the document either in:


                The Public Folders folder or sub-folder, depending on the security rights your administrator has set to you
            

                Your personal folder, that only you can access. When working in a production environment, the best workflow is to save documents there first to make changes to the query or one of the reports before saving them in the Public Folders folder or one its sub-folder.
            

You can also save your document in your file system, and use it through the Web Intelligence Rich Client (see Chapter 21, Section 21.3.2).
When saving your document in your BI platform repository, you can:


                Give it a name, a description and keywords. These are useful to easily identify and find your document.
            

                Assign it some categories, public or private.
            

                Set some Web Intelligence settings:
                

Refresh on open: Use this option to force the document to be refreshed when it is opened (Section 2.5.3).
                    

Permanent regional formatting: Use this option to save the document locale in the document, allowing it to be displayed in the same locale, when opened by users from other regions.
                    

Save document with comments: This option is available only if you save an existing document under another name and want to duplicate its comments as well (see Chapter 18, Section 18.5).
                    



The dialog box to save a document differs depending on the client you use: Web Intelligence Applet or HTML.
2.5.1    Save Document Dialog Box in Applet
In Web Intelligence Applet, follow these steps to save your document:


                    If your document has already been saved in the BI platform repository, click the Save icon   located in the upper left corner of the report, in the File tab, to overwrite the existing version.
                    If your document has never been saved, or if you click the drop-down menu under the Save icon (shown in Figure 2.23) to explicitly select the Save As... option, the Save Document dialog box opens. This dialog box (shown in Figure 2.24) allows you to enter the required details for saving this document.
                

                    Use the Folders tab to navigate in the folders structure and select the document destination folder.
                

                    You may click the Categories tab to select the categories to assign to the document.
                

                    Enter a name for this document in the Name text field.
                

                    Click the Advanced button to expand the Save Document dialog box and display the Description, Keywords and save options, as shown in Figure 2.25. If needed, fill these fields and modify the options.
                    
Figure 2.23    Save Menu in Web Intelligence Applet

Figure 2.24    Save Document Dialog Box in Web Intelligence Applet

Figure 2.25    Save Document Dialog Box with Advanced Options in Applet


                    Click Save to save your document.
                

2.5.2    Save Dialog Box in HTML
In Web Intelligence HTML, you can save your document by clicking the downward arrow beside the save icon located in the upper left corner of the report. This opens the Save As dialog box, as shown in Figure 2.26.

Figure 2.26    Save Document Dialog Box in HTML
Then, to save the document, follow these steps:


                    In the tree list, you can navigate into the folder where the document will be saved. This folder can be in your personal folders (click Favorites Folder tray) or corporate (click Favorites Folder tray).
                

                    In the File Name text field, enter the name for the file.
                

                    To display more options, click the >> button beneath the Save As Type selection. As shown in Figure 2.27, this extends the dialog box to display Description, Keywords text fields and Assign Category tree and Refresh on open and Permanent regional formatting options.
                    
Figure 2.27    Save Document Dialog Box with Advanced Options in HTML


                    Enter the appropriate options and click Save to save your document.
                


Small Screen
If you have a small screen, when you extend the save dialog box, you may not see the Save button anymore. Scroll down to the bottom of the window to access it.

2.5.3    Using Refresh on Open Option
You can force a document to be refreshed when it is opened by selecting the Refresh on open checkbox when saving it. This option can be set for the following reasons:


                    To make sure the reader has the most recent data.
                

                    When security has been defined to be applied, this forces this security to be applied to the current reader, preventing him to see data from a previous refresh by another user.
                

                    If you have defined filter prompts when defining the query (Section 2.4), then before retrieving the dataset from the dataset, the Prompts dialog box pops up to allow you to select values for these prompts.
                

This option can be set either when saving the document (Section 2.5) and is available among the advanced options. Alternatively, you can also set the Refresh on open option in the Document Summary dialog box (Section 2.7).

Administrator Setting
Through security rights (see Appendix B), your administrator can force documents to be refreshed on open. This is the case to force data security to be applied at query time and prevent users to disable it.










2.6    Other Data Sources
As described in Section 2.1, one of Web Intelligence's strengths is to allow you to query several data sources types, in addition to the ones supported through the universe. The next sections describe the workflows for these other data sources, except SAP BW and SAP HANA, which are covered in Chapter 13.
2.6.1    Excel as a Data Source
Using Microsoft Excel, it is easy to quickly create a database and store data into spreadsheets. But this approach has some drawbacks:


                    Because of this flexibility, many Excel files can be created, without any control, making them hard to maintain.
                

                    The data they contain cannot be traceable.
                

By storing the Excel files in the BI platform repository, you can add controls on these files, and then use them as data sources for Web Intelligence documents.
To create a Web Intelligence document on an Excel file, follow these steps:


                    Once you have opened Web Intelligence, create a new document, as described in Section 2.1.
                

                    In the Create a Document dialog box (see Figure 2.4 or Figure 2.5), when you are asked to select a data source, select Excel and click OK.
                

                    In the Open a document from server dialog box that opens (see Figure 2.28), navigate in the BI platform repository folders to find the Excel file to use.
                    
Figure 2.28    Selecting Excel File in BI Platform Repository


                    Select the Excel file to query and click Open.
                

                    In the Custom Data Provider - Excel window that opens (see Figure 2.29), you can define how the Excel file will be fetched:
                    

                            In the Sheet Name drop down list, select the sheet name that contains the data.
                        

                            In the Field Selection radio-buttons, select the fields to query: all of them (All Fields), by defining a range (Range Definition), or by selecting a range name already defined in the spreadsheet (Range Name).
                        

                            Select the First row contains column names checkbox to accept the first row in the spreadsheet as column names. These column names are by default used to name the mapped objects.
                        

                    Additionally, you can change the Excel file used as a source by clicking Browse and selecting another file. Click OK to move to the Query Panel for Excel.
                    
Figure 2.29    Options for Using an Excel File as a Data Source


                    As shown in Figure 2.30, this Query Panel has some differences with the universe Query Panel. The columns coming from the Excel file are displayed as objects in the Result Objects pane. The Data Samples pane shows you a preview of the dataset to be retrieved. You can select an object and in the Object Properties, modify:
                    

                            Its name
                        

                            Its qualification (dimension, measure or attribute)
                        

                            Its type
                        

                            Its aggregation function, if you have defined it as a measure
                        

                            Its associated dimension, if you have defined it as an attribute
                        


Figure 2.30    Excel Query Panel


                    In the Query Properties pane, you may:
                    

                            Modify the query name in the Name text field
                        

                            Modify the source Excel file by clicking the button beside the Source Path field
                        

                            Unselect the Refreshable checkbox to not refresh the query when the document is refreshed.
                        



                    In the Query Definition pane, you may click Edit settings to open the Custom Data Provider - Excel dialog box and modify the sheet and field selection defined when selecting the Excel file.
                

                    Click Run Query to close the Query Panel, get the dataset from the Excel file and display them in the report.
                

Once the dataset is displayed in the report, you can continue to build your report as defined in next chapters.
2.6.2    Free-Hand SQL as a Data Source
If your administrator has given you the right to do so, you can directly query a relational database by providing a SQL statement. This capability, named free-hand SQL, gives some flexibility to query but requires to know the underlying schema table.
This capability supports the ANSI SQL 89/92/98. The SQL query you enter can contain:


                    Stored procedures


                    @variable
                

                    @prompt in the SQL; which allows you to parameter your query
                

However, the SQL is not run if it contains Data Definition Language (DDL) commands—DROP, ALTER,...—that can modify the database.
If your SQL query is valid, you can define objects to map the returned columns and use them in the Web Intelligence document, as if they were returned by any other data source.
For each object, you can define the following properties:


                    Its name
                

                    Its qualification: dimension, attribute or measure
                

                    Its type: string or numerical
                

                    Its aggregate function, if you have defined it as a measure
                

                    Its associated dimension, if you have defined it as an attribute
                

Creating a document from free-hand SQL can be done with Web Intelligence Rich Client, HTML or Java applet. It must be based on a connection stored in the BI repository, hence you must be connected to it.
To create a document with free-hand SQL, follow these steps:


                    From BI Launch Pad, select to create a new Web Intelligence document, or in Web Intelligence Rich Client, connect to the BI platform, then select to create a new document.
                

                    In the Create a Document dialog box (see Figure 2.4 or Figure 2.5), when you are asked to select a data source, select Free-hand SQL and click OK.
                

                    In the Select a relational connection dialog box that opens, navigate in the BI repository folders to select the connection to use. Select it and click OK.
                

                    In the Query Script editor dialog box (Figure 2.31), type the SQL statement, then click OK.
                    
Figure 2.31    Free-Hand SQL Query Script Editor


                    The Query Panel opens. As shown in Figure 2.32, it has some differences with the universe Query Panel. The columns returned by your SQL are displayed as objects in the Result Objects pane. You can select an object and in the Object Properties pane, modify:
                    

                            Its name
                        

                            Its qualification (dimension, measure, or detail)
                        

                            Its type
                        

                            Its aggregation function, if you have defined it as a measure
                        

                            Its associated dimension, if you have defined it as a detail
                        


Figure 2.32    Free-Hand SQL Query Panel


                    In the Query Properties pane, you may:
                    

                            Modify the query name in the Name text field
                        

                            Modify the relational connection by clicking the button beside the Connection field
                        

                            Select the Max Rows Retrieved checkbox and then enter a value in the text field beside to limit the number of rows returned by the SQL query
                        

                            Select the Max Retrieval Times checkbox and then enter a value in the text field beside to set the SQL query timeout (in seconds)
                        



                    In the Query Definition pane, you may click Edit SQL... to open the Query Script editor dialog box and modify the SQL query.
                

                    Click Run Query to close the Query Panel, get the dataset from the SQL query and display it in the report.
                

Once the dataset is displayed in the report, you can continue to build your report as defined in next chapters.
2.6.3    Text Files as a Data Source
Using a text file as the data source can only be done from Web Intelligence Rich Client. This option is not available in Web Intelligence HTML or Applet.
To create a document from a text file, follow these steps:


                    In Web Intelligence Rich Client, select to create a new document.
                

                    When you are proposed to select your data source, select Text.
                

                    The Open a document dialog box opens where you can navigate in your file system to choose your text file to use as data source.
                

                    Once you have selected it, click Open to validate your choice. The Custom Data Provider - Text dialog box is launched (see Figure 2.33).
                    
Figure 2.33    Custom Data Provider - Text Dialog Box


                    Select the options for the Data Separator and Text Delimiter of the source text file. Other options include assigning the first row of the file as column names, and selecting the Locale, Charset, and Date Format.
                

                    Click OK to close the Custom Data Provider - Text dialog box and opens the Query Panel.
                

                    As shown in Figure 2.34, this Query Panel is very similar to the one for Excel.
                

                    The columns coming from the text file are displayed as objects in the Result Objects pane. The Data Samples pane shows you a preview of the dataset to be retrieved. You can select an object and in the Object Properties, modify its name, qualification, type, its aggregation function (if you have defined it as a measure) or its associated dimension (if you have defined it as an attribute).
                    
Figure 2.34    Text File Query Panel


                    Click Run Query to close the Query Panel, get the dataset from the text file and display it in the report.
                

2.6.4    Web Services as a Data Source
In Web Intelligence Rich Client, you can also create Web Intelligence documents using web services as the data source. These web services can be created from Query as a Web Service Designer, data blocks published as web services from other Web Intelligence documents, or generic web services.


                    In Web Intelligence Rich Client, select to create a new document.
                

                    When you are proposed to select your data source, select Web Services.
                

                    The Custom Data Provider - Web Services dialog box, as shown in Figure 2.35. In the Source URL text field, enter your web service URL, then click Submit.
                    
Figure 2.35    Custom Data Provider - Web Services Dialog Box


                    The dialog box is then extended to propose you more options, as shown in Figure 2.36.
                    

                            In the Service Name drop down menu, among the services exposed by the web service, select the one to query.
                        

                            In the Port Name, select the port used by the web service.
                        

                            In the Operation Name, select the operation to query.
                        


Figure 2.36    Web Service Details


                    The Message Details section is filled with the services details, as shown in Figure 2.37 1. You may click the SSO Enabled checkbox to use Single Sign-On for authentication.
                

                    This tree list behind describes the web service's Web Service Definition Language (WSDL). This WSDL defines the web service contract. It allows you to set some values to pass to the web service when it is called.
                    
Figure 2.37    Web Service Details


                    For example, go at the bottom of the tree and select login.
                

                    In the Enter Value text field, enter the username to authenticate, then click Apply.
                

                    Identically, select password and enter the password for this user then click Apply.
                

                    As shown in Figure 2.37 2, both branches are filled with the values you've entered. Click OK to validate the web services definition.
                

                    The Custom Data Provider - Web Services closes and the Query Panel opens.
                

                    As seen in Figure 2.38, this Query Panel is very similar to the one for Excel and text file and you can perform the same actions.
                    
Figure 2.38    Web Service Query Panel


                    The columns coming from the web services are displayed as objects in the Result Objects pane. The Data Samples pane shows you a preview of the dataset to be retrieved. You can select an object and in the Object Properties, modify its name, qualification, type, its aggregation function (if you have defined it as a measure) or its associated dimension (if you have defined it as an attribute).
                

                    Click Run Query to close the Query Panel, get the dataset from the text file and display it in the report.
                

2.6.5    Analysis Views as a Data Source
Analysis views are created with SAP BusinessObjects Analysis for online analytical processing. This reporting tool is also available from within the BI Launch Pad and allows you to analyze multidimensional data source. Web Intelligence can use an analysis view to access a subset of data derived from an analysis workspace and a multidimensional data set, as shown in Figure 2.39. This capability provides a means of accessing a specific arrangement of cube data within the Web Intelligence application and outside of the analysis workspace.

Figure 2.39    Viewing a Cube in SAP BusinessObjects Analysis, OLAP Edition
You can take advantage of the rich feature set in Web Intelligence with the option to create reports sourced from analysis views by doing the following:


                    From BI Launch Pad, select to create a new Web Intelligence document, or in Web Intelligence Rich Client, connect to the BI platform, then select to create a new document.
                

                    In the Create a Document dialog box (see Figure 2.4 or Figure 2.5), when you are asked to select a data source, select Analysis View and click OK.
                

                    The Select an Analysis View dialog box opens where you can navigate in your BI platform repository to choose the analysis view to use as data source.
                

                    Click OK.
                

                    The Query Panel opens displaying the objects exposed by the analysis view.
                

                    In the Data Preview, you may click Refresh to display data returned by the analysis view, as shown in Figure 2.40.
                

                    Click Run Query to close the Query Panel, get the dataset from the analysis view and display it in the report.
                    
Figure 2.40    Analysis View Query Panel











2.7    Document Options
The Document Summary dialog box contains a couple of very important property settings to enhance the effectiveness of particular reports. The most commonly used options include Refresh on open for prompted reports, Auto-merge dimensions for queries with multiple data sources, and Enable query stripping to improve performance.
To open this dialog box, in Design mode, select the Properties tab, then click Document. The Document Summary dialog box opens, as shown in Figure 2.41. Modify your options, then click OK to validate them. Save your document so your new settings are saved in the document.
Figure 2.41 shows the Document Summary options accessed through the Properties tab in the Report Panel.

Figure 2.41    Document Summary Options
Let's examine each of these Document Summary options:


Refresh on openThis option forces the query to be refreshed when the report is opened. This feature is useful in prompted reports and when the data is restricted to the user logged on to the BI Launch Pad. On SAP HANA Online mode (see Chapter 13, Section 13.6), this option is renamed Update prompts on open.
            

Permanent regional formattingThis option permanently sets the locale or regional formatting of the document.
            

Use query drillThis option modifies the underlying query when drilling down or drilling up in a report. Dimensions are added or removed to the Result Objects section of the query, and query filters are added dynamically based on the drill selection. The scope of analysis is also modified dynamically. The query drill feature is most commonly used when reports contain aggregate measures calculated at the database level.
            

Update shared element(s) on openWhen opening a document linked to shared elements, this option can be used to automatically update them in the document if newer version of these shared elements have been published in the BI repository (see Chapter 19, Section 19.2).
            

Enable query strippingThis feature allows queries to be generated with only the objects used in the Report Panel, instead of all objects of the query. Retrieving only the needed objects used in the document is intended to improve the query performance (see Chapter 12, Section 12.6).
            

Hide warning icons in charts and tablesThis feature hides general warnings that could potentially appear in the upper-left corner of a chart (see Chapter 12, Section 12.7).
            

Auto-merge dimensionsThis option automatically merges dimensions when more than one query is added to the document that contains objects with the same name, same data type, and from the same universe (see Chapter 14, Section 14.3).
            

Right to Left Content AlignmentDefines the default direction to display the document content if in BI Launch Pad preferences, you have defined your preferred document orientation as "Default".
            

Extend merged dimension valuesThis selection shows all of the data in a report that contains synchronized or merged dimension objects, not just the values relating to the merged objects (see Chapter 14, Section 14.3).
            

Merge prompts (BEx or HANA variables) This selection is useful when multiple SAP BEx queries or SAP HANA are queried in a single document. Identical prompts appearing in each query are synchronized and only show the prompt a single time to the user. This option is supported to all access to SAP BEx and SAP HANA (see Chapter 13), except SAP HANA Online mode:
                

                        SAP BEx direct access
                    

                        Relational or multidimensional universe (UNX) to SAP BEx query
                    

                        Relational or multidimensional universe (UNX) to SAP HANA
                    

                        SAP HANA direct access (relational or multidimensional)
                    



Check for shared element update(s) on open When opening documents linked to shared elements, this option can be used to prevent Web Intelligence to look if new updates of the shared elements have been published in the BI repository (see Chapter 19, Section 19.2).
            

Default Style In the Default Style section, you can import or export the style used by the document.
            

Comments In the Comments section, you can define if the comment displayed in the comment cell or tooltip if the first or last comment in the thread of discussion (see Chapter 18, Section 18.5).
            










2.8    Summary
Several features make Web Intelligence the best-in-class query and analysis solution for any data warehouse, data mart, or business intelligence reporting environment and one of them is the Query Panel.
In an intuitive web-based report development interface, using the drag-and-drop interface of the Query Panel, you can create queries to graphically transform prebuilt universe objects into analytical reports. The objects added to the Result Objects pane and Query Filter pane generate script to access data sources without having to write a single line of code; which makes Web Intelligence ideal for self-service data analysis and reporting.
Precise results are returned by constraining values at the database level with a rich set of operators for query filtering. You can group your conditions in nested pairings with the AND and OR operators for more complex filtering. You can learn to control your row counts by limiting the maximum number of rows retrieved by a query. Your DBAs will appreciate the reduced stress on the database when you set a maximum retrieval time on your queries.
Historically, Web Intelligence queries are based on universes, and all the data sources they support. But through variant versions of the Query Panel, you can also directly use Excel files, text files, free-hand SQL, web services or analysis views as Web Intelligence data sources.
Document properties can also be set to define various behaviors for this document.
Once the dataset is retrieved and stored in the document microcube, you can start designing and formatting your report, as described in the next chapter.








3    Creating a Report in Web IntelligenceUse Web Intelligence reports to analyze, present, and interact with highly formatted data for accurate and more informed decisions. You can use drill filters, input controls, charts, tables, block filters, and a lengthy set of report functions to produce highly customized reports. Additionally, with a powerful charting engine, Web Intelligence users are able to consume rich graphical reports.Reports are your window to a business's performance results and scorecards for tracking metrics from detailed granular data to summarized aggregate reports. A user's role in an organization will dictate how they use Web Intelligence reports. This can vary from viewing and analyzing data to designing and editing existing reports. Reports can also be shared with other users in a secure, customized, and web-based delivery format. Behind the scenes, Web Intelligence reports are saved to the file repository server and delivered to the end user using the BI Launch Pad, the SAP BusinessObjects BI portal.Web Intelligence enables you to present company data in your reports by adding data tables and charts to the Report Panel via several provided report templates. You'll then be able to group data by adding multiple sections and breaks to produce analytical documents by including sorts and drill filters.After creating a Web Intelligence reporting document, users can quickly share their findings with other users across the enterprise by saving reports in the folder structure storage area accessed with BI Launch Pad. Depending on permissions, users are either granted or denied access to view, schedule, or even edit documents while working within the BI Launch Pad.The application also enables users to identify significant values by including conditional formatting in reports. Conditional formatting can be applied to rows and columns in a report, assigned to every column or row in a table, or applied to single columns and headers of table reporting elements.Web Intelligence also allows users to create precisely designed reports by defining the formatting and object placement relationships of objects on the report canvas by assigning relative position attributes to report elements This feature is accessed by going to the Layout properties of a chart or table after it has been added to a report.Due in part to the broad set of features available in the Web Intelligence Report Panel, report developers can create free-form presentations for displaying data in the most ideal way for their unique business need rather than having to force data into a template.
3.1    Adding Data to Report Elements
Data is added to reports by adding result objects or variables to any of the report elements such as a table, chart, map, or cell.
Follow these steps to add a report element to the canvas of a Web Intelligence report after your query has been refreshed:


                Click on Design. All document editing must be done in design mode rather than reading mode.
            

                Select the Report Elements tab from the ribbon toolbar. (Note: If you're using the Applet viewer then the tab is labeled Report Element; in the HTML viewer it's labeled Report Elements.)
            

                Select the Table (or Tables depending on viewer) subtab and then select the data table to be added.
            

                Choose a location on the report canvas and click to insert the data table type selected, as shown in Figure 3.1.
            


Figure 3.1    Selecting a Location on the Report Canvas to Insert the Selected Element

Note
You can build the report elements without actually seeing the data by viewing the structure of the document pane, which is very useful when working with large sets of data. You can toggle between Structure only and With Data by using shortcut keys [Ctrl)+[2) and [Ctrl)+[3).

3.1.1    Populating a Cross Table
Table objects are the basic elements in reports; the following steps guide you through adding a cross table (crosstab) to a report. There are two methods for assigning objects to a report element.
Dragging and Dropping Objects onto a Table
The first method is accomplished by dragging one or more result objects from the Available Objects tab in the side panel and then dropping them into the appropriate sections in an already inserted cross table.
Figure 3.2 shows the [Sales revenue] measure object being added to a cross table.

Figure 3.2    Drag and Drop a Sales Revenue Measure Object to a Crosstab
Assigning Data to Report Elements
The second method for assigning objects to a data table or chart is by right-clicking on a report element and selecting Assign Data.... Figure 3.3 shows the menu presented when right-clicking on a crosstab.

Figure 3.3    Right-Clicking on a Crosstab to Assign Data

Note
The Assign Data... option for connecting result objects and variables to report elements is available for both charts and data tables. Figure 3.4 shows the Assign Data... window for connecting data to a crosstab.

Figure 3.4    Assign Data Window When Adding Objects to a Crosstab

3.1.2    Populating a Chart
Charts can be populated with data objects very similarly to the way data tables are created. To get started with the editing and chart building process, be sure that you're in design mode. The easiest method of assigning dimensions and measures to a chart is by dragging and dropping objects from the Available Objects tab on the side panel onto the chart. Objects can be dropped anywhere on the chart; the charting engine will know where to assign dimension and measure objects.
You will instantly see charted values after at least one dimension and one measure has been dropped onto the chart. If you're in Design structure only mode, return to Design with data to see the data populated in the charts and tables.

Note
A chart must include at least one dimension object and one measure object, while a data table can contain a single object.

The next section discusses how you can use sections and breaks to enhance the readability and functionality of a report.









3.2    Sections and Breaks
Grouping data is accomplished by creating sections for dimension objects or applying breaks to columns displayed in tables. Sections are used to group data into visually separated segments while breaks provide the ability to create subtotals within the same segment. Now in SAP BusinessObjects BI 4.2 SP 3, you'll see a new Section tab located within the primary Result Objects tab. Clicking on the Section tab will reveal the Insert Section button. Both are displayed in Figure 3.5.

Figure 3.5    Inserting a Section with the Section Tab
After clicking Insert Section, you'll have the chance to select a location on the report canvas to place the section. A standard click will insert in the location that you've chosen. Figure 3.6 shows the message that you'll see when using the Applet viewer.

Figure 3.6    Choosing a Location to Insert a Section
After adding a section to a report, you'll need to select a dimensional object from the list of available objects.
You can add multiple sections to a single report with each subsequent section becoming a subsection of the original. One restriction of a section is that it can't be a measure object.
3.2.1    Setting a Section
Figure 3.7 shows the City object in a vertical table being set as a section using the traditional method of right-clicking on the object and selecting Set as Section.

Figure 3.7    Transforming a Column in a Table to a Section
To add a section to a report, follow these steps:


                    Use an existing data table on a report that already has at least a one dimension object assigned to it. Identify the object to be used as the section.
                

                    Right-click on the object and select Set as Section. This will split the rows into groups based on the values of the dimension defined as the section.
                

After you've set an object as a section, it will be removed from the table and added as a table group (or section) header. The remaining values in the table will be grouped by the values of the section.
Figure 3.8 shows the outcome of setting the City result object column in the data table to a section. The City object has been added as a block header, and the object is no longer a column in the table.

Figure 3.8    Setting the City Object as a Section
After you've added the section you can also add report elements to that section. The values in any additional elements are grouped by the same values in the section heading.
To view the size of a section and identify the elements in it, switch to Design structure only mode. You can do this by clicking the downward arrow beside Design and selecting Structure only. This view of the report is also accessible by using shortcut keys (Ctrl)+(3). Viewing the report structure allows you to resize the height of the section with regard to the objects and elements that will be presented inside it.
Figure 3.9 shows the structure view of the report that contains the section added in the previous step.

Figure 3.9    Structure Only View of a Report
Formatting Sections
To apply formatting to a section in a report, right-click anywhere in the section while in Design with data mode and select Format Section from the list of options. From the Format Section window, you can apply various settings, including the following in the General category:


Bookmark section


Hide section when the following are empty


Hide always


Hide when empty


Hide when the following formula is true


The Appearance and Layout categories provide the following options:


Background colors and images


Vertical properties:


Start on a new page


Repeat on every page


Avoid page break





Note
An important setting that is often difficult to locate is the Minimum Top Offset section setting. For a report that contains at least two pages and a section, this setting should always be changed manually to 0.00, or the first page of your report will have a gap above the first sectioned value.

Accessing the Minimum Top Offset Setting
To access the Minimum Top Offset setting, follow these steps:


                        Right-click on a section.
                    

                        Select Format Section.
                    

                        Select the Layout category.
                    

                        Update the Minimum Top Offset function to 0.00.
                    

This setting is pictured in Figure 3.10.

Figure 3.10    Locating the Minimum Top Offset Section Setting
3.2.2    Grouping Data with Breaks
Another way of grouping table data in a Web Intelligence report is by using breaks. Breaks are similar to sections, except that when you add them, they don't include block headings. When you add a break, a new set of break properties becomes available for customization.
Add a break by selecting an existing object in a table, right-clicking on the object, and then in the contextual menu, select Break • Add Break. Adding a break to a data table is useful for calculating subtotals. Breaks will appear as a subset of section values and the dimensional object selected as a break will remain visible within the report table, unlike when a section is added.
A Second Way to Add a Break
Another way of adding a break is by using the Break function in the ribbon toolbar. Begin by selecting an object in a table to create the break for, and then click the Break button located in the Analysis tab and Display subtab. This function is pictured in Figure 3.11.

Figure 3.11    Adding a Break Using the Ribbon Toolbar
Editing Breaks
To edit the properties of a break, click anywhere inside the table containing the break and then click the downward arrow beside Break in the Analysis tab and Display subtab. Next, select Manage Breaks. From this window, you'll be able to apply break settings to all breaks within the selected report element.
Figure 3.12 shows the break properties available when designing a report.

Figure 3.12    Managing Break Properties
After a section or break has been created on a table, you can unfold and fold a data table to toggle between viewing detailed and aggregated data.
3.2.3    Adding Custom Groups
Custom groups allow for more flexibility when grouping data on a report. This relatively new feature allows report designers to create if-then-else logic graphically with a window for easy selecting.
Like creating breaks, begin by selecting an object from an existing data table in a report. Next, click the Group button located in the Analysis tab and Display subtab. This is pictured in Figure 3.13.

Figure 3.13    Adding a Custom Group
We talk more about adding custom groups in Chapter 11.









3.3    Outline Navigation
The outline feature provides the ability for users to navigate a report by collapsing and expanding data tables based on break or section values to view details or totals. This method of analysis can be a real time-saver by adding interactivity to reports that provide users with the ability to jump right to the level of aggregation needed. Even when a table doesn't have a break or section, the Outline Fold feature allows you to see the totals with two clicks. Outline, pictured in Figure 3.14, is one of the few toolbar choices available to users in Reading mode and is enabled/disabled with a standard click.
Enabling Outline will allow users to fold/unfold data blocks based on existing breaks to show all of the data available or to only show subtotals. It's worth noting that multiple tables can exist on a single report page with breaks added at different levels and the Fold/Unfold feature functions independently on each table.

Figure 3.14    Locating Outline in the Reading Toolbar
When viewing a report in Reading mode, the Fold/Unfold feature is turned off by default, even when the Outline button has been toggled on. Figure 3.15 shows part of a report containing four breaks and Outline enabled. The only noticeable difference is a thick gray border above and to the left of the report.

Figure 3.15    Outline Enabled on a Report with Breaks
3.3.1    Putting Outline into Action
To begin folding data in a table, you need to click anywhere in the table to see how many levels of aggregations are available to be collapsed or expanded. Figure 3.16 shows the same table pictured in Figure 3.15 except that the Sales Revenue column heading was clicked. Folding and unfolding takes place when an individual arrow is clicked. This will either collapse all of the details within that break value or expand all.

Note
When the arrows are pointing down, the break is unfolded or expanded to its maximum size. When the arrow or arrows are pointing to the right, then folding has taken place.

Since a single report tab can contain multiple data tables with varying dimensions, breaks, and levels of aggregation, the table must be clicked to engage the folding features.
Even if a table doesn't contain a break or section, when Outline is enabled, you can still click in the table to fold it and show column totals.

Figure 3.16    Enabling the Fold/Unfold Options in Outline Mode
Figure 3.17 shows the report from the previous tab when fold 4 is clicked. Hover over the fold column numbers to see the name of the dimension used to create the break. Notice how all of the details below the Week level have been hidden because the totals for each week are now being displayed.

Figure 3.17    Folding Enabled on the Fourth Break to Show Totals by Week
Also note that the arrows are now pointing to the right in the fourth break column. This tells the user that all values in the break are now showing totals within the hierarchies above it.
If you click one of the fold numbers like pictured in the lower-left corner of Figure 3.17, all breaks and folds beneath it will be hidden. Figure 3.18 shows how the report will look when fold 1 is clicked.

Figure 3.18    Folding at a Higher Level
3.3.2    Folding at Different Levels
Once you get the hang of how to fold and unfold breaks, you'll be able to create custom views of data that show a combination of totals, subtotals, and details. This is especially useful when hiding less essential line items without completely removing them and to also compare values and percentages at different levels.
Figure 3.19 shows varying levels of folding applied to the same table as the previous examples.

Note
If it's important to design a report for your audience to view data at very specific mixed levels, this can be achieved by following the example in Figure 3.21 and then toggling Outline mode to off.
Once Outline has been turned off, folding and unfolding will be disabled and the report can be used merely as an analytical document and to utilize other valuable features in Web Intelligence, without the need to reconfigure the folds and breaks to recreate a style or view of the data. The folds previously configured will remain in place with all future refreshes of the data.


Figure 3.19    Varying Levels of Folding
The following section describes how to insert sorting and ranking into a report.









3.4    Enhanced Sorting and Ranking
Sorting and ranking are two simple techniques that increase report readability by displaying the most significant information to report consumers in the shortest amount of time. In just a couple of clicks, columns can be sorted, or the rows in a table can be ranked to display the top 10 sales revenues by the dimension of your choice. Both functions are available to report consumers in design mode. Let's begin by examining sorting.
3.4.1    Sorting
Sorting can be applied to tables or charts in a report and to either dimension objects or measures. Sorting is also always applied in breaks and sections. Figure 3.20 shows the Sort options available in the toolbar menu under the Analysis/Display tabs.

Figure 3.20    Sort from the Toolbar Menu under Analysis/Display
Four sort types are available to you while viewing a report in BI Launch Pad or when editing a Web Intelligence document:


NoneNatural sorting occurs based on the type of data in the columns.
                

AscendingSorting begins with the smallest value at the top (e.g., A, B, C, or 2, 4, 6).
                

DescendingSorting ends with the smallest value at the top (e.g., C, B, A, or 6, 4, 2).
                

CustomSorting is defined by the user; it often applies to character names but doesn't apply to measures. It is accessible via Manage Sorts in the menu options.
                

Sorting data in charts or tables allows users to quickly access data points in alphabetical or numerical order.
Applying Sorting
To apply sorting within a table, follow these steps:


                        Select the column or result object to be sorted.
                    

                        Select the Sort option in the Analysis/Display tabs.
                    

                        Select the sort type.
                    

                        Select None to remove applied sorting and return to default.
                    

To apply sorting within a chart, follow these steps:


                        Click on Design/Structure only located on the main toolbar to switch from data view to structure only view.
                    

                        Click on the object in the chart to be sorted.
                    

                        Select the Sort option on the Analysis/Display tabs.
                    

                        Select the sort type.
                    

                        Click on Design/With data to return to see the sort selected.
                    

                        Return to the structure view, and add, remove, or edit an existing sort.
                    

                        Click on the Sort icon again to remove the sort.
                    

Custom Sorting
Custom sorting is available only for dimension objects and while editing a document in the Report Panel.
When you select custom sorting, the dimension values of the object will be displayed in natural or ascending order. You can re-sort the item values by selecting values individually and clicking on the up or down arrows until the values are in the order that you prefer.
An example of custom sorting is when a month name object sorts alphabetically rather than chronologically, as shown in Figure 3.21. For months to appear in chronological order, you need to create a custom sort to reorder the values. If you have data only through June, then July through December values won't appear in the list.

Figure 3.21    Default or Natural Sorting Applied to the Month Abbreviation
This is when you need to include temporary values. Enter the month names from July to December, add them to the existing list, and then order them chronologically rather than alphabetically. This will keep the month data sorted correctly for all future refreshes.
The only way to sort the months correctly is to apply a custom sort.
Custom Sort Dialog Box
Figure 3.22 shows the Custom Sort dialog box used to sort the month name values. Click on the values in the provided list box and then use the arrows to the right to move them up or down the list.

Figure 3.22    Custom Sorting
The left side of the Custom Sort screen allows you to add temporary values for items that don't currently appear within the list of values.

Note
Before a custom sort can be applied, the column has to already have a sort. After adding a sort to a column, view the advanced sort options to modify the custom sort order.

Custom Sorting Options
To create a custom sort, click on the small downward arrow to the right of the Sort function, and then select the advanced option. This menu provides additional options for customizing sorts on the selected chart. The following options are available in the Manage Sorts window:


                        Revise the priority of sorts if more than one sort has been added.
                    

                        Modify the direction or order of a chart between ascending or descending.
                    

                        Add a new object to be sorted, or remove an existing sort.
                    

                        Define a custom order to sort an object.
                    

                        Reset an existing custom sort object back to ascending or descending.
                    

Remove Custom Sort Value
If a custom sort has been added but needs to be removed, view the sort by accessing the advanced menu and then click reset located just beneath the values button under custom order.
Figure 3.23 shows sorting being set on a measure within a data table.

Figure 3.23    Sorting Sales Revenue in Descending Order

Note
Notice that custom sorting isn't an option when sorting on a measure object. Custom sorting is only available for dimension objects.

Enhanced Sorting
Sorting in charts and data tables is a very common requirement when analyzing data in reports. Now in SAP BusinessObjects BI 4.2, chart sorting has been enhanced to provide users with even more flexibility when displaying data visually in reports.
Sorting can become a necessary function when displaying data from two or more measures or dimensional objects. The Region Color feature, available when assigning data to charts, provides this capability by allowing charts to be created that display two-dimensional values for a single measure. Depending on the values being charted, this combination of measures and dimensions can be difficult to interpret. To ease the complexity of displaying and analyzing this type information, the sort feature now allows you to sort by dimension, measure, or by the dimensional value selected in the Region Color section. Figure 3.24 shows the Sort menu with a column chart selected that contains two dimension objects and a single measure object.

Figure 3.24    Sorting by Group
Note that in order to get the option of sorting a chart on two different groups, you'll need to add a second dimension to the Region Color selection when assigning data to the chart. By default, Region Color is optional. Adding a dimension object to this area will further breakout the results of the dimension used in the Category Axis.
Figure 3.25 shows the Year dimension being added to the chart to see the Quantity sold values by City and broken out by the year. With this feature, you can apply sorts to dimensions in both groups and also to any measure object in the chart.
Figure 3.26 shows a chart sorted by two dimensions: City and Year.

Figure 3.25    Adding a Second Optional Dimension with the Region Color Entry

Figure 3.26    Sorting a Chart by a Dimension and Measure
Multigroup charting displays information in a compound format and is ideal when the number of values in both dimension objects is relatively small.
Sorting in a Cross Table (Crosstab)
Compound sorting isn't reserved for charts only. Cross table report elements can also contain multiple sorts applied to the dimension objects in both the columns and rows in the table.
Figure 3.27 shows the sort selections applied in a cross table. The State object has been assigned to the vertical axis, and the Year object to the horizontal axis. To apply sorting to objects in the Columns and Rows sections, use the Advanced Sort option to set up custom sorting on either object. You can also simply select the data in the table and then select the sort direction in the toolbar.

Figure 3.27    Applying Sorts to a Crosstab
Ranking also helps report consumers access significant information quickly.
3.4.2    Ranking
Ranking is used to display the top or bottom number of objects within a block. Values are ranked by dimensions and are based on measures of several different types and calculation modes:


Top/BottomSelect Top, Bottom, or both, and then use the up and down arrows or text box to set number of values.
                

Based onSelect a measure to use for ranking.
                

Ranked by (optional)This selected dimension object is used by the ranking to create the top or bottom values.
                

Calculation mode:
                    

Count: This mode returns the top or bottom n records of the Based on selection.
                        

Percentage: This mode returns the top or bottom n% of records of the total number of records and the Based on selection.
                        

Cumulative sum: This mode returns the top or bottom records for the cumulative sum of the measure selected and (optionally) the Based on selection; doesn't exceed n.
                        

Cumulative percentage: This mode returns the top or bottom records for the cumulative sum of the measure selected and (optionally) the Based on selection; doesn't exceed n%.
                        



Ranking takes precedence over any sorts previously set up in a report block.

Note
Web Intelligence includes tied rankings, which means that if you want to display the top 10 values, and 3 records have the same value, 13 records will appear in the top 10 list.

To add a ranking, follow these steps:


                    Modify your Web Intelligence document. (Ranking can be applied only in Design mode.)
                

                    Select a table or chart to be ranked.
                

                    Click on the Ranking button located on the reporting toolbar on the Analysis tab and Filters subtab.
                

                    Select the Ranking properties in the Ranking dialog box.
                

Two options—Edit Ranking and Remove Ranking—will be available if a ranking has already been added to a report element, because only one ranking can be added to a report element.
Figure 3.28 shows the Ranking dialog box opened when Add Ranking or Edit Ranking is selected. This dialog box allows you to configure the ranking properties by checking the Top, Bottom, or both ranking property types, followed by selecting the Based on, Ranked by, or Calculation mode to create or edit a ranking.
The next section discusses conditional formatting rules and how they can be used to alert report consumers about important conditional elements in Web Intelligence reports.

Figure 3.28    Ranking Dialog Box for a Crosstab









3.5    Conditional Formatting
Web Intelligence reports use conditional formatting rules (previously known as alerters) to highlight values that meet a specified set of criteria. When a set of criteria has been met, values can be displayed with customized formatting. This includes the capability to modify the following areas:


TextFont, type, size, color, underline, strikethrough
            

BackgroundColor, skin, image from URL, image from file
            

BorderOne or more sides, border size, color
            


Note
Because of the capability to add a background image in a conditional formatting rule, reports can be designed to function as scorecards and display trend icon images based on a value's relation to a target value or threshold.

Figure 3.29 shows the New Rule... button for conditional formatting on the ribbon toolbar while using the HTML viewer.

Figure 3.29    New Conditional Rule Button on the Ribbon Toolbar
Clicking the New Rule... button will launch the Formatting Rule Editor window, which is shown in Figure 3.30. From this window, modify the following settings to set up the criteria for the new conditional formatting rule:


NameGive the conditional rule a descriptive and unique name; this is important if you have many rules. The default value in this field is Conditional Format.
            

DescriptionEnter a clear description of what each conditional rule will perform.
            

Filtered object or cellSelect the field or result object to be evaluated.
            

OperatorSelect the operator to be used (e.g., Equal to, Greater than, etc.).
            


Figure 3.30    Formatting Rule Editor


OperandsEnter a value to represent the target or threshold to trigger the conditional format.
            

After configuring these five settings, click on the Format button to launch the Formatting Rules Display window used to define the visual attributes of the new rule (see Figure 3.31).

Figure 3.31    Formatting Rules Display
From this window, revise the following items to create the criteria for the conditional display:


DisplayCan be used to write a formula or apply a specific number format to a data element when a specific condition is met.
            

TextChange the default font size and font color. The default color is already selected to red, but you can choose another color by clicking on the down arrow and selecting from the color palette.
            

BackgroundChoose colors, patterns, or images to apply to the cell background.
            

BorderChoose any style for the cell border to accentuate the cell.
            


Note
Use the Preview area in the Text section of the Formatting Rules Display window to see how a rule will show the text, background, or borders configured in the rule.

After you've created a new conditional formatting rule, select a column or table heading, and then click on the Formatting Rules icon on the ribbon toolbar under the Analysis/Conditional tabs. All available conditional formatting will have an open checkbox located to the left of the conditional formatting name.
Check the rule that you want to apply to the selected column and click on OK. Figure 3.32 shows a conditional formatting rule being applied with these three steps:


                Select the column to apply the conditional formatting to.
            

                Click on the Formatting Rules icon.
            

                Select the conditional settings to be applied to the selected column(s).
            


Figure 3.32    Conditional Formatting Rules Applied to a Column in a Table
Figure 3.33 shows the Formatting Rule Editor window with a basic condition in place to highlight any cell to light yellow and bold text when the value is greater than 15000.
The next section explains how to modify report headers and footers and describes the method for including background images in reports.

Figure 3.33    Basic Conditional Format Setup in the Formatting Rule Editor









3.6    Headers, Footers, and Background Images
To access headers and footers property window, click anywhere inside a header or footer, right-click, and then select either Format header or Format footer, depending on which you're working on. The Format header window opens, as shown in Figure 3.34.
Both property windows allow you to apply the following formats:


Border


Style


Thickness




Appearance


Color


Pattern: Can include a color, skin, or image
                    



Layout


Show header (or footer)
                    

Header (or footer) Height





Figure 3.34    Format Header Window
The header and footer sections can be hidden or displayed depending on your preference or business requirements.
To toggle the header on or off, begin by entering Design mode, and then click the primary Page Setup tab. Next, select either the Header or Footer subtabs. Notice that the Show button will either be on or off. Figure 3.35 shows the Show Header icon with the header enabled and the header height at 0.55 inches.

Figure 3.35    Report Header Set as Visible in a Report
If the page header and footer have both been removed from a report, and you need to add them back in, follow these steps:


                Click on the Page Setup • Header tab on the ribbon toolbar.
            

                Click on the Show button to turn the header on. You can also set the height of the header in this step.
            

                Click on the Page Setup • Footer tab on the ribbon toolbar.
            

                Click on the Show button to turn the footer on. You can also set the height of the footer in this step.
            

Quite often, report developers need to include background images or company logos in Web Intelligence reporting documents. You can easily do this by following just a few steps:


                Go to the Report Elements • Cell tab on the ribbon toolbar. Place the Blank icon onto the report canvas at your desired location.
            

                After the blank cell has been added, right-click on the it, select Format Cell, and choose Appearance in the Format Cell window. You can also click on the Appearance icon under Format/Style on the ribbon toolbar. Figure 3.36 shows the properties available for the blank cell under Appearance.
            


Figure 3.36    Format Cell Appearance
The Background dialog box opens to provide four options under Pattern (see Figure 3.37):


NoneDefault selection
            

SkinShows five predefined photos
            

Image from addressOpens a dialog box for manual URL entry
            

Image from FileEnables browsing to locate and select a local image
            

You can create background images with the following file types: PNG, BMP, GIF, JPG, or JPEG.
Images are presented with five different display types:


Normal


Stretch


Tile


Horizontal Tile


Vertical Tile


The position of the images can be displayed in any of these combinations:


Top, Center, Bottom


Left, Center, Right

Figure 3.37    Display Image Options for Formatting a Cell



Note
When images are selected as background images in a Blank Cell element, the recommended display selection should be set as the Stretch setting. This selection will resize the image to scale when the cell size is either increased or decreased.

Headers, footers, and background images can be used to add context to Web Intelligence reports. Report headers and footers can contain document names, company logos, dates, page numbers, and even custom messages such as confidentiality statements. Images can be useful because they can aid in illustrating concepts, add branding, or adding style to a report. Choosing the right placement for images and creating a consistent look and feel is imperative in achieving strong usability for report consumers.









3.7    Summary
Web Intelligence documents are created for viewing, analyzing, and sharing company data in a secure, customized, and drillable web-based delivery format. You can create reports by using the result objects and report elements, and by setting properties in the tabs provided in the side panel. Reports are physically presented in the document pane and easily enhanced with the extensive list of shortcut icons in five provided toolbars.
Web Intelligence allows you to present multiple reports within a single reporting document that contains a variety of data visualization component types. You also have the ability to create drillable and highly formatted reports that include sections, breaks, sorting, ranking, and report filters to produce effective analytical documents.
Changes in report data can be easily identified when detailed conditional formatting has been created.
SAP BusinessObjects provides a full spectrum of reporting components for displaying data. These include Available Objects tables, freehand cells, scorecarding capabilities through the use of conditional formatting, and 34 different types of charts.
The Report Panel provides a highly intuitive development canvas that allows business users to create, edit, and share reports with ease.
Chapter 4 describes how to navigate the Web Intelligence reporting interface and explains its ribbon-based toolbar. This is important because the Web Intelligence interface has changed from its previous releases. A bit of familiarization is necessary to get used to all the icons and their placements; however, you'll find that the grouping of icons is much more intuitive because it's based on their functional areas.








4    The Web Intelligence Report PanelThe streamlined interface in Web Intelligence 4.2 is easier than ever to use for both report developers and consumers. Use the ribbon toolbar for faster and more intuitive access to icons based on various functional areas. And take reports to an all new level with comments and shared elements. Then design, analyze, and share reports to effectively solve business issues.In this chapter we'll explore all of the features in the Report Panel in Web Intelligence, the robust reporting interface that allows report designers to create dynamic data presentations and visualizations. The reporting interface in Web Intelligence provides all formatting functions on a ribbon style toolbar in tabs grouped by functional areas for logical and effective development. The left pane has a couple of new "neighbors" joining the group beginning in SAP BI BusinessObjects 4.2—Shared Elements and Comments. These new features allow for a much more collaborative experience than in any previous version. And easy access to Available Objects, Document Summary, Navigation Map, and Input Controls make the report panel both intuitive and extremely powerful.
4.1    The Web Intelligence Reporting Interface
The reporting interface of Web Intelligence has two main interface options—Reading and Design—to accommodate different types of user interaction within a report. The reading mode has been exclusively designed for report consumers who only need to view and analyze results rather than edit it. The design mode provides many more capabilities and gives power users and report developers a full spectrum of creation and editing options.
In Figure 4.1, the Report Panel is shown in design mode and within the Applet viewer. Pictured is the report canvas with four basic chart types and the five tabs used to quickly access reporting functions when creating or modifying a report. Within these tabs, you'll find a well-organized collection of icons available for intuitive interaction and configuration of report elements and data.

Figure 4.1    The Web Intelligence Report Panel in Design Mode
If you've used Web Intelligence in BI 4.1 or earlier editions, you'll notice the two new icons in the side panel. These are for the new Shared Elements and Comments features. We'll discuss these in greater detail later.
To see the difference in features available in Design mode compared to Reading mode, Figure 4.2 shows the appearance of the Report Panel in reading mode. You'll notice that the side panel now has five icons available to users when viewing a report. That's because the new Comments feature is available during Reading mode to allow for easy participation in comment threads and to quickly share findings with other users.
This feature can come in handy for documentation of specific data points, to point out an issue discovered in the report, or to collaborate with other users based on the data in the report. With the proper credentials, commentary can be added in both Reading or Design mode.

Figure 4.2    The Web Intelligence Report Panel in Reading Mode
Navigate between these interface options by toggling between the Reading and Design options located in the upper-right corner of the panel.
A useful option in the reporting toolbar is Structure Only, found in the Design menu and shown in Figure 4.3.

Figure 4.3    Design Button Allows Access to Structure Only Mode
If you're using the HTML viewer, you'll have easy access to all of the interface options by right-clicking on the top bar and selecting Application mode, as shown in Figure 4.4.
The Editing option corresponds to the Design • With Data selection while the Show Structure option goes with to Design • With Structure selection. Selecting HTML will return the report to Reading mode.

Figure 4.4    Application Mode Menu in the HTML Viewer
Now that you're familiar with the different modes available for viewing and modifying reports, next we'll describe the ribbon-style toolbar and the functions located within it used for customizing the various elements of a report.









4.2    Reporting Toolbars
The formatting toolbar in Web Intelligence is similar to the Microsoft Office ribbon-style toolbars that you're probably already familiar with. This method of configuring properties allows for easier access to report formatting icons. The toolbar becomes useful when configuring charts and tables, customizing report features, modifying data access settings, and adding analytical features to reports. Figure 4.5 shows the formatting toolbar in design mode. Whether you're updating a horizontal table, vertical table, cross table, form, or freestanding cell, the ribbon toolbar allows you to instantly revise the format of entire columns with only a couple clicks.

Figure 4.5    Formatting Toolbar in Design Mode

Note
The Reading mode toolbar is different from the Design mode toolbar. They were designed to execute separate functions and to be more in line with the needs of report consumers and report designers. The Reading mode toolbar is much more streamlined for optimal viewing and filtering capabilities while the toolbar in Design mode has been created for power users and report developers with a greater need for customization.

The ribbon toolbar in design mode contains five primary tabs, each providing categorized functions and shortcut icons. We'll start by describing the report property tabs, located on the left side of the report page and only available in design mode, while providing a detailed description of each tab's individual function.
4.2.1    Overview of the Function Tabs in Design Mode
Following are the function tabs in design mode:


FileLocated on the left side of the window, this tab is used for adding new reports, opening existing documents, saving, printing, viewing historical instances, exporting, and sending reports to other users.
                

PropertiesThis tab allows you to view and revise Document and Application properties with three primary menu options:
                    

View: Quick access to viewing or hiding the various toolbars.
                        

Document: Launches the Document Summary properties window. The primary purpose of this window is the select the refresh on open option. New in BI 4.2 SP 3 are the options to choose the text displayed in a comment cell. The two choices are:
                            

Last comment (default)


First comment




Application: Change the measurement unit preferences: cm or inches. Two other important settings here are the options to Show Grid and to Snap to Grid. From the application settings you'll also be able to apply grid spacing and to choose if you'd like to reuse copied elements in other Web Intelligence documents.
                        



Report Element (labeled as Report Elements in the Web Intelligence HTML viewer)This tab provides access to the tables and charts that will be used for displaying data. From here you'll also be able to layer and align report elements and create document links, element links, and shared elements.
                

Format (labeled as Formatting in the Web Intelligence HTML viewer)This tab delivers a large number of formatting properties to fonts, cells, number formats, data alignment, and chart styles.
                

Data AccessWith this tab, you can add new data providers, edit existing ones, or add new variables to a reporting document. Now in SAP BusinessObjects BI 4.2 SP 3 you'll be able to create a new reference to a cell or reassign an existing one.
                

AnalysisCreate filters, rankings, input controls, enable data tracking, add conditional formatting, sort, enable/disable the filter bar, enable/disable outline mode, and apply an aggregate to a row or column.
                

Page SetupThis tab contains all page formatting options in one location. Features included are adding, renaming or moving a report, enable/disable a header or footer, enabling scale to page, or adjusting the report page's margins.
                

Let's explore the functions and options available in each tab.
4.2.2    Report Property Tab: File
Figure 4.6 shows the File tab and its associated icons:


NewThis icon is used to create a new document. Be careful when clicking the new page icon because if you have a report already open then it will close it, even if you decide not to create a new report.
                    
Figure 4.6    File Tab


OpenRepresented by the folder icon, this icon allows you to open a previously saved Web Intelligence document by browsing to it.
                

SaveThis icon is used to save reports with Save or Save As.
                

PrintThis icon provides one-click report printing by transforming the report into a PDF file.
                

FindThis icon allows you to search report data with the Find toolbar.
                

HistoryIf this report has been previously scheduled, the report instances will be available through this icon.
                

ExportWhen clicking this icon while using the HTML viewer you'll be able to save a document as a PDF, XLSX, XLS, CSV, or text file. New in SAP BusinessObjects BI 4.2 SP 3, if you're exporting a report to PDF then you'll be able to select a DPI for the images ranging from 72 to 2400 with seven choices available. If you're using the Applet viewer, you'll be able to export the query data to a CSV file.
                

Send toUse this icon to send the report to an email address, another SAP BusinessObjects user, or an FTP location. Note that the SAP BusinessObjects administrator is required to configure plug-ins on the server to use the email distribution functionality.
                

Undo/RedoThese icons let you undo or redo previous actions.
                

Cut/Copy/PasteCut, copy, and paste any report element, including charts and tables.
                

DeleteUse this icon to delete selected components.
                

Edit Data ProviderThis icon provides quick access to the Query Panel for query editing.
                

RefreshThe refresh icon is used to bring new data into the report by executing the queries within the document. Being able to refresh data is a primary function when generating reports.
                

4.2.3    Report Property Tab: Properties
Figure 4.7 shows the View menu of the Properties tab. 

Figure 4.7    Properties Tab
The following options can be found within the Properties tab:


ViewAllows report developers to access the Filter Bar, Outline mode (also known as Fold/Unfold), Formula Bar, and Side Panel (or Left Pane). Additionally, you can toggle the Report Tabs and Status bar on and off using their respective checkboxes.
                

DocumentProvides a summary of configurable document properties, including type, author, description of the document, and creation date. Configurable options include the following options, that are described with more details in Chapter 2, Section 2.7.
                    

Description


Keywords


Refresh on open


Permanent regional formatting


Use query drill


Check for shared element update(s) on open


Enable query stripping: Can be applied to relational universe-based reports when Allow Query Stripping has been enabled in the Information Design Tool and Enable Query Stripping has also been enabled in the Document Summary section of each report.
                        

Hide warning icons in charts and tables


Auto-merge dimensions


Update shared element(s) on open


Extend merged dimension values


Merge prompts (BEx or HANA Variables)


Right to Left Content Alignment


Change the default style - Used to import a style file or export the existing style settings.
                        

Comments


Last comment (default) / First comment






ApplicationAllows developers to set the measurement units to display in either centimeters or inches. In the Applet only, you can also enable the Show Grid and Snap to Grid options here.
                

4.2.4    Report Element Tab
Figure 4.8 shows the Report Element tab and its associated icons. This is the first primary tab used for displaying data on the report canvas.

Figure 4.8    Report Element Tab
First let's examine the tabs under the Report Element tab section by section:


Table


Vertical table: Displays header cells at the top of the table.
                        

Horizontal table: Displays header cells to the left of the table.
                        

Cross table or Crosstab: Displays dimensions across the top and along the left side of the table while displaying measures in the body of the table.
                        

Form: Displays categorized dimension descriptions or mailing addresses.
                        



Cell


Blank cells: Used for custom headings or subheadings or to display information that should appear in the document.
                        

Predefined: Predefined single value containing metadata about report.
                        



Section


Insert section: Allows report developers to insert a section using available objects.
                        



Comment


                            Use the insert comment cell function in the Comment tab to place a free-hand comment cell anywhere on a report.
                        



Chart (chart types are examined in Chapter 7)
                    

Column: Graphically presents values in vertical or horizontal charts (available column charts: stacked column, 100% stacked column, dual axis column, dual axis column and line, and 3D column).
                        

Line: Displays data graphically with connected data points (available line charts: vertical/horizontal mixed, vertical/horizontal stacked, vertical/horizontal percent, 3D line, 3D surface, dual axis line, and surface).
                        

Pie: Displays data as a percentage of the whole with pie slices (available pie charts: pie with variable slice depth, donut, 3D pie, and 3D donut).
                        

Bar: Insert a bar chart for better readability of axis values. Choices include: bar, stacked bar, or 100% stacked bar.
                        

Point chart: Includes scatter plot, bubble chart, polar scatter plot, and polar bubble chart.
                        

Geo Choropleth chart: Now in SAP BusinessObjects BI 4.2 SP 3 you can insert maps natively in a Web Intelligence report. Choices include: geo choropleth, geo bubble, and geo pie.
                        

More: Includes box plot, radar chart, tree map, heat map, and tag cloud.
                        



Tools


Turn Into: Transforms selected object into a different type table or chart.
                        

Set as Section: Allows report developers to insert a section using selected object.
                        



Position


Order: Used for layer report elements on the canvas for precise layouts.
                        

Align: Create professional reports by aligning elements on the canvas.
                        



Linking


Add Hyperlink


Link To Document: HTML viewer only
                        

Add Element Link


Shared Element: Save or insert a previously generated shared element
                        



Table LayoutAppears only when a data table on the report canvas has been selected.
                    

Break


Insert


Header: Lets you show table headers. Useful when break headers have been added to the report.
                        

Footer




Behaviors


Hide


Page Break


Repeat: Allows tables, headers, or breaks to repeat on every page.
                        



4.2.5    Format (or Formatting) Tab
Figure 4.9 shows the Format tab (or Formatting tab as it's called in the HTML client) and its associated icons:


Font


Border


Cell


Style


Numbers


Alignment


Wrap Text: Allows a word wrap style of formatting to be applied to the selected column or columns so that a carriage return takes place within the cell rather than extending the value horizontally.
                        



Size


Padding


Tools


Format Painter: Applies formatting. Quickly copy the format of an existing cell or column and apply it to an additional cell or column by first selecting a cell that contains the preferred formatting, clicking on the Format Painter icon, and then clicking on the text to which you would like to apply the formatting.
                        

Formatting: Displays all formatting options for the selected report element.
                        

Clear Format: Resets all formatting to the default formats.
                        

Chart style: Will be hidden unless a chart element appearing on the report canvas has been selected.
                        




Figure 4.9    Format Tab
4.2.6    Data Access Tab
Figure 4.10 shows the Data Access tab and its associated icons:


Data Providers


New data provider (Applet only): Adds a new query to the existing document.
                        

Edit: Returns to the Query Panel to edit a query.
                        

Purge: Purges report data. This is important when publishing reports to the file repository with restricted data. You can purge all data from all data providers or choose an individual data provider to purge.
                        

Refresh: Submits the query to the data source to retrieve the most recent data.
                        



Tools


Change Source: Now available in both the Applet and HTML client.
                        

Export Data: Only available in the Applet.
                        



Data Objects


New Variable


Assign Reference: A new addition to SAP BusinessObjects BI 4.2 SP 3. This feature is used to create a new reference to a cell (see Chapter 11, Section 11.6).
                        

Merge





Figure 4.10    Data Access Tab
4.2.7    Analysis Tab
Figure 4.11 shows the Analysis tab and its associated icons:


Filters


Filter


Ranking


Input Controls




Data TrackingPrompts you to set the reference point for data tracking. A variety of data tracking options are available when tracking has been enabled. These options include font formatting for dimension insertions and deletions, detail changes, and increased/decreased values for measures. For more details about tracking changes, refer to Chapter 18, Section 18.6.
                

Display


Group


Break


Sort




Conditional


Formatting rules


New Rule: Now available in the HTML client beginning in SAP BusinessObjects BI 4.2 SP 3.
                        



Interact


Drill: Used to enable drill mode. It also provides a drill pane to drop result objects for simple report filtering. Drill mode allows report consumers to drill up or drill down the drill path for deeper and quicker analysis.
                        

Filter Bar


Outline




Functions


Sum


Count


More: Includes average, min, max, and percentage.
                        

Formula Bar





Figure 4.11    Analysis Tab
4.2.8    Page Setup Tab
Figure 4.12 shows the Page Setup tab and its associated icons:


Report


Add Report


Duplicate Report


Delete




Rename Report


Move Report


Move Left


Move Right




Page


Page Orientation (landscape or portrait)
                        

Page Format (A4, letter, legal, etc.)
                        



Header


Show Button


Page Header height




Footer


Show Button


Page Footer height




Scale To Page


Width


Height


Scale




Margins


Top Margin


Bottom Margin


Left Margin


Right Margin




Display


Page Mode


Quick Display


Rows


Columns





Figure 4.12    Page Setup Tab
The ribbon-based toolbar in Web Intelligence is a robust interface that allows users to quickly access all functions related to creating reports. The next section describes the usability of the side panel, which also provides main functions necessary for report maintenance and creation.









4.3    The Side Panel
The side panel (previously known as the left pane) contains icon tabs with access to some of the most important functions of creating reports and plays a critical role in editing existing documents. Figure 4.13 shows the Document Summary settings displayed in the first tab on the side panel. The information displayed in this window is the same in reading mode as it is in design mode.
The side panel contains eight functional groups in design mode and up to five while in reading mode. Let's examine each of these now:


Reading mode


Document Summary: This tab includes information about the report, such as author, creation date, locale, content alignment, description, keywords, last refresh date, last modified date, last modified by username, duration of previous refresh, and several document options. It also contains sections for data options that show if data tracking, auto-merge dimensions, and if the extend merged dimension values settings have been enabled. This report metadata is useful for administrators because it shows who has created and refreshed the document. Additionally, it shows the duration of previous refresh records, that is, the number of seconds the report took to refresh on the previous refresh. (Note that if never run, this value will be zero.)
                    

Report Map (or Navigation Map): This tab provides a linked list of the reports and section values within each report in the document.
                        
Figure 4.13    Side Panel - Document Summary


Input Controls: This tab provides a list of all components used to filter report data using input controls. The map option shows all input controls already saved on the document. Click reset to unselect any values previously assigned to input controls.
                    

User Prompt Input: This is where values from prompted conditions in the query panel will appear if they exist in the queries.
                    

Comments: A new feature introduced in SAP BusinessObjects BI 4.2 to allow users to collaborate on ideas and findings with other SAP BusinessObjects BI 4.2 users (see Chapter 18, Section 18.5). From this window you'll be able to enter a comment after selecting a report element and then entering a comment. Adding comments can be done from either Design or Reading mode. After a comment has been added, an icon will appear in the upper-right corner of the object containing the comment.
                    





Design mode


Document Summary: This tab includes the same information types as described earlier for reading mode.
                    

Report Map (or Navigation Map): This tab provides a linked list of the reports and section values within each report in the document. Use this panel to jump directly to a specific report or section value.
                    

Input Controls: This tab allows both report developers and users to include a variety of components to filter report data. The report designer can create new input controls by clicking on the New button under the Input Controls tab. Users can select values from any input controls in the report or reset the values to their default settings. Now in SAP BusinessObjects BI 4.2 SP 3, cascading input can be added to groups and function as cascading filters. This new capability makes for a much better analytical experience for users.
                    

Web Service Publisher (Web Intelligence Rich Client only): This tab allows the report designer to create web services using existing components or blocks from Web Intelligence reports.
                    

Available Objects: This backbone of all report creation. This tab is where you'll find the Result Objects from the Query Panel and locally created formulas and variables. All objects in this tab are available to be displayed in reports and only available while in design mode.
                    

User Prompt Input (HTML client only): Displays prompt filters that exist in the Query Panel. Users can access this area to quickly change filters and refresh queries.
                    

Document Structures and Filters: This tab provides a detailed listing of all objects existing within the document. The Filter selection shows where a filter has been applied to a report element or data block.
                    

Shared Elements: Use this tab to access report elements that have been previously shared and add them to your current report. This new SAP BusinessObjects BI 4.2 feature takes collaboration to a new level by making report parts sharable across the enterprise (see Chapter 19). Create report mashups by including shared elements from a variety of different reporting documents.
                    

Comments: Described in the previous section, this new feature adds a layer of communication between report consumers with the ability to add comments to reports on the fly.
                    



Data mode  (Web Intelligence Rich Client only)


Data: This tab contains the fields included in the Result Objects pane in the Query Panel and locally created formulas and variables. All objects in the Available Objects tab are available to be displayed in reports.
                    



Figure 4.14 shows the result objects from the Query Panel in the Available Objects tab. The objects in this tab have been retrieved from the database and exist within the document's microcube. You'll also find document variables and references in the Available Objects tab.

Figure 4.14    Available Objects
In the next section, we'll discuss the various features of the Report Panel—the area of the report used for displaying data.









4.4    Report Panel
The Report Panel contains possibly the most important part of a report known as the document pane or report canvas. This is where report elements are placed to display data in a Web Intelligence document.
The document pane consists of three basic sections:


                Report header (optional)
            

                Report body


                Report footer (optional)
            


Tip
When a query is refreshed for the first time, the result objects will appear in the document pane in a report titled Report 1. All result objects will also appear in the side panel in the Available Objects section. For all subsequent refreshes after the initial refresh, the side panel will be updated with the latest list of result objects, but the objects appearing on the document pane won't change unless revised manually by the report developer.

4.4.1    Working with Report Tabs
Multiple reports can exist within a single document and are displayed as tabs at the lower left-corner on the report panel and above the status bar.
Below is an example of three report tabs in a Web Intelligence document in Figure 4.15.

Figure 4.15    Example of Three Report Tabs
Report tab names can be easily adjusted by right-clicking on the tab names. To rename, insert, duplicate, or delete report tabs, use these methods:


                    Right-click on the report name tab located in the lower left of the report.
                

                    Select Rename to change the name of the report tab.
                

                    Select Add Report to add a new report tab.
                

                    Select Duplicate to make a duplicate copy of the current report.
                

                    Select Delete Report to remove the current report tab.
                

Figure 4.16 shows the actions available when you right-click on the report name tab located at the lower left of the document pane. The Move Report option is enabled only when two or more reports exist within the document.

Figure 4.16    Actions Available When Right-Clicking on the Report Tab
4.4.2    Formula Bar
The formula bar provides quick access to the definition of an object in a table or cell. You can save time by revising object definitions in the formula bar rather than editing variables and formulas in the variable editor (see Chapter 11).
To access the bar, right-click on the main ribbon bar, and then select Formula Bar to toggle it on and off.

Note
The formula bar is accessible only in Design mode. Figure 4.17 shows the menu to access the formula bar.

The formula bar can also be expanded to allow report developers to see more code on the screen. Figure 4.18 shows the formula bar expanded by using the double up arrows.

Figure 4.17    Menu to Access the Formula Bar

Figure 4.18    Formula Bar Expanded
4.4.3    Page Features
Web Intelligence reports can be viewed in the BI Launch Pad with two different display modes: Page Mode and Quick Display Mode:


Quick Display ModeThis is the default display mode and provides the most ideal screen space for analyzing data. The maximum displayed vertical and horizontal records can be adjusted in the Properties tab to modify the default settings. It is is used primarily for reports intended for analysis but not for printing.
                

Page ModeThis mode displays reports as they would appear if printed or exported to PDF. This mode is commonly selected in dashboard reports. It allows you to view the report the way it fits onto a printed page while also providing the capability of drilling into the data.
                

Each mode displays data differently; you can easily toggle back and forth between modes as necessary. In design mode, go to the Page Setup tab. In the Display subtab from the third group of subordinate tab, use Page mode and Quick Display buttons to switch between these modes, as shown in Figure 4.19.

Figure 4.19    View Modes Available in Web Intelligence
Still in design mode, under the Page Setup tab, you have the option to zoom to Page Width or Whole Page (also known as Scale to Page). This is found in the Scale to Page subtab from the third group of subordinate tab.
Both this display mode and zoom features can be found in Web Intelligence status bar.
4.4.4    Status Bar
The status bar is located across the bottom part of the window and provides users with page navigation, as described in Section 4.4.3, but also additional actions and status.

Figure 4.20    Status Bar
Let's explore the status bar, as shown in Figure 4.20, from left to right:


                    SAP App Center: A new element appears in the status bar beginning in SAP BusinessObjects BI 4.1 SP 6 that will take you to the SAP App Center. The icon  resembles a puzzle piece and clicking it will take you to the SAP App Center where you can access Web Intelligence extensions or custom elements (see Chapter 6, Section 6.5) proposed by SAP partners. You'll find quite a few exciting applications designed for Web Intelligence to help you get more out of your SAP software investment.
                

                    Report display: A drop-down menu that allows you to quickly switch to another report of the document. By default, it displays the current displayed report. You may also open the menu and select another report to display it.
                

SAP HANA: Online: If the document is in SAP HANA Online mode, then an SAP HANA: Online button is displayed. In Design mode, you can click this button to switch to SAP HANA direct access (see Chapter 13, Section 13.6.4).
                

Shared Element icon: In design mode, if the selected report element is a shared element, then the Shared Element icon  appears in the status bar to identify the shared element (see Chapter 19, Section 19.2).
                

Track Data Changes On/Off: This button indicates if the track data changes is enabled or not (see Chapter 18, Section 18.6). You can click it to open the Data Tracking dialog box to enable, disable or configure it.
                

                    Page navigation buttons: Use these buttons to go to the first, previous, next and last page of the current report.
                

Quick Display Mode/Page Mode: use these two buttons to switch between quick display mode and page mode (Section 4.4.3). 


                    Zoom controls: Use these buttons to control the page zoom.
                

Refresh All: Click this button to refresh all reports in the document. This button also displays when the last refresh was done. If the refresh has returned partial results (see Chapter 12, Section 12.6), a warning icon  is also displayed.
                

To hide the status bar, you can right click it to open a menu (shown in Figure 4.21) where you can select the components to hide, including the status bar.

Figure 4.21    Status Bar Menu









4.5    Report Property Categories
Have you ever needed to select multiple columns on a report and apply the same formatting to each object? Now you can in SAP BusinessObjects BI 4.2! This feature was introduced in SAP BI 4.1 SP 6 and is a much requested improvement compared to previous versions of SAP BusinessObjects BI 4.x.
Let's take a look at the report formatting categories and the specific functions available within them.
The five major report element formatting tabs in the Web Intelligence ribbon toolbar are as follows:


Report Element


Formatting


Data Access


Analysis


Page Setup


Each tab contains a series of related functions that make it easy to locate specific features based on the category selected. We'll discuss each of these tabs in detail in the coming sections.
4.5.1    Report Elements
The Report Element tab offers many shortcuts to the most frequently used objects in a report: tables, charts, and predefined cells. When a report element is selected on the Report Panel, you'll see that the Report Element tab on the toolbar displays specific icons for the type of element selected. Figure 4.22 shows two additional tabs (Table Layout and Behaviors) containing icons to format a table when a table object has been selected.

Figure 4.22    Selecting a Table Displays Additional Tabs on the Report Element Toolbar
Report elements allow report developers to add data to the canvas and create robust visualizations for users. You can quickly convert an existing table to a chart or convert an existing dimension column into a section. Follow these steps to convert a table into a bar chart:


                    Select an existing table from the canvas.
                

                    Select the Tool tab on the Reports Element toolbar.
                

                    Select the Turn Into icon, and then select Bar Chart.
                

The table has been converted into a bar chart. Note that there are two tabs added to the Report Element tab on the toolbar. If a chart is selected, then Chart Style and Cell Behavior appear on the toolbar.
4.5.2    Relative Position and Object Alignment
Proper element alignment and relative positioning will improve the overall attractiveness and effectiveness of your reports. When business users view reports that contain charts and data tables aligned in unusual ways, the reports aren't usually as convincing as well-designed and properly formatted reporting documents.
Use the alignment functions to format the placement of report elements and the Relative Position feature to maintain consistent spacing and alignment when one or more blocks or report elements exist on a report.
Figure 4.23 shows the alignment types available when two or more report elements are selected:


Align Left


Align Center


Align Right


Align Top


Align Middle


Align Bottom


Relative Position...



Figure 4.23    Align Types from the Position Tab under the Report Element Tab
The Relative Position... setting allows two report elements to be tied together and spaced by a selected number of pixels (inches).
To set up relative positioning, select a secondary report element, and then select Relative Position... from the Align icon under the Position tab. Figure 4.24 shows the Relative Position... properties of a table in a report.

Figure 4.24    Relative Position Properties for a Table
Follow these steps to assign a position to a chart or table within a report:


                    Select Left edge of report, Right edge of report, or None from the first box at the top, and then select Top edge of report, Bottom edge of report, or None from the bottom setting.
                

                    Select the object(s) to assign the relative distance to.
                

                    Choose the relative distance for both the top section and the bottom section.
                

Relative positioning of charts and data tables gives report developers the flexibility to present data in a similar format when the amount of data being reported fluctuates as filters and input control values are selected and reselected.
4.5.3    Formatting
The Formatting tab on the ribbon toolbar gives report developers many formatting functions, such as font size, styles, borders, alignment, and much more. The Tools tab allows report developers to copy the format of previously produced components onto new components. Figure 4.25 shows the Font, Style, Alignment, and Tools tab icons under the Formatting tab.

Figure 4.25    Formatting Toolbar
Under the Tools tab, there are three icons that help report developers when duplicating report elements:


Format PainterAllows for duplicating formatting from one object and applying it to another object.
                

FormattingDisplays all formatting options for the selected report element.
                

Clear FormatResets all formatting to the default formats.
                

Follow these steps to duplicate formatting from one cell to another:


                    Move the Document Name predefined cell from the Report Elements • Cell tabs onto the canvas.
                

                    Select the newly added cell by clicking on it.
                

                    Select the Format tab and, under the Style tab, select Italic and Underline. Then change the text color to red.
                

                    Place the Last Refreshed Date predefined cell from the Report Elements • Cell tabs onto the canvas.
                

                    Select Format Painter from the Formatting • Tools tabs, and apply the Document Name cell format to the Last Refreshed Date cell. Figure 4.26 shows a column selected in a vertical table and the Format Painter icon selected.
                


Figure 4.26    Applying Formatting from One Cell to Another

Note
You can copy and duplicate cell formats to any type of objects. You can also duplicate table and chart formats. Formatting report elements provides a consistent appearance for ease of use.

4.5.4    Data Access
The Data Access tab on the toolbar provides functions for accessing the query panel, purging data retrieved by a query, refreshing queries, managing data providers, creating new variables, and merging dimensions from multiple data sources. New in SAP BusinessObjects BI 4.2 SP 3 is the option to assign a reference to a value in a cell. The Assign Reference function will appear greyed-out until a cell is selected. References can be created from column headers, a value in a data table, or the contents of a free-hand cell. The benefit of this type of reference is that you'll be able to use the new referenced value throughout the document in various report elements. References are described in more details in Chapter 11, Section 11.6.
Whether your data comes from a centralized universe, SAP HANA view, or simply from an Excel file, it's important to understand when to refresh, purge, or redefine data providers.
By restricting the amount of data returned from a data source, report developers can manage the query performance in the report while constructing it. A good way to achieve this is by understanding how much data is needed per data provider. When multiple data providers are generated for a particular report, developers may choose to refresh or purge individual data providers to increase the performance of the report.

Figure 4.27    Purge Menu under the Data Access Tab
Follow these steps to purge the results from an individual data provider:


                    Create two data providers, and refresh all data.
                

                    Click on the Purge dropdown arrow. As shown in Figure 4.27, the menu displays the document data providers.
                

                    Select the data provider to purge or Purge All to purge all data providers.
                

You'll now have data from only the other data providers.
Reports with secure and confidential data should be purged before they're published to the SAP BusinessObjects BI platform. Users with the appropriate permissions will be able to refresh the reports and retrieve the results. Users without the necessary permissions won't be able to see the data because the reports were published after the results were purged.
It's also important to purge the results when publishing prompted reports to the SAP BusinessObjects BI platform. Saving reports with data will eventually take up a significant amount of space if results are saved inside a report.
4.5.5    Analysis
The Analysis tab on the ribbon toolbar offers functions for interacting with the report data. Filtering, ranking, input controls, grouping, breaks, sorts, drilling, outline, and functions provide a robust way to interact with report elements, and they're all available within this tab.
By using a combination of these analysis functions, you'll be able to customize and filter report data to meet business requirements and greatly enhance the user experience. By applying detailed customizations in a report, you can create a reporting solution that can be easily consumed by users at different levels in the organization. Figure 4.28 shows the expanded More button under the Functions subtab of the primary Analysis tab to apply basic calculations on measure columns in tables.

Figure 4.28    Expanded More Button under the Functions Tab
These predefined functions are Average, Min, Max, and Percentage.
Follow these steps to create an aggregated value in a data table:


                    Create a table with a numeric measure object column.
                

                    Select the column to apply the sum to.
                

                    Click on Sum under the Function tab, and then check Sum.
                

A new row appears at the end of the table with the column summed up, as shown in Figure 4.29.

Figure 4.29    Sum Table Column
4.5.6    Page Setup and Layouts
Page margins in a Web Intelligence report can be modified to fit almost any business requirement or standards. Adjust the margins by changing the default settings exact sizes in inches or centimeters. Many enterprise reporting teams will design reports to fit a consistent appearance and style including a precise and repeatable margin size. The default margins in a report are as follows:


                    Top margin: 0.79 inches or 2 cm
                

                    Bottom margin: 0.79 inches or 2 cm
                

                    Left margin: 0.79 inches or 2 cm
                

                    Right margin: 0.79 inches or 2 cm
                

You can adjust the margins by accessing the Margins subtab in the primary Page Setup tab. Locate the margin properties, and then use the up or down arrows to change the size.
The changes take effect when you click off of the size adjustment arrows. Figure 4.30 shows the margins properties and highlights the top margin adjustment arrows for modifying the margin sizes.

Figure 4.30    Adjusting Page Margins
Report property categories are functional groupings for formatting icons based on their functional area. These groupings in tab format make it easier for the report designer to access the needed functions.









4.6    Summary
Web Intelligence provides a full spectrum of reporting components as well as a full line of functions to format every element to a customized look and feel. Users and report developers can now access several different formatting tools from multiple ways. This includes toolbars, right-click menus, the side panel, and the status bar. An example of the multiple ways of performing a function is the Refresh button. This feature can be found in three different locations: the status bar, the Data Access/Data Providers subtab on the ribbon toolbar, or the reading mode toolbar.
New features in SAP BusinessObjects BI 4.2 take major strides to creating a collaborative reporting environment with Shared Elements and Comments. Tracking data changes, adding conditional formatting to data values, and assigning references to significant data points are just scratching the surface of the useful features in the latest edition of Web Intelligence.
Chapter 5 describes how to display data in tables in a Web Intelligence report. Tables are powerful reporting elements and the primary method for delivering data to users. They can also be quickly and precisely formatted by using the icons located on the new ribbon toolbar.








5    Displaying Data with TablesTransform business information into analytical data-rich reports with data tables in Web Intelligence. Whether you're displaying 100+ columns of extensive details or writing highly formatted summary reports, you'll find what you need to create valuable reports for your users. You can strategically group, break, and position data tables and freehand cells in the Report Panel to convey information in the most meaningful ways.Displaying data in meaningful ways is the ultimate goal of Web Intelligence and it's done by inserting result objects into any of four different data table types or 34 different chart types known in the Report Panel as Report Elements. Now in SAP BusinessObjects BI 4.2 SP 4, you'll be able to create more advanced reporting documents than ever before by using new features such a geographical charts, shared elements, and the ability for users to add comments to a report. You'll be able to use any combination of these elements to craft the perfect presentation of data in a report.This chapter focuses on presenting data and how to create reports made from data table report elements, the various pre-defined freehand cells—including the new Comments features—and the various uses of blank cells. We discuss charts in detail in Chapter 6 and Chapter 7.Figure 5.1 shows the tables available in the Report Panel for displaying rows and columns of data. The four table types are Horizontal Table, Vertical Table, Cross Tab (or cross table), and Form. Each table contains an extensive set of properties that can be modified to allow for detailed reporting customizations.After you refresh a query for the first time in a new document, by default the full list of result objects will be displayed in a vertical table in the Report Panel. All subsequent refreshes that include additional fields in the Result Objects pane of the Query Panel won't automatically be added to a report. However, the new objects will appear in the Available Objects tab on the left panel. These objects can be easily added to new or existing report elements by dragging them from the Available Objects pane and then dropping them onto charts or cells in a data table or by using the Assign Data wizard.
Figure 5.1    Tables Available for Displaying Data
Tip
The Available Objects tab is used to maintain the list of result objects and variables available to be added to report element tables and charts. These objects can be sorted alphabetically, by query, or by data source folder (see Chapter 8, Section 8.6).
Figure 5.2 shows the default appearance of data as it appears in the Report Panel when five result objects are added to the Query Panel in the initial refresh of a document.After running a query for the first time, a report will be created by default with a blank cell report element and given the underlined title "Report 1" to make it easy to locate. You can edit the cell to include a title that more accurately describes the report, move it to a more ideal location, change the format of it, or simply remove it.The blank cell element is found in the Report Elements tab and under the new Cell subtab, as pictured in Figure 5.3.
Figure 5.2    Default Display in the Report Panel
Figure 5.3    Finding the Blank Cell Report ElementThe blank cell element has various potential uses in a report and can be used to page numbers, titles or subtitles, instructions to users, or confidentiality statements. Basically, just about any type of message that you'd like to display on a report can be done with the blank cell element, including values or dimensional information retrieve from your data provider. An example of this type of functionality is accomplished by adding formulas and result objects to the report title.Dynamic labels based on user selections made from input controls or simple filters are an excellent way to provide richer context to a report. Creating well-labeled reports can be extremely important, especially if important business decisions are going to be made when using them.An example of a dynamic label can be created by using one of the following formulas. The DrillFilters formula is used when you've added simple filters to your report while the second formula example is used when you have an input control for the City object, as follows:

=DrillFilters (" / ")


=If(Count([City])=1;[City];"All "+Count([City])+" Cities")

Chapter 11 focuses on writing formulas and variables to solve business problems. This chapter offers examples and syntax explanations to give you the tools to create your own set of valuable and creative calculations.So, let's first examine how to effectively use tables to convey data to the reader.
5.1    Using Tables
Tables are the reporting components used to present data to business users and provide many customizable properties to help you quickly format the way data appears in a report. It's important that you're able to display data in a format that best fits your requirements, your organization's visual style, and in an arrangement that makes it clearly understandable. Let's get started by looking at the tools and functions available to you to begin editing the various attributes of a table.
Figure 5.4 shows options available in the Table Layout subtab when you click on an existing table. This subtab is found in the primary Report Element tab and on the far right side.

Figure 5.4    Table Layout Subtab in the Report Element Tab
These properties are available in two primary categories, which are represented as tabs:


Table Layout


Break: Allows for the adding and removal of breaks.
                    

Insert: Allows for inserting rows above, below, left, or right of the position of the cursor on an active table.
                    

Header: Toggles the table header on and off.
                    

Footer: Toggles the table footer on and off.
                    



Behaviors


Hide: Hides the selected dimension or conditionally hides the entire table. Choose from:
                        

Hide


Hide when Empty


Hide When...: Write a formula to hide a table or chart when a specific condition defined in this selection is met.
                            



Page Break: Inserts a page break to avoid a page break. Choices include:
                        

Start on a New Page


Avoid Page Breaks




Repeat: Allows repeating table on every page and for repeating selected columns or rows. Choices include:
                        

Table on every page: Sets the table to repeat on every new page.
                            

Header on every page: Used to repeat the table's header on top of each page. This is a very useful setting when your row counts exceed 100 or the number of rows set as the maximum per page since, by default, headers are displayed only on top of the first page.
                            

Footer on every page: Used to repeat the table's footer on every page.
                            





5.1.1    Adding Report Elements While Designing Reports
To add a report element to a report, begin by entering Design mode to reveal the full set of functions in the toolbar. Next, click a table element that you'd like to add from the Table subtab under the Report Element tab and place it onto the Report Panel. The location you select is not permanent; later you'll be able to define its relative position on the page.
Figure 5.5 shows the shortcut icons used to access the different types of data tables that can be included in the main Report Panel.

Note
While designing a report, you can right-click anywhere on the Report Panel or report canvas and click on Insert from the menu to add a specific data table type or chart from the list of choices.

After selecting a table from the Report Element tab, choose a general location on the report canvas to place it. Adding an empty table to your report is just a starting point for custom report creation. You can always move the table to a more precise location at any point in the editing/designing process.

Figure 5.5    Shortcut Icons to Add Report Elements
Figure 5.6 shows a vertical table being placed on a report.

Figure 5.6    Vertical Table Report Element Being Added to a Report
After a table has been added, you can begin assigning result objects to the table by clicking on the Available Objects tab on the side panel and then dragging available objects and dropping them onto the table element you recently added.
Figure 5.7 shows the State result object being added to an empty cross table while designing a report.

Figure 5.7    Dragging and Dropping the State Object to Add It to a Vertical Table
Utilizing the Assign Data Feature to Add Objects
Another workflow for adding objects to a table is to right-click on the report element and select the Assign Data command from the contextual menu. This method is perhaps the easiest and fastest way to assign objects to a table or chart.

Note
You must be in Design mode to add objects to tables and charts. Reading mode is for viewing only.

5.1.2    Manage Table Properties
Every table type has an extensive list of properties to allow for modification and customization. Figure 5.8 shows the properties associated with a vertical table. In addition to table properties, specific elements within tables can be modified.

Figure 5.8    General Properties of a Vertical Table
To access table properties, right-click on the table element and then select Format Table.
General Property
The General property pane contains a Name setting that allows you to rename the selected block. Figure 5.8 shows the name "Block 1". Click on the name to replace the default name with a new name of your choice.

Tip
If relative positioning will be included in your reports, it's a best practice to rename your table and chart blocks with a descriptive or meaningful name. Because Web Intelligence provides a default name for all objects, setting up relative positioning can become confusing without descriptive or meaningful names assigned to each object or block.

Border Property
The Border property pane allows you to modify many border aspects of a table. You can add a border using the Style subtab within the primary Format tab or by right-clicking to select the Border grouping in the Format Table window. You can specify a border style, thickness, and color for the table border. Figure 5.9 shows the properties that can be specified for table borders.
Appearance Property
The Appearance property pane allows you to modify many visual aspects of a table. Figure 5.10 shows the following properties that can be adjusted for table appearances:


Background Image


Color: Changes the background color of headers, rows, columns, or cell spacing if the spacing is set to 1 pixel or greater.
                            

Pattern: Applies one of these four background images to a selected table section:
                                
None
Skin: Curve, SAP BusinessObjects, Dots, Draft, Final Copy
Image from address: Prompts you to choose display and position of image after entering the URL.
Image from file: Prompts you to browse for a local or network image.
Figure 5.9    Border Properties of a Vertical Table





Spacing and Padding: Changes the space format of the cells by modifying the following settings:
                        

Horizontal: Modifies the cell spacing of a table (default spacing value set at 0 inches).
                            

Vertical: Modifies the cell spacing of a table (default spacing value set at 0 inches).
                            



Alternate Color: Adjusts the frequency and color of the alternate row or column coloring.
                    


Figure 5.10    Appearance Properties of a Vertical Table
Layout Property
The Layout property pane allows you to assign a variety of positioning settings to report elements in a report. Figure 5.11 shows the properties that can be specified for table layouts. Following is a complete list of page layout properties for both a horizontal and vertical table layout:


Start on a new page: Sets the block to start on a new page.
                    

Avoid page break: Fits the table on one page where possible.
                    

Repeat on every page: Sets the cell to repeat on every new page.
                    

Repeat header on every page: Repeats the table header on every page.
                    

Repeat footer on every page: Repeats the table footer on every page.
                    


Figure 5.11    Layout Properties of Vertical and Horizontal Tables
You can assign the upper-left corner of a table, chart, or cell to another block by choosing two settings in the Relative Position section of the Layout screen: the left edge and the top edge.
5.1.3    Grouping
One of the most exciting features introduced in SAP BusinessObjects BI 4.1 was the capability to create custom groups of dimensional values. Previously only available in Desktop Intelligence, this simple, but extremely powerful, feature was one of the most requested functions by Web Intelligence report developers.
Up to this point, you would have had to write compound IF statements in a formula or variable to accomplish custom grouping. Depending on the number of conditions, this methodology could become a lengthy and manual process. But now in SAP BusinessObjects BI 4.1 and 4.2, custom groupings can be created with ease.
The reason that grouping is featured in this chapter on displaying data with tables is because you must be working within a data table in order to create a new custom grouping.
Figure 5.12 shows the Group function located in the primary Analysis tab and Display subtab. In the image, the City object is selected from a vertical table and then the Group function becomes enabled. As with all other changes, grouping must be added while in Design mode.

Figure 5.12    Creating a New Custom Group Based on a Dimension Object

Note
A dimensional object must be selected from a report element data table before the Group function will become enabled.

After selecting a dimensional object and clicking the Group function, the Manage Groups window, as shown in Figure 5.13, will appear. This is where you'll have an opportunity to select a custom set of values and add them to the same group.

Figure 5.13    Managing Custom Groups
Steps for Creating Custom Groups
The following are the two basic ways to create custom groups:


                        Select all dimensional values and then uncheck the unneeded values.
                    

                        Select only the values that should be assembled into the same group.
                    

After the desired combination of values has been selected, click the Group button to assign them to a group. By default, the New Group name will be the first value selected followed by a + symbol. This name can be easily changed to something more meaningful.
Figure 5.14 shows the New Group window with the default name of the group being added. Change the name to a word or phrase that will clearly describe the collection of values to your users. Click OK to confirm and proceed.

Figure 5.14    Naming a New Custom Group
After a new group has been created, the group name will be displayed along with all the other values available in the dimension object. This helps you to identify the remaining values that have not been assigned to a group, as shown in Figure 5.15.

Note
After setting up the first group, you have three options:


                            Create additional groups for values that have not been assigned to a group.
                        

                            Leave the values as they are so individual dimensional values can be compared to the new custom group(s).
                        

                            Assign the remaining values to an Others group.
                        



Figure 5.15    Dimension Objects with Custom Groups Listed
The final option just listed, assigning the remaining values to an Others group, is done by first clicking the Ungrouped Values button in the Manage Groups window.
The next step is to select the Automatically grouped option, as displayed in Figure 5.16. Selecting this choice will prompt you to enter a group name for the remaining values. The default name of "Others" can be changed to a more meaningful word or phrase.
Now all values will have a group name associated to them. Figure 5.17 shows all of the City objects with a group name assigned to them.

Figure 5.16    Assigning Ungrouped Values to be Automatically Grouped

Figure 5.17    All Values with a Group Name Assigned
Custom Group Values in a Table
After creating your new group(s), you'll see the group names as column values in your data table. This can help you aggregate values to fit custom business requirements and even create custom hierarchies by combining groups with breaks. Figure 5.18 shows the table with the new group added.

Figure 5.18    Custom Group Values in the Data Table
After a group has been created, you can perform any of the following tasks:


Move to Group: Click a specific value to assign it to a different group.
                    

Ungroup: Return the grouped dimension to its original state.
                    

Rename the selected Group: Change the group name of the value selected.
                    

Ungrouped Values: Toggle between making the ungrouped values either Visible or Automatically Grouped.
                    

Manage Groups: Launch the Manage Groups window so you can regroup dimensional values.
                    

These options are available by clicking on a grouped object and then clicking the small down arrow beside the Group icon in the Analysis/Display tabs (see Figure 5.19).

Figure 5.19    Interacting with an Existing Custom Group
Next we'll discuss another simple yet handy feature added earlier in SAP BusinessObjects BI 4.1: freezing header rows and columns.
5.1.4    Freeze Header Rows and Columns
With the primary strength of Web Intelligence being its ability to handle large data sets and crunch results in highly customized reports, freezing headers has been a much requested feature for several years.
Freezing headers is helpful because it keeps the header of a data table visible as you scroll through a report to review results. In the past, an analyst might be reviewing results with several hundred rows of data and then lose track of the column names. This is no longer a problem when you enable the new Freeze Header Rows and Freeze Left Columns settings.
Enabling Freeze
Freezing headers is one of the few features that isn't enabled while in Design mode; this option can only be enabled when reading a report.
There are only two requirements for enabling freeze headers:


                        View the report in Reading mode.
                    

                        Select a data table.
                    

Even in Reading mode, the Freeze option will be disabled until either a table header or the table values are selected. Figure 5.20 shows the Freeze icon in the toolbar while it's disabled. The Freeze function will be disabled until a data table is selected. That's because multiple blocks can appear on the same report with each having different freeze settings.

Figure 5.20    Disabled Freeze Icon
Clicking anywhere in the table will enable the Freeze icon to make it clickable. Clicking Freeze will set the Freeze Header Rows option to on. Clicking it a second time will turn it off.
With a row or column in a table selected, click the small downward arrow to examine the additional Freeze options. From here, you'll be able to turn the Freeze Header Rows option to either on or off (checked or unchecked) and also to enable Freeze Left Columns. You'll have the option to freeze up to the first five columns in a table with this feature enabled. Figure 5.21 shows these options.

Figure 5.21    Freeze Options
Freezing columns is a useful feature when analyzing reports containing a large number of columns. As you scroll to the right to view the values in each additional column, the first five columns can be configured to display at all times, making analysis easier.
Figure 5.22 shows a small table with Freeze Header Rows enabled.

Figure 5.22    Scrolling through a Report with Freeze Header Rows Enabled
Freezing one left column is shown in Figure 5.23 while a report is scrolled to the right. Frozen columns are easily identified with a subtle shadow on the right edge.

Figure 5.23    Scrolling through a Report with a Frozen Column
The next section discusses the types of data tables available for you to use in the Report Panel of a Web Intelligence reporting document.









5.2    Table Types
Four table types are available in Web Intelligence:


Horizontal Table: Header cells are listed on the left of the table.
            

Vertical Table: Header cells are listed on the top of the table.
            

Cross Table: Dimensions are listed across the top and along the left side of the table. Measures are displayed in the body as a cross-section of the charted dimensions. These are also known as crosstabs.
            

Form Table: These tables are commonly used to display small groups of related information such as addresses or employee information.
            

Let's take a look at each table type.
5.2.1    Horizontal Table
Figure 5.24 shows a horizontal table populated with four result objects: State, City, Sales revenue and Quantity sold.

Figure 5.24    Horizontal Table Populated with Four Result Objects
5.2.2    Vertical Table
The vertical table and the cross table are the most commonly used tables. Figure 5.25 displays a vertical table populated with the same result objects as in Figure 5.24.

Note
You can easily add vertical tables to a report by selecting multiple result objects in the Available Objects tab and then dragging and dropping them onto the Report Panel.


Figure 5.25    Vertical Table Populated with Four Result Objects
5.2.3    Cross Table
Figure 5.26 shows a cross table with two dimension objects and a measure. This table type is used to show one or more measures for at least two dimensions. Cross tables are often referred to as pivot tables because of their ability to pivot or switch the dimension objects from the top and left sides of the table.

Figure 5.26    Cross Table with Two Dimension Objects and a Measure
Figure 5.27 shows a cross table that contains the same fields as in Figure 5.26, but the dimension objects across the top and along the left side of the table have switched positions to provide the user a different perspective when analyzing the data.

Figure 5.27    Swapping the Dimensions in a Cross Table
5.2.4    Form Table
A form table is most commonly used to display information relating to customers, employees, addresses, or other sets of closely related fields and objects. It is recommended that you add a dimension object at the top of the form table with detail objects added beneath the related dimension item.
Figure 5.28 shows where to drop an object in a form table so it appears as the second dimension in the table.

Figure 5.28    Object Added to an Existing Form Table
Figure 5.29 shows the finished result of the action displayed in Figure 5.28.

Figure 5.29    Form Table Displayed with Three Result Objects
The next section discusses the process of converting or turning existing report elements into different display types. You can turn charts into cross tables or vice versa in just a few clicks.









5.3    Converting Table Formats and Types
Tables can be quickly converted to other table types or report element types by right-clicking on a table and selecting Turn Into. Figure 5.30 shows a vertical table selected and the right-click menu displayed.

Figure 5.30    Right-Click Menu with a Table Selected

Note
To copy and paste a report element, right-click on the table or chart and click on Copy. Then right-click in the Report Panel and click on Paste.
The commonly used procedure of pressing [Ctrl)+[C) followed by [Ctrl)+[V) can also be used to copy and paste report elements in the Report Panel.

When a report is in Design mode and Turn into is selected by right-clicking on a table or chart, a More Transformations... option will be displayed to provide users with more report element choices outside of the six types listed. This option allows you to change the data table to any table or chart with one more click.
Figure 5.31 shows the Turn Into window that is used to convert the current report element to a different element or component type. This option is available when More Transformations... is selected.
The current report element type is selected by default, and a visual representation of the element type appears, as shown in Figure 5.31.

Figure 5.31    Turn Into Window for More Transformations
The next section discusses the use of single blank cells in a report.









5.4    Blank Cells, Predefined Cells, and Comment Cells
Blank and predefined cells are flexible report elements that can be used for a variety of purposes. These cells can be placed anywhere in the report canvas and can be used for many functional reasons such as displaying informational text, last refreshed dates, titles, page numbers, and listing drill filter selections and values, just to name a few. Use blank cells to be as descriptive in your reports as possible.
5.4.1    Blank Cells
Blank cells, as shown in Figure 5.32, can be used to enhance reports by providing many different descriptive pieces of information. Examples of common uses for blank cells include adding them to display headings, subheadings, instructions, contact information, refresh dates, text labels, single values, formulas, or calculations.

Figure 5.32    Blank Cell Element Provided in the Report Element Tab
Insert the blank cell report element to strategically place text labels, headings, or other custom values in a report to provide a better context for report consumers. With the blank cell element, you also have the capability to create hyperlinks to other reporting documents, link to an SAP BusinessObjects Dashboards Flash object, or link to a website.
Chapter 15 goes into more detail about hyperlinking in reports.
5.4.2    Predefined Cells
The following nine predefined cells are available in the Cell subtab under the primary Report Element tab. You can use these cells to insert a specific element of information into a report by inserting the object into the report canvas:


Comment: Provides report developers with the option of adding a comment space to a report while in Design mode. Comments can be applied to charts or tables while in Reading mode, but by adding a comment in Design mode, a predefined space is reserved specifically for comments.
                

Document Name: Displays the name of the Web Intelligence document. The DocumentName () formula is used in this object.
                

Last Refresh Date: Object used to display the last refresh date of the query in a Web Intelligence document. If two or more queries exist in the document, a Data Provider window will prompt you to select the query to identify the last refresh. The LastExecutionDate () formula is used in this object.
                

Drill Filter: A single cell object containing the DrillFilters () function. This function becomes useful when dynamic headings or subheadings are required to display the dimensional selections made by users when objects are added to the report filter toolbar.
                

Query Summary: Provides many details relating to the query or queries in the document, including query name, universe name, last refresh date, execution duration, number of rows retrieved, and result objects returned. The Query Summary () function is used in this object.
                

Prompt


Summary: Displays the details of prompted filters. The PromptSummary () function is used in this object.
                        

Prompted Responses: When prompts are added in the Query Panel, answers to the prompts can be easily captured after a report is refreshed and placed onto a report for more context to assist users when analyzing data in reports. This often overlooked feature was previously introduced in SAP BusinessObjects BI 4.1 and continues in SAP BusinessObjects BI 4.2. The syntax used in this predefined condition translates to UserResponse("prompt text").
                        



Report Filter Summary: Provides details on the filters used in the Report Panel of a document. The ReportFilterSummary () function is used in this object.
                

Page Number: Uses the Page () function to display the page number.
                

Page Number/Total Pages: This cell uses the following functions concatenated together to display the current page number followed by the total number of pages in the document: Page()+"/"+NumberOfPages (). The end result will be displayed as 1/16 for page 1 of 15. This formula can be modified to display Page 1 of 16 rather than 1/16 by using the following formula:
="Page "+Page()+" of "+NumberOfPages().
                

Total Number of Pages: Displays the total number of pages in a report. The NumberOfPages () function is used in this object.
                

Figure 5.33 shows all available predefined cells that you can select and drop onto the report canvas.

Figure 5.33    Predefined Cells in the Ribbon Toolbar under the Report Element Tab
5.4.3    Comment Cells
A new addition to SAP BusinessObjects BI 4.2 is the predefined Comment cell. This feature brings a new level of collaboration and analysis to reports. Users can now share their findings, communicate a new discovery on a data point, or make a recommendation to other users-all while only reading a report. Comments are maintained inside the new comments section in the left pane.
The Document cell can be added and placed strategically on a report while in Design mode. It can be selected from the Predefined Cells list, as described in previous section. Or you can also click the Insert Comment Cell button located in the Report Element tab, or under the Comment subtab, as shown in Figure 5.34.

Figure 5.34    Inserting a Comment from Design Mode
More details about comments can be found in Chapter 18, Section 18.5.









5.5    Summary
Tables are the components used by Web Intelligence to visually deliver data in a reporting document. Remember that you can use four different types of tables to present data, and you can adjust settings to modify every aspect of a table report element. Now in SAP BusinessObjects BI 4.2, you can quickly and easily add comments to a report, produce custom groupings, freeze header rows and left columns, and capture prompt values entered by users when a report is refreshed.
Tables offer the convenience of quickly adding result objects and variables to a report to view data returned from your queries. Table data can be grouped into sections or include breaks to create visually separate groups—all with a single table report element. Tables also enable users to quickly convert table objects into charts with as few as two clicks, and use blank or predefined cells to enhance reports to display single value calculations, dynamic labels, hyperlinks, and page numbers.
Chapter 6 provides an in-depth discussion of displaying data with charts and describe all of the features in the powerful charting engine of Web Intelligence, along with the new collection of geochart types.








6    Displaying Data with ChartsYou can graphically display business data in Web Intelligence from 34 different chart types available in 14 different categories. Custom elements allow you to write your own charts service.Web Intelligence received a major upgrade in version 4.0 with a new charting engine that provided notably enhanced visual and functional capabilities. Table 6.1 shows how the chart library has grown from SAP BusinessObjects XI R2 through SAP BusinessObjects BI 4.2 Support Pack 4.



                    Chart Type
                

                    XI R2
                

                    XI 3.1
                

                    BI 4.0
                

                    BI 4.0 SP 3
                

                    BI 4.1
                

                    BI 4.2 SP 3
                

                    BI 4.2 SP 4
                





                    3D
                

                    X
                

                    X
                








                    Bar
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Line
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Combined column and line
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Pie
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Area
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    XY Scatter
                


                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Polar
                


                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Radar
                


                    X
                

                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Tree Map
                



                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Heat Map
                



                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Tag Cloud
                



                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Box Plot
                



                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Doughnut
                



                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Bubble
                



                    X
                

                    X
                

                    X
                

                    X
                

                    X
                



                    Waterfall
                




                    X
                

                    X
                

                    X
                

                    X
                



                    Geographic
                






                    X
                

                    X
                



                    Gauge
                







                    X
                



                    Tile
                







                    X
                


Table 6.1    Chart Types in Various Versions of Web IntelligenceBesides a growing chart library, Web Intelligence allows you to select from custom color palettes and extensive formatting properties, enabling you to design reports that meet virtually any business requirement and display standard.For specific requirements, custom elements allow you to develop your own charts for Web Intelligence. This used by SAP partners who propose applications based on this custom element framework.Let's begin by looking at how to add charts to your reports.
6.1    Adding Charts to a Report
You can use two basic methods to add charts to a report, both of which are only available while working in Design mode or while you are editing a report.
The first method is accessed by clicking on the Report Elements tab in the Report Panel and then choosing Chart subtab, as shown in Figure 6.1.

Figure 6.1    Adding Common Chart Components from the Report Elements Tab
The six most commonly used chart categories are available from within the Chart tab: column, line, pie, bar, point, and geography. From this tab, you can quickly add multiple variations of column, line, pie, bar, point, and geography to your reports by clicking the down arrow to the right of each chart category. Figure 6.2 shows the Chart toolbar with the down arrow selected.

Figure 6.2    Column Chart Dropdown Menu
Clicking More will reveal the remaining chart categories—Scatter Plot, Bubble Chart, Box Plot, Radar Chart, Tree Map, Heat Map, and Tag Cloud—as shown in Figure 6.3.

Figure 6.3    More Chart Categories
Another way to add charts to a report is by right-clicking on a report canvas. From the right-click menu, mouse over Insert to view several report elements that can be easily added. This option provides a quick way of inserting a new section, data table, chart, or other type of report element into a report.
Figure 6.4 shows the right-click menu and the choices available after hovering over Insert. After you make your selection from the list of available choices, you are guided to pick an area on the report canvas to place the element. Click on Report Element... to view a menu containing every type of report element.

Figure 6.4    Right-Clicking on a Report Canvas and Then Hovering over Insert
Figure 6.5 shows the Insert Report Element window that provides easy access to every chart type or data table grouped into functional report element categories. Select a report element category from the menu to display the available chart types associated with the selection.
Notice that the tools used for assigning data values to the selected report element are listed on the right side of the window. These tools deliver three basic functions:


Select an objectSelect from any of the available objects in the document. This includes objects retrieved by a query or variables created locally.
            

Add an objectClick on the plus (+) symbol or downward arrow symbol to insert, hide, edit, or select a number format of a numerical object.
            

Remove an objectClick on the X symbol to remove any optional object.
                
Figure 6.5    Inserting a Report Element


6.1.1    Converting Chart Types
You can easily convert charts into data tables or other chart types by right-clicking on a chart object while in Design mode and selecting Turn Into, as shown in Figure 6.6.

Figure 6.6    Turn Into
This method of converting an existing chart or table provides seven choices: Vertical Table, Horizontal Table, Cross Table, Column Chart, Line Chart, Pie Chart, and More Transformations.... Select the More Transformations... option to launch a window that gives you the opportunity to convert the existing chart to any chart group, and then choose from any of the chart or table types.
6.1.2    Modifying an Existing Chart
Many other modifiable properties are available when right-clicking on an existing chart, as shown in Figure 6.7:


CutRemove a chart from a report. Paste becomes enabled after Cut has been selected.
                

CopySelect Copy to begin the copy/paste process of duplicating a chart or data table (you must use this method to copy instead of the commonly used (Ctrl)+[C) command).
                

DeleteRemove a chart from a report.
                

Turn IntoSwitch the existing report element to another chart type or data table.
                

Assign Data...Assign the dimension, detail, or measure objects to the chart.
                

LinkingAdd hyperlinks or element links to other report elements.
                

Start DrillEnable simple filtering to constrain information on reports.
                

FilterAdd a new filter to the selected chart or add a new input control.
                

SortSelect Manage Sorts to define a new sort to apply to the object.
                

HideHide the object, enable the chart to hide when empty, or select Hide When to create a formula and force the object to only be displayed when the criteria defined in the formula is met.
                

OrderLayer objects, including bring to front, send to back, bring forward, and send backward.
                

AlignSelect two or more objects to align the objects by left, center, right, top, middle, and bottom (also available are Relative Position, Show Grid, Snap to Grid, and Grid Settings options).
                

Format Chart...Launch the extensive chart formatting editor.
                

Publish as Web ServiceLaunch the Publish Content window to generate a web service from the values in the selected object. This option is only available from within the Applet.
                


Figure 6.7    Right-Click Menu for Charts
Now that we've covered the basics of adding charts to reports and changing their type, let's review the library chart types that are available to you.









6.2    Chart Types
A single Web Intelligence report can contain any combination of report elements, and multiple charts can appear on the same report. The variety of chart types available provides report designers with the tools needed to create highly customized reporting documents that target the unique needs of displaying complex data while also meeting user requirements. This could mean creating reports with row counts in the hundreds of thousands, building interactive and visual reports that function similar to dashboards, or a combination of both.
This section surveys the different chart types their variations available in Web Intelligence 4.2. Each chart type provides several different modifiable properties for adjusting the area display, data values, palette and style, background, border, and layout.
Additionally, you can make several modifications to the category axis, value axis, plot area, legend, title, and global features of a bar, column, or line chart. These properties are described in Section 6.3.

Sections and Charts
When sections are added to a report, charts containing the section object will break by the section and appear as multiple charts.

6.2.1    Column Charts
Column charts display data vertically and are available in seven different types, including dual axis value, combined, stacked, 3D, and basic columnar style. The following is the complete list of column chart types as they're described in the Web Intelligence Report Panel:


Column ChartA chart constructed of vertically oriented rectangular bars. The heights of the rectangles are proportional to the values associated with different category items.


Column Chart with 2 Y-AxesA column chart with two value axes. It allows a part of a data series to be plotted against one axis and a part of the data series to be plotted against the other axis.


Combined Column Line ChartA chart displaying a combination of a column chart and a line chart. The chart types share the same value axis.
                

Combined Column Line Chart with 2-AxesA chart displaying a combination of a column chart and a line chart. The chart types have their own value axis.
                

Stacked Column ChartA chart constructed of vertically oriented and stacked colored rectangular bars. The heights of the rectangles are proportional to the values associated with different category items. Rectangles are colored according to legend entries.
                

100% Stacked Column ChartA 100% stacked column chart with data displayed as parts of a whole (as percentages). A whole is a column, and a series is a subdivision of the column.
                

3D Column ChartAn XYZ column chart. The secondary category axis represents an additional analysis category item.


Column Charts
Column charts, which compare dimensional values from at least one measure and dimension object, are the most commonly used chart types for this task. These chart types include more than 200 adjustable properties for customizing chart objects to fit into any visual style.
In fact, 3D column charts allow the same type of comparisons but with a different visual effect. Although 3D chart types are less commonly used than standard column charts, they still provide a useful alternative for communicating results. With a 3D chart, an optional secondary value can be included to visually compare results. Figure 6.8 shows a standard column chart and a 3D column chart with a secondary measure value on the same axis.
Charts are populated with data after they've been added to the report canvas. After you've added the chart, right-click on a chart and then select Assign Data from the menu of available choices. Begin assigning dimension or detail objects to the Category Axis section and measure objects to the Value Axis section.

Figure 6.8    Column Chart and 3D Column Chart
Figure 6.9 shows the Assign Data... window used to connect data objects to chart elements. You can assign multiple dimensions and measures to a single chart element, and you can change the column color using the Region Color option.

Figure 6.9    Assigning Data to Chart Elements
Dual Value Axes Column Charts
Report designers have several options for displaying multiple measure objects within a single chart. Multiple measures can be displayed in charts on the same axis, but if they have a significantly different factor, they should be displayed on a different axis for readability. Dual value axes chart types are available to handle this requirement.
Figure 6.10 shows a column chart with two Y-axes and a combined column line chart with two Y-axes. Though both charts display the Margin and Sales revenue object data, only the version on the right includes a line chart to differentiate the values.

Figure 6.10    Displaying Data in Dual Value Axes Charts
Stacked Column Charts
Stacked column charts are also used to display values from two or more measure objects simultaneously. These chart types should include measure objects representing individual parts of a whole. The 100% stacked column charts also display values as part of a whole but with a 100% scale. Each column in a 100% stacked column chart represents the total value, while the stacked items are the individual parts. Figure 6.11 shows a stacked column chart and a 100% stacked column chart that both contain the Margin and Sales revenue objects charted by month. You can mouse over each charted data element to view the dimensional description and value of the item. This feature exists for every chart type and is beneficial to users when analyzing data subsets. When drill is enabled, the charted columns and category axis values can be used to navigate up and down the hierarchy of dimensional objects as preconfigured in the universe.

Figure 6.11    Stacked Column Chart and 100% Stacked Column Chart

Note
When drill is enabled, mouse-over information for charted measures is displayed. This information is replaced with a statement indicating what will occur if the column is clicked. The message displayed on mouse-over with drill enabled will generally read, drill up to <dimension object name> or drill down to <dimension object name>.
You must disable drill to view the charted values on mouse-over.
Refer to Chapter 10 for more information about drill analysis.

One requirement of the stacked column chart is to include at least two measure objects and a dimension or detail object. Without a second measure object, the chart will function as a standard column chart.
The 100% stacked column chart also requires at least two measure objects. With only a single measure object, every column would convert to 100%.

Using Column Charts
Column charts are useful when comparing values of single dimensional objects or dimensional groups for a greater depth of analysis.
The following are a few key advantages of using column charts to display data:


                            Quickly identify the highest value by spotting the tallest column
                        

                            Quickly identify the lowest value by spotting the smallest column
                        

                            Easily compare column sizes
                        


A second dimension object can also be added to a stacked column chart. Visual groupings in the category axis are created when a second dimension object is added. Figure 6.12 shows a stacked column chart with two measures and two dimensions while hovering over the charted revenue value for May.

Figure 6.12    Stacked Column Chart with Two Dimensions and Two Measures
6.2.2    Line Charts
Line charts are commonly used to measure performance over time. When you measure values using line charts, you can quickly identify upward and downward trends over time intervals, reoccurring patterns, and spikes of proportionally high and low values.
Line charts allow users to pinpoint patterns and quickly identify points in time when significant trends start, end, and peak. One method that can be used to easily identify when trends are significant is to add a variable to a line chart that calculates the average of a measure being charted. By adding this additional object, movement of data above or below the average is easily detected. This method of analysis provides an additional visual indicator for the user and helps demonstrate exactly when a measure began trending above or below an average and whether the trend is worthy of further investigation.
The following are the three line charts, as described in Web Intelligence:


Line ChartAn XY chart that displays lines connecting plots. Value axis plot positions are expressed by analysis category items. The secondary value axis plot positions represent the associated values.


Line Chart with 2 Y-AxesAn XY chart with two axes displaying lines connecting plots. Category axis plot positions signify analysis category items. The value axis plot positions on both axes represent the associated values.
                

Area ChartAn XY chart that displays a surface made up of a connection of plots.
                

Let's examine each of these now.
Line Charts and Line Charts with 2 Y-Axes
Line charts are the standard line charts are the primary component used to display data trends over intervals of time. Use a Line Chart with 2 Y-Axes to display the correlative trend of two measures across a specified period of time. These chart types are used when the values are related but are of a significantly different factor.
In Figure 6.13, a standard line chart is presented along with a line chart with dual axes. Dual axes charts are preferred when measures have radically different data ranges, or in the case of Sales revenue and Quantity sold, when they have different units of measurement.

Figure 6.13    Standard Line Chart and a Line Chart with Dual Axes

Key Applications of Line Charts
The key applications of line charts are as follows:


                            Display data across time
                        

                            Analyze patterns in interval data
                        

                            Identify data shifts in trend data
                        

                            Recognize seasonal cycles
                        

                            Pinpoint high and low spikes in the data
                        


Area Charts
Area charts—previously known as surface charts—are used to provide a visual representation of data made up of connection plots. These chart types are used in similar scenarios as line charts and display a series of data points connected by a line with the area filled in below the line. Area charts and line charts are the only chart categories intended to display contiguous data.
Web Intelligence provides a large number of adjustable properties to modify the appearance of charts. Within these properties is the capability to modify the region type of a chart type. You can access this setting by right-clicking on a chart and selecting Format Chart. Locate the Global property group and select Region Type. From this window, you can change the type to bars, lines, or surfaces. Select Surfaces as the region type to convert it to an area display. In Figure 6.14, the first area chart shows the Sales Revenue object set to Surfaces, and the Margin object set to Bars. The second chart shows the region type set as Surfaces for both measure objects.

Figure 6.14    Combined Area Chart and Bar Chart Compared with Same Measures Both Represented as Area Charts

Note
Surface regions should never be used on both axes of a dual axes chart because the shaded surface area from one value axes will always cover at least a portion of the charted surface of the other axes. Multiple measures with both objects set as surface type will be difficult to analyze for most users.

6.2.3    Pie Charts
Pie charts are used to show dimensional values as a proportion of the whole data set. The pie or donut represents the sum total of a measure, while each slice represents the individual parts that are added to become the whole.
Only one dimension can exist in a pie chart, and values can't represent over 100% of the measure being evaluated. These are the three chart types available in Web Intelligence, followed by their descriptions as they appear in the Report Panel:


Pie chartA circular chart made up of sectors. The area of the circle represents a whole, and the sectors of the circle represent the parts of a whole.
                

Pie with variable slice depthA circular chart made up of sectors. The area of the circle represents a whole, and the sectors of the circle represent the parts of a whole. The sectors may have some depth expressing a third value.
                

Donut chartA chart similar to a pie chart, but it is ring shaped.
                

Let's expand on these further.
Pie and Donut Charts
Pie charts are useful when displaying values as proportions of the whole. Data values in pie charts are displayed in slices for each dimension object value and interpreted as a percentage of the whole. Properties can be configured to display several descriptive data labels, including the value, label, percentage, or a combination of two labels. The data label position can be assigned to appear either inside or outside the pie, and the label layout can be positioned on the side of the pie or in a circular layout.
Other attributes can also be enabled or configured, including the following: 3D look, color palette adjustments, textures, light and shadow effects, background color assignment, and border assignments.
Figure 6.15 shows a standard pie chart followed by a donut chart, with both charts displaying the same measure and dimension object.

Figure 6.15    Pie Chart and Donut Chart
Pie with Variable Slice Depth
A new type of pie chart was introduced in Web Intelligence 4.0 that allows report designers to communicate two values within a single pie chart. This component provides a depth dimension to pie charts and displays values from a second measure through exploding pie slices.
The chart pictured in Figure 6.16 shows values from the Sales revenue and Quantity sold measures in a variable slice depth pie chart by yearly values.

Figure 6.16    Pie Chart with Variable Slice Depth
In the figure, the size of each dimensional slice represents each year's sales revenue as a percentage of the whole group of all three years being reviewed. The depth dimension in the pie chart illustrates the quantity sold by year. It's easy to see a correlation between the two measures when both measures are represented in the same chart.
Charting in Business Reports
When you use variable slice depth pie charts in reports, make sure that the results can be easily interpreted by the intended audience. Misrepresented or misinterpreted data can lead to costly mistakes and potentially catastrophic situations. Always create thoroughly labeled report elements that describe the measures, dimensions, and context of the information being presented. Formula-driven title labels, legends, category values, and data labels should be used when appropriate to thoroughly communicate information to report consumers.
6.2.4    Bar Charts
Bar charts produce an effect similar to that of column charts but display information in horizontal bars rather than vertical columns.
You can use bar charts in reports to compare dimensional information with values from at least one measure and dimension object. These chart types are commonly used to present dimensional values so they can be read easier. Figure 6.17 shows a bar chart with the Sales revenue measure presented by the Lines dimension. You can hover over a bar to see the exact measurement values.

Figure 6.17    Bar Chart
The following bar charts are available for your use:


Bar chartA chart constructed of horizontally oriented rectangular bars. In bar charts, the heights of the rectangles are proportional to the values associated with different category items.
                

Stacked bar chartA stacked bar chart that displays one dimension as a series of bars using multiple color segments to display a second dimension.
                

100% stacked barA stacked bar chart with data displayed as parts of a whole (as percentages). A whole is a bar, and a series is a subdivision of the bar.
                

When adding stacked bar charts to reports, include at least two dimension objects and at least one measure object. Without a second dimension object, the chart will function as a standard bar chart.
The 100% stacked bar chart also requires at least two dimension objects. With only a single dimension object, every column would convert to 100%. You can use this type of chart to present measures as a percent of whole values by a dimension. Figure 6.18 shows Sales revenue by Lines and Month Name, as a standard bar chart, a stacked bar chart, and a 100% stacked bar chart.

Figure 6.18    The Same Data Represented in a Standard Bar Chart, a Stacked Bar Chart, and a 100% Stacked Bar Chart
6.2.5    Point Charts
Use scatter charts to plot the values of two variables and to display the correlation in the style of linear regression. Bubble charts display values similar to scatter charts but with varying sizes of bubbles to represent the values of a third variable. Other types of point charts include polar scatter and polar bubble charts; both of these chart types are used to display data points with a radial axis and an angular axis on a circular charting canvas rather than a standard rectangular canvas. Values are spread over 360 degrees, and data points are plotted between two numbers and then located within bands defined by the second variable.
Polar bubble charts go a step further than polar charts because they display a third value and present the bubbles in varying sizes. The following are the four types of point charts, as described in Web Intelligence:


Scatter plotAn XY chart displaying plots. Plots are positioned with coordinates given by a pair of values. Each plot may have colored symbols representing the analysis category item associated with the values.
                

Bubble chartA two-dimensional chart of points representing a collection of data. Extra variables are represented by the size of the points.
                

Polar scatter chartA chart with one radial axis and one angular axis, where each data point is represented with a symbol. Similar to a bubble chart, but without the sizing of points.
                

Polar bubble chartA two-dimensional chart with one radial axis and one angular axis of points representing a collection of data. Extra variables are represented by the size of the points.
                

Scatter Charts
Scatter charts are used to display the correlation between two measure objects. Depending on the relationship of the charted values, trends can be easily observed that illustrate the strength or weakness in the correlation of the variables used to plot the data points. Many analysts view scatter charts as one of the best components for visualizing data and locating trouble areas to investigate further.
Positive trends are observed when the plotted data points ascend on both the X- and Y-axes, moving from the lower-left corner of the chart to the upper-right corner. This type of trend is pictured in Figure 6.19. The example shows a linear or straight line trend that proves when Quantity sold increases, the Margin also increases. Even though a trend is observed in the plotted points, you can still identify outliers, such as the highly profitable Sweat-T-Shirts.

Figure 6.19    Scatter Chart Comparing Margin to Quantity Sold by Product Line
These findings provide valuable insight into potential revenue issues that deserve additional research. The result of the findings could uncover problems that have caused decreased profits.
Negative trends are observed when one set of data increases while the other decreases. In these scenarios, the plotted data points move in an organized fashion from the upper-left corner of the chart toward the lower-right corner.
If no pattern is observed among the plotted data points, then no relationship exists for the charted variables.
Bubble Charts
Bubble charts produce results very similar to those of scatter charts but with one addition—the potential to add a third variable to the chart to represent the data in bubble sizes. If patterns are observed in the plotted bubbles, then a relationship exists for the variables being charted.
Figure 6.20 shows a bubble chart with the same information displayed in the scatter chart shown in Figure 6.19 but with the addition of increasing bubble sizes to represent the values of a third measure. You can enhance the appearance of the bubbles by making adjustments to several configurable properties available in the Format Chart window. Many of the visual settings can be found when editing settings in the Palette and Style section located in the Global chart settings.

Figure 6.20    Bubble Chart Displaying the Correlation of Sales Revenue vs. Margin
Polar Charts
Polar charts display a series of values grouped by a dimensional result object on a 360-degree circle. Values are measured by their lengths from the center of the chart. The farther the point is away from the center, the larger the value.
Figure 6.21 shows a polar scatter chart with Sales revenue and Quantity sold values plotted by region. The chart plots the values on the 360-degree canvas by the amount of quantity sold and within multiple sales revenue bands on the circular background.
Figure 6.22 shows the same values charted on a polar bubble chart but with a third measure added. The polar bubble chart displays bubble sizes based on the relative size of the values in the Margin object.

Figure 6.21    Polar Scatter Plot with Two Measures Plotted

Figure 6.22    Polar Bubble Chart with Three Measures Plotted
6.2.6    Geographic Charts
Web Intelligence 4.2 introduces three new geographic charts not available in prior versions.
Geographic charts can provide context for geographic data that other carts cannot. To display geographic charts, you must first geolocalize your dimension. This process, geo localization, is described in Chapter 8, Section 8.11. This is done by:


                    Mapping country/region/sub-region/city according to the geography database embedded by Web Intelligence.
                

                    Starting with Web Intelligence 4.2 SP 3, by using latitude and longitude coordinates available in the dataset.
                

Once a dimension has been geolocalized, you can display your data in one of the three types of geographic charts, as described in Web Intelligence:


Geo Choropleth chartThis chart displays values that are represented by colors on a geographic map. The colors of the geographic zones are determined by a measure value.
                

Geo Bubble chartThis chart displays values that are represented by bubbles on a geographic map. The size of the bubbles on each geographic zone is determined by a measure value.
                

Geo Pie chart This chart displays values that are represented by pies on a geographic map. The size of the pies on each geographic zone is determined by a total measure value.
                

Choropleth Chart
Choropleth charts use geographic maps to compare measurements between different geographic entities such as states or countries. Different color values are used to highlight geographic entities to allow easy comparison of high-performing and low-performing geographic entities. Figure 6.23 shows a choropleth chart that shows Sales revenue by state.

Figure 6.23    A Choropleth Chart Showing Sales Revenue by US State
Geo Bubble Chart
Geo bubble charts place measurement bubbles on a geographic map according to the physical location of the geographic entity. Geo bubble charts use bubble size to compare measurements between geographic entities. Figure 6.24 shows a geo bubble chart that shows Sales revenue by city.

Figure 6.24    Geo Bubble Chart
Geo Pie Chart
Geo pie charts position pie charts on a geographic map according to the physical location of the geographic entity. Both the size of the pie chart as well as the size of individual pie slices convey meaning. Figure 6.25 shows a geo pie chart that shows Sales revenue by state and quarter.

Figure 6.25    Geo Pie Chart Showing Sales Revenue by State and Quarter
6.2.7    Box Plots
A box plot chart is a graphical display of a five-number summary based on the distribution of a data set: the maximum, the minimum, the first quartile, the third quartile, and the median. It can also show abnormal values called outliers.
Box plot charts are used to show the distribution of data ranges for a dimension object into five primary groupings. Each chart will also contain a category dimension to axis value. These charts show the following elements of information in a single graphic:


MaximumThe highest value in the chart, excluding outliers.
                

First (or upper) quartileIn the chart, 25% percent of the values are greater than this value.
                

MedianThe middle of the data set in the chart.
                

Third (or lower) quartileIn the chart, 75% percent of the values are greater than this value.
                

MinimumThe lowest value in the chart, excluding outliers.
                

Outliers are displayed in dots and plotted either above the maximum or below the minimum markings. These values can be hidden by checking the Hide Outliers options located in the Plot Area section available when formatting the chart. Figure 6.26 shows the different segments of a charted box plot.

Figure 6.26    Box Plot
6.2.8    Radar Charts
A radar chart (also known as a spider chart) displays several axes starting from a unique origin and with a common scale. Each axis represents an analysis category item. Plots are directly placed on an axis according to the associated values. Plots can be linked by lines.
Radar charts are used to quickly convey the "big picture" of one or more variables through a dimensional object. The primary benefit of radar charts is that they allow the users to analyze several different factors related to a single item. The points closest to the center of the axis indicate low values, while the charted points near the edge indicate high values. Figure 6.27 shows a radar chart displaying Sales revenue by Month.

Figure 6.27    Radar Chart Showing Sales Revenue by Month
6.2.9    Map Charts
Crosstables are effective when it's important to see precise values, but it can be challenging to identify trends and outliers. Web Intelligence provides two map charts—a tree map and a heat map—that use color (in the case of a heat map) or color and size (in the case of a tree map) to visually represent what's happening in the data set.


Tree mapThis chart displays values within nested rectangles that can be colored. The levels of nesting correspond to the level of hierarchical breakdown. The size of the rectangles and their color both express a set of values.
                

Heat mapThis chart displays values that are represented by colors in a map using a category axis and optionally a second category axis. The colors of the rectangles are determined by a measure value.
                

Tree maps are used for displaying hierarchical data to allow users to quickly identify unexpected patterns, exceptions, and significant factors. Data values are then displayed in rectangular areas of varying sizes, color, and position. Figure 6.28 shows a tree map chart with Sales revenue values charted by State and Quarter. You can mouse over the rectangles to show a tool tip that includes the dimension and measure values of the rectangle on the tree.

Figure 6.28    Tree Map Showing Sales Revenue by State by Quarter
Heat map charts also display data in rectangular shapes but with a slightly different way of using color. The box style of charted values is also different in the heat map compared to the tree map. Heat maps let you display data from one or more dimensional category axis values and a single measure object; you can add a secondary category axis value when assigning data to a chart. In Figure 6.29, a heat map is used to show Sales revenue by Quarter by City. Notice how the eye is immediately drawn to New York's revenue in Q3.

Figure 6.29    Heat Map Showing Sales Revenue by Quarter by City
6.2.10    Tag Cloud
A tag cloud is a mono-dimensional visualization representing data as words where the word font size represents its relative weight in the data set. This component displays data values by using only the text data in a dimension or detail object. The size of each dimensional value is determined by the associated measure object.
When assigning data to the component, the Tag Name setting is used to associate a dimension object, and the Tag Weight setting is where the measure object is assigned. Objects used in the Tag Name should contain values made up of either single words or very short phrases for clearly displaying results. A second measurement can be displayed by setting the Tag Family, which uses color. The purpose of the component is to quickly show the prominence of specific dimension values. In Figure 6.30, you quickly see that New York has the most Sales revenue by its size and most Margin by its color.

Figure 6.30    Tag Cloud Chart Showing Sales Revenue by City
A creative and functional use of this component is to anchor an element link to it for passing values to other report elements on the same report canvas.
6.2.11    Waterfall
A waterfall is chart of vertical bars for which each bar starts at the level of the previous one with the goal of showing the cumulative effect of the values of a measure. This type of chart allows you to represent the successive variations of a measure or to show the positive and negative contributions of a measure along the different category items.
Waterfall charts have historically been used for displaying the cumulative effect of sequential values and illustrating the impact of a measure across a dimensional category. This chart type was added to the Web Intelligence 4.0 Feature Pack 3 chart repertoire and continues to receive minor enhancements.
It's customary to include the total values when creating a waterfall chart because many users analyzing data with this type of chart will want to know how the final values relate to the start. The option to include totals as a charted bar is available through a setting in the Format Chart window.
Figure 6.31 shows a vertical waterfall chart that displays Sales revenue by Month where a reference line has been added. The same data also appears in a horizontal waterfall chart that also displays the total revenue for the period.

Figure 6.31    Vertical (Default) Waterfall Chart and Horizontal Waterfall Chart
After launching the Format Chart window, select the General category found in the Global property grouping, and then scroll down to the Calculate and show the total checkbox. Figure 6.32 shows the setting used to add the total value to the waterfall chart.

Figure 6.32    Properties for Calculate and Show the Total and Horizontal Orientation
Web Intelligence 4.1 added settings to make the biggest visual impact for displaying key elements on a waterfall chart:


Start Value Color


Total Value Color


Negative Value Color


Positive Value Color


By changing the default settings of these value colors from automatic to a fixed value, report consumers will have an easier time interpreting the results in the chart. These settings make it much easier to locate which dimensions had the biggest positive and negative impacts on the overall totals. Figure 6.33 shows these properties located in the Palette and Style category.

Figure 6.33    Setting Custom Value Colors in a Waterfall Chart
6.2.12    Gauge
Web Intelligence 4.2 starting with Support Pack 4 introduces three new gauge charts not available in prior versions. The following are the three types of gauge charts, as described in Web Intelligence:


Speedometer A speedometer is a gauge that uses a needle to represent data on a radial scale between a lower and an upper limit.
                

Linear GaugeA linear gauge indicates where a specific data point, the actual value, is located on a linear scale. It features a primary measure that is compared to other measures representing a mandatory maximum value and optional target and minimum values.
                

Angular Gauge An angular gauge indicates where a specific data point, the actual value, is located on a radial scale. It features a primary measure that is compared to other measures representing a mandatory maximum value and optional target and minimum values.
                

Shown in Figure 6.34, each gauge type displays an Actual Value between a Minimum value and Maximum value that you can set. The speedometer can put the Actual Value in perspective with multiple bands of color. By default, there are three color bands of red, yellow, and green; however, both the number of bands and the color values can be changed. The Linear and Angular gauge have an additional data value for a Target Value, which appears as a thin line perpendicular to the gauge.

Figure 6.34    Speedometer, Linear Gauge, and Angular Gauge
6.2.13    Tile
In addition to the three new gauge chart types in Section 6.2.12, Web Intelligence 4.2 Support Pack 4 and higher provides tile charts not available in prior versions. These tiles mimic the visual appearance of the tiles used in recent versions of the Microsoft Windows operating system as well as SAP's own Fiori user experience. There are two variations of gauge charts, as described in Web Intelligence:


Tile Tiles are used to display only the actual value of a measure.
                

Tile with deviationDeviation tiles are used to display only the actual value of a measure. You can enable semantic coloring by providing a target comparison value.
                

The standard tile, shown on the left in Figure 6.35, displays a single Tile Values. The tile with deviation, shown on the right in Figure 6.35, also displays a data value for Tile previous period values (indicated by the upward pointing arrow to the right of the revenue value) and Tile target values (indicated by the color red used to display the metric and the previous period indicator).

Figure 6.35    Tile and Tile with Deviation
The assignment of variables to the tile with deviation chart is shown in Figure 6.36.

Figure 6.36    Variables Assigned to the Tile with Deviation Chart
The actual values are shown in a table in Figure 6.37. Notice that Sales Revenue CY (current year) is larger than the Sales Revenue LY (previous year), which is why the arrow icon on the tile chart points upward. However, the rather aggressive 20% growth target over the previous year, or $5,599,332.90, was not met, which is why the text in Figure 6.35 for the tile is colored red.

Figure 6.37    Values Used in Tile with Deviation Chart
These are the default behaviors, which can be changed by altering the chart properties, which are described in the next section.









6.3    Chart Properties
Chart properties in Web Intelligence 4.0 and higher have been dramatically improved over prior versions. With more than 200 different properties available, report designers have more choices than ever to create highly customized and formatted charts and reports. Each chart type contains its own set of properties for displaying data values, changing the presentation effect and style, and applying formatting to titles, legends, and axis values.
6.3.1    Customizing Charts
To begin customizing the format of a chart, enter Design mode and then right-click on the chart to be edited. With the menu displayed, click on Format Chart to launch the chart editor and begin making changes to the properties and attributes. Chart properties are grouped into the following major categories for logical access:


Global


Title


Legend


Category Axis


Value Axis


Plot Area


Figure 6.38 displays the categories of a column chart. Here, the global properties are listed, and the other five property categories are minimized at the bottom left of the figure.

Figure 6.38    General and Global Properties of a Column Chart
Each category contains specific properties that can be modified to change the style and visual presentation. To access the individual properties, click on the category groupings located on the left side of the format editor.
You can modify individual properties by selecting the subgroup of each property category and then manipulating the specific options on the right side of the editor. Property subgroups provide an even more detailed collection of properties. Each chart type varies slightly by the number of properties available to each type. Following is a description of the property categories for a column chart:


GlobalUse the Global category to revise properties that apply to the entire chart. Eight subgroups are available within the Global category:
                    

General: Edit the name and size of the chart and enable settings to hide the chart dynamically with a formula.
                        

Area Display: Enable or disable a chart title and edit the title label. Use the formula editor to create a dynamic title. Also change the visibility of chart axes, legends, and data values.
                        

Measure Properties: Change the region type from bars, lines, and surfaces.
                        

Data Values: Check Data Label Displaying Modes to display the values being charted. Customize the data type being displayed, data position, orientation, and font properties.
                        

Palette and Style: Make visual changes by setting the 3D look, color palette, marker symbols, bar effects, and light and shadow effects. This subgroup of properties provides several advanced capabilities to generate highly customized chart objects.
                        

Background: Assign the background color to be RGBA color or gradient.
                        

Border: Assign the style, thickness, color, and border type.
                        

Layout: Enable or disable layout properties such as starting on a new page, avoiding page break, repeating on every page, and assigning the relative position to other report elements on the canvas.
                        



TitleUse this property category to apply a dynamic or static title, and edit the layout spacing, orientation, location, layout width, layout height, font properties, and border and background choices.
                

LegendUse this property category to modify properties associated with the legend values or title of the legend. These properties include making it visible and choosing symbol size, layout location, spacing, orientation, text and font properties, and border and background settings.
                

Category AxisUse this property category to apply visual settings to axis values. Settings include hiding or displaying the category axis itself and adjusting axis orientation, reversing the order on the axis, color options, and font properties.
                

Value AxisUse this property category to hide the axis, change the stacking type, modify the scaling method, adjust the layout and orientation, provide changes to color options, edit font properties, and assign a number format.
                

Plot AreaUse this property category to make the following adjustments to the plot area settings: invert superimposition order of series, spacing within and between groups, grid and background style, color, and lighting.
                

6.3.2    Useful Chart Properties
With more than 200 adjustable properties, some of the most significant properties can be difficult to locate. Don't overlook these properties when creating charts that engage users and display information in meaningful, actionable, and insightful ways:


Global • Palette and Style


3D Look Depth: 3D Look—Enhances the visual display of the report element to produce a 3D effect.
                        

Bar Display Effects—Adjusts the width and brightness in addition to adding volume effects to applicable chart types.
                        

Light and Shadow Effects: Real Lighting and Complex Shadows—Creates the illusion of subtle light with shadows behind the charted values.
                        

Line Effects: Line Width—Adds thickness to a line to produce a fuller visual impact.
                        

Line Effects: Spline Line—Produces lines with smoothed curves at the data point locations (also known as a smoothing spline).
                        



Plot Area • Background


Grid and Background: Striped Background.




Category Axis • Design


Layout: Reverse Order on the Category Axis and Show labels.
                        



Figure 6.39 shows the same basic line chart twice, but several properties have been adjusted on the right. These adjustments include increasing the line size and symbol width, checking the Spline Line option in the Line Display Effects section, and applying a subtle striped background to the plot area.

Figure 6.39    Basic Line Chart with and without Property Changes
These are just a few of the options that can be used to improve the way data is delivered in custom charts. Next, we'll describe zone formatting, a time-saving technique to quickly format a chart without entering the formatting window.









6.4    Zone Formatting
Zone formatting gives report designers the capability to modify every aspect of a chart by using the tools provided in the Format tab. The original and more comprehensive method of applying visual changes to charts requires entering the Format Chart window to apply property changes. There, you can make properties and formatting changes to adjust the existing settings within the chart. Properties are categorized into several functional groupings for a complete collection of adjusting settings in one panel, as shown in Figure 6.40.

Figure 6.40    Zone Formatting

Note
Other than changing the colors of a chart, zone formatting can only be accomplished while working within the Applet.

In addition to the functionality provided in the Format Chart window, zone formatting allows report designers to make changes instantly to a chart zone with only a single click. Make these property adjustments by selecting a bar, column, or line in a chart and then using the various options located in the Format tab.
The following chart zones and properties can be modified using the properties available on the Format tab:


Chart titleFont, border, style, alignment
            

ChartBorder, background color, size
            

Value axisFont, style, numbers
            

Category axisFont, style
            

Axis labelsFont, border, style
            

LegendBackground color
            

Legend titleFont, border, style, alignment
            

This new time-saving feature lets you modify charts quicker than ever before.









6.5    Custom Elements
In addition to out-of-the-box charts, Web Intelligence proposes a generic framework, called custom elements, that allow you to write your own visualizations. This framework is already used by some partners and developers.
For example, you can get a list of third parties proposing such custom element by accessing the SAP App Center. You can access this web site by clicking the icon  on the left corner of the Status Bar (see Chapter 4, Section 4.4.4) or through the URL https://www.sapappcenter.com/listing?q=Web%20Intelligence.
You can either contact one of these third-parties to acquire one of their custom elements, or write them yourself (if you have some development and REST Web Services skills). In both cases, the final custom element must be deployed and authorized by your administrator in the CMC.
As custom elements require a connection to the BI platform repository, custom elements are supported by Web Intelligence HTML, Applet and in the Interactive Viewer. The Web Intelligence Rich Client supports them in connected mode, but not in offline or standalone modes.
To display the chart in Web Intelligence, custom elements can return either a static picture or interactive HTML content. This may provide interactivity with the custom element when displayed in Web Intelligence. This HTML support can be used to do more than just display a chart and implement real embedded applications inside Web Intelligence. It is not yet supported in Web Intelligence Interactive Viewer, which can only display static picture returned by the custom element.

Enabling HTML
Since SAP BusinessObjects BI 4.2 SP 4, most HTML elements are now disabled by default in Web Intelligence. If you have deployed a custom element that displays in HTML, you may need to ask your administrator to enable HTML elements for Web Intelligence. In the CMC, in Applications • Web Intelligence • Properties page, select the Enable javascript content in Web Intelligence documents checkbox.

To be properly displayed when you export a document to Excel or PDF (see Chapter 19, Section 19.4), the custom element must return a static picture.
6.5.1    Using a Custom Element
To use a custom element that has been deployed on your machine by your administrator, navigate to Design mode. The Insert Custom Element button appears in the tab Report Element tab, under the Custom Element subtab, as shown in Figure 6.41.

Figure 6.41    Insert Custom Element Button
To insert a custom element into the document, follow these steps:


                    Click this button. This opens a box with the custom element icon  that follows your mouse. To exit this insert mode, press the (Escape) key.
                

                    Click in the report to select where to insert a custom element. The Insert Report Element dialog box opens. New chart types proposed by the custom element are displayed after the list of charts supported by default by Web Intelligence. For example, Figure 6.42 shows a custom element, Galigeo, that proposes only one chart type.
                    
Figure 6.42    Custom Element Displayed in Charts List (Courtesy of Galigeo)


                    Select a custom element and a chart type.
                

                    In the pane in the right side, as for any chart (Section 6.1), use the drop down menus to select the objects of the report that can feed the objects expected by the custom element you have selected.
                

                    Click OK. The dialog box closes and the selected custom element is displayed as defined by the developer who has written it. For example, Figure 6.43 shows the geo map application proposed by the same SAP partner and based on custom element.
                


Figure 6.43    Custom Element Displayed in Document (Courtesy of Galigeo)
An alternate way to use a custom element is to right-click a table or a chart and select the Turn to command. The available custom elements are also listed in the Turn to dialog box that opens. You can identically select such custom element and its feeding to display it in the report.
6.5.2    Custom Element Properties
A custom element deployed in your server behaves like any charts available out of the box. A dataset displayed through a custom element supports:


                    Filtering: report filters and input controls (see Chapter 9, Section 9.3) filter the dataset displayed in the custom element.
                

                    Sorting and ranking: sorts and ranks (see Chapter 3, Section 3.4) defined on the custom element are taken into consideration when displaying dataset.
                

                    Hiding: Hidden objects are not displayed by the custom element.
                

If the custom element's developer has planned some parameters for your custom element, you can see and change them by following these steps:


                    Select the custom element and right click it. In the contextual menu, select the Format Chart command.
                

                    In the Format Custom Element dialog box that opens, use the Select chart area drop down menu to check if the custom element supports custom properties.
                    By default, the menu contains only the area Global area, with the General, Border, Layout and Palette and Style sections.
                

                    If this is the case, as shown in Figure 6.44, select these properties, and then in the screen that appears, set the properties defined for this custom element.
                    
Figure 6.44    Custom Elements Property (Courtesy of Graphomate)


                    Click OK to close the Format Chart dialog box and apply your new settings to the custom element. The effect of these settings depends on the implementation done by the developer who has implemented the custom element service.
                










6.6    Summary
Report designers have never had more choices for the customization of reports than with the features available in the latest releases of Web Intelligence. You can alter charts to include volume effects, a 3D appearance, and several adjustable light and shadowing effects. In addition to formatting reports and reporting elements, you can convert individual charts into other chart types or data tables with as few as three clicks, create a dynamic chart title with formula capabilities, and apply custom formatting to every axis category and title.
If you need more chart types than the ones proposed by default by Web Intelligence, you can review the ones proposed by third parties or write your own chart services based on the Web Intelligence custom element framework. Once deployed, these new charts integrate smoothly into Web Intelligence user interface and behaves as other charts when it comes to filter, sort or set custom properties supported by the custom element.
In addition to displaying data, charts can function as clickable and interactive objects using element linking, described in Chapter 9, Section 9.5. Charts can also be used to drill from summarized to detailed data, for example from country to state to city. Drilling through navigation paths is described in Chapter 10.
But first, let's go discuss advanced topics regarding charting in Chapter 7.








7    Making an Impact with ChartsWith Web Intelligence charting engine, you can produce visual reports that vividly illustrate the data being displayed. Explore the extensive chart properties to create highly customized reports that generate the maximum impact for each unique scenario.Web Intelligence is known for its ability to retrieve high volumes of data and produce detailed analytical reports. After data is returned to the Report Panel, analysis is enhanced by features such as simple filters, drilling, and input controls. Now in SAP BusinessObjects BI 4.2, charting can also be included in the list of powerful devices available at your fingertips for clearly displaying information and emphasizing important values. The charting engine first introduced in SAP BusinessObjects BI 4.0 upgrades the tool's capabilities to present information in a variety of visually engaging chart components. Each chart type provides properties to configure the finest of details, with many charts offering over 200 adjustable settings.Charts also provide an intuitive method for drilling into results and guiding users to details at lower levels or aggregating up to higher levels in a hierarchy. Navigation can be synchronized when more than one chart is displayed in a report, and both contain hierarchical dimension values and when drilling has been enabled.Displaying hierarchical data in charts is possible for data sourced from either multidimensional or relational data sources. Options are provided to produce visual groupings when more than one dimension object is added to a chart and display multilevel analysis within a single graphic.This chapter covers all these topics and provides examples to help you make an appropriate visual impact with charts based on the data requirements and audience expectations.
7.1    Properties That Enhance the Display of Data
Whether you're using bar charts, column charts, or scatter charts to display data, the number of available configurable properties varies for each chart type. Properties range from making simple font changes in chart titles to enabling a 3D look and applying complex shadows in the Light and Shadow Effects setting in the global Palette and Style property category to maximize the visual impression of data.
These steps explain how you can begin modifying chart properties:


                Enter Design mode.
            

                Right-click on the chart to be edited.
            

                Select Format Chart.
            

Before making changes to the visual presentation of a chart, be sure that you understand the business reason behind every modification. Visual changes configured simply to add flair or contrast may be useful in some scenarios but will not be well received in every business setting. In fact, there are several things you should consider when planning and making visual changes to charts:


                The users' expectations
            

                The organization's visual standards
            

                Graphics and colors that enrich the communication of results
            

                Clear display of data that is not confusing and does not misrepresent
            

                Color scheme (colors should not provide meaning because up to 10% of users are color-blind)
            

Remember that visual attributes should be used to enhance the data being presented rather than distract users or detract from the content being displayed. Information should be easy to read and understand, not confusing or misleading.
Report element placement is also very important when presenting information with charts. Layouts should be well aligned and precisely placed on the report canvas. Consumer confidence is greatly diminished when report elements are misaligned, have inconsistent sizes, or are created with erratic color schemes. You can use the width and height adjustment options in the Format tab and the Size subtab to make precise adjustments to chart element widths and heights.
To align two or more charts, hold down the (Ctrl) key, and select all the charts that need to be aligned. Then right-click and select Align. Alignment options include align left, center, right, or top, middle, bottom.
7.1.1    Modifying Chart Properties
The Format Chart window in Web Intelligence provides a tremendous number of options for configuring charts. With just a few adjustments, standard reports with charts can be elevated to visually stunning reports, scorecards, dashboards, or report/dashboard hybrids known as "dashports". Let's explore the configurable options available in the Format Chart window that can be used to change the appearance of a chart. Every chart type contains several unique options that are specific to that chart type, as well as several settings that can apply to all chart types.
The settings described here present the options available in a column chart.
7.1.2    Global Configurable Options
The Global options affect the display of the entire chart and are organized into the following eight tabs:


GeneralUse this category to rename the chart, adjust the width and height of the entire report element, and assign up to eight different display options, including settings that show measure or dimension values when empty. From here, you can also show error and warning icons when chart drivers encounter incorrect data values and whether you can change the axis orientation when configuring a bar or column chart.
                

Area DisplayUse this category to add a dynamic title label with a formula and also to select a location (top, bottom, left, or right) to display the chart title. Other options include the ability to show or hide category axis labels, values, title, data values displayed on the charted shape, and legend details.
                

Measure PropertiesUse this category to quickly switch the chart type to bars, lines, or surfaces.
                

Data ValuesCheck the Data Label Displaying Mode option to display data values on the charted shapes and to configure the appearance of the following data labels:
                    

Data Type: Choose from displaying the data by value, label, or percent.
                        

Data Position: Select the position to display the data label.
                        

                    In a column chart, change the orientation from vertical to horizontal for ideal readability. Configure a variety of font properties, including font size, border size, border color, spacing, and background color.
                

Palette and StyleEnhance your chart with depth and color, and apply other effects (as shown in Figure 7.1):
                    

Depth: 2D look or 3D look.
                        

Palette: 13 different palette combinations that come out of the box plus the option to include a custom palette, or use the slider to adjust the transparency effect from 0 to 100% for opaque to invisible.
                        

Chart Series Style


Bar Display Effects: None, Volume, Gradient, Glossy, Cylinder, or Light Glossy.
                                

Light and Shadow Effects: No Filter, Simple Lighting, Simple Shadows, Simple Lighting and Shadows, Real Lighting, Complex Shadows, Real Lighting and Complex Shadows, and Image Embossed with Lighting and Complex Shadows.
                                



                    After you select a Light and Shadow Effect from the Global • Palette and Style grouping, you have five additional options that enable additional customization and precise adjustments. Figure 7.1 shows the modifiable options available when you select Real Lighting and Complex Shadows:
                    

Light Power: Define ranges from -1.00 to 1.00.
                        

Shadow X Offset: Allowable range: 0 to 0.52 cm.
                        

Shadow Y Offset: Allowable range: 0 to 0.52 cm.
                        

Filter Pass Count: Define the complexity of the effect; set from 1 to 9.
                        

Filter Window Size: Determine the smoothness of the shade; set from 1 to 9.
                        

Shadow Color: Choose between RGBA Color and Gradient.






BackgroundChoose between RGBA Color and Gradient.
                

BorderSelect a border style, thickness, color, and border area.
                

Layout


Start on a Page: Enable/disable.
                        

Avoid Page Break: Enable/disable.
                        

Relative Position: Set the element's location relative to another object.
                            
Figure 7.1    Palette and Style Options on the Global Category for a Column Chart




7.1.3    Title Category Options
Title options affect the appearance of the optional chart title:


Design


General: Display/hide the title and configure the title label.
                        

Layout: Select the layout location of the title (top, bottom, left, right), and select the orientation and spacing of the title.
                        

Text: Define font properties, and set a text policy to wrap, truncate, or choose to not wrap long titles.
                        

Border and Background: Choose a border size (None, Thin, Medium, Thick), border color, and background color.
                        



7.1.4    Legend Category Options
Legend options affect the display of the optional legend:


Design


Visible: Set the legend to be visible or not visible (checkbox option).
                        

Layout: Select the location of the legend (top, bottom, left, right).
                        

Group by Dimension: Enable/disable.
                        

Spacing: Options range from 0 to 8.
                        

Orientation: Automatic or vertical lettering.
                        

Symbol Size: Options range from 4 to 32.
                        

Text: Define font properties and set a text policy to wrap, truncate, or choose to not wrap long titles.
                        

Border and Background: Choose a border size (None, Thin, Medium, Thick), border color, and background color.
                        



Legend Title


Visible: Set the legend to be visible or not visible (checkbox option).
                        

Title Label: Display an automatic title or create a custom title.
                        

Layout: Define the spacing and orientation.
                        

Text: Define font properties and set a text policy to wrap, truncate, or choose to not wrap long titles.
                        

Border and Background: Choose a border size (None, Thin, Medium, Thick), border color, and background color.
                        



7.1.5    Category Axis Options
Category Axis options affect the display of dimensions on the X-axis:


Design


Visible: Display/hide the category axis (checkbox option).
                        

Layout: Enable/disable the following options:
                            

Display Axis


Reverse Order on the Category Axis


Continuous Axis Layout


Show Labels


Adjust Layout: Define the width and height to Automatic, Fixed, or Proportional.
                                

Display Staggered Axis Labels: Choose Wrap, Truncate, or No Wrap.
                                



Color Options: Choose from RGBA Color or Gradient for the Axis Color, Grid Color, and Grid Background Color.
                        

Text: Define font settings.
                        



Title


Visible: Enable/disable the category axis label, and choose a title label type between an Automatic or Custom title (optionally apply a label separator).
                        

Layout: Revise the title spaces within allowable range from 0 to 8.
                        

Text: Configure font settings.
                        

Border and Background: Define the border size, color, and background color.
                        



7.1.6    Value Axis Options
Value Axis options affect the display of measures on the Y-axis:


Design


Visible: Display/hide the value axis (checkbox option).
                        

Stacking: Unstacked, Stacked, Globally Stacked Chart, Scaling, and Layout. Also use this option to include a Region Color when assigning data to a chart.
                        

Scaling: Choose the origin in range from Always or Automatic, and define axis scaling from Linear or Logarithmic. Also use this option to set a minimum and maximum value to the chart and set a unit scale factor that ranges from 0 to 24.
                        

Layout: Enable/disable the display axis, show labels, adjust layout, and display staggered axis labels.
                        

Color Options: Set the axis color to either RGBA Color or Gradient.
                        

Text: Define font settings.
                        



Title


General: Enable/disable the axis title.
                        

Layout: Revise the title spaces within the allowable range from 0 to 8.
                        

Text: Configure font settings.
                        

Border and Background: Define the border size, color, and background color.
                        



7.1.7    Plot Area Options
Plot Area options affect the appearance of the area where a chart's bars or lines are drawn.


Design:
                    

                            Enable/disable the Invert Superimposition Order of Series setting, and set the Spacing Within Groups and Spacing Between Groups within a range from -1.00 to 1.00.
                        



Background


Grid and Background: Set the background of a chart to be either a plain background or a striped background, and make specific color changes to the following:
                            

Background Color


Category Axis Grid Color


Value Axis Grid Color




                    Additionally, the option to show or hide a dashed line is presented in the section.
                

Careful configuration of chart properties can make a significant difference in the way data is displayed when presented to users.









7.2    Hierarchical Charting with Relational Data
Displaying multiple dimensions in a single chart can be achieved in Web Intelligence, whether connected to a relational data source or a multidimensional cube. Right-click on a chart; then, while in design mode, select Assign Data. You can add several dimensions to the Category Axis. Figure 7.2 shows a bar chart built with two dimension objects.
Although you can add several additional dimension objects to the Category Axis, you might not be able to display more than three dimensions. This depends on the size of the chart itself and the amount of data in each dimension. As Figure 7.3 shows, you can add more than one object to the Region Color section when assigning data to the chart object.

Figure 7.2    Multiple Dimensions Displayed in a Column Chart

Figure 7.3    Assigning Multiple Dimension Objects to a Column Chart
Multiple dimension values are displayed in nested clusters to communicate the hierarchical groupings of the data in the chart. These axis values are clickable when drilling is enabled, which allows for seamless navigation up and down a hierarchy. When you hover over a column, bar, pie slice, or label, tooltips appear and provide the direction of the current drill option.









7.3    Reports Functioning as Dashboards
Web Intelligence lets users retrieve more than 100,000 rows of data and produce detailed analytical reports. But you can also present data visually with interactive charting components in a style that resembles a dashboard.
Several new features in Web Intelligence can be used together to create a dashboard experience. The following are eight features that can be used to present data interactively and in a dashboard or scorecard format:


Element linkingUse the element linking feature to pass values from one chart component to other dependency components on the same report tab. This feature allows for interactivity between components, even when hierarchies have not been set up at the universe level.
            

DrillUse the drill feature to perform in-place drilling to analyze dimensional values at different levels. This feature is aided by the Scope of Analysis pane and hierarchies set up in the universe.
            

HideUse the Hide and Hide When features to produce dynamic visibility. You can write a formula to show or hide a chart or other report element when specific conditions are met. This feature allows for layers of components to be used in a single report and then only be displayed when data conditions are met. These conditions can be the result of simple filter selections, element link selections, drill values, or data retrieved from the data source.
            

Scale to PageThe Fit to Page functionality popularized in Desktop Intelligence has been included in Web Intelligence as Scale to Page. This feature is accessed by going to the primary Page Setup tab and then locating the Scale to Page subtab in the third subtab group. Figure 7.4 shows the options available for scaling a report page:
                

Width: The default selection is Automatic and can be changed from 1 to 9 pages.
                    

Height: The default selection is Automatic and can be changed from 1 to 9 pages.
                    

Scale: The scale can be changed from 10% to 400% of the current report.
                    

                The functionality provided in the Scale to Page tab works best when used in conjunction with the Page mode selection on the Display tab. These two choices are displayed in Figure 7.5.
                
Figure 7.4    Scale to Page Tab

Figure 7.5    Toggling between the Display Formats: Page and Quick Display
                You have two options for the display mode, both found in the Display tab. The first option, Page, is used when a report needs to be analyzed on a single screen or printed report. You should use this setting when creating a Web Intelligence dashboard or exporting to PDF. The second option, Quick Display, is used primarily for analysis or exporting to Excel. Some relevant tools and features are as follows:
                

New charting engineThe charting engine introduced to Web Intelligence in SAP BusinessObjects BI 4.0 has profoundly improved the data visualization capabilities of the product. Charts can be designed to include flashy styles with complex lighting or be displayed in a conservative and minimalistic format to present data in a style free of unwanted shadows.
                    

Input ControlsThe Input Control tools were introduced in Web Intelligence XI 3.1 Service Pack 2 to provide interactive filtering on a report tab. Input Controls have been enhanced to allow document-level filtering in addition to the existing report-level filtering. In Web Intelligence 4.2, input controls can also be grouped together. Use this feature to give users more choices for slicing, dicing, filtering, and analyzing data.
                    

Conditional formattingKnown in previous versions as alerters, the conditional formatting tools allow specific values to be easily identified in data tables when property changes are conditionally applied to values that meet the outlined criteria. Formatting changes are displayed in real time as users explore reporting documents using filters, element links, and input controls. With conditional formatting, reports can be transformed from simple rows and columns to highly informative scorecards with visual indicators to help you manage your business and drive change.
                    

Additional report tabs for extensive data analysisThis feature amplifies Web Intelligence to become both a data visualization tool and data analysis reporting tool. By having both capabilities within the same tool, a single document can contain multiple data sources, several dashboards, report/dashboard hybrids or "dashports", and also analytical reports containing many thousand records.
                    



You can reach new heights with your reports by combining the features outlined in this section. Scaling the report to fit to a single page, including drilling, Input Controls, and the Hide When feature, along with uniquely customized charts, can go a long way in engaging users and delivering actionable information to them in the most effective format possible.









7.4    Formatting Tips
With more than 200 potential configuration options available for most chart types, it may seem difficult to select areas that provide the greatest impact. This section shows a few of the settings that can be easily changed to make a significant impression and produce increased readability.
7.4.1    Measure Formatting
To properly present a measure in a chart, you'll need to assign the most appropriate number format to the measure, or the chart won't be adequately communicating results to the user. The window for setting this format is accessed by right-clicking on a chart and selecting Assign Data....
From the Assign Data... window, dimension objects are assigned to appear in the Category Axis and measure objects in the Value Axis sections. Click on the plus (+) symbol located to the right of the object selected to add a second object to the chart.
To configure the number format of a measure object, click on the small down arrow located immediately to the right of the plus (+) symbol. Clicking on this arrow will display up to nine different options, depending on the number of objects already assigned to the chart, as shown in Figure 7.6. Click on Format Number to assign a specific format to the measure object.
The Format Number window lets you choose from 40 preset number formats displayed in six different format groupings. There's also a Custom group that allows you to create your own format. And for formatting money measures, the Currency grouping received an update in Web Intelligence 4.1. There are now six currency formats preset for display values in Euro and Yen.
Figure 7.7 shows the Format Number window and the format groupings. To set a format, select a grouping from the left side of the window, and then click on your preferred format on the right side of the window.

Figure 7.6    Formatting the Number of the Value Axis Measure Object

Figure 7.7    Formatting the Number of a Measure Object in a Chart
If the specific format you need isn't found in the list of choices on the right, click on the Custom button to create your own format.
7.4.2    Region Color and Value Axis Stacking
If you'd like each column in a column chart to be displayed with a different color, add a dimension object to the Region Color section when assigning data to a chart. The same dimension object added to the Category Axis section can be used, or a completely different object can be selected.
This setting is optional and is used to visually display groupings within the charted values. Figure 7.8 shows the State object assigned to a chart that already contains State in the Category Axis.
This methodology provides a distinct color for each state value in the chart.

Figure 7.8    Assigning a Region Color to a Chart
Assigning a region color object to a column chart will display the columns in very thin bars, as shown in Figure 7.9. This result may be acceptable in some scenarios, but it's more likely that users will expect to see the columns in a standard width.

Figure 7.9    Column Chart with a Region Color Object Assigned
To display the columns with a wider width, enter the Format chart window, and revise the Stacking option in the Value Axis grouping.
The default setting is Unstacked. By changing the Stacking selection to either Stacked Chart or Globally Stacked Chart, the option of converting the chart to a 100% Stacked Chart becomes enabled.
Leave the 100% Stacked Chart option unchecked unless your chart contains at least two measures and you'd like to show their correlation. To see the column chart with wider bars, just select Stacked Chart, and click OK, as shown in Figure 7.10.

Figure 7.10    Stacking Options
Columns will be presented in a standard width when either Stacked Chart or Globally Stacked Chart is selected as the Stacking option. This setting is useful because it increases the readability of the data presented in the chart.
Figure 7.11 shows the same chart previously displayed in Figure 7.9, with the only difference being that Stacked Chart was selected as the stacking option, as shown in Figure 7.10. Any dimension object or variable existing in the document can be added to the Region Color section to create visual groupings by color.

Figure 7.11    Column Chart with Stacked Chart Option Selected
Next, we'll discuss how to create charts using a customized collection of colors.









7.5    Custom Color Enhancements
As described in Chapter 6, Section 6.3.1, Web Intelligence provides the ability to create custom color palettes. This great new feature gives developers the flexibility to build charts and reporting documents that use precise color codes, which is often a requirement in many businesses and corporations. Chart colors can now be consistent, accurate, and in line with the required color standards at any organization. Each color palette contains 32 total colors with 8 primary colors.
From the Create palette window, you can create a new combination of colors based purely on their appearance, or you can use color codes to create precise and repeatable variations.
Perform the following steps to begin creating a custom palette:


                Select an existing chart on your report.
            

                Locate the Chart Style subtab found on the primary Format tab.
            

                Expand the Palette Style dropdown, and then scroll down and select Custom... (see Figure 7.12).
            

                In the Manage Palettes window, click New in the Custom section to begin creating a new custom palette as shown in Figure 7.13.
                
Figure 7.12    Creating a Custom Color Palette

Figure 7.13    Creating a New Custom Color Palette


                Begin setting the colors by clicking one of the existing colors located in the Color settings area, and then click the color picker selector. Select More Colors under the default list of choices to make your color selection by code (see Figure 7.14).
                
Figure 7.14    Selecting Custom Colors for Your New Custom Palette


                By selecting More Colors, you'll launch the Custom Color window. This window provides five ways of choosing a color: Swatches, HSV, HSL, RGB, and CMYK.
                The next several screenshots show each of the custom color windows used for choosing colors in the most accurate and repeatable method. Figure 7.15 shows the Custom Color window and the number of choices available on the Swatches tab.
            

                In each of the next four color choice tabs, you can select colors using any of these methods:
                

                        Clicking in the color picker square
                    

                        Changing the color by tint in the vertical gradient
                    

                        Using sliders to manually adjust specific color elements
                    

                        Changing the Hex color code
                    

                        Modifying the numeric value of color elements such as the following:
                        

Hue


Saturation


Value


Lightness


Transparency


Red/Green/Blue (RGB)


Alpha


Cyan/Magenta/Yellow/Black (CMYK)

Figure 7.15    Custom Color Choices - Swatches






Figure 7.16 through Figure 7.19 show the various options available for adjusting and defining colors on the other tabs in the Custom Color window. The following is a description of how adjustments are made in each Custom Color selection type:


SwatchesChoose from 288 predefined color choices.
            

HSVColor codes are generated by adjusting colors by Hue, Saturation, and Value. The level of Transparency is also selectable (see Figure 7.16).
            


Figure 7.16    Custom Color Choices - HSV


HSLGenerate color codes based on Hue, Saturation, Lightness, and Transparency (see Figure 7.17).
            


Figure 7.17    Custom Color Choices - HSL


RGBDefine the levels of Red, Blue, and Green in a color (see Figure 7.18).
            


Figure 7.18    Custom Color Choices - RGB


CMYKCreate a precise color by using traditional Cyan, Magenta, Yellow, and Black color levels. Alpha represents the level of transparency in this color selection category (see Figure 7.19).
            


Figure 7.19    Custom Color Choices - CMYK









7.6    Summary
Charting in Web Intelligence has been elevated to include improved linking and a boardroom-quality appearance. With an extensive array of configurable properties, charts can include changes to more than 200 different attributes. You can use the full list of provided features to produce highly effective and visual reporting documents that function as dashboards and scorecards while also delivering the data volumes that only Web Intelligence can cleanly consume.
Data analysis is improved by adjusting visual settings such as number formats in charts and the stacked chart option when assigning a region color to a chart. The next chapter describes the various report properties and tools available for creating precisely formatted reports.








8    Report Properties, Tools, and FormattingWeb Intelligence contains specific metadata about reports, providing report users with a quick and accessible way to modify and interact with them. You can use the various tools and properties to produce highly configured reports to not only effectively communicate information but to share elements and collaborate with other users.This chapter describes the various properties that can be modified in Web Intelligence to increase the readability and usability of reporting documents. Building on the new robust reporting interface, users get quick access to a report's metadata through the tools located in the side panel. This panel, located in the Report Panel, contains eight sections in Design mode, five in Reading mode, and one in Data mode. Each section delivers useful and relevant information to users for the report viewing scenario. The following sections outline all of the functional capabilities delivered in the side panel or left pane of the Report Panel.
8.1    Formatting Report Properties
The reporting interface in Web Intelligence allows for dynamic formatting of report properties while working in Design mode. This section explains the ways to access report properties and how to most effectively display reports for different types of report consumers.
The side panel of the Report Panel was introduced in Chapter 4, and this chapter expands on that introduction by describing all of the functionality available inside of it. This panel plays a critical role in editing existing documents and creating new reports. It's different for Reading mode, Design mode, and Data mode, so you'll notice that most functionality is not available when viewing a report in Reading mode. The differentiation between capabilities in the Reading and Design modes provides greater control to power users and report developers in Design mode. Reading mode provides a cleaner interface designed specifically for report consumers who need only to view, analyze, filter, share, and export report data. And now in SAP BusinessObjects 4.2 SP 3, you can collaborate through commentary in Reading mode.
Table 8.1 shows the side panel properties available in each mode.




                        Reading Mode


                        Design Mode


                        Data Mode








Document Summary


Navigation (Report) Map


Input Controls


User Prompt Input


Comments






Document Summary


Navigation (Report) Map


Input Controls


*Web Service Publisher (only available in the Applet)
                            

User Prompt Input (only available in the HTML client)
                            

Available Objects


Document Structures and Filters


Shared Elements


Comments






Data






Table 8.1    Side Panel Properties Listed by Mode
When expanded, the side panel provides report developers with access to available objects, an area for creating new input controls, access to the web service publisher, and a display of report metadata in the Document Summary, as shown in Figure 8.1.
The following sections outline the functional options available in the side panel tabs.

Figure 8.1    Document Summary Details in the Side Panel









8.2    Document Summary
The Document Summary tab includes the following information about the report:


General


                        Type: Web Intelligence Document


                        Author
                    

                        Creation date
                    

                        Locale
                    

                        Content alignment direction: Left-to-Right


                        Description
                    

                        Keywords
                    



Statistics


                        Last refresh date
                    

                        Last modified date
                    

                        Last modified by
                    

                        Duration of previous refresh
                    



Document Options


                        Refresh on open: on/off
                    

                        Permanent regional formatting: on/off
                    

                        Use query drill: on/off
                    

                        Enable query stripping: on/off
                    

                        Hide warning icons in charts and tables: on/off
                    

                        Merge prompts (BEx or HANA variables): on/off
                    

                        Default Style: on/off
                    

                        Comment displayed: on/off
                    

                        Check for shared element update(s) on open: on/off
                    

                        Update shared element(s) on open: on/off
                    



Data Options


                        Data tracking: on/off
                    

                        Auto-merge dimension: on/off
                    

                        Extend merged dimensions values: on/off
                    



Parameters


                        Prompts
                    

                        Keydates
                    



This report metadata is useful for administrators to see who has created and refreshed published documents. The Duration of previous refresh setting is helpful to users and report developers when analyzing query performance after refreshing queries. The amount of time the query took to refresh in its last run is used to provide an estimated wait time when the query is refreshed again. If the query has never been run, then this value will be zero.
The following buttons and fields are relevant to the Document Summary tab:


PrintSends the document properties to the printer.
            

Edit (Design mode only)Allows the report developer to update the General section with metadata about the report. It's important to be specific when entering a description and keywords that accurately describe the report. The Keywords section is used to quickly locate relevant report data by using the search option in the BI Launch Pad. Figure 8.2 shows the properties available in the Document Summary window.
            


Figure 8.2    Document Summary


General sectionProvides a description of the type of document, author, and creation date. This window also displays descriptions and keywords assigned to the report. Click on Edit at the top of the Document Summary tab to enter new values or make changes to existing information in the Description or Keywords sections.
            

OptionsIndicates the on or off status of the following six report parameters by using checkboxes:
                

Refresh on open


Permanent regional formatting


Use query drill


Check for shared element update(s) on open


Enable query stripping


Hide warning icons in charts and tables


Auto-merge dimensions


Update shared element(s) on open


Extend merged dimension values


Merge prompts (BEx or HANA variables)


Right to Left Content Alignment





Note
All of the preceding options are set to on or off and can be set in the Options section after clicking on the Edit button in the Document Summary.



Default Style


                        Click the Change Default Style button to import a preformatted style into your report. You can also export the current settings to a new style file to be used by other users and in other reports.
                    



CommentsChoose the text to be displayed in a comment cell to show user commentary. The following two options are available:
                

Last comment (default)


First comment




The Document Summary tab provides a significant amount of descriptive report information, including the last refresh time. This information can be used by report designers to troubleshoot any potential performance issues when queries are refreshed.
By identifying queries with lengthy refresh times, developers can focus on improving retrieval times and the user experience.









8.3    Navigation (Report) Map
Known as the Navigation Map in the HTML client and the Report Map in the Applet, this map provides a list of the reports and section values within each report. It also provides navigation to all of the reports in the document. If you've included sections in your report, you'll be able to jump directly to specific values in a report from this tab. Figure 8.3 shows a Navigation Map with three report tabs and all sections associated with the first report tab.

Figure 8.3    Navigation (Report) Map









8.4    Input Controls
This tab allows users to slice, dice, and interact with data while reading a report. Designed for filtering reports, Input Controls provide an excellent method to do just that. Filtering and drilling into data is easily accomplished by setting up individual controls from the Input Controls tab in the side panel.
New features have been added to Input Controls in SAP BusinessObjects BI 4.1 SP 6 and SAP BusinessObjects BI 4.2 SP 3 to provide some of the much requested functionality that users need. These two features are:


Document Input Controls (or global controls that filter an entire document)
            

Group Controls (cascading filters)
            

We'll discuss these two new features and more in the coming pages.
In Design mode, the Input Controls options include:


New: Create a new input control
            

Map: View a detailed list of all objects on the current report
            

Reset: Quickly clear all input control selections
            

New input control filters can only be added while in Design mode, while the Map and Reset options are available in both Design mode and Reading mode. Follow these steps to create a new input control:


                Enter Design mode and select the Input Controls tab from the side panel.
            

                Click on the New button at the top to add a new input control.
            

                Select the object or variable to use as the source of the control and click on Next.
            

                Choose the preferred control type and make modifications to the input control properties. Click on Next to proceed.
            

                Assign report elements to accept the filter value of the input control and click on Finish.
            

The input control map outlines all input controls created for the report. Each input control is assigned a report element at the time of creation. The map view allows report users to see all of the dependencies of each input control. This option toggles to either on or off. To get out of map view, just re-click Map to toggle to the off position.
Figure 8.4 shows a map view example for all of the objects in a reporting document. Input controls and their dependencies are easily identified.

Figure 8.4    Map View for All Input Controls
The Reset button resets all updated input controls to their original defaulted values. Use this button when a series of selections have been made, and you'd like to return all of the filters back to their defaults.
Input controls are one of the most powerful filtering tools you can add to a report to encourage interactivity for report users. This functionality allows users to slice or filter data in a report using retrieved dimensions, measures, or variables.

Tip
Whenever possible, you should revise the input control label to include a name using appropriate business terminology and descriptive terms that fully describe the context of the filter.

Depending on the qualification of the object used in the input control, you'll be able to create controls with the following control types:


                Single-value selections
                

                        Entry field
                    

                        Combo box
                    

                        Radio buttons
                    

                        List box
                    

                        Calendar
                    

                        Entry field
                    

                        Spinner
                    

                        Simple slider
                    



                Multiple selections
                

                        Checkbox
                    

                        List box
                    

                        Double slider
                    



Each control type created from a dimension or detail object contains the following configurable settings:


Label


Description


List of Values


Use restricted list of values checkbox
                    



Default values


Allow selection of all values checkbox
            

Allow selection of null values checkbox
                

                        This new feature allows you to select any null or empty string value from a list of values. It's available for the following input control types:
                        

                                Combo box
                            

                                Radio button
                            

                                Checkbox
                            





Operator


This functionality allows for customized user interaction. You'll need to ensure that the label name and description are descriptive enough for the user to understand how to use input controls. Figure 8.5 shows the input control properties for a combo box control named Store name.

Figure 8.5    Input Control Based on the State Object

Note
Input controls segment or filter data at the report level, while prompted filters restrict data at the query level. The right mix of filters is based on user requirements and balances query performance to provide the optimal user experience.

You can edit existing input controls in Design mode by clicking on the wrench icon available on the right side of the header bar. Four icons appear when you hover over the header bar of an input control:


Edit


Show Dependencies


Remove


Collapse or Expand the content


Figure 8.6 shows the icons that appear when hovering over an input control title in Design mode.

Figure 8.6    Icons Appearing When Hovering over an Input Control Title in Design Mode
8.4.1    Document Input Controls
One of the most exciting new enhancements to input controls is the option to set a control to apply to an entire Web Intelligence document, not just the Report tab. This type of global filtering is completely new since up until this point, all levels of report filtering had taken place exclusively on each individual report.
Assigning an input control to apply to an entire document is simple and can be done while the control is being created or edited.
Click the Dependencies tab and then select the Whole document option, as pictured in Figure 8.7.
After you make the whole document selection, the control will move from the Report Input Controls section inside the Input Controls panel to the Document Input Controls section. This is pictured in pictured in Figure 8.8.

Figure 8.7    Changing an Input Control Dependencies to Whole Document

Figure 8.8    Input Control Moving from the Report Section to Document-Level Section
8.4.2    Grouping Input Controls: Cascading Filters
Grouping is the other exciting new edition to input controls and makes them function as cascaded filters rather than free-standing unrelated filters. This single new feature is a huge improvement for analysts that use Web Intelligence to drill into data at various levels of a hierarchy.
Without grouping, each input control stands independently and is derived from unique values returned by the data source or produced by a variable. For example, Figure 8.9 shows two input controls added to a report: one for Quarter and one for Month.
If the Q3 value is selected from the Quarter control, nothing is changed in the Month control. Logically, you have to be wondering why months 1-6 are being displayed along with months 10-12. That's because the controls are not connected in any way and both stand independently. This problem has been solved with the use of control groups.

Figure 8.9    Independent Quarter and Month Input Controls
To group the controls, start by entering Design mode and then clicking the Group button located at the top of the controls panel. This is pictured in Figure 8.10.

Figure 8.10    Creating an Input Control Group
Clicking the Group button will launch the Group of input controls window and give you the following options to configure the new group:


Group name: Default name is New Group


Show: Provides the option to assign the group to apply to the whole document or current report
                    

Document Input Controls


Report Input Controls




Input Controls list: Check all of the input controls that you'd like to exist within the group
                

At least two input controls are required to create a group.

Note
Be sure to choose the correct filter level at the time the new control group is created. You cannot edit a control group and change the scope of the filter group from document level to report level. This selection can only be made at the time the group is created.

Figure 8.11 shows the group of input controls window with the two controls selected to apply to the Quarter and Month Group and with the scope of the filter set at the report level.

Figure 8.11    Choosing Input Controls to Add to a Control Group
Now that the group has been created, if the Q3 value is selected, only months 7-9 will appear in the month control. This is displayed in Figure 8.12.

Figure 8.12    Grouped Input Controls
This quarter-month example is very simple but the benefit of the cascading effect becomes much more significant and helpful when users are analyzing complex business data.









8.5    Web Services Publisher
This tab allows the report designer to access web services previously created from data blocks in other Web Intelligence reports. Figure 8.13 shows the Web Service Publisher with a Web Service Definition Language (WSDL) for a selected web service previously created.
Let's examine some of the important options here:


Manage servers...This button is used to add a web services host to the current document. If you're planning to connect to a web service created by Query as a Web Service, use this tool to retrieve the host name. After adding the host name in the provided text box, the URL is automatically generated.
                
Figure 8.13    Web Service Publisher


Web Service PublisherThe various metadata describing published web services can be accessed and edited by the following set of feature icons:
                

Views: Allows the designer to view created WSDLs by the following three options (additionally, an option is presented in the View menu to show web services by query):
                        

View by web service


View by document and web service


View by document and block




Delete: Deletes a selected web service.
                    

Edit: Launches the Publish Content wizard to edit an existing web service.
                    

Rename: Allows you to rename a web service group.
                    

Refresh: Refreshes a web service group.
                    

Test: Tests the input request and server response for a web service group.
                    

Import web service query: Displays the web services properties of the query and enables the Import web service query option (available only when the Show web services content option in the View menu is checked).
                    

Search: Searches for existing web services (this is one reason that WSDL names and descriptions should be descriptive in nature).
                    





Web Services Properties


WSDL URL: Shows the URL associated with the selected web service query and is also used to connect to data in SAP BusinessObjects Dashboards.
                    

                        Example syntax of the WSDL URL is: http://Brogden_Lab2:8080/dswsbobje/qaawsservices/biws?WSDL=1&cuid=Afz_ewqY1jlOpJmeZLLfGPs




Follow these steps to create a new web service:


                Right-click on an existing table or chart.
            

                Select Publish as web service.
            

                The Publish Content wizard is launched. Click on Next to proceed.
            

                Click on Next in the Identify Duplicate Content window.
            

                Enter a descriptive name and (optionally) a description, and then click on Next, as shown in Figure 8.14.
                
Figure 8.14    Defining a New WSDL Name and Description


                Click on the Create button shown in Figure 8.15.
                
Figure 8.15    Publishing Content as a Web Service


                Give the new web service a name with no spaces.
            

                Add a Description for the web service and click on Publish.
            

                When complete, you'll see that the web service has been successfully deployed. The WSDL can then be used as a data source in other SAP reporting tools.
            










8.6    Available Objects (Design Mode Only)
After you add a data provider and retrieve data from your source, you'll find all of the resulting objects available for report consumption in the Available Objects tab. The Available Objects tab contains the following sections and is only available in Design mode:


Filter barUse this space if you're looking for a specific object name. Every letter you enter will filter the objects in the tree.
            

List of available objectsDisplays all of the report's result objects retrieved from data sources.
            

VariablesThis folder contains all of the variables created within the document. It also stores any groups created by using the Group feature located in the Analysis/Display tabs.
            

ReferencesThis is where the new references feature stores references that have been created from specific data points.
            

Arranged by dropdownThis option is located at the bottom of the window and gives report developers a choice of how to sort or display available objects. In complex documents with multiple data sources and a significant number of objects, arranging by query can be extremely useful. In other situations, arranging alphabetically will provide more value.
                New in SAP BusinessObjects BI 4.2 SP 3 is the ability to arrange objects by data source. This setting will definitely come in handy when multiple data sources are used and the objects being retrieved are similarly named. The available objects can be arranged as follows:
                

Alphabetical order: Arranges the available objects in alphabetical order.
                    

Query: Displays all available objects by query name.
                    

Data Source: Displays all available objects by data source and class.
                    



Report developers can drag and drop any available object onto the report canvas or assign them to report elements. Figure 8.16 shows the new Arranged by Data Source option with folders (or classes) the objects retrieved by the query.

Figure 8.16    Arranged by Data Source Option for Arranging Available Objects
This feature can be extremely valuable when multiple instances of the same objects exist within various classes and contexts in a universe. Arranging the objects retrieves by data sources helps developers to ensure they're using the correct instance of an object in those types of situations.









8.7    Document Structures and Filters
This tab provides a detailed listing of all objects existing within the document and is only available in Design mode. Use the Document Structures and Filters tab to access the following:


Filter buttonShows/hides filters that exist on report elements and data blocks within the report.
            

Axis buttonToggles on and off the report axis found in charts and data tables.
            

Shared Element buttonHelps you locate where shared elements have been used within the document.
            

It's important to name report elements appropriately for relative positioning and layering purposes. Figure 8.17 shows document structure and filters.

Figure 8.17    Document Structure and Filters
The various objects in the report can be easily identified by their unique icons. An example of that is the funnel-shaped icon used to identify that a filter exists in the report.









8.8    Data
The Data tab is only available when Data mode is selected. It's important to note that the Applet viewer is required to access the Data tab, as pictured in Figure 8.18.

Figure 8.18    Locating the Data Tab from the Applet Viewer
To enter this option, click on the Data button in the upper-right corner of the report immediately to the right of the option to enter Design mode. This tab shows all data providers and available objects, including dimensions, measures, details, and variables.
The following elements are available in the Data tab:


Filter barFilters objects by name.
            

Expand and Collapse buttonsExpand and collapse data sources (queries).
            

Data source and variables listDisplays all queries generated for the report as well as associated variables (you can edit variables by right-clicking on a variable name and selecting Edit).
            

Figure 8.19 shows the Data tab, including query name and associated query properties.
The purpose of the Data mode is to view specific elements of metadata about the data sources in a report. This metadata includes query names, data sources, refresh dates, duration of queries, and the number of rows retrieved. You can also export results retrieved by a specific data source to a CSV file.
Figure 8.20 shows a sample of actual data retrieved for the query when selecting the query name.

Figure 8.19    Data Tab with Query Information

Figure 8.20    Data Provider with Data
To view the values returned within a single object, just enter Data mode and then select an object from the available objects list. This includes objects retrieved by your queries and also locally created variables. Figure 8.21 shows the data values for the City object retrieved from Query 1.

Figure 8.21    Data Values in the City Object
Next, we'll look at how to configure report properties to help maintain a defined standard for reporting and add a consistent look and feel to your reporting documents.









8.9    Style Sheet Modification
Report designers now have the capability to create reports that contain a consistent set of style features across multiple reporting documents. This feature allows report designers to change the default style of a Web Intelligence report by importing a customized style sheet or Cascading Style Sheet (CSS) file.
Users can also export all of the existing formats created in a report to a new, unique style sheet. This is a very powerful feature because it gives report designers the freedom to modify a wide variety of visual settings through the toolbar, and then save all of those settings into a single CSS file that can be applied to other reports.
To change the default style of a report, click on the Properties tab while in Design mode, and then select the Document button shown in Figure 8.22.

Figure 8.22    Opening the Document Properties

Note
Style sheet modifications do not affect the color or properties in charts.

Changing the Default Style
Located in the lower-left corner of the Document Properties window is a new category listed as Default Style. Within this category is a single Change Default Style button. Click on this button to import a new CSS file or export the existing formatting settings to a new CSS file.
Figure 8.23 shows the Document Summary window. Notice the Change Default Style... option located in the lower-left corner of the Document Summary. Click this button to import a different style (and CSS file), export the current style, or reset the current style in the report to the default style.
After clicking on the Change Default Style... button, the Default Style window appears with the following three options (Figure 8.24):


Import Style...


Export Style...


Reset Standard Default Style


Clicking on Import Style allows you to search for a local CSS file to assign to the current Web Intelligence reporting document. Clicking on Export Style gives you the option to save the formatting within the current document to a new CSS file that can be used in other reports.

Figure 8.23    Changing the Default Style of a Report

Figure 8.24    Importing, Exporting, and Resetting a Default Style
Be sure to choose an appropriate name and location when saving a new CSS file. The file can also be shared with other users or be published to a shared directory on a network.
After you've exported a reporting style as a local CSS file, you can begin making edits to the file outside of Web Intelligence and then reimport it into the current report or any other Web Intelligence report in SAP BusinessObjects BI 4.2.
Open the CSS file with your preferred file editor, such as Notepad or WordPad, to make changes to any of the attributes outlined in the file. The following is just a sample of the settings that can be edited in the CSS file:


                Font-family
            

                Font-size
            

                Color
            

                Font-weight-bold
            

                H-Spacing
            

                V-Spacing
            

                Page-records-horizontal
            

                Page-records-vertical
            

                Page-format-dimension-width
            

                Page-format-dimension-height
            

                Page-format-margin-top
            

                Page-format-margin-left
            

                Page-format-margin-bottom
            

                Page-format-margin-right
            

                Background-color
            

                Background-fill
            

                Background type
            

                Text-v-align
            

                Text-align
            

                Min-width
            

                Min-height
            

Formatting is grouped into several functional sections that match the structure of a report. The following is a sample of the formatting groups that contain editable formatting sections:


General settings


                        Font-family
                    

                        Font-size
                    

                        Font-color
                    

                        Font-weight
                    

                        Default-date-h-align
                    



Report and Areas


                        Page body section
                    

                        Page header
                    

                        Page footer
                    

                        Settings for sections
                    



Tables and Forms


                        Settings for a table
                    

                        Settings for a form
                    



Charts


                        Not supported in CSS attributes
                    



Columns and Rows


                        Column width default size and break separator
                    

                        Row height default size and break separator
                    



Cells


                        Several cell attributes for the various sections in a report. A few of the possibilities include changing the default attributes in the following areas: page header, page footer, page body, cell in a section, and summary cells.
                    



Table Cells


                        Various cell attributes of formats within a table
                    



Global standards can be created by system administrators by editing the WebiDefaultStyleSheet.css file located on the server. Always make a backup copy of this file before making any changes in case you need to revert back to the default CSS settings.
A few of the key reasons to update the WebiDefaultStyleSheet.css file is to standardize on import data display formats and to also include a company logo on every report with consistent size and placement on the report.

Note
Chart colors are managed globally in the VisualizationConfig.template.xml file located at C:\Program Files (x86)\SAP BusinessObjects\SAP BusinessObjects Enterprise XI 4.0\images in a Windows Server deployment.
A corporate color palette can be defined by editing any or all of the 32 colors in this file. Colors in this file are defined in four color-defining strengths: red (R), green (G), blue (B), and the level of transparency (A). An example color definition is <COLOR A="255" B="125" G="125" R="0"/>.

Standardizing on a collection of settings defined in a CSS file provides for a more consistent presentation of reports and a more cohesive overall reporting solution. This feature also saves report developers a significant amount of time compared to working in previous versions that require making configuration changes to individual reports to attain visual consistency.









8.10    High Precision Numbers
SAP BusinessObjects BI 4.2 now provides the capability of displaying "big numbers" accurately in a Web Intelligence report to 40 digits of precision. This is done in the Report Panel when a measure object is converted to a decimal.
Right-click on a measure object and then select Decimal. This settings change will allow the measure object to display any fractional number with precision. Figure 8.25 shows the Quantity sold object being converted to a decimal.

Figure 8.25    Converting a Standard Measure Object from a Number to a Decimal









8.11    Geolocalizing a Dimension
Before being able to use geographical charts (see Chapter 6, Section 6.2.6), you need to geo localize the objects that you want to display in your charts, in order to define their position. This step is called geolocalization and is done in Web Intelligence.
Once geolocalized, the dimension's additional, geographical details are saved in the Web Intelligence document itself. It means geolocalization must be completed for each document where you want to enforce a dimension's geographical data. One workaround is to save the dimension after it has been geolocalized in a shared element, so the geographical enrichment can be shared among the documents using this shared element (see Chapter 19, Section 19.1).
There are two methods for geolocalization: by name or by latitude/longitude.
8.11.1    Geolocalize by Name
The first method of geolocalization is to use geographical names contained in your dataset.
Web Intelligence recognizes four types of geographical levels: country, region, sub-region, and city.

Recognized Cities
In SAP BusinessObjects BI 4.2, only cities with more than 100,000 inhabitants are recognized. In SAP BusinessObjects BI 4.2 SP 3, this limit has been lowered to 10,000 inhabitants for cities in the United States .

Geolocalization requires that all values returned by the dimension for enrichment are of the same level (that is, it is not possible to geolocalize a dimension if it returns both countries and cities).
To geolocalize a dimension that returns geographical names, follow these steps:


                    Open the Web Intelligence document and in Design mode, open the Available Objects side panel.
                

                    Select the dimension and right click it. In the contextual menu, shown in Figure 8.26, select the Edit as a Geography • By Name... command.
                    
Figure 8.26    Edit as a Geography Menu


                    In the Edit Geography dialog box that opens (see Figure 8.27), use the Level drop-down list to select the level of geographical names returned by the dimension. As shown in Figure 8.28, you can choose from Country, Region, Sub-Region, and City.
                    
Figure 8.27    Edit Geography Dialog Box

Figure 8.28    Select Level


                    After the level has been selected, the table beneath displays all values returned by the dimension and proposes a match regarding the selected level, as shown in Figure 8.29. The percentage displayed after the proposed match indicates the confidence.
                    
Figure 8.29    Proposed Geographical Mapping


                    If you are not satisfied by the proposed named or if no mapping has been proposed, you can use the drop down menu in the Location column to select another value.
                    For more choices, select the Select location command (Figure 8.30). The Select location dialog box is where:
                    

                            More choices are proposed for you. You can type a location in the text field and click the binoculars icon  to filter the proposed list.
                        

                            You can click Add Location... to open the Add Location dialog box shown in Figure 8.31 where you can explicitly enter the latitude and longitude. 


                    You can select one option and then click OK. The dialog box closes and the selected value is displayed in the Edit as a Geography dialog box.
                    
Figure 8.30    Choosing Location among More Choices

Figure 8.31    Explicitly Adding Latitude and Longitude


                    The Summary section displays how many values are returned by the dimension, how many are resolved , how many are unresolved , and how many are not mapped , which appear as follows:
                    

Resolved: One match has been defined for this value.
                        

Unresolved: Several matches are possible. By default, the one with the highest confidence is selected.
                        

Missing: No match has been found.
                        

                    The same icons are used in the table. You can use the Show drop-down menu to filter the values in the table and display only the values in a specific status.
                

                    Repeat these steps until all values are mapped, as shown in Figure 8.32. Then, click OK to validate the mapping and close the dialog box.
                    
Figure 8.32    All Values Are Geolocalized


                    As shown in Figure 8.33, the new geolocalized dimension can be easily identified in the Available Objects pane:
                    

                            It now displays a new icon .
                        

                            As the dimension has been enriched with geographical data, new details are added to this dimension: latitude, longitude, and full name description. As shown in Figure 8.34, these details can be used in your report like any other objects.
                        




Figure 8.33    Geolocalized Dimension Displayed in Available Objects

Figure 8.34    Using Geolocalized New Dimension's Details
Once a dimension data has been geolocalized, you can use it in geographical maps to locate and display your report figures, as described in Chapter 6, Section 6.2.9.
Geolocalization based on names requires several manual steps. For this reason, another process to geolocalize dimension has been introduced in SAP BusinessObjects BI 4.2 SP 3, based on latitude and longitude.
8.11.2    Geolocalize by Latitude and Longitude
Data sources often contain geographical data based on their longitude or latitude. This is the case for plant locations. This is the format used by devices to return coordinates, and is also how plant locations are defined. If these latitudes and longitudes are stored in your data source you can query them, and you can use them to quickly geolocalize your data.
Assuming you have two dimensions that return data, follow these steps:


                    Open the Web Intelligence document and in design mode open the Available Objects side panel.
                

                    Select a dimension to add a geographical dimension. This can be a plant ID or a name, for example.
                

                    Right click it and in the contextual menu shown in Figure 8.26, select the Edit Geography • By Latitude/Longitude command.
                

                    In the Edit Geography dialog box, shown in Figure 8.35, use:
                    

                            The Latitude drop-down menu to select the object that returns latitude values.
                        

                            The Longitude drop-down menu to select the object that returns longitude values.
                        


Figure 8.35    Selecting Latutude and Longitude


                    Click OK to validate your choice and close the dialog box.
                

                    The dimension has been geolocalized due to the coordinates coming from the two selected objects. It can be easily identified in the Available Objects pane by its new icon . New latitude and longitude details are also added to this dimension. They can be seen as duplicate with the ones used for the geolocalization.
                

This new geolocalized dimension can be used in geographical maps to locate and display your report figures, as described in Chapter 6, Section 6.2.9.









8.12    Summary
Web Intelligence provides a full spectrum of reporting properties, tools, and formatting. The side panel in the Report Panel offers easy-to-access tools for reports designers and users to find metadata information about reports. It's important to keep report properties up to date with detailed and relevant descriptions so that users can understand the context of the report's content.
Additionally, the side panel allows for robust user interaction by using input controls. Input controls can be created against dimensions, measures, or variables, and they allow the report user to filter data and change parameters in real time.
As a report designer, you have the ability to enrich the report content by setting a measure as a high precision decimal, which provides more precision for computation as decimals are stored in 40 digits, and by geolocalizing dimensions so they can be used on geographical charts
Next, Chapter 9 takes a deep dive into filtering data in both the Query Panel and Report Panel. Now that you've learned how to navigate a report's metadata and properties, you'll learn how to filter data in a report to make reports more meaningful for users.








9    Filtering Data in the Query Panel and Report PanelWeb Intelligence provides several different ways to filter data and present specific information for answering business questions. Whether you are restricting data in the Query Panel or filtering results in the Report Panel, you have many options for displaying detailed and accurate company information.Applying filters to reports and report parts produces documents that provide business users with pertinent information that's relevant to the specific criteria needed for analysis. Restricting data at the query level is accomplished by applying filters in the Query Panel. A structured query language (SQL) script will be generated based on the objects in the panel and submitted to the database for retrieval. Query filters translate to the where clause of the generated SQL statement and minimize the amount of information returned to the microcube in a Web Intelligence document.After running or refreshing a query, you can further restrict the data appearing in your reports by applying any number of report-side filters. Several different types of filters are available in the Report Panel that can be applied to entire documents, specific reports, or to individual report elements. Among the various types of filters available are: report filters applied in the Filter Bar, block filters applied directly to specific report elements, input control filters, and conditionally hidden report elements.This chapter covers the various data filtering methods to explain how each method is accomplished in Web Intelligence.
9.1    Filtering in the Query Panel
Query filtering restricts the amount of information retrieved from a data provider when a query is refreshed. Query filtering is achieved by including any of three filter types when creating a query:


Predefined filtersFilter objects created in the universe.
            

User-defined filtersFilters defined in the Query Panel.
            

Prompted filtersFilter objects that prompt users for input.
            

Let's examine each of these more closely.
9.1.1    Predefined Filters
Predefined filters are objects that have been previously set up in the universe. These filter types are symbolized with a yellow funnel icon and contain SQL syntax that assigns a value to an object or contains a formula to calculate the value.
Figure 9.1 shows four predefined filters in a query sourced from the eFashion universe.

Figure 9.1    Identifying Predefined Filters in the Query Panel
This example shows how predefined filter objects appear to users in the Query Panel of a Web Intelligence 4.2 document. These filter objects are often aliased with descriptive terms that easily communicate the function of the filter to business users for intuitive report filtering.
A predefined filter generally contains the assignment of a specific value or set of values and also a description. Figure 9.1 shows the filter object definition for the Christmas period object in the eFashion universe while editing the properties of the object in the Universe Design Tool of SAP BusinessObjects BI 4.2.
The key element in a predefined filter is the Where section in the filter definition. Figure 9.2 sets the Where section of the Christmas period filter for the Calendar_year_lookup.Week_In_Year to be between week number 46 and 53. Whenever this object is used in a query, the data returned will have occurred within this weekly time frame.

Figure 9.2    Properties of the Predefined Christmas Period Filter Object
The Description field of a filter object plays an important role because it communicates additional information about the object to the user when creating a query.
Hover over a predefined filter in the Query Panel to see the filter's description. Figure 9.3 shows the description of the Christmas period object that appears when you hover over it in the Query Panel.

Figure 9.3    Predefined Filter Descriptions
In many cases, predefined filters need to be applied by default to every query created from a specific universe. This can be accomplished by checking the Use filter as mandatory in query option when creating or editing the filter object properties in the Universe Design Tool (see Figure 9.4).

Figure 9.4    Applying Filter as Mandatory Query
As a universe designer, you'll have the opportunity to set a predefined filter to be applied on either the entire universe or the class where the filter is saved. These options become enabled when the Use filter as mandatory in query checkbox is checked.
A single predefined filter can either include the assignment of values to multiple objects or contain a variety of complex formulas. By adding a predefined filter to a Web Intelligence query, you ensure that the data returned to the microcube will be restricted by the conditions defined in the filter.
When creating a predefined filter object, make sure that you name the object with a term or short phrase that clearly describes the purpose of the filter with terminology known by the user community and anticipated audience.
9.1.2    User-Defined Filters
User-defined filters are created in the Query Panel by adding dimension, detail, or measure objects to the Query Filters pane. Objects are added to the Query Filters pane by dragging them from the universe outline and dropping them in the Query Filters pane.
After adding an object to the Query Filters pane, you need to select an operator for the object. By default, the operator assigned by Web Intelligence is In List. Change the operator by clicking on the small down arrow located immediately to the right of the existing operator. Figure 9.5 shows the Quarter object after it has been added to the Query Filters pane.
After an operator has been selected, click on the icon to the right of the input box to select the assignment type.

Figure 9.5    Viewing a Dimension Object in the Query Filters Pane
The following operators are available for creating filters with detail, dimension, or measure objects:


In list


Not in list


Equal to


Not Equal to


Greater than


Greater than or Equal to


Less than


Less than or Equal to


Between


Not Between


Is null


Is not null


Matches pattern


Different from pattern


Both


Except


Figure 9.6 shows the assignment type choices available in Web Intelligence 4.2 when creating a user-defined filter. The default assignment type selection is Constant.

Figure 9.6    User-Defined Filter Assignment Types
The following are filter assignment types:


ConstantAllows the user to type a constant value.
                

Value(s) from listLaunches the List of Values dialog box to select one or more values from a distinct list of values for the selected object.
                

PromptPrompts for user input when a query is refreshed.
                

Object from this querySelects from the available objects and variables (not enabled when the In List or the Not In List operator is selected).
                

Results from another querySelects a value from a different query within the same document.
                

When a measure object is added to the Query Filters pane, a small calculator icon appears inside the value box. This icon is used to launch a calculator panel and provide users with the capability to add a specific number without using their keyboard. Figure 9.7 shows this calculator panel with a measure object.

Figure 9.7    Calculator Panel in the Measure Filter
Remove Filter Objects from the Query Filters Pane
To remove filter objects, choose any of these methods:


                        Select the filter and press (Backspace).
                    

                        Drag the filter from the Query Filters pane and drop it in the Universe Outline panel.
                    

                        Select the filter, and then click on the X in the upper-right corner of the pane.
                    

                        Click on the Remove All button in the upper-right corner of the pane.
                    

Figure 9.8 shows the icons located in the upper-right corner of the Query Filters pane.

Figure 9.8    Removing One or All Filters
Use these icons to remove a single filter or to remove the entire set of query filters. You'll be prompted with a dialog box asking, Are you sure you want to delete all filters?
If you click on Yes, all of the filters will be removed without an option to undo the changes.
9.1.3    Filtering with Wild Cards
You can use wild cards to help you filter an object when the entire value isn't known, such as when the exact spelling of the intended filter is uncertain.
Wild cards are created by using the Matches pattern operator. Figure 9.9 shows the State object using the Matches pattern operator and % wild card to return all states that begin with C.

Figure 9.9    Query Filter Using Matches Pattern and the % Wild Card
Use the underscore character for each character to be represented in a filtered value. For example, if you want to filter an object to return the color beige, use both wild cards in combination with the known characters.
Figure 9.10 shows two different wild cards with the Color object, in which a percentage sign is used to represent any number of characters, and an underscore is used to represent a single character.

Figure 9.10    Custom Filter Containing the Wild Cards _ and %
The Matches pattern operator is converted to LIKE when the SQL statement is generated. Figure 9.11 shows the SQL translation of the operator in combination with the % wild card.

Figure 9.11    Matches Pattern Converted to LIKE in Generated SQL
Figure 9.12 shows the SQL generated by the Matches pattern operator that includes an underscore wild card and a % wild card.

Figure 9.12    SQL Generated by the Matches Pattern Operator
9.1.4    Nested Query Filters
You can use nested query filters to group a series of targeted constraints that return a precise data set. When you nest filters, dimensions and measures can be grouped into several combinations by using the AND or OR operators. Nested filters can be applied to many layers of grouped objects with the AND or OR operator. This method of filtering is very easy to set up.
Adding and Nesting Query Filters
To add and nest query filters, follow these steps:


                        Drag and drop predefined filters, prompted objects, or standard results objects into the Query Panel.
                    

                        Drop the filter directly on top of an existing filter object to nest the filter.
                    

                        Drop the filter immediately beneath an existing filter to apply filtering outside of a nested relationship.
                    

                        Double-click on the AND and OR operator located immediately to the left of the nested group to toggle the operator type.
                    

Figure 9.13 shows several query filters included at the same level in a Web Intelligence document grouped by default with the AND operator. If a query containing the filters in the screenshot were executed, the result would include only results from the current year's Christmas period, Owned stores only, and for color lines that begin with "Be". The results must meet all criteria for results to be returned.
But if the filters were grouped using the OR operator for the collection of filters, the SQL statement would be generated differently and results would be returned relating to any of the four filters rather than all four.

Figure 9.13    Query Filters Grouped by the AND Operator

Note
The default group operator is AND. Double-click on it to change it to OR. Query filters can be grouped by both AND and OR in the same document.

Nesting Filters
Figure 9.14 shows the exact same filters listed in the previous screenshot, but the results from the two queries are quite different. The SQL statement generated with this set of query filters returns rows that meet the criteria from two pairs of filters separated by the OR operator. Results from This year or when the Color object begins with "Be" make up the first pair of filters; the second pair limits the results to either Owned stores or Christmas period.

Figure 9.14    Nested Query Filters
Query filters can be added to a nested group with objects that have already been added to the Query Filters pane or by dragging and dropping new custom or predefined filter objects into the Query Filters pane.
Creating a Nested Group
To create a nested group, drop an object on top of an existing filter in the Query Panel. A thin vertical line will be displayed to the left of two or more filters to denote that a nested group has been created with the filters. Double-click on AND to the left of the thin vertical line to switch the nested group to the OR operator.
This can also be achieved with existing filters by dragging and dropping an object on top of another filter to add it to an existing group. Figure 9.15 shows the predefined Christmas period filter being dropped onto the Owned stores filter to create a new nested filter group.

Figure 9.15    Creating a New Nested Group with Existing Query Filters
Removing Query Filters from a Nest
To remove a query filter from a nested group, drag and drop it to a different location. This can mean moving it to a different nested group, moving it to the bottom of the list of query filters to be outside of all filter groups, or dropping it back into the Available Objects section to completely remove it from the query.
Figure 9.16 shows the This year object being moved from a nested group and dropped to the bottom of the query filters.

Figure 9.16    Removing a Query Filter from a Nested Group
9.1.5    Value(s) from List
When Value(s) from List is selected as the filter assignment type, a full distinct list of the values that belong to the object being filtered will be displayed.
Lists of values (LOVs) are either enabled or disabled when the objects are created in the universe. Custom LOVs can also be created in the universe to provide cascading prompted filtering to report consumers.
To select values from the List of Values dialog box, follow these steps:


                    Select Values from the list of distinct values to be included.
                

                    Click on the > button to add the values to the Selected Value(s) box.
                

                    Click on OK to accept.
                

9.1.6    Prompted Filters
Use prompted filters to require report consumers to provide input when refreshing a report. The user's response will be passed into the where clause when the SQL statement is generated.
When a Web Intelligence reporting document is saved with the document property option Refresh on open selected, and the document includes prompted filters, users will be required to answer the prompt(s) as the report opens.
If Prompt is selected as the filter's assignment type, a Prompt Properties icon will be displayed to provide options for configuring the prompt (see Figure 9.17).

Figure 9.17    Locating the Prompt Properties Icon
In Chapter 12, Section 12.2 presents the BI variants that simplify how you can answer prompts.
Prompt Filter Properties
When a prompted filter object is included in a query, report developers have the opportunity to revise a variety of properties for each filter object.
Figure 9.18 shows the Prompt Properties window that is launched when you define a prompt. The following are the associated properties:


Prompt textA prompt text is added by default. This property is important if the document and filter will receive values passed to it with a hyperlink. This is discussed in detail in Chapter 15.
                    

Prompt with list of valuesThis property displays a distinct LOV for the object being filtered.
                    

Keep last values selectedThis property defaults to the last value selected.
                    

Select only from listThis property requires the selection to be made only from the provided LOV rather than allowing freehand entry.
                    

Optional promptThis property permits the prompt to be optional rather than required.
                    

Set default valuesThis property allows a default value to be added to the filter.
                    


Figure 9.18    Prompt Dialog Box for Configuring Prompted Filters









9.2    Complex Filtering Options
Several techniques can be employed in the Query Panel to filter data retrieved by a query. Chapter 2 discussed how to easily create filters to narrow down the data set returned by the queries. This section covers additional methods of filtering queries to produce reports that contain the data needed for solving specific business problems.
9.2.1    Database Ranking
Database ranking is used in a reporting document to return only the rows meeting the ranking criteria. By pushing ranking onto the database instead of performing ranking locally, you can significantly minimize the amount of data retrieved in a Web Intelligence document.
However, you can use database ranking only if your database supports it. The addition of a database ranking shortcut icon will be disabled if your database doesn't support ranking.
Adding Database Ranking
You can add database ranking to a document by clicking on the Add a database ranking button located in the upper-right corner of the Query Filters pane, as shown in Figure 9.19. Click this icon to configure the database ranking parameters. The default setup is arranged to return the Top 10 <dimensions> based on a <measure>. Following are details about the options available when adding a database ranking:


Rank directionThe default ranking number is set to 10 but can be adjusted up or down:
                        

Top: Returns the top 10 <dimension> object values based on the <measure>, with the number 10 being adjustable.
                            

Bottom: Returns the bottom 10 <dimension> object values based on the <measure>, with the number 10 being adjustable.
                            

% Top: Returns the top 10% of the <dimension> object based on the <measure>, with 10 being adjustable.
                            

% Bottom: Returns the bottom 10% of the <dimension> object based on the <measure>, with 10 being adjustable.
                            



Ranked numberUse the default number of 10, change to a different constant value, or prompt the user for a value.
                    

Context for rankingInsert a dimension object to be used in the ranking by dragging and dropping it into the database ranking structure.
                    

Ranking based onDrop a measure object as the basis for the ranking.
                    

Optional rankAdd another dimension object to rank by.
                    

Ranking filteringDrop predefined filters or objects for custom filters to restrict the data set returned by the ranking query.
                    


Figure 9.19    Adding Database Ranking in the Query Panel
The Database Ranking Parameters filter will be added to the Query Filters pane when Add a database ranking is clicked. Figure 9.20 shows the database ranking parameter filter object.

Figure 9.20    Database Ranking Parameters
Enabling Database Ranking
To complete the parameters for database ranking, follow these steps:


                        Select a ranking direction (Top or Bottom).
                    

                        Enter the number of records to be ranked, or click on the small down arrow beside the value box to select Prompt. The default value is Constant.
                    

                        Drop a dimension object for the context of the ranking.
                    

                        Drop a measure object to be ranked in the Based on box.
                    

                        (Optional) Specify additional calculation context by clicking the small arrow to the right of the Based on measure to expand the Ranking Parameters box and display a For Each (dimension) option.
                    

Whenever possible, apply complex filtering options at the query level rather than at the report level to produce a result set that already meets the business requirements. Simple filters added in the Report Panel can be easily removed and can potentially misrepresent the information. By restricting the results at the query level, only the needed information is returned.
Filters can also be added at the query level that prompt users for input when the report is opened or refreshed. The next section describes how to set up optional prompts that present users with a list of available values to select from.
9.2.2    Subqueries
Subqueries are used in Web Intelligence to produce a query within a query. This type of document is used when the primary query needs to be filtered by the inner query or subquery. When a query containing a subquery is refreshed, the subquery runs first and then returns the values to be filtered in the main query. This type of query is used when the main query needs to be filtered by a value that isn't known at the time of refresh.
Figure 9.21 shows how you can add a subquery to an existing filter by simply clicking on the Add Subquery button in the upper-right corner of the Query Filters pane.

Figure 9.21    Inserting a Subquery into the Query Filters Pane
After adding a subquery to your document, you'll need to drag predefined filters or custom-defined object filters into the new Subquery Filter window to create the "query within a query" effect.
An example scenario for using a subquery is the requirement to return all cities within two selected states. This is accomplished with the following steps:


                    Create a query from the eFashion universe, and then add the City object to the Result Objects pane.
                

                    Select the City object in the Result Objects pane.
                

                    Click on the Add a Subquery button in the Query Panel to create a subquery for the City object.
                

                    Drag the State object into the Subquery pane of the City object.
                

                    Set the State operator to In List.


                    Select Value(s) from List for the State filter, and then move New York and California to the Selected Value(s) frame.
                

                    Run the query.
                

The results returned will include only cities within California and Texas. Figure 9.22 shows the City and State subquery used in the example.

Figure 9.22    Subquery Example for City and State
9.2.3    Dynamic Default Value for UNX Prompts
Dynamic date filtering is now available for parameters created in the Information Design Tool. If your users have ever asked for a date prompt in a query to default to the previous day, or a year prompt to default to the current, then you'll be happy with this new feature introduced in SAP BusinessObjects BI 4.1 SP 6. We'll describe the dynamic date filtering, but this can be extended to any formula you can define in the universe.
To get started, import your UNX universe into the Information Design Tool and navigate to the business layer. This is the universe layer with the suffix .blx.
Create Parameter Formulas
With the business layer selected, follow these steps to create a default value formula to dynamically associate the previous date to a date prompt in a report:


                        Navigate to the Parameters and Lists of Values section.
                    

                        Under Parameters, click the + symbol to inert a new parameter.
                    

                        Give the new parameter a name and a prompt text value.
                    

                        Change the data type to date.
                    

                        Under the Default Values section, check the Set default values box, select the Formula option, and click the ellipsis button to enter a formula. Figure 9.23 shows the formula entered as CurrentDate()-1 to set the default value of the parameter to yesterday.
                        
Figure 9.23    Configuring a Parameter in the Information Design Tool


                        Uncheck the Keep last values checkbox and click OK to create the new parameter.
                    

                        Save the universe and publish it to the BI platform repository. You're ready to use it in your reports.
                    

Connecting a Parameter with a Default Value to a Prompted Report Filter
Here are the steps to associate a parameter to a prompted filter in a Web Intelligence query:


                        Open an existing reporting document or create a new one and enter the Query Panel.
                    

                        Add the object to be associated with the parameter to the Query Filters pane.
                    

                        Change the filter type from Constant to Prompt, as pictured in Figure 9.24.
                        
Figure 9.24    Change Filter Type from Constant to Prompt


                        Click the Prompt Options button located to the left of the Prompt Type button.
                    

                        Change the prompt type from New Prompt to Use Universe Parameters. This is pictured in Figure 9.25.
                        
Figure 9.25    Changing the Prompt from New Prompt to Use Universe Parameters


                        Select the parameter created in the previous section called DateStart and click OK.
                    

                        Save your report and click Refresh to see the default value based on the formula.
                    

That's it! Following these steps will allow you to set a default value based on a formula created in a universe parameter.
9.2.4    Filtering through BI Sets
BI sets were already available as a separate tool (Set Analysis) in SAP BusinessObjects XI 3.x portfolio. They have been reintroduced in SAP BusinessObjects BI 4.2 SP 3 through an integration with Information Design Tool and the BI platform.
To summarize, BI sets are pre-calculated list of values. BI sets are created in Information Design Tool, based on metadata defined in relational universes.

Supported Databases
BI sets can only be created on relational universe that queries SAP HANA, Microsoft SQL Server, IBM Netezza or Oracle databases.

Your universe designer can create BI sets through different techniques:


                    By defining sequence of steps to narrow down the members to include, based on data distribution, formula or query panel.
                

                    With Venn diagram, as shown in Figure 9.26, to combine existing BI sets through sets operators (union, intersection, minus).


Using this set logic is simpler to define members sets rather than using SQL.
These BI sets members are saved in the production database, and their creation can be scheduled. As the members are precalculated; performance to retrieve these members is greatly improved at query time. There are two types of sets:


                    Static sets: whose content is not based on time
                

                    Temporal sets: that allows you to analyze the set evolution over a suite of defined periods. These periods are also defined in Information Design Tool by your universe designer.
                


Figure 9.26    Sets Creation in Information Design Tool

Example
You can define your list of premium customers as a static set. But if you want to analyze how this list is evolving each month, you might use a temporal set. The temporal set allows you to get the list of customers who have left the premium category the last two months.

In Web Intelligence, BI sets appear in the Query Panel, in the universe outline when you create a query on top of the universe on which they have been created. As shown in Figure 9.27, BI sets are displayed as filters:


                    Filters based on static BI sets 


                    Filter based on temporal BI sets 



Figure 9.27    Query Panel with BI Sets Displayed as Filters
Let's explore the difference between these two filters.
BI Sets Used As Filters
In the Query Panel, a static BI set can be seen as a predefined filter. Select this BI set and add it to your query to filter your dataset with the member of the BI set.
If you display the automatically generated SQL (see Chapter 2, Section 2.2.4), you can see how the set members are saved in the database and how the filter is used in the query, as shown in Figure 9.28. The potential complexity of computing these members is hidden since members have been pre-calculated and saved in the database.

Figure 9.28    Generated SQL
Temporal BI Sets Used as Filters
Temporal sets are sets based on calendar defined by your universe designer. These calendars contain periods and the temporal sets can be used to see the evolution of the members of the sets over these periods. When you use a BI set as a filter, you can select the members that will filter your query.
For example, if you create a temporal set for your premium customers, you can see the evolution of your customers in this category over the year and list the ones who have left this category every month to take additional actions.
As shown in Figure 9.29, the possible choices are:


Current Members: Returns the members of the last calculated period.
                    

Members for period: This selection requires you to select an additional operand that can be a list of periods. The resulted members are the ones in the selected periods.
                    

Members who joined: This selection returns the members of the BI set who have joined the set in the specified period.
                    

Members who left: This selection returns the members of the BI set who have left the set in the specified period.
                        
Figure 9.29    Selected Members Available for Filter Based on Temporal Set


Depending on your choice, you may need to provide an operator, and depending of this operator, zero, one or two additional operands to specify the filter to apply. The list of authorized operators and the operands they require are described in Table 9.1.




                                Member Selection
                            

                                Operator
                            

                                Operand
                            





                                Current members
                            

                                No additional operator or operand is required. It simply returns the members of the last calculated period in the calendar.
                            



                                Members for period
                            

                                This selection requires only one additional operand that can be a list of periods. The resulted members are the ones in the set in the selected periods.
                            



                                Members who joined
                                Members who left
                            

                                Equal to
                                Not Equal to
                            

                                List of periods.
                            



                                Between
                                Not Between
                            

                                Two periods (period 1 and period 2) from the set calendar.
                                The resulting period is the one between the start date of the first selected period and the end date of the second, selected period.
                                If the second period precedes the first one, then the resulting period is empty.
                            



                                Less than
                                Less than or equal
                                Greater than
                                Greater than or equal
                            

                                A period.
                                If you select several periods, only the oldest period is taken into consideration.
                            



Table 9.1    Operator Description
To use a filter based on a temporal set, follow these steps:


                        In the Query Panel, select it and drag and drop it in the Query Filters pane.
                    

                        In the filter, you can select in the drop-down menu the set members to query.
                    

                        Depending on your selected members (Table 9.1), additional drop-down menu may appear (or not) to let you select an operator.
                    

                        Depending on your selected operator (Table 9.1), additional fields may appear (or not) to let you select one or two operands:
                        

                                Click on the first field. A dialog box opens, to let you select one or more periods, as shown in Figure 9.30.
                            

                                Click OK to validate your choice and close the dialog box. Your selected period is displayed in the text.
                            

                                If your selected operator requires you to enter a second operand, repeat these steps for the second field.
                            


Figure 9.30    Periods Selection


                        As shown in Figure 9.31, filters based on static or temporal sets can be combined with other query filters (predefined filters, nested filters, or subqueries, presented in previous sections) to create complex query filters.
                    

                        After you have added filters based on BI sets to your query, you can continue to build your query.
                    

                        When your query is ready, run it to retrieve the dataset. As for any query filters; filters based on BI sets are applied when the query to the data source is generated, by adding these filters to the query.
                        
Figure 9.31    Combining Filters and Different Filters Based on BI Sets


Once dataset has been retrieved in the documents, Web Intelligence proposes additional methods in the report itself to filter dataset(s) retrieved from query, or queries.









9.3    Filtering in the Report Panel
Report filtering provides business users with the capability to display a small subset of data in a report rather than everything returned from the query and stored locally within the microcube.
It's very common for business requirements to call for Web Intelligence reports that contain charts for specific values in a data set along with additional charts or data table elements that display diverse divisions of the values. This type of functionality is possible in Web Intelligence by applying different report filters to each element (chart, table, or section) within a report.
When values are filtered in a report, the data is hidden only from the user and remains within the microcube for use in other report tabs within the document. This way, business users can insert new report tabs and set up new filters without affecting other reports in the same document.
Filtering report data can be achieved by performing the following actions:


                Adding simple filters to entire reports by assigning values to objects on the Filter Bar


                Adding filters to specific elements in a report by assigning values to objects in the Report Filter Panel
            

                Interacting with report data by using input controls
            

9.3.1    Simple Filtering with the Filter Bar
Simple report filters are easily added to a reporting document by clicking on the Filter Bar button in the reporting toolbar while in Design mode.
The ideal method of adding simple report filters entails the following three steps:


                    Enter Design mode.
                

                    Select the Analysis tab.
                

                    Click on the Filter Bar button located on the Interact subtab.
                

Figure 9.32 shows the Filter Bar button on a report in Design mode. Enabling the Filter Bar lets you drop objects onto the bar for simple report filtering.

Figure 9.32    Enabling the Filter Bar in Design Mode
Simple filters can be added to the Filter Bar from either reading or Design mode. To add filters in Reading mode, enable the filter and click the icon to add filters, as indicated in Figure 9.33.

Figure 9.33    Report Filter Bar with Objects Added
If you're using the Applet, simple report filters are added to the Filter Bar by dragging and dropping them onto the bar. If you're using the HTML client, you'll need to click the icon on the Filter Bar to select the objects to be added.
Once an object has been added to the filter, a distinct list of values will be displayed in dropdown components, providing a simple method of filtering the entire report.
Simple filtering can be toggled on or off by selecting the Report filter toolbar icon located on the Analysis tab in the toolbar.
9.3.2    Report Element Filters
Report element filters can be added to single data blocks, charts, sections, or to entire reports. This type of filtering is applied to reports while in Design mode only.
Follow these steps to add a filter to a specific report element:


                    Right-click on the element and select Filter from the list of choices.
                

                    Select Add Filter to launch the Report Filter window.
                

                    From the Filter Map pane in the Report Filter window, select the report element to assign the new filter to and click on Add Filter.
                

                    Choose from the list of available objects to begin creating the filter.
                

                    Select the operator for the filter.
                

                    Assign or enter a value and then click on OK.
                

Figure 9.34 shows the menu displayed when right-clicking on a report element.

Figure 9.34    Adding a Filter to a Report Element
Choosing Add Filter allows you to place a filter on the element selected or switch to another element on the current Report Panel. From this menu, you can also edit or remove existing filters or add a new input control filter (Section 9.3.3).
Every element (chart, table, section, or report) on the Report Panel can be assigned one or more unique filters for the creation of highly customized reports.
The Report Filter window lets you assign filters to every element on the Report Panel without having to right-click on each element individually. Select the element from the Filter Map pane that you'd like to assign the filter to, and then click on Add filter.
Notice that charts, data blocks, sections, and even entire reports are displayed in the Filter Map pane for easy configuration of filters (see Figure 9.35).

Figure 9.35    Report Filter Window and the Filter Map Pane
After you select Add filter, the list of objects available in the existing report will be displayed. Select an object and click on OK to proceed with creating the filter.
Figure 9.36 shows the Available objects window as it appears when adding a report filter. This window displays all objects retrieved from your query and also existing variables and references (see Chapter 11) created within the report.

Figure 9.36    Available Objects for Creating a Report Filter
After selecting a dimension or measure and clicking on OK, you can select an operator for the filter. The default operator is In List, which allows for multiple selections to be made from a distinct list of values.
Twelve different operators are available for this type of filtering. Figure 9.37 shows a chart element with a single filter assigned to it. In this example, the City object has been selected along with the In list operator. The list of available state values is displayed at the bottom of the screen.
Double-click on or select values followed by clicking on the > symbol to assign a value to the filter. Click on Apply and click OK to accept.

Figure 9.37    Assigning an Operator to a Chart Filter
The next section covers how to use input controls to control data results.
9.3.3    Filtering with Input Controls
Input controls provide users with the flexibility to interact with and analyze report data in several different ways. You can choose from eight different components for filtering single-value dimension objects or four components for multiple-value dimension filtering.
Similar to report element filters, input controls can be assigned to charts, tables, sections, or entire reports.
Input controls are located in the Input Controls side pane. In Design mode, you go to this side pane to create, edit, and manage input controls and groups input controls (Section 9.3.4). In Reading mode, document readers can go to this side pane to get the list of input controls and change the values that filters your document and reports.
Creating New Input Controls
To create an input control, enter Design mode and right-click on a report element. Then click on Filter • Filter by a New Input Control.... Figure 9.38 shows a portion of the menu displayed when you right-click on a report element with Filter selected.

Figure 9.38    Adding a New Input Control When Right-Clicking on a Report Element
Another way to add a new input control is by clicking on the Analysis tab, the Filters subtab, and then Input Controls. This method of adding a new input control is also available only in Design mode and is shown in Figure 9.39.

Figure 9.39    Adding a New Input Control from the Toolbar
There's also a third place you can go to add new input controls. This location is probably the most logical and is found when clicking on the Input Controls section in the side panel. Click the New button at the top of the window to get starting with defining your new input control. This area is pictured in Figure 9.40.

Figure 9.40    Adding a New Input Control from the Side Panel
The Define Input Control window will appear when you start the process of creating a new input control. You'll be prompted to select an object to use as the basis for the new input control filter. The objects can be arranged alphabetically, by query, or by data source. This option is helpful when filtering reports sourced from multiple data sources.
You may also want to create input controls with objects existing in the selected block (chart or data table). This is accomplished by checking the Include objects from selected block only box at the bottom of the window. Figure 9.41 shows these options at the bottom of the Define Input Control box.

Figure 9.41    Properties When Defining a New Input Control
Because text, numeric, dates or hierarchies need to be filtered differently, defining input controls on measure objects is accomplished with a different set of control types and properties.
Adding Input Controls on Dimension Object (Text)
Figure 9.42 shows the types of input controls available for single-value and multiple-value textual dimension objects.
The input controls that allow users to select only one value are:


Entry fieldAllows users to directly type the value for the input in a text field.
                    

Combo boxAllows users to select from a list of possible values with the selected value being displayed in the box.
                    

Radio buttonsEnables users to select from a list of possible values (the selected value is displayed as checked).
                    

List boxEnables users to make several selections from a list of possible values.
                        
Figure 9.42    Input Control Properties for a Dimension Object (String)


The input controls that allow users to select multiple values are:


Check boxesProvide users with the ability to make several selections from a list of possible values (the selected values are shown as checked).
                    

List boxProvides users with the ability to make several selections from a list of possible values.
                    

Figure 9.43 shows the four different single-value input controls displayed in the Input Controls side panel after they have been created to prompt users to filter a document or one of its reports.
Except for the entry field control type, each input control type comes with several modifiable properties. The following input control properties for dimension objects can make a big difference in terms of how data is returned and how the control is presented to users:


LabelThis property is the revisable name of the input control. The default entry is the object name.
                    

DescriptionThis is an optional area for entering a full description of the input control filter. We recommend that you add a complete description of the input control, including the blocks it's assigned to and the business meaning of the filter.
                    

List of ValuesThis property allows for a custom or restricted list of available values to be used. This is a good practice for creating regulated reports that allow users to view and interact only with limited values.
                    

Use Restricted List of ValuesThis property is used in combination with the List of Values property when a custom list of values has been selected.
                    

Allow selection of all valuesChecked by default to show All values as a choice in the input control. If selected, the input control will have All values as its default value. If you uncheck this option, you need to explicitly enter a default value.
                        
Figure 9.43    Entry Field, Combo Box, Radio Button, and List Box Input Controls


Allow selection of null valuesUnchecked by default, allows null values to be selected as a filterable control. If you select this option, then null values are displayed in the input control as [NULL_VALUE].
                    

OperatorThis property provides you with the following six operators for filtering data:
                        

Equal to


Not Equal to


Less than


Less than or Equal to


Greater than


Greater than or Equal to




Number of linesThis property allows designers to set the number values that will be displayed when the input control is viewed. The default setting is 5.
                    

Adding Input Controls on Measure or Dimension (Numeric)
As shown in Figure 9.44, several control types are available for filtering numerical values rather than descriptive data.

Figure 9.44    Input Control Properties for a Dimension Object (Numeric) or Measure
The following are single-value control types:


Entry fieldAllows users to directly type its value for the input in a text field.
                    

SpinnerAllows users to type a value in a text field controlled two arrows beside the field that increase or decrease this value.
                    

Simple sliderAvailable only for dimension whose type is numeric. Enables users to slide a cursor on a rule to select a value.
                    

There is only one input control that allows users to select multiple numeric values:


Double sliderEnables users to slide two cursors on a rule to select a value. The double slider is similar to the simple slider, except it provides users with two sliders for selecting and changing a range of values. This functionality lets users focus on specific data elements that fall within a range defined by the position of the sliders.
                    

Figure 9.45 shows the available control types for a measure object or a dimension that returns numeric value.

Figure 9.45    Spinner and Double Slider Input Controls
Minimum, maximum values and increment must be set on the spinner, simple slider, and double slider input controls at the time of creation.
The filter operator is also adjustable on the single value controls, allowing you to change the default Equal to one of the following operators:


Not Equal to


Less than


Less Than or Equal to


Greater than


Greater than or Equal to


For the double slider, the only available operators are:


Between


Not Between


Adding Input Controls on Dimension Object (Date)
As shown in Figure 9.46, if the selected object is a dimension that returns a date, the possible input controls are the same than for a dimension that returns textual data (Entry field, Combo box, List box, and Radio buttons) plus a Calendar, which allows users to select a date on a pop-up calendar.

Figure 9.46    Input Control Properties for a Dimension Object (Date)
Figure 9.47 shows the input control specific to dimension that returns dates.

Figure 9.47    Calendar Input Control
Adding Input Control on Hierarchy
If the selected object is a hierarchy, then the only possible component is the tree list. This tree list can be used for single or multiple selections, as shown in Figure 9.48.

Figure 9.48    Input Control Properties for a Hierarchy
The Tree list enables users to navigate in the hierarchy using a tree list to select one or several values.
Figure 9.49 shows the input control specific to dimension that returns dates.

Figure 9.49    Tree List Input Control
After choosing the control type, the next step is to assign it to report elements.
Assigning Dependencies to Input Controls
After selecting the control type and configuring the properties of the control, you'll need to assign report element dependencies that would receive the value passed to it. Click on Next on the Choose Control Type window to proceed to the Assign Report Elements window (see Figure 9.50). This is where report elements are selected to have the new input control filter assigned.
Notice that your first option is to select between Whole document and Current report. This is the setting used to make your input control perform as a global filter for the entire document.

Figure 9.50    Assigning Report Element Dependencies in an Input Control
Available elements to assign the input control filters to include the following:


                        Whole document or current report
                    

                        Checkbox for the report (if the current report option is selected)
                    

                        Sections
                    

                        Charts and data tables
                    

The checkboxes indicate that the elements can be selected and explicitly assigned to the input control filter.
When a top-level box is selected (e.g., the report page or section), all elements nested within that object will be checked by default and greyed out. To uncheck a specific child element, you need to uncheck the top-level element and then explicitly check the box of the element(s) requiring the input control assignment.
After you've created one or more input controls, it's time to publish your document to the repository to share it with other users to begin exploring and analyzing the results.
Interacting with Input Controls
Users can interact with input controls while reading reports without a need for editing or working in Design mode. By default, input controls are located on the side panel.
Report data updates instantly as users interact with input control values, thus providing a fluid analysis experience. Figure 9.51 shows a report with two input controls viewed in Reading mode.

Figure 9.51    Input Controls Displayed While in Reading Mode
Editing or Removing an Input Control
To edit the properties of an existing input control, begin by entering Design mode and then locating the input control to be updated. With appropriate permissions, you'll be able to edit and remove any input control existing within the report.
Hover over the input control title of the control to be modified to display three shortcut icons previously not visible. These icons allow you to easily edit, show dependencies, or remove the control. Figure 9.52 shows the wrench icon used to edit an input control in Design mode.

Figure 9.52    Editing or Removing an Input Control
Editing an input control will return you to the window used to define the control during creation. From this screen, you can change the filter's dependencies, modify its properties, or even change the control type.
9.3.4    Input Control Groups
Input control groups are one of the top new features introduced in SAP BusinessObjects BI 4.2 SP 3. This feature is used to allow controls to filter each other when they're in the same group. An example of this can be seen if you have a State filter and City filter. Without adding both objects to the same group, clicking a state would not change the cities listed. So if California is selected in the first input control, the control for city would show states such as Austin, Chicago, Dallas, etc. They are essentially unrelated and freestanding filters. But now with input control groups, if the state and city object have been added to the same group, clicking California would update the city control to only show cities located in California. This method of filtering is often referred to as cascading filters.
Grouping is not required but is an additional feature for a better user experience. Also, multiple groups of filters can exist within a single report tab. When you set values for an input, then the group of input controls displays the filter path (in the selection order) and collapse the input controls where values have already been set.
For example:


                    US > Texas > Dallas
                

Here's an example in Figure 9.53 of a control group named Location Group containing two input controls—State and City. Beneath it are non-grouped controls for Quarter and Month.

Figure 9.53    Input Controls Groups with Non-Grouped Controls
Notice that when Texas is selected from the State control, only Texas cities are available to be selected in the City control. But when Q1 is selected in the Quarter filter, all months can be selected. This is a simple example because we all know that June is not in Q1. But in a business scenario with more complex dimensions, this could be misleading and frustrating to business users. Groups put an end to that type of confusion.
Adding a New Group
To add a new input control group, click the Group button beside New. This is pictured in Figure 9.54.

Figure 9.54    Adding an Input Control Group
You'll have the following options when adding an input control group. These are pictured in Figure 9.55:


                        Giving it a meaningful name
                    

                        Applying it to the entire document or current report
                    

                        Checking the box beside the controls to be added to the new group
                        
Figure 9.55    Grouping Input Controls



Note
You cannot add the same object to multiple groups. You'll get a warning message stating This input control belongs to another group. It will be reset and the filter path modified if you click OK to accept.
Input controls are not eligible to be added to a group unless the All values option has been selected or if it contains a default value.

An example of a two control groups is pictured in Figure 9.56. The State and City object have been added to a group called Location Group and the Quarter and Month object have been added to the group named Timeframe. Now when Q3 is selected, only the months within the selected quarter will be displayed for additional filtering and drilling down to a lower level.

Figure 9.56    Two Input Control Groups









9.4    Conditionally Hiding Report Elements
Conditionally hiding report elements is a type of report filtering similar to the dynamic visibility feature available in SAP BusinessObjects Dashboards. This type of conditional formatting provides designers with the capability of creating reports that resemble and function as dashboards in many ways. This includes adding layers of components onto a single report and then triggering the appropriate components to be displayed based on the result of custom formulas. It may also mean hiding report elements when they are empty.
There are two ways to conditionally hide report elements; both are enabled when in Design mode:


                Right-click on a report element and in the contextual menu, select Hide • Hide When...


                Right-click on a report element and then in the contextual menu, click on Format Table or format chart.
            

Both methods will take you to the General section of the Format window (shown in Figure 9.57, along with the area to enable the Hide When feature) where you can write a formula to allow for conditional visibility.

Figure 9.57    Configuring the Hide When Feature
The Hide menu is available to any chart type, data table, or section within a report. A common reason for enabling Hide When conditional formatting is to display different customized charts based on the number of dimensions being viewed.
As users begin to analyze refined data sets by drilling into results through the use of the Filter Bar and input controls, the number of dimensions that meet the criteria will shrink significantly, which changes the way the data is displayed. For robust reporting documents that resemble the functionality of dashboards, use the Hide When feature to display appropriate report elements that match the amount of data being viewed at any given time.









9.5    Element Linking
Element linking lets you create an interaction between a chart or data table and one or more report elements. This functionality allows report designers to produce a form of guided navigation by using a chart value or object in a data table to filter other report elements.
This form of linking bears a similarity to drilling and also resembles the type of interaction experienced with input controls. But element linking performs much differently by allowing a component to pass filters to other elements on a report. This functionality leads to the creation report/dashboard hybrids.
9.5.1    Adding Element Linking
Two methods for adding element links are available. The first step in both methods is to enter Design mode and select the source element to be used as the basis for the document link. This can be a chart or object in a data table. The methods are as follows:


                    The first method requires to right-click on the element to be used as the source of the element link. From the contextual menu, select Linking • Add Element Linking.
                

                    The second method of adding element links is by selecting the Add Element Link icon from the tabbed property ribbon. Click on the Report Element tab and then select the Linking subtab to reveal the icons for the available linking types.
                

Both of these methods open the Define Input Control window. Use this window to select the report objects to be used for filtering data in the dependency elements. When a chart is used as an element link source that contains multiple dimensions, a unique value from each dimension can be passed to its dependency objects.
To only pass a single value, change the default selection from All objects to Single Object, and a value from a single object will be passed to filter the dependency report elements.
The next step is to select the object to filter data in the dependency elements. Finally, click on Next to proceed.
Figure 9.58 shows the Define Input Control window, which you'll use to select the report objects that filter and connect data to the dependency components.

Figure 9.58    Selecting Objects Used to Filter Data in Element Linking
After choosing the report object used to filter data, you can make changes to the label name or add a description to the source component of the element link in the next window. Updates to this screen are optional.
Figure 9.59 shows the Set Control Properties window as it appears after you've selected the report object to be used in adding an element link.
A best practice is to change the default label value to a more meaningful and descriptive term or phrase for the benefit of the users.
The final screen in the process is where you'll assign the report elements to be filtered by the selections made in the element link. These report elements, shown in Figure 9.60, are also known as dependency objects. Notice that only one object is unavailable for selection. That's because block 5 is the object that the element link is based on in this example.

Figure 9.59    Setting Control Properties of Element Link

Figure 9.60    Selecting Report Elements as Dependencies of an Element Link
Report elements that can be dependencies of an element link include the following:


                    Page body
                

                    Sections
                

                    Charts
                

                    Data tables
                

9.5.2    The Impact of Element Linking
After an element link has been added to an object in a report, the chart or table containing the link will display a small icon  in the upper-right corner of the object to indicate that an element link has been added. This can be seen in the chart in the upper-left corner in Figure 9.61. In the example, the bar chart contains an element link, and all three of the other elements display data related to the selection made by the user.

Figure 9.61    Series of Report Elements with an Element Linking
Valid and accurate labeling is very import when developing dynamic and interactive reports. Because of the filtering capabilities of element links, we recommend that you label dependency charts with the filtered value used in the link.
As an example, use the following steps to add the filtered value to a dependency chart's title:


                    Right-click on a dependency chart object and select Format Chart.
                

                    Navigate to the Title section in the Format Chart window.
                

                    Edit the Title label to include the dynamic filtered value.
                

                    Click on the green checkmark icon to validate the syntax.
                

                    Click on Apply and then click OK.
                

Figure 9.62 shows the edited title of a dependency chart with the [Lines] object used as the filter object.

Figure 9.62    Adding a Dynamic Value to a Chart Title
Adding the filtered object used in creating the element link to the title of a dependency chart will provide a better context for users viewing the report. An example of a dynamic title can be seen in Figure 9.63 using the following formula in the title label:
="Quantity Sold by Year - "+[Lines]
Use this formula to produce a valid title when the Lines object is used as a simple filter. The purpose of this formula is to display Quantity Sold by Year - All Lines if a value has not been selected and Quantity Sold by Year - Accessories if the value selected in the [Lines] filter object is accessories:
="Quantity Sold by Year"+If(Count([Lines])=1;" - "+[Lines];" - All Lines")
In Figure 9.63, the bar chart contains an element link. The values being charted in the column chart are associated with the line selected in the bar chart. The Lines object has also been included in the title of the column chart.

Figure 9.63    Dynamic Chart Title Resulting from an Element Link
Resetting a Chart with an Element Link Selected
If you need to reset an element link value to remove the filters from the dependency charts, right-click on the Input Control icon located in the upper-right corner of the chart and select Reset.
This action will release the filter and return the dependency charts to their original state. The Reset button is shown in Figure 9.64. From this menu, you can also click Highlight dependencies to see which charts have been set up to receive the element value from the source element.

Figure 9.64    Clearing Element Link Filters

Note
Element linking can't be used when it's added to a chart that contains a dimension object that's part of a hierarchy and when drill mode has been enabled. This is because drill mode will force the chart either to drill up or to drill down the hierarchy rather than functioning as an element link. Disabling drill mode will allow the element link to function as designed.










9.6    Summary
Filtering data in Web Intelligence is both flexible and easy to apply. Begin filtering your documents in the Query Panel by restricting the amount of data returned in a query by including various types of filters: predefined, user-defined, or prompted filters, database ranking, subqueries, and filters based on BI sets.
After data is returned to the microcube in a Web Intelligence document, you can fine-tune your reports by adding element filters to precisely display subsets of data. You can use the Filter Bar to provide dimension and detail values in selectable dropdown lists to quickly filter entire reports, and you can conditionally hide charts, data tables, and sections based on the result of a custom designed formula.
For more interactivity, you can also a series of input controls or element linking that give users control to the displayed dataset from the side panel, or directly inside the document.
The next chapter explains how the Scope of analysis section works in the Query Panel to produce drillable hierarchies when analyzing data. This topic is important because it dictates the drill paths and interactive capabilities of report data.








10    Scope of Analysis and Drill FunctionalityDrill functionality puts the power of analysis into the users' hands by enabling them to filter down on report tables and charts with a simple click. By adding drill features to a report, the report can answer additional questions about the data than if only a summary of data is shown.By drilling on a report, you can see levels of data beyond your original query. For instance, let's say that you receive a monthly report summarizing profit margin by state. Upon review of the report, you discover that profit margin in 2006 has declined for the State of Illinois when compared to 2005, as shown in Figure 10.1. Exploring this anomaly further to determine its root cause would normally require running numerous additional detailed reports or even requesting a customized query to get your desired result.
Figure 10.1    Lower Profit Margin in Illinois over Previous Year
Note
Conditional formatting to change the appearance of data was used to highlight years in which margin decreased. Conditional formatting is covered in Chapter 3, Section 3.5.
This process means that a report request is made and another query generated, which produces another report showing profit margin results at a quarterly level by state. If this still didn't answer your questions, you'd need to make another request to produce another query to further drill down the data to a lower level (perhaps city or week) to pinpoint the reason for the profit margin results. You can see how this process could become long and cumbersome.Here's the good news: A report developer can avoid these extra report requests by designing the report to use drill-down analysis, as shown in Figure 10.2. Using drill-down, a user can see lower levels of detail in the data. In this case, the user has drilled from the state of Illinois to City and the year 2006 to Quarterly results.
Figure 10.2    Drilling on a Table to Explore the Data FurtherEnabling drill-down analysis in a Web Intelligence report requires two steps. The first step is setting the scope of analysis in the Query Panel. The second step is to enable drilling from either the Reading mode or Design mode.
10.1    Setting the Scope of Analysis in the Query Panel
To create the report from the previous example, you build a new query by choosing Year, State, and Margin in the Result Objects pane, as shown in Figure 10.3.

Figure 10.3    A Query to Analyze Profit Margin by Year and State
The next step to enabling drill is to set the scope of analysis in the Query Panel. This tells Web Intelligence to return additional data beyond the results specified in the Result Objects pane. To set the scope of analysis, open the Scope of Analysis Panel by clicking the Scope of Analysis button on the Query Panel toolbar, as shown in Figure 10.4.

Figure 10.4    The Scope of Analysis Panel Icon
The Scope of Analysis Panel appears, as shown in Figure 10.5.

Figure 10.5    Query Panel Showing the Scope of Analysis Pane
Notice that the dimensions from the query, in this case Year and State, automatically appear in the Scope of analysis pane because they are result objects.
The scope of analysis contains the extra pieces of information that you want to include in the report, in case somebody wants to drill down to those extra details. The easiest way to set the scope of analysis is to set the Scope level dropdown, which is located in the top-right corner of the Scope of analysis pane, as shown in Figure 10.6.

Figure 10.6    Scope Level in the Scope of Analysis Pane
If a scope level of none is selected, no additional objects will be added to the query, as shown in Figure 10.7.

Figure 10.7    Setting the Scope Level to None
Setting the scope level to one level will add the next level of detail for each dimension object. The Quarter object is added to Year and the City object is added to State, as shown in Figure 10.8.

Figure 10.8    Setting the Scope Level to One
Setting the scope level to two will add two levels of detail for each dimension object. The Quarter and Month objects are added to Year and the City and Store name objects are added to State, as shown in Figure 10.9.

Figure 10.9    Setting the Scope Level to Two
Setting the scope level to three will add three levels of detail for each dimension object. The Quarter, Month, and Week objects are added to Year. Notice that only two objects, City and Store name, are added to State, as shown in Figure 10.10. You'll see why in the next section.

Figure 10.10    Setting the Scope Level to Three
Lastly, a custom scope level can be set by either removing objects from the Scope of Analysis Panel or by selectively adding objects from the Available Objects pane. In Figure 10.11, the report designer has chosen to only add the Quarter and Month objects to the Year and only Store name to the State.

Figure 10.11    Setting a Custom Scope Level
By now you might be wondering how the universe knew which objects to add to the Scope of analysis pane. The relationship between various objects are defined as navigation paths, or hierarchies, by the universe designer. To see the navigation paths, change the Universe outline in the Query Panel from the Master Perspective to Display by Navigation Paths, as shown in Figure 10.12.

Figure 10.12    Changing the Universe Outline to Display by Navigation Paths
Notice in Figure 10.13 that the eFashion universe has five navigation paths defined: Time period, Store, Store details, Product, and Promotions. Because the Year object in the Result Objects belonged to the Time Period navigation path, the next three objects—Quarter, Month, and Week—were added to the scope of analysis.

Figure 10.13    Navigation Paths, or Hierarchies, in the eFashion Universe
A fourth level of time period—Holiday (y/n)—could also be added to the scope of analysis. Next look at the Store navigation path. It only contains three objects: State, City, and Store name. Even though you chose three levels of scope, only two levels were defined by the universe.
When you place the master perspective next to the navigation paths, as shown in Figure 10.14, you can understand how the universe designer of eFashion created navigation paths.

Figure 10.14    Comparing the Universe Folders and Navigation Paths
A universe automatically creates a navigation path for each folder of objects in the universe. These navigation paths are known as default navigation paths and are the type used by the eFashion universe. The order of objects in the navigation path is identical to the order of the objects in the original folder. It is also possible for a universe designer to create custom hierarchies that cross folder boundaries. For example, it might help the buyers at the eFashion company if they could drill from state to store name from the Store folder but then drill from store name to category and SKU description in the Product folder. A universe designer can create custom hierarchies that match how users prefer to analyze data. A universe designer can also specify that a universe have no navigation paths. The important thing to remember here is that what appears on the Navigation Paths pane is controlled by the universe designer.
When the query is first executed, only the result objects will be projected onto the report, as shown in Figure 10.15.

Figure 10.15    Only Result Objects Are Displayed When Scope of Analysis Is Set
However, if you look closely at the available objects, notice that all of the result objects as well as all of the scope of analysis objects are available to the document, as shown in Figure 10.16.

Figure 10.16    Available Objects Include Result Objects and Scope of Analysis Objects
This is the good news alluded to at the beginning of the chapter. It means that detailed analysis is only one click away if the visible objects—Year, State, and Margin—can't answer all of your questions.

Note
When setting the scope of analysis, remember that each new level of drill-down increases the complexity of the SQL statement and the size of the microcube returned with the query results. The larger the microcube, the longer it will take to refresh the query and the larger the file size maintained in the repository.
In certain circumstances, it may be preferable to connect two separate Web Intelligence documents, a master and a detail, using report linking than using drill-down analysis. This topic is covered in Chapter 15, Section 15.1.










10.2    Drill-Down Setup in the Report Panel
After the scope of analysis has been set up in the Query Panel, the query results will return the additional data required to perform drill analysis. After the data is available at the report level, the user can drill within the report against the report's microcube. No further queries are necessary to run against the database to gather more information as long as drill remains within the defined scope.
Enabling Drill
You can enable drill-down at the report level from either Reading mode or Design mode.
From Reading Mode
After you've selected to view a report in BI Launch Pad, the Drill button appears on the toolbar, as shown in Figure 10.17.

Figure 10.17    Drill Button on Web Intelligence Toolbar (Reading Mode)
From Design Mode
In Design mode, the Drill button appears on the toolbar, as shown in Figure 10.18.

Figure 10.18    Drill Button on Web Intelligence Toolbar (Design Mode)
In either case, you enter Drill mode by clicking the Drill button directly or choosing Start Drill from the dropdown on the side of the Drill button. There will be two visual indicators that you are in Drill mode. First, the icon on the report label at the bottom of the window will change from a report icon (which looks like a sheet of paper) to a drill icon (which adds a magnifying glass to the sheet of paper), as shown in Figure 10.19.

Figure 10.19    The Magnifying Glass Icon Signifying That the Tab Is in Drill Mode
If your Web Intelligence options have been set up in BI Launch Pad to open a new report for drilling (as shown), then a duplicate report will open in a new window. We'll discuss how to personalize your drill settings later in this chapter.
The second visual indicator will be the appearance of the Filter Bar at the top of the Report tab, as shown in Figure 10.20. Dimensions will appear on the Filter Bar as you drill down and automatically disappear when you drill up. You can also use the drill toolbar to filter additional data elements within your report by dragging the object from the Available Objects pane to the drill toolbar. The Filter Bar filters all blocks on the report and you will see in an upcoming section that it can be used as an alternative control besides clicking directly on tables and charts to affect drill behavior.

Figure 10.20    The Filter Bar in Drill Mode









10.3    Drilling on Tables
Let's first look at drilling on tables and continue to analyze the low margins for Illinois discovered at the beginning of the chapter. You can drill on both the dimensions and measures in the table but the behavior for each is slightly different.
10.3.1    Drilling on Dimensions
To drill down on the State dimension, hover over the desired state (Illinois in this case). Notice in Figure 10.21 that Illinois becomes underlined and a tool tip appears to advise what will happen if you click. Based on the navigation paths created by the eFashion universe designer, clicking on any State dimension will drill down to the City dimension.

Figure 10.21    Drilling Down on the State Dimension
The drill operation has effectively filtered the crosstable for only the state of Illinois, which now appears on the Filter Bar, as shown in Figure 10.22. Chicago is the only city in Illinois that has an eFashion store. Notice that if you hover over the value of Chicago, another tool tip appears to remind you that the universe designer included Store Name in the navigation path.

Figure 10.22    Drilling from City to Store Name
Clicking on Chicago drills down to a single store in Chicago. You have reached the bottom of the scope of analysis set in the Query Panel. You might want to drill down the Time Period navigation path by hovering over one of the year objects (shown in Figure 10.23).

Figure 10.23    Drill Down from Year to Quarter
Drill-Up
Drill-up enables the users to drill from a lower level of aggregation to a higher level of aggregation. After drilling down to a lower level, you may want to drill back up to a higher level in the navigation path. You can click on the dimension and select Drill up from the dropdown menu, as shown in Figure 10.24.

Figure 10.24    Drill Up from Store Name to City
Drill-By
Sometimes a business question cannot be answered by drilling down a single navigation path. For example, once you begin analyzing the data for the eFashion Chicago 33rd store, it may be helpful to break down the numbers by product mix. To allow this type of analysis, you may need to add dimensions to the scope of analysis. Continuing with the earlier example, edit the query and add the Lines and Category dimensions from the Product folder to the Scope of analysis pane, as shown in Figure 10.25.

Figure 10.25    Adding Lines and Category Dimension Objects to the Scope of Analysis
Re-run the query then drill down on the crosstable to the eFashion Chicago 33rd store as before. To analyze the store by its product mix, right-click and choose Drill • Drill by • Product • Category from the menu, as shown in Figure 10.26.

Figure 10.26    Drill By Product Category
Now the eFashion Chicago 33rd store results are shown by category, as shown in Figure 10.27.

Figure 10.27    Analyzing eFashion Chicago 33rd Store by Product Category
Extending the Scope of Analysis
Sometimes you'll want to drill past the end of the navigation paths that you included in the Scope of analysis pane. Web Intelligence allows you to extend the scope of analysis to the next object in the navigation path. But be aware that Web Intelligence has to refresh the data provider with the additional object. For example, if you hover over the category Party pants in the previous example, a tool tip appears stating Drill down to SKU number (new query), as shown in Figure 10.28.

Figure 10.28    Extending the Scope of Analysis
If you have enabled the option for Prompt When Drill Requires Additional Data (recommended), a dialog box will appear allowing you to adjust the scope of analysis further or stop the additional query from refreshing, as shown in Figure 10.29.

Figure 10.29    Extend the Scope of Analysis
The next dimension in the navigation path, SKU number, is already selected. You also have the option to add objects from the Product navigation path. Clicking OK to refresh the query allows the crosstable to break down the results by SKU number, as shown in Figure 10.30.

Figure 10.30    Analyzing by SKU Number by Extending the Scope of Analysis
10.3.2    Drilling on Measures
You can also drill down on measure objects, which drills all dimensions contained in the table with the measure by one level.
Figure 10.31 shows a crosstable with Sales revenue by Year and State. The tool tip when hovering over the Sales Revenue measure indicates that drilling down will drill by both the Time Period and Store navigation paths simultaneously, in this case to Quarter and City.

Figure 10.31    Drill Down on Measure Object
The drill-down result can be seen in Figure 10.32.

Figure 10.32    Crosstable after Drill-Down on Measure Object









10.4    Drilling on Charts
Users can drill on charts in the same ways that they can drill on tables: drill down, drill up, and drill by. We'll examine how to drill on a bar chart and a pie chart.
10.4.1    Dimensions on Chart Axis
The drill functionality is available on dimensions included in the chart axis, such as the bar chart showing Margin by City in Figure 10.33. You can click on either the City label or its corresponding bar to drill down to the next level in the navigation patch.

Figure 10.33    Drill Down on Chart Axis
The same principles for drill-up apply as with the tables: You can right-click on the dimension to drill up in order to drill back to the Year dimension or select the up arrow. The user can also drill by an object by selecting the Drill by option from the right-click menu when selecting on a dimension. This functionality works the same as it does with a table. In some cases, the chart has multiple dimensions on the axis, as shown in Figure 10.34. In this case, Drill by functionality will not be available on the axis of the chart.

Figure 10.34    Multiple Dimensions on the Category Axis of the Chart
10.4.2    Dimensions on Legends
Drill functionality is also available on dimensions included in the chart legend, if the legend is viewable in the report. This can be especially helpful with pie charts, when it is sometimes difficult to determine which slice belongs to what data element, as shown in Figure 10.35.

Figure 10.35    Chart Legends Can Also Be Used for Drilling
In this example, the user can click on one of the states listed in the legend to drill down to the next level in the hierarchy. A tool tip showing the next level of drill available appears.
The user can right-click on the dimension to drill up and drill back to the State dimension, as done with drill functionality on a chart axis.
The user can also select to drill by an object by selecting the Drill by option from the right-click menu when selecting on a dimension. This functionality works the same as it does with a table.
In some cases the chart has multiple dimensions on the axis, as shown in Figure 10.34. In this case, the Drill by functionality won't be available on the legend of the chart.
10.4.3    Measures on Chart Bars and Markers
A helpful analysis feature in Web Intelligence is the ability to select the bar or marker in a chart to drill up or down. This functionality is available on bar charts, pie charts, line charts, and radar charts. For bar charts, users drill on the bars. On pie charts, users drill on the pie slices. Drilling on line and radar charts is done by drilling on the line markers, as shown in Figure 10.36. The bars, slices, or markers of a chart consist of the measure data elements; therefore, the drill functionality is the same as drilling on a measure in a table.
When drilling on a measure, all dimension objects placed with it are drilled down by one level, and the measure is recalculated to match the new data elements.

Figure 10.36    Drill Down Using Line Chart Marker
To drill down on the chart bars and markers, select the appropriate bar, and click to enable the drill down to the next level in the hierarchy. To drill up on the charts and markers, right-click on the bar or marker and select Drill up to reach the next highest level in the drill hierarchy.
There are some limitations to drilling on measures in chart bars and markers. Certain chart types—such as the 2D and 3D area charts, stacked area charts, radar charts, and scatter charts—do not drill down on all dimensions included in the chart when selecting on the chart measure bars or markers. When drilling on these charts, only the dimension included in the chart legend is drilled upon, and therefore the measure object recalculates for this dimension change only.

Note
Measures cannot be drilled upon in 3D area charts.










10.5    Taking a Snapshot
When using drill features to analyze data, you may have an "a-ha" moment that explains what is going on with the data. Web Intelligence allows you to capture this "a-ha" moment by taking a snapshot of the current view of the report for future reference. For example, you might drill down to the eFashion Chicago 33rd store, drill by category, then drill down to SKU description, only to realize that the margin for Crepe Trousers is below what the organization was expecting, as shown in Figure 10.37.

Figure 10.37    Party Pants Margin for eFashion Chicago 33rd
To capture this analysis permanently, click on the Snapshot button on the Analysis toolbar, as shown in Figure 10.38.

Figure 10.38    Drill Snapshot
When the snapshot is taken, the Drill tab becomes a normal report tab, as can be seen from its icon (Figure 10.39).

Figure 10.39    Taking a Snapshot Exits Drill Mode
To clarify the analysis, you may want to rename the Report tab and either add a free-standing cell of analysis (shown in Figure 10.40) or perhaps use the new Web Intelligence 4.2 commentary feature (see Chapter 18, Section 18.5).

Figure 10.40    Analysis Added to Drill Snapshot Using a Free-Standing Cell









10.6    Drill Options
There are drill options that can be set individually for each Web Intelligence document. There are also options, located in the BI Launch Pad preferences, that affect the behavior of all Web Intelligence documents.
10.6.1    Document Settings for Drill Functionality
There are many document-level settings but only one related to drill functionality: Use Query Drill.
Use Query Drill
The query drill lets the user drill on a report without maintaining all the data within the data provider, thereby minimizing the refresh time and the amount of space taken up by the report.
The query drill is also essential when report measures cannot be calculated properly through normal drill mode and must be calculated at the database level. Examples include non-additive measures such as ranks, percentages, distinct counts, standard deviations and variances, running aggregates, and lead and lag functions.
To enable query drill, select the Document button from the Properties menu. Select the Use query drill checkbox, as shown in Figure 10.41.

Figure 10.41    Use Query Drill Option
The query drill works differently from standard drill mode. When a user selects to drill down on Year and selects the year of 2001, Web Intelligence not only applies the drill filter to limit the results at the report level but also applies a query filter to limit the results at the query level. This means that the user can no longer use the dropdown boxes in the drill toolbar to change the filter because only the year 2001 exists in the report. Also, the new query filter will affect the entire report. The entire report is now filtered for only the year 2001.

Caution
The query drill applies the drill filter to the report query, so all report tabs will be affected by the drill.
If you drill from Year to Quarter in query drill mode, then the Year object will be removed from your query and replaced with the Quarter object. Therefore, the Year object will be removed from all report tabs in your Web Intelligence report.

10.6.2    User Settings for Drill Functionality
You can specify your own preferences for the drill in the Preferences menus located on the BI Launch Pad toolbar. Your drill options are found on the Web Intelligence Preferences tab, as shown in Figure 10.42. Each of these options can provide a more personalized drill experience based on how you want Web Intelligence to behave. These options can be controlled by your SAP BusinessObjects administrator, so not all options may be available to use based on your rights.

Figure 10.42    User Settings for Drill Functionality in BI Launch Pad Preferences
Prompt When Drill Requires Additional Data
When you need to extend the scope of analysis to view a higher or lower level of drill than was set up in the report scope, you must run a query to retrieve the additional data. If the Prompt when drill requires additional data option is selected, then you'll be prompted to ensure that you want to run a query before the query is run. If this option is not selected, then a query will automatically be run if you choose to extend the scope of analysis by drilling beyond the designated scope.
Synchronize Drill on Report Blocks
The Synchronize drill on report blocks option lets you drill on all report blocks simultaneously. A report block can include tables or charts. If you enable synchronized drill in your Web Intelligence preferences, then when you choose to drill on an object that is contained in more than one report block, the object changes in all report blocks in which it is contained.
If the option is not enabled, then when you select to drill on an object that is contained in more than one report block, the object changes only in the block in which you selected to drill.
Hide Drill Toolbar on Startup
When drill is enabled on a report, a toolbar appears at the top of the screen that shows dropdown boxes with the selected drill filters. You can change the filters by using these boxes and see which filters you've chosen in your drill path by referencing the boxes shown in the drill toolbar.
The drill toolbar can be hidden so it doesn't show when the drill is enabled. To set this option, select the Hide Drill Toolbar checkbox in the Web Intelligence Preferences.
Start Drill Session
The Start Drill Session option sets whether the drill is completed within the current report or whether a new report is opened in a new browser to complete drill mode. The two options are Start Drill Session in Existing Report or Start Drill Session in a Duplicate Report.









10.7    Summary
Drill functionality is an important feature that allows Web Intelligence to be an analysis tool, not just a reporting tool. By setting scope of analysis when designing a report, you'll be able to quickly and easily answer important business questions by performing drill-down, drill-up, and drill-by functions that can be accessed from either Reading or Design mode, whether you're using Web Intelligence inside of a web browser or using the Web Intelligence Rich Client. When you uncover insights, you can create a snapshot to share your analysis with others in the organization.








11    Using Formulas and VariablesCreate complex calculations by using data objects retrieved from your database along with more than 160 built-in reporting functions and 40 operators in the Formula Editor. By using formulas and variables to transform data into analytical information, you'll be able to make better business decisions.Formulas and variables are commonly used structures that allow you to create calculations using the data retrieved from a query. Variables are used to store the calculation syntax of a formula in reusable objects that are saved in Web Intelligence reporting documents.Variables can be used in reports to perform a variety of tasks that display your data in different ways than when retrieved by queries. Variables can be used to insert If-Then-Else logic into a column or chart, contain complex calculations that produce precise views of information, or create analytical formulas that solve difficult business problems—all within a single object that can be used throughout a reporting document.The formula bar provides the capability to quickly revise the definition of an object within a toolbar, similar to Microsoft Excel. The Formula Editor or Create Variable windows can be used to create extensive and detailed formulas with the convenience of viewing all available data elements, functions, and operator types in the same window.The next several sections introduce you to the Formula Editor, explain the syntax used in creating formulas and variables, and provide examples to help you get the most out of the editor when creating unique calculations.
11.1    Formulas and Variables
The first step in creating a formula or variable or modifying the definition of an existing field is to enable either the formula bar or Formula Editor. Regardless of the viewer set in the Web Intelligence preferences, the formula bar is accessible only while in Design mode. The second step is to understand the syntax used in the Web Intelligence Report Panel. We'll begin by editing an existing report and describing the various ways to access the Formula Editor, also known as the Create Variable window.
To add a new variable to a reporting document without placing it directly in a data table, select the Data Access tab provided in the ribbon of tabs located above the report. Next, select the Data Objects tab in the second set of subtabs. Figure 11.1 shows the New Variable icon accessible inside the Data Objects tab. The default variable type is dimension. Select the small down arrow immediately to the right of the New Variable button to choose between Dimension, Detail, or Measure as the new variable type.

Figure 11.1    Creating a New Variable Object from the Tab Ribbon
11.1.1    Converting In-Place Objects into Formulas
Formulas are calculations created to transform data retrieved by your queries for producing results that solve business problems. These formulas can be created as variables and then used in data tables and charts throughout a Web Intelligence document rather than creating single instances of the formula.
Every object added to a table or chart in a report contains a formula definition, even if the object added comes directly from objects retrieved by the query. Figure 11.2 shows the dimension object selected in a table with the formula bar displayed. Notice that the formula for the selected object is =[City].

Figure 11.2    Formula of the Selected Dimension Object
The formula or definition of a selected object in a table can be edited by changing the definition in the formula bar. An example of a revision that can be applied to the selected object is displayed in Figure 11.3, in which the City object was replaced with a formula by modifying the object definition in the formula bar.

Figure 11.3    Revised Formula in the Selected Dimension Object
Editing the definition of an object in the formula bar will result only in modifying the specific instance of the object. To use the formula in other report elements within the document, click on the Create Variable icon to transform the formula into a variable usable throughout the document.

Tip
Clicking on the Create Variable icon located to the left of the formula bar launches the Formula Editor and gives you access to available objects, functions, and operators for creating even more complex and powerful formulas.

Figure 11.4 shows the other commands to use when editing an object definition or formula:


Formula EditorLaunch the Formula Editor by clicking on the Fx icon.
                

Create Variable Transform the existing formula into a reusable variable.
                

CancelCancel the revisions made to a calculation in the formula bar.
                

Validate FormulaValidate the formula by clicking on the green checkmark icon.
                


Figure 11.4    Revising the Formula of a Selected Object in a Cross Table
11.1.2    Exploring the Formula Editor
After launching the Formula Editor, you can graphically build or edit your formula by using elements from the following three categories of objects for advanced formula creation:


Available objectsAll result objects and variables that exist within the document.
                

FunctionsMore than 160 functions are available to be used in formulas.
                

OperatorsNearly 50 operators are available to be used in formulas.
                

Figure 11.5 shows the Formula editor in the Create Variable window, which is used for creating and editing formulas graphically, writing freehand syntax, or a combination of both.

Figure 11.5    Formula Editor in the Create Variable Window
Formulas can be edited manually, by dragging and dropping, or by double-clicking on Available objects, Functions, and Operators and then placing them in the Formula area. To validate the syntax of the statement created in the formula, click on the green checkmark to the right of the window. If the formula is incorrect, the position of the first invalid identifier will be displayed.
For a quick example of the proper syntax to be used for a function or operator, click on the object and then view the contents of the description box located at the bottom of the editor. A brief description of the function or operator will appear, followed by the proper syntax structure of the object selected.
Functions in the formula editor are presented in nine different categories. A tenth category is also provided that contains all 160+ functions. These nine functional groups are listed here along with a few commonly used functions:


AggregateContains 24 functions, including Average(), Min(), Max(), Sum(), Median(), Percentage(), and RunningSum().
                

CharacterContains 24 functions, including Char(), FormatNumber(), Concatenation(), LeftTrim(), and Pos().
                

Date and TimeContains 18 functions, including CurrentDate(), CurrentTime(), LastDayOfMonth(), Year(), and Month().
RelativeDate(): Improvements were made in SAP BusinessObjects BI 4.2 SP 3 to this function making it the highlight of the section. The possible values for the period parameter include: MillisecondPeriod, SecondPeriod, MinutePeriod, HourPeriod, DayPeriod, WeekPeriod, MonthPeriod, QuarterPeriod, SemesterPeriod, and YearPeriod.
                

DocumentContains 13 functions, including DocumentAuthor(), ReportFilter(), DrillFilters(), and PromptSummary().
                

Data ProviderContains 17 functions, including UserResponse(), Connection(), UniverseName(), and NumberOfRows().
                

Misc.Contains 26 functions, including If(), Else, Then, BlockName, CurrentUser(), ForceMerge(), and NameOf().
                    New to SAP BusinessObjects BI 4.2 SP 3 is the Comment() function. Use this function to capture and display either the first or last comment entered into a cell.
                

LogicalContains nine functions, including Even(), IsDate(), IsNull(), IsNumber(), IsString, IsTime(), and Odd().
                

NumericContains 24 functions, including Abs(), Ceil(), Cos(), Floor(), Power(), Rank(), and ToNumber().
ToDecimal(): New to SAP BusinessObjects BI 4.2 SP 3, this function allows for big numbers to be used in a report for more precise calculations.
                

SetContains nine functions, including Ancestor(), Children(), Descendants(), IsLeaf(), Lag(), Parent(), and Siblings().
                    The two new functions added in SAP BusinessObjects BI 4.2 SP 3 are Depth() and MemberAtDepth(). Use these functions to get the depth of a member in a hierarchy and the hierarchy members at the given level.
                

Section 11.3 provides examples and additional information about these formulas.
11.1.3    Creating Variables
The difference between variables and formulas is that variables have been converted into reusable objects. By promoting a calculation or formula into a variable, you're creating a local result object that can be used throughout a reporting document.
To turn a formula into a variable, click on the Create Variable icon located to the left of the formula bar, as shown in Figure 11.6.

Figure 11.6    Create Variable Icon to Convert the Formula into a Variable
The Create Variable window allows you to perform all of the same tasks as the Formula Editor, with the addition of being able to assign a name and qualification to the variable. If Detail is selected as the qualification type, you also have the opportunity to assign an associated dimension to the object. The following are the modifiable sections in the Variable Definition section of a new variable:


NameProvide a descriptive and user-friendly term or short phrase to uniquely identify and clearly describe the variable.
                

QualificationSelect Dimension, Measure, or Detail as the variable qualification type (if Detail is selected, choose a dimension that the new detail object should be associated with).
                

FormulaReview the syntax of the formula to be used in the variable.
                

Figure 11.7 shows the Create Variable window used to name and set the qualification of a new variable object being converted from a formula.

Figure 11.7    Create Variable Window
Formula Descriptions, Syntax, and More on This Function
If you're new to a function or want to see the syntax that it requires, just select the function from the list of available functions in the Create Variable window. After selecting the function, you'll see a description of what the function does along with the data type, syntax required, and a link to several examples labeled More on this function. Pictured in Figure 11.8 is the Formula Editor with the new MemberAtDepth function selected.

Figure 11.8    Syntax Help with Functions









11.2    Custom Grouping
Custom grouping is feature resembling a popular classic from Desktop Intelligence. This feature performs like an IF-THEN-ELSE statement but without having to write any code. The entire calculation is created graphically by checking the values that should go into a group. Remaining values can then be grouped into their own group of Ungrouped Values.
To create a custom group, select a dimension object from a data table and then click the Group button located in the Analysis tab and Display subtab. This is pictured in Figure 11.9.

Figure 11.9    Adding a Custom Group
After selecting Group, you'll have the opportunity to select all values that should appear within a specified collection. In Figure 11.10, you'll see five values selected to be grouped together. Click the Group button to group them.

Figure 11.10    Grouping Values
Clicking Group will prompt you to enter a name for the new collection of values, as shown in Figure 11.11.

Figure 11.11    Naming a Custom Group
You can continue to create additional groups for any ungrouped values or choose to automatically group the remaining values. This is done by clicking the Ungrouped Values button located in the upper-right corner. You'll have two choices after clicking this button—Visible and Automatically grouped.
Click the Automatically grouped button to create a group for all remaining unchecked and ungrouped values. You'll be prompted to enter a name for the ungrouped values after making the selection pictured in Figure 11.12.

Figure 11.12    Grouping All Remaining Ungrouped Values
If you decide later to rename or delete a custom group, you can do this by selecting the group from the combo box located in the lower-right corner of the window and then clicking the Edit button or the Delete button. These options are pictured in Figure 11.13.

Figure 11.13    Renaming or Removing a Custom Group
Next we'll take a closer look at each of the functions available in the Report Panel and the operators to be used with them.









11.3    Reporting Functions and Operators
Web Intelligence provides an extensive set of reporting functions with which you can create very detailed and complex formulas for producing advanced reporting documents.
This section introduces you to the full list of reporting functions available for creating formulas and variables in the Report Panel. More than 160 reporting functions can be easily located within nine functional categories.
The broad collection of operators used in formulas and variables is also described here. With more than 50 available operators, report developers can create precise formulas that leverage the full set of built-in reporting functions.
The nine function categories for creating formulas in the Report Panel are reviewed here:


AggregateAggregate measures
            

CharacterFunctions that interact with character data
            

Date and TimeFunctions created with date data
            

DocumentIdentify information about the current document
            

Data ProviderFunctions available to identify information relating to the data provider in the current document
            

Misc.Functions covering a variety of topics not included in the other categories
            

LogicalLogical Boolean functions
            

NumericNumerical-related functions
            

SetMultidimensional functions
            

Let's look at each function category in more detail.
11.3.1    Newest Functions
There are a number of new functions introduced in SAP BusinessObjects BI 4.1 SP 6 and SAP BusinessObjects BI 4.2 that can be valuable assets to your reporting documents. Here is a list of those functions:


RelativeDate()Use this function to identify a date relative to a specific date and specified date range. In other words, with the following formula is used—RelativeDate(currentDate();1;MonthPeriod)—the result is one month before the current date. This report-side function is particularly useful when calculating measures by specific intervals. MonthPeriod values that can be used are MillicondPeriod, SecondPeriod, MinutePeriod, HourPeriod, DayPeriod, WeekPeriod, MonthPeriod, QuarterPeriod, SemesterPeriod, and YearPeriod. Other examples:
                    

RelativeDate([Date];5): Returns October 25 2015 when [Date] is October 20 2015.
                        

RelativeDate([Date];-5): Returns October 15 2015 when [Date] is October 20 2015.
                        



Comment()This function is used to transform a standard freehand cell into an area for collecting comments by users.
                

MemberAtDepth()Used exclusively in a report for multidimensional data. This function displays the members of a hierarchy at the depth chosen.
                

PromptSummary()This function is used to add context to a report and display metadata about what was retrieved from a query. Includes the query name and prompt values.
                

TimeBetween() and DatesBetween()Both functions are used to provide the interval between two date objects. Measurements can be made at the following levels: year, semester, quarter, month, day, hour, minute, and second.
                

11.3.2    Aggregate Functions
Aggregate functions are used for returning numeric calculations for creating commonly used formulas with measure objects (see Table 11.1).




                            Function
                        

                            Description
                        





Aggregate (measure;set)


                            Used in a report sourced from SAP BEx queries to aggregate values by set
                        



Average (measure;[member_set];IncludeEmpty)


                            Returns the average value of a measure
                        



Count (dimension|measure;IncludeEmpty;Distinct|All)


                            Returns the number of values in a dimension or measure
                        



First (dimension|measure)


                            Returns the first value in a data set
                        



Interpolation (measure;PointToPoint|Linear;NotOnBreak;Row|Column)


                            Calculates empty measure values by interpolation
                        



Last (dimension|measure)


                            Returns the last value in a data set
                        



Max (dimension|measure)


                            Returns the largest value in a dimension or measure in a set of values
                        



Median (measure)


                            Returns the median (middle value) of a measure
                        



Min (dimension|measure;[member_set])


                            Returns the smallest value in a dimension or measure
                        



Mode (dimension|measure)


                            Returns the most frequently occurring value in a data set
                        



Percentage (measure;[break];[row|col])


                            Expresses a measure value as a percentage of its embedding context
                        



Percentile (measure;percentile)


                            Returns the nth percentile of a measure
                        



Product (measure)


                            Multiplies the values of a measure
                        



RunningAverage (measure;[Row|Col];[IncludeEmpty];reset_dims)


                            Returns the running average of a measure
                        



RunningCount (dimension|measure;[Row|Col];[IncludeEmpty];reset_dims)


                            Returns the running count of a number set
                        



RunningMax (dimension|measure;[Row|Col];reset_dims)


                            Returns the running maximum of a dimension or measure
                        



RunningMin (dimension|measure;[Row|Col];reset_dims)


                            Returns the running minimum of a dimension or measure
                        



RunningProduct (dimension|measure;[Row|Col];reset_dims)


                            Returns the running product of a measure
                        



RunningSum (dimension|measure;[Row|Col];reset_dims)


                            Returns the running sum of a measure
                        



StdDev (measure)


                            Returns the standard deviation of a measure
                        



StdDevP (measure)


                            Returns the population standard deviation of a measure
                        



Sum (measure;[member_set])


                            Returns the sum of a measure
                        



Var (measure)


                            Returns the variance of a measure
                        



VarP (measure)


                            Returns the population variance of a measure
                        



Table 11.1    Aggregate Functions
11.3.3    Character Functions
Character functions are primarily used for performing tasks that manipulate dimension objects (see Table 11.2).




                            Function
                        

                            Description
                        





Asc (string)


                            Returns the ASCII value of a character
                        



Char (ascii_code)


                            Returns the character associated with an ASCII code
                        



Concatenation (first_string;second_string)


                            Concatenates (joins) two character strings
                        



Fill (repeating_string;num_repeats)


                            Builds a string by repeating a string n times
                        



FormatDate (date;format_string)


                            Formats a date according to a specified format
                        



FormatNumber (number;format_string)


                            Formats a number according to a specified format
                        



HTMLEncode (html)


                            Applies HTML encoding rules to a string
                        



InitCap (string)


                            Capitalizes the first letter of a string
                        



Left (string;num_chars)


                            Returns the leftmost characters of a string
                        



LeftPad (padded_string;length;left_string)


                            Pads a string on its left with another string
                        



LeftTrim (trimmed_string)


                            Trims the leading spaces from a string
                        



Length (string)


                            Returns the number of characters in a string
                        



Lower (string)


                            Converts a string to lowercase
                        



Match (string;pattern)


                            Determines whether a string matches a pattern
                        



Pos (string;pattern)


                            Returns the starting position of a text pattern in a string
                        



Replace (replace_in;replaced_string;replace_with)


                            Replaces part of a string with another string
                        



Right (string;num_chars)


                            Returns the rightmost characters of a string
                        



RightPad (padded_string;length;right_string)


                            Pads a string on its right with another string
                        



RightTrim (trimmed_string)


                            Trims the trailing spaces from strings
                        



Substr (string;start;length)


                            Returns part of a string
                        



Trim (trimmed_string)


                            Trims the leading and trailing spaces from a string
                        



Upper (string)


                            Converts a string to uppercase
                        



URLEncode (html)


                            Applies URL encoding rules to a string
                        



WordCap (string)


                            Capitalizes the first letter of all of the words in a string
                        



Table 11.2    Character Functions
11.3.4    Date and Time Functions
Date and time functions allow developers to extract date elements from date objects and calculate date differences (see Table 11.3).




                            Function
                        

                            Description
                        





CurrentDate()


                            Returns the current date formatted according to the regional settings
                        



CurrentTime()


                            Returns the current time formatted according to the regional settings
                        



DayName (date)


                            Returns the day name from a date from the data passed to the function
                        



DayNumberOfMonth (date)


                            Returns the day number in a month from the data passed to the function
                        



DayNumberOfWeek (date)


                            Returns the day number in a week from the data passed to the function
                        



DayNumberOfYear (date)


                            Returns the day number in a year from the data passed to the function
                        



DaysBetween (first_date;last_date)


                            Returns the number of days between two dates passed into the function
                        



LastDayOfMonth (date)


                            Returns the date of the last day in a month
                        



LastDayOfWeek (date)


                            Returns the date of the last day in a week
                        



Month (date)


                            Returns the month name in a date
                        



MonthNumberOfYear (date)


                            Returns the month number in a date
                        



MonthsBetween (first_date;last_date)


                            Returns the number of months between two dates
                        



Quarter (date)


                            Returns the quarter number in a date
                        



RelativeDate (start_date;num_days)


                            Returns a date relative to another date
                        



TimeDim (date;period)


                            Completes a list of dates when the values retrieved from a query return missing dates
                        



ToDate(date_string;format)


                            Returns a character string formatted according to a date format
                        



Week(date)


                            Returns the week number in the year from the date passed to the function
                        



Year(date)


                            Returns the year in a date from the date passed to the function
                        



Table 11.3    Date and Time Functions
11.3.5    Document Functions
Document functions, which are shown in Table 11.4, let you identify various attributes of a reporting document.




                            Function
                        

                            Description
                        





DocumentAuthor()


                            Returns the logon of the document creator
                        



DocumentCreationDate()


                            Returns the date on which a document was created
                        



DocumentCreationTime()


                            Returns the time when a document was created
                        



DocumentDate()


                            Returns the date on which a document was last saved
                        



DocumentName()


                            Returns the document name
                        



DocumentOwner()


                            Returns the logon of the user that last saved the document
                        



DocumentPartiallyRefreshed()


                            Determines whether a document is partially refreshed
                        



DocumentTime()


                            Returns the time when a document was last saved
                        



DrillFilters(object|separator)


                            Returns the drill filters applied to a document or object in Drill mode
                        



PromptSummary()


                            Returns the prompt text and user response of all prompts in a document
                        



QuerySummary(query_name)


                            Returns information about the queries in a document
                        



ReportFilter(object)


                            Returns the report filters applied to an object or report
                        



ReportFilterSummary (report_name)


                            Returns a summary of the report filters in a document or report
                        



Table 11.4    Document Functions
11.3.6    Data Provider Functions
Data provider functions (shown in Table 11.5) let you create formulas that retrieve various details about the query, retrieved result set, and universe used to build the query.




                            Function
                        

                            Description
                        





Connection ([query_name])


                            Returns the parameters of the database connection used by a data provider
                        



DataProvider (object)


                            Returns the name of the data provider containing a report object
                        



DataProviderKeyDate ([query_name])


                            Returns the key date of a data provider
                        



DataProviderKeyDateCaption ([query_name])


                            Returns the key date caption of a data provider
                        



DataProviderSQL ([query_name])


                            Returns the SQL generated by a data provider
                        



DataProviderType ([query_name])


                            Returns the type of a data provider
                        



IsPromptAnswered ([query_name];prompt_string)


                            Determines whether a prompt has been answered
                        



LastExecutionDate ([query_name])


                            Returns the date on which a data provider was last refreshed
                        



LastExecutionDuration ([query_name])


                            Returns the time in seconds taken by the last refresh of a data provider
                        



LastExecutionTime ([query_name])


                            Returns the time at which a data provider was last refreshed
                        



NumberOfDataProviders ()


                            Returns the number of data providers in a report
                        



NumberOfRows ([query_name])


                            Returns the number of rows in a data provider
                        



RefValueDate ()


                            Returns the date of the reference data used for data tracking
                        



RefValueUserResponse ([query_name];prompt_string;index)


                            Returns the response to a prompt when the reference data was the current data
                        



ServerValue ([measure])


                            Returns the value of a measure calculated by the database
                        



UniverseName ([query_name])


                            Returns the name of the universe on which a data provider is based
                        



UserResponse ([query_name];prompt_string;index)


                            Returns the response to a prompt
                        



Table 11.5    Data Provider Functions
11.3.7    Miscellaneous Functions
A wide variety of functions are included in the Misc. category that returns details about components and features of a report (see Table 11.6).




                            Function
                        

                            Description
                        





BlockName ()


                            Returns the block name
                        



ColumnNumber ()


                            Returns the column number
                        



CurrentUser ()


                            Returns the login of the current user
                        



[member].Depth


                            Returns the depth of a specified member in a hierarchy
                        



Else (false_value)


                            Returns a value from the If function when the test expression is false
                        



ElseIf (test_value)


                            Used to nest an If function within another If function
                        



ForceMerge (measure)


                            Includes synchronized dimensions in measure calculations when the dimensions aren't in the measure's calculation context
                        



GetContentLocale ()


                            Returns the locale of the data contained in the document (the Document Locale)
                        



GetDominantPreferredViewingLocale ()


                            Returns the dominant locale in the user's Preferred Viewing Locale group
                        



GetLocale ()


                            Returns the user's locale used to format the Web Intelligence interface (the Product Locale)
                        



GetLocalized (string;comment)


                            Returns a string localized according to the user's Preferred Viewing Locale
                        



GetPreferredViewingLocale ()


                            Returns the user's preferred locale for viewing document data (the Preferred Viewing Locale)
                        



If (boolean_value;true_value;false_value)


                            Returns a value based on whether an expression is true or false
                        



[member].Key


                            Returns the key of a member
                        



LineNumber ()


                            Returns the line number in a table
                        



NameOf (object)


                            Returns the name of an object
                        



NoFilter (object;all|drill)


                            Ignores filters when calculating a value
                        



NumberOfPages ()


                            Returns the number of pages in a report
                        



Page ()


                            Returns the current page number in a report
                        



Previous (dimension|measure| Self; reset_dims; offset; NoNull)


                            Returns a previous value of an object
                        



RefValue (object)


                            Returns the reference value of a report object when data tracking is activated
                        



RelativeValue (measure|detail;slicing_dims; offset)


                            Returns previous or subsequent values of an object
                        



RepFormula


                            Appears when a document has been converted from Desktop Intelligence and previously used a function not supported in Web Intelligence
                        



ReportName ()


                            Returns the name of a report
                        



RowIndex ()


                            Returns the number of a row
                        



Then true_value


                            Returns a value from the If function when the test expression is true
                        



UniqueNameOf (object)


                            Returns the unique name of an object
                        



UseMerged(expression)


                            Forces the use of a merged dimension
                        



Table 11.6    Misc. Functions
11.3.8    Logical Functions
Logical functions determine whether an object is true or false by returning either a 1 or 0, respectively (see Table 11.7).




                            Function
                        

                            Description
                        





Even (number)


                            Determines whether a number is even
                        



IsDate (object)


                            Determines whether a value is a date
                        



IsError (object)


                            Determines whether an object returns an error
                        



IsLogical (object)


                            Determines whether a value is Boolean
                        



IsNull (object)


                            Determines whether a value is null
                        



IsNumber (object)


                            Determines whether a value is a number
                        



IsString (object)


                            Determines whether a value is a string
                        



IsTime (object)


                            Determines whether a variable is a time variable
                        



Odd (number)


                            Determines whether a number is odd
                        



Table 11.7    Logical Functions
11.3.9    Numeric Functions
Numeric functions allow you to manipulate and measure values in a variety of ways, as shown in Table 11.8.




                            Function
                        

                            Description
                        





Abs (number)


                            Returns the absolute value of a number
                        



Ceil (number)


                            Returns a number rounded up to the nearest integer
                        



Cos (angle)


                            Returns the cosine of an angle
                        



EuroConvertFrom (euro_amount;curr_code;round_level)


                            Converts Euros to another currency
                        



EuroConvertTo (noneuro_amount;curr_code;round_level)


                            Converts an amount to Euros
                        



EuroFromRoundError (euro_amount;curr_code;round_level)


                            Returns the rounding error in a conversion from Euros
                        



EuroToRoundError (noneuro_amount;curr_code;round_level)


                            Returns the rounding error in a conversion to Euros
                        



Exp (power)


                            Returns an exponential (e raised to a power)
                        



Fact (number)


                            Returns the factorial of a number
                        



Floor (number)


                            Returns a number rounded down to the nearest integer
                        



Ln (number)


                            Returns the natural logarithm of a number
                        



Log (number;base)


                            Returns the logarithm of a number in a specified base
                        



Log10 (number)


                            Returns the base 10 logarithm of a number
                        



Mod (dividend;divisor)


                            Returns the remainder from the division of two numbers
                        



Power (number;power)


                            Returns a number raised to a power
                        



Rank (measure;ranking_dims;Top|Bottom;reset_dims)


                            Ranks a measure by dimensions
                        



Round (number;round_level)


                            Rounds a number
                        



Sign (number)


                            Returns the sign of a number
                        



Sin (angle)


                            Returns the sine of an angle
                        



Sqrt (number)


                            Returns the square root of a number
                        



Tan (angle)


                            Returns the tangent of an angle
                        



ToNumber (string)


                            Returns a string as a number
                        



Truncate (number;truncate_level)


                            Truncates a number
                        



Table 11.8    Numeric Functions
11.3.10    Set Functions
A series of set functions has been added to the Report Panel to get more information from data retrieved by multidimensional data sources. Use these functions to identify ancestral information relating to hierarchical members, including parents, children, siblings, and ancestors of a specific member.
Many of these functions are used primarily in the input parameter in aggregate functions to specify a member to be aggregated and cannot be used as standalone functions. When using a member in a function, you need either to specify the member explicitly or provide the full hierarchical path of the member.
Table 11.9 provides a list of the set functions followed by a description of each.




                            Function
                        

                            Description
                        





Ancestor (member;level|distance)


                            Returns an ancestor member of a member by either level or distance
                        



[member].Children


                            Returns the child members of a specified member or member path
                        



[member].Depth


                            Returns the depth of a member in a hierarchy
                        



Descendants (member;level |distance;desc_flag)


                            Returns the descendant member of a specified member by either level or distance. Optionally, in the desc_flag position, use either Self, Before, After, Self_Before, Self_After, Before_After, Self_Before_After, or Leaves




[member].Key


                            Returns the key of a member
                        



[member].IsLeaf


                            Determines whether a member is a leaf member; returns either True or False




[member].Lag (distance)


                            Returns the members before or after a specified member; use a negative distance to identify the member before; use a positive number to identify the member after
                        



MemberAtDepth(hierarchy;depth)


                            Returns the members of a hierarchy at a chosen depth
                        



[member].Parent


                            Returns the parent member of a specified member
                        



[member].Siblings


                            Returns the sibling members of a specified member
                        



Table 11.9    Set Functions
11.3.11    Operators
Operators are symbols used in formulas and variables to indicate the type of operation you want to perform. Formulas can contain several different combinations of operators, which are used to solve a variety of business problems.
Report operators are grouped into the following six categories, each of which has a corresponding table:


                    Mathematical (see Table 11.10)
                

                    Conditional (see Table 11.11)
                

                    Logical (see Table 11.12)
                

                    Function-specific (see Table 11.13)
                

                    Extended syntax operators (see Table 11.14)
                

                    Extended syntax keywords (see Table 11.15)
                

                    Hierarchical operators (see Table 11.16)
                





                            Operator
                        

                            Description
                        





-


                            Subtraction
                        



+


                            Addition
                        



*


                            Multiplication
                        



/


                            Division
                        



Table 11.10    Mathematical Operators




                            Operator
                        

                            Description
                        





=


                            Equal to
                        



> 


                            Greater than
                        



< 


                            Less than
                        



>=


                            Greater than or equal to
                        



<=


                            Less than or equal to
                        



<>


                            Not equal to
                        



Table 11.11    Conditional Operators




                            Operator
                        

                            Description
                        





And


                            Links Boolean values, commonly used in IF statements
                        



Or


                            Links Boolean values, commonly used in IF statements
                        



Not


                            Returns the opposite of a Boolean value
                        



Between


                            Determines whether a value is between two values
                        



InList


                            Determines whether a value is within a list of values
                        



Table 11.12    Logical Operators




                            Operator
                        

                            Description
                        





All


                            Used as an optional parameter in many functions to calculate all or distinct values
                        



Drill


                            Used with the NoFilter function to ignore report filters
                        



Bottom


                            Ranks values in ascending order
                        



Break


                            Forces the Percentage function to calculate within table breaks
                        



Col


                            Optionally used to set the calculation direction in the following functions: Percentage, RunningAverage, RunningCount, RunningMax, RunningMin, RunningProduct, and RunningSum




Distinct


                            Used as an optional parameter in many functions to calculate distinct or all values
                        



IncludeEmpty


                            Optionally used to tell an aggregate function to include empty values
                        



Index


                            Used by the UserResponse and RefValueUserResponse functions to return the database primary key of a prompt response
                        



Linear


                            Used by the Interpolation function to use linear regression
                        



NoNull


                            Tells the Previous function to ignore null values
                        



NotOnBreak


                            Optionally used by the Interpolation function to ignore section and block breaks
                        



PointToPoint


                            Used by the Interpolation function to use point-to-point to account for missing values
                        



Row


                            Optionally used to set the calculation direction in the following functions: Percentage, RunningAverage, RunningCount, RunningMax, RunningMin, RunningProduct, and RunningSum




Self


                            Refers the Previous function to the previous cell when it doesn't contain a report object
                        



Top


                            Ranks values in descending order
                        



Where


                            Restricts the data to calculate a measure
                        



Table 11.13    Function-Specific Operators




                            Operator
                        

                            Description
                        





In


                            Specifies an explicit list of dimensions to use in the context
                        



ForAll


                            Removes dimensions from the default context
                        



ForEach


                            Adds dimensions to the default
                        



Table 11.14    Extended Syntax Operators




                            Operator
                        

                            Description
                        





Block


                            Refers to data within an entire block, ignores breaks, respects filters: Sum([Revenue]) In Block




Body


                            Displays the value of the data presented in a block and can be used in a footer, header, or body: Sum([Revenue]) In Body




Break


                            Calculates the total for the dimension used in a break: Sum([Revenue] In Break




Report


                            Displays all report data: Sum([Revenue]) In Report




Section


                            Calculates the section total of a measure when a section has been set in a report: Sum([Revenue]) in Section




Table 11.15    Extended Syntax Keywords
The hierarchical operators are used in place of the desc_flag keyword in the Descendants function to specify the distance of the descendant in relation to the specified member. See Table 11.16.




                            Operator
                        

                            Description
                        





After


                            Returns the descendants after the level or distance is specified in the Descendants function
                        



Before


                            Returns the descendants before the level or distance is specified in the Descendants function
                        



Before_After


                            Returns the current member and all descendants except those specified by the level|distance parameter in the Descendants function
                        



Leaves


                            Returns all members between the current member and the level or distance specified for members that do not have child members
                        



Range (:)


                            Returns a set of members at the same level existing between the two members specified
                        



Self_After


                            Returns the current member and all descendants at and after the level or distance specified in the Descendants function
                        



Self_Before


                            Returns the current member and all descendants at and before the level or distance specified in the Descendants function
                        



Self_Before_After


                            Returns the current member and all descendants
                        



Table 11.16    Hierarchical Operators









11.4    Formula Syntax
The first step in writing formulas and creating variables is to understand the Web Intelligence formula syntax. You must follow a few basic rules to create a valid formula. After you understand how to apply these basic rules, the task of writing a formula will no longer be a challenge. You can then focus your efforts on writing formulas and building analytical Web Intelligence reports that provide the greatest value to your client.
11.4.1    Primary Formula Syntax Rules
Consider these primary rules:


                    Each formula must begin with the equals symbol (=).
                

                    Data objects used in a formula must be encapsulated by brackets ([ ]).
                

                    Use a semicolon to represent Else in an If-Then-Else statement (;).
                

                    Use a semicolon to represent Then in an If-Then-Else statement (;).
                

                    Every statement with an open parenthesis must also include a closing parenthesis.
                

                    Click on the green checkmark button to validate the syntax of the formula or variable.
                

                    Change the qualification type when creating a measure or detail variable.
                

                    Assign a commonly used business term or phrase with the proper naming convention as the variable name.
                

11.4.2    If/Then/Else Syntax
Figure 11.14 shows a simple formula entered into the Formula Editor window. Several key areas of the formula are labeled in the screenshot, including three of the most important rules:


                    Begin a formula with the equals symbol (=).
                

                    Use a semicolon for THEN (;).
                

                    Use a semicolon for ELSE (;).
                

(You'll notice that these rules are repeated from the list of primary syntax rules.)

Figure 11.14    Example of Variable Syntax in a Formula
The formula shown in the Formula box in Figure 11.14 is translated into English as the following:
If the State data object contains values of California or Texas, then assign the value to West. If the State data object contains values of Colorado or Illinois, then assign the value to Midwest. If the State data object contains values of DC, Florida, New York, or Massachusetts, then assign the value to East. If the State data object contains any other values, then return the word South.
11.4.3    Saving a Variable
Before clicking on OK in the Formula Editor and saving a formula, click on the green checkmark button located to the right of the formula. This button validates the syntax in the formula.
If the syntax is valid, a small statement beneath the formula will appear that reads, The formula is correct. Click on OK to at the bottom of the Formula Editor to proceed.
If there's an error in the syntax, the formula can't be validated. To close the Formula Editor, all modifications will either have to be discarded or revised to include the correct syntax. If an error in the formula is present, the position of the first occurrence will be displayed beneath the formula when the syntax is validated.
11.4.4    Modifying a Variable
When a variable is created, the new object will be added to the Available Objects section for use in report elements throughout the document. The variable will appear along with all of the existing result objects returned from the query. Figure 11.15 shows three dimension variables and two measure variables. In SAP BusinessObjects BI 4.2 SP 3, when you right-click on a variable and it's a location, you'll be able to edit it as a geographical dimension to be used in the new geo map components (see Chapter 8, Section 8.11).

Figure 11.15    Right-Clicking on a Variable to Edit, Rename, or Remove
All variables created in a document are easily identified because they're automatically added to a Variables folder. To modify a variable, right-click on the object and select Edit. Editing a variable will launch the Variable Editor, in which you can modify the formula, name, or qualification of the object.

Note
An alternative method for creating a new variable is to right-click on the Variables folder in the list of Available Objects and select New Variable, as shown in Figure 11.16.

Figure 11.16    Adding a New Variable by Right-Clicking on the Variables Folder

The next section describes the differences between input and output context formula types that can be created in the Web Intelligence Report Panel.









11.5    Input, Output, and Calculation Contexts
Calculation contexts can be a sticky wicket to master, but if you're successful, the data in your reports can be transformed from just data returned by a query to truly analytical information. We'll begin this coverage of calculation contexts by discussing how SAP BusinessObjects aggregates data by default and then show how the values can be changed to meet different requirements with the addition of certain operators and keywords to your formulas.
The default aggregation behavior in Web Intelligence is to sum a measure by the dimensions in the table. These values automatically update anytime the dimensions or contexts are changed. Whether simple filters or input controls are selected or new dimensions are added to the table, the summed measure column(s) update immediately. An example of this functionality is shown in Figure 11.17 with a vertical table that contains two objects: Lines and Sales Revenue.

Figure 11.17    Default Aggregation of a Single Dimension and Measure Object
By default, the dimensions are automatically aggregated to show the sales revenue total for each distinct value. Also by default, the values are being displayed in both the block and report. As you'll learn later, these two keywords can be used to further restrict or specify the calculation.

Note
This example is based on the projection function of the measure objects being set to the Sum function in the object's definition at the universe level.

When another dimension is added to the data block, the Sales revenue measure will summarize the values based on the dimensions added to the block (see Figure 11.18).
To override the Year column that was added to the block and continue displaying the values aggregated at the Lines dimension, use the In operator as illustrated in the formula bar in Figure 11.19.

Figure 11.18    Default Aggregation with Two Dimensions and a Measure Object

Figure 11.19    Using the In Operator to Aggregate Values for a Specified Dimension
Next, we'll look at the different aggregation types and how you can use them together with context operators and keywords to further transform calculations.
11.5.1    Aggregates in Context Formulas
Input and output contexts are generally used to produce values at different dimensional levels to calculate maximums, minimums, averages, sums, and percentages. One of the most common requirements is to calculate the percentage of each dimension value's contribution to the whole. To do this, we need each row to be divided by the whole within the block.
Figure 11.20 shows the data table with a new column added to aggregate the total Sales Revenue for the entire block. This formula uses the In Block operator and keyword to bypass the default calculation behavior and provides the values at the block level rather than dimensional row level.

Figure 11.20    Calculating a Total within the Block
Click the Create Variable icon on the formula bar to convert the formula into a variable that can be used throughout the report (see Figure 11.21).

Figure 11.21    Converting a Formula into a Reusable Variable
From the Create Variable window, enter a unique name for your variable and click OK to proceed. In Figure 11.22, the variable is named Sales Rev Totals.

Figure 11.22    Giving a Name to a Formula
Now that you have a variable that calculates the sales revenue totals within the block, let's divide it by the Sales Revenue object, as shown in Figure 11.23. This new column now shows each row's percentage of the total value. Just as you did in the preceding step, this formula can also be converted to a variable.

Figure 11.23    Sales Revenue Totals Divided by Sales Revenue

Note
To format the new percentage column to show values in a percentage format, right-click on the column, select Format Number, and then navigate to the Percentage grouping. The new method of formatting percentages introduced in SAP BusinessObjects BI 4.1 is discussed next.

A single-click icon is available for applying the percentage format to a column. Figure 11.24 shows this icon and percentage column after clicking the icon. It's located in the Formatting tab and Numbers subtab.

Figure 11.24    Formatting a Column to Percentage Format with Icon
Because you created the new Sales Rev Totals variable to include the In Block operator and keyword, we'll now describe the four report structure operator and keyword combinations that can be used in formulas. If no keyword is provided, the implicit level of aggregation will be In Body.
11.5.2    Report Structure Operator and Keyword Combinations
Following are the four report structure operator and keyword combinations:


In ReportThis combination is used to set the formula to display at the report total level to produce a grand total for the visible and nonfiltered data objects on the report.
                

In BlockThis combination is used to set the context of the formula to the data table. If a section is applied in the report, this operator will function within each section individually. If a section has been added, and values at the entire block are needed rather than aggregates at the section level, the In Report operator should be used.
                

In SectionThis combination works exactly the same as In Block when applied to a data block within a section on a report.
                

In BodyThis combination is the implicit default operator of a formula. For instance, these two formulas produce the same result:
                    

Max([Sales revenue]) In Body


Max([Sales revenue])




11.5.3    Context Operators
We've already discussed the In operator, so now let's examine the Where, ForEach, and ForAll context operators. These two context operators are commonly used in conjunction with an aggregation function such as max() and min(). Following are definitions of the context operators that describe how they're used in formulas:


WhereThis operator can be used in formulas to restrict calculations to specific values.
                

ForEachThis operator is used to explicitly add dimensions to a context. Existing dimensions in the block continue to impact the formula. This is considered an input context operator because it requires explicitly named dimensional objects to be included in the calculation.
                

ForAllThis operator is used to remove dimensions from a context. Dimensions as part of the ForAll construct will be removed, but other dimensions within the block will continue to have a bearing on the formula. This is considered an output context operator because it aggregates out at the dimensional level.
                

The ForEach Operator
This context operator should be used to add a dimensional break to a calculation even when the dimension is not assigned to the same data block. An example of this operator can be used to calculate the maximum sales revenue by quarter for each year.
In this example, the data table contains a single dimension—Year—but needs to display the highest quarterly revenue for each year. This is shown in Figure 11.25, along with the total annual sales revenue.

Figure 11.25    Highest Sales Revenue for Each Quarter
You can add to this formula to get even more information by using the ForEach operator. Let's say that you need to know the highest revenue producing categories by quarter and by year. This can be accomplished by adding the Category object to the formula after the Quarter object, as in Figure 11.26.

Figure 11.26    Calculating the Maximum Sales Revenue for Each Category Quarterly and within Each Year
The ForAll Operator
This operator is used to calculate a value after removing a dimension from a context. In this example, you have a data table with two dimensions—Year and Quarter. This calculation uses the ForAll operator to aggregate Sales revenue by Year and remove the Quarter dimension from the calculation. You can also calculate the maximum Sales revenue for all quarters within each year. These columns are shown in Figure 11.27.
The formulas used in these calculations are the following:


=Sum([Sales revenue]) ForAll ([Quarter])


=Max([Sales revenue]) ForAll ([Quarter])



Figure 11.27    Using the ForAll Operator to Remove the Quarter Dimension from the Calculation
Next, we'll discuss references that give a new dimension to the formula language by allowing you get value from any specific data point.









11.6    References
References are a new variable type introduced in SAP BusinessObjects BI 4.2 SP 3 that returns the value of a specified cell. These new variables can be very useful when creating summary reports that need to reference various data points within a report and can be used anywhere in a document. They serve as shortcuts that point to data of any cell in a report and are filterable by selections made from input controls or simple filters.
References have the advantage of retrieving the value of a cell in its computational context. This helps by avoiding the recreation of complex formulas to get the context of a cell where it has been computed.
Once created, references appear in the Available Objects pane in the side panel and can be used in variables and custom formula calculations.
11.6.1    Creating a Reference
To create a reference follow these steps:


                    In Design mode, right-click on a cell for a value that you'd like to generate a reference. This cell can be part of a table or not.
                

                    In the contextual menu, select the Add Reference command. The Assign Reference dialog box opens, as shown in Figure 11.28.
                    
Figure 11.28    Assign Reference Dialog Box


                    Keep the radio-button Create a new reference for this cell selected.
                

                    Enter a meaningful name for the reference in the Name text field and, optionally, a description in the Description text field. This text field was added in SAP BusinessObjects BI 4.2 SP 4.
                

                    Click OK. The reference  appears in the Available Objects side panel, under the References folder.
                

                    You can right-click the reference and in the contextual menu, select the Show referenced cell command.
                

                    As shown in Figure 11.29, the focus is moved to this referenced cell which is highlighted in the report. This can be useful for sorting your references if you have created many of them.
                


Figure 11.29    Show Referenced Cell
In the Assign Reference dialog box (shown in Figure 11.28), the second option, Assign an existing reference to this cell, is used to assign an already existing reference to this cell. This can be used, for example, if the referenced cell has been deleted. This option helps you avoid unnecessary recreation of cells by redefining a new cell.
To delete a reference, right-click it in the Available Objects side panel and in its contextual menu, and select the Delete command.
11.6.2    Using a Reference
Once a reference has been created, you can drop it into a report or cell by dragging it from the References folder or use it in a formula or variable definition.
Figure 11.30 shows two uses for references. The first is on top the report. The reference has just been dragged and dropped into the document, which displays the reference value into a new free cell.
The second is in the source table. The reference has been used in a formula that computes the difference between this reference and the measure in the Internet Order Count column. This difference is displayed in the last column.

Figure 11.30    Using References
11.6.3    Reference Error Code
There are two error codes that you're likely to see in specific situations:


#REF_CELLNOTFOUNDThe reference returns this error message if the cell it references has been deleted. All formulas that may use this reference are also impacted by this error message. To fix this error message, you can select a new cell and assign it to this reference, with the Assign an existing reference to this cell option.
                

#REF_DATANOTFOUNDThe reference returns this error message if the referenced cell is no longer available since it has been filtered and is no more displayed. Filtering can have been done by any query or report filters (see Chapter 9) or directly in the database.
                    If the filter is removed and the cell content is available, then the reference can return the value.
                










11.7    Summary
With so many powerful report-side functions in Web Intelligence, you'll be able to develop the most sophisticated reports for advanced data analysis and to solve unique business problems.
Functions and variables allow report developers to provide valuable analytical insight by using business data to create calculations. Data retrieved by a Web Intelligence query can be used in combination with more than 160 functions and almost 40 operators to create complex and precise formulas. The ability to merge variables to other variables or dimensions from other data sources is a new feature that almost every report developer is sure to get miles of use from.
Formulas can be converted into variables, used throughout an entire reporting document, and saved within a document to provide ongoing and maintenance-free analysis.
You can use result objects returned by your queries to create functions that aggregate data, extract information from dates, or dissect string values by using character functions.
You can create formulas and variables to calculate data at an even more detailed level of analysis by using a unique set of operators. Examples of these operators include filtering values with the Where operator and aggregating values by block, section, or report. Through references, you can retrieve the value of any cell in a report and reuse it in a formula.








12    Advanced Query Panel FunctionalitiesYou can apply complex filtering strategies when retrieving data to create reports with highly customized and refined data sets. Use advanced querying techniques to produce tightly focused reporting documents.Web Intelligence proposes a powerful way to query data sources without any technical knowledge, through the Query Panel, described in Chapter 2, Chapter 9, and Chapter 10. This Query Panel supports intuitive and simple workflows common to most data sources that have contributed to Web Intelligence's success.Among its strengths, the Web Intelligence Query Panel offers you an intuitive self-service access to company data based on an easy-to-learn drag-and-drop interface. This interface hides technical details to generate the scripts from universe objects. You can also easily take advantage of a wide range of different condition types when filtering objects, limit query retrieval time and row counts, prompt users for input when reports are refreshed, and set drill options to the analysis data set in the document.Behind its apparent simplicity, the Query Panel includes advanced features that allow you to create queries that answer more complex business questions:

            You have access to several prompt options such as cascading prompts and the capability to save and reuse predefined sets of answers for prompts.
        

            It takes advantage of the hierarchical metadata exposed by multidimensional data sources. These abilities are enforced to support SAP BW and SAP HANA data sources, described in Chapter 13.
        

            When you query a relational universe, you have the flexibility to edit the generated SQL script to modify it.
        

            Performances can be improved through query stripping.
        

            The Query Panel can manage partial, purged, and cancelled queries.
        
All these advanced capabilities are described in this chapter, starting with information on cascading and optional prompts.
12.1    Cascading and Optional Prompts
Cascading prompts are used to assist users with selecting values in prompted Web Intelligence reports. Use the Universe Design Tool or the Information Design Tool to create and modify cascading prompts for dimension objects by creating a cascading list of values (LOV). Figure 12.1 shows the steps for opening the Create a Cascading List of Values window. Choose Tools • Lists of Values • Create cascading Lists of Values to begin setting up cascading LOVs.

Figure 12.1    Create Cascading Lists of Values in the Universe Design Tool
12.1.1    Defining a Cascading List of Values in the Universe Design Tool
You can use this utility to provide users with a hierarchical structure for selecting values in prompted reports. By providing a functional context of the dimensional values, users have a better understanding of the data in a report that uses a cascading LOV in the prompted filter.
To add dimensional objects to a cascading list, double-click on dimension objects or select them from the list of Available Objects and click the > icon. LOVs should be created from logical hierarchies previously set up in the universe.
Figure 12.2 shows the Create Cascading List of Values window launched from the step described previously, with three objects added to create a cascading list of dimensional values.

Figure 12.2    Cascading Lists of Values Window
To create a cascading LOV, follow these steps:


                    Select objects to generate a cascading LOV.
                

                    Click the > symbol to add objects to the Cascading List of Values section.
                

                    Revise the prompt text of each object (optional).
                

                    Click Generate LOVs to accept the selections and create the cascading list.
                


Note
Be sure to save and export your universe to the repository after creating the LOV.

12.1.2    Using a Cascading List of Values as a Prompted Filter
After you create a cascading LOV in the universe, you can use any object in the LOV as a prompted filter by following these steps:


                    Drop the object onto the Query Filters pane.
                

                    Select Prompt as the filter type (see Figure 12.3).
                    
Figure 12.3    Using Cascading Objects as a Prompted Filter


                    Click the Settings button to view the prompt settings, as shown in Figure 12.4.
                

                    Be sure to check the Prompt with list of values checkbox.
                


Figure 12.4    Prompt Properties

Note
Although Keep last values selected is checked by default, it's optional and can be unchecked.

12.1.3    Refreshing a Report with a Prompted List of Values
Cascading prompted filters become useful when refreshing reports. All objects in the cascading list will appear in the prompted values list in tree form. Navigate into the tree to select the values you want.
As an example, Figure 12.5 shows the order of the cascading list of objects that you set up at the universal level in the previous step. Notice that the Store name object is at the bottom of the hierarchy, the City object is one level up, and the State object is at the top of the hierarchy.

Figure 12.5    Hierarchy of Cascading List of Values
When the Store name object is added as a prompted filter and the report is refreshed, you'll be prompted to select a value from the list of available customer objects.
When the object being filtered is at the bottom of the hierarchy in a cascading LOV, you need to expand the object values above it in the hierarchy until you get down to the level of the object.
In this example, the Store name object prompts the user to expand a State value, followed by expanding a City within the state selected, and finally selecting the Store name value (see Figure 12.6).

Figure 12.6    Prompted Filter of Cascading List of Values Object
Click on the > symbol to add the value to the list, and then click Run Query.
The Run Query button becomes enabled when at least one value is added.
12.1.4    Optional Prompts
Check the Optional Prompt checkbox in the Prompt Properties section of the Parameter Properties window to make a prompted filter object optional when answering prompts rather than requiring the user to select or enter a value. To access this setting, set the filter type to Prompt in the Query Filters pane, and then launch the Prompt properties dialog box (see Figure 12.4).
Prompts give you flexibility when it comes to filtering datasets. To simplify prompts even more, you can save prompt answers in BI variants.









12.2    Saving Prompts Answers in BI Variants
Prompts are one of the most common used features in operational BI, as they allow you to parameter your queries to retrieve your data set. If you have a document with several prompts and/or a long list of personal values to answer, BI variants help you avoid the tedious task of answering them each time you refresh.
A document can store the previous prompt values answered to refresh the document. But you may have cases where:


                Several users are using the same document and when they refresh it, they answer the prompts with their own values.
            

                You have different set of answers to refresh the document. If these answers are non-intuitive, like product code, it can be tedious to enter these product codes each time you need to refresh your document.
            

A solution for these cases is to duplicate the documents, each document copy storing different previous values. But this generates many documents, which may become difficult to maintain. With a BI variant, you can save a group of often-used variable value sets as a prompt variant.
If you have dynamic answers prompts (for example, you can define in the universe a prompt answer based on a formula, like CurrentDate), then saving it in the BI variant will keep a static value instead of evaluating it at runtime. To avoid this, since SAP BusinessObjects BI 4.2 SP 4, you can select the answers to not include in the BI variant.
A variant is specific to a pair user/document, and when you save it, you are the only one who can use it.

Saved Document
You can only create a BI variant for a document that has already been saved in the BI platform repository.

Variants are available for any document, whatever its data source (universe, SAP BW, SAP HANA, etc.).
12.2.1    Creating a BI Variant
To create a BI variant for a document saved in the BI platform repository and containing prompts, follow these steps:


                    Open the document and refresh it to open the Prompts dialog box.
                

                    Answer the prompts, but before clicking OK to run the query, click Create prompt variant  in the dialog box toolbar.
                

                    The Create variant dialog box opens, as shown in Figure 12.7.
                    
Figure 12.7    Create Variant Dialog Box


                    Enter a name for your variant in the Name text field.
                

                    In the Prompts list, you may unselect the checkbox for the prompt answers you do not need to include in the BI variant.
                

                    Click OK. Your BI variant has been saved. Its name appears in the toolbar, in the Available prompt variants dropdown menu. Click OK to run the query.
                

You can save as many BI variants for your document as you want. Each BI variant may contain different answers for your document.
Once the BI variant has been created, you can use it to easily and quickly answer often-used variable prompts answers instead of having to manually enter them.
12.2.2    Using BI Variants
When you refresh a document containing prompts, if you have created some BI variants for it, in the Prompts dialog box, the Available prompt variants dropdown menu contains the list of these BI variants, as shown in Figure 12.8. To use one them:


                    Select it in this dropdown menu. The answers you have saved in it automatically fill the Prompts dialog box.
                

                    You can modify some answers or answer the ones that were not saved in the BI variant, if any.
                

                    Click OK to run your query and fetch the data from the data source.
                


Figure 12.8    Selecting a BI Variant in Prompt Dialog Box
12.2.3    Managing BI Variants
Managing BI variants is also done in the Prompts dialog box.
To modify the answers saved in a BI variant, select it in the Available prompt variants dropdown menu. Modify the answers, then click Save prompt variant changes  in the toolbar. As seen in Figure 12.9, the dropdown menu that opens contains the following choices:


Update: Save only updated values for answers previously saved in the BI variant.
                

All: Save all answers in the BI variant.
                

Selection: Open the Create variant dialog box so you can select the answers to save in the BI variant.
                

After you have confirmed, the BI variant is updated.

Figure 12.9    Save Prompt Variant Changes Dropdown Menu
To delete a BI variant, select it in the Available prompt variants dropdown menu, then click Delete prompt variant  in the toolbar. After you have confirmed, the BI variant is deleted.









12.3    Querying Multidimensional Data Sources
When you create a Web Intelligence document from a multidimensional data source (multidimensional universe, SAP Business Explorer (BEx), or SAP HANA direct access described in Chapter 13), you also use the Query Panel to define the query to send to the data source. As shown in Figure 12.10, this Query Panel contains additional functionalities compared to a relational universe:


                The Outline pane displays hierarchical metadata coming from the multidimensional data source.
            

                The Result Objects pane takes on a whole new set of capabilities and allows you to drill into hierarchical member data through the Member Selector.
            


Figure 12.10    Multidimensional Query Panel
12.3.1    Multidimensional Metadata
In the outline sourced from a multidimensional source, like the multidimensional universe created with the Information Design Tool, new objects' metadata are exposed by the multidimensional data source. In addition to the folder, filter, measure, dimension, and attribute common with relational data sources (see Chapter 2, Table 2.1), a multidimensional data source supports the specific objects listed in Table 12.1.




                            Icon
                        

                            Object Type
                        

                            Description
                        








                            Analysis dimension


                            An analysis dimension is the container of the dimensions and hierarchies in a multidimensional database.
                        






                            Level-based hierarchy 


                            A hierarchy is a collection of members with one-to-many relationships and organized in levels.
                            A level-based hierarchy is a hierarchy where members are of several types, and members of the same type have the same level. For example, a hierarchy Catalog may have Category, Line, and Product levels.
                        






                            Parent-child hierarchy


                            A parent-child hierarchy is a hierarchy where all levels have the same type. For example, a hierarchy Organization may have an Employee level. To represent management links, an employee can be parent of other employees.
                        






                            Default hierarchy
                        

                            When you drag and drop an analysis dimension in the Result Objects pane, if this analysis dimension has several hierarchies, then the default hierarchy is the one that is added.
                        






                            Time hierarchy
                        

                            This analysis dimension has been defined as a time dimension. However, Web Intelligence does not take advantage of the time characteristic.
                        






                            Hierarchy level


                            Members in a hierarchy are organized in levels.
                        






                            Level attribute
                        

                            A level attribute is always associated with a level. It provides descriptive data about this level. For example, an Employee level may have an ID attribute.
                        






                            Calculated measure


                            A calculated measure is a custom measure defined in the business layer.
                        






                            Calculated member


                            A calculated member is a member of an OLAP dimension and associated with a hierarchy.
                        






                            Named set


                            A named set is a collection of members that can belong to one or more hierarchies.
                            A name set can be a simple set or a complex set.
                        



Table 12.1    Additional Objects in Multidimensional Universe Outline
You can create the query by adding objects from the Outline into:


                    The Result Objects pane by dragging and dropping or double-clicking them.
                

                    The Query Filters pane by dragging and dropping them.
                

Query filters can still be used as long they contain objects not in the Result Objects pane. Query filters aggregation can only be done using the AND operator. But to avoid these limitations and take full advantage of multidimensional hierarchies, it is best to filter hierarchies through the Member Selector.
12.3.2    Member Selector
As seen in the previous section, multidimensional data sources contain richer metadata that you can select in the Result Objects pane. When you include a hierarchy, this object lets you choose the members you want to display in the result set. The choice of members affects only the display of the data, not the calculations or the filtering. For example, as shown in Figure 12.11, if you choose to display the revenue of US and of its child California, then the revenue of US takes into account all states—it's not filtered on the California state only since the revenue of US is already aggregated in the multidimensional data source.

Figure 12.11    Aggregated Value Displayed for Hierarchy
When you add a hierarchy in the Result Objects pane, it retrieves its default member by default. You may explicitly define the members to display by using the Member Selector dialog box, which can be opened by clicking the downward arrow  on the right of a hierarchy object, as shown in Figure 12.12.
As shown in Figure 12.13, the Member Selector pane contains:


                    Three tabs (Members, Metadata, and Prompt) that allow you to define the members to add in the query in three different manners.
                

                    A Summary pane at the bottom that displays the selected members.
                    
Figure 12.12    Opening the Member Selector



Figure 12.13    The Member Selector
Let's look at each of those now.
12.3.3    Member Selector: Members Tab
In this first tab, you can directly choose which members to display in the result. You can directly check each needed member. Right-click a member to use operators that automatically add or exclude other members based on those selected. The possible rules, appearing in the menu as shown in Figure 12.14, are:


SelfOnly the member.
                

ChildrenOnly the child members of the selected member (one level down).
                

DescendantsAll descendants of the selected member (all levels down).
                

Descendants until Named LevelAll members who descend from the selected member to a specific level. For level-based hierarchies, the level is defined by its name. For parent-child hierarchies, the level name is its position (e.g., Level 01, Level 02, etc.).
                

Descendants untilAll descendants until reaching a specified number of levels below.
                

ParentThe parent of the selected member (one level up).
                

AncestorsAll members from which the selected member descends.
                

SiblingsAll members at the same level and with the same parent of the selected member.
                

ExcludeExcludes members from the selection; this command opens a submenu, letting you choose the operator (among Children, Descendants, Parent, Ancestors, and Siblings) to use to compute the members to exclude.
                


SAP BW
The Parent, Ancestors, Siblings, and Exclude commands are not available with SAP BEx (direct access and multidimensional universe) data source.


Figure 12.14    Right-Click Options Available within the Member Selector
The Member Selector contains a toolbar that can also help you to search for members, select members, change the member's name display, sort members, and show the members.
Search for Members
To search for members, click the  button to open the search dialog box, as shown in Figure 12.15. When you query a multidimensional universe, this button is enabled only if the list of values associated with the hierarchies has the Allow users to search values in the database option activated.
Only the values that match the search criteria are returned in Member Search dialog box. The following characters are used to define the matching criteria:


*: Matches any number of characters, even zero characters.
                    

?: Matches exactly one character.
                        
Figure 12.15    Searching for Members in the Member Selector


You can search for member names (select the Search in text option) or member unique names (select the Search in keys option). You can check the members and click OK to add them in the current member selection. You can search for members several times to add members to the selection.
Member Selection
Click the Select button  to open a dropdown menu, shown in Figure 12.16, containing some shortcuts to add or remove member to/from the selection.


Select NoneRemoves all the members of the hierarchy.
                    

Select All MembersAdds all the members of the hierarchy.
                    

Select All Members until Named LevelAdds all the members that descend from the hierarchy root member(s) to a specified level below.
                    

Select All Members until Adds all the members that descend from the hierarchy root member(s) to a specified number of levels below.
                        
Figure 12.16    Select Dropdown Menu


Display Name and/or Unique Name
You can change the member's name display by clicking the Member display mode button  and selecting one of the following options:


Display caption (e.g., Phones)
                    

Display unique name (e.g., [Product].[Product Lines].[Line].&[9])
                    

Display both caption and unique name (e.g., Phones [Product].[Product Lines].[Line].&[9])
                    

Sort Members
By default, the hierarchy members are displayed in the database order. But it is possible to sort the members of a hierarchy by clicking the Sort order button  and selecting one of the following options:


No Sort (database order): Restores the default members' display.
                    

Sort Ascending: The members are sorted in ascending mode. The sort applies for all members having the same parent and thus for the whole hierarchy.
                    

Sort Descending: The members are sorted in descending mode. The sort applies for all members having the same parent and thus for the whole hierarchy.
                    

Show the Member Selection
The selected members can be directly selected or indirectly selected by using OLAP style family selection and levels selection. To view all the selected members, you can unfold members in the hierarchy or click the Expand tree to show selections button  that expands the hierarchy to make all selected members visible in the Member Selector pane.
12.3.4    Member Selector: Metadata Tab
The Metadata pane offers the possibility to select hierarchy levels, named sets and calculated members.  You can choose the levels, the named sets, and the calculated members to display in the result, as shown in Figure 12.17. The list of named sets contains the named sets you have created in the business layer and the named sets that have been created in the OLAP cube—mainly for Microsoft SQL Server Analysis Services.

Figure 12.17    The Metadata Tab of the Member Selector
The Member Selector pane lets you navigate through the hierarchies under the Levels branch, which displays the number of levels within the selected hierarchical object and allows you to select a specific level for analysis. All levels—or any combination of the available levels—can be chosen.
If named sets have been created for this hierarchy, there are listed under the Named Sets branch. You can also select the ones to use in the query definition.
12.3.5    Member Selector: Prompt Tab
Member prompting is also available to provide a form of guided analysis. Use the Prompt tab shown in Figure 12.18 to enable prompting and ask users for input when reading reports. Users can be prompted to select specific members or levels in a hierarchical structure for selective analysis. This setting saves time and helps users get directly to the information they need and at the right level of detail.

Figure 12.18    Prompt Tab of a Selected Member
Define a prompt (and its text) by asking to choose the members when clicking Refresh. The prompt appears before running the query. The prompt member selection removes all the selections you added in the Members and Metadata panes. As shown in Figure 12.18, you can define some properties for this prompt:


Enable prompt: Enable or disable this prompt.
                

Prompt Text: Define the text to display in the prompt.
                

Keep last values selected: Keep the same selected members when the query is refreshed again.
                

Set default values: Define default members selected in the prompt. To modify these members, click the Edit button.
                

When the prompt is displayed to let the user choose members, the Member Selector only offers the ability to check members (member picker), as shown in Figure 12.19. The OLAP style family selection (children, descendants, and so on) is not possible in the prompted member selection.

Figure 12.19    Prompted Members When Refreshing the Query
12.3.6    Member Selector: Summary Pane
The selections you added in the Members and Metadata panes are reflected in the Summary pane, which in turn displays the members you selected in these panes, as shown in Figure 12.20.
From this pane, you can do the following:


                    Directly delete a selection by clicking the icon  in the column in the right.
                

                    Exclude the selected members from the list of members to query by selecting the checkbox in the Exclude column.
                

                    Delete the entire selection by clicking the button  on the right side of Summary text.
                    
Figure 12.20    Member Selector Summary


When you've defined your member selection, click OK to close the Member Selector pane. In the Result Objects pane, the hierarchy object is updated with the selected members.
12.3.7    Displaying Hierarchies
Hierarchical data will be returned to the Report Panel for intuitive and logical navigation of the multitiered data structures. Expandable and collapsible data blocks are available in the Report Panel specifically designed for hierarchical interaction for reports originating from multidimensional data sources, as shown in Figure 12.21.

Figure 12.21    Hierarchy Display with Collapsed and Elapsed Rows









12.4    Editing Auto-Generated SQL Scripts
To execute queries, Web Intelligence generates SQL or MDX statements based on the join paths set up at the universe level, objects added to the Result Objects pane, and user-defined or predefined conditions added to the Query Filters pane.
On occasion, you might encounter a need to make minor changes to the script generated by Web Intelligence. This capability is available only for relational universes that generate SQL, and not for multidimensional universes and their generated MDX.

A Word of Caution
Modifying the generated script should be attempted only if you understand SQL syntax, understand the underlying database table relationships, and have a legitimate business reason for manually overriding the generated SQL statement.

Although it gives the appearance of free-hand SQL, a couple of very specific rules must be followed when editing and overriding the SQL script generated by the Web Intelligence engine, making it more the capability to edit the generated script than an option to write completely freehand SQL:


                The number of items in the Select section of the edited SQL statement must match the number of result objects originally placed in the query.
            

                The data type of the objects and their order in the edited Query Script viewer must match the data type of the result objects originally placed in the query.
            


Restricting the Modification of Generated SQL
From an administrative perspective, the rights to view SQL and edit the query script can be denied in the Central Management Console (CMC) by modifying the rights of an access level (see Appendix B).

To modify the automatically generated SQL, follow these steps:


                As described in Chapter 2, Section 2.2, in the Query Panel, click View Script. The SQL syntax is displayed in light gray lettering. The Undo and Validate buttons are disabled unless changes are made to the SQL generated by Web Intelligence.
            

                Click on the Use custom query script radio button to make changes to the generated script. This enables the text area that displays the generated SQL statement. The code is then displayed in black lettering and is editable.
                Editing the script will enable the Undo button located at the bottom of the Query Script viewer screen. You can also copy the script for use outside of the document. This is helpful if you need to paste the SQL statement into another window to edit it or email it to a colleague.
            

Figure 12.22 shows the Query Script viewer with a customizable SQL statement, with a filter added manually to return only the data set for Dallas.
            

                Click Validate to check your SQL script is valid. If this is the case, a confirmation message is displayed, otherwise an error message is displayed. This is a very handy feature that protects you from submitting a custom SQL statement to the database that contains errors.
            

                If no errors were found after validating the syntax, click Save to overwrite the SQL generated by the Query Panel, close the Query Script viewer, and return to the Query Panel.
            

                Click Run Query to run the script you have provided and retrieve the data set in the document.
                
Figure 12.22    SQL Viewer with Custom SQL



Regenerating SQL
After you have provided your script, if you change the query by modifying the objects in the Result Objects or Query Filters panes in the Query Panel, then the SQL script is automatically regenerated from the universe and your custom script is lost.

In addition to editing SQL scripts to query the relational database, Web Intelligence offers another method to optimize such queries: query stripping.









12.5    Support of Query Stripping
Query stripping is a technique that improves query performance by stripping out all objects from the query that are not directly or indirectly being used in the Report Panel.
For example, if your query contains seven objects but your document contains a table that displays only three of these objects, then the query to the data source is optimized to query only these three objects, hence improving the query performance.
This technique is available for the following data sources:


                Relational and multidimensional universe created with Information Design Tool (UNX). For relational universe, you need to select the Allow query stripping option in the Information Design Tool for this universe. This includes the ones created on SAP BEx (see Chapter 13, Section 13.3.2) and SAP HANA (see Chapter 13, Section 13.6.1).
            

                Relational universe created with Universe Design Tool (UNV) on SAP BW (see Chapter 13, Section 13.3.1).
            

                SAP BEx direct access (see Chapter 13, Section 13.2).
            

                Relational SAP HANA direct access based on ODBC or JDBC (see Chapter 13, Section 13.4). However, it is not supported on multidimensional SAP HANA direct access based on the SAP HANA Client.
            

This feature provides significant query improvements to queries based on SAP Business Warehouse (SAP BW) queries.
These settings are also required when creating Web Intelligence documents sourced from SAP BW or SAP Business Explorer (SAP BEx) sources.
Three options must be enabled at several levels to turn on query stripping:


Universe levelIf your query is based on a relational universe, the query stripping must be enabled in the Information Design Tool, at the business layer.
                Open the Query Options tab in the business layer and check the Allow query stripping option. Be sure to save the changes and then publish the universe into the BI platform repository.
                For multidimensional universe, query stripping is always enabled.
            

Query levelTo enable query stripping at the query level, begin by opening the Query Panel, and then editing Query Properties. Check Enable query stripping and then click OK (see Chapter 2, Section 2.2.2).
            

Document levelTo enable query stripping at the document level, return to the Report Panel. Next, click the Properties tab followed by the document selection.
                Check the Enable query stripping option in the Document Summary window (see Chapter 2, Section 2.6).
            

With query stripping enabled in all three areas, the script generated by Web Intelligence will be modified each time an object is either added or removed from a report element in the Report Panel. Each time an object has been removed or added to/from a report element, the query should be refreshed again to apply the query stripping feature to the script generation engine.
Even with optimized queries, when it comes to querying a large amount of data, you may end up dealing with partial or cancelled queries and, under some circumstances, with purged data.









12.6    Partial Results, Purged Data, and Cancelled Queries
The data set displayed in your document depends on the query execution against the data source. To understand the boundaries of this data set, it is important to know the specific cases where you can retrieve partial data set, purge this data set, or cancel your queries.
12.6.1    Retrieving Partial Results
If a query refreshes successfully but returns partial results, the bottom-right corner of the report will display a yellow icon containing an exclamation point, as shown in Figure 12.23. This icon indicates that only partial results have been retrieved.

Figure 12.23    Yellow Icon Indicating Partial Results
Partial results leave reporting documents incomplete and should be resolved before publishing, printing, or exporting a report locally or to the BI platform.
The following are the three most common scenarios that cause partial results:


Max rows retrieved setting in the Limits category of the Query Properties window in the Query Panel (see Chapter 2, Section 2.2.2).
                

Max retrieval time setting in the Limits category of the Query Properties window (see Chapter 2, Section 2.2.2). This setting is expressed in seconds.
                

Controls tab in the Universe Parameters dialog box, as shown in Figure 12.24.
                


Figure 12.24    Controls Tab in the Universe Parameters
To modify the maximum number of rows retrieved in the query, follow these steps:


                    From the Report Panel, click the Data Access tab to enter the Query Panel.
                

                    Click the Query Properties shortcut icon located at the top of the screen.
                

                    Check or uncheck the Max Rows Retrieved setting. If checked, modify the number of rows.
                

                    Check or uncheck the Max Retrieval Time setting. If checked, modify the time value.
                

Use the following steps to modify the maximum number of retrievable rows at the universe level:


                    Launch the Universe Design Tool.
                

                    Open the Universe Parameters dialog box.
                

                    Click on the Controls tab.
                

                    Check or uncheck Limit Size of Result Set To and then modify the maximum number of rows to be retrieved.
                

12.6.2    Purging Data
The option to purge data is commonly used before publishing Web Intelligence reports to the server that may contain restricted information. You can purge data in the Report Panel, in Design mode. Figure 12.25 shows the Purge icon  located on the Data Access • Data Providers tab.

Figure 12.25    Purge Button in Data Access
You can also use the Refresh On Open option (see Chapter 2, Section 2.5.3) to force the document to be refreshed when it is opened. If row-level security has been defined for users, this security is applied during the refresh.
12.6.3    Cancelling a Query
If a query takes too long, you can cancel it by clicking Cancel in the progress windows, shown in Figure 12.26. If the underlying data source does not support Cancel (this is the case for example with SAP BW), then Web Intelligence lets the query finish in the background, so you can continue working in the tool.

Figure 12.26    Progress Window
When you cancel a query, Web Intelligence proposes you three options to manage the data set, as shown in Figure 12.27:


Restore the results from the previous data retrieval: To keep the previous data set before the refresh.
                

Purge all data from the document: To clean the document microcube and remove the full data set (Section 12.6.2).
                

Return the partial results: To display only the rows retrieved before you've cancelled. The data set is displayed as partial (Section 12.6.1).
                


Figure 12.27    Proposed Options for Cancelled Query









12.7    Summary
You can produce the most accurate, valuable, and actionable reports possible for your clients by using the Query Panel advanced features:


                Add more interactivity in your documents with cascading and optional prompts.
            

                Save your own prompt answers in a BI variant. This will save you time when answering prompts and can help reduce Web Intelligence document proliferation.
            

                Edit the generated SQL script to use your own.
            

                If you query multidimensional data sources, the Query Panel gives you capabilities to take advantage of hierarchies and select the members to query through a dedicated component, the Member Selector pane.
            

                You can purge the document data set and manage partial results and cancelled queries.
            

Chapter 13 explains how to connect Web Intelligence to SAP HANA and SAP BW data sources.








13    Access to SAP BW and SAP HANAGet the best of both worlds by connecting Web Intelligence to query your SAP data sources (SAP BW and SAP HANA) and create documents on top of them.SAP Web Intelligence is a Business Intelligence tool that can access a wide range of data sources (including the ones supported by universe), query them identically through the Query Panel interface, and create powerful documents from the retrieved data set. This is also the case when it comes to querying SAP data sources and SAP HANA:

            SAP Business Warehouse (SAP BW) is an SAP enterprise warehouse solution.
        

            SAP HANA is the new platform proposed by SAP. This high-powered, in-memory data platform provides real-time analytics and enables businesses to create competitive advantages and make more agile decisions with very large volumes of transactional and analytical data.
        
Before detailing how Web Intelligence connects to SAP BW and SAP HANA and taking into consideration their specificities, this chapter presents an overview of these accesses in the SAP landscape.
13.1    SAP BW and SAP HANA Access Overview
The overview is intended to present SAP BW, SAP HANA, the different interfaces used to connect to them, and the models they expose (relational or multidimensional). It also presents how these systems integrate in SAP landscape and how to access them in such a deployment.
13.1.1    SAP HANA and SAP BW
For SAP BW, the possible accesses from Web Intelligence are described in Table 13.1.




                            SAP BW Artifact
                        

                            Interface
                        

                            Type
                        

                            Mode
                        





                            SAP BEx query
                        

                            BICS


                            Multidimensional
                        

                            Direct access, Section 13.2.
                        



                            SAP BEx query
                        

                            BICS
                        

                            Multidimensional
                        

                            Universe (UNX), Section 13.3.
                        



                            InfoProvider
                        

                            SQL


                            Relational
                        

                            Multi-source universe (UNX), Section 13.4.1.
                        



                            InfoCube
                            MultiCube
                            SAP BEx query
                        

                            SQL
                        

                            Relational
                        

                            OLAP UNV universe, Section 13.4.2.
                        



Table 13.1    Access to SAP BW
As for SAP BW, Web Intelligence proposes different ways to connect to SAP HANA and query it, as described in Table 13.2. The ones that allow direct connection to the server without the need of a universe are expected to be more popular since they're easier to put in place.




                            SAP HANA Artifact
                        

                            Interface
                        

                            Type
                        

                            Mode
                        





                            View
                        

                            SQL
                        

                            Relational
                        

                            Direct access, Section 13.5.
                        



                            View
                        

                            MDX


                            Multidimensional
                        

                            Direct access, Section 13.5.
                        



                            View
                        

                            SQL
                        

                            Relational
                        

                            Online, Section 13.6.
                        



                            View
                        

                            SQL
                        

                            Relational
                        

                            Universe (UNX), Section 13.7.
                        



                            Table
                        

                            SQL
                        

                            Relational
                        

                            Single-source universe (UNX, UNV) and multi-source universe (UNX), Section 13.7.
                        



                            Table or view
                        

                            SQL
                        

                            Relational
                        

                            Free-hand SQL, Section 13.8.
                        



Table 13.2    Access to SAP HANA

Unsupported HANA HTTP Connection
In SAP BusinessObjects BI 4.2 SP 4, the SAP HANA HTTP connection that can be created in CMC is not supported by Web Intelligence.

In SAP BusinessObjects BI 4.2 SP 3, the change source proposes new paths to support documents based on SAP BW direct access, SAP HANA direct access, or on a universe based on an SAP BEx query (see Chapter 14, Section 14.7).
13.1.2    SAP HANA as a Platform
SAP HANA is not only a database, but also an application platform that can be used to embed and run applications.


                    SAP BW on SAP HANA does not use SAP HANA as a platform but is simply an SAP BW system using SAP HANA as its underlying database.
                

                    SAP Business Suite powered by SAP HANA is a first implementation of the SAP Business Suite on SAP HANA that uses native SAP HANA calculation views and named SAP HANA Live calculation views in addition to SAP Business Suite tables. These SAP HANA calculation views can be maintained in SAP HANA Studio.
                

                    SAP S/4HANA is the next generation of SAP Business Suite, simplified and powered to run on SAP HANA, including ABAP-managed Core Data Services (CDS) of the ABAP layer of SAP. SAP S/4HANA views (open CDS views) can be maintained in ABAP for Eclipse.


                    SAP BW/4HANA is the next generation of SAP BW applications that has been ported and optimized to run on SAP HANA.
                

As described in Table 13.3, these applications can be queried by Web Intelligence as well, through one of the available accesses it supports (Section 13.1.1).




                            Data Sources
                        

                            Web Intelligence Supported Access
                        





                            SAP BW on SAP HANA
                        

                            Same access as for SAP BEx queries:
                            

                                    SAP BW direct access on SAP BEx query
                                

                                    Multidimensional universe (UNX) on SAP BEx query
                                

                            If SAP BEx queries are exposed as SAP HANA views, then the same access as for SAP HANA views:
                            

                                    Relational universe (UNX)
                                

                                    SAP HANA direct access


                                    SAP HANA Online mode


                                    Freehand SQL






                            SAP Business Suite on SAP HANA
                        

                            Same access as for SAP HANA views:
                            

                                    Relational universe (UNX)
                                

                                    SAP HANA direct access
                                

                                    SAP HANA Online mode
                                

                                    Free-hand SQL
                                





                            SAP S/4HANA
                        

                            If SAP S/4HANA CDS views are exposed as SAP BEx queries, same access as for SAP BW through BICS:
                            

                                    SAP BW direct access
                                

                                    Multidimensional universe (UNX) on SAP BEx query
                                





                            SAP BW/4HANA
                        

                            Same access as for SAP BW through BICS:
                            

                                    BW direct access
                                

                                    Multidimensional universe (UNX) on SAP BEx query
                                





Table 13.3    Access to Applications Running on SAP HANA









13.2    SAP BEx Query through Direct Access
Direct access to SAP BEx queries is one of the key enhancements to Web Intelligence, and it continues to increase the popularity of Web Intelligence. This capability allows you to leverage your existing BEx queries as a data source for building Web Intelligence documents.
In BEx direct access, you do not need to create a universe to retrieve data exposed by the BEx query. The BEx query's objects are directly displayed in the Query Panel. You can select them and take advantage of all Web Intelligence features to display the corresponding data set in your document.

Public SAP BEx Query
You can only create a document on SAP BEx queries that have the Allow External Access to the Query option enabled in the SAP BEx Query Designer.

The SAP BEx query is exposed through its multidimensional model and you can see the benefit of the hierarchical capabilities in the Query Panel (see Chapter 12, Section 12.3) and in the document.
13.2.1    Creating a Document in SAP BEx Direct Access
To create a document with an SAP BEx query as a data source, follow these steps:


                    Create a new document (see Chapter 2, Section 2.1).
                

                    In the Data Source Selection dialog box, select the BEx option.
                

                    The Select a BW BEx query dialog box opens (Figure 13.1), where you're prompted to choose the SAP BEx query from a list of certified queries displayed within your preconfigured connections. Navigate in the Connections folder and its subfolders in your BI platform repository to select a connection.
                    
Figure 13.1    Selecting the SAP BEx Query


                    Expand the connection to select an SAP BEx query among the ones you're allowed to use. Depending on the connection created by your administrator or designer, you can access only one specific query, some queries of a cube, or some cubes and their queries.
                    The queries that are not set as public through the Allow External Access to the Query option enabled in the SAP BEx Query Designer are displayed in grey and you cannot use them to create a document.
                

                    Select the query from the right side of the panel and click OK to proceed.
                

                    If you do not have any variables to answer, the Query Pane l opens (Figure 13.2); otherwise, the Set Variables dialog box opens and you must answer them to set the BEx query metadata before it is displayed in the Query Panel.
                    
Figure 13.2    Query Panel for SAP BEx Direct Access


                    The Query Panel displays multidimensional metadata from the SAP BEx query. Click the Member display mode icon  to open a dropdown menu (see Figure 13.3), where you can select how to display the SAP BEx query metadata: by their caption, their unique name (technical name), or both.
                    
Figure 13.3    Member Display Mode Menu


                    In this Query Panel, you can drag and drop objects from the outline to add them in the query, either in the Result Objects or Query Filters section. The metadata is multidimensional and has the same properties as any multidimensional universe (see Chapter 12, Section 12.3). You can:
                    

                            Select hierarchies to drill into hierarchical member data within the SAP BEx query.
                        

                            Select members using the Member Selector pane, allowing you to expand, collapse, and check any of the member values to retrieve exactly the information you need.
                        

                            Enable SAP BEx member prompting and ask users for input when reading reports to prompt to provide a form of guided analysis. Use the Prompt tab of the Member Selector (see Chapter 12, Section 12.3.5). Users can be prompted to select specific members or levels in a hierarchical structure for selective analysis. This setting saves time and helps users get directly to the information they need and at the right level of detail.
                        

                    However, you cannot filter on SAP BEx attributes.
                

                    Click Run Query to close the Query Panel and run your query.
                

                    The query is sent to the SAP BEx query that returns the data set.
                


Member Selector Limitations
In the Member Selector, the Siblings, Parent, and Ancestor member functions are not available for SAP BEx queries.

As for any data source, the objects of the query are listed in the Available Objects panel; the data set is stored in the microcube, allowing you to perform additional powerful calculations. If you selected hierarchies from the SAP BEx query, as shown in Figure 13.4:


                    Hierarchies displayed in the report can be collapsed or elapsed to display the members and allow you to navigate in the multidimensional cube.
                

                    In the Available Objects side panel, levels are automatically created under the hierarchy. You can drag and drop one or more levels and add them into the report to display only the selected levels, and not the full hierarchy.
                


Figure 13.4    Data Retrieved from SAP BEx Query
The capability to create documents directly connected to BEx queries gives SAP BW customers the same reporting features as customers accessing relational or multidimensional databases connected with universes.
13.2.2    Answering SAP BEx Query Variables
In SAP BW and SAP HANA, variables are very specific concepts. A variable is used to define a filter on an attribute of the view. Typically, they must not be confused with Web Intelligence variables (see Chapter 11, Section 11.1).
SAP BW variables are surfaced as Web Intelligence prompts and can be answered:


                    At design time, when you create the query. The metadata returned by the SAP BEx query may depend on some SAP BEx variables that are prompted to you and that you must answer before the SAP BEx query is displayed in the Query Panel.
                

                    Or at query time, when you refresh the query.
                

Design Time
When you create a Web Intelligence query based on an SAP BEx query that contains mandatory variable(s), the Set Variables dialog box appears and displays all variables and their default values, if any.


                        In this Set Variables dialog box (see Figure 13.5), you can answer these variables to fix SAP BW metadata, before the Query Panel can display it.
                        
Figure 13.5    SAP BW Direct Access: Set Variables before Query Panel


                        For each variable, click the ... button in the Values column to open the List of Values dialog box, where you can select the values to set.
                        Since SAP BusinessObjects BI 4.2 SP 3, these variables support multiple operators and range interval variables. For example, as seen in Figure 13.6, if the variable has been defined to support multiple operators, you can define several conditions for different values and define a different operator for each condition.
                        
Figure 13.6    Multiple-Operator Variable


                        When you set your variables, click OK to close the dialog box, open the Query Panel, and create your query.
                    

Later, when you are editing your query, you can modify the values you have set for these variables. In the Query Panel toolbar (see Figure 13.7), click the Set Variables icon  to reopen the Set Variables dialog box.

Figure 13.7    Set Variables Icon in Query Panel Toolbar
In the Set Variables dialog box, as shown in Figure 13.8, you can:


                        Fix variables' values to prevent them from being prompted at query time. Unselect the Set as prompt checkbox beside each variable name and, in the Values column, click the ... button to open the List of Values dialog box and select the value(s) to set for this variable.
                    

                        Set the variables as a prompt, so they are prompted at query time. In this case, select the Set as prompt checkbox beside each variable name.
                    


Figure 13.8    SAP BW Direct Access: Set Variables from Query Panel
You can also select the Use BEx/HANA defined default values at runtime checkbox so these variables' default values (that can be dynamic) are retrieved from the SAP BW system at query time.

Dynamic Default Values
To have this option available, you must also purge the document before refreshing it; otherwise, the default values are not retrieved at query time.

Query Time
When refreshing the document, variables that have not been answered at design time are prompted to users in the Prompts dialog box, where they need to answer the requested prompts.
These prompts are displayed in addition of the prompts added in the query itself to further restrict the data being returned:


                        When defining the query, you have added a prompt filter in the Query Filters pane (see Chapter 9, Section 9.1).
                    

                        In the selected hierarchy, you have defined a prompt to select the hierarchy's members (see Chapter 12, Section 12.3.5).
                    

You can select the Merge Prompts (BEx/HANA Variables) parameter in the document options (see Chapter 2, Section 2.7) and then decide whether to factorize them based on their captions.









13.3    SAP BEx Query through Multidimensional Universe
SAP Web Intelligence can also query SAP BW through universes. The use of universes allows you to better control how the SAP BW content is exposed. Through this universe, you can arrange, simplify, and present the SAP BW content in a friendlier way.
There are three universes supported for SAP BW:


                Multidimensional universe created in the Information Design Tool on top of an SAP BEx query
            

                Relational universe created in the Universe Design Tool on top of InfoProviders
            

                Relational universe created in the Information Design Tool on top of InfoProviders
            

13.3.1    Multidimensional Universe
Instead of getting the whole SAP BEx query content in Web Intelligence SAP direct access, you can create a multidimensional universe on top of an SAP BEx query.
By default, the generated metadata is similar to the metadata displayed when you access the SAP BEx query in Web Intelligence through SAP BEx direct access (Section 13.2), but your universe designer can modify it in order to:


                    Create folders to reorganize objects from the SAP BEx query
                

                    Delete objects or rename them
                

                    Set dimension presentation
                

                    Set aggregation extension
                

                    Set zero suppression
                

                    Set relative depth selection
                

                    Create business layer views


                    Define business security profiles
                

When you create a document from such universe, these changes are transparent to you since only the resulting metadata is displayed in the Query Panel.
13.3.2    Creating a Document from Multidimensional Universes
In Web Intelligence, you can create a document from any multidimensional universe (see Chapter 12, Section 12.5):


                    Create a new document, and in the list of available data sources (see Chapter 2, Figure 2.4), select Universes.
                

                    In the Universe dialog box, choose the universe based on the SAP BEx query.
                

                    If you do not have some variables to answer, the Query Panel opens; otherwise, the Set Variables dialog box opens and you must answer them (Section 13.2.2) before the Query Panel opens.
                    As shown in Figure 13.9, the Query Panel displays multidimensional metadata defined in the universe from the SAP BEx query.
                

                    Click the Member display mode icon  to open a dropdown menu where you can select how to display the BEx query metadata—by their caption, their unique name (technical name), or both.
                    
Figure 13.9    Information Design Tool Query Panel on Universe Authored on an SAP BEx Query


                    In this Query Panel, you can create your query by dragging and dropping objects from the outline to add them in the query, either in the Result Objects or Query Filters section. The metadata is multidimensional and has the same properties as any multidimensional universe (see Chapter 12, Section 12.5). You can:
                    

                            Select hierarchies to drill into hierarchical member data within the SAP BEx query.
                        

                            Select members using the Member Selector pane, allowing you to expand, collapse, and check any of the member values to retrieve exactly the information you need.
                        

                            Enable SAP BEx member prompting and ask users for input when reading reports to prompt to provide a form of guided analysis. Use the Prompt tab of the Member Selector (see Chapter 12,  Section 12.5.5). Users can be prompted to select specific members or levels in a hierarchical structure for selective analysis. This setting saves time and helps users get directly to the information they need and at the right level of detail.
                        



                    Click Run Query to close the Query Panel and run your query.
                

                    The query is sent to the BEx query, which returns the data set.
                

As for any data source, you can continue to create your documents from the retrieved data set, using the Web Intelligence capabilities.
13.3.3    Answering SAP BEx Query Variables
SAP BEx variables are surfaced as Web Intelligence prompts and can be answered in the universe. Setting answers for these variables in the universe allows you to fix the metadata in the universe.
As opposed to SAP BW direct access (Section 13.2.2), the Set Variables dialog box is available when creating the query in the Query Panel. Variables must be answered in the universe, otherwise, they are prompted at query time, in the Prompts dialog box. They are prompted in addition to query filters prompts (see Chapter 9, Section 9.1) or hierarchy member prompts (see Chapter 12, Section 12.3.5) defined in the query.









13.4    SAP BW through Relational Universe
Although it was the only supported method in previous version, accessing SAP BW through relational universe is less common in SAP BusinessObjects BI 4.2. This method:


                Requires you create a universe on top of SAP BW, which is not the case with SAP BW direct access (Section 13.2).
            

                Does not support multidimensional metadata, as opposed to multidimensional universe (Section 13.3).
            

This access is still supported for users who have not done the conversion or who are now used to it.
There are two relational universes supported for SAP BW:


                Relational universe created in the Information Design Tool (UNX)
            

                Relational universe created in the Universe Design Tool (UNV)
            

Both use SAP BW's SQL interface, that does not support multidimensional metadata. Hierarchies defined in SAP BW are flattened in these universes. The hierarchies' levels are exposed through dimensions.
13.4.1    Relational Universe in the Information Design Tool (UNX)
The first universe of SAP BW supported by the Information Design Tool was the relational universe based on the multi-source technology. Such relational universe can be created in the Information Design Tool on top of any InfoProvider.
Although it does not support multidimensional hierarchy, it proposes the following advantage:


                    Create folders to reorganize objects from the SAP BW InfoProvider.
                

                    Delete objects or rename them.
                

                    Create business layer views.
                

                    Define data or business security profiles.
                

As the relational universe for accessing SAP BW must be a multi-source universe, you can take advantage of this capability to query in the same universe data coming from several SAP BW systems or several SAP BW InfoProviders and to couple them with other data sources through this multi-source capability.
13.4.2    Relational Universe in the Universe Design Tool (UNV)
In the Universe Design Tool, universes that query multidimensional data sources such as SAP BW are named OLAP universes, although they do not support the multidimensional feature.
As shown in Figure 13.10, in an OLAP universe, the SAP BW hierarchies are exposed by default through dimensions:


                    Whose names are L<leveldepth>_<Levelname>_, for example: Country_L01, State_L02...


                    Stored under a folder whose name is the hierarchy name
                

Your universe designer can reorganize, rename, or delete these objects, to simplify how they are displayed in Web Intelligence.
Such relational universes can be created in the Universe Design Tool on top of an InfoCube, a MultiCube, or an SAP BEx query enabled on top of any InfoProvider.

Figure 13.10    Universe (UNV) Displaying SAP BW Hierarchies in Query Panel
13.4.3    Creating a Document from a Relational Universe
Creating a document from a relational universe on SAP BW created in the Information Design Tool or the Universe Design Tool is like creating a document from any relational universe (see Chapter 2, Section 2.1).
The universe appears in the list of available universes and you can select it and use the Query Panel to query data from it.









13.5    SAP HANA Direct Access
To ease reporting on SAP HANA, the same direct access available to connect to an SAP BEx query (Section 13.2) is also available for SAP HANA:


                You do no need to create a universe since you directly connect to the SAP HANA analytical or calculation view (attribute views are not supported) to create a query before running it. The metadata layer is directly available in the Query Panel.
            

                You can directly select an SAP HANA view (analytic or calculation view) as a data source, but not an SAP HANA table or dimension view.
            

                You can choose to either access a relational or multidimensional display of the view, depending on the connection type you select.
                

                        In a relational view, the hierarchies are flattened and you cannot take advantage of multidimensional capabilities.
                    

                        In a multidimensional view, the hierarchies are supported in the dimensional Query Panel with member selection and hierarchical report output.
                    



This SAP HANA direct access can connect to only one SAP HANA view per query. To access several SAP HANA views, you can add multiple queries and use merge dimensions to synchronize data sets, as described in Chapter 14.
13.5.1    Creating a Document in SAP HANA Direct Access
To create a document using SAP HANA direct access:


                    In the list of available data sources (see Chapter 2, Figure 2.4), select SAP HANA.
                

                    The Select an SAP HANA View dialog box opens with a list of available connections:
                    

                            Selecting an OLAP connection allows you to browse SAP HANA models as multidimensional cubes (with dimensions, hierarchies, levels, measures, etc.) and to run multidimensional query scripts using the MDX script language.
                        

                            Selecting an SAP HANA relational connection allows you to query SAP HANA views through the Connection Server and HANA SQL access. The system generates a relational transient universe. The transient universe generation strategies are similar to those of relational authored universes on SAP HANA views in the Information Design Tool.
                        



                    Expand a connection and select the view to query, as shown in Figure 13.11. Click OK.
                

                    The Query Panel opens and directly generates the metadata from the SAP HANA view. Depending on the connection you select as a data source, the model generated in the Query Panel is multidimensional (Figure 13.12) or relational (Figure 13.13).
                    
Figure 13.11    SAP HANA Direct Access: View Selection

Figure 13.12    Multidimensional Query Panel in SAP HANA Direct Access

Figure 13.13    Relational Query Panel in SAP HANA Direct Access


                    If you are connecting a multidimensional model, you can click the Member display mode icon  to open a dropdown menu where you can select how to display the metadata—by their caption, their unique name (technical name), or both.
                

                    Select your objects to create your query and run it.
                

To improve performance, before refreshing a report, Web Intelligence checks if the SAP HANA view has been modified since the last refresh. If this is not the case, then it does not regenerate the metadata layer and can reuse the one saved in the document, leading to better performance.
13.5.2    Answering SAP HANA Input Parameters and Variables
SAP HANA supports two types of prompts:


                    An input parameter is used to define an internal parameterization of the view. For example, you may enter a target currency for currency conversion. It is not used to filter data, but rather to define the metadata.
                

                    As for SAP BW, variables are used to define a filter on an attribute of the view.
                

Input parameters and variables are both surfaced as Web Intelligence prompts and can be answered at design time (when you create the query) or at query time (when you refresh the query).
Design Time
The Set Variables dialog box available for SAP BW (Section 13.2.2) is also available for SAP HANA since SAP BusinessObjects BI 4.2 SP 3. It can be used to fix variables' values in the Query Panel and prevent you from having to answer them at each refresh.
After you have selected your SAP HANA view to create your query, if this view contains input parameters or variables, then the Set Variables dialog box opens, as shown in Figure 13.14.

Figure 13.14    SAP HANA Direct Access: Set Variables before Query Panel
In this dialog box, as for SAP BW (Section 13.2.2):


                        Input parameters and variables and are listed in the order defined in SAP HANA Studio.
                    

                        Click the ... button in the Values column to open the List of values dialog box where you can select the values to set.
                    

                        Conversion for any unit measure is supported. When a measure unit has been defined as a prompt in SAP HANA, Web Intelligence also prompts you for this unit measure.
                    

                        Since SAP BusinessObjects BI 4.2 SP 4, multiple operators and multiple interval variables are supported.
                    

Once you have selected your values, if all mandatory variables and input parameters have been answered, you can click OK to open your Query Panel and create the query.
Later, when you are editing your query, you can modify the values you set for these input parameters and variables. In the Query Panel toolbar, click the Set Variables icon  to reopen the Set Variables dialog box.
In the Set Variables dialog box, as shown in Figure 13.15, you can:


                        Fix variables' values to prevent them from being prompted at query time. Unselect the Set as prompt checkbox beside each variable name and, in the Values field, click the ... icon to open the List of Values dialog box. Select the value(s) to set for this variable.
                    

                        Set the variables as a prompt, so they are prompted at query time. In this case, select the Set as prompt checkbox beside each variable name.
                    


Figure 13.15    SAP HANA Direct Access: Set Variables from Query Panel
You can also select the Use BEx/HANA defined default values at runtime checkbox so these default values (that can be dynamic) are retrieved from the SAP HANA system at query time.

Dynamic Default Values
To have this option available, you must also purge the document before refreshing it; otherwise, the default values are not retrieved at query time.

Query Time
When you refresh your document, if you have variables or input parameters you have set as prompts when designing the query, you are then invited to provide answers for them before the query refresh is sent to SAP HANA.
These variables and input parameters are displayed in the Prompts dialog box, as shown in Figure 13.16, among the other query filters prompts and member prompts you may have defined in the query.

Figure 13.16    SAP HANA Direct Access: Prompts at Query Time
You can select the Merge Prompts (BEx/HANA Variables) parameter in the document options (see Chapter 2, Section 2.7) and then decide whether to factorize them based on their captions.









13.6    SAP HANA Online Mode
To simplify access to SAP HANA views, Web Intelligence proposes another access named online mode. As for SAP HANA direct access described in previous section, this mode does not require you to have a universe to query the SAP HANA view; Web Intelligence is directly connected to it. But compared to SAP HANA direct access, this mode offers a simplified experience since it does not require the Query Panel and proposes a quick exploration and discovery of the view data. The document is created as you drag and drop objects from the SAP HANA view directly into the document.
This mode is also more performant since Web Intelligence delegates calculations to SAP HANA. They are no more performed in the Web Intelligence microcube, and Web Intelligence retrieves only data needed for the display. However, not all calculation functions are supported and only variables based on measures can be created. This method takes advantage of the SAP HANA in-memory architecture and enables very fast response times.
In this mode, when a document is saved, it is saved without any data; only its metadata is saved. The data set is retrieved from SAP HANA server when the document is re-opened; which guarantees the most recent piece of information.
SAP HANA Online mode is supported only through a relational model; hence, it does not benefit from the SAP HANA hierarchies that are flattened as dimensions in the exposed model.

Limitations
SAP HANA Online mode does not support:


                    Geo maps (see Chapter 6, Section 6.2.6)
                

                    Variable on dimension (see Chapter 11, Section 11.4)
                

                    Custom groups (see Chapter 11, Section 11.2)
                

                    Cancel query (see Chapter 12, Section 12.6)
                

                    Merged dimensions and merged variables (see Chapter 14, Section 14.5 and Section 14.6)
                

                    Change source (see Chapter 14, Section 14.7)
                

                    Shared elements (see Chapter 19, Section 19.2)
                


13.6.1    Creating a Document in Online Mode
To create a document in SAP HANA Online mode, follow these steps:


                    Create a new document in Web Intelligence and, in the Create a Document dialog box, select SAP HANA Online as the data source.
                

                    In the Select an SAP HANA View dialog box, you're prompted to choose an SAP HANA view from a list of views displayed in your preconfigured connections. Navigate to the Connections folder and its sub-folders to select a connection.
                

                    Expand the connection to select a view among the ones you're allowed to use. Depending on the connection created by your administrator or designer, the connection gives you access to only one specific view or to a set of views.
                

                    The Select an SAP HANA View dialog box closes and the SAP HANA view content is directly displayed in the Available Objects side panel, in the Web Intelligence reporter interface. As opposed to the direct access, there is no Query Panel where you first need to select the objects to query from the view before you display the data set.
                    The SAP HANA Online mode can be identified through:
                    

                            The Data Access • SAP HANA subtab, as shown in Figure 13.17.
                        

                            The SAP HANA: Online label in the status bar, as shown in Figure 13.18.
                        


Figure 13.17    SAP HANA Online Tab

Figure 13.18    Web Intelligence Status Bar in SAP HANA Online Mode


                    The view full content is displayed as a relational model, the hierarchies being flattened.
                

                    Select some objects and drag and drop them in the report to add the corresponding data, as shown in Figure 13.19. Each time a new object is added to the document, a new query is sent to the SAP HANA server that returns the data set that is displayed in the report. You can then interactively explore the data and create your document.
                    When you drag and drop an object from the SAP HANA view into the report and the following is true:
                    

                            Filters have been set on the current document or report
                        

                            And/or you add the object to an existing report element to extend it and if filters have been set on this report element
                        

                    Then these filters are added to the query sent to SAP HANA to retrieve the data set. By proceeding this way, these filters are delegated to the SAP HANA database.
                    
Figure 13.19    SAP HANA View Displayed in SAP HANA Online Mode


                    By default, in the Available Objects side pane, objects are displayed in a flat list, in alphabetical order (Arranged by Alphabetic order). Using the menu at the bottom of the side panel, you can select to display these objects for better visibility:
                    

Arranged by Data Source: To display the objects organized per data source, in case of multi-source data (see Chapter 14, Section 14.2.4).
                        

Arranged by Navigation paths: To gather the objects per level-based hierarchies, as defined in the SAP HANA view (see Figure 13.20). Note that in this mode, objects that are not part of the hierarchies are not displayed.
                        




Figure 13.20    Objects Arranged by Navigation Paths in SAP HANA Online Mode
13.6.2    Answering SAP HANA Variables and Input Parameters
When you create a new document in SAP HANA Online mode, if the SAP HANA view has variables or input parameters, then the Set Variables dialog box opens, where you are prompted to answer them before the objects of the SAP HANA view are displayed in the Available Objects pane.
This dialog box is similar to the Set Variables dialog box described for SAP HANA direct access (in fact, it is available for SAP HANA Online mode since SAP BusinessObjects BI 4.2, whereas SAP HANA direct access supports it since SAP BusinessObjects BI 4.2 SP 3 only):


                    It displays the list of optional and mandatory variables and input parameters.
                

                    You can select to merge them or not using the SAP Merge Prompts (BEx/HANA Variables) document parameter (see Chapter 2, Section 2.7).
                

                    It supports SAP HANA currency/unit conversion.
                

                    Since SAP BusinessObjects BI 4.2 SP 4, multiple operators and multiple interval variables are supported (Section 13.2.2).
                

Once the variables are set, objects from the view are displayed in the Available objects side panel. You can create your report by dragging and dropping objects from the Available Objects pane, as described in Section 13.6.1. Even if a query is sent to SAP HANA each time you add an object, you do not need to answer these prompts, whose values are kept, until you explicitly:


                    Click Refresh to change these values. In this case, the prompts are presented to you in the classical Prompts dialog box.
                

                    Reset them through the Reset Prompts button in the Data Access • Data Providers toolbar. This purges the prompt values from the document. Until you refresh your document, the document tables display the #TOREFRESH content.
                

                    In the document's properties (see Chapter 2, Section 2.7), you can set the Update prompts on open option to force this Prompts dialog box to be displayed and the user to answer prompts before displaying the SAP HANA view.
                


Default Values
To set default values, you also need to purge the documents before refreshing them.

13.6.3    Partial Result
The online mode allows you to interactively discover the SAP HANA view data set by selecting the objects to display. A query is created every time you modify the objects to query, as described in Section 13.6.1. These queries support settings are defined in the SAP HANA connection to limit the maximum number of retrieved rows or the execution duration.
To avoid running too long queries during this exploration mode, you can reduce even more these limits by clicking the Data Access • SAP HANA • Options button, which opens the Options dialog box.
As shown in Figure 13.21, you can set limits for the document queries online mode. These options can be used to reduce the limits defined at the connection, but you cannot extend them.

Figure 13.21    Options in SAP HANA Online Mode
When a data set is retrieved from the SAP HANA system, if a query reaches one of these limits defined either through the connection or through this dialog box, then a Partial Result icon  is displayed on the table or chart, as shown in Figure 13.22, to identify report elements containing a partial data set.

Figure 13.22    A Table and a Chart with Partial Result in SAP HANA Online Mode

Cancel Query
In SAP HANA Online mode, it is not possible to cancel a query. Web Intelligence must wait until SAP HANA returns the expected data set.

13.6.4    Switching to SAP HANA Direct Access
If your document has been created in SAP HANA Online mode, you can add a new data source but it must also be an SAP HANA view accessed in SAP HANA Online mode: it is not possible to mix SAP HANA Online mode with other data sources.
However, it is possible to switch to the SAP HANA direct access mode by clicking the Disconnect from SAP HANA button in the Data Access • SAP HANA toolbar. The objects selected in the document are then used to create a query in the Query Panel.
This typically corresponds to a use case where you first explore SAP HANA view to get its data, before turning it in a more classic mode to take advantage of advanced reporting options in SAP HANA direct access.

Unsupported Switch to SAP HANA Online
It is not possible to switch a document from SAP HANA direct access to SAP HANA Online mode. For this reason a confirmation box is displayed before switching from SAP HANA Online mode to SAP HANA direct access (Figure 13.23).

Figure 13.23    Disconnect from SAP HANA Online Mode Confirmation










13.7    SAP HANA View through Relational Universe
Before SAP HANA direct access and online mode were introduced, relational universes created with the Information Design Tool (UNX) were the only way to query SAP HANA in Web Intelligence.
13.7.1    Relational Universe
The advantages of using a relational universe are:


                    You can query several SAP HANA views and SAP HANA tables in the universe, as opposed to SAP HANA direct access or online, where you need to create a query per view.
                

                    You can query attribute, analytic, and calculation views.
                

                    You can merge SAP HANA with other agnostic sources using multi-source universes.
                

                    You can benefit from other universes' features such as linked universes or security overload defined at the universe level.
                

                    You can set variables in the universe definition (Section 13.7.2).
                

However, the relational model does not support hierarchies that are flattened in the model. Some designers prefer to use SAP HANA direct access or online since this prevents them from having to create and maintain a universe on an SAP HANA view, which can be seen as redundant.
So it is recommended that you use universe either to help migrate existing BI projects or when you need functionality that's not yet available in HANA (e.g. dynamic joins, hierarchical prompts, etc.).
13.7.2    Answering SAP HANA Variables
When you access an SAP HANA view through a relational universe created with the Information Design Tool, variables are only exposed to you through the Prompts dialog box.
Until SAP BusinessObjects BI 4.2 SP 3, these variables were set in the Query Panel and the Set Variables dialog box, as for SAP HANA direct access (Section 13.5.2).
Since SAP BusinessObjects BI 4.2 SP 4, your universe designer can simplify the SAP HANA variables by setting them in the relational universe. The ones not set in the universe are then displayed at query time in the Prompts dialog box. Since SAP BusinessObjects BI 4.2 SP 4, multiple range and multiple operator variables are also supported.

Figure 13.24    Variables and Input Parameters Set in Universe

Setting SAP HANA Variables and Input Parameters in the Information Design Tool
As seen in Figure 13.24, in the Information Design Tool, when defining a data foundation based on an SAP HANA view, universe designers can define these variables' behavior by clicking on a table representing the SAP HANA view and selecting the Variables tab:


                        Designers can select the variables that are prompted in the Prompts dialog box versus the ones whose values are set and hence don't have to be prompted. For the variables to prompt, they can modify the question displayed and set their default values.
                    

                        Designers can set values for the variables so they are not prompted.
                    











13.8    SAP HANA through Free-Hand SQL
For advanced reporting, you can also query SAP HANA using free-hand SQL. This allows you to access some SAP HANA features not yet supported by the universe, direct access, or online modes previously described.
In this mode, the SAP HANA system is seen as a relational database, whereby both the SAP HANA views and SAP HANA tables are exposed as tables that you can query through SQL.
To do so, your administrator must give you access to a relational connection that connects to the SAP HANA server.
To create a document or to add a new query on SAP HANA using free-hand SQL, select Free-hand SQL when you need to select the query data source. Then type the SQL in the SQL editor that opens. You must know the database format to accurately type this SQL (see Chapter 2,  Section 2.7.2).









13.9    Summary
Web Intelligence has introduced new workflows specifically designed to query SAP BW and SAP HANA data sources:


                Direct access to directly use the Query Panel on top of an SAP BEx query or an SAP HANA view, without the need to create a universe.
            

                For SAP HANA, the online mode takes advantage of the SAP HANA in-memory architecture and provides a simplified user experience and data source exploration with very fast response times.
            

These new workflows come in addition to more classical access Web Intelligence supports for other data sources: universes for both or free-hand SQL for SAP HANA. In both cases, the metaphors remain the same and allow you to work in a familiar interface, using the same graphical components.
Once the data set has been retrieved from the SAP system, you can benefit from all the Web Intelligence design capabilities to create powerful documents. Typically, one of the key strength of Web Intelligence is its ability to mix data from different data sources, as described in the next chapter.








14    Using Multiple Queries and Data SourcesSAP integrates data from multiple sources into a single Web Intelligence document to produce powerful and analytical reports. You can join unrelated results by merging compatible dimension objects from disparate sources.Web Intelligence lets you combine data retrieved from separate queries into a single reporting document. Several different queries can be added to a single document by querying the same universe, querying different universes, or querying other data sources such as text files, Microsoft Excel files, SAP BEx queries, SAP HANA views, and more.This chapter takes you into the processes of working with multiple queries from the same source, and from multiple data sources. In case of multiple data sources, it explains how to combine your datasets by synchronizing data by merging dimensions and variables. It covers parallel queries that are intended to speed up your queries. Finally, it details the process of changing a Web Intelligence data source to another data source.
14.1    Setting Up a Combined Query
The first method to gather several data sets is to use combined queries. The idea behind combined queries is to return a single set of data, which would otherwise be impossible to retrieve, with a single query.
Combined queries can only be created on top of relational universes (they are not supported on top of multidimensional universes). Combined queries are created in the Query Panel and merged at the database level to compare the rows in one query to the rows retrieved by an additional query.
These are the two primary rules for creating a combined query:


                Result objects in each query must contain the same number of objects, or the query won't refresh.
            

                The order of the objects in both queries must have matching data types. If the data types don't match, then the query won't refresh.
            


Example
You can create and combine two queries:


Employee, City, Salary


Manager, City, Salary and Bonus


Where Employee, Manager, and City are text and Salary and Bonus and Salary are numerical.

The returned values can be displayed in one of three different relationship types:


UnionIncludes the rows from both queries.
            

IntersectionIncludes the rows common to both queries.
            

MinusIncludes the rows from the first query minus the rows from the second query.
            

14.1.1    Union
Unions are most commonly used when you are attempting to build a result set with incompatible objects that can't be included in the same block in a report, due to database or universe configurations.
In many cases, all of the result objects will be exactly the same in both queries (except for minor differences in result objects or query filters). The results from both queries are pushed to the database to complete the merging, and a single set of results is returned.
The first query in a union is created like any other query. To add a union query, you need to click on the Add a combined Query shortcut icon located in the Query Panel in Design mode (see Figure 14.1).

Figure 14.1    Adding a Combined Query to Create a Query Union
After a combined query has been added, a new pane opens, located in the lower half of the Universe outline, as shown in Figure 14.2. This pane displays the two queries. Query 1 changes names to become Combined Query 1, and a Combined Query 2 is inserted.

Figure 14.2    Combined Query Added to the Universe Outline
You can toggle back and forth from these two queries by clicking on the buttons that include the new query names, and you can modify the queries' definitions in the Result Objects and Query Filters panes.
The default combined query type is union. To change from union to intersection or minus, double-click on Union in the Query Manager pane located to the left of the combined query names (with the Universe outline after a combined query is inserted).
14.1.2    Intersection
You can add intersections when you want to produce a combined query that returns only the values that appear in both queries. The purpose of this type of query is to cut away any nonintersecting data.
14.1.3    Minus
You can use the minus combined query to remove everything in the results of the first query from the results of the second query. The purpose of this type of combined query is to find the results in the first query that aren't in the results of the second.
14.1.4    Remove a Combined Query
To remove a combined query, drag the unneeded Combined Query button to the Universe outline section that includes the classes and objects.
Combined queries is a first method to merge a data set coming from the same relational universe. In addition of this single data source constraint, it also constrains the number of objects, their type, and their order in the queries. Most of the time, you will simply add a new query to the document.









14.2    Adding a New Query
Every Web Intelligence document can contain data sourced from multiple queries with varying source types. The following section explains how new queries are added and how the results can be used within the reporting document.
14.2.1    Adding Queries and New Data Providers
New queries can be added to documents that are made up of result objects that have absolutely nothing in common with the result objects in the existing query. This is common if reporting requirements present elements from both unrelated data sets on the same report or within the same document.
There are several ways to add new queries and new data providers in an existing document:


From the Query PanelIn Design mode, open the Query Panel, then click the Add Query button in the top-left corner. As shown in Figure 14.3, a dropdown menu opens where you can select a new data provider.
                    Depending on the data provider you selected, the corresponding wizard described in Chapter 2 and Chapter 13 allow you to create a new query and add it to the document.
                


Figure 14.3    Adding a New Query from the Query Panel
Another method to add a query in the Query Panel is to duplicate an existing one. As described in Section 14.3, in the Query Panel, right-click the Query tab and select the Duplicate command. This adds an identical query to the document, based on the same data source.


From the Report PanelIn Design mode, click the Data Access tab and then select the New Data Provider button from the Data Providers subtab. As shown in Figure 14.4, a dropdown menu opens where you can select a new data provider.
                    Depending on the data provider you selected, the corresponding wizard described in Chapter 2 or Chapter 13 allow you to create a new query and add it to the document.
                


Figure 14.4    Adding a New Data Provider from the Report Panel


In Data ModeThis option is available only in Web Intelligence Applet and Rich Client only. In Data mode, in the Data side panel:
                    

                            Right-click the document name and in the contextual menu, select the New data provider command, as shown in Figure 14.5. This opens the Create a document dialog box described in Chapter 2, Section 2.1, that allows you to select a new data source and create a new query from it.
                        

                            Right-click a data provider name and in the contextual menu, select the New data provider command. This opens the Query Panel on this data provider so you can create a new query from this data source and add it to the document.
                        




Figure 14.5    Adding a New Data Provider from Data Mode
When you are not in SAP HANA Online mode (see Chapter 13, Section 13.5), the menu displays the different sources supported by Web Intelligence:


                    For Web Intelligence HTML: Universes, Excel, SAP BEx, SAP HANA Direct Access, and Freehand SQL
                

                    For Web Intelligence Applet: the same data sources as for HTML, plus Analysis view
                

                    For Web Intelligence Rich Client: The same data sources as for the Applet, plus Web Services and Text
                

The SAP HANA Online mode option is not displayed since this mode is not compatible with other data sources that use data in the microcube. You cannot:


                    Add a new SAP HANA Online mode data source if your document already queries another data source.
                

                    Add another data source in a document in SAP HANA Online mode.
                

This first example involves combining two data providers, both from the same eFashion universe.
For the first data provider, you'll see how to create a query using the City, Margin, and Sales revenue objects, as shown in Figure 14.6.

Figure 14.6    Single Query from the eFashion Universe
For the second data provider, you'll use the same universe and in the Query Panel, you create a query with the City and Quantity sold objects.
Notice that the Run Query button now reads Run Queries, indicating that multiple queries exist in the Web Intelligence document, as shown in Figure 14.7. To run all queries, click the Run Queries button.

Figure 14.7    Running Both Queries
Click the down arrow to the right of the Run Queries button to select and run a single query rather than having to run all the queries within the document. More details on refreshing queries can be detailed in Section 14.4.
14.2.2    Including New Result Data
After a new query has been added to a Web Intelligence document from the Query Panel and the query is refreshed for the first time, you're prompted to choose how the results from the new query are to be displayed. Figure 14.8 shows the three available choices:


Insert a table in a new reportCreates a new report and adds the results from the new query in a standard vertical table (defaultselection).
                

Insert a table in the current reportAdds a new table containing the results from the new query on the currently active report tab, alongside any existing tables and charts on the report.
                

Include the result objects in the document without generating a tableIncludes the results from the new query in the document microcube but doesn't add it to a report. It can be used later in the document.
                


Figure 14.8    Choosing How Data from the New Query Is Displayed
If you have added the new query from the Report Panel or from the Data mode, then the results from the new query are added on the currently active report tab in a new table, alongside any existing tables and charts on the report.
14.2.3    Options to Display Available Objects
Objects coming from the data sources can be seen in Available Objects side pane. Available objects are displayed in alphabetical order by default, as shown in Figure 14.9.

Figure 14.9    Available Objects Arranged by Alphabetical Order
When working with multiple data providers, it's often helpful to display available objects by query. The Available Objects side pane offers you two additional options to display objects. In the Arranged by dropdown menu located at the bottom of the Available Objects side pane, you can select:


Arranged by Query, to display the objects by queries. as shown in Figure 14.10.
                


Figure 14.10    Available Objects Arranged by Query


Arranged by Data Source, to display the objects by data sources and inside the same data source, by folders from the data sources, as shown in Figure 14.11.
                

This is an extremely simple example, but in actual practice, you may encounter documents with 5 to 10 queries and more than 100 objects. In these scenarios, it's very helpful to arrange the objects by query. Depending on the document data source, you may use one of these options to easily locate the object instances needed.

Figure 14.11    Available Objects Arranged by Data Source
14.2.4    Adding New Data Source in SAP HANA Online Mode
If your document connects to SAP HANA in online mode, then the only other data source you can add is SAP HANA and it can be only in online mode as well.
It is not possible to create merged dimensions or merged variables (Section 14.5) in SAP HANA Online mode.
To add a new SAP HANA data source to a document that already queries an SAP HANA view in SAP HANA Online mode, follow these steps:


                    In Design mode, click the New Data Source button in the Data Access • Data Providers subtab.
                

                    The dropdown menu that opens contains only the From SAP HANA Online choice, as shown in Figure 14.12. Select it.
                    
Figure 14.12    Add a New SAP HANA Online Data Source


                    The Select an SAP HANA View wizard opens. As for document creation (see Chapter 13, Section 13.6), select a relational connection and an SAP HANA view to use as a data source.
                

                    Click OK. As shown in Figure 14.13, in the Available Objects side panel, the new SAP HANA view you selected is displayed after the ones that were already used by the document.
                


Figure 14.13    Available Objects from Two SAP HANA Online Data Sources
You can repeat these steps to add other SAP HANA views to your document.
When you disconnect from SAP HANA Online mode and switch to SAP HANA direct access (see Chapter 13, Section 13.6.4), a query is created for each SAP HANA view whose objects have been used in the documents.









14.3    Managing Queries
After having added multiple queries to your document, you may need to reorganize them. Such commands are possible in the Query Panel. Figure 14.14 shows the bottom of a Query Panel for a document where seven queries have been created.

Figure 14.14    Query Tab Contextual Menu
Each query is displayed as a tab and you can click these tabs to switch from one query to another one. Right-clicking one of these tabs opens a contextual menu with the following commands:


Rename: Opens a window where you can rename the selected query.
            

Move: Opens a submenu with the Left or Right commands, which allow you to move the selected tab to the left or to the right.
            

Duplicate: Creates a copy of the selected query.
            

Delete: Deletes the selected query.
            










14.4    Running Multiple Queries
Refreshing a document containing several queries has some differences with running a document based on only one query.
14.4.1    Refreshing Documents Containing Multiple Queries
Documents that contain multiple queries can either be refreshed all at once or individually.
To refresh all queries at once in the document, click the Run Queries button. Doing so replaces the Run Query everywhere in the interface, in Reading, Design, or Data mode.
When all queries are to be run, Web Intelligence computes the execution plan that defines in what order the queries must be run, based on the queries' dependencies (query on query). Whenever possible, the document queries are then run in parallel (Section 14.4.3).
You can also explicitly run one specific query:


                    From the Report Panel, in Design mode, click the Data Access tab, and then locate the Refresh icon within the Data Providers subtab. Now, when you click the small down arrow immediately to the right of the Refresh icon, you can select a query from the list and only that query will be refreshed, as shown in Figure 14.15.
                

                    The same option is also available while working in the Query Panel. When creating or editing queries in the Query Panel, click the down arrow located immediately to the right of the Run Queries button. This selection will show all of the queries within the document, and you can select a single query to be refreshed, as shown in Figure 14.15.
                


Figure 14.15    Selecting a Query to Refresh from the Report Panel
14.4.2    Prompts
When refreshing a document that contains several queries, if these queries require you to answer prompts, then all prompts are displayed in the same Prompts dialog box so you can answer them before the queries are sent to the data sources.
In the Prompts dialog box, the prompts coming from SAP HANA and SAP BW data sources are displayed first, before the ones coming from universes.
If the Merge prompts (BEx or HANA Variables) option has been unselected, then these SAP BW and SAP HANA prompts are not factorized, and you must answer them several times, one for each occurrence of this prompt in the queries.
14.4.3    Multiple Queries Parallel Refresh
Since SAP BusinessObjects BI 4.2, if your document contains several data sources, then they are run in parallel, instead of sequentially, as was the case before. This capability is intended to improve document refresh performance.
The parallel data provider refresh is supported for the following data providers:


                    Universes created by the Information Design Tool (UNX) and Universe Design Tool (UNV) on both relational or OLAP connections
                

                    Freehand SQL based on secured relational connections
                

                    Text files (TXT/CSV)
                

                    SAP HANA Direct Access based on SAP HANA views
                

                    SAP BW BEx queries
                


SAP BW Parallel Queries
Parallel queries for SAP BW are only supported since SAP BusinessObjects BI 4.2 SP 3.

Your administrators can control the use of parallel data provider refresh to prevent users from decreasing the database performance by running too many parallel queries.
For Web Intelligence, the administrator can set the maximal number of concurrent data refresh jobs per document. By default, the maximum number of refresh jobs that can run in parallel is set to 64, but it can be decreased if the underlying hardware cannot support the workload. Additionaly, your administrator can set a maximum parallel queries limit per relational or OLAP connection. These settings can be defined in the CMC, the Information Design Tool, and the Universe Design Tool.









14.5    Merging Dimensions
This section explains how to combine data from two or more queries. Figure 14.16 shows a Web Intelligence document with data from two queries. Because data from two different sources isn't automatically synchronized, data from both queries can't accurately be used in the same table.
Notice that each row in the table shows 223,229 for the quantity sold, the total for all stores. Because the data providers aren't synchronized, Web Intelligence doesn't understand how to take the sales revenue from Austin and combine it with the quantity sold for Austin. Therefore, it combines a single store's revenue with the employee count for all stores, which is incorrect.

Figure 14.16    Objects in a Table from Two Unsynchronized Queries
This limitation can be addressed through merged dimensions.
14.5.1    Creating a Merged Dimension
Data synchronization allows you to combine measures from multiple queries into a single table without worrying about data accuracy. For example, the total sales revenue for Austin is perfectly synchronized with the quantity sold for Austin, even though it came from a separate query.
Two requirements govern merging dimensions:


                    The result objects to be merged must have the same data type.
                

                    The result objects to be merged must contain compatible and related data.
                

The dimension names have no bearing.

Note
When working with multiple queries, it's worth the extra effort to rename them with useful and descriptive names.

In the initial example, the City dimension object from both queries meets the two requirements to be merged into a single dimension:


                    The result objects to be merged have the same data type (character).
                

                    The result objects to be merged contain compatible and related data (Austin, Boston, etc.).
                

There are two different methods for creating merged dimensions.
Merging Dimensions through the Dialog Box
The first approach to manually synchronize data providers and merge their dimensions is to select the Data Access tab and then click on the Merge button on the Data Objects subtab, as shown in Figure 14.17.

Figure 14.17    Merge Data Providers Button on Toolbar
Then, complete the following steps:


                        From the list of Available objects, shown in Figure 14.18, choose the desired dimension, City, from Query 1.
                    

                        While holding down the (Ctrl) key, choose the City dimension from Query 2.
                    

                        Click OK.
                    


Figure 14.18    Selecting Objects to Merge
In the Available Objects side panel, the merged dimension is displayed under the Merged Dimensions folder (see Figure 14.19), with a special icon  showing two overlapping dimension objects.

Figure 14.19    Merged Dimension Displayed in Available Objects

Tip
As described in Section 14.2.3, change the Arranged by option located at the bottom of the Available Objects pane from Alphabetic order to Query. This object listing type makes it easier to locate the object instances needed.

The appropriate dimensions in both queries have been merged, and the data is properly synchronized. Now the Quantity sold values from Query 2 display the correct results when placed in the same table as the objects from Query 1, as shown in Figure 14.20.

Note
Be sure to add the new merged instance of the City object to the data table rather than assigning it directly from one of the queries.

In this simple example, only a single pair of dimensions needed to be merged. In practice, additional dimensions shared among multiple data providers must be merged by repeating this technique.

Figure 14.20    Synchronized Data Providers
Merging Dimensions through the Contextual Menu
Another way to merge dimensions is to select compatible objects from the Available Objects side pane.


                        Use the (Ctrl) key to select several objects.
                    

                        Right-click and, in the contextual menu, select the Merge command, as shown in Figure 14.21.
                        
Figure 14.21    Merging Dimensions from the Available Objects Pane


                        The same merged dimension as with the first method is created and added under the Merged Dimensions in the Available objects side pane.
                    

This method is extremely helpful because if new queries are added to a document with existing merged dimensions, it's easy to add compatible objects to a merged dimension without having to completely re-create it.
Follow these steps if new queries are added to a document that contains objects that should be merged to an existing merged dimension:


                        Select the merged instance of the object.
                    

                        Holding down the (Ctrl) key, select the compatible object from the new query.
                    

                        Right-click and, in the contextual menu, select the Merge command, as shown in Figure 14.21.
                    

Adding an Object to an Existing Merge
When a new query is added to a document that already has merged objects, you can add an object from the new query to an existing merged dimension object. Figure 14.22 shows a sample of the available objects from a document with three queries that contain a merged dimension for the City object created from only two of the queries.
To add the City object from Query 3 to the Merged Dimensions instance of City, select City in Query 3 and City from the Merged Dimensions class, and then right-click.


                        Select the merged instance of the City object from the Merged Dimensions folder.
                    

                        Holding down the (Ctrl) key, select the City object from Query 3.
                    

                        Right-click and, in the contextual menu, select the Add to Merge command, as shown in Figure 14.22.
                    


Figure 14.22    Adding an Object to an Existing Merged Dimension
The Merged Dimensions instance of the City object will show that it was created from all three instances of the object, as shown in Figure 14.23.

Figure 14.23    Merged Dimension Object Added
14.5.2    Merging Geo-Localized Dimensions
If you merge dimensions that have been geo-localized (see Chapter 8, Section 8.11), then the merged dimension also benefits of this geo-localization, as well as the other dimensions that are part of the merged dimension.
In the example in Figure 14.23, if before the merge, City from Query 1 has been geo-localized, then after the merge, as shown in Figure 14.24:


                    A new icon  is used to represent merged, geographical dimension.
                

                    Both this merged dimension and the other City objects benefit of the geo-localization.
                

If you reset the geographical mapping for a dimension or the merged dimension, then all geographical mappings for all dimensions that are part of the merged object are reset.

Figure 14.24    Merged, Geographical Dimensions
14.5.3    Additional Options for Merged Dimensions
Automatic Merge
When you add a new query based on a relational or multidimensional universe to a document, Web Intelligence can automatically merge the dimensions of objects with matching names and data types if:


                        The Auto-merge dimensions option has been enabled before adding the new query.
                    

                        The objects to merge are retrieved by queries based on the same universe.
                    

By default, the Auto-merge dimensions setting is disabled. To access it, click the Properties tab in the upper-left corner of the control panel and select the Document button (see Chapter 2, Section 2.6).
Extend Merged Dimension Values
By default, merging dimension acts as an inner join: only values that come from the different merged objects are kept. You can use the Extend Merged Dimension Values setting in the document properties (see Chapter 2, Section 2.6) to perform a full outer join of merged dimension objects. This setting allows all of the values from both data sources to be merged into the newly created merged dimension object.

ForceMerge
Consider two queries:


City and Quantity Sold


City and Inhabitants


A merged dimension City is created since it is the common object in the two queries.
Figure 14.25 1 shows the table created by default with City from the first query and Inhabitants. Figure 14.25 2 shows the same table but with the Extend Merged Dimension Values setting selected. With this option, cities that are not returned by the first query are listed in the table since they are returned in the second queries.

Figure 14.25    Impact of the Extend Merged Dimension Values Setting

ForceMerge
You can use the forceMerge() formula to provide synchronization to data providers with different aggregation levels. The forceMerge() formula works to display accurate results when the dimensions merged have objects above them in the hierarchy.

ForceMerge
Let's create two queries:


State, City, Quantity Sold


City and Sales revenue


A merged dimension City is created since it is the common object in the two queries.
If you add a table with State and Sales revenue, Sales revenue sums all values and returns the same value for all states since State is not synchronized in the two queries, as shown in Figure 14.26.
To return the correct value for each state, you can use the formula =ForceMerge([Sales revenue]). As shown in Figure 14.26, the Revenue variable returns the expected sales revenue for each state.

Figure 14.26    Using ForceMerge through a Variable


Note
Filtering in reports can't be applied to merged dimension objects. The premerged dimension objects must be used when adding report filters. When a filter is added to a report that was used to create a merged dimension, the filter is applied to all synchronized data providers.

14.5.4    Modifying Merged Dimensions
You may need to modify a merged dimension, remove an object from it, or just delete it. These can be easily achieved in the user interface.
Editing Merged Dimension Properties
Another option is to edit a merged dimension's properties (see Figure 14.27). This is a useful property if you need to rename a merged dimension object's name.

Figure 14.27    Merged Dimension Properties
By selecting the dropdown under Source Dimension, you'll see a list of the objects that have been merged along with the query name of each object instance.
From this window, you can edit the Merged Dimension Name and provide a Description for the merged object.
Unmerging Objects
After objects have been merged, they aren't permanently merged. You can unmerge them by right-clicking on the merged instance and selecting Unmerge (see Figure 14.28).

Figure 14.28    Unmerging a Merged Dimension
Removing an Object from a Merged Dimension Instance
To remove an object from a merged dimension that contains more than two objects, right-click on the object and select Remove from Merge (see Figure 14.29).

Figure 14.29    Removing an Object from a Merged Dimension









14.6    Merging Variables
One difficulty when merging dimension is to make sure that the data in the two data sets for the dimensions to merge are exactly identical, otherwise, the merge cannot happen. For example, "phone" cannot be merged with "Phone," whereas it is very likely that they cover the same data. More generally, some cleaning (upper/lower case, trimming extra space) is needed to make sure the data can be merged. This cleaning can be done using the formula language through a variable, as described in Chapter 11.
The defined variable can then be merged to another dimension or another variable.
Merging variables is an important enhancement to Web Intelligence because it allows for dimensions to be merged from different data sources. Even though merging dimensions has been around for quite some time, merging variables is a new capability and much different.
This new feature allows you to merge variables, not just dimensions retrieved by your queries. Being able to merge variables gives the flexibility to cleanse the data retrieved from your data sources by utilizing the vast array of report-side functions. It's common for data from various sources to be slightly different but have the same business meaning. In these situations, the standard merging of dimensions becomes unusable and of little to no value. That's where the benefit of merging variables comes in.
You can write formulas in variables to synchronize data in these scenarios and then merge the variables. For developers who frequently create reports from multiple sources, merging variables will likely become their favorite new feature introduced in SAP BusinessObjects BI 4.2 SP 3, especially when minor modifications are needed before the dimensions, or now—the variables—can be merged.
14.6.1    How to Merge Variables
Variables can be merged in the exact same way as standard dimensions. A variable can be merged to a dimension from another data source or from a variable created from objects from another source. The outcome of the following steps is pictured in Figure 14.30.
Follow these steps to merge a variable:


                    Select a variable from the list of available objects.
                

                    Hold down (Ctrl) and select the dimension to join it to.
                

                    Right-click on top of either object and then select Merge.
                


Figure 14.30    Merging Variables
The Merge function is also available in the toolbar from the Analysis tab. Clicking the merge dimension pictured in Figure 14.31 will launch a new window of available objects to allow either dimensions or variables to be merged.
14.6.2    Merging Geo-Localized Variable
If a variable has been geo-localized (see Chapter 8, Section 8.11), when it is merged with another dimension or variable, the geo-localization is shared among all the variables and dimensions.









14.7    Changing Source
Whether your document queries one or several data sources, you may need to change the data source it relies on. For example, after a universe conversion, you want your document created on the original universe to now query the converted universe. Or after having deployed a document into a BI platform repository, you want this document to query a data source stored in this BI platform repository.
There are two main workflows for changing the data source:


                One to change sources between universes, SAP BEx, and SAP HANA data sources. As described in Table 14.1, most combinations between these data sources are supported, except for some restrictions when the target data source is a universe created with the Universe Design Tool (UNV).
            






                        Target Data Source
                    



                        UNV
                    

                        UNX
                    

                        UNX on SAP BW
                    

                        SAP BW Direct Access
                    

                        SAP HANA Direct Access
                    





UNV


                        Supported
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    



UNX


                        No
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    



UNX on SAP BW


                        No
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    



SAP BW Direct Access


                        No
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    



SAP HANA Direct Access


                        No
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    

                        Supported
                    



Table 14.1    Supported Change Source Workflow


                One for text, Excel, and free-hand SQL, described in Section 14.7.4.
            

The first workflow is technically more complex. It is based on several strategies used by Web Intelligence. To better control this process, you must know these strategies, which are described first.
14.7.1    Change Source Strategies
When changing the data source, the difficulty is to map objects used in the document queries to this data source to the objects in the target data source, since many combinations are possible. When you do the change source, Web Intelligence proposes a default mapping. This suggested mapping is based on strategies that are run one after the other for each object to map, until a match can be found for this object. The tested strategies are, in test order:


Same object IDTo find a valid object that has the same internal ID.
                

Same object technical nameTo find a valid object that has the same technical name, if it exists.
                

Same object pathTo find a valid object that has the same path, the path including both the object name and the list of parent folders.
                

Closest object nameTo find a valid object that has the closest name.
                

Remove the objectTo remove the object from the query.
                

Web Intelligence allows you to change the strategies to apply and the order in which to apply them. You can choose the best strategies to apply based on your data source knowledge. For example, the "same object ID" strategy is appropriate if the source and target documents are two versions of the same universe where objects have the same ID in the universe. On the contrary, if the source and target data source have been created independently, the "same object technical name" or "closest object name" strategies might return better results.
14.7.2    Change Source Workflow
The Change Source wizard can be opened several ways:


                    In Design or Data modes, select Data Access • Tools • Change Source and then choose the query for which you want to change the data source.
                

                    In Data mode, right-click a data source in the left panel, then select Change Source in the contextual menu. If several queries have been created from this data source, then the Change Source will apply to all these queries.
                

                    In Data mode, right-click a query in the left panel, then select Change Source in the contextual menu.
                

Once the Change Source wizard is opened (as seen in Figure 14.31), follow these steps:


                    Select the target data source. You can select any data source already used by the document by selecting the Choose an existing data source from the document radio button and a data source in the list of the ones already used by the document. It is possible to select the original data source, for example, to replace objects used in a query with objects from the same data source.
                    
Figure 14.31    Change Source Wizard


                    You can also specify a target data source by selecting the Specify a new data source radio button and in the Select a data source scroll-down menu, select either Universe or BEx or SAP HANA. Depending on your choice, this opens the universe, SAP BEx, or SAP HANA selection dialog box where you can select your target data source.
                

                    Once this data source has been selected, the dialog box closes and the selected data source name is displayed below the Select a data source scroll-down menu.
                

                    If other queries are created on this data source, you may select the Apply changes in all queries sharing the same data source checkbox to apply the change source to all these queries created from this data source.
                

                    Click Next.
                

                    The Strategy Selection screen opens, as shown in Figure 14.32. The Selected strategy order lists the strategies applied to map the objects of the queries to the objects in the target data source. The first strategy to apply is on top of the list. Then, the other strategies to apply until an object to map is found are listed.
                    

                            You can select a strategy from the Available strategies and click the > button to add it in the list of strategies to run.
                        

                            You can select a strategy and use the Up and Down buttons to move its position in the order of strategies to apply.
                        


Figure 14.32    Strategy Selection


                    After analyzing the original and target data sources, the wizard proposes in the Object Mapping screen a suggested mapping based on the selected strategies. As shown in Figure 14.33, in the displayed table:
                    

                            The first column, Current, displays the objects used in the selected query.
                        

                            The second column, New, displays the objects of the target data source to map to the objects of the original data source.
                        


Figure 14.33    Suggested Mapping
                    The icons displayed in front of each objects are:
                    

: The object has been mapped
                        

: The object has been mapped with another object whose path is different
                        

: The object is removed from the query
                        



                    To modify the object proposed by the wizard and explicitly select another one in the target data source, click the button  in the object line, in the last column.
                    In the Object Mapping dialog box that opens (see Figure 14.34), you can select another target object in the object tree displayed below. The objects in the tree are the ones from the target data source.
                    
Figure 14.34    Individual Object Mapping
                    To help you find a target object, you can:
                    

                            Select a strategy (Section 14.7.1) in the Search by applying a strategy dropdown menu. This will find a target object using this selected strategy. Select the Removal option to remove the object from the query.
                        

                            Type a search text in the text field to filter the object tree and display only the objects that fit the typed text.
                        

                            Click the Only display object name <ObjectName> checkbox to display only objects that have the same name as the source object.
                        

                            Click the Only display valid target objects checkbox to display only objects that are compatible with the source object.
                        

                    Click OK to validate the target object and update it in the Change Source Wizard screen.
                

                    Once you have finalized the mapping, click Finish to proceed with the change source.
                

                    When the change source is done, the Change Source wizard closes and the Query Panel opens. You can either:
                    

                            Select Apply and close to just close it and return to the document edition.
                        

                            Select Refresh to run the query against the new data source.
                        



                    Save your document to keep your changes.
                


Revalidate Your Document
Even if the change source has mapped the object's query to objects in the target data source, the metadata and the list of values might differ in the original and target data sources. So, after the change source, it is wise to check that the document and its recurrent schedules still refresh properly and return the correct data, especially if the document contains prompts.

This workflow can change source for only one document at a time. In some cases, you may want to have a way to manage several documents at once. SAP BusinessObjects BI 4.2 SP 4 proposes a sample utility tool that can help after a universe conversion.
14.7.3    Bulk Change Source
If you have several documents that query a universe UNV that you have converted into UNX, you may want to change the source all these documents so they query the converted UNX. Instead of manually performing this action for each document, you can use a sample utility tool, Web Intelligence Change Source, provided in SAP BusinessObjects BI 4.2 SP 4.
This utility is available in the Samples/wics folder in the installation folder as a BIAdminWebIChanceSource.lcmbiar. Ask your administrator to go to the CMC to import it with Promotion Management. Once imported, when you go into the BI Launch Pad, you can see in the BI Admin folder:


                    Two Web Intelligence documents: WebIChangeSource_Update and WebIChangeSource_Worklist


                    An Excel file: WebIChangeSource_Worklist_SearchReplace


To do bulk changes, follow these steps:


                    Open and refresh the WebIChangeSource_Worklist document. This document lists all universes and documents that use them in your CMS repository. Use this document to find the universe source and target CUID.
                

                    Save the WebIChangeSource_Worklist_SearchReplace file locally. Open it and fill it with the universe details:
                    

                            Source universe (UNV) CUID
                        

                            Source universe (UNV) name
                        

                            Target universe (UNX) CUID
                        

                            Target universe (UNX) name
                        



                    Upload the modified Excel file in the BI platform repository, in the BI Admin folder.
                

                    Open and refresh the WebIChangeSource_Worklist document.
                

                    Open and refresh the WebIChangeSource_Update document. The Prompts dialog box opens where you can select one of these three options:
                    

Cancel: To cancel the action.
                        

Test: To test the change source. This does not modify the Web Intelligence documents but you can use it to check the results of the change source. Always run this test before actually doing the change.
                        

Change: To actually perform the change source.
                        



14.7.4    Change Source Excel, Text, and Free-Hand SQL
If your document is based on an Excel (respectively text) file, you may change this Excel (respectively text) file. You do not use the Change Source wizard described previously, but use the Query Panel. You must be in Design mode and edit the query. In the Query Panel, in the Query Properties pane, click the button beside the Source Path field to select another Excel (respectively text) file (see Chapter 2, Section 2.5).
Identically, if your document queries a relational database through free-hand SQL, you may change the queried database by modifying the used connection. You must be in Design mode and edit the query. In the Query Panel, in the Query Properties pane, click the button beside the Connection field to modify this connection (see Chapter 2, Section 2.5).









14.8    Summary
One of Web Intelligence's strength is its capability to support multiple queries and multiple data sources and to merge the resulting data sets.
A first method is to combine queries based on the same universe and to use the union, intersection, and minus operators on the resulting data sets.
You can use multiple data sources in a single document to expand the capabilities of your reports by combining data from a variety of sources. You can include the results from multiple queries sourced from the same universe, different universes, and other data sources such as SAP BEx queries, Analysis workspaces, Excel files, various text formats, and web services.
When refreshing a document, you can select to run one individual query or all its queries. In this last case, these queries can be run in parallel to reduce query time.
To take full advantage of multiple queries, Web Intelligence can synchronize the data sets to combine the results from multiple data sources. This is achieved by selecting dimensions in these data sources that have identical rows and by merging these dimensions. Merging dimensions can be done manually or automatically when you add a new query.
If the rows returned by these dimensions do not match exactly, you can create variables on these dimensions to transform their rows, make sure they are identical, and merge the resulting variables.
In a document's lifecycle, you will very likely have to change its data source. Web Intelligence proposes the Change Source wizard to perform this task.








15    Adding Hyperlinks in Web Intelligence DocumentsEmbed hyperlinks into Web Intelligence reports to connect to documents saved in the BI platform repository to any web site in order to create interactivity between reporting components. You can use the OpenDocument() function to generate URL that can be shared to open Web Intelligence document.Hyperlinks enable report developers to create comprehensive and cohesive reporting solutions that connect SAP BusinessObjects documents with single-click navigation. This feature can be used to provide business users with a form of guided analysis by connecting to reports and dashboards that tell a different story with the data. Strategically inserted links in Web Intelligence reports expand on the data being viewed by opening and refreshing other related reporting documents.Hyperlinks allow reports to be connected for a variety of purposes. They can launch reports to open in a printer-friendly PDF format, launch an SAP Lumira data story, or provide additional information in detailed reports associated with specified parameters in prompted documents.One of the most significant benefits of hyperlinking is opening and refreshing reports that pass values to prompted Web Intelligence documents. This feature gives business users access to the most current data possible by refreshing target reports at the moment the link is clicked. Links can also go outside of the SAP BusinessObjects BI 4.2 platform to intranet or public-facing websites.This chapter describes how to link to other reports graphically while working in the HTML viewer or by configuring them manually. It explains the relative advantages and disadvantages of setting up links in each viewer and describes the detailed steps for manually building hyperlinks.
15.1    Linking to Document with the HTML Client
You can easily add hyperlinks to existing Web Intelligence documents when in Design mode and when you've selected the HTML client in the Web Intelligence preferences. This viewer provides an additional feature that's not available in the Java Applet. The Add Document Link option provides the ability to link to a document published to the BI platform repository.
15.1.1    Adding a Hyperlink to a Web Intelligence Document
To add a hyperlink to a document published to the BI platform repository using the HTML client, you must be in Design mode.

Web Intelligence HTML Only
The wizard to add a hyperlink to a Web Intelligence document published in the BI platform repository can only be used in HTML, not in the Java Applet. The created hyperlink is active in the four Web Intelligence clients, including the Java Applet.
To add a hyperlink to a Web Intelligence document using the Java Applet, you must manually add its URL using the OpenDocument syntax (Section 15.2).

Right-click on a row, column, or cell in a data table, and then select the Linking option from the menu. From this menu, you can add a hyperlink, document link, or element link to an existing reporting document.
Figure 15.1 shows the menu that appears when you right-click on a column in a data table while in Design mode using the HTML client. The same hyperlink options appear when right-clicking on a freestanding cell. In the Linking sub-menu, select the Add Document Link command to create a connection to another document published to the BI platform repository.
The same command can also be found in the Report Elements tab, Linking tab in the third set of subtabs, as shown in Figure 15.2.

Figure 15.1    Adding a Hyperlink While Designing a Report in the HTML Client

Figure 15.2    Add Document Link Commands in the HTML Client
After you click on Add Document Link, the Create Hyperlink window opens with options divided into two tabs:


Link to web page (Section 15.2)
                

Link to document


If you right-click on a cell or column that already contains a hyperlink, the Add Hyperlink and Add Document Link options will be disabled, and the options to Edit Link and Remove will be enabled so that you can make changes to an existing hyperlink.
After a hyperlink has been created, the Read Contents As Hyperlink setting will be checked, indicating that the cell contains an enabled link. Unchecking this option will disable the link but not get rid of the link completely. Use the Remove option to completely disable and delete a hyperlink.
Browsing for Documents
With the Link to document tab selected, click on Browse to choose an existing document on the BI platform repository to set as the target document of the hyperlink. Figure 15.3 shows the Create Hyperlink window displayed when linking to a document.

Figure 15.3    Linking to a Document in the HTML Client

Note
The option to Link to document is available only when you've selected the HTML client in the Preferences section for Web Intelligence.

Clicking on Browse launches the Choose a Document window, where you'll see a full list of reporting documents that you have the rights to access and link to:


                        Web Intelligence documents
                    

                        SAP Crystal Reports
                    

                        SAP BusinessObjects BI workspaces
                    

                        Analysis workspaces
                    

                        SAP BusinessObjects dashboards
                    

Figure 15.4 shows the window opened when browsing for a document. Follow these steps to select a document to link to while viewing a report:


                        From the left side of the window, select the storage location of the target document. Options include the following:
                        

My Documents


Public Folders




                        From the right side of the window, select the document to link to, and then click on Open to confirm.
                    


Figure 15.4    Choosing a Document to Link To
15.1.2    Setting Hyperlink Properties
After selecting a document, you'll have the opportunity to revise properties used when opening the document, as shown in Figure 15.5. Properties of the new hyperlink are broken into three categories:


Hyperlink properties


Document prompts (displayed only when linking to a report that contains a prompted filter)
                

Customize the look and behavior of the hyperlink



Figure 15.5    Configuring Properties of a New Hyperlink
Hyperlinks Properties
Any of the four hyperlink properties can be selected to provide the following types of functionality. All four are unchecked by default:


Use complete URL path to create hyperlinkIncludes the web server name and port number in the hyperlink.
                    

Refresh on openSets the linked report to refresh on open (recommended when connected to a prompted document).
                    

Link to document instanceUsed when linking to a scheduled instance.
                    

Target area within the documentProvides the option to link to a specific report tab if multiple reports exist in the linked document as well as the capability to link to a report part.
                    

Figure 15.6 shows the options available when the Target areas within the document property is selected. Set the target document to open to a specific Report name or select the Report part option to target a specific chart or data table within a report. Both options are helpful for creating connections that guide users directly to the information needed for specific scenarios.

Figure 15.6    Linking to a Target Area or Report Part
Document Prompts
If a target document contains a prompted filter, a document prompt property will be presented in the list of Link to document properties. Use this entry to define what is passed to the prompted filter in the linked document.
The best practice for linking to a prompted report is to set the hyperlink on a column or value that contains the same object as the prompted filter. See Section 15.1.3 for more details about answering document prompts.
Customizing Hyperlink Look and BehaviorThree settings are provided to customize the look and behavior of the target document:


Document FormatDrop-down menu where you can select the format in which the document must open. The possible values are Default, HTML, PDF, Excel, and Word.
                    

Target WindowDrop-down menu where you can select to open the document in the current window (Current) or in a new window (New Window).
                    

TooltipType a message for the tool tip and choose Select object or Build a formula to display specific information when a user hovers above an active link.
                    


Note
After checking property boxes and making selections from the behavior dropdowns, click on Apply and then OK to accept the changes and set the hyperlink.
When a hyperlink has been applied to a cell or column in a data table, the values will be displayed with a blue text color and underlined by default.

15.1.3    Adding a Hyperlink to Prompted Documents
When a prompted Web Intelligence document is selected in the Choose a Document window, an additional set of options are displayed for document prompts. This section allows you to pass values to a prompted filter in the linked document.
The Document prompts section of the link properties displays a list of all prompted filters listed by the prompt text for each filter in the linked document.
By default, the object in the column or cell that contains the link will be passed to the prompted filter. Additionally, five options (shown in Figure 15.7) are provided to allow different ways of dynamically passing values to a prompted filter in the linked document:

Figure 15.7    Creating a Hyperlink to a Prompted Web Intelligence Report


Select objectSelects an object or variable from the source document.
                

Build formulaOpens the Formula Editor for custom formula creation.
                

Enter a constantAllows manually entered values.
                

Prompt user at runtimePrompts the user at runtime.
                

Use document defaultUses the default prompt value selection type.
                


Note
If a prompted document contains two or more prompted filters and is selected as the linked document, a Select Prompts window will present you with both prompted filters, allowing you to choose which object will receive the value.

Figure 15.8 shows the Select Prompts window when a new hyperlink has been created based on the State object in a data table and linked to a document containing two prompted filters. Choose the prompt filter to receive the value.

Figure 15.8    Select Prompts Window
Passing a Selected Object to a Prompted Report
An excellent way of linking Web Intelligence reports is to create a hyperlink based on the value of a selected object. This type of linking works best when the target report contains a single prompted filter that contains compatible values. This is most commonly used when creating a hyperlink on a dimension object and the same object serves as the prompted filter in another document.
An example of this type of linking is shown in Figure 15.9, in which you right-click on a column in a vertical table that contains the State object as the basis for the hyperlink. Mouse over the Linking option to display the available linking choices and then select Add Document Link to create a connection to another document. The selected value in the State object will be used as the basis for the new link. If the target document contains a prompted filter, then by default the value selected will be passed to the prompted filter in the linked document.

Figure 15.9    Creating a Hyperlink Based on the State Object

Note
The result of setting up a hyperlink containing this parameter-passing feature is that any [State] value selected in the data table is dynamically passed as part of the hyperlink to the target document when the value is clicked.










15.2    Linking to the Web Page URL
The second type of hyperlinking that can be added to a Web Intelligence report is to a web page. This setting allows you to create and embed hyperlinks to your company websites, blogs, or other types of web pages.
This method to add hyperlink through the URL is available in both the Web Intelligence HTML client and Applet. Similar to adding links to reports using the HTML client (Section 15.1), you must be in Design mode to add hyperlinks.
15.2.1    Adding Hyperlinks to Web Pages
Figure 15.10 shows the linking options available when right-clicking on a report element while in the Java Applet and in Design mode.


                    Right-click on a dimension column in a table and then select Linking from the available options. Next, select Add Hyperlink to launch the Hyperlinks window.
                    
Figure 15.10    Adding a New Hyperlink While Editing a Report


                    Click on Add Hyperlink opens the Hyperlinks dialog box, as shown in Figure 15.11.
                    Alternately, you may also click Linking, in the Report Elements tab, under the Linking sub-tab, as shown in Figure 15.12.
                    
Figure 15.11    Adding a New Hyperlink in the Applet Viewer

Figure 15.12    Adding Hyperlinks Using Icon in the Ribbon


                    In the Hyperlinks dialog box, paste or type a URL and then click on Parse to display the dynamic elements of the URL entered in the provided text area.
                    The URL properties are broken into three parts on the Link to web page tab:
                    

Address: the URL address.
                        

Customize the following dynamic elements of the address: to set the URL parameters values.
                        

Customize the look and behavior of the hyperlink: to define the hyperlink tooltip and where the web site must open
                        



                    If your URL contains parameters, they are displayed under the Customize the following dynamic elements of the address part. You can modify them to set the values of these URL parameters in one of two ways:
                    

                            Type a value in the text field to set a static value.
                        

                            Alternately, click the icon beside the drop-down menu to select a dynamic value based on report content. As shown in Figure 15.13, this menu contains two options:
                            

Select object: To open the Available Objects dialog box, as shown in Figure 15.14, where you can select an object of the report to use as value for this URL parameter.
                                

Build formula: To open the Formula Editor, as shown in Figure 15.15, where you can enter a formula to dynamically generate the URL parameter.
                                




Figure 15.13    Dynamic Elements Menu

Figure 15.14    Available Objects

Figure 15.15    Formula Editor


                    In the Customize the visual and interaction properties of the hyperlink , you may also define the link the following behavior settings:
                    

Tooltip: Enters a tool tip to be displayed when you place the mouse over the hyperlink. As for URL parameters, you can either type a static value, or use the dropdown menu to assign an object or formula as the tool tip.
                        

Target window: Specifies whether documents are to be opened in a new window or the current window.
                        



                    Click OK to validate your choice, close your dialog box, and have the defined hyperlink added into your report.
                


Example
If you enter the following URL in the text field and click Parse, the options sent to the web site are recognized and displayed under the dynamic elements section, as shown in Figure 15.16:
https://www.google.fr/search?q=web+intelligence&rlz=1C1GGRV_enFR751FR751&oq=web+intelligence&aqs=chrome.0.0j69i61j69i60j69i61j69i59j0.4077j0j7&sourceid=chrome&ie=UTF-8

Figure 15.16    Parsed URL Example

15.2.2    Adding a Hyperlink to a Web Intelligence Document Using Its URL
To link to documents published to the SAP BusinessObjects BI 4.2 platform, use this basic format for constructing your URL and using the OpenDocument syntax:
http://<server>:<port>/BOE/OpenDocument/opendoc/openDocument.jsp?
All parameters supported for Web Intelligence by OpenDocument are described in Section 15.3.

Note
Unlike in SAP BusinessObjects Enterprise XI 3.x, SAP BusinessObjects BI 4.2 supports only a Java deployment. This means you'll need to use openDocument.jsp when creating document hyperlinks.

This method can be used in Java Applet that does not support the wizard described in Section 15.1 to directly add an hyperlink to a Web Intelligence document.
One of the easiest ways to become familiar with the structure of a hyperlink URL is to analyze the syntax generated when the HTML client is used to add a document link. To do this, follow these steps:


                    Add a document link using the HTML client and check the option to Use the complete URL path to create the hyperlink.
                

                    Select the cell or column that contains the new hyperlink and view it in the formula bar while in Design mode, or click the URL to open it in a browser and get the generated URL.
                

                    Copy the full URL beginning with http:// and ending at the final double-quote symbol located before the title parameter.
                

                    Change the viewer to Java Applet and add a new hyperlink, as described in Section 15.2.1.
                

                    Paste the full URL retrieved from the previous step into the hyperlink box and click on Parse.
                

Consider this full URL example created when a link to another Web Intelligence document is added:

Link Syntax to Published Web Intelligence Document
="<a href=\"http://localhost:8080/BOE/OpenDocument/opendoc/openDocument.jsp?iDocID=AdbPdYxgwINLhJ4KEwjcsss&sIDType=CUID&sType=wid&sRefresh=N\" title=\"\" target=\"_blank\" nav=\"doc\">"+NameOf([Quantity sold])+"</a>"

Recognize that the URL within the statement begins with http:// and ends with the final slash before the quotation mark and title parameter. To use this URL to link to another document, switch to the Java Applet and create a new hyperlink. Paste the URL into the hyperlink box and click on Parse.

Figure 15.17    Hyperlink Parsed in the Applet Viewer
Figure 15.17 shows the dynamic elements of the URL after adding it to the hyperlinks box and clicking on Parse. The syntax used in the URL is into three different groupings:


AddressUses the openDocument.jsp application.
                

Customize the following dynamic elements of the addressContains the dynamic identifier parameters of the target document (Section 15.3):
                    

iDocID


sIDType


sType


sRefresh




Customize the visual and interaction properties of the hyperlink


Tool Tip: Manually enter a constant, select an object, or build a formula to provide a tool tip or mouse-over message to the user.
                        

Target Window: Specify where to open the target window (e.g., current window or new window).
                        



15.2.3    Getting Document OpenDocument URL
As described in the previous section, you can get the OpenDocument URL by analyzing the URL generated by Web Intelligence HTML when adding a hyperlink to a Web Intelligence document.
Another method that can be used for simple configurations or to share the link outside the BI platform is to have the BI Launch Pad generate this OpenDocument URL for you.
To do so, follow these steps:


                    In the BI Launch Pad, select your document and right-click it.
                

                    In the contextual menu, select the Document Link command, as shown in Figure 15.18.
                    
Figure 15.18    Document Link Command in BI Launch Pad


                    The Document Link dialog box opens, as shown in Figure 15.19.
                    
Figure 15.19    Generated URL


                    Select and copy the displayed URL.
                

                    You can use this URL when adding a hyperlink to a website, as described in Section 15.2.1. You can also send it by email or include it in another portal.
                

When your recipient clicks this URL, he is asked to authenticate to the BI platform by providing its credentials. Then, the Web Intelligence viewer opens and displays the document you have selected.
The generated URL is simple. It does not include the many parameters supported by OpenDocument such as Refresh to refresh the document when it is open or lsS, lsM, and lsR to answer prompts. These parameters are described in Section 15.3.
15.2.4    Adding Hyperlinks to the SAP BusinessObjects Dashboard
Hyperlinks to dashboards can be created by adding even just a single parameter to the end of the main URL. This can be achieved by using the sDocName parameter, followed by the name of the target document.
Use a plus (+) symbol to represent spaces between words in the document title, as in this working URL that links to a dashboard:
http://localhost:8080/BOE/OpenDocument/opendoc/openDocument.jsp?sDocName=Simple+Dashboard
Whether linking to a report by using Web Intelligence HTML or Java Applet, understanding the syntax of document linking is crucial to being able to edit it and expand on it. The next section introduces the various parameters available for customizing a document link using the OpenDocument syntax.

Tip
Using a single parameter in a document link provides a very easy way of connecting to a dashboard, but it could also lead to problems if multiple instances of the same document name exist in different folders on the BI platform repository.
The ideal solution for linking to another document is to use these two linking parameters: iDocID=<document ID> and sIDType=CUID. Alternatively, using the document name in the hyperlink works perfectly fine but should also be accompanied by the sPath or folder name where the document has been saved.










15.3    OpenDocument Syntax
The OpenDocument syntax can be used to pass a wide variety of parameters to the document being opened with the OpenDocument URL hyperlink.
The OpenDocument URL supports several parameters that are grouped into three categories:


                Document identifier parameters
            

                Input parameters
            

                Output parameters
            

15.3.1    Document Identifier Parameters
The document identifiers parameters are used to identify the document to open. These parameters are described in Table 15.1.




                            Parameter
                        

                            Description
                        





sDocName


                            Document name
                            Use the plus symbol (+) to represent spaces between words.
                        



iDocID


                            Document identifier
                            Document ID located in document properties.
                        



sIDType


                            CMS object ID type
                            Values: CUID, ParentID, InfoObjectID.
                        



sInstance


                            Selects the instance to open. Possible values are:
                            

user: For the latest instance owned by the current user.
                                

last: For the latest instance of the report.
                                

param: For the latest instance of the document run with the same prompt values.
                                





Table 15.1    Document Identifier Parameters
The document must be identified either by sDocName or sDocID. If you use sDocID, you must also provide sIDType to define what ID is used.
15.3.2    Input Parameters
The input parameters are mainly used to answer documents prompts and contexts. These parameters are described in Table 15.2.




                            Parameter
                        

                            Description
                        





lsC


                            Specifies a context.
                        



lsS [Name]


                            Specifies a value for a single prompt. [Name] is the text of the prompt.
                            Use no_value to ignore an optional prompt.
                        



lsM [Name]


                            Specifies multiple values for a prompt. [Name] is the text of the prompt.
                            Values are separated by semicolons.
                            Use no_value to ignore an optional prompt.
                        



lsR [Name]


                            Specifies a range of values for a prompt based on a Between or Not Between operator or an interval. The two endpoints are separated by a double period (..).
                            Use no_value to ignore an optional prompt.
                        



lsI[Name]


                            Specifies index or key values. This parameter must be associated with one of these parameters: lsS[Name], lsM[Name], or lsR[Name].
                            Used for index-aware prompts. Can be used to pass the technical name of the variable setup in the SAP BEx Query Designer. URL encoding is required.
                        



sRefresh


                            Identifies the specific report element in the target document to open when using sViewer=part (Section 15.3.3). Possible values are:
                            

Y: Force the document to refresh on open.
                                

N: Do not force the document to refresh on open.
                                





sReportName


                            Identifies the report to open if the target document contains multiple reports. Possible values are the name of a report in the Web Intelligence document.
                        



sReportPart


                            Identifies the specific report element of the target document to open when using sViewer=part (Section 15.3.3).
                        



Table 15.2    Input Parameters

Passing SAP Prompt Variables
To identify SAP variables in OpenDocument URLs, you must use their technical names. The technical names can be obtained using the multidimensional expressions (MDX) test editor.

15.3.3    Output Parameters
The output parameters are used to define how the output must be displayed. These parameters are described in Table 15.3.




                            Parameter
                        

                            Description
                        





NAII


                            Forces the display of the prompt selection page. Possible value is Y.
                        



sOutputFormat


                            Defines the format of target document. Possible values are the following:
                            

H: Web Intelligence


P: PDF 






sWindow 


                            Specifies how the document must open. Possible values are the following:
                            

Same: In the current window
                                

New: In a new window
                                





sViewer


                            Specifies the selected report viewer. Possible values are the following:
                            

html: To open the full document in Web Intelligence HTML, in Reading mode.
                                

part: To focus only the report part identified by sReportPart (Section 15.3.2). The document is opened in Web Intelligence HTML, in Reading mode.
                                





noDocument


                            Opens Web Intelligence in Design mode, without any document. Possible value is true.
                        



Lang


                            The language to use for displaying the Web Intelligence interface. This language is expressed in two letters, like en for English.
                        



Pvl


                            The locale to use for displaying document content. This locale is expressed using the format lang_country, like en_US for English (US).
                        



Table 15.3    Output Parameters
By knowing the available parameters that can be used with the OpenDocument function and the syntax required for using them, you can create complex links to meet unique business requirements. Links can contain several input parameters, output parameters, and document identifier parameters. Remember to separate every parameter and value combination with an ampersand (&) symbol.









15.4    Summary
Hyperlinks are useful additions to Web Intelligence reports. They allow report developers to embed links to other reporting documents or to web pages. Links can be added to documents while working in the HTML client through document linking or with the Java Applet using the OpenDocument syntax.
One of the biggest benefits of inserting hyperlinks in reports is the capability of passing dynamic values to prompted filters. This feature allows entire columns to serve as hyperlinks that pass only the selected value to a prompted filter in a Web Intelligence document. Reporting documents can also be refreshed and opened to display up-to-date data with a single click.
An extensive list of input, output, and document identifier parameters is available for passing values to linked reports published to the SAP BusinessObjects BI 4.2 platform. These parameters are appended to URLs created with the OpenDocument syntax structure that connect to target documents.
Chapter 16 provides details on working within the BI Launch Pad.








16    Working in the BI Launch PadThe BI Launch Pad web portal used to access Web Intelligence documents provides a fully integrated interface for organizing, viewing, analyzing, and sharing business intelligence content. The added functionality and ease of use of the interface make the BI Launch Pad a powerful tool for end users and report writers alike.Web Intelligence reports are accessed using the SAP BusinessObjects BI platform web portal called the BI Launch Pad (formerly InfoView). The BI Launch Pad portal gives you access to a variety of business content outside of Web Intelligence reports, including SAP Crystal Reports, SAP Lumira documents, Microsoft Office documents, and so on. This gives business users a single and secure location to view business intelligence content. You can also publish and distribute content to other users in Web Intelligence, Excel, PDF, SAP StreamWork, and the MIME HTML (MHTML) format from within the BI Launch Pad.
16.1    Navigating in BI Launch Pad
Figure 16.1 shows the default view after you log in to the BI Launch Pad. The initial view shows the Home tab, which can be customized in General Preferences. The screen is divided into three sections by default: header panel, tabs, and Home tab view. The header panel includes the BI Launch Pad toolbar with menu options applicable across the BI Launch Pad. The tabs display the default Home and Documents tabs as well as any tabs pinned to the BI Launch Pad interface. Additional tabs may be available by default depending on your configuration.
Let's begin by focusing on the header panel.

Figure 16.1    BI Launch Pad Initial View
16.1.1    Header Panel
The header panel menu options may vary depending on any customization that may have been applied to your environment or security group (see Figure 16.2).

Figure 16.2    Header Panel
The header panel includes the customizable top header section with the company logo and the header panel menus. A number of menu options are available by default, although availability of these options depends on your access rights. The header also displays the name of the user account that is currently logged in.
The following are various menus and tabs found in the header panel:


Home tabSelecting the Home tab brings you back to the initial view shown in Figure 16.1. Your Home tab can be customized in your General Preferences, as discussed in Section 16.2.1. SAP BusinessObjects administrators can also create custom Home tabs for users or groups.
                

Documents tabSelecting the Documents tab option enables you to view the drawers with the folders and categories organization structure as well as the documents available within these folders and categories.
                

Applications menuUpon selecting the Applications menu from the header panel, a dropdown list appears of the available types of applications that can be opened within the BI Launch Pad, as shown in Figure 16.3. These options will vary based on the settings in your environment as well as your user rights.
                


Figure 16.3    Applications Menu on Header Panel


Preferences menuSelecting the Preferences menu opens the personal preferences available to customize the BI Launch Pad and Web Intelligence for your user account. Further discussion regarding setting preferences is contained in Section 16.2.
                

Help menuSelecting the Help menu opens the About page with the specific product information about your environment as well as access to additional help resources.
                

Log Off optionSelecting the Log Off option will end your current SAP BusinessObjects BI platform session. It's important to log out of the BI Launch Pad rather than closing the browser because your session will remain open until the default timeout period set up by your SAP BusinessObjects administrator. Depending on your company's licensing structure, numerous open sessions may restrict your access to the BI Launch Pad. If you experience this problem, contact your SAP BusinessObjects administrator to re-enable your access.
                

Home Tab
The default Home tab (refer to Figure 16.1) features icons for quick access to applications as well as five panels:


My Recently Viewed DocumentsThe first quadrant includes links to the 10 last viewed documents sorted by view date with the most recent at the top of the list.
                    

Unread messages in My InboxThe second quadrant displays the 10 most recent unread messages in your BI Inbox. Selecting the See more... link at the bottom-right of the box will bring you to your BI Inbox to view the unread messages.
                    

My Recently Run DocumentsThe third quadrant lists the last 10 documents that you scheduled or ran. It also includes the status of each instance. You may select the document name to open the instance.
                    

Unread AlertsThe fourth quadrant includes a listing of unread alert messages that you are subscribed to in your alert subscriptions. Selecting the See more link at the bottom-right of the box will bring you to your alerts to view the unread messages.
                    

My ApplicationsThis area provides links to the applications that you have access to within the BI Launch Pad.
                    

Documents Tab
The second default tab in the initial workspace is the Documents tab, shown in Figure 16.4, and it contains the drawer menus and objects such as folders, categories, Web Intelligence documents, and publications for your use in the BI Launch Pad.
The expandable panes on the left of the screen in the Documents tab are called drawers. Depending on your access rights, not all objects in the drawers may be visible to you. The following drawer menus are available:


My DocumentsThe items included in the My Documents drawer include objects that are visible only to you. It also has a My Favorites folder, in which you can store your personal documents as well as temporary files saved from a timeout. You can create additional folder hierarchies within your My Favorites folder to further personalize and organize your documents. Other folders include BI Inbox, My Alerts, Subscribed Alerts, and Personal Categories.
                    

FoldersThe Folders drawer includes the public folders visible to all users, although which specific folders are available is dependent on access rights.
                    

CategoriesThe Categories drawer includes the categories available for public consumption. These are discussed later in Section 16.3.
                    

SearchThe Search drawer includes the search box discussed in further detail in Chapter 18.
                    


Figure 16.4    Documents Tab
If you select the Documents tab instead of the Home tab, you'll see the drawers for navigation, the folders, or categories set up within the BI Launch Pad. Figure 16.5 shows a sample Navigation Panel structure within the Folders drawer. The Navigation Panel within each organization will be customized to its needs, so your Navigation Panel will be different from this view. Along with the folder hierarchy in the Navigation Panel, you will see the list of documents in the List Panel as well as the toolbar and Details Panel.
Figure 16.5 shows a sample view of the List Panel after selecting Public Folders from the Folders drawer.

Figure 16.5    Folders Drawer
When you've selected the Documents tab from the BI Launch Pad, you can access the documents' toolbar, as shown in Figure 16.6.

Figure 16.6    Toolbar
This toolbar includes the following items:


ViewAs shown in Figure 16.7, you have several options when you select the View menu: View (the document), View Latest Instance, or Properties. To activate the menu options, you must first select a document from the List Panel. The View option will open the document in Reading mode within the BI Launch Pad. The View Latest Instance option will open the latest scheduled instances in Reading mode. If there are no saved instances, then this option won't be active in the menu options. The Properties option displays the document properties with specific information regarding the selected report.
                    


Figure 16.7    View Menu


NewWhen you select the New menu from the toolbar, a dropdown list displays the available options, as shown in Figure 16.8. The available options will depend on your environment and user settings.
                    


Figure 16.8    New Menu


OrganizeThe Organize menu contains options that are standard in a number of programs, such as Cut, Copy, Copy Shortcut, Paste, and Delete, as shown in Figure 16.9. The Organize button will only become enabled when you've selected a folder where your rights allow you to perform this action. When you've selected a document in the List Panel, the Organize menu also contains the option to Create Shortcut In My Favorites.
                    


Figure 16.9    Organize Menu


SendThe Send menu, shown in Figure 16.10, contains options for sending a document to other users across the organization, including to another user's BI Inbox. Sending Web Intelligence content is described in more details in Chapter 19, Section 19.2.
                    


Figure 16.10    Send Menu


More ActionsThe More Actions menu displays only after you select an object from the Workspace Panel. This menu contains a number of actions you can perform on a Web Intelligence document from within the BI Launch Pad (see Figure 16.11).
                        

Modify: Allows you to modify the object. For a Web Intelligence report, selecting the Modify option will open the report in Web Intelligence in Design mode to make any necessary changes.
                            

Schedule: Allows you to schedule to a designated distribution. Refer to Chapter 19 for detailed information on scheduling reports.
                            

History: Displays the schedule history. Refer to Chapter 19 for detailed information on scheduling reports.
                            

Categories: Allows you to select which categories an object should display in.
                            

Document Link: Provides the OpenDocument hyperlink information. Chapter 15, Section 15.3 provides further information on utilizing document linking. You also have the ability to create a URL link to a public folder or category.
                                
Figure 16.11    More Actions Menu






DetailsThe Details button opens the Details Panel (as shown in Figure 16.12), which provides information about the document. A drawer menu is also available on the Details tab, including Summary, Collaboration, and Discussions drawers. The Summary drawer displays information about your current selection. The Collaboration drawer is available based on your settings. This drawer exposes the collaboration options available with SAP Jam.
                    


Figure 16.12    Details Panel


RefreshSelecting the Refresh button refreshes the Documents tab. This can be helpful when a new report is added to the BI Launch Pad or after creating a new folder or category.
                    

Page NavigationThe Page Navigation includes the current page number of the Navigation Panel with arrows allowing you to quickly navigate between pages. The default number of items displayed per page is set in the General Preferences, as discussed in Section 16.2.1.
                    

16.1.2    List Panel
The List Panel, as shown previously in Figure 16.5, displays the objects selected in the Navigation Panel.
16.1.3    Tabs
Additional tabs may be available to you, depending on your environment. Your SAP BusinessObjects administrator can designate specific default tabs for your organization. Also, if your implementation includes integration with SAP Jam, you may see a tab for Collaboration. You can also select the Pin this tab option to pin a selected document to your initial view, as shown in Figure 16.13.

Figure 16.13    Pin This Tab Option









16.2    Setting BI Launch Pad Preferences
The majority of user settings are set by your SAP BusinessObjects administrator in the Central Management Console (CMC), but there are some preferences that the user can set. These include preferences for the BI Launch Pad, Web Intelligence, and possibly SAP Crystal Reports or SAP BusinessObjects BI workplace. Refer to Chapter 1, Section 1.3 for a more substantial discussion on Web Intelligence preferences. Settings that are specific to the BI Launch Pad environment are defined in the general preferences.
16.2.1    General Preferences
General preferences include settings for your BI Launch Pad environment. The Use Default Settings (Administrator defined) checkbox—which enables you to naturally inherit default settings—is selected by default. You can define your own custom preferences if you uncheck this box.
The first setting allows you to define the BI Launch Pad start page, whose options are shown in Table 16.1.




                            Location
                        

                            Description
                        





Home


                            The Home tab is the default setting as shown earlier in Figure 16.1. You can select the default Home tab or browse the repository for a custom Home tab.
                        



My Documents • My Favorites


                            The My Favorites option opens the BI Launch Pad with the Navigation Panel selected on your Favorites folder and the List Panel showing the contents of your Favorites folder.
                        



My Documents • Personal Categories


                            The Personal Categories option opens the BI Launch Pad with the Navigation Panel selected on your personal categories and the List Panel showing the contents of your categories.
                        



My Documents • My Inbox


                            The My Inbox option opens the BI Launch Pad with the Navigation Panel selected on your BI Inbox and the List Panel showing the contents of your BI Inbox.
                        



Folders


                            The Folders option shows the tree view set to the folder you specify in the Browse folder box and the Workspace Details Panel showing the contents of the selected folder.
                        



Categories


                            The Category option shows the tree view set to the category you specify in the Browse Category box and the Workspace Details Panel showing the contents of the selected category.
                        



Table 16.1    The BI Launch Pad Start Page Options
The Documents tab preferences allow you to select the default view of either folder or categories that will display in your workspace. We'll discuss the differences between folders and categories in further detail in the next section.
The Documents tab display option allows you to select which columns will be displayed by default when viewing the Documents tab in the List Panel. Select the checkbox to display the property according to your preference. Options include: Type, Last Run, Instances, Description, Created By, Created On, Location (Categories), Received On (Inbox), and From (Inbox).
The Document Viewing Location property specifies how you'll view documents upon selecting View from the toolbar in the BI Launch Pad. The available options include the following:


                    In the BI Launch Pad portal as tabs
                

                    In multiple full screen browser windows, one window for each document
                

The final option on the general preferences allows you to set the maximum number of objects to show at one time per page in the Workspace Details Panel of the BI Launch Pad. The default setting is set to 50 items per page. Increasing the number of objects shown per page can have an impact on performance, so exercise caution when changing these settings.
16.2.2    Locales and Time Zone Preferences
Additional properties specific to your locale are shown in Figure 16.14. Locale-specific properties are usually defined in the CMC by your SAP BusinessObjects administrator. If you prefer to use customized personal properties, then the option is available in Preferences.

Figure 16.14    Preferences for Locales and Time Zone
The following are locale-specific properties:


Product LocaleThis locale defines how the user interface (menu, buttons) must be displayed. The default setting uses the locale of your browser.
                

Preferred Viewing LocaleThis locale defines how business intelligence content must be displayed. This covers translated universes and documents, multilingual datasources, and more. The default setting uses the locale of your browser.
                

Current Time ZoneThe default setting uses the time zone of the web server used by SAP BusinessObjects Enterprise.
                

16.2.3    Changing Your Password
The ability to change your password will depend on your authentication type. If you are set to Enterprise authentication, and your SAP BusinessObjects administrator has enabled this right, then you can change your password. The Change Password preferences are shown in Figure 16.15.

Figure 16.15    Change Enterprise Password

Note
The options that are available to you in Preferences may be different depending on the settings in the CMC set by your SAP BusinessObjects administrator as well as your specific SAP BusinessObjects deployment.










16.3    Organizing in Folders and Categories
There are two ways to organize your documents within the BI Launch Pad: folders and categories. The key difference between folders and categories is that every document must belong to a folder, but a document doesn't have to belong to a category. Categories are a way to organize your documents into logical groupings without having to create copies or shortcuts of your documents. The documents contained within categories are not duplicates, but the same original document organized in a different way. For example, your public folders may be organized by region so that each region is restricted to see their folder alone. The category structure could be organized by logical grouping of time when reports are normally viewed or run: yearly, monthly, weekly, or daily. This helps users quickly see which reports to view using categories but also lets them navigate through the folders based on their company structure.
16.3.1    Folders
There are two types of folders: public and personal. Public folders are usually set up by the SAP BusinessObjects administrator and restricted on who can set up new public folders. They also can be restricted on who can publish documents to the public folders in order to maintain a system of testing and quality assurance before reports are published for public consumption. They are contained in the Folders drawer.
In contrast, only you or users with administrative access can view documents contained in personal folders. Each user has his own personal folders to organize documents for his own personal use. These documents are not available for public consumption. They are found in the My Documents drawer.
Personal folders include the My Favorites documents and the user's BI Inbox. Users across an organization can share documents by sending them to each other's BI Inboxes. More detail on sharing documents is discussed in Chapter 19. My Favorites consists of personal documents for the user's own consumption. You can create additional personal folders within your My Favorites to further organize your documents, provided you've been given the appropriate rights. Refer to Figure 16.5, which shows a sample folder structure in the BI Launch Pad.
16.3.2    Categories
Categories are an optional way to organize documents. A Web Intelligence document belongs to only one folder, but it can belong to multiple categories, if desired. Categories are also used to tag Web Intelligence documents for display on mobile devices via the SAP BusinessObjects Mobile BI app, which is covered in Chapter 24. Like folders, categories can be both personal and corporate. Corporate categories are available across an organization, while personal categories are only available to the specific user. Figure 16.16 shows the Categories drawer in the Documents tab. You can access personal categories from the My Documents drawer.

Figure 16.16    Corporate Categories
16.3.3    Organizing Objects
Objects such as Web Intelligence documents are organized in the BI Launch Pad using folders and categories. Depending on your user rights, you can create new folders and categories, move and copy existing folders and categories, sort objects within folders and categories, delete unneeded folders and categories, and set folder and category preferences. Let's explore all of these options further.
Creating New Folders and Categories
To create a new folder, it's necessary to be in the folder drawer or to have My Favorites selected in the My Documents drawer. Select New from the BI Launch Pad workspace toolbar and choose Folder from the dropdown list.
To create a new category, it's necessary to be in the Categories drawer or have the Personal Categories selected in the My Documents drawer. Select New from the BI Launch Pad workspace toolbar and choose Category from the dropdown list.
Moving Objects in Folders and Categories
Use the Cut • Paste option from the Organize menu to move an object in a folder or category. First, select the object to be moved. Then select the Organize menu from the BI Launch Pad workspace toolbar and choose Cut. This will remove the object from its current location and allow you to paste it into the new location. Navigate to the new folder or category location and select Paste from the Organize menu.

Note
Any shortcuts that have been applied to an object will be maintained when copying and pasting objects to a new location.

Copying Objects in Folders and Categories
To copy an object in a folder or category to another location, highlight the object to be copied and select Copy from the Organize menu on the Documents tab toolbar. Then navigate to the new folder or category to add the object to the new location and select Paste from the Organize menu. This will create another instance of this object in the new location. If you make changes to one object, you also need to make them to the other object to maintain consistency. If you want the second instance to automatically reflect any changes made to the original object, then you should use the shortcut function discussed in Chapter 18.
Sorting and Filtering Objects in Folders and Categories
You can sort objects from within folders and categories into ascending or descending order by selecting the heading of the column of the Workspace Panel. The default setting is to sort objects from A to Z by title. When you hover over the title bar, a funnel icon will appear. Select this icon to filter content in the list, as shown in Figure 16.17. Reselect the Filter icon and select the Clear Filter checkbox to remove the content filter.

Figure 16.17    Column Filters Option
Deleting Objects in Folders and Categories
To delete an object in a folder or category, select the object and choose the Delete option from the Organize menu. Whether you're authorized to delete objects will be dependent upon your user rights. Users are typically only authorized to delete objects in their personal folders or categories unless they have administrative level access. See Section 16.4 for details about the Recycle Bin, where the object is moved before being actually deleted.
Setting Object Properties
To set object properties, highlight the object in the Workspace panel and select Properties from the View menu. The Properties box allows you to define the object title, description, and keywords.









16.4    Deleting Documents and the Recycle Bin
SAP BusinessObjects BI 4.2 introduced rudimentary Recycle Bin functionality to BI administrators. In SAP BusinessObjects BI 4.2 SP 3 and higher, this functionality is now available to users in the BI Launch Pad.
After you have deleted an object from Organize • Delete menu or tab, it is moved to a Recycle Bin instead of being permanently deleted as in previous versions. You'll have an opportunity to confirm the delete operation, as shown in Figure 16.18. In prior releases, it would not be possible to recover the document after this step.

Figure 16.18    Confirming the Delete Operation
The deleted file no longer appears in its original location.
The Recycle Bin is not visible until you delete a document for the first time. The next time you log in to the BI Launch Pad, you'll notice the Recycle Bin drawer between the Folders and the Search drawers, as shown in Figure 16.19.
To restore a document from the Recycle Bin, simply right-click and choose Restore. The document immediately appears in its previous location.

Figure 16.19    Restoring a Document from the Recycle Bin









16.5    Viewing, Printing, and Saving Objects in BI Launch Pad
You can view, print, and save Web Intelligence documents within the BI Launch Pad without having to edit them in Web Intelligence. From within the List Panel, select the Web Intelligence document that you want to view within the BI Launch Pad and select View from the Actions menu on the BI Launch Pad workspace toolbar. You can also double-click on the name of a report to open it in Reading mode or select View from the right-click menu when selected on a document. (The View option also opens the Web Intelligence document in Reading mode. How the document opens within Reading mode will be dependent on your preferences, as discussed in Section 16.3.) When viewing a Web Intelligence document within the BI Launch Pad, the Web Intelligence Viewer toolbar, shown in Figure 16.20, will appear with the options available to you.

Figure 16.20    Web Intelligence Viewer Toolbar in Reading Mode
Let's examine this toolbar closely.
16.5.1    Web Intelligence Viewer Toolbar
The first menu on the Web Intelligence Viewer toolbar is the Web Intelligence menu, where you can select options for your toolbar views. This includes toggling on or off the filter bar, outline view, side panel, report tabs, and status bar.

Figure 16.21    Additional Menu Options
The following toolbar options are shown in Figure 16.21:


NewCreates a new Web Intelligence document.
                

OpenEnables you to select from the Documents tab to open another Web Intelligence report in Reading mode.
                

Save MenuTwo options are available:
                    

                            The Save option saves any changes made to the report.
                        

                            The Save As option saves any changes made to the report as a new name and/or to a new location.
                        



PrintExports the report to PDF format for printing. Web Intelligence documents must first be exported to PDF before they can be printed. After you select the Export to PDF button, you will be prompted to open the PDF or save it. You don't need to save the PDF to create a printed copy, but you may want to save the PDF for further reference.
                

FindSearches for text in tables and cells on the page being viewed of the report.
                

HistoryLists dates corresponding with the history of the scheduled instances of the document.
                

ExportEnables you to export a document in PDF, Excel, Excel 2007, CSV Archive, or text format (see Chapter 19, Section 19.3).
                

Send ToAllows you to send to email, BI Inbox, or FTP location (Chapter 19, Section 19.2), depending on your access rights.
                

UndoUndoes the previous action.
                

RedoRedoes the previous action.
                

RefreshRefreshes selected queries or all queries used by the report.
                

TrackActivates or deactivates the data tracking, see Chapter 18, Section 18.6.
                

DrillEnables drill mode, as discussed in Chapter 11.
                

Filter BarDisplays the filter bar on the report, as discussed in Chapter 9.
                

FreezeProvides the ability to freeze headers or columns in tables to keep them displayed as you scroll through data, see Chapter 5, Section 5.1.4.
                

OutlineShows or hides the outline providing the ability to use fold/unfold features on the report.
                

Reading MenuLets you switch between different modes such as HTML and PDF for viewing the document.
                

Design MenuLets you edit the document in Web Intelligence by selecting to Design with Data or Structure only.
                

HelpOpens the online help.
                

Other menu options extend Web Intelligence viewer functionality, as described next.
16.5.2    Additional Menu Options
The left side panel includes additional toggle menu options, including Document Summary, Navigation Map, Input Controls, and User Prompt Input. Document Summary details the properties of the Web Intelligence document. The Navigation Map shows the sections of the document, including the content on each report tab. The Input Controls (which were discussed in Chapter 10) let you specify values or move selectors to change the content of the report. This option is available only if this feature has been enabled and set up by the report designer. The User Prompt Input box, which is shown in Figure 16.21, shows the prompt values and enables you to change the prompt values to refresh a report.









16.6    Summary
The BI Launch Pad portal provides a multifunctional interface for the casual user to organize, view, print, and share Web Intelligence documents. Additional features discussed in Chapter 18 (such as tracking data changes and robust search capabilities) make the BI platform interface a powerful tool for collaboration across the business. Next, we'll discuss SAP BusinessObjects BI workspaces.








17    Using Web Intelligence with SAP BusinessObjects BI WorkspacesUsing BI workspaces, users can create multitabbed dashboards that combine multiple types of SAP BusinessObjects BI content.The BI workspaces web application gives you capabilities to create multitabbed workspaces to organize related objects from the SAP BusinessObjects BI platform for an integrated viewing experience. BI workspaces can combine SAP Crystal Reports, SAP BusinessObjects Analysis for online analytical processing workspaces, Web Intelligence documents, and dashboards with agnostic content such as static text, HTML, or web pages external to the SAP BusinessObjects BI platform. You can also integrate existing BI workspaces into new BI workspaces. Once created, BI workspaces can be accessed on demand or set as the default Home tab to be seen when users log on to the BI Launch Pad.This chapter explores the BI workspaces application and shows you how to combine Web Intelligence documents and report parts into a single, cohesive BI workspace.
Note
In versions prior to SAP BusinessObjects BI 4.x, the BI workspaces application was known as the Dashboard Builder.

17.1    Introducing BI Workspaces
The BI workspaces application can be launched from the Applications menu in the BI Launch Pad, as shown in Figure 17.1.

Figure 17.1    BI Workspace on the BI Launch Pad Applications Menu
Within the BI workspaces application, there is a large canvas for laying out the design of the workspace. At the top of the canvas, you'll find the BI workspaces toolbar. On its left side is the Module Library. In the next sections, you'll explore how to use the BI workspaces toolbar and the Module Library to add content to the workspace canvas.
17.1.1    BI Workspaces Toolbar
The BI workspaces toolbar appears across the top of the BI workspaces application, as shown in Figure 17.2, and includes the following options:


NewCreates a new BI workspace.
                

OpenOpens an existing BI workspace.
                

SaveUpdates the repository with the latest BI workspace changes.
                

Save AsSaves a new BI workspace with a different name or location than the original.
                

Show Module LibraryOpens the Module Library sidebar.
                

Revert ChangesReturns the BI workspace to the last saved revision.
                

Content LinkingEnables content linking between different modules in the BI workspace.
                

LayoutOrganizes the canvas by columns, template, or freeform layout.
                

Exit Edit ModeExits the Edit Mode (any unsaved changes will be lost).
                


Figure 17.2    BI Workspaces Toolbar

Note
Other options appear on the toolbar depending on which layout (column, template, or freeform) is chosen.

A BI workspace consists of a primary, or Home, tab. This Home tab can be extended with a series of tabs and subtabs, permitting a two-layer hierarchy to be constructed, as shown in Figure 17.3.

Figure 17.3    Two-Layer Hierarchy
The options for each tab or subtab can be modified by right-clicking on the desired tab or subtab. There are five options, as shown in Figure 17.4:


RenameRenames the current tab or subtab.
                

DuplicateDuplicates the current tab or subtab.
                

DeleteDeletes the current tab or subtab.
                

PropertiesModifies the properties of the current tab or subtab.
                

Set as defaultSets the current tab or subtab as the default, meaning it will appear first when the user selects BI Workspace.


Each tab or subtab can display multiple objects from the SAP BusinessObjects BI platform. Three different layout options are available from the BI workspaces toolbar: Column layout, Template layout, and Freeform layout.

Figure 17.4    Tab Options
Column layout, shown in Figure 17.5, organizes the content into multiple columns for an orderly appearance.

Figure 17.5    Column Layout
Template layout, shown in Figure 17.6, provides several predefined templates with options for either rows or columns.

Figure 17.6    Template Layout
Freeform layout, shown in Figure 17.7, offers the most flexibility of the three layout options. BI workspace authors can choose a visible grid to assist with module placement and can even choose to snap modules to the grid lines for better organization.

Figure 17.7    Freeform Layout
The BI workspaces Module Library is a left-hand pane found underneath the BI workspaces toolbar.
17.1.2    BI Workspaces Module Library
The Module Library offers six different sources of business intelligence content: templates, BI Launch Pad modules, public modules, private modules, BI workspaces, and Document Explorer. Let's explore each of these now.
Template Modules
The five types of templates that can be used with the BI workspace are shown in Figure 17.8:


GroupProvides a box outline. This outline can improve the appearance of other modules.
                    

Navigation ListCan be used as a table of contents. It can be paired with a Viewer module using module variables.
                    

Text ModuleDisplays either plain text or formatted HTML. Text modules are useful for documentation or navigation when neither presently exist on an external web page.
                    

ViewerDisplays content from the SAP BusinessObjects BI platform, such as a Web Intelligence document. Content can also be selected using the Public and Private modules, which are covered later in this chapter.
                    

Web Page ModuleDisplays the contents of a web page. An example is the contents of a corporate intranet such as a help page.
                    


Figure 17.8    Template Modules in the Module Library
BI Launch Pad Modules
The modules available from the BI Launch Pad Modules tab should be familiar to even the most casual SAP BusinessObjects user, as they appear on the default Home page tab in the BI Launch Pad. The following modules are shown in Figure 17.9:


Collaboration FeedDisplays custom SAP Jam or SAP StreamWork home page, if these features are configured by your SAP BusinessObjects BI administrator.
                    

My AlertsDisplays alerts from the SAP BusinessObjects BI platform.
                    

My ApplicationsDisplays icons for applications if the user has rights to access them.
                    

My InboxDisplays the contents of the user's BI Inbox.
                    

My Recently Run DocumentsDisplays documents recently run (or, in other words, scheduled) by the user.
                    

My Recently Viewed DocumentsDisplays documents recently viewed by the user.
                    

SAP StreamWork feedDisplays the user's SAP StreamWork feed (requires SAP StreamWork to be integrated with the SAP BusinessObjects BI platform).
                    


Figure 17.9    BI Launch Pad Modules in the Module Library
Public Modules
As shown in Figure 17.10, the Public Modules tab displays all of the Business Intelligence content available from the public folders. To access them, simply navigate to the desired public folder, identify the desired module, such as a Web Intelligence document, and drag it to the BI workspace canvas.

Figure 17.10    Public Modules in the Module Library
Private Modules
The Private Modules tab of the Module Library, shown in Figure 17.11, displays the modules present in the BI workspace author's personal folders, such as eFashion and eStaff and eFashion Expert Excel. These modules can only be used for personal BI workspaces that will be saved in the user's personal folders because other users don't have sufficient rights to private modules to use them.

Figure 17.11    Private Modules in the Module Library
BI Workspaces
Tabs and subtabs from other BI workspaces can be reused by choosing them from the BI Workspaces tab in the Module Library, as shown in Figure 17.12. In this example, you can see that a single BI workspace, named Category, exists in the repository. That BI workspace contains three tabs (Category Summary, Category Detail, and Category Chart), which can be added to the currently open BI workspace canvas.

Figure 17.12    BI Workspaces in the Module Library

Note
We strongly recommend that you replace default module names in BI workspaces with meaningful names. This action will make it easier for other BI workspace authors to find useful preexisting content for their own BI workspaces without reinventing the wheel.

Document Explorer
The Document Explorer tab in the Module Library, shown in Figure 17.13, provides an easy way to add an entire public folder to a BI Workspaces tab or subtab. Document explorers for personal lists, such as the BI Inbox or Query Panel, are also available.

Figure 17.13    Document Explorer in the Module Library
17.1.3    Setting BI Workspaces Preferences in the BI Launch Pad
Only a single setting, Default Style, is available in the BI Launch Pad preferences, as shown in Figure 17.14.

Figure 17.14    BI Workspaces Preferences in the BI Launch Pad
Several of these styles are carried over from previous versions of the SAP BusinessObjects BI platform for backward compatibility, so the appearance is outdated. You might prefer the newer BI Launch Pad style for new BI workspaces.
17.1.4    Setting Web Intelligence Preferences in the BI Launch Pad
The ability to include a single report part from a Web Intelligence document is a useful feature of Web Intelligence that will be explored later on in the chapter. It's important to choose the html viewer (View setting) in the Web Intelligence preferences (see Chapter 1, Section 1.3), because the Java Applet viewer doesn't permit the selection of report parts, but it makes no difference to the BI workspaces application which version of Web Intelligence is used to create and modify Web Intelligence documents (Modify setting).









17.2    Working with Modules
The BI Launch Pad application menu also offers an application to create modules; this Module application is shown in Figure 17.15.

Figure 17.15    BI Launch Pad Module Application
Two types of modules can be created in this manner: text modules and compound modules. Let's take a closer look at both of these.
17.2.1    Text Modules
Text modules can contain either plain text or formatted HTML. They can be useful for annotating BI workspaces with simple documentation or hyperlinks to locations outside of the SAP BusinessObjects BI platform when a preexisting web page that performs those functions doesn't exist.
To begin, chose Text Module from the New Module tab, as shown in Figure 17.16.

Figure 17.16    Text Modules and Compound Modules
Next, choose either Regular (plain) or HTML text, which has been selected in Figure 17.17.

Figure 17.17    Creating a Text Module Using HTML
The formatted HTML, shown in Figure 17.18, can be saved as a module in a personal or public folder.

Figure 17.18    Viewing a Text Module Using HTML
17.2.2    Compound Modules
In contrast to text modules, a compound module is a simplified BI workspace that doesn't contain tabs and subtabs. Compound modules are useful for reusing content in multiple tabs or subtabs of the same BI workspace or even across multiple BI workspaces. For example, it may be beneficial to create a compound module containing corporate branding elements for BI workspaces.









17.3    Working with Web Intelligence Report Parts
Although entire Web Intelligence documents can be placed inside a viewer on a BI workspace, it can be more effective to place a single report part (either a table or chart) on a single tab or subtab. In this section, you'll see how to place a tag cloud chart from a Web Intelligence document on a subtab of an existing BI workspace (see Figure 17.19).

Figure 17.19    Web Intelligence Document with a Tag Cloud Chart
The existing BI workspace is called eFashion BI Workspace. As shown in Figure 17.20, it already contains a tab named Party Pants with a subtab named Bubble, which is where the bubble chart report is found. To begin editing an existing BI workspace, click on the Edit BI Workspace button in the top-right corner.

Figure 17.20    Editing an Existing BI Workspace
Next, add a new subtab next to the Bubble subtab by clicking on + Add a new subtab, as shown in Figure 17.21.
Next, assign the subtab a name by replacing the default text "New subtab," shown in Figure 17.22. In this example, the new subtab is named "Tag Cloud."

Figure 17.21    Adding a New Subtab

Figure 17.22    Naming the New Subtab
The next step is to choose the layout of your new subtab. This example uses the Freeform layout, as shown in Figure 17.23.

Figure 17.23    Choosing the Layout
Next, you need to choose the Public Modules tab from the Module Library. In this example, we navigate to the public folder BI Workspaces and drag the Party Pants Summary Web Intelligence document from the Module Library to the BI workspace canvas, as shown in Figure 17.24.

Figure 17.24    Dragging Desired Web Intelligence Document to BI Workspaces Tab
By default, the entire Web Intelligence document is placed on the subtab. However, we prefer to select a single report part (a tag cloud chart), which is located on a Web Intelligence report tab named Tag Cloud. Right-click on the desired chart and choose Select this report part from the menu, as shown in Figure 17.25.

Figure 17.25    Right-Clicking on the Desired Report Part
The report part is now part of the BI Workspaces subtab. Notice that, by default, the subtab is labeled with the name of the Web Intelligence document, Party Pants Summary, as shown in Figure 17.26. To modify this label and other properties, click on the Edit (wrench) icon in the top-right corner of the subtab.
When you edit the report part, you'll find that module properties are located on two tabs: Content and Layout (see Figure 17.27). On the Content tab, notice that the Display Mode is set to Selected Report Part. Notice that the report content can be loaded on demand, from the latest instance (selected), or from the latest instance of a specific user. This functionality allows the BI workspace designer to take advantage of Web Intelligence documents that were previously scheduled—a useful feature particularly for long-running Web Intelligence documents.

Figure 17.26    Editing the Report Part

Figure 17.27    Review Properties on Content Tab
On the Layout tab, you can change the default title (the Name of the Web Intelligence document). The example shown in Figure 17.28 shows the title changed to "My Tag Cloud."

Figure 17.28    Modify Properties on Layout Tab
After all modifications are complete, click on Exit Edit Mode in the top-right corner of the BI Workspaces subtab, as shown in Figure 17.29.

Figure 17.29    Exit Edit Mode
To finish, click on the Save icon on the BI workspaces toolbar to update the BI workspace with all modifications, as shown in Figure 17.30.

Figure 17.30    Saving Changes on the BI Workspaces Toolbar
You'll receive a message indicating that the BI workspace was saved, such as the one shown in Figure 17.31.

Figure 17.31    Saved BI Workspace









17.4    Using a BI Workspace as the Default Home Tab
If desired, you can replace your default Home tab with a custom BI workspaces tab. To begin, open the BI Launch Pad Preferences. The General tab is active by default. Uncheck the Use Default Settings (Administrator defined) box and choose Select Home tab from the Home tab menu. Next, click on the Browse Home Tab button, as shown in Figure 17.32.

Figure 17.32    Setting a Custom Home Tab in BI Launch Pad General Preferences
Next, browse to the folder containing the desired BI workspace. For our example, we've selected the eFashion BI Workspace from the public folder BI Workspace, as shown in Figure 17.33.

Figure 17.33    Selecting Content for a Custom Home Tab
Notice that the selected BI workspace appears in the General Preferences screen, as shown in Figure 17.34. Save and close the BI Launch Pad Preferences.

Figure 17.34    Workspace Selected as a Custom Home Tab
The user will see the customized Home tab the next time he logs on to the BI Launch Pad, as shown in Figure 17.35.

Figure 17.35    BI Workspace as the New Default Home Tab









17.5    Printing BI Workspaces
BI workspaces can now be printed using SAP BusinessObjects BI 4.1 or higher. Simply click on the Printer icon in the top-right corner of a BI workspace (see Figure 17.36).

Figure 17.36    Printing BI Workspaces
Choose whether to print the current tab or all tabs of the BI workspace (see Figure 17.37). Change your printer settings to Landscape.

Figure 17.37    Printing Options









17.6    Content Linking
Using a feature called content linking, you can allow modules in your BI workspace to communicate. In this example, you'll see how to create three Web Intelligence reports and link them together in a single BI workspace.
The first report, Category Summary, will display a list of categories and will be the source content (see Figure 17.38).

Figure 17.38    Creating a Source Document
The next two Web Intelligence documents will define prompts so they can receive a user selection from the source report. The Category Detail report will display a table (see Figure 17.39).

Figure 17.39    Creating a Target Document with a Prompt
The Category Chart report will display a chart. Notice that both reports prompt on the Category object (see Figure 17.40).
This example defines a two-column layout, placing the Category Source report part in the left column, and the Category Detail and Category Chart report parts in the right column (see Figure 17.41).
To connect these three Web Intelligence reports, click on the Content Linking button on the toolbar. A pop-up window showing a graphical representation of the reports will appear at the top of the window. Using the mouse, connect the output (Parameters_Out) of the Category Source report to the inputs (Prompt_In) of the Category Detail and Category Chart reports.

Figure 17.40    Creating a Second Target with a Prompt

Figure 17.41    A Two-Column Layout with All Three Web Intelligence Reports
Next, at the bottom of the screen for each source/target combination, map the parameters by selecting the Web Intelligence prompts as Target parameters for the Source parameter (Category) in the Category Source Report (see Figure 17.42).

Figure 17.42    Content Linking Pop-Up
Close the Content Linking pop-up window, save the BI workspace, and choose Exit Edit Mode. Clicking a desired category in the Category Source report will cause both the Category Detail and Category Chart report parts to refresh using that category as their prompt values. Choosing Casual Dresses (see Figure 17.43) and Party Pants (see Figure 17.44) will show different results.
The content linking feature is not limited to Web Intelligence and can be used to link SAP Crystal Reports and dashboards, too.

Figure 17.43    A Selection in the Category Summary Updates the Category Detail and Category Chart (Casual Dresses)

Figure 17.44    A Selection in the Category Summary Updates the Category Detail and Category Chart (Party Pants)









17.7    Summary
The BI workspaces application provides you with a powerful way to mash up multiple types of content into a cohesive user experience within the BI Launch Pad. Although this book focuses on Web Intelligence, BI workspaces can additionally contain SAP Crystal Reports, SAP BusinessObjects Analysis for online analytical processing workspaces, dashboards, and content such as web pages from outside the SAP BusinessObjects BI platform.
You can customize the login experience for BI Launch Pad users and replace the default Home tab with a BI workspace.
By using content linking, you can create interactive BI workspaces that accept input choices that update the data displayed by various BI workspace modules. The next chapter explores interaction from a user's perspective.








18    Interaction from a User's PerspectiveBI Launch Pad and Web Intelligence propose many functionalities to simplify adoption of users who do not create documents but simply consume them. Hyperlinks, search, discussions, comments, and tracking data changes are common, but powerful capabilities for an enterprise platform to help ease navigation, interaction, and collaboration.As a Web Intelligence document designer, you can take advantage of BI platform capabilities to add interaction to your document. Such interaction can ease navigation of your readers who don't develop their own documents but refresh canned reports you have already created and prepared for them within the SAP BusinessObjects BI platform.In BI Launch Pad, you can create shortcuts and hyperlinks, complete powerful searches, sort and filter content, and leverage discussions regarding reports. In Web Intelligence, in addition of viewing and refreshing the document, you can comment its content and create alerts to visually identify data changes at a glance when a query is refreshed with track data changes within reports.This chapter explores these functions, starting with shortcuts and hyperlinks.
18.1    Creating Shortcuts and Hyperlinks
One method of organizing content within BI Launch Pad is to create a hyperlink or a shortcut to another location or document. This enables quick collaboration and ease of updating a report without having to update numerous copies of the same report.
18.1.1    Shortcuts
Creating a shortcut can help organize documents that are viewed by different security profiles without having to maintain numerous copies of the same report.
To create one, you can select the report and then select Copy Shortcut from the Organize menu on the BI Launch Pad toolbar, as shown in Figure 18.1. You can then navigate to the folder location to paste the shortcut. Another option is to select Create Shortcut in My Favorites from the Organize menu when selected on a document. This will automatically create a shortcut to the selected document in your My Favorites folder. Both of these options are also available from the right-click menu when the report name in the workspace is selected.

Figure 18.1    Shortcut Command from the Organize Menu
18.1.2    Hyperlinks
Hyperlinks can be helpful in sharing online help resources or internal help resources for quick reference. You can create hyperlinks within BI Launch Pad to reference other important web pages or information resources. To create a hyperlink, select the New button on the BI Launch Pad toolbar and choose the Hyperlink option from the dropdown menu, as shown in Figure 18.2.

Figure 18.2    Hyperlink Command from the New Menu on the BI Launch Pad Toolbar
A box will appear to enter the properties, URL address, and categories for the hyperlink, as shown in Figure 18.3. The hyperlink will appear as an object in the designated folder, categories, or both.

Figure 18.3    Hyperlink Properties
Shortcuts and hyperlinks provide enhanced functionality for organizing content within the BI Launch Pad. Additional features are available within this environment to enable more robust data analysis for the report customer. Now let's dive into searching within the BI Launch Pad.









18.2    Searching within the BI Launch Pad
Web Intelligence documents, SAP Crystal Reports, Microsoft Excel, Word, PowerPoint, RTF, PDF, and text files are all searchable if they are contained within the BI Launch Pad environment. The metadata of additional object types are also searchable. The files that you can search depend on your access rights. The data regarded by a search is different for each document type.
18.2.1    Running the Search
Searches are performed within BI Launch Pad from the Search text field in BI Launch Pad left right corner or in Documents tab in the Search drawer, as shown in Figure 18.4.

Figure 18.4    Search Box in the Search Drawer (on the Left) and Top Right Corner
The Search text field allows you to locate words. The search can be enriched with one of the techniques described in Section 18.2.3. If you pause while typing in the search box, the quick search functionality is prompted, and the top six matches are displayed, as shown in Figure 18.5.

Figure 18.5    Quick Search
When you finish typing your search criteria, press the Search icon . The search results are shown in the List Panel in the right side on the panel and additional facets appear in the Search drawer, as shown in Figure 18.6.

Figure 18.6    Search Results
Facets are pertinent grouping based on attributes in the documents found by the search that provides further filtering of your search content. The following facets may appear:


                    Location
                

                    Type
                

                    Refresh time
                

                    Author
                

                    Data sources
                

                    Categories
                

To view a result, double-click the object link in the List Panel or click on a facet in the Search drawer and double-click the generated object link. When the document opens, the viewer will scroll to the location of the first match to your search criteria.
18.2.2    Searchable Object Types
A large number of object types are available for search within the BI Launch Pad. There are also a number of attributes that are searched within your commonly consumed document types, which provide thorough search capabilities:


                    Web Intelligence documents
                    

                            Report title
                        

                            Report description (as defined in report properties)
                        

                            Universe filter names
                        

                            Universe object names
                        

                            Data contained in the report as saved data
                        

                            Constants in filter conditions that are defined in a document
                        

                            Static text contained within the report
                        



                    SAP Crystal Reports
                    

                            Report title
                        

                            Report description (as defined in report properties)
                        

                            Selection formulas
                        

                            Data contained in the report as saved data
                        

                            Text fields
                        

                            Parameter values
                        

                            Subreports
                        



                    Microsoft Excel and Word documents
                    

                            Data
                        

                            Document properties
                        

                            Header and footer text
                        

                            Numerical values
                        

                            Calculation or formula values (Excel only)
                        

                            Date/time values (Excel only)
                        



                    Document types with text-only searchable content
                    

                            Rich Text Format (RTF)
                        

                            Portable Document Format (PDF)
                        

                            Microsoft PowerPoint
                        

                            Text files (TXT)
                        



                    Document types with metadata-only searchable content
                    

                            Agnostic objects
                        

                            Analysis views
                        

                            BI workspaces
                        

                            Dashboards objects
                        

                            Discussions
                        

                            Events
                        

                            Adobe Flash objects
                        

                            Hyperlinks
                        

                            Lifecycle management console jobs
                        

                            Metadata from Information Design Tool
                        

                            Modules
                        

                            Object packages
                        

                            Profiles
                        

                            Program objects
                        

                            Publications
                        

                            Queries from Query as a Web Service


                            Universes
                        

                            Widgets
                        

                            Workspaces created in SAP BusinessObjects Analysis for online analytical processing




18.2.3    Search Techniques
There are certain recommended techniques to use when searching content within the BI Launch Pad. For example, separate search terms using spaces, which implies the AND separator. Table 18.1 defines the key techniques.




                            Technique
                        

                            Description
                        





                            Space
                        

                            Space between words implies the AND separator (e.g., sales revenue).
                        



                            Asterisk *
                        

                            Asterisk returns results with any number of characters in its place (e.g., 19*).
                        



                            Question mark
                        

                            Question mark represents a single character (e.g., Sm?th).
                        



                            Quotation marks
                        

                            Quotation marks are used to indicate an exact phrase that should be found in the documents returned by the results (e.g., "sales revenue").
                        



                            Plus sign +
                        

                            Plus sign forces the inclusion of a search term (e.g., sales + revenue).
                        



                            Minus sign -
                        

                            Minus sign removes results that have the indicated term (e.g., sales - revenue).
                        



                            OR
                        

OR returns results when the word before or after the word "or" is found in the document (e.g., income OR profit statement).
                        



Table 18.1    Search Techniques
You can perform attribute searches by typing the name of the attribute with a colon and then the term to be searched. You may also combine search techniques from the preceding table for more specific results.









18.3    Sorting and Filtering Content
Objects within BI Launch Pad are sorted alphabetically by title. Of course, your access to the content depends on whether you have the appropriate rights to view in each folder or category. It may be useful to customize these views to sort by different criteria or filter for your desired results.
Selecting the column heading re-sorts the list by that heading in ascending order. Selecting the heading again sorts the list in descending order. When you hover over a column heading, you'll notice that the Filter icon  appears.
Click the icon to filter the content in the list. Depending on the column name, the filter options differ:


                For the Title column, you may type a filter mask, as shown in Figure 18.7.
            

                For the Type column, you may select the document type to display through the corresponding checkboxes, as shown in Figure 18.8.
            

                For the Last Run column, you may select the start and end date of the document's last refresh, as shown in Figure 18.9.
            


Figure 18.7    Filter Option in Title Column

Figure 18.8    Filter Option in Type Column

Figure 18.9    Filter Option in Last Run Column
After applying the filter, the filtered results will only display in the list view. To remove the filter:


                For the Title and Last Run columns, click the Filter icon in the title bar again and select the Clear Filter checkbox, then click OK.
            

                For the Type column, click the Filter icon in the title bar again and select the All Types checkbox.
            










18.4    Creating Discussions
You can create discussions for BI platform documents to post document-relevant information. These discussions can be organized in threads or as notes in a document.

Enabling Discussions
Discussions are disabled by default. To be created against your Web Intelligence documents in the BI Launch Pad, you must enable them in the Central Management Console (CMC), in the BI Launch Pad application properties, by selecting the Enable Discussions checkbox.

Let's see how to add notes and contribute to threads in discussions.
18.4.1    Notes
Discussions are located in BI Launch Pad within the Details panel of the selected document.
To open this panel, in BI Launch Pad, select the Documents tab, then click Details in the toolbar. The panel opens in the left side of your browser. Select the Discussions drawer at the bottom of the Details panel to view the notes and discussion threads.
To add a note, select the New Message icon and type the Subject and Message as relevant. You may also change the level of importance to High or Low, which will create a flag indicator on the note, as shown in Figure 18.10.
You can edit notes you've created by selecting an existing note and making any modifications to the previous text as necessary. If a note has replies in a discussion thread, then you may no longer modify it unless you have administrative rights. The same is true for deleting a note, which you do by clicking the Delete icon.
18.4.2    Discussion Threads
You can create a discussion thread by replying to an existing note, as shown in Figure 18.10.

Figure 18.10    Discussion Thread
After selecting a note, you have the option to reply to group or reply to sender. The Reply to Group option makes your response visible to everyone, while the Reply to Sender option displays your comments to only the sender of the note. After completing your comments and selecting Post, the note will display in the hierarchy of the conversation. The plus sign + indicates that there is a discussion thread associated with a note.









18.5    Commenting Documents
In addition to discussions seen before, since SAP BusinessObjects BI 4.2, Web Intelligence includes the ability to add comments to documents. Compared to the discussions whose granularity is the document, comments allow you to drill into the comment and directly comment the document content.
This ability requires your administrator to set up an external database, where the comments are stored. By default, this comment database is the audit database, but your administrator can change it in the CMC.
When you open a document, Web Intelligence checks in the database if comments exist for this document. If this is the case, these comments are retrieved so you can see them when the document is displayed in Web Intelligence.
There are two types of comments:


Document comment, which is integrated in the document itself. 
                You need to be in Design mode to add a document comment, since you are modifying the document structure. This comment is added in the document through a new cell type containing the text comment. As for any cell (see Chapter 5, Section 5.4), you can modify its properties—size, position, background color, font, and so on—to define how the comment must look in the document.
                When you print the document, the cell and the comment it contains are printed as well.
            

Block or cell comment, which is created on top of an existing cell or block and associated with it. 
                This comment does not modify the document and you can add these comments in Reading or Design mode. It is not displayed in the document but an icon shows that the cell or block has been commented. When you hover your mouse on this icon, a pop-up message with the comment appears, as seen in Figure 18.11.
            


Figure 18.11    Comment Added on a Cell and Displayed When Hovering the Mouse
These comments are contextual, meaning they are associated with the data in the commented cell or block. When you refresh the document, if the data is no longer in the data set, the comment is not available. If the data is back after a new refresh, then the comment becomes available again.
As the comments rely on a service provided by the BI platform, they are not available in Web Intelligence standalone or offline modes:


                In these modes, it is not possible to add a new comment.
            

                If a document has already been commented, its comments are not displayed in offline mode.
            

When you save a document under a different name, this creates a copy of the document. Its comment are not saved in this copy by default. In the Save Document dialog box, if you select the Save document with comments option, these comments are duplicated in the comments database for this new document and are hence also available for it.
18.5.1    Adding Comments
To comment a document, you must have first saved the document in the BI Platform repository, since the comments are identified through the ID of the document in the comment database. Then, the steps to follow depend on the comment type to add, as well as whether you are creating a new comment or answering an existing one, as described in the next sections.
Document Comment
To add a comment in the document, follow these steps:


                        In Design mode, in the Report Elements toolbar, select the Comment • Insert Comment Cell button or the Cell • Pre-Defined • Comment command.
                    

                        Click the report at the desired location to position your comment. (You can exit this insert mode by pressing the (Escape) key.)
                        You can also add the cell for the comment by right-clicking in the report and, in the contextual menu, selecting the Insert • Comment command.
                    

                        If it was not yet open, the Comments side panel opens.
                    

                        Type your text into the Comment on the selected item text field.
                    

                        Click OK to validate it. Your text is displayed in the comment cell, as shown in Figure 18.12.
                    

                        Save your document to keep this document's change.
                    


Figure 18.12    Comment Inserted in a Document
Cell or Block Comment
To add a comment on a cell or a block, follow these steps:


                        In Reading or Design mode, right-click the cell or the block to comment.
                    

                        In the contextual menu, select the Comment command.
                    

                        If it was not yet open, the Comments side panel opens.
                    

                        Type your text into the Comment on the selected item text field.
                    

                        Click OK to validate it.
                    

                        The comment is then saved in the comment database. An icon ( or ) is displayed on the top-right of the cell or the block to highlight it. Hovering the mouse over this cell or block opens a window to show this comment, as seen in Figure 18.11.
                    

There is no need to save the document since the comment is saved in the comment database and the document itself is not modified.
Replying to Comment
A document, block, or cell comment can be seen as a discussion where several users can exchange. This is done by replying after the last posted message; the last reply is added to the end of the discussion. To reply to a comment, follow these steps:


                        In Reading or Design mode, go to the Comments side panel.
                    

                        In your report, select a document comment or a commented cell or block. In the Comments side panel, the comment is displayed, and under it, is a new text field, Add a comment.
                    

                        In this text field, type another message to answer the previous comment. This new text is added to the comment thread, as seen in Figure 18.13.
                    

                        In Web Intelligence document property (see Chapter 2, Section 2.6), the Comment displayed in the Report Comment property defines which message of the thread must be displayed in the comment and shown in the report.
                        

                                If it is set to The last comment in the thread, which is the default value, then the last message is displayed in the comment.
                            

                                Otherwise, if it is set to The first comment in the thread, then the first message of the thread will always be displayed in the comment.
                            




Figure 18.13    Discussion through Comments

Document Comment
Although you must to be in Design mode to add a document comment, this is not the case to reply to a document, block, or cell comment. You can be either in Reading or Design mode.

Through this comment mechanism, several people can exchange document content and read this discussion in the Comments side panel. As described in next section, this side panel has also some more general purposes.
18.5.2    Managing Comments
In the Comments side panel, you can read and add comments, as well as manage them:


                    You can delete a specific message in the thread by clicking the Delete Comment icon beside the message to delete.
                

                    On top of the side panel, you can click Copy all to open a dialog box containing the whole thread in text format. You can copy it completely or only partly in the clipboard and paste it in another application.
                

                    You can edit a comment by clicking it and modifying its text. Click OK to confirm the change.
                

18.5.3    Comments Function
To enforce comments, a new function, Comment, has been introduced in Web Intelligence language formula (see Chapter 11, Section 11.2). When you add a comment through a predefined cell, its text is saved in the comment database. The cell contains only a call to this function that retrieves the text from the database and displays it in the cell. The returned text is the first or the last comment, depending on the value of the Comment displayed in the Report option you selected for the document (Section 18.5.1).

Annotating Tables
This function can be used to annotate a table. In Design mode, add a column to your table. In its definition, simply add =Comment() then save your document. Now, in Reading mode, any user can select a cell in this extra column and type a comment. The comment will then be displayed in the table, as seen in Figure 18.14.

Figure 18.14    Additional Column to Display Cell Comments

In the comment database, comments are saved with the document CUID and a path that identifies the commented cell or block. The table containing the comments has four extra columns you can customize for your own use if you have access to the comments database and the right to write in it:


                    These column names are OptionKey1, OptionKey2, ..., OptionKey4.
                

                    You can fill the column cell with any content and assign a value for each comment. Setting these values can be done programmatically through another application.
                

You can use these columns to define a conditional display through two optional arguments this function supports:
Comment("ColumnName";"Text"), where:


"ColumnName" is the name of one of the four extra columns.
                

"Text" is the string to check in this column for this comment.
                

The function returns and displays the text in the cell, only if the string "Text" is found in the extra column "ColumnName".

Comments Conditional Display
Comment("OptionKey1";"Yes") displays the comment only if the text "Yes" is found in the column "OptionKey1". Comment() always displays the comment.

This conditional display requires you to access and write into the database. But it offers powerful capabilities to implement workflows around documents with the comments.









18.6    Tracking Data Changes
The ability to track data changes is an exciting feature in Web Intelligence. This functionality enables you to easily pinpoint changes to data to make informed decisions in a timely manner.
Reference data is chosen during setup and used to base the changes; these are highlighted in your reports based on your selections. Many viewing options can be modified to customize the appearance of data values that have changed when a report is refreshed.
The following data changes can be tracked within a Web Intelligence report, as shown in Figure 18.15:


                Inserted data


                Removed data


                Modified data


                Increased data


                Decreased data



Figure 18.15    Sample Report with Data Tracking
You can also use formulas and functions within Web Intelligence and build custom alerts to highlight changed data.

Incompatible Actions
The following actions are incompatible with data tracking:


                    Drilling out of scope
                

                    Query drilling
                

                    Deleting a query
                

                    Making any changes to the SQL generated by the data provider
                

                    Modifying security rights that will affect the SQL generated
                

                    Purging the document data
                

                    Refreshing on open (prior data is purged when the document is refreshed on open)
                


The setup of the reference data and display of the changes is completed from within Web Intelligence.
18.6.1    Setting Reference Data
When you enable tracking of data changes, you select a particular data refresh as your reference point. This data is known as your reference data. If you make changes to your data provider, the reference data is lost, and consequently, data tracking won't be available. These actions enact changes that will cause the current version of the document to be incompatible with the reference data, making data tracking misleading.
Data tracking is toggled on or off by clicking the Track button, which is located:


                    In Reading mode, in the Report Panel toolbar.
                

                    In Design mode, on the Data Tracking subtab, which is found on the Analysis tab in the Report Panel (see Figure 18.16).
                


Figure 18.16    Track Button in Design Mode
To set reference data, select the Data Tracking subtab from the Analysis tab in Design mode. Then, click the Track button to display the Data Tracking dialog box, which displays the options to either compare with last data refresh or compare with a specific refresh date instance, as shown in Figure 18.17:


Compare with last data refresh: The data existing before the last refresh becomes the reference data.
                

Compare with data refresh from: You can select among several recent refresh dates from a dropdown menu. The data selected becomes the reference data and remains the reference data after each refresh regardless of the number of times the data is refreshed. The newly refreshed data is tracked against the fixed reference data.
                

Data tracking can be applied to every report in a Web Intelligence document or to only specific report tabs. It's common for one tab to have data tracking enabled, but all other tabs to have data tracking disabled. Other scenarios require that all tabs have data tracking enabled. In the Reports with data tracking shown section, you can define which reports should show data tracking.

Figure 18.17    Data Tracking Options Dialog Box
Check Refresh data now to refresh the query immediately after clicking on OK.

Icon for Report with Track Data Changes
As seen in Figure 18.18 for Report 1, an asterisk appears on the report tab when changed data tracking is activated on the report.

Figure 18.18    Dedicated Icon for Report with Track Data Changes

18.6.2    Formatting Changed Data
The default setting for the formatting of changed data is defined by the SAP BusinessObjects administrator in the CMC. You can overwrite these defaults by setting your formatting within the Data Tracking Options  dialog box. Select the Options tab to specify your formatting dependent on the type of changed data. Figure 18.19 shows the options available in the Data Tracking Options dialog box.
The following changes are available for configuration of formatting:


                    Inserted dimension and detail values
                

                    Deleted dimension and detail values
                

                    Changed dimension and detail values
                

                    Increased measure values
                

                    Decreased measure values
                

Changed data is displayed differently in blocks, sections, breaks, charts, and reports with merged dimensions.
You can launch the Data Tracking Options dialog box by clicking on the button to the right of the Hide/show changes tracking button on the default toolbar in the Report Panel. Formatting can be applied to modify a variety of font- and background-related attributes. Figure 18.19 shows the five options to visually display data changes: Insertions, Deletions, Changes, Increased values, and Decreased values.

Figure 18.19    Data Tracking Formatting Options
With these settings in mind, let's see how they impact document displayed content.
Displayed Data in Blocks
If data is removed from a row in a block, deleted data formatting is applied to all cells as defined in the Data Tracking properties. If a measure increases for a row, increased data formatting is applied to the Measure cell. If a measure has decreased, decreased data formatting will be applied to the Measure cell. New data appearing in a block will show inserted data formatting on all cells.
Let's take a look at an example that details how these formatting changes will appear given a block of sample data. The sample reference data in Table 18.2 shows sales revenue by year and by state.




                                Year
                            

                                State
                            

                                Sales Revenue
                            





                                2013
                            

                                Arizona
                            

                                $1,100,000
                            



                                2014
                            

                                Arizona
                            

                                $1,200,000
                            



                                2012
                            

                                California
                            

                                $1,100,000
                            



                                2012
                            

                                New York
                            

                                $1,150,000
                            



Table 18.2    Example Reference Data
The changed data in Table 18.3 shows the comparison data used for the data tracking.




                                Year
                            

                                State
                            

                                Sales Revenue
                            





                                2014
                            

                                Arizona
                            

                                $1,300,000
                            



                                2013
                            

                                California
                            

                                $1,900,000
                            



                                2012
                            

                                New York
                            

                                $1,000,000
                            



                                2014
                            

                                Washington
                            

                                $1,700,000
                            



Table 18.3    Example Changed Data
When data tracking is enabled, the reference and changed data are compared, and formatting is applied to the resulting data block as per the options selected in the Data Tracking dialog box (see Table 18.4).




                                Year
                            

                                State
                            

                                Sales Revenue
                            

                                Formatting
                            





                                2013
                            

                                Arizona
                            

                                $1,100,000
                            

                                [Deleted data formatting on all cells]
                            



                                2014
                            

                                Arizona
                            

                                $1,300,000
                            

                                [Increased data formatting on Revenue cell]
                            



                                2012
                            

                                California
                            

                                $1,300,000
                            

                                [Deleted data formatting on all cells]
                            



                                2013
                            

                                California
                            

                                $1,900,000
                            

                                [Inserted data formatting on all cells]
                            



                                2012
                            

                                New York
                            

                                $1,150,000
                            

                                [Decreased data formatting on Revenue cell]
                            



                                2014
                            

                                Washington
                            

                                $1,700,000
                            

                                [Inserted data formatting on all cells]
                            



Table 18.4    Example with Data Tracking Activated and Results Displayed
Displayed Data in Sections
The data in the section header can be displayed in two ways, depending on whether the entire section data changed or just some of the rows within in the section:


                        If all rows in the section have changed in the same way, the section header format will be the same as all the rows.
                    

                        If only some rows in a section have changed or the rows have changed in different ways, the section header will stay in its default format.
                    

Displayed Data in Breaks
If the Center value across break option is applied to the break in the properties, the same formatting rules apply as with sections:


                        If all rows in the break for the centered value have changed in the same way, the centered break value format will be the same as all the rows.
                    

                        If only some rows in a centered break section have changed or the rows have changed in different ways, the centered break value will stay in its default format.
                    

Displayed Data in Charts
Tracked data isn't displayed within a chart. When data tracking is applied to a chart, an icon will appear above the chart. Select the icon to display the tracked data changes. The chart will be converted to a table to allow you to see the detailed tracked data changes.
Displayed Data in Reports with Merged Dimensions
When using merged dimensions, Web Intelligence doesn't display that a new data element was added to a block unless the data element has been added to all dimensions participating in the merge.
18.6.3    Displaying Tracked Data
After clicking on Track and toggling data tracking on, you'll see that a Show Changes button becomes enabled. This button allows you to either show or hide the data changes found by the data tracking tool without deactivating tracking. After tracking has been deactivated, you won't be able to compare the current data with the reference data.
Figure 18.20 shows the default data tracking formatting when values from the reference point are different from the values in the latest refresh. Different background colors, font colors, and font types can be configured to represent increased values, decreased values, insertions, deletions, or changes.

Figure 18.20    Visible Changes When Tracking Data Changes
Select the Hide Changes/Show Changes button to the right of the Track button on the toolbar in Report mode or the BI Launch Pad viewer toolbar to display tracked data.
18.6.4    Advanced Tracking Techniques
Several functions are available in the Web Intelligence language formula (see Chapter 11, Section 11.2) to perform advanced techniques with the data tracking functionality:


RefValue returns the value of the reference data.
                

RefValueDate returns the date of the reference data.
                

RefValueUserResponse returns the answer of a specific prompt used to retrieve the reference data.
                

These functions can be used in a formula to find the difference between changed data and reference data. For example:
=[Sales Revenue] - RefValue([Sales Revenue])
If the current refresh returned sales revenue equal to $2.5 million, and the reference data showed sales revenue equal to $1.5 million, then this difference formula would return a result of $1 million.









18.7    Summary
A variety of functionalities are available in Web Intelligence and the BI Launch Pad portal to customize the reading experience to go above and beyond the capability of only reviewing a static report:


                Creating hyperlinks to open other content from Web Intelligence
            

                Searching within the environment for specific content
            

                Sorting and filtering document to narrow down your data set
            

                Managing discussions and commenting on the document content
            

                Tracking data changes to easily identify changes in company data compared to values from a specified reference point
            

For further collaborations in Web Intelligence, the next chapter discusses methods of sharing your Web Intelligence document with other users inside and outside the organization.








19    Sharing Web Intelligence ContentThe core functionality of Web Intelligence involves querying, reporting, analyzing, and sharing information across the enterprise. The ability to share information quickly and easily is vital to successful Business Intelligence reporting. Web Intelligence provides enhanced sharing capabilities for your internal and external audience.So far, you've learned how to create a Web Intelligence report, use advanced query techniques and multiple data providers, create unique charts, and format your report to create the most meaningful output for your audience. Now that your report design is complete, it's time to share your results with others.Web Intelligence provides a variety of ways to distribute and share your reports across an organization. From the enhanced ability to share document content through Web Intelligence shared elements, to the capability to create publications and burst them out for end-user consumption, you have a wide variety of options to share data content with your colleagues from within Web Intelligence or BI Launch Pad.We review these methods within this chapter to give you a thorough understanding of each of the options available to you and focus on publication in the next chapter. Now, let's explore the shared elements.
19.1    Sharing Document Content through Shared Elements
Introduced in SAP BusinessObjects BI 4.2, shared elements are Web Intelligence report elements saved in the BI platform repository. As they are saved in the BI platform repository, any users who have the appropriate security rights can re-use them and add them in their own documents.
Shared elements are available only in the BI platform repository: it is not possible to save them in your filesystem and they are not available in offline or standalone modes.
A shared element is saved with anything required to create it:


                The report element itself and its properties. The report element can be of any type—table, chart, custom element, cell, and so on—but the shared element can contain only one of them.
            

                The report element's format: labels, colors, conditional formatting, and more.
            

                Report elements filters, if any. However, input controls are not included.
            

                The variables used by the report element, if any.
            

                The queries used by the report element and the variables it uses, if any.
            

                Their data source(s). If the report element is based on several data sources, then they are all saved in the shared element.
            

The report element data set is not saved in the shared element.
With shared elements, expert designers can create and save report elements that can be used by casual users who can re-use them to create their documents, rather than re-creating it from scratch.
When a shared element is inserted in the document, a link between this shared element and the document is created. Thanks to this link, when a document is opened, you can check whether a new version of the shared element has been published and, if needed, resynchronize the content of the shared element into the document.

SAP HANA Online Mode
Shared elements are not supported in SAP HANA Online mode (see Chapter 13, Section 13.5), but they are supported in SAP HANA direct access.

Let's review how you can manipulate these shared elements to share your preferred report elements with other users on your BI platform.
19.1.1    Creating Shared Elements
You can save any single report part from your document as a shared element: a cell, a table, or a graph. Shared elements are saved in the BI platform repository, in the Favorites or Public folder or subfolder. To improve visibility of these shared elements, you can organize them in folders with meaningful names or assign them categories.
To create a shared element from a report element in a document, follow these steps:


                    Open the document containing the report element to publish in Design mode.
                

                    Select the report element and, in the Reports Elements • Linking • Shared Element, select the Save As command. You can also right-click this report element and, in the contextual menu, select the Linking • Save as Shared Element command.
                

                    In the Export Element to Enterprise dialog box that opens, select the name of the shared element, its path, and the categories to assign to it. You may also click Advanced to display and change the following options:
                    

Description and Keywords: To more easily identify the shared element.
                        

Remove format: To save the report element without its format.


Link to the current document: To link the shared element to the current document (Section 19.1.3). By default, this created shared element is not linked to the document.
                        



                    Click Save to save the shared element (see Figure 19.1).
                


Figure 19.1    Export Element to Enterprise Dialog Box

Editing a Shared Element
It is not possible to explicitly open and modify a shared element in Web Intelligence. You must re-save it from a document containing the new version of this shared element.

Now you have created a shared element, let's see how others can re-use it in their own documents without having to re-create them from scratch.
19.1.2    Using Shared Elements in Web Intelligence Documents
Shared elements are intended to be added into documents when they are created or edited. When the shared element is inserted in a document, then all its content (report element, query, data source, variable, format) is copied in the document.
Inserting a shared element can be done in Design mode—from the Shared Elements side panel (a new side panel available in Design mode only), from the toolbar, or from the contextual menu, as follows:


                    In the Shared Elements side panel, click the Browse tab to select the shared element to add. You can either explore the BI Platform repository folders in the Folders tab or the categories in the Categories tab. Once you have selected the shared element to add, you can drag and drop it into the report.
                

                    You can also select the Insert command from the toolbar, in Report Element • Linking • Shared Element or the Shared Element command in the Insert submenu in the right-click contextual menu. In both cases, this opens a small box with the shared element icon  that follows your mouse. To exit this insert mode, press the (Escape) key. Click in the report to select where to insert a shared element. The Insert dialog box opens where you can browse into the BI platform repositories by folders or categories to select your shared element. Click Open to add the shared element.
                

The shared element content is copied into the document as follows:


                    The report part is placed where you have clicked.
                

                    All underlying data sources, queries, and variables are copied in the document as well.
                

                    As no data set is saved in the shared element, underlying queries (if any) are run to retrieve data from the data source(s) and feed the report element. If you do not have the appropriate rights for this data source, an error message is displayed.
                

If you add the same shared element several times in the document, then older versions of the shared elements previously added in the document are updated (Section 19.1.4).
19.1.3    Identifying Document Shared Elements
When a shared element is inserted in a document, the created report element is identified as coming from a shared element, and a link between this shared element and the document is created.
There are several ways to find the shared elements linked to a document:


                    In the Shared Elements side panel, the Currently used list displays the shared elements that are linked to the current document, as well as their versions.
                

                    The Document Structure and Filters side panel shows the structure of the document. In this side panel, the Shared Element button can be used to display or hide whether a report element is linked to a shared element. In this case, the name of the shared element is displayed in brackets after the report element name.
                

                    Another method to identify shared element's instance in a document is to click the report element. If the report element is linked to a shared element, then the shared element icon is displayed in the status bar.
                

Let's see now how these links can be helpful.
19.1.4    Updating and Unlinking Shared Elements
When a shared element is inserted in a document, its content is explicitly copied into the document. As this is a copy and not a dynamic reference, the shared element may be modified, but not its copy in the documents where it has been inserted.

Figure 19.2    Shared Elements Used by the Document
The shared elements linked to the document are listed in the Currently used pane of the Shared Elements side panel (see Figure 19.2). The version of the copied shared element content is also displayed. This version help you know when to update a shared element.
The next paragraphs describe how to guarantee the synchronization between the document and the shared elements it uses.
Checking for Updates
By default, when a document linked to shared elements is opened, Web Intelligence checks if the version of the instance copied in the document is still aligned with the one in the BI platform repository. If a shared element version in the BI platform repository is different from the one saved in the document, as shown in Figure 19.3:


                        A green icon  is displayed in the tab of Shared Elements side panel
                    

                        In the Currently used list, the same green icon  is displayed before the shared elements that have been updated in the BI Platform repository
                    

                        The version of this shared element in the document and in the BI platform repository are displayed in the Version column
                    


Figure 19.3    Document Shared Elements Updated in the BI Platform Repository
If the document is linked to a shared element that is no longer found in the BI Platform repository, then an error icon  is displayed in the list. If the check cannot be done, a question mark icon  is displayed in the list.
If you consider it's worthless to check for new versions of shared elements, you can stop checking the shared element version when the document is opened by unselecting the Check for Shared Element update on open option in the Document Summary dialog box. In this case, you may later explicitly run such a check by clicking the Check New Versions button in the Currently used pane.
Updating Document's Shared Elements
If your document is linked to a shared element for which a new version has been saved in the BI platform repository, you can resynchronize your document with this new version, so it contains the latest changes. To do so, follow these steps:


                        In Design mode, in the Shared Elements side panel, in the Currently used pane, select the checkbox next to the shared element name to update.
                    

                        Click the Update button to replace the content of the shared element that has been copied into the document with the new one available in the BI platform repository.
                        You can also directly select a report element in the document. Right-click it and, in the contextual menu, select the Linking • Shared Element command.
                    

                        Save your document so these changes are persisted in your document.
                    

This update has the following effects:


                        The report element linked to this shared element is completely replaced by the new version. Any changes you made to it in the document are lost.
                    

                        If the document contains instances of this shared element that have been previously inserted, then they are also all updated.
                    

                        If the query in the shared element has been updated, when the shared element is updated, the query in the document is also replaced, unless another report element has been created on this query. In this case, to prevent changes in this report element, the query is not replaced but a copy is kept in the document.
                    

                        Finally, its queries (if any) are run to retrieve the data set to feed the report element.
                    

Even if there is no version difference between the copied content and the shared element, you can perform an explicit update via the Update button.
In order to simplify the shared elements update, another option, Automatically update shared element on open, has been added in Web Intelligence properties (see Chapter 2, Section 2.6). If new versions of the shared element used by the document are available, this option automatically updates the shared elements when the document is opened, in Reading or Design mode.
Unlinking Document's Shared Elements
Updating shared elements allows you to take advantage of the latest changes and consider the shared element version in the BI platform repository as the reference to follow. If you modify one report element coming from a shared element and want to keep these changes without them being replaced by the next update, you need to unlink this report element. This breaks the link between the shared element and the report element, but the content itself remains in the document and can evolve independently from the shared element.
To unlink a specific report element, right-click it in the document or in the Document Structure and Filters side panel and select the Unlinking Shared Element command. Only this selected instance will be unlinked. If other instances of the same shared element have been added to the document, they remain linked to it.
To explicitly unlink all instances of a shared element, you can simply select it in the Currently used pane and click the Unlink button. This unlinks the document from the shared element since all its instances are unlinked from the shared element in the BI Platform repository.
In both cases, save your document to keep your changes.

Offline Mode
As they require access to the BI platform repository, it is not possible to check for shared elements update or update them when you are in Web Intelligence offline mode. But you can unlink shared elements since the links will be removed the next time you publish the document in the BI platform repository.

19.1.5    Managing Shared Elements
In Design mode, the Shared Elements side panel can be used to insert, update, or unlink shared elements. It can also be used to manage shared elements in the BI Platform repository. To do so, select Browse in the Shared Elements side panel to switch into the BI platform repository browser.
As seen in Figure 19.4, this browser proposes two tabs, Folders and Categories, that allow you to navigate by folders and categories. The commands available in the toolbar or in the right-click contextual are almost similar in the Folders or Categories tab.
They are:


Cut, Copy, PasteThe common actions to cut, copy, and paste the selected shared element.
                

Delete To delete the selected item (shared element, folder, or category).
                    
Figure 19.4    Shared Elements Browse Pane Toolbar


Edit propertiesOpens a dialog box where you can modify the shared element name, description and keywords and its assigned categories.
                

New folder or New categoryTo create a new folder or category, depending on the selected tab.
                

RefreshTo refresh the displayed view in the tree list.
                

Find a shared elementSelect a folder then this command to switch into the Search mode. In this mode, you can select to search shared elements by name, description, or keyword under the selected folder. Type the text, then click the Search for documents under the selected folder icon  to start the search.
                    The found shared elements are listed in the pane below the search toolbar. You can right-click a shared element in this list and select the Insert command to add it to the report (Section 19.1.2).
                    To return to the Browse mode, click the Return to navigation view icon .
                


Figure 19.5    Search Shared Elements


Insert the selected shared element in the documentOpen a small box with the shared element icon that follows the mouse. Hence, you can select where to insert the shared element in the report by clicking in it. To exit this insert mode, press the (Escape) key.
                










19.2    Using the Send Feature in BI Launch Pad
You can easily share reports from within the BI Launch Pad portal provided that you've been given the rights by the system administrator. Another option available in BI Launch Pad is the ability to send Web Intelligence reports.

Note
Chapter 16 discusses how to view a Web Intelligence report in BI Launch Pad; refer to it for a review of this and other features within BI Launch Pad.

To activate the Send option on the BI Launch Pad toolbar, you must first select the report to be sent so that it's highlighted in the Workspace Panel. The Send button will become active.
Select the Send button to display the dropdown list options shown for sending a document: BI Inbox, mail, FTP Location, or File Location. The options available will depend on your configuration, so we'll examine them further.
19.2.1    BI Platform Inbox
You can send a Web Intelligence document to another SAP BusinessObjects BI Platform user's inbox. The report will be displayed in his My Documents drawer in the inbox, as shown in Figure 19.6.

Figure 19.6    BI Inbox
The new report will be listed in the Unread Messages in My Inbox panel on the Home tab.
Upon selecting the option to send a report to a BI Inbox, a dialog box appears to indicate the Send options. When marking the Use default settings checkbox at the top of the dialog box, the user won't be able to complete any custom settings. The default settings for distribution will be used as defined by the system administrator. To select personalized settings for the report destination, proceed to the settings discussed next.
Figure 19.7 shows the selection of users and Send To inbox settings.

Figure 19.7    Send to BI Inbox Settings
You'll be prompted to select the destination BI Inbox from the User List or from the Group List. Selecting from the Group List will enable you to select all members of a group to receive the same report in his BI Inbox. A search box is also available to aid in finding the appropriate name from the User List or Group List. Select the arrows to move the names into the Selected Recipients box.
The next option is to designate a Target Name by selecting one of the options:


Use Automatically Generated NameThis will use the current name of the document selected as the name of the report as it appears in the recipient's inbox.
                

Use Specific NameThis will enable you to generate a unique name to use for the report name as it will appear in the inbox. There is also a dropdown list to add placeholder values; as described in Section 19.2.5.
                

Finally, the Send As option enables you to select whether the recipient will receive a shortcut or copy of the report. After these options have been marked, select Submit to send your document to the recipient's BI Inbox.

Note
Use caution when sending a shortcut. If the recipient doesn't have the right to view reports in the folder where the original report resides, then he will be unable to view the report.
For example, if you send a report to another user that resides in your My Documents drawer (i.e., Favorites or Inbox), the recipient won't have the right to view these reports unless he has administrative level access to this location, which is unlikely.

19.2.2    Email
A Web Intelligence report can be sent to an email address for the user to view outside of BI Launch Pad. If Web Intelligence format is sent by email, the user must have an SAP BusinessObjects BI platform user account to view the Web Intelligence report because he'll need to enter his credentials to log on to the SAP BusinessObjects BI platform.
There is an additional placeholder in the list for the message body (Section 19.2.5). The placeholder of Viewer allows you to insert a hyperlink to the report within the BI Launch Pad environment. The user would select the hyperlink and log in to the SAP BusinessObjects BI platform environment to view the report. Figure 19.8 provides a view of the Send To email options.

Figure 19.8    Send To Email Options
19.2.3    FTP Location
Send to FTP location enables the user to send the Web Intelligence document to a File Transfer Protocol (FTP) location. An FTP location is a standard network protocol location used to exchange files over a network.
Specific information regarding the FTP location must be specified in the options box, including Host, Port, User Name, Password, Account, and Directory. This information will be specific to the FTP location the document is being sent to.
After the FTP-specific properties are set, the File Name properties are specified, including whether the report is automatically generated or uses a specific name with placeholder options. Figure 19.9 shows the options for sending documents to FTP locations.

Figure 19.9    Send To FTP Server Options
19.2.4    File Location
The final possible location to send a report is a file location. Sometimes the best option may be to send PDF or Excel versions of Web Intelligence documents to a location on a shared drive that can be viewed by numerous users for collaborative purposes and ease of access.
When specifying a file location, the directory path must be specified as well as a User Name and Password for that directory if applicable. Then the file name property can be set to use an automatically generated name or a specific name with placeholder options. Figure 19.10 shows the file location options when scheduling a report.

Figure 19.10    Send To File System Options
19.2.5    Using Placeholders
When defining the destination's options, you may use placeholder at different locations. Placeholders are a set of dynamic variables that are evaluated and can be used customize your schedule.
You can either use the Add Placeholder dropdown menu, as shown in Figure 19.11.

Figure 19.11    Placeholders List
This dropdown menu contains the different available placeholders. Select one of them to add it in the text field.
You can also directly type the placeholder variable in the text field. The list of placeholders and the corresponding tag to enter are listed in Table 19.1.




                            Name
                        

                            Description
                        

                            Tag
                        





Title


                            Inserts the title as it exists when the report is sent
                        

%SI_NAME%




ID


                            Inserts the unique identifier number for the report as it exists in the system at the time the report is sent
                        

%SI_ID%




Owner


                            Inserts the name of the owner of the document as it appears in the properties
                        

%SI_OWNER%




DateTime


                            Inserts the current date and time when the report is sent
                        

%SI_STARTTIME%




Email Address


                            Inserts the email address the report is being sent to
                        

%SI_EMAIL_ADDRESS%




User Full Name


                            Inserts the user's full name
                        

%SI_USERFULLNAME%




Viewer


                            Available only when sending to email (Section 19.2.2). Includes an URL to access the document with OpenDocument  (see Chapter 15, Section 15.3) in the email body.
                        

%SI_VIEWER_URL%




File Extension


                            Inserts the file extension of the document type
                        

.%EXT%




Table 19.1    Available Placeholders

Placeholder Example
For example, if you enter %SI_NAME%_%SI_ID%_%SI_STARTTIME% as the file name, the 27th August at 10:42, the generated file name will be:
All KPIs Team_8651_2017-07-27-10-42-00.wid
Where:


                        "All KPIs Team" is the document name
                    

                        8651 is its ID
                    











19.3    Exporting a Web Intelligence Report
You are often faced with the requirement of analyzing company data in Excel for even more detailed analysis or distributing reports in PDF format. As a report consumer, Web Intelligence enables you to export report data retrieved from the universe and database into one of the following file formats: Microsoft Excel (XLS or XLSX), Adobe Acrobat (PDF), Comma Separated Values (CSV), or plain text (TXT).
Web Intelligence allows you to export either the document data or the query data. Their differences are described next.
19.3.1    Exporting Document Data or Query Data
You can either export the document data or the query data. Let's see the differences between these two options.
Exporting the Document Data
When you export document data, you export the data set as it is displayed in the document. Hence this data set may contain variables, references, reports filters, input controls, etc., that you defined in the document.
You can select to save all reports of the document or only one of them.
The supported file formats for document data export are:


Microsoft Excel or Microsoft Excel 2007 Saving with the Excel option converts the Web Intelligence report into Excel format and allows you to open or save the report. The data in the tables of the Web Intelligence document will drop into the columns and rows of the Excel spreadsheet, as you saw with the Paste without Formatting option (Section 19.1). Further manipulation of the data is then available in this format.
                        The Microsoft Excel option saves the report into .XLS format, which limits the resulting rows to 65,000. The Microsoft Excel 2007 option saves the document into the .XLSX format—effectively enabling up to one million rows of data to export into the spreadsheet.
                    

Adobe Acrobat PDF Selecting to save with the PDF option will convert the Web Intelligence report into PDF format and allow you to open or save the report. The report will appear similar to a picture, so further manipulation of the data will not be available. This is a preferable format to use when you want to maintain the report formatting and ensure that the data can't be manually changed in the future.
                    

CSV archive The CSV Archive export option saves the Web Intelligence report as a compressed .zip file with a compilation of comma-separated value format files. It creates a separate CSV file for each report tab in your document. This enables you to import the report into a number of different programs (including Microsoft Excel).
                        The CSV format gives you additional options for customizing the format of your CSV output file, letting you designate the specific format to make the CSV file compatible with the end program where you may be importing your data.
                    

Text file The Text file export option saves all document figures into a single text file.
                    

Depending on your selected file format, you can specify additional options. For example, if you select the PDF or Excel file format type, then you can specify the resolution in Dots Per Inch (DPI) to generate the document charts, if any. If you select CSV, you can select the characters used for column delimiter, text qualifier, or the charset.
Exporting a Query Data
Exporting query data saves the raw data coming from the query in the microcube. If you select Data, you can select the queries for which to save the data and the only possible output file format is a CSV file.
19.3.2    Exporting in Web Intelligence Applet or Rich Client
In Web Intelligence Applet or Rich Client, to save the report's data, follow these steps:


                    In the toolbar, open the menu using the Save button and select the Save As command.
                

                    In the Save Document dialog box that opens (see Figure 19.12), click the My Desktop, My Documents, or My Computer button to export the data locally on your filesystem.
                    
Figure 19.12    Save Document Dialog Box in Web Intelligence Java Applet


                    The Files of Type dropdown list appears, where you can select the file output format.
                

                    In the Select reports list, select the reports whose data will be saved.
                

                    Depending on the file format you selected, enter the corresponding options.
                

                    Click Save to generate the file.
                

To export query data, in Reading, Design, and Data mode, follow these steps:


                    Click the Export Date icon on the Report toolbar. A dropdown menu opens and displays the list of queries the document contains.
                

                    Select one query in this menu. The Save Document - <Query name> dialog box opens (see Figure 19.13), where you can select:
                    

                            The folder on your filesystem to export the data set to and the file name to use.
                        

                            The CSV parameters, since queries data can only be saved in CSV file.
                        

                            The Set as default values checkbox to save these options for future export.
                        



                    Click Save to generate the CSV file in the selected folder.
                


Figure 19.13    Save Document—Query Dialog Box in Web Intelligence Applet
19.3.3    Exporting in Web Intelligence HTML
Compared to the Web Intelligence Applet or Rich Client, Web Intelligence HTML relies on another component for saving and the commands to export data from the document are different. In Web Intelligence HTML, in both Reading and Design modes, click the Export button  in the toolbar. This will open the Export dialog box.
As seen in Figure 19.14, in this dialog box, you can export:


                    Document data by clicking the Reports radio button. In the sections that follow, select:
                    

                            The reports to export
                        

                            The output file format in the File Type dropdown menu
                        

                            The options available for this file format (Section 19.3.1)
                        



                    Query data by clicking the Data radio button. In the sections that follow, select:
                    

                            The queries to export
                        

                            The CSV options since the query data can be saved only in CSV (Section 19.3.1)
                        



Click OK to validate your choice and generate the file in your filesystem, in your Downloads folder.

Figure 19.14    Export Dialog Box in Web Intelligence HTML









19.4    Scheduling a Web Intelligence Report
The processes discussed so far included manually generated methods of sharing Web Intelligence reports. A document can also be scheduled to be distributed to recipients in a variety of formats and methods. This scheduling ability is available within BI Launch Pad from which you can schedule a report, view the latest instance of a scheduled report, and view the scheduling history of the report.
19.4.1    Scheduling in BI Launch Pad
After selecting the report to be scheduled in the Workspace Panel, navigate to the More Actions menu on the BI Launch Pad toolbar, as shown in Figure 19.15. Select the Schedule option to set the scheduling properties.

Figure 19.15    Schedule Command from the Actions BI Launch Pad Toolbar
You'll be prompted to complete the following items:


Instance TitleType in the title for this instance of the report or use the default title already entered.
                

RecurrenceNumerous options are available in the dropdown menu for selection dependent upon your report distribution requirements:
                    

Now: The Now option runs your report schedule immediately upon completion of your scheduling properties and selecting the Submit button.
                        

Once: The Once option runs your report schedule once during the time frame specified in the Recurrence properties box, as shown in Figure 19.16.
                        




Figure 19.16    Recurrence - Once Options


Hourly: The Hourly option shown in Figure 19.17 runs the report at the hourly increments specified in the Hours and Minutes boxes in the Recurrence properties. The Start and End Date/Times are also specified.
                


Figure 19.17    Recurrence - Hourly Options


Daily: The Daily option shown in Figure 19.18 runs the report daily for N number of days, as specified in the Recurrence properties. The Start and End Date/Times are also specified.
                


Figure 19.18    Recurrence - Daily Options


Weekly: The Weekly option shown in Figure 19.19 runs the report weekly on the day or days specified by the checkboxes. You also specify the Start and End Date/Times for when the schedule will start and end.
                


Figure 19.19    Recurrence - Weekly Options


Monthly: The Monthly option shown in Figure 19.20 will run the report monthly every N months as specified. You also specify a Start and End Date/Time for this schedule.
                


Figure 19.20    Recurrence - Monthly Options


Nth Day of Month: The Nth Day of Month schedule shown in Figure 19.21 allows you to specify the exact day of the month to run the schedule. This can be especially useful for financial reports that run for month-end reporting. A Start and End Date/Time are also specified for the schedule.
                


Figure 19.21    Recurrence - Nth Day of the Month Options


1st Monday of Month: This schedule allows you to run the report on the first Monday of every month. This can be useful for monthly reports to maintain consistency in the run date. You also specify the schedule Start and End Date/Time, as shown in Figure 19.22.
                


Figure 19.22    Recurrence - First Monday of the Month Options


Last Day of Month: The Last Day of Month option will run the report on the final day of each month. You specify the schedule Start and End Date/Time. Figure 19.23 shows the options available when selecting the Last Day of Month recurrence option.
                


Figure 19.23    Recurrence - Last Day of the Month Options


X Day of Nth Week of the Month: This schedule, as shown in Figure 19.24, enables you to specify the week and day of each month that the schedule should be run. For example, you can specify to run the report on the third Thursday of each month. In this case, you would specify week number 3 and the day of Thursday. You'll also specify the schedule Start and End Date/Time.
                


Figure 19.24    Recurrence - X Day of Nth Week of the Month Options


Calendar: Calendars need to be set up in the CMC by the system administrator for them to be seen here. If a customized calendar is set up, you can specify to use them here, as shown in Figure 19.25. These calendars enable you to have more specific options on dates to run the report.
                



Formats and DestinationsOutput formats include Web Intelligence, Microsoft Excel, Adobe Acrobat, Comma Separated Values (CSV), or Plain Text. Available destinations include BI Inbox, file locations, FTP or SFTP server, and email recipients. The default is Default Enterprise Location.
                    
Figure 19.25    Recurrence - Calendar Options
                    Destination options and settings change depending on the Output Format Details selected in the Output Format and Destination section. These settings are the same as discussed in Section 19.2.
                    When you check the Cleanup instance after scheduling box, the instance will be removed from the history after it has been sent out to the selected recipients. This removes unnecessary extra copies of the report to maximize disk space.
                

CachingSelect the formats to be used to pre-load the cache when scheduling (only applicable if scheduling in Web Intelligence format). Available formats to cache include Excel, standard HTML, and Adobe Acrobat. Select the formatting locales to be used to pre-load the cache when scheduling. The available locales will show in the left box. You must select the arrow to move to the Selected Locales box to specify your selection.
                

EventsEvents are set up by your system administrator in the CMC. Available events are listed in the box on the left. Select the arrows to move your selections to the Events to Wait For box. You may also select the event in the Available Schedule Events box to move to the Events to Trigger on completion. This will specify which events must occur for the job to be triggered. This can be useful to ensure a nightly data load job has completed loading the new data before the report is run.
                

Scheduling Server GroupThis option enables you to specify a specific server group to use when scheduling your document. The usual setting is to use the first available server. Note that if a specified server is busy, your job will likely fail. The Scheduling Server Group options are detailed in Figure 19.26.
                


Figure 19.26    Scheduling - Server Group Options
19.4.2    Viewing Latest Instance
If a report has been scheduled previously, then the View Latest Instance option will appear in its contextual menu, as shown in Figure 19.27. The latest instance shows you the last scheduled version of the report as distributed to your selected recipients.

Figure 19.27    View Latest Instance Command
19.4.3    Viewing History
You are also able to see the history of all instances scheduled for a report by selecting History from the Actions dropdown list in the BI Launch Pad toolbar or from the right-click contextual menu. The History view will show a listing of all scheduled reports, including the date/time of the instance, title, run by, parameters values (if applicable), format, and status.
In Figure 19.28, the instance in the History view is showing a status of Running. This indicates that the report schedule is currently running and not yet complete to view. Additional radio buttons and checkboxes at the top of the History view can aid you in filtering a longer list of instances to customize your view. These options include Show All, Show Completed, Show only instances owned by me, and Filter Instances by Type.

Figure 19.28    History View









19.5    Summary
The sharing features available in Web Intelligence make it a powerful business intelligence reporting tool to share and analyze data with others.
Sharing report parts through shared elements enable quick and easy collaboration. You can also take advantage of the features provided by the SAP BusinessObjects BI platform, such as sending documents to different destinations or the scheduling that enables users to automate this process.
Exporting content into different file formats can also be a very convenient way to share dataset retrieved and transformed by Web Intelligence to other applications.
The next chapter discusses another exciting feature available for sharing report content, called publications. Publications provide a powerful tool for creating robust, customized distributions of documents contained within the SAP BusinessObjects BI platform.








20    Report Scheduling and Distribution with PublicationsThe SAP BusinessObjects platform can be harnessed to distribute personalized reports, known as publications, to subscribers, either inside or outside of your organization.The primary strength of Web Intelligence is that it allows business users to query and manipulate corporate data with minimal assistance from corporate IT. However, the SAP BusinessObjects BI platform also includes powerful capabilities for automatically distributing data to business users using a feature called publications and known more generically in the business intelligence industry as report bursting.A publication is a collection of documents intended for distribution to a mass audience, often personalized to target this group specifically. You can define the publication metadata surrounding these documents, such as document sources, recipients, and personalization rules, from either the BI Launch Pad or the Central Management Console (CMC). Publication subscribers can view publications through the secure BI Launch Pad portal or via email.Publications have been part of the SAP BusinessObjects platform since an add-on product named Broadcast Agent Publisher was introduced on the classic (pre-SAP BusinessObjects Enterprise XI) SAP BusinessObjects platform. Beginning with SAP BusinessObjects Enterprise XI Release 2, when Desktop Intelligence was reintroduced to the platform (SAP BusinessObjects Enterprise XI Release 1 did not include Desktop Intelligence), publications could be created only in the Desktop Intelligence format. Additionally, a recipient required an SAP BusinessObjects BI license to receive a publication.SAP BusinessObjects Enterprise XI 3.0 added significant new capabilities to publications. For the first time, publications could be created using SAP Crystal Reports or Web Intelligence, in addition to Desktop Intelligence. Also, a new feature called dynamic recipients permitted organizations to schedule and distribute publications via email for users who weren't license holders on the SAP BusinessObjects BI platform. This enhancement was particularly useful for distributing publications to customers outside the traditional walls of the organization. Dynamic recipients also made the distribution of publications more cost effective, as no user license was required.The SAP BusinessObjects BI 4 platform continues the features introduced in SAP BusinessObjects Enterprise XI 3.0, but no longer supports publications based on Desktop Intelligence. Desktop Intelligence documents should be converted to the Web Intelligence format using the Report Conversion Tool (see Appendix A).Publications allow critical business information such as corporate sales figures to be pushed directly to recipients and complement the self-service features of the SAP BusinessObjects BI platform. As necessary, each recipient can receive a personalized version of the publication that displays only data of interest to him; this personalization can also serve as a security measure, limiting access to sensitive data. For example, employees in the Asia Pacific region will receive a publication with only their data; data for the Americas and EMEA regions will not appear in their copy of the publication.One of the key features of publications is its efficient use of database resources during personalization, known as single-pass report bursting. Instead of executing unique database queries for each publication recipient, the publication executes non-personalized database queries. By applying one or more report filters to the source document, you can make sure that the data is personalized after it's retrieved from the database. Publications use Web Intelligence report filters, so one popular practice is to distribute publications in a neutral format such as Adobe PDF or Microsoft Excel because a savvy user could potentially remove the report filtering from the original document and view sensitive corporate data.As we look ahead to the publication creation process, we begin by discussing the various roles that are involved.
20.1    Publication Roles
Four roles are involved in the creation and consumption of a publication: administrator, report designer, publisher, and recipient. The first three roles can be filled by a single person with access to both the BI Launch Pad and CMC. In larger organizations, these roles are often divided among multiple people:


AdministratorThe SAP BusinessObjects administrator ensures that the SAP BusinessObjects BI environment is functioning, that security roles are defined, and that desired destinations such as Simple Mail Transfer Protocol (SMTP) email or mobile devices are configured. These tasks are performed in the CMC.
            

Report designerThis individual will use the techniques outlined in this book to create one or more Web Intelligence documents to form the foundation of a publication. These Web Intelligence documents can be created using either Web Intelligence from the BI Launch Pad or the Web Intelligence Rich Client.
            

PublisherThis individual creates the publication and configures its metadata, including the personalization information. Publications can be created by users from the BI Launch Pad or administrators from the CMC.
            

RecipientThis individual receives the publication, typically via email, although the BI Launch Pad inbox can also be used for both desktop and mobile access.
            

Let's examine each of the four roles in greater detail.
20.1.1    The SAP BusinessObjects Administrator
The SAP BusinessObjects administrator has several important tasks. First, he is responsible for ensuring that the user account used to schedule the publication has access to the public folders containing the publication source documents, universes, and connections on which those documents are based. He must also ensure that the desired destination (inbox, email, FTP, or file system) is properly configured on the publication job server. Lastly, the SAP BusinessObjects administrator will create and manage profiles that are used to personalize publications for enterprise recipients. Each of these administrative tasks requires access to various management areas of the CMC.
20.1.2    The Web Intelligence Report Designer
The Web Intelligence report designer is responsible for creating one or more source documents for the publication.
All documents in the publications must be of a single type—in other words, they must all be Web Intelligence documents—because it isn't possible to combine Web Intelligence documents and SAP Crystal Reports into the same publication.
Although the report designer doesn't need to understand the inner mechanics of the publication mechanism, the report designer must understand the reporting requirements and the personalization requirements. Personalization is applied by the publication server to documents as report filters, which are presented in Chapter 9, Section 9.3.
20.1.3    The Publication Designer
The publication designer uses either the CMC or the BI Launch Pad to build a new publication. This chapter focuses mainly on this role.
20.1.4    The Publication Recipient
The publication recipient has the easiest responsibilities of the four roles. The recipient simply checks his BI Inbox or corporate email inbox to see whether a publication has been sent. A recipient can also subscribe or unsubscribe to a publication from the BI Launch Pad.









20.2    Creating a Publication
This example uses a single Web Intelligence document based on the eFashion universe as the basis of the publication. The sample document is shown in Figure 20.1.

Figure 20.1    Sample eFashion Publication
The query in the publication source will retrieve all eFashion stores; however, the publication's metadata will ensure that each recipient only receives data for one store by applying a report filter to the store name object in the report section.
To begin creating a new publication, open the BI Launch Pad and choose Publication from the New menu on the main toolbar, as shown in Figure 20.2.

Figure 20.2    Select Publication from the New Shortcut Icon in BI Launch Pad
20.2.1    Naming the Publication
First you must give the publication a name. The sample publication is called "eFashion Publication Dynamic," as shown in Figure 20.3. Adding a Description and Keywords that help identify the publication is optional.

Figure 20.3    Publication General Properties
20.2.2    Choosing the Source Documents
Choose one or more source documents from the Source Documents box, as shown in Figure 20.4.
Now choose one or more Web Intelligence documents. This example uses a single document named Analysis by SKU by Category, as shown in Figure 20.5.

Figure 20.4    Source Documents

Figure 20.5    Source Document Selection
After you've entered the general properties and source documents, you'll see additional menus on the left side of the screen, as shown in Figure 20.6.

Figure 20.6    Source Documents
20.2.3    Choosing Enterprise Recipients
A publication may have enterprise recipients, dynamic recipients, or both. You can add enterprise recipients as individual users or as groups using the selection box, as shown in Figure 20.7. In this example, a group named eFashion has been chosen.

Figure 20.7    Enterprise Recipients

Note
Keep in mind that users with access to the folder containing the publication can subscribe or unsubscribe themselves via the BI Launch Pad, which is described later in the chapter.

Personalization with a Global Profile
If the SAP BusinessObjects administrator has created a suitable profile in the CMC, it may be applied to the publication. The administrator must grant viewing rights to the profile to the publication author; otherwise, the profile will not appear in the author's dropdown list. In Figure 20.8, the eFashion Manager Profile profile is used to personalize the publication.
The inner workings of the profile and which universes and objects it filters can only be examined using the CMC.

Figure 20.8    Personalization with a Global Profile
Personalization Using a Local Profile
Personalization for enterprise recipients can also be accomplished using a local profile, as shown in Figure 20.9. A local profile filters a report field in the Web Intelligence source document. Although local profile filters can be used to filter universe objects, they are typically employed when the source document contains a report variable to be filtered that isn't present in the universe.

Figure 20.9    Personalization with a Local Profile
20.2.4    Choosing Dynamic Recipients
Dynamic recipients are specified using a dynamic recipient provider, which is a report authored using either SAP Crystal Reports or Web Intelligence. This example uses Web Intelligence as the Web Intelligence Report Dynamic Recipient Provider, as shown in Figure 20.10.

Figure 20.10    Web Intelligence Report Dynamic Recipient Provider
Next, you need to select the desired Web Intelligence report. Figure 20.11 shows eFashion Dynamic Recipient List selected.

Figure 20.11    Choosing eFashion Dynamic Recipient List Report
After the dynamic recipient provider report is selected, choose the data provider containing the dynamic recipient list, as shown in Figure 20.12. In this example, the default Query 1 contains the dynamic recipient list.

Figure 20.12    Selecting the Data Source Name for the Document
After the data provider is chosen, three fields appear for the Recipient Identifier, Full Name, and Email of the recipients. These fields should be mapped to the proper objects in the data provider, as shown in Figure 20.13.

Figure 20.13    Map Fields from the Source Document
Personalization with a Local Profile
After the dynamic recipients are specified, the publication can be personalized for each recipient using additional fields in the Dynamic Recipient Provider report, as shown in Figure 20.14. In this example, each recipient will receive a publication for a single store name.

Figure 20.14    Personalizing Dynamic Recipients with Local Profile
20.2.5    Setting Publication Properties
A variety of settings are available to format your publication with your audience in mind.
Formats
Publications can be delivered in four formats: Web Intelligence, Microsoft Excel, Adobe Acrobat (PDF), and MIME HTML (MHTML), as shown in Figure 20.15.

Figure 20.15    Formats
Destinations
As with any scheduled job, you can send publications to the five standard destinations: Default Enterprise Location, BI Inbox, Email, FTP Server, and File System, as shown in Figure 20.16. Except for the Default Enterprise Location, the destinations may require additional configuration by the SAP BusinessObjects administrator.

Figure 20.16    Destinations
Prompts
If any of the source documents contain prompts, they can be modified. Figure 20.17 shows a default value of Party pants for the publication source document.

Figure 20.17    Prompts
Delivery Rules
In release 4.2 SP 3, Web Intelligence introduces a new feature to publications called Delivery Rules, as shown in Figure 20.18, which control delivery of individual documents within the publication or the entire publication itself. This feature can prevent a document of the publication from being delivered to its recipient for two reasons:


                        If it has no data.
                    

                        If it has not been successfully refreshed. If the document has been partially refreshed (see Chapter 12, Section 12.6), it is then not considered as valid for delivery.
                    

The document is evaluated after the personalization, if any.

Figure 20.18    Delivery Rules
If you select the first option, Deliver individual document when condition is met, then only the documents that met the selected conditions are added and sent in the publication. Otherwise, if you select the second option, Deliver all documents when only when all conditions are met, the publication is not sent to its recipient if at least one condition is not met for one document.
Individual conditions for each document is selected in the drop-down menu in the Condition column.
Recurrence
Publications support all of the standard recurrence intervals of the SAP BusinessObjects BI platform, as shown in Figure 20.19. For more information about scheduling recurrence options, see Chapter 19, Section 19.5.

Figure 20.19    Recurrence
Events
Publications support all of the standard event types (file, schedule, and custom) available from the SAP BusinessObjects BI platform, as shown in Figure 20.20. For more information about scheduling with events, see Chapter 19, Section 19.5.

Figure 20.20    Events
Scheduling Server Group
Server groups are created and managed by the SAP BusinessObjects administrator to specify specific resources in the SAP BusinessObjects BI platform cluster, as shown in Figure 20.21. Ask your SAP BusinessObjects administrator if your publication should use a server group that assigns long-running jobs to the largest, fastest machines in the SAP BusinessObjects BI server cluster.

Figure 20.21    Scheduling Server Group
Advanced Options
Advanced options is where you control profile resolution, display of users who have no personalization applied, and the method for report bursting, as shown in Figure 20.22.

Figure 20.22    Advanced Options
Let's examine these options.
Profile Resolution
In certain cases, an enterprise recipient may be defined in more than one profile. The profile resolution specifies how the publication should behave for these recipients. If Do not merge is chosen, the recipient will receive multiple distinct documents for each profile in which the recipient is defined. If Merge is chosen, the distinct profiles will be combined, and the recipient will receive a single document.
Personalization
By selecting the Display users who have no personalization applied box, publishers can see which subscribed recipients have no personalization applied, meaning that those recipients will see the entire unfiltered source documents. Depending on business requirements, it may be totally appropriate for corporate executives and senior managers to appear on this list, as their role in the organization dictates that they should have visibility to all corporate operations.
Report Bursting Method
Publications based on Web Intelligence can only have the option of one database fetch for all recipients. Additional report bursting methods exist for publications based on SAP Crystal Reports.
Scope Batch Size Limit
Scope Batch Size Limit is a new parameter in Web Intelligence 4.2 and can be adjusted to improve performance when multiple pass bursting mode is enabled. When set to Default, the thread pool size is determined using a formula based on the number of CPU cores in node processing the publication. Otherwise, a Custom Value can be specified. Refer to SAP Note 2229293 for additional information about this parameter.
Summary Screen
After the publisher has completed the publication setup, it's helpful to return to the Summary screen, shown in Figure 20.23, to review all options you've selected.

Figure 20.23    Summary Screen
20.2.6    Testing the Publication
Test mode, shown in Figure 20.24, allows the publisher to validate a publication before sending it to actual recipients. All instances of the publication will be sent to the publisher—not the actual recipients—so the publication behavior can be tested. Testing the publication is an important step to ensure that sensitive corporate data is not inadvertently revealed by the publication.

Figure 20.24    Test Mode









20.3    Mobile Publications
Using the latest version of SAP BusinessObjects Mobile BI (see Chapter 24), publications scheduled to the BI Inbox can be viewed on a mobile device, allowing you to deliver personalized analytics nearly anywhere (see Figure 20.25).

Figure 20.25    BI Inbox in the SAP BusinessObjects Mobile BI Application (iOS Shown)
To demonstrate, we loaded a Desktop Intelligence XI R2 document from an old Business Intelligence Archive Resource (BIAR) file into SAP BusinessObjects BI 4.2, which can host Desktop Intelligence documents. Next, we converted the document to Web Intelligence using the Report Conversion Tool (see Appendix A). Finally, we created a personalized publication to enterprise recipients using the techniques covered in this chapter, scheduling to the BI Inbox. The result is shown in Figure 20.26.

Figure 20.26    Web Intelligence-Based Publication Delivered to the SAP BusinessObjects Mobile BI Inbox (iOS Shown)









20.4    Summary
Publications allow organizations to complement self-service reporting by publishing personalized content directly to users, both inside (enterprise recipients) and outside (dynamic recipients) the organization.
Of the four roles involved in publications (administrator, report designer, publication designer, and recipient), this chapter has focused on the role of the publication designer. The publication designer builds a publication using one or more Web Intelligence documents and assigns personalization through either a global profile (a reusable profile managed in the CMC) or a local profile (unique to a single publication).
Publications use the same destinations and scheduling options available to other document types on the SAP BusinessObjects BI Platform. The most common destination is email, as it allows publications to serve customers outside the walls of an organization. However, new capabilities in the SAP BusinessObjects Mobile app allow you to send personalized content to the BI Inbox to view almost anywhere using supported phone and tablet devices.
The next chapter covers Web Intelligence Rich Client, which enables the use of local data providers to create reports.








21    Web Intelligence Rich ClientWeb Intelligence Rich Client puts the power of Web Intelligence reporting on your workstation. It provides all the same capabilities while providing the additional benefits of working in offline or standalone mode—with no connection to the BI platform required!Prior to the release of Web Intelligence 3.x, Web Intelligence reporting existed over the web only. Users were required to log in to the web portal of BI Launch Pad to view, create, modify, and share Web Intelligence report content. With the introduction of this thin client version, Web Intelligence 3.x provided you with the ability to use all the functionality of Web Intelligence from your local PC, completely unconnected from the BI platform repository. Web Intelligence documents can be stored locally, which provides you with another means for backing up your reports. Local data providers can be used to create reports with Web Intelligence Rich Client.There are two ways to install Web Intelligence Rich Client: using the SAP BusinessObjects BI platform Client Tools installation downloaded from the SAP Support Portal, or directly from the BI Launch Pad.This chapter explores the unique functionality available within Web Intelligence Rich Client as well as differences in navigation compared to the HTML and Java Applet versions.
21.1    How Web Intelligence Rich Client Is Different
Web Intelligence Rich Client enables you to work with Web Intelligence documents from a Windows-based application installed on your local workstation. The familiar interface of Web Intelligence Rich Client, which is shown in Figure 21.1, makes it a favorite destination for report writers. Access to the BI platform isn't required. Documents can be saved to your local computer, and you can use local data providers when building queries. Timeouts or web-based issues won't create interruptions to your Web Intelligence report writing and viewing. These features provide exciting new capabilities for the Web Intelligence report consumer.

Figure 21.1    Web Intelligence Rich Client Interface
Compelling reasons for users to turn to Web Intelligence Rich Client for their reporting needs include the following:


                Web Intelligence Rich Client can work offline without a connection to the BI platform.
            

                Web Intelligence Rich Client performs calculations locally—rather than on the server—for improved performance.
            

                Web Intelligence Rich Client can be used in standalone mode when there is no BI platform or application server installed.
            

                When the data source is contained in Excel, CSV, text, or web services, you can use Web Intelligence Rich Client as a local data source.
            

Note that all the features of the HTML and Java versions of Web Intelligence via BI Launch Pad are available in Web Intelligence Rich Client. Additional available features will be discussed in further detail in this chapter, although for the purposes of this chapter, we won't duplicate our discussions in other chapters on the core functionality of Web Intelligence. Instead, we'll discuss only the differences found when using Web Intelligence Rich Client for your Web Intelligence reporting needs.
There are two ways to access Web Intelligence Rich Client: locally or through the BI Launch Pad. After Web Intelligence Rich Client is installed in your local machine, you can access it through the Windows Programs menu. To launch Web Intelligence Rich Client from BI Launch Pad, first set your Web Intelligence preferences to use Desktop as your default creation/editing tool, as shown in Figure 21.2.

Figure 21.2    Web Intelligence View and Modify Preferences for the Rich Client
When opening Web Intelligence Rich Client, you are presented with the initial screen to create a new document or open an existing document. At the bottom-left of the screen is the Blank Document option, shown in Figure 21.3. Selecting this option opens Web Intelligence Rich Client without establishing a connection to the repository; therefore, a logon screen doesn't appear. With this option, you default to enter Web Intelligence Rich Client in offline mode. You may begin working with a blank Web Intelligence document now and add queries and connections later.
After selecting a connected option, the login screen will appear. At this point, you may select to log on to the repository or log on in standalone mode. You have three options when accessing Web Intelligence Rich Client: offline, connected, and standalone.

Figure 21.3    Initial Options When Opening Web Intelligence Rich Client
21.1.1    Working in Offline Mode
The first new option available is the Use in Offline mode checkbox, as shown in Figure 21.4.

Figure 21.4    Offline Mode
Offline mode uses the security of the repository stored on your local machine. The first time you log in to Web Intelligence Rich Client, you have to log in using connected mode in order for the repository security information to be downloaded to your local machine. Every document and universe stored locally on your machine carries an access control list that stores the groups and users that have access rights to the object. Therefore, when working in offline mode, you aren't connected to the repository, but repository security is applied. You can work with secured or unsecured local documents and universes. When creating or refreshing documents, you'll will need a local universe and local connection server.
21.1.2    Working in Connected Mode
Working in connected mode enables you to import documents and universes from the repository as well as export Web Intelligence documents back to the repository. This capability isn't available in offline or standalone modes. There are two options to log in to connected mode. From within BI Launch Pad, set your Web Intelligence preferences to use Desktop as your default creation/editing tool. When you select to edit an existing Web Intelligence document or create a new Web Intelligence document from the BI Launch Pad, Web Intelligence Rich Client is launched on your local computer. When you use this method, Web Intelligence connects to the repository in client-server mode, and database middleware is needed on your local machine.
Another method involves logging in to Web Intelligence Rich Client by launching Web Intelligence Rich Client from your Programs on your local machine. When presented with the login dialog box, select the System and then select the same authentication type used when logging in to BI Launch Pad.
21.1.3    Working in Standalone Mode
To log in using standalone mode, select Standalone from the System list when entering your login credentials, as shown in Figure 21.5. Standalone mode doesn't connect to the repository, and security isn't enforced as in offline mode. While in connected and offline mode, you can work with secured or unsecured documents and universes; in standalone mode, you can work with secured documents and universes only. This requires the appropriate database connection middleware to enable you to create and refresh documents with local universes.

Figure 21.5    Standalone Mode









21.2    Data Provider Options
Multiple types of data sources are available in Web Intelligence Rich Client. In addition to the universe, Excel, SAP BEx, Analysis View, text, and web services data sources available in SAP BusinessObjects 4.1, version 4.2 adds support for direct connectivity to SAP HANA, both direct access and online mode, (see Chapter 13) and Free-hand SQL. The universe data source includes all universes stored within the CMC, as discussed in previous chapters. When you select the Text and Excel options, the personal data provider dialog box opens. Personal data providers include the following file types:


                *.TXT
            

                *.CSV
            

                *.PRN
            

                *.ASC
            

                *.XLS
            

After selecting the file type, you're prompted to define further options for selection of your data source.
Another data source available is the use of a web service, a data source exclusively supported by the Web Intelligence Rich Client. When a web service data source is selected, you are prompted to enter your source URL as well as additional pertinent information about your web service. Web service functionality can be used to bring in real-time information to your Web Intelligence document. Refer to Chapter 2, Section 2.6.4 for further details on using a web service as a custom data provider.
21.2.1    Import a Universe from the Repository
When creating a new Web Intelligence report in Web Intelligence Rich Client, you are prompted to select your data source. When selecting a universe as a data source, you have the option to choose a local universe or a universe saved in the repository. Note that you can only use a universe in the repository if you're working in connected mode. If you want to store additional universes locally for use in unconnected sessions, you can use Tools • Import Universe to import universes from the repository. Upon selecting Universes from the Tools menu, you'll receive a list of available universes, as shown in Figure 21.6. Select the universe to be imported locally and choose the Import button.

Figure 21.6    Universe Dialog Box: Importing

Note
Universes showing a green checkmark have already been imported locally.

21.2.2    Query Panel in Web Intelligence Rich Client
Within Web Intelligence Rich Client, select Edit from the Data Access menu to view the Query Panel. This is the same workflow as operating from within the web-based interface. Upon selecting Edit, the Query Panel dialog box appears. Make any appropriate changes to the query from this panel and then click Run Query to see your changes reflected in your report. This functionality works the same as within web-based Web Intelligence.









21.3    Working with Web Intelligence Reports
When working in Web Intelligence Rich Client, the same ribbon and menu exist as seen when working with Web Intelligence reports over the web. This provides a familiar source of organization for the options available for use when designing Web Intelligence reports. Figure 21.7 shows the menu options as seen in Web Intelligence Rich Client.

Figure 21.7    Web Intelligence Rich Client Menu
21.3.1    Opening Documents from the Repository
To import a report from the repository, you first must be in connected mode. Select Open from the File menu. (You may also select the Open From option.) The Open a document from server dialog box appears, as shown in Figure 21.8.
Select the name on your SAP BusinessObjects BI Platform from the left panel. Navigate through your personal and public folders or categories to select the name of the document from the document list. You may also search for the document by using the Search title box at the top of the dialog box. These search options are like those in BI Launch Pad. You can select one or many documents to be opened on your local machine. After selecting a document, click the Add button to move the document to your list of documents to be imported locally. When complete, select the Open button at the bottom of the dialog box.

Figure 21.8    Open Documents from Server Dialog Box
The new document opens by default in a new window in Reading mode.
21.3.2    Saving Reports Locally
To save a Web Intelligence Rich Client document locally, you can select Save or Save As from the File menu. Save will save the document as its original name to its original location. Save As has a number of options, including Web Intelligence Document, Excel, or PDF. These documents won't be viewable in BI Launch Pad. The next step is dependent on which file type you save the document as; these file types are located in the dropdown menu at the bottom of the dialog box.
The Save as a Web Intelligence document option opens another dialog box, which is shown in Figure 21.9.

Figure 21.9    Web Intelligence Save Document Dialog Box
Enter the Web Intelligence document File Name, Description, and Keywords as you would like them to appear within BI Launch Pad. You also can indicate whether to refresh the document upon open by selecting the Refresh on open checkbox. The Permanent regional formatting checkbox indicates that it will maintain permanent regional formatting rather than adjusting per the user's settings. The new options that are available when saving a Web Intelligence document within Web Intelligence Rich Client include:


Save for all usersSaves the document for all users to view and enables the Web Intelligence report to be moved between environments.
                

Remove document securitySaves the document as unsecured so it can be viewed in standalone or offline mode.
                

After selecting available options and indicating the report File Name, Description, and Keywords, you can select a location to save the document outside of the SAP BusinessObjects BI Platform environment. The default location is to save to your userDocs folder. The path for this folder is defined in your Web Intelligence Rich Client options, as discussed in Section 21.4.
The Save as Excel or Excel 2007 option changes the dialog box properties, as shown in Figure 21.10. When saving a Web Intelligence document as an Excel file, you have the option to convert all report tabs to Excel or select only certain report tabs for export. You can also select the option on how to prioritize the processing of the Excel document. The default settings for these preferences are defined in the Rich Client Options in the Tools menu. Further information on these options is discussed in previous chapters.

Figure 21.10    Save as Excel
The Save as PDF option opens another dialog box, as shown in Figure 21.11. When saving as a PDF, you are given the option to define which reports and pages to include in your PDF.

Figure 21.11    Save as PDF
The Save as CSV (data only) option opens another dialog box where you can define the text qualifier, column delimiter, and character set for the CSV file. There is also the option to save as CSV Archive, as discussed in Chapter 19.
21.3.3    Exporting Reports to Repository
To view these documents and share with other user within BI Launch Pad, you must save your report to the repository. To export your document to the repository, you must first be in connected mode. Then select Publish to repository from the Save dropdown list. Select the folder and categories to export your document to for viewing within BI Launch Pad, and then select the Save button, as shown in Figure 21.12. Additional export options are available by selecting the Advanced button in the dialog box. This enables options to Save for all users or Remove document security, as mentioned earlier.

Figure 21.12    Publish Document Dialog Box
21.3.4    Printing from Web Intelligence Rich Client
To print from Web Intelligence Rich Client, select the Print icon on the toolbar, as shown in Figure 21.13. You are presented with print options, as shown in Figure 21.14.

Figure 21.13    Print Icon

Figure 21.14    Print Dialog Box
21.3.5    Sending Reports as Email Attachments
Another option available in Web Intelligence Rich Client is to send a report as an email attachment using your workstation's default. From the toolbar, select Send by Email attachment (as seen in Figure 21.15).

Figure 21.15    Email Attachment Format Options
You have the choice to send the document in several formats, including Web Intelligence document, unsecured Web Intelligence document, Excel, PDF, and CSV.









21.4    Setting Preferences in Web Intelligence Rich Client
Options are available in Web Intelligence Rich Client, as shown in Figure 21.16. These options are available from the Properties ribbon under Application or from the Tools menu under Options. Preferences can be defined for Drill, Locale, Proxy, Viewing, and General preferences. Web Intelligence Rich Client preferences are managed independently from the Web Intelligence preferences defined in BI Launch Pad.

Figure 21.16    Web Intelligence Rich Client Viewing Options
For example, the General section allows you to set special folders used by the Web Intelligence Rich Client, like a folder where documents are saved locally (User Documents) and a folder where local universes used by Web Intelligence can be stored (Universes).









21.5    Summary
Web Intelligence Rich Client combines the features of web-based Web Intelligence onto your desktop with standalone capabilities that allow you to work with Web Intelligence documents in the field, on an airplane, or anywhere a connection to the BI platform is not available. Former SAP BusinessObjects Desktop Intelligence users will appreciate the new thin client capabilities of Web Intelligence provided within Web Intelligence 4.x. The ability to work whether connected or disconnected from the repository, save universes and documents locally, and use local data providers provides additional capabilities to aid the report designer in the report creation, consumption, and sharing processes.








22    Web Intelligence Interactive ViewerTo present a modern, simplified experience, a first version of the SAP BI Launch Pad and Web Intelligence are also available in SAP Fiori, the SAP user interface library used to homogenize all SAP applications.SAP BusinessObjects BI 4.2 SP 4 introduces new interfaces for BI Launch Pad and Web Intelligence. These new interfaces are provided in addition to the existing ones described in the previous chapters. They provide a new experience that follows modern standards and meets user's expectation for simplification.These new interfaces are written with SAP Fiori, the graphical library SAP uses to modernize and harmonize the user interface of all its products. Applied to SAP BusinessObjects BI, it means these analytics complement the features provided by SAP Fiori by design:

            Simplified and intuitive interface and controls that are easy to learn
        

            Supported on multiple devices and platforms, including touch-based devices
        

            In an SAP landscape, common behaviors and look and feel with other SAP products
        
This new interface for Web Intelligence is named Web Intelligence Interactive Viewer. SAP BusinessObjects BI 4.2 SP 4 includes a first version of this interface that allows only viewing workflows, described in this chapter.As this Web Intelligence Interactive Viewer is accessible from the new BI Launch Pad, we'll first explore the two tools and then discuss how this new viewer can be called from the BI Launch Pad.
22.1    New BI Launch Pad and Web Intelligence Interactive Viewer Overview
When you install or upgrade to SAP BusinessObjects BI 4.2 SP 4, new Web Intelligence and BI Launch Pad interfaces are installed and deployed in addition to the existing ones. In this chapter, we call these current interfaces classic BI Launch Pad and Web Intelligence as opposed to the new ones.

Common Document and Backend Services
These new interfaces do not require any BI platform repository or document conversion. The backend services are the same for the classic Web Intelligence and Web Intelligence Interactive Viewer; the file format is common to these interfaces.

In SAP BusinessObjects BI 4.2 SP 4, these new interfaces do not include all the features included in the classic ones, but they will be included in future releases. The new SAP BI Launch Pad allows you to:


                Browse and organize the Public Folders and your Favorites Folders


                Open Web Intelligence, SAP Crystal Reports, or SAP BusinessObjects Analysis for Microsoft Office documents
            

                Consult documents and alerts you've received in your BI Inbox


                Search the BI platform repository through an improved search


                Create categories and assign them to documents
            

                Schedule a Web Intelligence document and review your schedules and instances
            

Web Intelligence Interactive Viewer includes a new simplified experience with additional capabilities. Through this new modern interface, you can:


                View any Web Intelligence document and navigate in it
            

                Refresh the opened document
            

                Modify prompts, filters, and input controls
            

                View comments assigned to this document
            

                Rank or sort report parts data
            

To create or modify an existing document, you need to use the classic Web Intelligence HTML, Applet, or Rich Client described in the previous chapters.









22.2    Navigating in the New BI Launch Pad
By default, the address to access this new BI Launch Pad interface is:
http://<server>:<port>/BOE/BIlaunchPad
Type this address in your browser to open the login page, as seen in Figure 22.1.

Figure 22.1    New BI Launch Pad Login Page
The new BI Launch Pad shares the same BI Platform repository as the classic BI Launch Pad. You enter your same credentials and authentication mode. Click—or tap if you are on a touch device—Sign in to authenticate and log in.
22.2.1    BI Launch Pad Interface
Once you're logged in, the BI Launch Pad home page opens. As shown in Figure 22.2, in this page contains the following parts:


                    A header with the following icons:
                    

1: The User Settings button.
                        

2: The Home button.
                        

3: A dropdown menu listing all documents you have currently opened. Use it to switch from one document to another.
                        

4: The Search button.
                        



                    Below this header, several tabs (see the 5) allow you to navigate in the portal:
                    

My Home: To go to the home page.
                        

Schedule: To lists all schedules and instances you have created (Section 22.7).
                        

Inbox: To review the documents and alerts you may have received.
                        

Folders: To navigate into the BI Platform repository using a classic tree view.
                        

Recycle Bin: To see the content you have deleted and restore it if needed. 





Figure 22.2    New BI Launch Pad Home Page
By default, when you log, the displayed tab is My Home, where you can get an overview of the BI Platform repository content. You can define the content to display through several options:


6: A dropdown menu where you can select to display all documents, only your documents, the recent ones you have viewed, and more.
                

7: Select this option to display the content using tiles.
                

8: Select this option to display the content using lists.
                

9: Click the Add Category button to create a new category.
                

22.2.2    Document Contextual Menu
In any tab listing documents, a ... button is displayed near the document name. Click this button to open a contextual menu containing actions for the selected document. As shown in Figure 22.3, these commands are:


View: To open the document in Web Intelligence Interactive Viewer (Section 22.3).
                

Properties: To open a dialog box where you can set some document properties (name, description, and keywords).
                

Schedule: To schedule the document (Section 22.7).
                

Mobile Properties: To open a dialog box where you can define options to display the document in SAP BusinessObjects Mobile (see Chapter 24).
                

History: To display the document instances.


Categories: To assign categories to the document.
                

Mark As Favorite: To set a document as favorite, so it is listed in My Home • My Favorites.
                

Details: To open a panel in the right containing document details.
                

Organize: To open the submenu to copy, cut, or paste the document.
                

Send To: To send the document to another user's inbox.


Delete: To delete the document.
                


Figure 22.3    Web Intelligence Document Contextual Menu
We first describe the view action that allows you to open the document in Web Intelligence Interactive Viewer.









22.3    Viewing a Document
In BI Launch Pad, you can open a Web Intelligence document by either clicking its name or selecting the View command in the document's contextual menu (Section 22.2.2).
Both options, described in the next sections, open the document in the Web Intelligence Interactive Viewer interface.
22.3.1    Web Intelligence Interactive Viewer Interface
As shown in Figure 22.4, once you have opened your document, the BI Launch Pad header remains displayed on top of the document so you can access some of the portal's controls (Section 22.2).

Figure 22.4    SAP Web Intelligence Interactive Viewer
The Web Intelligence interface is made of the following parts:


                    A main toolbar with the following controls:
                    

1: The report selector. It displays the name of the report currently displayed and, in parentheses, the number of reports the document contains. To display another report, open this menu and select the report to display.
                        

2: The Save button, to save the document or save a new version of it (Section 22.8).
                        

3: The Refresh button (Section 22.4).
                        

4: The Filter button, to display or hide the Filters toolbar (Section 22.5).
                        

5: The Advanced button, to opens a menu with more commands.
                        

6: The Switch to standard/Advanced mode button, to enter/exit the Advanced mode, where you can sort or rank report part's data set (Section 22.6).
                        



7: The Filters bar (Section 22.5), which aggregates all controls filtering the document content: queries prompts, document filter, input controls, and element linking.
                


Designer
The first version of this Interactive Viewer is available only for reading documents. To open the current document in a new browser with Web Intelligence HTML in Design mode, in the toolbar, select the Advanced button (see 5 in Figure 22.4) and then select the Open in Designer command.

22.3.2    The Fading Toolbar
The fading toolbar is a toolbar that appears at the bottom of the Web Intelligence interface. After some seconds of inactivity, it disappears. Move your mouse to make it appear again. This toolbar offers some useful and convenient controls:


                    Click Show Navigation Map to open the side panel where you can navigate in the document by section (Section 22.3.3).
                

                    Click the Previous page < or Next page > button to move one page backward or forward. To explicitly go to a page, enter your page number in the text field between these two buttons and press (Enter).
                

                    Click the Select zoom button to display the zoom slider, as seen in Figure 22.5. Use it to zoom in and out of the document. If you have a touch screen, you can also pinch or spread the screen to zoom in and out.
                

                    Click the Fit to Width button to maximize the document width into the web viewer.
                

                    Click the Fit to Page button to scale the zoom to fit the document's page into the web viewer.
                


Figure 22.5    Fading Toolbar and Zoom Slider
22.3.3    Navigating in a Document
When a document is opened, the different ways to navigate in it through Web Intelligence new interface are:


                    In the main toolbar, the first dropdown menu lists the reports in the document. It displays the name of the report currently displayed and, in parentheses, the number of reports it contains. To display another report, open this menu and select the report to display.
                

                    As described in Section 22.3.2, you can also use the fading toolbar to go to a specific page in the report.
                

                    To navigate by section, in the main toolbar, click the Advanced button (...). In the menu that opens, select the Properties command. This opens the side panel where you can click the Show Navigation Map button to switch into the Navigation Map. You can also directly click the Show Navigation Map button in the fading toolbar (Section 22.3.2).
                    As shown in Figure 22.6, this navigation map displays the reports and the sections this document contains. As in other Web Intelligence clients (see Chapter 4, Section 4.3), you can click a report or a section to directly access it in the Report Panel.
                    
Figure 22.6    Web Intelligence Interactive Viewer Side Panel
                    You can also type a specific report or section name in the Search text file and click the magnifier button . The navigation map will be filtered to display only the names that fit your search request. Click the one to display it in the Report Panel.
                

22.3.4    Expanding and Collapsing Hierarchies
If your document is based on a multidimensional data source, you may collapse or expand hierarchies in your document.
As seen in Figure 22.7, hierarchies are displayed with a blue icon before them:


                    Click it to collapse the hierarchy () and display only the aggregated values
                

                    Click it again to expand it () and display all values for this hierarchy
                


Figure 22.7    Expanded and Collapsed Hierarchy Levels in a Crosstable
22.3.5    Comments
If a document contains block or cell comments (see Chapter 19, Section 19.3), they are also displayed in Web Intelligence Interactive Viewer. In a block or a cell, a comment can be recognized thanks to its icon. Hover the mouse on top of this icon to pop up a window with the comment. On a touch screen, tap on this icon to open this comment.
For the moment, you can't yet add a new comment or answer to an existing one.
22.3.6    Listing Document Properties
You can display some properties of the open document by selecting the Advanced • Properties command from main toolbar. This opens the side panel, with properties gathered in three sections:


General: General properties like the document's name, description, keywords, author, and more.
                

Statistics: Last refresh date, last change date, and the duration of the previous refresh.
                

Options: Some options applicable to Web Intelligence (Refresh on open, User query drill, and so on).
                










22.4    Refreshing a Document
You can refresh a document by clicking the Refresh button in the toolbar (see 3 in Figure 22.4). As in other classic interfaces, this refreshes runs all document queries to retrieve data from their data sources.
If the document contains prompts (contexts, parameters, and so on), the Prompts dialog box opens where you can answer the possible prompts.
22.4.1    Prompts
When you refresh your document, if it contains prompts or parameters, the Prompts dialog pop opens so you can answer them before retrieving data. Web Intelligence Interactive Viewer supports the same prompts as the Web Intelligence HTML, Applet, or Rich Client do: multi-values, mandatory prompts, cascading prompts, and more.
As seen in Figure 22.8 1, the Prompts dialog box lists all prompts of the document that you may answer. A blue star is displayed before the mandatory prompts. If there are optional prompts, the Mandatory button displays the number of mandatory prompts that must be answered. Click it to hide or unhide the non-mandatory prompts from the list. To answer the prompts to refresh the document, follow these steps:


                    In the list of prompts displayed in the Prompts dialog box, select one by clicking it. Depending on the prompts type, the Prompts dialog box displays:
                    

                            The list of possible values for this prompt, as shown in Figure 22.8 2.
                        

                            A text field where you can manually enter a value.
                        



                    Click the checkbox before the answers to select for this prompt, as shown in Figure 22.8 3. Once your answers have been selected, click OK.
                

                    The Prompts dialog box redisplays the initial list of prompts you may answer. The values you have selected for the first prompt are listed behind this prompt.
                

                    Repeat these steps for all prompts you need to answer. When you have answered all the prompts, the Run button is enabled, as seen in Figure 22.8 4. Click it to close the dialog box and run the query with your answers.
                


Figure 22.8    Prompts Dialog Box
In the Prompts dialog box, you can also create, use, and manage BI variants.
22.4.2    BI Variants
Web Intelligence Interactive Viewer supports BI variants management (see Chapter 12, Section 12.3):


                    After you have answered your prompts, click the Save current variant or create a new one button  located in the Prompts dialog box header.
                

                    The Create Variant panel opens, as shown in Figure 22.9. Type a name for your variant.
                

                    Use the checkboxes beside the different prompts to select their answers to keep in the variant. The values for the unchecked ones are not kept in the variant.
                

                    Click Save to save your variant and return to the Prompts screen. The header displays the name of the variant you have created.
                

                    Click Run to run your query.
                


Figure 22.9    Create Variant Screen
The next time you need to answer these prompts with the same answers:


                    Select the Variants Management icon  in the Prompts dialog box header.
                

                    The Available Variant screen opens and displays all variants you have created for this document.
                

                    Select a variant. The Available Variants screen closes and the answers for the prompts saved in the variant are applied.
                

                    If needed, answer the prompts that were not saved in the variant and click Run to run your query.
                

You can delete a variant in the Available Variant screen, by clicking the Delete icon  beside the variant to delete.









22.5    Filtering a Report
As seen in the previous chapters, Web Intelligence includes different methods to filter data: filters, input controls, element linking, and more. In the new Web Intelligence Interactive Viewer, for simplicity's sake, all these filtering methods are gathered in a single place: the Filters toolbar. By default, this toolbar is hidden. Click the Filters icon (see 4 in Figure 22.4) to display or hide it. As shown in Figure 22.10, it contains one prompt, one document input control (Month), and one report group input control (Location).

Figure 22.10    Filters Toolbar with Prompts, Document, and Report Input Control
This toolbar displays the filters in the following order:


Prompts


Document Group Input Controls and Input Controls


Report Group Input controls and Input Controls


Drill Filters


Element Linking


Let's discuss these filters in detail.
22.5.1    Listing Prompts Values
The Filters bar first displays the number of prompts of your document. Click the Prompts icon  to open a dialog box that lists them and their answers, as seen in Figure 22.11. In this dialog box, you can use the Search text field to filter this list with a specific string.

Figure 22.11    Prompts Summary from Filters Bar
22.5.2    Document and Report Input Controls
If input controls or group input controls have been defined in your document, they are also displayed in the Filters bar. They are displayed in two sections of the Filters bar: document input controls  and report input controls . Their behavior is similar:


                    Input controls are displayed with their selected values. You may click one of them to open a dialog where you can select values for this input control, as seen in Figure 22.12. The user control (sliders, checkboxes, and so on) is the one selected at input control creation (see Chapter 9, Section 9.3.3).
                


Figure 22.12    Modifying an Input Control (Slider)


                    Group input controls are collapsed by default; only their name and the number of its input controls that have been used for filtering are displayed. You can take following actions:
                    

                            Click a group input control to expand it, as shown in Figure 22.13 1.
                        

                            Click the Add filter button  to select an input control from the group to use. Figure 22.13 2 shows a group where you can select City or State.
                        

                            Once you have selected an input control, it is displayed in the group, as shown in Figure 22.13 3. You can add other input controls from the group. The input controls selection order defines the filter path, as seen in Figure 22.13 4.
                        

                            Answer each input control individually, as explained previously. As input controls belong to the same group, the values selected for an input controls filter the possible values in other input controls if they follow the filter path, as shown in Figure 22.13 5.
                        

                            To remove an input control, hover the mouse over the input control and click the icon  that appears.
                        

                            Click the icon  to collapse the group and displays only the number of input controls used for filtering, as shown in Figure 22.13 6.
                        




Figure 22.13    Answering Group Input Controls
22.5.3    Drill Filters
If the document has been saved with the drill option enabled (see Chapter 10, Section 10.6), then you can also drill in Web Intelligence Interactive Viewer.
As shown in Figure 22.14, if the document has the drill option enabled, the Filters toolbar displays a group named Drill filters. Click it to expand these filters.

Figure 22.14    Drill in Filters Toolbar
As for input controls, in the Filters toolbar, you can:


                    Click the Add drill filter button  to open a dialog box where you can select a new dimension to drill.
                

                    Click a drill filter to open a dialog box where you can modify the filter value.
                

                    Hover the mouse over the drill filter and click the icon  that appears to remove it.
                

                    Click the icon  in front of the drill filters to collapse them.
                

Additionally, you can also click in the report part to drill down or the drill icon  in the header to drill up.
22.5.4    Element Linking
If your document contains element linking (see Chapter 15, Section 15.4), you can use it to filter report parts by selecting values from another report part.
When you open a report, for a few seconds, a blue border can be seen around report parts that have been filtered by other report parts through element linking.


                    Click a value in a table to filter the other blocks that are linked to these values. A pop-up message appears briefly at the bottom report to display the filtered value, before disappearing. In the Filters bar, the Linking Elements button  appears to show that an element linking has been used.
                

                    To remove this filter, you can:
                    

                            Re-click the same value.
                        

                            Or in the Filters bar, click the Linking Elements button. A list of filters used for element linking opens, as seen in Figure 22.15. Select the icon  that appears to remove the corresponding filter.
                        




Figure 22.15    Linked Element in Filters Toolbar









22.6    Sorting or Ranking Data in a Report
Compared to the classic Web Intelligence clients that clearly separate Reading and Design modes, the new interface is an interactive reader that allows you to apply some analysis on a document: sorting and ranking.
If you have the appropriate rights to modify a document, then in the toolbar, the Advanced icon (see 6 on Figure 22.4) is enabled. Click it to enter the Advanced mode. In this mode, when you click a report part (table or chart), a new contextual menu appears on its top-right corner where you can sort or rank the report part data set.
To sort the data set:


                In this contextual menu, select the Sort command.
            

                In the Sort dialog box, click the Add sort button . A new dropdown list is added to the dialog box. This list contains the objects used by the report part.
            

                In this dropdown list, select the object whose data will be sorted. For example, if your data set contains state names, select the State object to sort them alphabetically.
            

                Beside the dropdown list, select the Sort ascending or Sort descending button to define how the list must be sorted.
            

                Repeat these steps to sort your data set through other criteria, as seen in Figure 22.16. Click the icon  on a line to delete the corresponding sort or the Remove All button to remove them all.
            

                Click OK to apply these sorts to the report part data set.
            


Figure 22.16    Sort Dialog Box

Sort on Crosstable
If your table is a crosstable, you can sort the columns, the rows, or both, as seen in Figure 22.17.

Figure 22.17    Sort on Crosstable

You can also directly apply a sort on a column by clicking a first time on the table, then a second time on the column to select it: the contextual menu appears on the column, as seen in Figure 22.18 1. Select the Sort command to apply a descending sort on the column data. An icon appears to indicate the descending sort, as seen in Figure 22.18 2. Repeat these steps to apply an ascending sort on the column, as seen in Figure 22.18 3. Reselecting this Sort command a third time removes the sort from the column.

Figure 22.18    Sort Applied on a Column

Custom Sort
Custom sorts are not yet supported.

To rank the data set:


                In the Advanced mode, select a report part, and in its contextual menu, select the Rank command.
            

                In the Rank dialog box (Figure 22.19 1), select the ranking options:
                

                        Select the Top or Bottom radio buttons.
                    

                        Enter the number of lines to return.
                    

                        In the Based on dropdown list, select the object to use to rank the data set.
                    



                Click Advanced to show more options for your ranking, as seen in Figure 22.19 2:
                

                        You can define both top and bottom ranking at the same time.
                    

                        You can also define the objects to rank by and the aggregation mode.
                    



                Click OK to apply these rankings to the report part data set.
            


Figure 22.19    Rank Dialog Box
The same dialog box can be opened by selecting the Rank command from the column contextual menu, but in this case, you cannot change the column used to rank the data set.









22.7    Scheduling a Document
In the BI Launch Pad, you can also schedule a Web Intelligence document so it is refreshed at a specific time (see Chapter 19,  Section 19.6). To do so, in the document contextual menu (Section 22.2.2), select the Schedule command to open the Schedule dialog box, as shown in Figure 22.20.

Figure 22.20    Schedule Dialog Box
This dialog box contains the following tabs where you can define the schedule parameters, which are similar to the ones in the classic BI Launch Pad:


Instance Title: Enter a name for the instance.
            

Recurrence: Select the schedule recurrence in the Run Report dropdown list. Compared to the classic BI Launch Pad, the different options have been organized into four main categories:
                

Now: To run the schedule immediately.
                    

Once: To run the schedule only once.
                    

Recurring: To define a recurrence for the schedule. Depending on your recurrence choice (hourly, daily, weekly, monthly, or specific day in the month), you must define additional parameters.
                    

Calendar: To define the schedule on a calendar defined in the BI platform repository.
                    



Formats: Select the format generated by the schedule. Depending on the selected format, you must provide additional details to define it.
            

Events: Select the events that can trigger the schedule and/or the ones to trigger after the schedule completion.
            

Scheduling Server Group: Select the server to process the schedule. 


Destinations: Select the schedule destination. Depending on the selected destination, you must provide additional details to define it.
            


Prompts and Cache
In SAP BusinessObjects BI 4.2 SP 4, the prompts and cache options are not yet available.

Once you have defined your schedule, click Schedule to create it and add it into the processing pool.
To control the schedules you have created and their generated instances:


                In the new BI Launch Pad, select the Schedule tab.
            

                In the calendar displayed on the left side, select a starting day and an end day.
            

                Click Show Schedules.
            

                The schedules planned and instances generated in the period you have selected are displayed in a list, as shown in Figure 22.21.
            


Figure 22.21    Schedule Tab
From an instance's contextual menu (Section 22.2.2), you can select:


View Latest Instance to open the document's latest generated instance.
            

History to get the list of all instances generated for this document.
            










22.8    Saving and Exporting to XLS and to PDF
From Web Intelligence Interactive Viewer, you can also save the opened document into PDF and XLS. To do so, select the Export to PDF or Export to Excel commands in the menu from the Advanced button in the toolbar. This generates the PDF or XLS file on your file system, in your Downloads folder (the path of this folder depends on your operating system).
After you have refreshed a document or changed its filter values (Section 22.5), you can save your document to keep these changes. To do so, select the Save icon from the toolbar. Then, from the menu, select:


                The Save command to simply save the document.
            

                The Save as command to save the document in another location or with a different name.
            










22.9    Setting Web Intelligence Preferences
You can define your preferences for Web Intelligence in the Settings dialog box. Open this dialog box by clicking the User Settings icon in BI Launch Pad toolbar (see 1 in Figure 22.2). A sliding panel appears where you can click the Settings button to open the Settings dialog box.
In the dialog box, you can modify your BI Launch Pad settings, such as your password in User Account or your preferred viewing locale and product locale in Account Preference.
Some Web Intelligence preferences (see Chapter 1, Section 1.3) can be changed in Application Preferences • Web Intelligence, as seen in Figure 22.22:


                The locale to use to format the data (document locale or preferred viewing locale)
            

                Microsoft Excel export options
            

Click Save to save your changes and exit the Settings dialog box. Click in the BI Launch Pad page to hide the User Settings sliding panel.

Figure 22.22    Web Intelligence Application Preferences









22.10    Logging Out
To log out from the new BI Launch Pad, click the User Settings icon in its header (see 1 in Figure 22.2).
In the sliding panel that appears, click the Log Out button to log out.









22.11    Summary
SAP BusinessObjects BI 4.2 SP 4 introduces a new interface for the BI Launch Pad and Web Intelligence. This new interface comes in addition to the existing Web Intelligence interfaces. It includes a simplified experience that follows modern user interface standards (touch-based, intuitive, mobile, and so on), thanks to SAP Fiori, the SAP graphical library used to harmonize SAP application user interfaces.
In SAP BusinessObjects BI 4.2 SP 4, for the first release of these interfaces, only the most common features are available: navigating in the BI platform repository and viewing, refreshing, and scheduling a Web Intelligence document with some additional interactive features (all filters gathering in a single place, ranking, and sorting). For the moment, creating and editing a Web Intelligence document must still be done using the other Web Intelligence interfaces.








23    Connecting SAP BusinessObjects Live Office to Web Intelligence and UniversesSAP BusinessObjects Live Office is a powerful tool to enable the use of Business Intelligence content within Microsoft Office documents. SAP BusinessObjects Live Office allows a larger audience to consume, query, analyze, and visualize the content of Web Intelligence documents and universes in a familiar interface.With SAP BusinessObjects Live Office, you can work with your business intelligence content within Microsoft Office applications such as Word, Excel, PowerPoint, and Outlook. This functionality allows you to quickly and easily collaborate with other users across your organization. It also empowers users of different skillsets or comfort levels to manipulate their Web Intelligence query results within other mediums. This chapter reviews the core functionality, basic settings, and usage of the SAP BusinessObjects Live Office product with Web Intelligence documents. SAP BusinessObjects Live Office 4.2 supports Microsoft Office 2010 SP 1+, 2013, 2016, and 365. The menu options may appear different in the different versions as compared to those shown in this chapter.
23.1    Introduction to SAP BusinessObjects Live Office
SAP BusinessObjects Live Office is a Microsoft Office plug-in that can be installed on a client machine. After SAP BusinessObjects Live Office has been installed on your machine, a new Live Office ribbon appears on your toolbar when you are in Microsoft Office applications (Excel, PowerPoint, Word, or Outlook), as shown in Figure 23.1.

Figure 23.1    Live Office Ribbon from within Excel
To do further manipulation within the Office applications, SAP BusinessObjects Live Office allows you to bring data from:


                Web Intelligence documents based on universes—created with the Universe Design Tool (UNV) or the Information Design Tool (UNX)— and SAP Business Explorer (BEx) queries.
            

                SAP Crystal Reports; however, SAP Crystal Reports for Enterprise is not supported.
            

                Queries based on relational universes created with the Universe Design Tool (UNV) or the Information Design Tool (UNX).
            

Excel is frequently used with SAP BusinessObjects Live Office because it lets users perform further analysis of the data in a familiar place. Users in finance departments are often very familiar with Excel, and SAP BusinessObjects Live Office gives them a tool that works within their comfort zone and requires little additional training.
The integration of Web Intelligence content within SAP BusinessObjects Live Office provides a powerful tool for the end user and report writer alike. To integrate Web Intelligence content, a Web Intelligence document must already exist in the repository for access within SAP BusinessObjects Live Office. This document content can be brought into Word, Excel, PowerPoint, or Outlook. For the purpose of this chapter, we use Excel to integrate our Web Intelligence content.
23.1.1    Integration with Web Intelligence Documents
SAP BusinessObjects Live Office enables you to insert Web Intelligence content into your Office documents as tables, charts, or freestanding cells.

Tip
Consider the format of the application you're adding content to. If you're using PowerPoint, for example, make sure you have adequate space available for your content to display.

Excel is the most common destination for Web Intelligence content because it uses a tabular interface and enables further manipulation of the data. A user who is not fully trained on how to use Web Intelligence can easily create a report using Web Intelligence content from within SAP BusinessObjects Live Office.
23.1.2    Live Office Ribbon Menu
The Live Office ribbon menu is available from within your Word, Excel, PowerPoint, or Outlook documents. The ribbon menu, as shown earlier in Figure 23.1, enables quick access to the most commonly used functions available within SAP BusinessObjects Live Office.
The following options, available on the Live Office ribbon menu, are organized by pane:


Insert


Crystal Reports: This option opens the Live Office Insert Wizard to define the options available for inserting content from an SAP Crystal Report.
                        

Web Intelligence: This option opens the Live Office Insert Wizard to define the options available for inserting content from a Web Intelligence document.
                        

Universe Query: This option opens the Live Office Insert Wizard to define the options available for creating a universe query to insert results into your destination Office document.
                        



Object Actions


Go To Object: In this dropdown menu, select a report part inserted in your SAP BusinessObjects Live Office document to go to this specific report part.
                        

Modify Object: This option allows you to modify the properties for a specific object.
                        

Refresh Object: This option enables you to refresh the selected object only.
                        

Refresh All Objects: This option lets you refresh all objects contained in your SAP BusinessObjects Live Office document.
                        



Explore


Selection: This enables you to export a selection in your SAP BusinessObjects Live Office document to SAP BusinessObjects Explorer for further analysis.
                        

Sheet: This feature enables you to export an entire sheet in your document to SAP BusinessObjects Explorer for further analysis.
                        



Publishing


Create Snapshot: This option enables you to create a snapshot of the document in the current state to save for further reference. More information on snapshots is discussed in Chapter 10, Section 10.5.
                        

Save to Repository: This option saves the SAP BusinessObjects Live Office document to the BI platform repository to share and collaborate with others in your organization.
                        

Save as New to Repository: This option allows you to save an SAP BusinessObjects Live Office document existing in the BI platform repository as a different name or to a different location.
                        

Open from Repository: This option allows you to open an SAP BusinessObjects Live Office document saved to the BI platform repository.
                        



Settings


Object Properties: This option allows you to define object-specific properties (Section 23.5.3).
                        

Refresh Options: This option allows you to define refresh options for the SAP BusinessObjects Live Office document (Section 23.5.2).
                        

Application Options: This option allows you to define SAP BusinessObjects Live Office application options (Section 23.5.1).
                        



View


Object in Browser: This option opens the object in a browser window.
                        

Help: This option opens the SAP BusinessObjects Live Office Help dialog box.
                        

About Live Office: This option shows the version information for your current SAP BusinessObjects Live Office installation.
                        



Now that you're familiar with the SAP BusinessObjects Live Office basics, let's shift our attention to how to create documents in this tool that contain valuable information retrieved from Web Intelligence document or universe.
23.1.3    Accessing the Live Office Insert Wizard
If you haven't already logged on or selected auto-authentication (Section 23.5.1), then the login dialog box appears as shown in Figure 23.2. In this dialog box, enter:


User Name and Password: Your credentials to the BI platform.


Web Services URL: The URL to connect to the server that answers to SAP Live Office calls. This URL must follow this syntax: 
http://<webserver>:<portnumber>/dswsbobje/services/session
<webserver> and <portnumber> identify the server to connect and must be replaced with the appropriate information given to you by your SAP BusinessObjects BI administrator. For example:
http://myserver:8080/dswsbobje/services/session


System: The BI platform repository to connect. You do not need to enter it if it has the same name as the web server you listed in the Web Services URL.
                

Authentication: The authentication mode.
                


Figure 23.2    Authentication to the BI Platform from SAP Live Office









23.2    Creating Queries from Universes
Once connected, you can also directly create a query on top of a universe saved in the BI platform repository. Live Office supports relational universes created with the Information Design Tool (UNX) or the Universe Design Tool (UNV). But it does not support the multidimensional universes created with the Information Design Tool (UNX).
Once a query is created and run, the query's retrieved data set is displayed in the Office application. When you save your document, the query is saved in it as well. Later, you can re-run this query to get an updated data set or edit the query to modify it.
23.2.1    Selecting the Universe
Navigate to the appropriate cell where you want the content to be dropped in your Excel worksheet. From the Live Office ribbon menu, select the Universe Query button from the Insert tab to open the Live Office Insert Wizard. It will guide you through the query creation.
The first step in the Live Office Insert Wizard is to select the universe to use to query data in your Excel document. Figure 23.3 shows the Choose Universe screen in the Live Office Insert Wizard.

Figure 23.3    Choosing a Universe in the Live Office Insert Wizard
The screen displays the universes available within the repository. This view displays the folders in the BI Platform. You can also search a universe by its title, keyword, content, or all. Highlight the name of your chosen universe and select Next.
23.2.2    Creating the Query
Once you have selected the universe to query, the Live Office version of the Query Panel opens. As seen in Figure 23.4, this Query Panel is similar to the Web Intelligence's Query Panel for relational universes and provides the following features and functions (see Chapter 2, Section 2.2):


                    It presents the universe objects in the left pane.
                

                    You can drag objects to add in your query from this left pane and drop them into the Result Objects area. To change the objects' order in the query, select an object and use the arrows buttons in the right side of the Query Panel.
                

                    You can drag objects to filter the data set from this left pane and drop them into the Filter Objects area. Select the filters operator and the values to use for filtering.
                

                    If you have selected the values to be entered through a prompt, you can set the same prompt parameters described in Chapter 9, Section 9.1.6, as shown in Figure 23.5.
                

                    In the toolbar, you can use the Sub-Query, Ranking, or Sort icons to use these filters in your query, assuming the underlying database supports them.
                


Figure 23.4    Universe Query Panel

Figure 23.5    Prompt Properties
When you have created your query, select Next.
23.2.3    Running the Query
To retrieve data, the query you have created must be refreshed on the server. If your query contains prompts, then they are displayed in a dialog box similar to the Web Intelligence Prompts dialog box (see Chapter 2, Section 2.4.2), as shown in Figure 23.6.

Figure 23.6    Specify Prompt Values
Answer at least the mandatory prompts, then click Next to move to the wizard's last step.
23.2.4    Displaying the Summary
The last step of the wizard is the Summary panel. It reminds you the universe to query, as shown in Figure 23.7.

Figure 23.7    Summary
If needed, give another name to your new SAP BusinessObjects Live Office content.
Click Finish to run the query and retrieve the data set in the Excel spreadsheet.









23.3    Retrieving Web Intelligence Content
In addition to creating a new query, SAP BusinessObjects Live Office allows you to import a Web Intelligence report element into your SAP BusinessObjects Live Office document. To do so, once connected, navigate to the appropriate cell where you want to drop Web Intelligence content in your Excel worksheet. From the Live Office ribbon menu, select the Web Intelligence button from the Insert tab. The Live Office Insert Wizard displays.
23.3.1    Selecting the Web Intelligence Document
The first option in the Live Office Insert Wizard is to select the Web Intelligence document to use for content in your Excel document. Figure 23.8 shows the Choose Document screen in the Live Office Insert Wizard.

Figure 23.8    Choosing a Document in the Live Office Insert Wizard
The screen displays the Web Intelligence documents available for integration within the repository. This view displays the folders and categories in the BI platform. You can navigate by folders or categories by selecting the icons at the top. You can also search by title, keyword, content, or all fields to find a document. Highlight the name of your chosen document and select Next.
23.3.2    Selecting Document Content
After choosing the Web Intelligence document, if your document has been set to refresh when it is opened  (see Chapter 2, Section 2.7), then before you can select the document content to insert, the document must first be refreshed. If the document contains contexts and prompts, they are first displayed to you so you can answer them. For example, Figure 23.9 shows the dialog box where you can select the queries' context.
Identically, prompts, if any, are displayed in a dialog box, as shown in Figure 23.10.

Figure 23.9    Answering Contexts

Figure 23.10    Answering Prompts
After you have selected contexts and prompts, or if your document does not require that to be opened, you can select the content to be included in the SAP BusinessObjects Live Office document.
As shown in Figure 23.11, the Choose Data dialog box allows you to:


                    Navigate in the document and display the document's report by selecting the tab or the navigation tree on the left pane.
                

                    Select the report part(s) to include it in the report.
                    

                            Click on a report element to select it. Selected report part(s) are highlighted with a blue background.
                        

                            Click on a selected report part to unselect it.
                        

                    All selected blocks are brought into your SAP BusinessObjects Live Office document starting at the cell where you placed your cursor.
                


Figure 23.11    Choosing Report Elements


                    The toolbar can be used to:
                    

                            Zoom in and zoom out the report display
                        

                            Find a specific text in the page
                        

                            Go the first, previous, next, or last page
                        

                            Hide/unhide the left pane
                        

                            Switch between Page mode and Quick Display mode (see Chapter 4, Section 4.4.3)
                        



After making all selections of relevant report parts, select Next. If you have not selected any report parts, this button remains disabled.
23.3.3    Displaying the Summary
Upon selection of the report parts to be included in your SAP BusinessObjects Live Office document, you are shown the Summary, as shown in Figure 23.12. At this time, you'll give a name to your particular SAP BusinessObjects Live Office content before selecting Finish.

Figure 23.12    Summary before Inserting Web Intelligence Content
SAP BusinessObjects Live Office connects to the SAP BusinessObjects BI repository to retrieve the report element(s) you have selected:


                    Tables and cells are inserted as tables in the spreadsheet, allowing you to manipulate figures it contains in Excel.
                

                    Charts are inserted as pictures.
                

After you have inserted your content, you will very likely have to edit this content.









23.4    Editing Added Content
After your selected content is displayed in Excel, the different edit actions you may perform on the report elements you have inserted are located in the Live Office tab and are gathered under the Object Actions pane. These actions are:


Go To Object: Use this dropdown menu and select one of the report elements you've inserted to put the focus on this report element in Excel.
            

Modify Object: In this dropdown menu (shown in Figure 23.13), you'll find the following commands:
                

Insert Row and Insert Column: Select a report element of type table and select one of these commands to add a row or column into the report element. Added row(s) and column(s) remains if you refresh the report element.
                    

Insert Row and Insert Column: To remove one of the rows or columns added, as previously described.
                    

Prompt Setting: If the selected report element requires you to answer some prompts when the query is refreshed, this command opens the Specify Prompt Values dialog box (shown in Figure 23.14), where you can set some settings for each prompt.
                    

Properties...: To open the Live Office Object Properties dialog box described in Section 23.5.3.
                    

New Object From Same Report: Select an already inserted report element and select this command to reinsert another report element from the same document. The Live Office Insert Wizard appears to select the relevant options using the same Web Intelligence document, as described in Section 23.3.2.
                        
Figure 23.13    Modify Object Menu





Figure 23.14    Set Prompt Properties


Refresh Object: To refresh the selected, inserted report element.
            

Refresh All Objects: To refresh all inserted report elements.
            

When you refresh one or several report elements, if they require you to answer some prompts, then these prompts are displayed, as shown in Figure 23.10. After you have answered them, the queries are sent to the servers running on the SAP BI platform and the result set is returned in the Excel document.









23.5    Setting Preferences
You can customize your session using a number of preferences within SAP BusinessObjects Live Office. Preferences apply to application options, refresh options, object properties, and prompt binding options.
23.5.1    Application Options
To define default settings for all your SAP BusinessObjects Live Office documents within the application, select Settings • Application Options from the Live Office ribbon menu. This opens the Options dialog box. This dialog box contains tabs for the three types of application options: General, View, and Enterprise.
General Options
The General tab properties vary depending on the Office application. In the General tab from Excel (shown in Figure 23.15), you can define the Shortcut Menu options. In addition, options for the treatment of SAP BusinessObjects Live Office cells and refresh options are available:


Prompt before overwriting Live Office cells: To prompt you before you can type over content that is being fed by your business intelligence content.
                    

Refresh Live Office object when binding cell changes: To refresh content when you bind your Business Intelligence content to cells in your Excel spreadsheet.
                    

Refresh Live Office object on document open: When opening a document, SAP BusinessObjects Live Office returns the most recent results from the BI platform repository for your specified content.
                    

Copy and paste with Live Office connectivity: Enables you to move bound ranges without losing the connectivity to SAP BusinessObjects Live Office. If this is disabled, then only the results will move, and the copied content won't be refreshed when the SAP BusinessObjects Live Office content is refreshed.
                    

Update formulas to include/exclude cells when refreshing: To automatically update SAP BusinessObjects Live Office objects' formula when they are refreshed, if cells are added or removed from the retrieved data set.
                    


Figure 23.15    General Tab in Options Dialog Box
View Options
The View tab options, shown in Figure 23.16, affect how the data will be displayed in your SAP BusinessObjects Live Office document. For Excel, the possible options are:


                        The Appearance options are set to determine whether the formatting from the original report should be maintained. The Appearance options also allow you to set whether to show filters as comments in the SAP BusinessObjects Live Office document and to alert you when a time-consuming operation occurs that will affect a defined number of cells.
                    

                        The View tab options also define how cells will display for default cell values of No Data, Data Error, and Concealed Data.
                    

                        The Column Heading options can be used to define column headings to be set to the Field Name, Field Description, or Both by default.
                    


Figure 23.16    View Tab in Options Dialog Box
Enterprise Options
The Enterprise tab options, as shown in Figure 23.17, allow you to define your login parameters, so you don't have to re-enter them each time you use SAP BusinessObjects Live Office.

Figure 23.17    Enterprise Tab in Options Dialog Box
Select the Use specified logon criteria checkbox and enter the parameters you use to connect to the BI platform using SAP BusinessObjects Live Office (Section 23.1.3):


User Name and Password: Your credentials to the BI platform.
                    

Web Services URL: The URL to connect to the server that answers to SAP BusinessObjects Live Office calls. This URL must follow this syntax:
http://<webserver>:<portnumber>/dswsbobje/services/session
<webserver> and <portnumber> identify the server to connect and must be replaced with the appropriate information given to you by your SAP BusinessObjects BI administrator.
                    

System: The BI platform repository to connect. You do not need to enter it if it has the same name as the web server you gave in the Web Services URL.
                    

Authentication: The authentication mode. 


Select the Specify OpenDocument URL for viewing object in web browser checkbox and enter an openDocument URL to view objects in a browser using this URL (see Chapter 15, Section 15.3).
23.5.2    Data Refresh Options
The data in a report can be set to refresh based on the original document, an instance of it, or on demand. The following options are available for refreshing data by selecting a report part and then selecting Settings • Refresh Options. This opens the Refresh Options dialog box shown in in Figure 23.18, where you can set the following options:


Latest InstanceThe first option in this dialog box is to refresh data based on the latest instance of a scheduled document (see Chapter 19, Section 19.4). Therefore, the SAP BusinessObjects Live Office data will refresh as the scheduled document data refreshes. The SAP BusinessObjects Live Office object will use the latest instance of the document for its data.
                

On DemandThis option enables you to manually refresh the SAP BusinessObjects Live Office document when you want updated data. The source of the update will come from the database rather than from the original Web Intelligence report or instance.
                

Use Report Saved DataThis option refreshes the SAP BusinessObjects Live Office objects with the data saved in the original Web Intelligence document contained in the BI platform repository.
                

Specific InstanceThis option enables you to use one of the scheduled instances of a Web Intelligence document as the source data for the SAP BusinessObjects Live Office document.
                


Figure 23.18    Refresh Options Box
23.5.3    Object Properties
The Settings • Object Properties screen shown in Figure 23.19 allows you to specify properties that are specific to an object contained in your SAP BusinessObjects Live Office document. An object is defined as one of the report parts from the Web Intelligence document.
When you click on each object, detailed information about the object is shown on the right side of the box. Specific details on the Web Intelligence document used in the SAP BusinessObjects Live Office document are also contained within the Objects/Reports box at the top. By clicking on each of these objects, you can see the properties display to the right.

Figure 23.19    Object Properties Dialog Box
To set refresh properties for the object, select the object from the Objects of the Report box on the bottom left, and then select the appropriate properties in the Refresh tab (see Figure 23.20). Available properties include whether to Apply report format when refreshing, Conceal data on saving, and Refresh Setting. Conceal data on saving enables you to secure the data so that a refresh must be made before a user can view the data. This will ensure that the user is seeing only the data that he is allowed to access, given his security settings.

Figure 23.20    Refresh Object Properties Box









23.6    Summary
SAP BusinessObjects Live Office is a powerful tool that enables you to retrieve Web Intelligence document content and query universes within Microsoft Office documents. This combines the power of business intelligence queries in a comfortable, familiar setting for end users and report writers alike.
The next chapter discusses another powerful tool to customize your Web Intelligence reporting experience. SAP BusinessObjects Mobile allows users to create customized mobile reporting to be shared on mobile devices, which is one more step toward a completely integrated business intelligence reporting experience.








24    Mobile Business IntelligenceBecause the mobile landscape has changed significantly in recent years, business intelligence must respond accordingly to provide advanced analytics available on mobile devices. Web Intelligence answers this need through on-device mobile integration with SAP BusinessObjects Mobile.The ability to quickly and easily view, analyze, and interact with key metrics while performing day-to-day activities is a requirement for today's organizations. For everyone from executives to operational employees, business analytics provide a consumable source of data on the current status of the company, enabling them to respond quickly to business needs. Web Intelligence documents can be easily created for mobile consumption and made available on a variety of mobile devices. Mobile Business Intelligence can be deployed in a range of form factors and from tablets to phones that use Apple iOS (iPad and iPhone) and Android OS. In addition to Web Intelligence, the SAP BusinessObjects Mobile application integrates with your SAP Crystal Reports, SAP BusinessObjects Dashboards, SAP BusinessObjects Explorer, and SAP Lumira. The SAP BusinessObjects Mobile BI application provides powerful functionality to answer the call for on-device analytics for today's increasingly mobile workplace.
24.1    Introducing SAP BusinessObjects Mobile
It's hard to believe that just a decade ago, mobile business intelligence meant squinting at a Blackberry device, waiting for content to be delivered over a slow and possibly unreliable mobile network. Today, SAP supports a mobile experience on much more capable iOS and Android devices.
As of this writing, SAP BusinessObjects Mobile 6.5 for iOS (available from the Apple iTunes App Store) and SAP BusinessObjects Mobile 6.2 for Android (available from the Google Play store) are the most recent versions. The current version of SAP BusinessObjects Mobile for iOS supports content from all the major SAP Business Intelligence applications, including SAP Crystal Reports, SAP BusinessObjects Dashboards, SAP BusinessObjects Design Studio, SAP BusinessObjects Explorer, SAP Lumira, and SAP BusinessObjects Web Intelligence. SAP introduces new features on iOS first and later adds them to the Android edition, which is why we used iPhones and iPads to write this chapter. Expect innovation to continue at a breakneck pace, realizing that new mobile features frequently require the software on both the Business Intelligence platform as well as the mobile device to be upgraded to the latest versions.

Note
New mobile features are frequently dependent on changes to the business intelligence platform. Be sure to review the release notes when new versions of mobile applications are released, taking note if server-side patches are required to use new features.










24.2    Designing Reports for Mobile Viewing
Unlike previous generations of mobile devices with small screens, limited memory, and slow connection speeds, today's mobile devices provide high-resolution displays, operating systems that support application development, and high-speed 4G and WiFi connectivity. Although screen resolution on an Apple iPad is significantly greater than an iPhone, report designers must still consider overall readability on a mobile device. Additionally, some features available on desktop- and browser-based Web Intelligence remain unsupported on the mobile application. When viewing reports in tables, charts, and other visual representations, it's important to consider whether the information is still coming across as clear. As a report designer, it is important that you are able to test the reports you create on the mobile devices your organization intends to support.
Figure 24.1 illustrates how vertical, horizontal, and crosstables appear in the BI Launch Pad.
These same tables preserve most of their formatting when viewed from the SAP BusinessObjects Mobile app (see Figure 24.2).

Figure 24.1    Tables Viewed in the BI Launch Pad

Figure 24.2    Tables Viewed on SAP BusinessObjects Mobile
As you learned in Chapter 6, Web Intelligence has an extensive library of charts; however, not all of these charts can be viewed on mobile devices. Figure 24.3 shows a 3D pie chart in the BI Launch Pad.
However, the three-dimensional pie chart is currently unsupported by the SAP BusinessObjects Mobile application. When the SAP BusinessObjects Mobile application can't render content, a Content not supported error is displayed, as shown in Figure 24.4.

Figure 24.3    Three-Dimensional Pie Chart in BI Launch Pad

Figure 24.4    Three-Dimensional Pie Chart Viewed in SAP BusinessObjects Mobile
Because not every Web Intelligence document renders properly on a mobile device, SAP utilizes some reserved corporate categories to control whether a Web Intelligence document is available to mobile devices. By using these categories, you can limit the documents visible to a mobile audience.
24.2.1    Mobile Categories
The SAP BusinessObjects BI platform uses categories to control which Web Intelligence documents will display correctly on mobile devices, as explained in Table 24.1. These categories can either be created in the BI Launch Pad or the Central Management Console (CMC) and should be assigned sufficient rights by the SAP BusinessObjects BI administrator.




                            Category
                        

                            Description
                        





Mobile


                            Acts as a control switch to determine if a Web Intelligence document should be displayed on a mobile device. Renders reports on mobile devices using a "card" layout.
                        



MobileDesigned


                            Formats mobile documents as closely as possible to their original layout; also known as "page layout."
                        



Confidential


                            Prevents users from saving Web Intelligence documents tagged with the category on their mobile device, even if the SAP BusinessObjects BI platform settings allow users to save documents.
                        



Featured 


                            Allows documents to be auto-downloaded to the mobile device when a user logs in to a server or refreshes the Home screen.
                        



Table 24.1    Mobile Device Web Intelligence Document Displays
These categories can be created side-by-side at the top level, although you may find them easier to work within a hierarchy (see Figure 24.5). Create the Mobile category at the top level, and then create Confidential, Featured, and MobileDesigned as subcategories. In this arrangement, a Web Intelligence document tagged as Confidential, Featured, or MobileDesigned is automatically tagged as Mobile due to inheritance rules.

Figure 24.5    Mobile Categories in the BI Launch Pad

Note
Always test Web Intelligence documents in a non-production environment for mobile compatibility. If the document won't display adequately, don't tag it with the Mobile category in the production environment. Otherwise, users may see messages such as Content not supported and assume the document is defective.

The Mobile, MobileDesigned, Confidential, and Featured categories are used by the SAP BusinessObjects Mobile application but never seen by an SAP BusinessObjects Mobile user. However, other categories are visible to mobile users and can be used to organize mobile content. In Figure 24.6, the mobile user sees categories for Lumira, Monthly Reports, Party Pants, Quarterly Reports, Weekly Reports, and eFashion.

Figure 24.6    Categories in an SAP BusinessObjects Mobile Application

Note
Although users find content in the BI Launch Pad using folders, mobile users find content using categories.

24.2.2    Mobile versus MobileDesigned
As a mobile report designer, you will need to evaluate on a case-by-case basis whether to tag a Web Intelligence document with only the Mobile category (card layout) or whether to tag with both the Mobile and MobileDesigned categories (page layout). This section illustrates how documents appear with each layout scheme. The most ideal layout for SAP BusinessObjects Mobile is four blocks, which can be displayed in equal proportions on an iPad screen. To gain a better understanding of the differences between Mobile and MobileDesigned, we've use a document that shows a 2 × 3 grid of charts on one report tab and a 3 × 3 grid of charts on another report tab. Figure 24.7 and Figure 24.8, respectively, show how these charts, also known as report parts, appear when viewed from the BI Launch Pad.

Figure 24.7    The 2 × 3 Grid Viewed in the BI Launch Pad

Figure 24.8    The 3 × 3 Grid Viewed in the BI Launch Pad
Let's first look at the Mobile category, which instructs the mobile device to use a card layout. If the mobile application can't fit all of the report parts on a single screen of the device, it will distribute the report parts across multiple screens, which can be viewed by swiping.
In Figure 24.9, the 2 × 3 grid is displayed using the Mobile category, or card layout. Notice that only four of the six report parts are shown, and the remaining two report parts are displayed on a separate screen, not visible.

Figure 24.9    The 2 × 3 Grid in SAP BusinessObjects Mobile with the Mobile Category
When the Web Intelligence document is also tagged with the MobileDesigned category, the mobile app renders it using page layout, not card layout. Therefore, all six report parts are rendered on a single screen, as shown in Figure 24.10.

Figure 24.10    The 2 × 3 Grid in SAP BusinessObjects Mobile with the MobileDesigned Category (Portrait Orientation)
MobileDesigned also displays all six report parts when the tablet is in a landscape position, as shown in Figure 24.11.

Figure 24.11    The 2 × 3 Grid in SAP BusinessObjects Mobile with the MobileDesigned Category (Landscape Orientation)

Note
Due to its smaller screen size, the SAP BusinessObjects Mobile app always uses card layout on the iPhone, only displaying one card, or report part, per screen.

Next, we'll consider the 3 × 3 grid of Web Intelligence report parts. Using only the Mobile category, the mobile device is unable to display all nine report parts using card layout. Only three report parts are rendered per screen, with the other six report parts organized on two additional screens (see Figure 24.12).

Figure 24.12    The 3 × 3 Grid Using the Mobile Category
But when the document is also tagged with the MobileDesigned category, the SAP BusinessObjects Mobile app is able to render all nine report parts on a single screen without the need to swipe to additional screens. Figure 24.13 shows how the MobileDesigned report will appear in portrait orientation.

Figure 24.13    The 3 × 3 Grid Using the MobileDesigned Category (Portrait Orientation)
Figure 24.14 shows how the MobileDesigned report will appear in landscape orientation.

Figure 24.14    The 3 × 3 Grid Using the MobileDesigned Category (Landscape Orientation)
The MobileDesigned category and page mode allow the SAP BusinessObjects Mobile app to more closely observe the layout of the original Web Intelligence document, although the importance of fidelity in layout must be weighed against the size of the report parts. However, you can zoom in on any report part simply by double-tapping on it.

Note
The behavior of the card layout model and page layout model depends on the version and patch level of the SAP BusinessObjects BI platform as well as the version and patch level of the SAP BusinessObjects Mobile app. You may notice slight changes in rendering when either is updated to a new version or patch level.










24.3    Mobile-Only Analytic Types
In the previous section, you learned how the SAP BusinessObjects Mobile app renders Web Intelligence tables and charts. In this section, you learn how to create additional visualizations such as sparklines, bullet graphs, and scorecards that are unique to the mobile experience.
These visualizations are created by assigning a formula to the name property of a table block. These formulas always begin with a semicolon (;) and use a combination of alphanumeric codes and column numbers to inform the SAP BusinessObjects Mobile app how to render the visualization.
Although you can't see the visualization at design time from either the Web Intelligence Rich Client or the browser-based edition of Web Intelligence, this formula is interpreted by the SAP BusinessObjects Mobile app, which renders the visualization. To develop these visualizations, you'll want to keep your tablet close at hand so you can immediately test changes to the formulas.
24.3.1    Query and Formula Design
All of the examples in this section can be created in a single Web Intelligence document that uses the following objects from the eFashion universe: Year, Month, Month Name, State, City, Category, Lines, Sales revenue, Quantity sold, Margin, and Discount (see Figure 24.15).

Figure 24.15    Exploration of Mobile-Only Analytic Types in the eFashion Query
The eFashion universe contains three years of data. Using output contexts, you can create variables for the current year (2006) and previous year (2005).
To calculate the current year's revenue, create a variable named "Revenue CY" with the following Formula (see Figure 24.16):
=Sum([Sales revenue] Where ([Year]="2006"))

Figure 24.16    Formula for Current Year's Revenue
To calculate the previous year's revenue, create a variable named "Revenue LY" with the following Formula (see Figure 24.17):
=Sum([Sales revenue] Where ([Year]= "2005"))

Figure 24.17    Formula for Previous Year's Revenue
You can also compute the minimum revenue amount, average revenue amount, and maximum revenue amount.
The minimum yearly revenue for a particular state can be computed by the following variable (see Figure 24.18):
=Min([Sales revenue] Where([Year]="2006")) ForAll([State]; [Year])

Figure 24.18    Formula for Lowest Annual Revenue
The maximum yearly revenue for a particular state can be computed by the following variable (see Figure 24.19):
=Max([Sales revenue] Where([Year="2006")) ForAll([State]; [Year])

Figure 24.19    Formula for Highest Annual Revenue
The average yearly revenue for all states in a given year can be computed by the following variable (see Figure 24.20):
=Avg([Sales revenue] Where([Year="2006")) ForAll([State]; [Year])

Figure 24.20    Formula for Average Yearly Revenue
Lastly, to create a variable for year-over-year percentage growth, which can be used with scorecards (see Figure 24.21), use this formula:
=([Revenue CY]-[Revenue LY])/[Revenue LY]

Figure 24.21    Formula for Revenue Percentage Growth
Next, let's investigate the benefits of sparklines.
24.3.2    Creating Sparklines
A sparkline is a line chart that is small enough to be embedded alongside text, such as a table. The term sparkline is attributed to data visualization pioneer Edward Tufte.
Create a crosstab table that shows monthly sales revenue by state. Add total calculations for both the rows and columns. Then add the variables for last year's sales revenue and this year's sales revenue to the right of the state column. The results are shown in Figure 24.22.

Figure 24.22    Sparkline Table Design
To create a sparkline for the monthly sales figures, change the name of the table block to the following formula:
;SL_GF_[column name for MicroChart]_C_[starting number of column]_[Ending number of column]
Because January revenue figures appear in column 4 and December revenue figures appear in column 15, the final formula should look like this (see Figure 24.23):
;SL_GF_Revenue_C_4_15

Figure 24.23    Sparkline Formula: Area
When viewed on the mobile device, all other columns will appear in a table. But instead of 12 months of sales revenue figures, the mobile user will see an inline sparkline, as shown in Figure 24.24.
If desired, the sparkline can be displayed as a line chart instead of an area chart by replacing the "GF" in the block name with an "L" (see Figure 24.25). The revised sparkline is shown in Figure 24.26.

Figure 24.24    Sparkline (Area) Displayed on a Mobile Device

Figure 24.25    Sparkline (Line) Formula

Figure 24.26    Sparkline (Line) Displayed on a Mobile Device
As with other chart types, you can zoom any sparkline to full screen by double tapping it.
24.3.3    Creating Bullet Graphs
The bullet graph was designed by Stephen Few. The goal of a bullet graph is to display a single metric in a bar format using much less space than what is required for other visualization types, such as gauges. To provide context, a bullet graph also displays a comparison value (e.g., last year's sales in comparison to this year's) and a qualitative scale to help the SAP BusinessObjects Mobile user determine if the metric displayed by the bullet graph is good, bad, or ugly. Lastly, the bullet chart has a quantitative scale that helps the user determine the value of the metric. Let's attempt this now.
Create a vertical table that displays State and Yearly Revenue for the current year (the Revenue CY variable created earlier in this chapter). These values will be displayed in table format on the mobile device. Next, add the Revenue CY, Revenue LY, Revenue Min, Revenue Avg, and Revenue Max variables to the table, as shown in Figure 24.27.

Figure 24.27    Bullet Graph Table Design
A Web Intelligence bullet graph requires an actual value, a comparative value, three (min, mid, and max) qualitative values, and an optional title. The formula is represented generically as:
;BC_[Graph Name]_C_[Starting Column]_[Ending Column]_tl_[Title]
For the data represented in Figure 24.27, the formula should be (see Figure 24.28):
;BC_State Comparison_C_3_7_tl_1

Figure 24.28    Bullet Graph Block Name
The bullet graph is rendered on a tablet, as shown in Figure 24.29.

Figure 24.29    Bullet Graph Displayed in SAP BusinessObjects Mobile
On an iPhone SE display, SAP BusinessObjects Mobile can show up to eight bullet graphs. As with other chart types, you can zoom any bullet graph to full screen by double tapping it.
24.3.4    Creating Micro Bar Charts
A micro bar chart is similar to a sparkline in that it's displayed inline with text. But unlike a sparkline, it uses discrete bars rather than a continuous line to display its values. Use the same table design that was used in the earlier sparkline example, which is shown in Figure 24.30.

Figure 24.30    Micro Bar Chart Design
The formula to render a micro bar chart is:
;MBC_TYPE_< micro bar chart name >_C_<starting_column_number>_<ending_column_number>
Using the table from Figure 24.30, the formula should be (see Figure 24.31):
;MBC_TYPE_Monthly_Sales_C_4_15

Figure 24.31    Micro Bar Chart Block Name
The micro bar chart is rendered on a tablet, as shown in Figure 24.32.
As with other chart types, you can zoom any micro bar chart to full screen by double tapping it.

Figure 24.32    Micro Bar Chart Displayed on an SAP BusinessObjects Mobile Tablet
24.3.5    Creating Scorecards
The last type of mobile analytic is the scorecard. Scorecards focus on displaying a trend going up or down with an at-a-glance indicator rather than displaying discrete values as with other analytic types. An example of a trend is year-over-year percent revenue growth, as it's either going up (positive numbers) or down (negative numbers). The SAP BusinessObjects Mobile app can display the trend in three different visual formats: glossy icon, button, or arrow.
Create a scorecard using State, Revenue LY (last year's revenue), Revenue CY (current year's revenue), and Revenue % Growth, as shown in Figure 24.33.

Figure 24.33    Scorecard Table Design
The trend icon is displayed using the text color of the trend metric. Therefore, if desired, create conditional formatting (known as an alerter in previous versions of Web Intelligence) for Revenue % Growth, displaying positive revenue growth with the color green, and negative revenue growth with the color red.
Create a scorecard using the trend icon (see Figure 24.34), which uses the following generic formula:
;SC_TT_C_[Column number of trend]_[Position of the icon to be displayed]
or
;SC_TT_C_4_R

Figure 24.34    Scorecard with Trend Icon Block Name
The table appears with the Trend icon to the right of the Trend Metric (revenue percent growth), as shown in Figure 24.35.

Figure 24.35    Scorecard with Trend Icon
The icon can be changed to an arrow by changing the TT in the formula to TA (see Figure 24.36). For example:
;SC_TA_C_[Column number of trend]_[Position of the icon to be displayed]
or
;SC_TA_C_4_L

Figure 24.36    Scorecard with Arrow Block Name
The arrow appears to the left of the trend metric, as shown in Figure 24.37.

Figure 24.37    Scorecard with Arrow Displayed on SAP BusinessObjects Mobile
The third and final scorecard indicator is a button. The formula to generate a trend button is the following (see Figure 24.38):
;SC_GF_C_[Column number of trend]_[Position of the icon to be displayed]
or
;SC_TT_C_4

Figure 24.38    Scorecard with Button Block Name
Notice that there isn't an "R" or "L" for right or left because the trend button is displayed as a bar chart behind the trend value. The scorecard with the button indicator appears in Figure 24.39. Notice that it doesn't display negative values, so in certain circumstances, the icon or arrow may be a more effective trend indicator.

Figure 24.39    Scorecard with Button Displayed in SAP BusinessObjects Mobile









24.4    Report Linking
Mobile Web Intelligence reports can support report linking just like their browser-based counterparts. For example, a store name can be configured to link to a details report. The linked column appears in a different color, as shown in Figure 24.40. Report linking is configured using the HTML client (see Chapter 15).

Figure 24.40    Report Linking: Hyperlinks in Source Report
Navigate to the linked detail report by clicking on the store name. The detail report is shown in Figure 24.41.
To return to the master report, simply click on the Back button in the top-left corner.

Figure 24.41    Report Linking: Prompted Destination Report









24.5    Input Controls
Mobile Web Intelligence documents can use input controls, which can be invoked by clicking on the Filter icon in the top-right corner of the Web Intelligence document. Figure 24.42 shows a document that has an input control for the eFashion Lines object.
Because the input controls were configured to filter the entire report, choosing only the lines of City Trousers and Trousers filters both the table and the chart, as shown in Figure 24.43.

Figure 24.42    Mobile Input Controls

Figure 24.43    Report Filtered Using Input Control

Web Intelligence Input Control
The input controls created in Web Intelligence (see Chapter 9, Section 9.5) are not applied in the mobile version. You need to explicitly recreate them.










24.6    Mobile Thumbnails
You can give your mobile reports a professional appearance by creating thumbnail images. These images should be 208 × 208 pixels square, in either JPEG or PNG format with .jpg, .jpeg, or .tif file extensions. These images should be stored on a publicly available web server. Some examples of thumbnail images are shown in Figure 24.44.

Figure 24.44    Sample Mobile Thumbnails
To specify the thumbnail image, edit the Web Intelligence document properties from either the BI Launch Pad or CMC and place the URL for the image in the Keywords field, as shown in Figure 24.45.

Figure 24.45    URL for Mobile Thumbnail Image in Keywords Field









24.7    Summary
The SAP BusinessObjects Mobile app allows Business Intelligence from your SAP BusinessObjects platform to be accessible yet secure from nearly anywhere, providing a powerful tool for collaboration and analysis. In addition to rendering standard Web Intelligence tables and charts, you learned in this chapter how to exploit several charting types that are exclusive to the mobile experience.








A    Converting Desktop Intelligence Reports to Web Intelligence DocumentsYou can convert Desktop Intelligence documents from SAP BusinessObjects Enterprise XI 3.x or XI R2 to Web Intelligence to be used in SAP BusinessObjects BI 4.2. Follow this checklist of best practices for a methodical conversion that produces a highly functioning series of Web Intelligence documents that were once Desktop Intelligence documents.Now that Desktop Intelligence has reached its end-of-life stage with the release of the SAP BusinessObjects BI platform, the conversion of Desktop Intelligence documents to Web Intelligence is an important topic for customers still using the classic desktop reporting tool. As the product known to many as the original SAP BusinessObjects full-client reporting tool, Desktop Intelligence offered advanced functional capabilities that set it apart from other reporting tools in the market. Many of these were so valuable to business users that many clients opted to continue to use the product.In fact, even when its successor, Web Intelligence, began to receive an influx of enhancements and improved functionality, many customers found it difficult to trade in the classic desktop client for its zero-client reporting tool successor. Functional differences and the pervasiveness of locally saved documents have continually been cited as leading reasons for continued use of Desktop Intelligence.By offering a greatly enhanced product that far exceeds the capabilities delivered in Desktop Intelligence, Web Intelligence has made a big leap in minimizing the functional differences between the two products. But even with all the enhancements, there are still capabilities in the last version of Desktop Intelligence that aren't yet available in Web Intelligence, such as custom VBA code, and the capability to export a report to HTML. These features and a few others can present challenges in migration and conversion efforts when upgrading from previous releases.
A.1    Planning Your Conversion to Web Intelligence
This section focuses on the major steps in performing a successful conversion from Desktop Intelligence to Web Intelligence. The conversion process checklist contains nine general key steps for completing an effective report conversion from Desktop Intelligence to Web Intelligence.

Conversion Checklist: Desktop Intelligence to Web Intelligence
The conversion checklist is as follows:


                    Analyze existing Desktop Intelligence document usage.
                

                    Identify users with Desktop Intelligence installed.
                

                    Publish locally saved Desktop Intelligence documents to the repository.
                

                    Prioritize, consolidate, and eliminate documents that are no longer needed.
                

                    Customize the conversion plan and roadmap.
                

                    Perform document conversion with the Report Conversion Tool.
                

                    Perform post-conversion analysis and validation.
                

                    Manually create unconverted documents.
                

                    Educate users on Web Intelligence 4.2.
                


The steps outlined in the checklist describe general best practices for any Desktop Intelligence to Web Intelligence conversion project. The Report Conversion Tool is used to perform these types of conversions. It's important to know that even though a tool exists specifically for performing conversions, almost every conversion will require some level of manual rework to achieve 100% success.
A.1.1    Analyze Existing Desktop Intelligence Document Usage
Before you create an in-depth conversion plan or rely on a cookie-cutter roadmap to conversion, it's critical to understand what you're dealing with in terms of Desktop Intelligence document existence and usage. We recommend that you perform a comprehensive review of the reporting documents published to the repository to begin creating an inventory of Desktop Intelligence documents currently in use.
You can determine actual usage by enabling auditing in the source system to audit the events of the Desktop Intelligence application. Usage statistics are a very powerful indicator of the value of a document. Because Web Intelligence, and not Desktop Intelligence, is the recommended tool, it's possible that many Desktop Intelligence documents in production have a very small viewership and can be consolidated or eliminated rather than converted. On the other hand, you may discover that a number of published Desktop Intelligence documents are still frequently viewed by business users and very valuable to organizations. The priority to convert these documents to Web Intelligence is high.
The goal of this step is to determine the number of high-value and high-visibility documents to convert to Web Intelligence. It's also important to determine which documents can be eliminated. Take this opportunity to perform some cleanup before attempting to convert every Desktop Intelligence document to Web Intelligence.

Note
The number of existing Desktop Intelligence documents is an important statistic to the system administrator. The number of Web Intelligence services will likely need to be increased to accommodate the increased number of Web Intelligence documents after conversion.

A.1.2    Identify Users with Desktop Intelligence Installed
Over the course of the past several years, Desktop Intelligence may have been installed on several hundred or even several thousand PCs, depending on the size of the organization. Inevitably, each user will have a number of Desktop Intelligence documents saved locally.
Even though all important documents should exist on the server, to comply with most corporate policies, some documents may exist locally. This is often the case simply because the tool lends itself to working offline and provides the capability of storing .rep files locally.
A.1.3    Publish Locally Saved Desktop Intelligence Documents to the Repository
After you've identified the users and report developers who are still using Desktop Intelligence, ask them to publish all important personal and locally saved Desktop Intelligence documents into the BI platform repository. This step puts potentially valuable documents onto the repository so that the migration team can review, analyze, and convert them to Web Intelligence.
It's important to get every useful Desktop Intelligence documents published to the repository so they can be converted to Web Intelligence and be used in the SAP BusinessObjects BI 4.2 system after migration. Insist that your users make every effort to only retain necessary documents to minimize the buildup of unneeded or duplicate ones.
A.1.4    Prioritize, Consolidate, and Eliminate
Before converting every single Desktop Intelligence document ever created at your organization, take this opportunity to archive or completely eliminate documents that are no longer being used. As companies evolve and data sources change, it's likely that a large number of locally saved Desktop Intelligence documents are no longer needed. You'll recognize the distinction between ad hoc documents and valuable documents that are used by business users.
When you're prioritizing reports, create categories or buckets to differentiate documents based on the frequency of use and the visibility of the data presented in the documents.
A.1.5    Customize the Conversion Plan and Roadmap
After completing the first four steps, you'll understand the scope of the project and conversion effort. The volume of documents to be migrated plays a major role in developing the roadmap and conversion plan. There are two common approaches to conversion:


Single-pass conversionThe entire repository is converted in one pass.
                

Staged conversionConversion is segmented by business area or departmental group.
                

The decision regarding which approach to select depends on the following factors:


                    Number of Desktop Intelligence documents to convert
                

                    Complexity of Desktop Intelligence documents
                

                    Amount of rework required to fully convert to Web Intelligence
                

                    64-bit server architecture of the SAP BusinessObjects BI 4.2 system
                

                    Combination of any of the first four potential scenarios
                

When you're preparing the conversion plan, you should also determine document complexity. The difficulty level of conversion can be anticipated after evaluating the Desktop Intelligence documents in the source environment. 
These scenarios provide the greatest opportunity to create a small number of new universes that can be used by a much larger number of Desktop Intelligence documents; therefore, these universes should include several objects and predefined filters to increase their usefulness.
Depending on the practices of Desktop Intelligence documents designers, it's possible that you'll need to manually create some documents in Web Intelligence. These reports should be identified and placed into their own groups. These are the most common reasons for known conversion problems:


                    Documents containing Visual Basic for Applications (VBA)


                    Documents with value-based or same-level breaks
                

                    Documents with variance calculations


Documents with any of these features should be manually revised before converting.
A.1.6    Perform Document Conversion
You can help stay on track by setting milestones and timelines. Customizing a project timeline will help guide you through the conversion process and ensure that every aspect of the conversion is completed and in the correct order.
Other critical decisions must be made and conveyed to users, such as the following:


                    Well-communicated end date for development of Desktop Intelligence documents in the source system
                

                    Documented deadline for refreshing existing Desktop Intelligence documents
                

                    Go-live date to begin using documents converted to Web Intelligence in the new system
                

Launch the Report Conversion Tool as an administrator and perform the type of conversion:


Single-pass conversionConverts all documents.
                

Staged conversionConverts only a portion of the documents.
                

Even if it is possible to convert XI 3.1 Desktop Intelligence documents with the XI 3.1 Report Conversion Tool and then migrate them into the BI platform repository 4.2, it is rather recommended to use the latest version of the Report Conversion Tool (SAP BI BusinessObjects 4.2 SP 4) to take advantage of the latest conversion features and convert a greater number of documents.
The Report Conversion Tool workflow is described in Section A.2.
A.1.7    Execute Post-Conversion Analysis and Validation
After completing a conversion, documents are grouped into three categories:


                    Fully converted
                

                    Partially converted
                

                    Not converted
                

The seventh conversion step leads you to performing a post-conversion analysis. Partially converted documents can be evaluated to determine the reason that it wasn't fully converted. In many cases, minor manual modifications can be made to fully convert documents. This can be a labor-intensive exercise depending on the volume of partially converted documents.
Perform validation on reports that were fully converted. Verify that all data sources, formulas, and report functions continue to work properly in Web Intelligence as they did in Desktop Intelligence.
You need to identify the reason that partially converted documents weren't fully completed by reviewing log files. In many cases, these documents can be quickly edited. In other cases, it can be easier to re-create partially converted documents in Web Intelligence rather than making the necessary corrections.
Documents that aren't converted will often need even more manual corrections or will need to be re-created in Web Intelligence rather than converted with the Report Conversion Tool.
A.1.8    Manually Create Unconverted Documents
As mentioned in the seventh step, it's common that unconverted documents will need to be manually re-created in Web Intelligence if resources permit. Even though Web Intelligence now contains almost all of the function capabilities of Desktop Intelligence, a number of features will still cause Desktop Intelligence documents to not be converted.
You should create a focused strategy for handling reports that remain unconverted even after running them through the Report Conversion Tool. It's possible that the reason documents aren't converted can be removed or modified. After making changes, run the Report Conversion Tool again for a second attempt at converting the Desktop Intelligence documents to Web Intelligence.
A.1.9    Educate Users on Web Intelligence
Invest in user training for all users and report designers who will be using Web Intelligence. Training comes in many different forms, including text books, blogs, webinars, e-learning sessions, and official training from SAP and from vendors specializing in providing SAP BusinessObjects training.
We recommend the following resources for learning Web Intelligence:


                    Join SAP user groups and attend webinars and conferences. Explore what they have published online. You can see some of them in Table A.1.
                

                    Explore content at the SAP Community Network (SCN) at http://scn.sap.com/.
                

                    Attend official SAP training courses.
                

                    Obtain training from private vendors specialized in providing SAP BusinessObjects and Web Intelligence training courses.
                

                    Read this book!
                





                            Countries
                        

                            User Group
                        

                            Website
                        





                            United States of America and Canada
                        

                            ASUG (Americas' SAP Users' Group)


www.ASUG.com




                            Germany, Austria, Switzerland
                        

                            DSAG (Deutschprachige SAP Anwendergruppe)


www.dsag.de




                            France and French speaking countries
                        

                            USF (Utilisateurs SAP Francophone)


www.usf.fr




                            United Kingdom, Ireland
                        

                            UKISUG (UK & Ireland
                            SAP User Group)
                        

http://www.sapusers.org




                            Netherlands
                        

                            VNSG (Vereniging Nederlandstalige SAP Gebruikers)


http://www.vnsg.nl




Table A.1    Some SAP User Groups









A.2    Running the Report Conversion Tool
The Report Conversion Tool is an easy and effective tool for converting .rep (Desktop Intelligence) files to .wid (Web Intelligence document) files. Outside of a few complex cases described in the previous section, the tool converts the majority of Desktop Intelligence files to Web Intelligence.
The Report Conversion Tool proceeds in two main steps:


                It first converts the documents you have selected so you can assess the conversion rate.
            

                After you review the conversion result, you select the converted documents to publish in the BI platform repository.
            

After you complete a thorough analysis of the source system and group reports by business area, the likelihood of conversion success, and the need for manual rework, it's time to proceed to conversion.

Universe Designer Requirement
To run Report Conversion Tool, Universe Design Tool must also be installed on your machine.

A.2.1    Report Conversion Tool Workflow
The Report Conversion Tool is installed as part of the SAP BusinessObjects BI 4.2 Client Tools installer.
To use it for Desktop Intelligence document conversion, follow these steps:


                    Start the Report Conversion Tool.
                

                    In the Login dialog box (see Figure A.1), in the Source panel, enter the system name containing the Desktop Intelligence documents and the credentials to connect to it. In the Destination panel, enter the system name where the converted Web Intelligence documents are to be published and specify the credentials to connect to it.
                    
Figure A.1    Report Conversion Tool Login Page


                    Click OK.
                

                    In the application's first screen, you can navigate in the BI platform repository to select the Desktop Intelligence documents  to convert:
                    

                            You can select the Folder or Category to navigate either by folders or by categories.
                        

                            In the folder tree list, the numbers displayed after the folder name indicate the number of Desktop Intelligence documents found in the folder.
                        

                            You can select the Show unconverted documents only to display only the documents that have never been converted (see Figure A.2).
                        



                    Select the documents in the tree list in the left pane and click the >> button to add them in the Selected Document(s) pane.
                    
Figure A.2    Desktop Intelligence Documents Selection


                    You may select some options:
                    

Read all Cell Contents as Text: To convert hyperlinks as text.
                        

Convert all instances of selected documents for conversion: To convert document-generated instances as well.
                        

Convert documents containing free-hand SQL/stored procedures: To convert documents based whose data source is free-hand SQL or stored procedures.
                        



                    Click Next to start the conversion. The Converting window opens and shows you the document conversion progress.
                

                    Once the documents have been converted, the application's second screen displays the conversion results through the number and percentage of successfully , partially , and unsuccessfully  converted documents.
                

                    To compare the Desktop Intelligence and the converted Web Intelligence documents, select the Compare fully converted documents checkbox.
                

                    You may also save the conversion result in an audit database for further analysis:
                    

                            Select the Save conversion results in audit database checkbox.
                        

                            In the Select the audit connection to use to save conversion results dropdown menu, select a connection to the database where the conversion results will be saved.
                        



                    Click Next.
                

                    In the application's third screen, you can select the converted documents to save in the BI platform repository.
                

                    If in the second screen you have selected the Compare fully converted documents checkbox, then you can click the View differences button to open a new window that highlight the documents' differences.
                

                    To select a document to publish, select the checkbox in the left column in the document line. In the same line, right-click the converted document name, target folder, and categories to modify them.
                

                    Click Next to publish the documents in the BI platform repository.
                

                    After the publication, the application's fourth screen displays a summary of your conversion session.
                

                    Click Exit to quit the application or Return to start to convert other documents.
                

A.2.2    Freehand SQL Conversion
Before SAP BusinessObjects BI 4.1 SP 5, Web Intelligence was not proposing free-hand SQL as a data source. It was possible to convert reports containing free-hand SQL to Web Intelligence, but the conversion generated a new universe with derived tables for each document. This scenario could produce hundreds or potentially thousands of single-use universes.
Since SAP BusinessObjects BI 4.1 SP 5, Web Intelligence proposes free-hand SQL as a data source (see Chapter 2, Section 2.6.2). The Report Conversion Tool can convert the Desktop Intelligence document into a Web Intelligence document based on free-hand SQL.
The Report Conversion Tool can convert Desktop Intelligence documents based on free-hand SQL saved locally or in the BI platform repository. Such documents contain the connection to the database to query. When the documents are converted by the Report Conversion Tool:


                    The corresponding connection is created in the BI platform repository. If several Desktop Intelligence documents share the same connection, it is created only once.
                

                    The converted Web Intelligence document is based on this created connection.
                


Unsupported Connection
If the original connection used by the Desktop Intelligence document to convert is based on a database driver that is no longer supported in SAP BusinessObjects BI 4.2 SP 4, then the Report Conversion Tool will not convert the document.










A.3    Desktop Intelligence Compatibility Pack
The last commercial release of Desktop Intelligence came in XI 3.1. It was supported with mainstream maintenance until 2015 and its priority-one support terminates at the end of 2017. With these dates in mind, remaining customers still using Desktop Intelligence need to plan their conversions to Web Intelligence accordingly to remain in support.
The tool delivered to help with migrations from previous SAP BI versions and conversions of Desktop Intelligence documents to Web Intelligence documents is the Desktop Intelligence Compatibility Pack. This tool was introduced in SAP BusinessObjects BI 4.1 SP 6 to allow Desktop Intelligence to connect to a BI platform repository. SAP BusinessObjects BI 4.2 also proposes a version of this Compatibility Pack to allow Desktop Intelligence to connect to an SAP BusinessObjects BI 4.2 repository.

Minimal Fix Pack on XI 3.1
It's important to note that, to take advantage of the Desktop Intelligence Compatibility Pack, the XI 3.1 client tools must be upgraded to at least Fix Pack 6.1 (FP6.1) on SP 6.

The following details outline the features provided by the Desktop Intelligence Compatibility Pack:


                Desktop Intelligence documents can be moved to SAP BusinessObjects BI 4.2 using the Upgrade Management Tool.
            

                The Report Conversion Tool can access Desktop Intelligence documents in an SAP BI BusinessObjects 4.2 repository for conversion to Web Intelligence.
            

                Scheduling functionality is provided using the Windows Task Scheduler.
            

                Users accessing Desktop Intelligence documents from the BI Launch Pad will receive data in the following formats: PDF, XLS, or TXT.
            










A.4    Summary
A step-by-step methodical approach to report conversion produces the safest and most effective way to move away from Desktop Intelligence reports in SAP BusinessObjects XI R2 or XI 3.1 and begin using Web Intelligence for reporting with all your data sources.
Collaboration among users, designers, and the conversion/migration team is essential to success. In addition, clearly communicating deadlines and the importance of publishing locally saved Desktop Intelligence reports to the repository is an important part of the conversion process. After you analyze all the existing Desktop Intelligence documents in an environment, you'll need to determine which documents continue to deliver relevant and valuable information to users while also identifying documents that can be retired.
Review the last save date and last refresh date of documents to help identify obsolete content rather than converting unneeded documents. You should also look for ways to consolidate redundant documents that may have been repeated many times over.
After a complete analysis, prepare a customized roadmap for converting existing Desktop Intelligence documents with the Report Conversion Tool. You can perform the conversion in a staged multi-pass approach or single-pass approach, depending on the number of documents to convert and the level of complexity.








B    Web Intelligence Security RightsSAP BusinessObjects BI proposes a complete security framework that allows administrators to grant or deny features to their users. A set of security rights can be defined at Web Intelligence application or document level and secure the actions you can perform in the tool.SAP BusinessObjects BI includes a complete framework for security, which makes it suitable for enterprise deployment. Among other security concepts, this framework provides a security model based on security rights.Your administrator has likely setup these security rights in order to control the actions you are able to run un Web Intelligence.
B.1    SAP BusinessObjects BI Platform Security Model
In the BI platform repository, any object (application, folder, document, universe, connection, user, etc.) has security rights that can be granted or denied to users or groups of users, either directly or through custom access levels, which are sets of predefined granted or denied rights.
These rights are set in the CMC, as shown in Figure B.1.
These rights define what the user can and cannot do with the application:


                Security rights defined at Web Intelligence application level secure capabilities in the application, for any document.
            

                Security rights defined at Web Intelligence document level secure capabilities for the document for which they are set.
            

The following sections describe the list of rights specific to Web Intelligence applications and documents, as well as the rights to authorize some workflows. These descriptions can help you understand the level of security that can be set and help you define (with your administrators) the capabilities to grant or not, depending on your business requirements.

Figure B.1    Web Intelligence Security Rights in the CMC

Web Intelligence Customization
Web Intelligence user interface can also be modified through customization.

Some rights can also be defined at universe and connection level and impact Web Intelligence. For example, in SAP BusinessObjects BI 4.2 SP 4, a new security right has been introduced for relational connection to authorize the use of free-hand SQL (see Chapter 2, Section 2.6.2). But this complete list goes beyond this book.

Additional Reference
This appendix is only an overview of these security concepts. To learn more about them, refer to SAP BusinessObjects BI Security (SAP PRESS, 2013, www.sap-press.com/3193).










B.2    Web Intelligence Application Rights
Web Intelligence application supports the four application general rights. The name of the general right that allows you to log on in Web Intelligence is Log on to Web Intelligence.
In addition, Web Intelligence application leverages many specific rights that finely secure its features.
These rights are classified into the following categories:


Data: Rights related to data tracking
            

Desktop interface: Rights specific to Web Intelligence Rich Client (see Chapter 23); they secure document workflows between the local machine and BI platform repository
            

Documents: Rights to create a new document, to enable automatic refresh and save, and to publish a report item as web services
            

General: Rights to secure the user's preference and right-click menu use
            

Interfaces: Rights to secure the different deployment modes and interfaces
            

Left pane: Rights to secure the use of the left pane
            

Query script: Rights to view and edit the generated query script
            

Reporting: Rights to secure changes to the report specification in Design mode
            

Sharing: Rights to manage shared elements
            

These rights apply to all Web Intelligence interfaces (Rich Client, HTML, Applet and Interactive Viewer), except the ones in the Desktop Interface and Interfaces categories, which apply only to the Web Intelligence Rich Client and HTML/Applet/Interactive Viewer, respectively.
When you connect with Web Intelligence Rich Client in offline mode, these rights apply if you have already connected to it in connected mode, because the rights are saved in a local cache managed by Web Intelligence Rich Client.
B.2.1    Data: Enable Data Tracking
This right allows you to track data changes between two refreshes (see Chapter 18, Section 18.6).
If the right is denied, you cannot enable the track data change features since the corresponding buttons are disabled in the interface, both in Reading and Design modes.
B.2.2    Data: Enable Formatting of Changed Data
This right allows to modify the formats (colors and fonts) used to display changes found by data tracking (see Chapter 18, Section 18.6). If you do not modify the formats, the default ones are defined in the CMC, in the Web Intelligence parameters page. To modify these settings, you also need to have the Data: Enable data tracking right; otherwise, you cannot open the Data Tracking dialog box.
If the right is denied, in the Data Tracking dialog box, in the Options tab, all controls are disabled, preventing you from modifying data tracking format.
B.2.3    Desktop Interface: Enable Local Data Providers
In Web Intelligence Rich Client, this right allows you to create a document based on a TXT, CSV, or Excel data source or edit the query of a document based on such a data source. This right does not prevent you from viewing or refreshing the document.
If the right is denied, in Web Intelligence Rich Client, any workflow where you can create a query based on a TXT, CSV, or Excel file fails. In Design mode, if you try to edit a document based on a TXT, CSV, or Excel file, you cannot modify its query.
B.2.4    Desktop Interface: Enable Web Intelligence Desktop
This right allows you to use Web Intelligence Rich Client.
If the right is denied, you cannot select Web Intelligence Rich Client as an option to view or modify a Web Intelligence document. In Web Intelligence Rich Client, when you try to log on to the BI platform repository, after you have provided your credentials, an error message is displayed.
B.2.5    Desktop Interface: Export Documents
This right allows you to publish your documents to the BI platform repository using Web Intelligence Rich Client.
If the right is denied, in Web Intelligence Rich Client, in Reading and Design modes, you cannot select BI platform repository as a destination when saving a document.
B.2.6    Desktop Interface: Import Documents
This right allows you to retrieve Web Intelligence documents from the BI platform repository using Web Intelligence Rich Client.
If the right is denied, in Web Intelligence Rich Client, in Reading and Design modes, you cannot open a file from the BI platform repository.
B.2.7    Desktop Interface: Install from BI Launch Pad
This right allows you to download and install Web Intelligence Rich Client from the BI Launch Pad. It does not prevent you from launching it if it is already installed.
If the right is denied, in the BI Launch Pad Preferences dialog box, in the Web Intelligence section, the installation required links are not displayed. This prevents you from downloading the Web Intelligence Rich Client.
B.2.8    Desktop Interface: Print Documents
This right allows you to print a document using Web Intelligence Rich Client. This right does not control printing the document summary from the Document Summary side pane.
If the right is denied, in Web Intelligence Rich Client, the Print button is disabled. This prevents you from opening the Print dialog box and printing the document.
B.2.9    Desktop Interface: Remove Document Security
This right allows you to save a document locally, without its security. By doing this, users can open a document without having to authenticate to the BI platform repository, and the document can be seen in standalone mode. This capability is possible only in Web Intelligence Rich Client. You also need to have the security right Desktop interface: Save documents locally to save a document locally.
If the right is denied, in Web Intelligence Rich Client, you cannot use the Remove document security option when saving a document.
B.2.10    Desktop Interface: Save Document for All Users
This right allows you to save a document locally, for all users. Any user who has an account in the BI platform repository can open it, but he needs to have authenticated to the BI platform repository first. This capability is possible only in Web Intelligence Rich Client. You also need to have the security right Desktop interface: Save documents locally to save a document locally.
If the right is denied, in Web Intelligence Rich Client, when saving a document, you cannot use the Save for all users option.
B.2.11    Desktop Interface: Save Documents Locally
This right allows you to save locally on your machine a document retrieved from the BI platform repository. This right applies only to Web Intelligence Rich Client since it is not possible to save a document locally through the web interfaces.
If the right is denied, in Web Intelligence Rich Client, you cannot select a local folder to save your document.
B.2.12    Desktop Interface: Send by Mail
This right allows you to send a document by email through Web Intelligence Rich Client. It does not cover sending a Web Intelligence document from the BI Launch Pad.
If the right is denied, the Send by E-mail attachment button is disabled, preventing you from opening its dropdown menu and sending the document by email.
B.2.13    Disable Export to BI On Demand for this User
This right is no longer used.
B.2.14    Disable Import from BI On Demand for this User
This right is no longer used.
B.2.15    Documents: Disable Automatic Refresh on Open
This right is used to force a document to be automatically refreshed when users open it (see Chapter 2, Section 2.5.3), even if the document has been saved without this option. To do this, you must have first set the property Check the "Disable automatic refresh on open for all documents" security right parameter in the CMC. Then, if this right is denied, even if the Refresh On Open option has not been set, the document is always refreshed on opening.
If the right is denied, it has no impact on the user interface since you can still save a document with or without the Refresh on Open option. But when you open it, it is refreshed anyway, if the Check the "Disable automatic refresh on open for all documents" security right parameter has been set in the CMC.
B.2.16    Documents: Enable Auto-Save
This right allows you to benefit from the auto-save feature. The auto-save parameters (enabled/disabled, auto-save delay time, and so on) are set in the CMC in Web Intelligence application's properties. If auto-save has been enabled, then your document is regularly saved in your My Favorites/~WebIntelligence folder. If you lose your connection to the BI Launch Pad, you can recover it from this folder. This option is available only when you launch Web Intelligence from the BI Launch Pad, since the BI Launch Pad has some session timeout.
If the right is denied, your document is not auto-saved.
B.2.17    Documents: Enable Creation
This right allows you to create a new Web Intelligence document, but does not cover saving an existing document with a new name.
If the right is denied, Web Intelligence prevents you from creating a document.
B.2.18    General: Edit My Preferences
This right allows you to change Web Intelligence preferences in the BI Launch Pad.
If the right is denied, no option is displayed in the Web Intelligence section of the BI Launch Pad's Preferences dialog box (see Chapter 1, Section 1.3).
B.2.19    General: Enable Right-Click Menus
This right allows you to use the right-click button in Design mode in order to open the contextual menu that contains shortcuts for most common commands.
If the right is denied, in Design mode, when you right-click any item in a report, the contextual menu does not open.
B.2.20    Interfaces: Enable Rich Internet Application
This right allows you to use the Web Intelligence Applet user interface.
If the right is denied, in the BI Launch Pad preferences (see Chapter 1, Section 1.3), you cannot select Web Intelligence Applet as an option to view or modify a Web Intelligence document.
B.2.21    Interfaces: Enable Web Viewing Interface
This right allows you to use the Web Intelligence HTML user interface.
If the right is denied, in the BI Launch Pad preferences (see Chapter 1, Section 1.3), you cannot select Web Intelligence HTML as an option to view or modify a Web Intelligence document.
B.2.22    Left Pane: Enable Document Structure and Filters
This right allows you to display the document structure and filters in Web Intelligence left pane. When you are in Design mode, this shows in a hierarchical tree the list of reports, report items, and filters that make up the document.
If the right is denied, in Design mode, it is not possible to display the Document Structure and Filters side pane.
B.2.23    Left Pane: Enable Document Summary
This right allows you to display the document summary in the side pane. This document summary displays some general data about the current document, some statistics, and some of its main parameters. In Design mode, you can also modify some of these parameters.
If the right is denied, in Reading or Design modes, it is not possible to display the Document Summary side pane.
B.2.24    Query Script: Enable Editing (SQL, MDX, ...)
This right allows you to:


                    Modify the SQL script generated to query the database, if the document is based on a relational universe (see Chapter 2, Section 2.5). You also need the application right Query script: Enable viewing (SQL, MDX, ...) and the document rights View SQL and Edit Query to view and edit the script.
                

                    Create a new query through free-hand SQL (see Chapter 2, Section 2.7). Since SAP BusinessObjects BI 4.2 SP 4, you also need to have the right Use connection for Free-Hand SQL scripts granted for the connection.
                

This right must be granted with care, since modifying the script includes the ability to modify the script generated after the universe security has been applied and thus bypassing this security.
If the right is denied, when editing a query based on a universe, in the Query Script viewer, you cannot modify the generated script and replace it with a custom one. You cannot create a new query based on free-hand SQL.
B.2.25    Query Script: Enable Viewing (SQL , MDX, ...)
If the document is based on a universe, this right allows you to view the script generated to query the database, if the data source is a universe. Depending on the data source, this script can be expressed using SQL or MDX expression. In the case of SAP direct access (see Chapter 13, Section 13.2), you cannot see this script. You also need the document rights Edit Query and View SQL to view the script.
If the right is denied, in the Query Panel, you cannot open the Query Script viewer.
B.2.26    Reporting: Create and Edit Breaks
This right allows you to create a break when viewing a report (see Chapter 3, Section 3.2).
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, you cannot manage breaks since the corresponding menus, buttons, and Manage Breaks dialog box are disabled.
B.2.27    Reporting: Create and Edit Conditional Formatting Rules
This right allows you to create, modify, and organize conditional formatting (see Chapter 3, Section 3.5). This allows you to define a cell format (text font, background, border, etc.) depending on the cell content.
To grant this right, the Reporting: Enable formatting right must also be granted.
If the right is denied, in Design mode, it is not possible to create, modify, and organize formatting rules or change the order in which their condition is evaluated.
B.2.28    Reporting: Create and Edit Input Controls
This right allows you to create and modify group input controls and input controls (see Chapter 8, Section 8.4). This right does not control the use of input controls: in both Reading and Design mode, you can filter data in the document even if this right is denied.
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, the Input Controls side pane is available, but not the buttons to create, edit, or remove an input control or a group of input controls.
B.2.29    Reporting: Create and Edit Predefined Calculations
In Design mode, this right allows you to insert predefined calculations (see Chapter 4, Section 4.5.5). This is a simple method to add a new cell to a column, a row, or both containing standard calculation (sum, count, min, max, and average) that applies to the values in the column, the row, or both.
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, you cannot include predefined calculations.
B.2.30    Reporting: Create and Edit Report Filters and Consume Input Controls
This right allows you to create and edit report filters used to filter displayed data (see Chapter 9, Section 9.3). These filters may be based on input controls or not. A report filter does not modify the data included in the document; it is just a visual filter that hides some data.
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Reading mode, in the toolbar, the Filter Bar button is denied, which prevents you from opening the Filter Bar. In Design mode, you cannot create, edit, or delete report filters. In both Reading and Design mode, the Input Controls side pane is not displayed.
B.2.31    Reporting: Create and Edit Sorts
This right allows you to sort data in your reports, either through standard sorts (alphabetical and numerical) or custom ones (see Chapter 3, Section 3.4).
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, you cannot add and remove sorts or open the Manage Sorts dialog box to manage them and create custom sorts.
B.2.32    Reporting: Create Formulas and Variables
This right allows you to create and edit formulas and variables. They allow you to use advanced calculations in your reports by giving you access to functions and operators (see Chapter 11).
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, you cannot edit a formula or create, edit, or remove variables from the Formula Bar or the Available Objects side pane.
B.2.33    Reporting: Enable Formatting
This right allows you to modify the report specification, which is the case when you drill, fold, or modify formatting of the report. This right is mandatory to do any changes in the report specification. Thus, even if a "Reporting: ..." right is granted, the features it secures are not available if the Reporting: Enable formatting right is denied. (See Table B.1.)





                            "Reporting: ..." Right Is Granted
                        

                            "Reporting: ..." Right Is Denied
                        





"Reporting: Enable Formatting" Right Is Granted


                            Granted
                        

                            Denied
                        



"Reporting: Enable Formatting" Right Is Denied


                            Denied
                        

                            Denied
                        



Table B.1    Availability of Formatting Depending on Rights' Values
If the right is denied, you cannot open the document in Design or Data mode, only in Reading mode. In Reading mode, the track data, drill, filter, and outline capabilities are disabled.
B.2.34    Reporting: Enable Merged Dimensions
This right allows you to create merged dimensions and variables to aggregate data from different queries (see Chapter 14, Section 14.3).
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, the user interface prevents you from merging or unmerging objects.
B.2.35    Reporting: Insert and Remove Reports, Tables, Charts, and Cells
This right allows you to modify the document structure by adding or removing any element: reports, tables, charts, sections, and cells.
To be effective, this right must also be granted with the Reporting: Enable formatting right.
If the right is denied, in Design mode, it is not possible to add or remove report elements: buttons, menus, and commands are disabled (as well as the drag and drop).
B.2.36    Sharing: Publish Shared Elements
This right allows you to create shared elements (see Chapter 19, Section 19.2). To be effective, you must also grant the right Publish shared elements for the document containing the report element to publish as a shared element.
If the right is denied, you cannot create shared elements.
B.2.37    Sharing: Insert Shared Elements
This right allows you to insert shared elements in your document (see Chapter 19, Section 19.2).
If the right is denied, in Design mode, you cannot insert shared elements in a document.









B.3    Web Intelligence Document Rights
Web Intelligence documents support general rights, including the scheduling rights set. If a document's general right Edit objects is denied, you can still open and modify the document. But when you try to save it, an error message is displayed, preventing you from modifying it. If you want to keep your changes, you need to save it with another name.
It also supports specific rights, which are described next.
B.3.1    Edit Query
This right allows you to edit the document query. This right is mandatory if, in the query, you also want to view or edit the generated script.
If the right is denied, in Design mode, it is no longer possible to open the Query Panel, even to view the query, or to add a new query to the document. In Web Intelligence Rich Client, you cannot open the Data mode.
B.3.2    Export the Report's Data
This right allows you to export document data into a CSV, PDF, Excel, or text file. If this right is granted, it is always possible to save in these file formats. If this right is denied, then export to these file formats is granted if the corresponding Save as CSV, Save as Excel or Text, or Save as PDF right is granted. Table B.2 summarizes whether you can export to a file format depending on the Export the report's data and Save as <file type> rights.





                            "Save as <file type>" Right Is Granted
                        

                            "Save as <file type>" Right Is Denied
                        





"Export the Report's Data" Right Is Granted


                            Granted
                        

                            Granted
                        



"Export the Report's Data" Right Is Denied


                            Granted
                        

                            Denied
                        



Table B.2    Availability of File Format Export Depending on Rights' Values
B.3.3    Publish Shared Elements
This right allows you to create a shared element from a report element of the document (see Chapter 19, Section 19.2). To create a shared element, the Web Intelligence application right Sharing: Publish shared elements must also be granted.
If the right is denied, the commands to publish a report element of the document as a shared element are disabled.
B.3.4    Refresh List of Values
This right allows you to refresh list of values. Lists of values can be found for example in prompts when you need to filter a query. The possible values for a dimension can be retrieved from the database and prompted to the user.
To refresh list of values, you also need the Use lists of values right in order to first access this list.
If the right is denied, when using list of values, you cannot refresh this list from the data source.
B.3.5    Refresh the Report's Data
This right allows you to refresh the document data by running the query to retrieve the data from the document's data providers. This right is not required to schedule the document or to run a publication with this document.
If the right is denied, it is not possible to run the document queries. The refresh commands are disabled.
B.3.6    Save as CSV
If the Export the report's data right is denied for the document, then this right allows you to export the Web Intelligence document data using the CSV file format or schedule it into a CSV file.
If the right is denied, then when exporting or scheduling the document content, the CSV option is not available. As query data can only be exported as a CSV file, it is no longer possible to export query data.
B.3.7    Save as Excel or Text
If the Export the report's data right is denied for the document, then this right allows you to:


                    Export the Web Intelligence document data using Excel or text file formats
                

                    Schedule it into an Excel or text file
                

                    Send the document through a publication as an Excel file
                

If the right is denied, then when exporting, scheduling, or publishing the document content, the Excel and Plain Text options are not available.
B.3.8    Save as PDF
If the Export the report's data right is denied for the document, then this right allows you to:


                    Export the Web Intelligence document data using PDF file format
                

                    Schedule it into an PDF file
                

                    Send the document through a publication as a PDF file
                

If the right is denied, then when exporting, scheduling, or publishing the document content, the PDF or Acrobat Reader option is not available.
B.3.9    Use Lists of Values
This right allows you to use lists of values. Lists of values can be found, for example, in prompts when you need to filter a query. The possible values for a dimension can be retrieved from the database and prompted to the user.
If the right is denied, when editing the document query, you are not able to choose lists of values as a possible option for prompts.
B.3.10    View SQL
This right allows you to view the script generated to query the database through a universe—in SQL for a relational universe or in MDX for a multidimensional universe. To view this script, the document Edit query right and the Web Intelligence application Query script: Enable viewing (SQL, MDX, ...) right must also be granted.









B.4    Mandatory Rights for Common Workflows
Security can be set at different levels to meet different levels of security requirements. The drawback of this flexibility is the number of rights to set on several objects to grant one particular action.
The following sections describe these rights for some common actions.
B.4.1    Viewing a Web Intelligence Document
To view a document, the following rights must be granted:


Log on to Web Intelligence right for Web Intelligence applications


Log on to BI Launch Pad and view this object in the CMC right for the BI Launch Pad application if the document is accessed through the BI Launch Pad
                

View objects right for the folder containing the document
                

View objects right for the document (optional, since it should be inherited from the folder)
                

B.4.2    Creating a Web Intelligence Document
To create a Web Intelligence document on a universe (created either by the Information Design Tool or the Universe Design Tool), the following rights must be granted:


Log on to Web Intelligence right for Web Intelligence applications
                

Log on to BI Launch Pad and view this object in the CMC right for the BI Launch Pad application if the document was created through the BI Launch Pad
                

Documents: Enable creation and Reporting: Enable formatting rights for Web Intelligence applications


Create and edit queries based on the universe, View objects, and Data access  rights for the universe
                

View objects and Data access rights for the connection used by the universe
                

B.4.3    Saving a Web Intelligence Document
To save a Web Intelligence document in the BI platform repository, the following rights must be granted:


Edit objects right for the document, if this action simply updates a document that already exists
                

Add objects to the folder right for the folder where the document will be saved, if this creates a new document in this folder
                

Copy objects to another folder right for the document if a new version of an existing file will be saved
                

At the application level, Web Intelligence does not offer any right to prevent users from saving documents. A workaround is to disable the Add objects right for each folder or disable it at the folder root level and make sure it is inherited by all folders. Thus, the Save button is displayed in Web Intelligence, but no folder is displayed in the folder list and the user cannot save reports.
B.4.4    Refreshing a Web Intelligence Document
To refresh a Web Intelligence document based on a universe and a connection, the following rights must be granted:


Log on to Web Intelligence right for Web Intelligence
                

Log on to BI Launch Pad and view this object in the CMC right for the BI Launch Pad application if the document is accessed through the BI Launch Pad
                

View objects right for the document:
                    

View objects right for the folder containing the document; View objects and Refresh the report's data rights for the document
                        



                    If the document is based on a relational monosource universe created with the Information Design Tool or the Universe Design Tool:
                    

View objects and Data Access rights for the universe
                        

View objects and Data Access rights for the connection
                        



                    If the document is based on a relational multi-source universe created with the Information Design Tool:
                    

View objects and Data Access rights for the universe
                        

View objects and Data Access rights for the all connections
                        



                    If the document is based on a multidimensional universe created with the Information Design Tool:
                    

View objects and Data Access rights for the universe
                        

View objects right for the OLAP connection
                        



                    If the document is based on an SAP Direct Access:


View objects right for the OLAP connection
                        



B.4.5    Editing a Web Intelligence Document
To edit a Web Intelligence document, the following rights must be granted:


Log on to Web Intelligence right for Web Intelligence
                

Log on to BI Launch Pad and view this object in the CMC right for the BI Launch Pad if you access it from the BI Launch Pad
                

View objects and Edit objects rights for the document
                

View objects right for the folder containing the document
                

If the data provider is a universe, the following rights must also be granted:


View objects and Data access rights for the universe
                

View objects and Data access rights for the connection
                

B.4.6    Scheduling a Document
Scheduling and publishing are enforced by the framework, and scheduling rights are controlled by general rights, although these general rights do not apply to objects that cannot be scheduled. So for all applications that use this scheduling framework (Web Intelligence and SAP Crystal Reports), the following rights must be granted to schedule a document:


Log on to <application name> and view this object in the CMC rights for CMC or the BI Launch Pad, depending on the application where the schedule is created
                

View objects right for the document
                

View document instances right for the document
                

Schedule document to run right for the document
                

The same universe and connection rights are needed to refresh the document.
The document is refreshed when it is scheduled. Nevertheless, the "Refresh" right is not needed at the document level for Web Intelligence. Some additional rights must also be granted to change some schedule parameters:


Schedule to destinations right for the document to change the schedule default destination
                

Add objects to Folder and View objects rights for the destination Inbox folder, if the destination is an inbox folder
                

Define server groups to process jobs right to change the server groups that process the schedule
                

To manage scheduling, some general rights can also be useful at the document level: Define server groups to process jobs, Delete instances, View document instances, Pause and Resume document instances, Reschedule instances, and Schedule on behalf of other users.









B.5    Security Reports
In SAP BusinessObjects BI 4.2 SP 4, universe and report samples that take advantage of the connectivity to your BI platform repository are now installed on your file system as a BIAR file, but they are not deployed on the CMS repository. You need to import them using Promotion Management.
This BIAR (BI Platform CMS System Database Sample.lcmbiar) file is installed in the Samples/bionbi folder in your installation folder.








C    The Authors
Christian Ah-Soon has worked for SAP BusinessObjects for almost 20 years as a program manager on transversal areas like administration, security, internationalization, installation, semantic layers, Web Intelligence, and SDKs. He is co-author of SAP BusinessObjects BI Security (SAP PRESS, 2013), Universe Design with SAP BusinessObjects BI: The Comprehensive Guide (SAP PRESS, 2014), and Getting Started with SAP Lumira (SAP PRESS, 2015). Christian holds a Ph.D. in computer science and graduated from TELECOM Nancy.
Jim Brogden is an award-winning technical author and dashboard designer, and a Senior Data Warehouse Developer for Intercontinental Exchange (ICE) in Atlanta, Georgia. He combines a master's degree in Information Technology with nearly ten years of business intelligence consulting experience and a proven track record for delivering BI solutions in a variety of industries. He's the lead author of all three official textbooks dedicated to Web Intelligence, and is an active contributor to SAP's Idea Place. A happily married father of sons Jamie and Hunter, in his off time Jim proclaims himself an avid (beginner) cricket player on the ICE Storm cricket team, a passionate hacker of the golf ball, and a runner (jogger/walker) of frequent (annual) 10Ks in Atlanta.
Dallas Marks is a principal technical architect and trainer for EV Technologies and an SAP Certified Application Associate for SAP BusinessObjects Web Intelligence and the Business Intelligence platform. Dallas has worked with SAP BusinessObjects BI tools since 2003 and has implemented solutions for a number of industries, including retail, energy, health care, and manufacturing. He is a frequent speaker at local ASUG chapters, national ASUG, and SAPinsider conferences, and independent SAP BusinessObjects user groups. Dallas holds a master's degree in computer engineering from the University of Cincinnati. Dallas blogs about various business intelligence topics at http://www.dallasmarks.com/. You can follow him on Twitter at @dallasmarks.
Gabriel Orthous is a population health management and healthcare analytics expert, and a senior consultant to Wellcentive. Gabe has more than 15 years of business analytics managerial and software engineering experience with extensive expertise around business intelligence, financial reporting, and decision analytics. Gabe graduated from Mercer University with a master's degree in Business Administration and was inducted to the International Honor Society Beta Gamma Sigma in 2008. In addition, Gabe is chair for the Dashboarding and Visualization Special Interest Group for ASUG, co-chair for ASUG's Business Objects' Strategic SIG, and an active member of the Customer Advisory Council, as well as a renowned international speaker.
Heather Sinkwitz is a certified SAP BusinessObjects instructor with over 10 years of business intelligence consulting experience. She gained her expertise while working as a business intelligence consultant, specializing as a certified SAP BusinessObjects instructor and solution provider. She currently dedicates herself to building innovative Business Intelligence solutions using a variety of technologies. A data junkie, she enjoys presenting meaningful information in new and unique ways to aid customers in making informed decisions. She remains actively involved in the BI community through participation in user groups and speaking engagements, both locally in her home state of Arizona or nationally. Currently, Heather is the Analytics and Reporting Product Manager for Trax Technologies (www.traxtech.com).







Index

↓A  ↓B  ↓C  ↓D  ↓E  ↓F  ↓G  ↓H  ↓I  ↓J  ↓L  ↓M  ↓N  ↓O  ↓P  ↓Q  ↓R  ↓S  ↓T  ↓U  ↓V  ↓W  ↓Z  
#REF_CELLNOTFOUND [→ Section 11.6]
#REF_DATANOTFOUND [→ Section 11.6]
3D look [→ Section 7.1] [→ Section 6.3]
A ⇑
ABAP [→ Section 13.1] [→ Section 13.1]
ABAP for Eclipse [→ Section 13.1]
Access level [→ Section B.1]
Administrator [→ Section 20.1]
Adobe Acrobat [→ Section 20.2]
Alert [→ Section 22.2]
Alerter [→ Section 3.5]
Align [→ Section 7.1]
All values [→ Section 9.3]
Allow External Access to the Query [→ Section 13.2]
Analysis [→ Section 1.1]
dimension [→ Section 12.3]
view [→ Section 2.1]
views, data source [→ Section 2.6]
workspaces [→ Section 2.6]
AND/OR operations [→ Section 2.3]
Android [→ Section 24.1]
ANSI SQL [→ Section 2.6]
Applet viewer [→ Section 1.2]
Java Runtime Environment [→ Section 1.2]
Application options [→ Section 23.1]
Arranged by alphabetic order [→ Section 13.6]
Arranged by data source [→ Section 13.6]
Arranged by navigation paths [→ Section 13.6]
Ascending or descending chart [→ Section 3.4]
Assign data [→ Section 7.2] [→ Section 7.4]
ASUG [→ Section A.1]
Attribute [→ Section 2.2]
Authentication mode [→ Section 21.1] [→ Section 23.1] [→ Section 23.5]
Auto-merge dimensions [→ Section 2.7]
Available objects tab [→ Section 8.6]
B ⇑
Background Image [→ Section 3.6]
add [→ Section 3.6]
color [→ Section 5.1]
pattern [→ Section 5.1] [→ Section 3.6]
Bar charts 
horizontal grouped [→ Section 6.2]
vertical bar and line [→ Section 6.2]
vertical grouped [→ Section 6.2]
Bar display effects [→ Section 7.1] [→ Section 6.3]
BI Inbox [→ Section 19.2] [→ Section 19.2] [→ Section 19.2] [→ Section 20.2]
BI Launch Pad [→ Section 2.1] [→ Section 1.1] [→ Section 1.2] [→ Section 4.4] [→ Section 16.1] [→ Section 22.1] [→ Section 20.2]
additional menu options [→ Section 16.5]
application icons [→ Section 2.1]
categories [→ Section 16.1] [→ Section 16.3]
details [→ Section 16.1]
document link [→ Section 16.1]
documents tab [→ Section 16.1]
documents toolbar [→ Section 16.1]
folders [→ Section 16.3]
general preferences [→ Section 16.2]
header panel [→ Section 16.1]
header panel menus [→ Section 16.1]
history [→ Section 16.1]
locales and time zone preferences [→ Section 16.2]
modify [→ Section 16.1]
modules [→ Section 17.1] [→ Section 17.1] [→ Section 17.1]
more actions menu [→ Section 16.1]
navigation [→ Section 16.1]
new menu [→ Section 16.1] [→ Section 16.1]
objects [→ Section 18.3] [→ Section 16.5]
organize menu [→ Section 16.1]
organizing objects [→ Section 16.3]
page navigation [→ Section 16.1]
preference options [→ Section 16.2]
preferences [→ Section 16.2]
refresh [→ Section 16.1]
schedule [→ Section 16.1]
scheduling [→ Section 19.4]
searching [→ Section 18.2]
send [→ Section 19.2]
send menu [→ Section 16.1]
setting preferences [→ Section 17.1]
start page [→ Section 16.2]
tables [→ Section 24.2]
tabs [→ Section 16.1]
toolbar [→ Section 16.1] [→ Section 18.1]
view menu [→ Section 16.1]
BI set [→ Section 9.2]
static [→ Section 9.2]
temporal [→ Section 9.2]
BI variant [→ Section 12.2] [→ Section 22.4]
BI workspaces [→ Section 17.1]
Module Library [→ Section 17.1] [→ Section 17.1]
toolbar [→ Section 17.1]
BIAR [→ Section B.5]
BICS [→ Section 13.1]
Blank cells [→ Section 5.4]
Block comment [→ Section 18.5]
Block heading [→ Section 3.2]
Break properties [→ Section 3.2]
Breaks [→ Section 3.2] [→ Section 3.2]
Bulk Change Source [→ Section 14.7]
Bullet graph [→ Section 24.3]
design [→ Section 24.3]
Business layer, View [→ Section 13.3] [→ Section 13.4]
Business security profile [→ Section 13.4]
C ⇑
Calculated measure [→ Section 12.3]
Calculated member [→ Section 12.3] [→ Section 12.3]
Calculation context [→ Section 11.5]
Calendar [→ Section 22.7]
Cancel [→ Section 11.1]
Cancel query [→ Section 12.6] [→ Section 13.6] [→ Section 13.6]
Cascading input control [→ Section 9.3]
Categories 
moving [→ Section 16.3]
new [→ Section 16.3]
organizing [→ Section 16.3]
Category [→ Section 19.1] [→ Section 22.1] [→ Section 22.2] [→ Section 23.3]
Category axis [→ Section 7.1] [→ Section 6.3]
CDS view [→ Section 13.1]
Cell [→ Section 23.3]
Cell comment [→ Section 18.5]
Central Management Console (CMC) [→ Section 12.4] [→ Section 20.1] [→ Section 20.1]
Change default style [→ Section 8.9]
Change source [→ Section 13.1] [→ Section 14.7] [→ Section 13.6]
Change source strategies [→ Section 14.7]
closest object name [→ Section 14.7]
remove the object [→ Section 14.7]
same object ID [→ Section 14.7]
same object path [→ Section 14.7]
same object technical name [→ Section 14.7]
Changed data [→ Section 18.6]
Charts [→ Section 7.1] [→ Section 6.1] [→ Section 3.1] [→ Section 23.3]
angular gauge [→ Section 6.2]
area chart [→ Section 6.2]
bar chart [→ Section 4.2] [→ Section 6.2]
box plot chart [→ Section 6.2]
bubble chart [→ Section 6.2]
business reports [→ Section 6.2]
chloropleth [→ Section 6.2]
column chart [→ Section 6.2] [→ Section 6.2]
converting [→ Section 6.1]
donut chart [→ Section 6.2]
donut chart 2D [→ Section 6.2]
dual value axes [→ Section 6.2]
filter [→ Section 9.3]
format [→ Section 6.3]
geo bubble [→ Section 6.2]
geo pie [→ Section 6.2]
geographical [→ Section 8.11]
globally stacked chart [→ Section 7.4]
heat map chart [→ Section 6.2]
hierarchical charting [→ Section 7.2]
line chart [→ Section 4.2]
line charts [→ Section 6.2]
linear gauge [→ Section 6.2]
multigroup charting [→ Section 3.4]
pie chart [→ Section 4.2] [→ Section 6.2]
pie chart 2D [→ Section 6.2]
pie chart 3D [→ Section 6.2]
point chart [→ Section 6.2]
polar chart [→ Section 6.2]
properties [→ Section 7.1] [→ Section 7.1] [→ Section 6.3]
radar chart [→ Section 4.2] [→ Section 6.2]
scatter chart [→ Section 6.2]
speedometer [→ Section 6.2]
stacking [→ Section 6.2] [→ Section 7.4]
tile [→ Section 6.2]
tree map chart [→ Section 6.2]
types [→ Section 6.2]
view results [→ Section 3.1]
zones [→ Section 6.4]
Class [→ Section 2.2]
Classic desktop reporting tool [→ Section A.1]
Clear filter [→ Section 18.3]
Client-server mode [→ Section 21.1]
CMC [→ Section 6.5] [→ Section 13.1] [→ Section 14.4] [→ Section 18.4] [→ Section 18.5] [→ Section B.1]
CMS security [→ Section 21.1]
Collaboration [→ Section 18.1]
Collapse [→ Section 22.3]
Color palette [→ Section 7.5]
Column [→ Section 23.4]
Column layout [→ Section 17.1]
Combined query [→ Section 14.1]
query union [→ Section 14.1]
remove [→ Section 14.1]
Comment [→ Section 2.7] [→ Section 18.5] [→ Section 18.5] [→ Section 22.3]
Comment cells [→ Section 5.4]
Compound module [→ Section 17.2]
Conditional formatting [→ Section 3.1] [→ Section 7.3] [→ Section 3.5]
rules [→ Section 3.5]
settings [→ Section 3.5]
Conditions [→ Section 2.3]
AND/OR operations [→ Section 2.3]
case statement [→ Section 2.3]
in list segment [→ Section 2.3]
segments [→ Section 2.3]
Confidential [→ Section 24.2]
Connected mode [→ Section 21.1]
Connection, server [→ Section 21.1]
Content linking [→ Section 17.6]
Context [→ Section 2.2] [→ Section 2.2] [→ Section 2.4] [→ Section 23.3]
Conversion [→ Section A.1] [→ Section A.1]
checklist [→ Section A.1]
single-pass report conversion [→ Section A.1] [→ Section A.1]
staged report conversion [→ Section A.1] [→ Section A.1]
Copying objects [→ Section 16.3]
Create variable [→ Section 11.1]
CSS [→ Section 8.9]
file [→ Section 8.9]
CSV [→ Section 19.3] [→ Section 21.1]
export [→ Section 19.3]
save as [→ Section 21.3]
Current members [→ Section 9.2]
Cursor [→ Section 23.3]
Custom BI workspace [→ Section 17.4]
Custom color enhancements [→ Section 7.5]
Custom colors 
CMYK [→ Section 7.5]
HSL [→ Section 7.5]
HSV [→ Section 7.5]
RGB [→ Section 7.5]
swatches [→ Section 7.5]
Custom element [→ Section 6.5]
Custom group [→ Section 3.2] [→ Section 13.6]
Custom sort 
dialog box [→ Section 3.4]
remove [→ Section 3.4]
temporary values [→ Section 3.4]
D ⇑
Dashboards [→ Section 7.3]
Dashports [→ Section 7.1]
Data analysis [→ Section 7.3]
Data definition language [→ Section 2.6]
Data display [→ Section 7.1]
Data format [→ Section 1.3]
Data label displaying mode [→ Section 7.1]
Data mode [→ Section 8.1] [→ Section 4.3]
Data preview [→ Section 2.2] [→ Section 2.2]
filter [→ Section 2.2]
Data provider [→ Section 21.2]
custom [→ Section 21.2]
new [→ Section 14.2]
options [→ Section 21.2]
Data security profile [→ Section 13.4]
Data source 
analysis views [→ Section 2.6]
Excel [→ Section 2.6]
free-hand SQL [→ Section 2.6]
text files [→ Section 2.6]
universes [→ Section 2.2]
web services [→ Section 2.6]
Data synchronization [→ Section 14.5]
automatically synchronized [→ Section 14.5]
extend merged dimension values [→ Section 14.5] [→ Section 14.5]
ForceMerge() formula [→ Section 14.5]
Data tab [→ Section 3.1] [→ Section 8.8]
Data tracking [→ Section 18.6]
advanced techniques [→ Section 18.6]
breaks [→ Section 18.6]
charts [→ Section 18.6]
decreased data [→ Section 18.6]
display [→ Section 18.6]
display data in blocks [→ Section 18.6]
incompatible [→ Section 18.6]
Increased data [→ Section 18.6]
inserted data [→ Section 18.6]
merged dimensions [→ Section 18.6]
modified data [→ Section 18.6]
options [→ Section 18.6]
reference data [→ Section 18.6]
removed data [→ Section 18.6]
sections [→ Section 18.6]
Data type [→ Section 14.5] [→ Section 14.5]
Data values, assigning [→ Section 6.1]
Database ranking [→ Section 9.2]
adding [→ Section 9.2]
enabling [→ Section 9.2]
parameters [→ Section 9.2]
Default enterprise location [→ Section 20.2]
Deleting objects [→ Section 16.3]
Design mode [→ Section 8.1] [→ Section 4.3]
toolbar [→ Section 4.2]
Design time [→ Section 13.2] [→ Section 13.5]
Desktop Intelligence [→ Section 20.1] [→ Section A.1]
Desktop Intelligence Compatibility Pack [→ Section 20.3] [→ Section A.3]
Destination [→ Section 22.7]
Detail [→ Section 2.2]
Dimensions [→ Section 2.2]
Discussions [→ Section 18.4]
delete [→ Section 18.4]
drawer [→ Section 18.4]
notes [→ Section 18.4]
post [→ Section 18.4]
threads [→ Section 18.4]
Display 
data [→ Section 6.1]
effects [→ Section 6.3]
types [→ Section 3.6]
Document 
comment [→ Section 18.5]
Explorer [→ Section 17.1] [→ Section 17.1]
locale [→ Section 22.9]
pane [→ Section 4.4]
properties [→ Section 6.1]
summary [→ Section 8.2] [→ Section 2.7]
viewing [→ Section 16.2]
Document prompt 
build formula [→ Section 15.1]
dynamically passing values to filter [→ Section 15.1]
enter a constant [→ Section 15.1]
prompt user [→ Section 15.1]
select object [→ Section 15.1]
Document Structures and Filters tab [→ Section 8.7]
Drill [→ Section 6.2] [→ Section 7.3] [→ Section 4.2] [→ Section 10.1] [→ Section 22.5]
bars and markers [→ Section 10.4]
chart axis [→ Section 10.4]
charts [→ Section 10.4]
dimensions [→ Section 10.3]
drill by [→ Section 10.3] [→ Section 10.4]
drill down settings [→ Section 10.6]
drill down setup [→ Section 10.2]
drill up [→ Section 10.3]
enabling [→ Section 10.2]
end user [→ Section 10.2] [→ Section 10.2]
filter [→ Section 1.1] [→ Section 1.3] [→ Section 22.5]
legends [→ Section 10.4]
measure [→ Section 10.4]
measures [→ Section 10.3]
options [→ Section 10.6]
prompts [→ Section 10.6]
session [→ Section 1.3]
setup [→ Section 10.2] [→ Section 10.2]
snapshot [→ Section 10.5]
start session [→ Section 10.6]
synchronize [→ Section 10.6]
toolbar [→ Section 10.6]
Drill options 
preferences [→ Section 1.3]
Web Intelligence preferences [→ Section 1.3]
DSAG [→ Section A.1]
Dynamic recipient [→ Section 20.2]
E ⇑
Element link filters [→ Section 1.1]
Element linking [→ Section 7.3] [→ Section 9.5] [→ Section 22.5]
Email [→ Section 19.2] [→ Section 20.2]
report attachments [→ Section 21.3]
Enterprise recipient [→ Section 20.2]
personalization [→ Section 20.2]
Event [→ Section 22.7]
custom [→ Section 20.2]
file [→ Section 20.2]
schedule [→ Section 20.2]
Excel [→ Section 2.1] [→ Section 19.3] [→ Section 15.3] [→ Section 23.1] [→ Section 21.1] [→ Section 20.1] [→ Section 22.9]
export [→ Section 6.5] [→ Section 19.3]
plug-in [→ Section 23.1]
save as [→ Section 21.3]
Excel 2007, save as [→ Section 21.3]
Expand [→ Section 22.3]
Export report, HTML [→ Section A.1]
Export, style [→ Section 8.9]
F ⇑
Facets [→ Section 18.2]
Fading Toolbar [→ Section 22.3]
Favorite [→ Section 22.2]
File system [→ Section 20.2]
File Transfer Protocol (FTP) [→ Section 19.2] [→ Section 20.2]
Filter [→ Section 9.1] [→ Section 2.2] [→ Section 18.3] [→ Section 22.5]
add [→ Section 9.3]
assignment type [→ Section 9.1]
bar [→ Section 9.3]
block [→ Section 9.3]
complex [→ Section 9.2]
content [→ Section 18.3]
custom filter [→ Section 2.3]
data [→ Section 9.1]
description [→ Section 9.1]
group filter [→ Section 2.3]
input control [→ Section 9.3]
object [→ Section 9.1]
objects [→ Section 23.2]
operators [→ Section 9.1]
predefined [→ Section 9.1] [→ Section 2.3]
quick filter [→ Section 2.3]
remove objects [→ Section 9.1]
report panel [→ Section 9.3]
simple [→ Section 9.3]
types [→ Section 9.1]
user-defined [→ Section 9.1]
Folders [→ Section 2.2] [→ Section 23.3]
moving [→ Section 16.3]
new [→ Section 16.3]
organizing [→ Section 16.3]
universe [→ Section 2.2]
Footer [→ Section 3.6]
add [→ Section 3.6]
Format [→ Section 19.1] [→ Section 22.7]
Format number [→ Section 7.4]
Formatting 
changed data [→ Section 18.6]
functional sections [→ Section 8.9]
measure [→ Section 7.4]
report properties [→ Section 8.1]
sections [→ Section 3.2]
tips [→ Section 7.4]
toolbar [→ Section 4.2]
Formula [→ Section 5.1]
bar [→ Section 4.4]
context formula [→ Section 11.5]
create [→ Section 11.1]
definition [→ Section 11.1]
editor [→ Section 11.1] [→ Section 11.1]
editor functions [→ Section 11.1]
syntax [→ Section 11.4]
text cell [→ Section 4.2]
toolbar [→ Section 11.1]
variables [→ Section 11.1]
Freeform layout [→ Section 17.1]
Free-hand SQL [→ Section 2.1] [→ Section 2.6] [→ Section 13.1] [→ Section 13.1] [→ Section 14.7] [→ Section 13.8] [→ Section B.1] [→ Section B.2]
Freeze 
columns [→ Section 5.1]
enabling freeze [→ Section 5.1]
header rows [→ Section 5.1]
headers [→ Section 5.1]
FTP, location [→ Section 19.2]
Functions [→ Section 11.1]
aggregate [→ Section 11.1] [→ Section 11.3]
categories [→ Section 11.3]
character [→ Section 11.1] [→ Section 11.3]
data provider [→ Section 11.1] [→ Section 11.3]
date and time [→ Section 11.1] [→ Section 11.3]
document [→ Section 11.1] [→ Section 11.3]
logical [→ Section 11.1] [→ Section 11.3]
miscellaneous [→ Section 11.1] [→ Section 11.3]
numeric [→ Section 11.1] [→ Section 11.3]
set [→ Section 11.3]
G ⇑
General settings [→ Section 1.3]
Geo map [→ Section 13.6]
Geolocalization [→ Section 8.11]
by latitude and longitude [→ Section 8.11]
by name [→ Section 8.11]
Global configurable options [→ Section 7.1]
Global property category [→ Section 6.3]
Grid and background [→ Section 6.3]
Group Input Control [→ Section 22.5]
Group List [→ Section 19.2]
Grouping [→ Section 5.1]
custom [→ Section 5.1]
custom values [→ Section 5.1]
data [→ Section 3.2]
options [→ Section 5.1]
H ⇑
Header [→ Section 3.6]
add [→ Section 3.6]
panel [→ Section 16.1]
Help [→ Section 23.1]
Hide [→ Section 7.3]
Hide Changes/Show Changes button [→ Section 18.6]
Hierarchical navigation data [→ Section 12.3]
Hierarchy [→ Section 12.3] [→ Section 12.3] [→ Section 22.3]
High Precision Numbers [→ Section 8.10]
History [→ Section 22.7]
Horizontal table 
layout properties [→ Section 5.1]
HTML [→ Section 6.5] [→ Section 15.3]
saving [→ Section 2.5]
HTML client → see [Web Intelligence HTML]
Hyperlink [→ Section 18.1] [→ Section 15.1] [→ Section 18.1] [→ Section 15.2] [→ Section 19.2]
adding [→ Section 15.1]
complete URL Path [→ Section 15.1]
link to document instance [→ Section 15.1]
options [→ Section 18.5]
prompted reports [→ Section 15.1]
properties [→ Section 15.1] [→ Section 15.1]
refresh on open [→ Section 15.1]
target area within the document [→ Section 15.1]
I ⇑
iDocID [→ Section 15.3] [→ Section 15.3]
If-Then-Else syntax [→ Section 11.4]
Import style [→ Section 8.9]
Inbox [→ Section 22.1] [→ Section 22.2]
Information Design Tool [→ Section 2.2] [→ Section 9.2] [→ Section 9.2] [→ Section 12.1] [→ Section 14.4] [→ Section 14.4] [→ Section 12.5] [→ Section 13.4] [→ Section 13.7] [→ Section 13.7] [→ Section 23.1] [→ Section 23.2]
InfoView [→ Section 16.1]
Input control [→ Section 8.4] [→ Section 7.3] [→ Section 22.5] [→ Section 24.5]
assign dependency [→ Section 9.3]
edit or remove [→ Section 9.3]
group [→ Section 9.3]
interacting [→ Section 9.3]
map view [→ Section 8.4]
type [→ Section 8.4] [→ Section 9.3]
Input parameters [→ Section 15.3] [→ Section 13.5]
Instance [→ Section 22.2] [→ Section 22.2] [→ Section 22.7] [→ Section 23.5]
Instance title [→ Section 19.4]
Integrate [→ Section 1.1]
Intersection [→ Section 14.1] [→ Section 14.1]
iOS [→ Section 24.1]
J ⇑
Java [→ Section 1.2] [→ Section 15.2]
Java Applet → see [Web Intelligence Java Applet]
L ⇑
Language formula [→ Section 18.6]
Latitude [→ Section 8.11] [→ Section 8.11]
Legend category options [→ Section 7.1]
Legend property category [→ Section 6.3]
Level [→ Section 12.3] [→ Section 12.3]
Level-based hierarchy [→ Section 12.3]
Light and shadow effects [→ Section 7.1] [→ Section 7.1] [→ Section 6.3]
Light power [→ Section 7.1]
Limits [→ Section 2.2]
Line charts, vertical mixed [→ Section 6.2]
Linking [→ Section 15.1]
List of actions [→ Section 4.4]
List of values [→ Section 9.1] [→ Section 12.3] [→ Section B.3] [→ Section B.3]
cascading [→ Section 12.1]
List Panel [→ Section 16.1]
Live Office [→ Section 23.1]
Live Office Insert Wizard [→ Section 23.1]
Live Office toolbar [→ Section 23.5]
Local data source [→ Section 21.1]
Local documents [→ Section 21.1]
Local universe [→ Section 21.1]
Locale [→ Section 1.3] [→ Section 22.9]
document [→ Section 1.3]
Login parameters [→ Section 23.1] [→ Section 23.5]
Logout [→ Section 22.10]
Longitude [→ Section 8.11] [→ Section 8.11]
M ⇑
Manage servers [→ Section 8.5]
Mandatory variable [→ Section 13.6]
Matches pattern [→ Section 9.1]
MDX [→ Section 13.1] [→ Section B.3]
Measure [→ Section 2.2]
Measure by dimension [→ Section 6.2]
Member selector [→ Section 12.3] [→ Section 12.3] [→ Section 12.3] [→ Section 12.3] [→ Section 12.3] [→ Section 12.3] [→ Section 13.2] [→ Section 12.3]
Members for period [→ Section 9.2]
Members who joined [→ Section 9.2]
Members who left [→ Section 9.2]
Merge Prompts (BEx/HANA Variables) [→ Section 13.5]
Merged dimensions [→ Section 2.7] [→ Section 2.7] [→ Section 14.5] [→ Section 13.6]
existing merge [→ Section 14.5]
hierarchies [→ Section 14.5]
remove from merge [→ Section 14.5]
Merged variable [→ Section 13.6]
MHTML [→ Section 20.2]
Micro bar chart [→ Section 24.3]
design [→ Section 24.3]
Microcube [→ Section 2.2] [→ Section 2.3]
Microsoft Excel [→ Section 20.2]
files [→ Section 14.1]
Priority [→ Section 1.3] [→ Section 1.3]
Microsoft Office [→ Section 23.1]
Microsoft SQL Server Analysis Services [→ Section 12.3]
Minimum Top Offset [→ Section 3.2]
Minus [→ Section 14.1] [→ Section 14.1]
Mobile [→ Section 24.2] [→ Section 24.2]
analytic types [→ Section 24.3]
business intelligence [→ Section 24.1]
categories [→ Section 24.2]
query and formula design [→ Section 24.3]
thumbnails [→ Section 24.6]
versus MobileDesigned [→ Section 24.2]
viewing [→ Section 24.2]
Mobile Web Intelligence 
input controls [→ Section 24.5]
report linking [→ Section 24.4]
MobileDesigned [→ Section 24.2] [→ Section 24.2] [→ Section 24.2]
Modify Object [→ Section 23.1]
Module [→ Section 17.2]
compound modules [→ Section 17.2]
group [→ Section 17.1]
module templates [→ Section 17.1]
My Alerts [→ Section 17.1] [→ Section 17.1]
My Applications [→ Section 17.1]
My Inbox [→ Section 17.1]
My Recently Run Documents [→ Section 17.1]
My Recently Viewed Documents [→ Section 17.1]
navigation list [→ Section 17.1]
private modules [→ Section 17.1] [→ Section 17.1]
public modules [→ Section 17.1] [→ Section 17.1]
text module [→ Section 17.1]
viewer [→ Section 17.1]
web page module [→ Section 17.1]
Multidimensional data source [→ Section 22.3]
Multidimensional universe → see [Universe, multidimensional]
Multiple operator [→ Section 13.2]
Multiple range interval variable [→ Section 13.2]
My Documents drawer [→ Section 19.2]
N ⇑
NAII [→ Section 15.3]
Named set [→ Section 12.3] [→ Section 12.3]
Navigation path [→ Section 2.2]
Nested conditions [→ Section 2.3]
Nesting 
filters [→ Section 9.1]
group [→ Section 9.1]
query filters [→ Section 9.1]
remove [→ Section 9.1]
Netezza [→ Section 9.2]
New chart engine [→ Section 7.3]
NULL_VALUE [→ Section 9.3]
O ⇑
Objects [→ Section 16.5]
alignment [→ Section 4.5]
copying [→ Section 16.3]
deleting [→ Section 16.3]
printing [→ Section 16.5]
Properties [→ Section 23.1]
properties [→ Section 16.3] [→ Section 16.5]
saving [→ Section 16.5]
sorting [→ Section 16.3]
viewing [→ Section 16.5]
Offline [→ Section 21.1]
mode [→ Section 19.1] [→ Section 21.1]
OpenDocument [→ Section 15.1] [→ Section 15.2] [→ Section 15.2] [→ Section 19.2] [→ Section 23.5]
syntax [→ Section 15.3]
Operators [→ Section 2.3] [→ Section 11.1] [→ Section 11.3] [→ Section 11.3]
AND/OR [→ Section 9.1]
Between [→ Section 2.3]
Both [→ Section 2.3]
conditional [→ Section 11.3]
context [→ Section 11.5]
Different from pattern [→ Section 2.3]
Equal to [→ Section 2.3]
Except [→ Section 2.3]
extended syntax [→ Section 11.3]
ForAll [→ Section 11.5]
ForEach [→ Section 11.5]
function-specific [→ Section 11.3]
Greater than [→ Section 2.3]
Greater than or Equal to [→ Section 2.3]
hierarchical [→ Section 11.3]
In list [→ Section 2.3]
Is not null [→ Section 2.3]
Is null [→ Section 2.3]
Less than [→ Section 2.3]
Less than or Equal to [→ Section 2.3]
logical [→ Section 11.3]
Matches pattern [→ Section 2.3]
mathematical [→ Section 11.3]
Not Between [→ Section 2.3]
Not equal to [→ Section 2.3]
Not in list [→ Section 2.3]
report structure [→ Section 11.5]
Outliers [→ Section 6.2]
Outline navigation [→ Section 3.3]
Outlook [→ Section 23.1]
Output parameters [→ Section 15.3] [→ Section 15.3]
P ⇑
Page 
features [→ Section 4.4]
layout [→ Section 4.5]
margins [→ Section 4.5]
mode [→ Section 4.4] [→ Section 4.4] [→ Section 23.3]
Palette and style [→ Section 7.1] [→ Section 6.3]
Parameter 
input [→ Section 15.3]
lsC [→ Section 15.3]
lsM [→ Section 15.3]
lsR [→ Section 15.3]
lsS [→ Section 15.3]
sDocName [→ Section 15.3] [→ Section 15.3]
sIDType [→ Section 15.3] [→ Section 15.3]
sOutputFormat [→ Section 15.3] [→ Section 15.3]
sRefresh [→ Section 15.3]
sReportName [→ Section 15.3]
sReportPart [→ Section 15.3]
sWindow [→ Section 15.3] [→ Section 15.3]
Parent-child hierarchy [→ Section 12.3]
Partial refresh [→ Section 4.4] [→ Section 12.6] [→ Section 20.2] [→ Section 20.2]
Partial result [→ Section 13.6]
Password [→ Section 16.2]
PDF [→ Section 19.3] [→ Section 15.3] [→ Section 20.1] [→ Section 20.2]
export [→ Section 6.5] [→ Section 19.3]
save as [→ Section 21.3]
Performance [→ Section 13.5]
Permanent regional formatting [→ Section 2.7]
Personal data provider [→ Section 21.2]
Pie chart [→ Section 24.2]
Placeholder [→ Section 19.2] [→ Section 19.2]
Plot area [→ Section 6.3]
options [→ Section 7.1]
Post-conversion analysis and validation [→ Section A.1] [→ Section A.1]
PowerPoint [→ Section 23.1]
Predefined cells [→ Section 5.4]
comment cells [→ Section 5.4]
document name [→ Section 5.4] [→ Section 5.4]
drill filter [→ Section 5.4]
last refresh date [→ Section 5.4]
page number [→ Section 5.4]
page number/total pages [→ Section 5.4]
prompts [→ Section 5.4]
query summary [→ Section 5.4]
report filter summary [→ Section 5.4]
total number of pages [→ Section 5.4]
Preferences [→ Section 21.1] [→ Section 21.4] [→ Section 22.9]
groups [→ Section 1.3]
Preferred viewing locale [→ Section 1.3] [→ Section 16.2] [→ Section 22.9]
Printing, BI workspaces [→ Section 17.5]
Product locale [→ Section 1.3] [→ Section 16.2]
Prompt [→ Section 12.3] [→ Section 22.4] [→ Section 22.5] [→ Section 23.3] [→ Section 23.4]
cascading [→ Section 12.1]
cascading filters [→ Section 12.1]
document [→ Section 15.1]
filter [→ Section 9.1] [→ Section 2.4] [→ Section 2.4] [→ Section 15.1]
filter properties [→ Section 9.1]
optional [→ Section 12.1] [→ Section 12.1]
order [→ Section 2.2]
select [→ Section 15.1]
text [→ Section 12.1]
Prompted report [→ Section 15.1]
Properties [→ Section 22.3]
Publications [→ Section 20.1]
advanced options [→ Section 20.2]
delivery rules [→ Section 20.2]
designer [→ Section 20.1]
destinations [→ Section 20.2]
dynamic recipient [→ Section 20.1] [→ Section 20.2]
dynamic recipient list [→ Section 20.2]
enterprise recipients [→ Section 20.2]
events [→ Section 20.2]
formats [→ Section 20.2]
global profile personalization [→ Section 20.2]
local profile personalization [→ Section 20.2] [→ Section 20.2]
mobile [→ Section 20.3]
naming [→ Section 20.2]
personalization [→ Section 20.2]
profile resolution [→ Section 20.2]
prompts [→ Section 20.2]
properties [→ Section 20.2]
recurrence [→ Section 20.2]
report bursting [→ Section 20.1]
report bursting method [→ Section 20.2] [→ Section 20.2]
roles [→ Section 20.1]
server groups [→ Section 20.2]
single pass report bursting [→ Section 20.1]
summary screen [→ Section 20.2]
test mode [→ Section 20.2]
Publisher [→ Section 20.1]
Purging data [→ Section 12.6]
Q ⇑
Query [→ Section 1.1]
adding [→ Section 14.2]
combined query [→ Section 14.1]
drill [→ Section 2.7]
filter [→ Section 9.1] [→ Section 2.2] [→ Section 2.3]
filter benefits [→ Section 2.3]
filter pane [→ Section 9.1] [→ Section 2.3]
new [→ Section 14.2]
panel [→ Section 2.1] [→ Section 2.1] [→ Section 9.1] [→ Section 2.1] [→ Section 12.1] [→ Section 13.2] [→ Section 21.2] [→ Section 23.2]
properties [→ Section 2.2]
refreshing [→ Section 14.4]
run [→ Section 12.1]
script viewer [→ Section 2.2]
stripping [→ Section 2.7] [→ Section 12.5]
time [→ Section 13.2] [→ Section 13.5]
Query as a Web Service [→ Section 18.2]
designer [→ Section 2.6]
Quick display mode [→ Section 4.4] [→ Section 4.4] [→ Section 23.3]
R ⇑
Ranking [→ Section 3.4] [→ Section 3.4] [→ Section 22.6] [→ Section 23.2]
add [→ Section 3.4]
edit [→ Section 3.4]
properties [→ Section 3.4]
remove [→ Section 3.4]
steps [→ Section 3.4]
Reading mode [→ Section 8.1] [→ Section 4.3] [→ Section 9.3]
toolbar [→ Section 4.2]
Real lighting and complex shadows [→ Section 7.1] [→ Section 6.3]
Recipient [→ Section 20.1] [→ Section 20.1]
Recurrence [→ Section 22.7]
Recycle Bin [→ Section 22.2]
Reference [→ Section 11.6]
Reference data [→ Section 18.6] [→ Section 18.6] [→ Section 18.6]
setting [→ Section 18.6]
Refresh [→ Section 4.4] [→ Section 22.4]
all objects [→ Section 23.1]
object [→ Section 23.1]
options [→ Section 23.1]
Refresh on open [→ Section 9.1] [→ Section 2.5] [→ Section 2.7] [→ Section 23.3]
Region color [→ Section 7.4] [→ Section 3.4]
Relational universe → see [Universe]
Relative positioning [→ Section 3.1] [→ Section 5.1] [→ Section 4.5]
Reply to Group option [→ Section 18.4]
Reply to Sender option [→ Section 18.4]
Report [→ Section 1.1]
adding charts [→ Section 6.1]
assigning data [→ Section 3.1]
bar [→ Section 9.3]
body [→ Section 4.4]
consolidate [→ Section A.1]
create/edit [→ Section 3.2]
designer [→ Section 20.1]
designing [→ Section 24.2]
distribution with publications [→ Section 20.1]
element [→ Section 3.1] [→ Section 6.1] [→ Section 5.1] [→ Section 9.3]
eliminate [→ Section A.1]
exporting [→ Section 19.3]
exporting to CMS [→ Section 21.3]
file location [→ Section 19.2]
filter [→ Section 9.3] [→ Section 20.1] [→ Section 20.1]
footer [→ Section 4.4]
functions [→ Section 11.3]
header [→ Section 4.4]
hide elements [→ Section 9.4]
interface [→ Section 4.1]
linking [→ Section 24.4]
locally saved [→ Section A.1]
manually unconverted [→ Section A.1]
map [→ Section 8.3]
page mode [→ Section 4.4]
panel [→ Section 4.1] [→ Section 5.1] [→ Section 5.1] [→ Section 4.4] [→ Section 11.1]
part [→ Section 15.1]
prioritize [→ Section A.1]
quick display mode [→ Section 4.4]
saving locally [→ Section 21.3]
scheduling [→ Section 19.4]
scheduling with publications [→ Section 20.1]
title [→ Section 5.1]
value [→ Section A.1]
Report Conversion Tool [→ Section 20.1] [→ Section A.1]
Report property 
analysis tab [→ Section 4.2] [→ Section 4.5]
categories [→ Section 4.5]
data access tab [→ Section 4.2] [→ Section 4.5]
file tab [→ Section 4.2]
formatting tab [→ Section 4.2] [→ Section 4.5]
function tabs [→ Section 4.2]
page layout [→ Section 4.5]
properties tab [→ Section 4.2]
report element tab [→ Section 4.2] [→ Section 4.5]
Reporting toolbars [→ Section 4.2]
Repository, publish [→ Section 21.3]
Reset standard default style [→ Section 8.9]
REST Web Services [→ Section 6.5]
Result objects [→ Section 5.1] [→ Section 2.2] [→ Section 2.2] [→ Section 4.3] [→ Section 23.2]
Ribbon toolbar [→ Section 4.2]
Rich Internet Application [→ Section 1.2] [→ Section 15.2]
Right to left [→ Section 2.7]
Rights 
add object to the folder [→ Section B.4]
copy objects to another folder [→ Section B.4]
create and edit queries based on this universe [→ Section B.4]
data access [→ Section B.4]
data: enable data tracking [→ Section B.2]
data: enable formatting of changed data [→ Section B.2]
desktop interface: enable local data providers [→ Section B.2]
desktop interface: enable web intelligence desktop [→ Section B.2]
desktop interface: export documents [→ Section B.2]
desktop interface: import documents [→ Section B.2]
desktop interface: install from bi launch pad [→ Section B.2]
desktop interface: print documents [→ Section B.2]
desktop interface: remove document security [→ Section B.2]
desktop interface: save documents locally [→ Section B.2]
desktop interface: save document for all users [→ Section B.2]
desktop interface: send by mail [→ Section B.2]
disable export to bi on demand for this user [→ Section B.2]
disable import from bi on demand for this user [→ Section B.2]
documents: disable automatic refresh on open [→ Section B.2]
documents: enable auto-save [→ Section B.2]
documents: enable creation [→ Section B.2] [→ Section B.4]
edit objects [→ Section B.3] [→ Section B.4]
edit query [→ Section B.3]
export the report's data [→ Section B.3]
general: edit 'my preferences' [→ Section B.2]
general: enable right-click menus [→ Section B.2]
interfaces: enable rich internet application [→ Section B.2]
interfaces: enable web viewing interface [→ Section B.2]
left pane: enable document structure and filters [→ Section B.2]
left pane: enable document summary [→ Section B.2]
log on to ... and view this object in the cmc [→ Section B.4]
query script: enable editing (sql, mdx, ...) [→ Section B.2]
query script: enable viewing (sql, mdx, ...) [→ Section B.2]
refresh list of values [→ Section B.3]
refresh the report's data [→ Section B.3]
reporting: create and edit breaks [→ Section B.2]
reporting: create and edit conditional formatting rules [→ Section B.2]
reporting: create and edit input controls [→ Section B.2]
reporting: create and edit predefined calculations [→ Section B.2]
reporting: create and edit report filters and consume input controls [→ Section B.2]
reporting: create and edit sorts [→ Section B.2]
reporting: create formulas and variables [→ Section B.2]
reporting: enable formatting [→ Section B.2] [→ Section B.4]
reporting: enable merged dimensions [→ Section B.2]
reporting: insert and remove reports, tables, charts, and cells [→ Section B.2]
save as CSV [→ Section B.3]
save as Excel [→ Section B.3]
sharing: insert shared elements [→ Section B.2]
sharing: publish shared elements [→ Section B.2] [→ Section B.3]
use lists of values [→ Section B.3]
view objects [→ Section B.4]
view sql [→ Section B.3]
Roadmap and conversion plan [→ Section A.1]
Row [→ Section 23.4]
S ⇑
Same-level break [→ Section A.1]
Sample [→ Section 2.2] [→ Section B.5]
SAP Analysis for Office [→ Section 22.1]
SAP App Center [→ Section 4.4] [→ Section 6.5]
SAP BEx query [→ Section 2.1] [→ Section 2.7] [→ Section 14.1] [→ Section 13.2] [→ Section 12.5]
data source [→ Section 13.2]
member prompting [→ Section 13.2] [→ Section 13.3]
SAP BEx Query Designer [→ Section 13.2]
SAP Business Suite [→ Section 13.1]
SAP Business Warehouse [→ Section 13.1]
SAP BusinessObjects administrator [→ Section 20.1] [→ Section 20.2]
SAP BusinessObjects Analysis, OLAP edition [→ Section 2.6] [→ Section 18.2]
SAP BusinessObjects BI 4.2 SP 4 [→ Section 22.1]
SAP BusinessObjects Dashboards [→ Section 8.5] [→ Section 9.4] [→ Section 24.1]
SAP BusinessObjects Desktop Intelligence [→ Section A.1]
SAP BusinessObjects Enterprise XI [→ Section 20.1]
SAP BusinessObjects Explorer [→ Section 24.1] [→ Section 23.1]
SAP BusinessObjects Live Office [→ Section 23.1]
enterprise options [→ Section 23.5]
general options [→ Section 23.5]
integration [→ Section 23.1]
object properties [→ Section 23.5]
preferences [→ Section 23.5]
refresh [→ Section 23.5]
search [→ Section 23.2]
toolbar [→ Section 23.1]
view options [→ Section 23.5]
SAP BusinessObjects Mobile [→ Section 22.2]
features [→ Section 24.1]
tables [→ Section 24.2]
SAP BusinessObjects Mobile 6.2 for Android [→ Section 24.1]
SAP BusinessObjects Mobile 6.5 for iOS [→ Section 24.1]
SAP BusinessObjects Mobile BI [→ Section 20.3]
SAP BusinessObjects Mobile for iOS [→ Section 24.1]
SAP BW [→ Section 13.1]
InfoProvider [→ Section 13.4]
SAP BW/4HANA [→ Section 13.1]
SAP Community Network (SCN) [→ Section A.1]
SAP Crystal Reports [→ Section 24.1] [→ Section 22.1] [→ Section 23.1] [→ Section 23.1] [→ Section 20.2] [→ Section 20.2]
SAP Crystal Reports for Enterprise [→ Section 23.1]
SAP Direct Access [→ Section B.2] [→ Section B.4]
SAP Fiori [→ Section 22.1]
SAP HANA [→ Section 2.1] [→ Section 9.2] [→ Section 2.7] [→ Section 13.1] [→ Section 12.5]
analytic view [→ Section 13.5] [→ Section 13.7]
attribute view [→ Section 13.5] [→ Section 13.7]
calculation view [→ Section 13.5] [→ Section 13.7]
direct access [→ Section 4.4] [→ Section 13.1] [→ Section 13.5]
input parameter [→ Section 13.6] [→ Section 13.7]
online mode [→ Section 2.1] [→ Section 4.4] [→ Section 19.1] [→ Section 13.1] [→ Section 13.6]
table [→ Section 13.5] [→ Section 13.8]
variable [→ Section 13.6] [→ Section 13.7]
view [→ Section 14.1] [→ Section 13.8]
SAP Lumira [→ Section 24.1]
SAP S/4HANA [→ Section 13.1]
Save [→ Section 16.5] [→ Section 23.1]
Save as [→ Section 16.5]
New to Repository [→ Section 23.1]
Scale to page [→ Section 7.3]
Schedule [→ Section 22.2] [→ Section 22.2] [→ Section 22.7] [→ Section 23.5]
Scheduling [→ Section 19.4]
1st Monday of month [→ Section 19.4]
caching [→ Section 19.4]
calendar [→ Section 19.4]
daily [→ Section 19.4]
destinations [→ Section 19.4]
events [→ Section 19.4]
formats [→ Section 19.4]
history [→ Section 19.4]
Hourly [→ Section 19.4]
instance [→ Section 19.4] [→ Section 19.4]
last day of month [→ Section 19.4]
monthly [→ Section 19.4]
now [→ Section 19.4]
nth of month [→ Section 19.4]
once [→ Section 19.4]
recurrence [→ Section 19.4]
server group [→ Section 19.4]
weekly [→ Section 19.4]
x Day of nth week of the month [→ Section 19.4]
Scheduling destination 
BI Inbox [→ Section 20.1] [→ Section 20.1]
email [→ Section 20.1]
file system [→ Section 20.1]
FTP [→ Section 20.1]
Scope of analysis [→ Section 2.2] [→ Section 10.1] [→ Section 10.1]
Scorecard [→ Section 24.3]
design [→ Section 24.3]
Search [→ Section 19.2] [→ Section 22.1] [→ Section 23.3]
object types [→ Section 18.2]
techniques [→ Section 18.2]
Sections [→ Section 3.2]
Sections and breaks [→ Section 6.2]
Security Model [→ Section B.1]
Security Reports [→ Section B.5]
Selection types [→ Section 1.3]
Send [→ Section 19.2] [→ Section 19.2]
Send To [→ Section 19.2] [→ Section 19.2]
Server architecture [→ Section A.1]
Server group [→ Section 19.4] [→ Section 22.7]
Set analysis [→ Section 9.2]
Set as section [→ Section 3.2]
Shared element [→ Section 4.4] [→ Section 2.7] [→ Section 2.7] [→ Section 19.1] [→ Section 13.6]
check for updates [→ Section 19.1]
create [→ Section 19.1]
find [→ Section 19.1]
insert [→ Section 19.1] [→ Section 19.1]
manage [→ Section 19.1]
modify [→ Section 19.1]
unlink [→ Section 19.1]
update [→ Section 19.1]
Sharing [→ Section 1.1] [→ Section 19.1] [→ Section 19.1]
Shortcut [→ Section 18.1] [→ Section 18.1] [→ Section 16.3]
copy [→ Section 18.1]
My Favorites [→ Section 18.1]
Side panel [→ Section 3.1] [→ Section 5.1] [→ Section 4.3]
Single Sign-On [→ Section 2.6]
Snapshot [→ Section 23.1]
Sort [→ Section 22.6] [→ Section 23.2]
custom sort [→ Section 22.6]
Sorting [→ Section 3.4] [→ Section 18.3]
by dimensions [→ Section 3.4]
content [→ Section 18.3]
cross table [→ Section 3.4]
custom [→ Section 3.4] [→ Section 3.4]
enhanced [→ Section 3.4]
manage sorts [→ Section 3.4]
objects [→ Section 16.3]
temporary values [→ Section 3.4]
type [→ Section 3.4]
Sparkline [→ Section 24.3]
formula area [→ Section 24.3]
mobile device display [→ Section 24.3]
SQL [→ Section 9.1] [→ Section 2.6] [→ Section 13.1] [→ Section 12.4] [→ Section B.3]
free-hand [→ Section A.1]
generated [→ Section 2.2]
script [→ Section 2.2]
validate [→ Section 12.4]
SQL Server [→ Section 9.2]
SQL view [→ Section 13.1]
Stacking [→ Section 7.4]
Standalone mode [→ Section 21.1] [→ Section 21.1]
Status bar [→ Section 4.4] [→ Section 6.5]
Stored procedure [→ Section 2.6]
Style sheet modification [→ Section 8.9]
Sub-query [→ Section 9.2] [→ Section 9.2] [→ Section 9.2] [→ Section 23.2]
Switch to SAP HANA direct access [→ Section 13.6]
T ⇑
Table [→ Section 4.2] [→ Section 23.3]
appearance property [→ Section 5.1]
border property [→ Section 5.1]
converting [→ Section 5.3]
cross table [→ Section 3.1] [→ Section 4.2] [→ Section 5.2] [→ Section 5.2]
data table [→ Section 5.3]
displaying data [→ Section 5.1]
drag and drop objects [→ Section 3.1]
form table [→ Section 4.2] [→ Section 5.2] [→ Section 5.2]
general property [→ Section 5.1]
horizontal table [→ Section 4.2] [→ Section 5.2]
layout [→ Section 4.2]
layout property [→ Section 5.1]
properties [→ Section 5.1]
types [→ Section 5.1] [→ Section 5.2]
using [→ Section 5.1]
vertical table [→ Section 5.1] [→ Section 3.2] [→ Section 4.2] [→ Section 5.2] [→ Section 5.2]
Target window [→ Section 15.2]
property [→ Section 15.2]
Templates [→ Section 17.1] [→ Section 17.1]
layout [→ Section 17.1]
Text modules [→ Section 17.2] [→ Section 17.2]
Thumbnail [→ Section 24.6]
Time zone [→ Section 1.3] [→ Section 16.2]
Title category options [→ Section 7.1]
Title property category [→ Section 6.3]
Tool tip [→ Section 15.2] [→ Section 15.2]
Toolbars [→ Section 17.1]
Track data changes [→ Section 4.4]
Turn Into [→ Section 6.1] [→ Section 5.3] [→ Section 5.3]
U ⇑
Union [→ Section 14.1] [→ Section 14.1] [→ Section 14.1]
Unique identifier [→ Section 19.2]
Universe [→ Section 2.1] [→ Section 9.1] [→ Section 13.1] [→ Section 13.3] [→ Section 13.4] [→ Section 13.7] [→ Section 23.1]
multidimensional [→ Section 2.7] [→ Section 13.1]
objects [→ Section 2.1]
outline [→ Section 2.2]
parameters [→ Section 12.6]
relational [→ Section 9.2] [→ Section 2.7] [→ Section 23.1] [→ Section 23.2]
view [→ Section 2.2]
Universe Design Tool [→ Section 2.1] [→ Section 14.4] [→ Section 14.4] [→ Section 14.7] [→ Section 12.5] [→ Section 13.4] [→ Section 23.1] [→ Section 23.2]
Unmerging dimension [→ Section 14.5]
Unstacked [→ Section 7.4]
URL [→ Section 6.5]
User education [→ Section A.1] [→ Section A.1]
User List [→ Section 19.2]
USF [→ Section A.1]
V ⇑
Validate [→ Section 11.1]
Value axis [→ Section 6.3]
options [→ Section 7.1]
stacking [→ Section 7.4]
Value-based break [→ Section A.1]
Variable [→ Section 13.2] [→ Section 13.5] [→ Section 13.6]
create [→ Section 11.1] [→ Section 11.1]
editor [→ Section 11.1]
modify [→ Section 11.4]
save [→ Section 11.4]
slice depth [→ Section 6.2]
syntax [→ Section 11.4]
Variance calculation [→ Section A.1]
VBA [→ Section A.1] [→ Section A.1]
Venn diagram [→ Section 9.2]
Vertical table, layout properties [→ Section 5.1]
View Latest Instance option [→ Section 19.4]
View Object in Browser [→ Section 23.1]
View structure [→ Section 4.1] [→ Section 3.2]
VNSG [→ Section A.1]
Volume effects [→ Section 6.3]
W ⇑
Web Intelligence [→ Section 1.1]
capabilities [→ Section 1.1]
features [→ Section 1.1]
functions [→ Section 1.1]
offline mode [→ Section 1.2]
preferences [→ Section 1.3]
report designer [→ Section 20.1]
report parts [→ Section 17.3]
settings [→ Section 1.3]
Web Intelligence 4.1 
core functionality [→ Section 1.1]
Query Panel [→ Section 2.2]
Web Intelligence HTML [→ Section 2.1] [→ Section 1.2] [→ Section 2.5] [→ Section 15.1] [→ Section 19.3] [→ Section 15.3]
Web Intelligence Interactive Viewer [→ Section 1.2] [→ Section 22.1]
Web Intelligence Java Applet [→ Section 2.1] [→ Section 1.2] [→ Section 19.3]
Web Intelligence Rich Client [→ Section 2.1] [→ Section 1.2] [→ Section 19.3] [→ Section 21.1] [→ Section 21.1] [→ Section 20.1] [→ Section B.2]
access [→ Section 21.1]
connected mode [→ Section 21.1]
data provider [→ Section 21.2]
data sources [→ Section 21.2]
differences [→ Section 21.1]
document security [→ Section 21.3]
import [→ Section 21.3]
import a universe [→ Section 21.2]
install [→ Section 21.1] [→ Section 21.1]
launch [→ Section 21.1]
offline mode [→ Section 21.1]
preferences [→ Section 21.4]
printing [→ Section 21.3]
query panel [→ Section 21.2]
reports [→ Section 21.3]
save [→ Section 21.3]
save for all users [→ Section 21.3]
standalone mode [→ Section 21.1]
Web Intelligence viewer toolbar [→ Section 16.5]
Web Service Definition Language (WSDL) [→ Section 8.5]
Web services [→ Section 2.6] [→ Section 21.1] [→ Section 23.1] [→ Section 23.5]
publisher tab [→ Section 8.5]
WebI [→ Section 1.1]
Wild card [→ Section 9.1]
character [→ Section 2.3]
Windows Task Scheduler [→ Section A.3]
Word [→ Section 23.1]
Workspace panel [→ Section 19.4]
Z ⇑
Zone formatting [→ Section 6.4]
Zoom [→ Section 4.4] [→ Section 22.3] [→ Section 23.3]










Service Pages
The following sections contain notes on how you can contact us. In addition, you are
            provided with further recommendations on the customization of the screen layout for
            your e-book.
         
Praise and Criticism
We hope that you enjoyed reading this book. If it met your expectations, please do
            recommend it. If you think there is room for improvement, please get in touch with
            the editor of the book: Will Jobst. We welcome every suggestion for improvement but, of course, also any praise! You
            can also share your reading experience via Twitter, Facebook, or email.
         
Supplements
If there are supplements available (sample code, exercise materials, lists, and so
            on), they will be provided in your online library and on the web catalog page for
            this book. You can directly navigate to this page using the following link: https://www.sap-press.com/4412. Should we learn about typos that alter the meaning or content errors, we will provide
            a list with corrections there, too.
         
Technical Issues
If you experience technical issues with your e-book or e-book account at SAP PRESS,
            please feel free to contact our reader service: support@rheinwerk-publishing.com.
         
Please note, however, that issues regarding the screen presentation of the book content
            are usually not caused by errors in the e-book document. Because nearly every reading
            device (computer, tablet, smartphone, e-book reader) interprets the EPUB or Mobi file
            format differently, it is unfortunately impossible to set up the e-book document in
            such a way that meets the requirements of all use cases.
         
In addition, not all reading devices provide the same text presentation functions
            and not all functions work properly. Finally, you as the user also define with your
            settings how the book content is displayed on the screen.
         
he EPUB format, as currently provided and handled by the device manufacturers, is
            actually primarily suitable for the display of mere text documents, such as novels.
            Difficulties arise as soon as technical text contains figures, tables, footnotes,
            marginal notes, or programming code. For more information, please refer to the section
            Notes on the Screen Presentation and the following section.
         
Should none of the recommended settings satisfy your layout requirements, we recommend
            that you use the PDF version of the book, which is available for download in your
            online library.
         
Recommendations for Screen Presentation and Navigation
We recommend using a sans-serif font, such as Arial or Seravek, and a low font size of approx. 30-40% in portrait format
            and 20-30% in landscape format. The background shouldn't be too bright.
         
Make use of the hyphenation option. If it doesn't work properly, align the text to the left margin. Otherwise,
            justify the text.
         
To perform searches in the e-book, the index of the book will reliably guide you to the really relevant
            pages of the book. If the index doesn't help, you can use the search function of your
            reading device.
         
Since it is available as a double-page spread in landscape format, the table of contents we've included probably gives a better overview of the content and the structure
            of the book than the corresponding function of your reading device. To enable you
            to easily open the table of contents anytime, it has been included as a separate entry
            in the device-generated table of contents.
         
If you want to zoom in on a figure, tap the respective figure once. By tapping once again, you return to the previous screen. If you tap twice (on the
            iPad), the figure is displayed in the original size and then has to be zoomed in to
            the desired size. If you tap once, the figure is directly zoomed in and displayed
            with a higher resolution.
         
For books that contain programming code, please note that the code lines may be wrapped incorrectly or displayed incompletely
            as of a certain font size. In case of doubt, please reduce the font size.
         
About Us and Our Program
The website http://www.sap-press.com provides detailed and first-hand information on our current publishing program. Here,
            you can also easily order all of our books and e-books. Information on Rheinwerk Publishing
            Inc. and additional contact options can also be found at http://www.sap-press.com.
         










Legal Notes
This section contains the detailed and legally binding usage conditions for this e-book.
Copyright Note
This publication is protected by copyright in its entirety. All usage and exploitation
            rights are reserved by the author and Rheinwerk Publishing; in particular the right
            of reproduction and the right of distribution, be it in printed or electronic form.
            © 2017 by Rheinwerk Publishing Inc., Boston (MA)

Your Rights as a User
You are entitled to use this e-book for personal purposes only. In particular, you
            may print the e-book for personal use or copy it as long as you store this copy on
            a device that is solely and personally used by yourself. You are not entitled to any
            other usage or exploitation.
         
In particular, it is not permitted to forward electronic or printed copies to third
            parties. Furthermore, it is not permitted to distribute the e-book on the Internet,
            in intranets, or in any other way or make it available to third parties. Any public
            exhibition, other publication, or any reproduction of the e-book beyond personal use
            are expressly prohibited. The aforementioned does not only apply to the e-book in
            its entirety but also to parts thereof (e.g., charts, pictures, tables, sections of
            text).
         
Copyright notes, brands, and other legal reservations as well as the digital watermark
            may not be removed from the e-book.
         
Digital Watermark
This e-book copy contains a digital watermark, a signature that indicates which person may use this copy.
         
If you, dear reader, are not this person, you are violating the copyright. So please
            refrain from using this e-book and inform us about this violation. A brief email to
            info@rheinwerk-publishing.com is sufficient. Thank you!
         
Trademarks
The common names, trade names, descriptions of goods, and so on used in this publication
            may be trademarks without special identification and subject to legal regulations
            as such.
         
All of the screenshots and graphics reproduced in this book are subject to copyright
            © SAP SE, Dietmar-Hopp-Allee 16, 69190 Walldorf, Germany. SAP, the SAP logo, ABAP,
            Ariba, ASAP, Concur, Concur ExpenseIt, Concur TripIt, Duet, SAP Adaptive Server Enterprise,
            SAP Advantage Database Server, SAP Afaria, SAP ArchiveLink, SAP Ariba, SAP Business
            ByDesign, SAP Business Explorer, SAP BusinessObjects, SAP BusinessObjects Explorer,
            SAP BusinessObjects Lumira, SAP BusinessObjects Roambi, SAP BusinessObjects Web Intelligence,
            SAP Business One, SAP Business Workflow, SAP Crystal Reports, SAP EarlyWatch, SAP
            Exchange Media (SAP XM), SAP Fieldglass, SAP Fiori, SAP Global Trade Services (SAP
            GTS), SAP GoingLive, SAP HANA, SAP HANA Vora, SAP Hybris, SAP Jam, SAP MaxAttention,
            SAP MaxDB, SAP NetWeaver, SAP PartnerEdge, SAPPHIRE NOW, SAP PowerBuilder, SAP PowerDesigner,
            SAP R/2, SAP R/3, SAP Replication Server, SAP S/4HANA, SAP SQL Anywhere, SAP Strategic
            Enterprise Management (SAP SEM), SAP SuccessFactors, The Best-Run Businesses Run SAP,
            TwoGo are registered or unregistered trademarks of SAP SE, Walldorf, Germany.
         
Limitation of Liability
Regardless of the care that has been taken in creating texts, figures, and programs,
            neither the publisher nor the author, editor, or translator assume any legal responsibility
            or any liability for possible errors and their consequences.
         










The Document Archive
The Document Archive contains all figures, tables, and footnotes, if any, for your
            convenience.
         











Figure 1.1    Example Web Intelligence Report in Design Mode
         











Figure 1.2    Example Web Intelligence Report in Reading Mode
         











Figure 1.3    Preferences Link in the BI Launch Pad
         











Figure 1.4    Web Intelligence Preferences
         











Figure 1.5    Locales and Time Zone Preferences
         











Figure 1.6    Drill Options Settings and Drill Session Start Type
         











Figure 2.1    Launching Web Intelligence from BI Launch Pad
         











Figure 2.2    Launching Web Intelligence from the Applications Menu Link
         











Figure 2.3    Options Available before Creating or Opening a Document
         











Figure 2.4    Selecting a Data Source for a New Document in Web Intelligence Java
         











Figure 2.5    Data Source Types Available in Web Intelligence Rich Client
         











Figure 2.6    Universe Selection
         











Figure 2.7    Universe Query Panel
         











Figure 2.8    Selecting Views to Display in the Universe Outline
         











Figure 2.9    Selected Objects in the Query Panel
         











Figure 2.10    Query Properties
         











Figure 2.11    Data Preview
         











Figure 2.12    Creating Simple Filters from the Data Preview Section
         











Figure 2.13    Dynamically Filtering Preview Data
         











Figure 2.14    View Query Script Generated by the Query Panel
         











Figure 2.15    The Edit Icon
         











Figure 2.16    Filter Operator Selection
         











Figure 2.17    Adding a Quick Filter to a Result Object
         











Figure 2.18    Nested Query Filter Conditions
         











Figure 2.19    Choosing Prompt as Filter Type
         











Figure 2.20    Prompt Filter Properties
         











Figure 2.21    Answering Prompts
         











Figure 2.22    Context Selection Prompt
         











Figure 2.23    Save Menu in Web Intelligence Applet
         











Figure 2.24    Save Document Dialog Box in Web Intelligence Applet
         











Figure 2.25    Save Document Dialog Box with Advanced Options in Applet
         











Figure 2.26    Save Document Dialog Box in HTML
         











Figure 2.27    Save Document Dialog Box with Advanced Options in HTML
         











Figure 2.28    Selecting Excel File in BI Platform Repository
         











Figure 2.29    Options for Using an Excel File as a Data Source
         











Figure 2.30    Excel Query Panel
         











Figure 2.31    Free-Hand SQL Query Script Editor
         











Figure 2.32    Free-Hand SQL Query Panel
         











Figure 2.33    Custom Data Provider - Text Dialog Box
         











Figure 2.34    Text File Query Panel
         











Figure 2.35    Custom Data Provider - Web Services Dialog Box
         











Figure 2.36    Web Service Details
         











Figure 2.37    Web Service Details
         











Figure 2.38    Web Service Query Panel
         











Figure 2.39    Viewing a Cube in SAP BusinessObjects Analysis, OLAP Edition
         











Figure 2.40    Analysis View Query Panel
         











Figure 2.41    Document Summary Options
         











Figure 3.1    Selecting a Location on the Report Canvas to Insert the Selected Element
         











Figure 3.2    Drag and Drop a Sales Revenue Measure Object to a Crosstab
         











Figure 3.3    Right-Clicking on a Crosstab to Assign Data
         











Figure 3.4    Assign Data Window When Adding Objects to a Crosstab
         











Figure 3.5    Inserting a Section with the Section Tab
         











Figure 3.6    Choosing a Location to Insert a Section
         











Figure 3.7    Transforming a Column in a Table to a Section
         











Figure 3.8    Setting the City Object as a Section
         











Figure 3.9    Structure Only View of a Report
         











Figure 3.10    Locating the Minimum Top Offset Section Setting
         











Figure 3.11    Adding a Break Using the Ribbon Toolbar
         











Figure 3.12    Managing Break Properties
         











Figure 3.13    Adding a Custom Group
         











Figure 3.14    Locating Outline in the Reading Toolbar
         











Figure 3.15    Outline Enabled on a Report with Breaks
         











Figure 3.16    Enabling the Fold/Unfold Options in Outline Mode
         











Figure 3.17    Folding Enabled on the Fourth Break to Show Totals by Week
         











Figure 3.18    Folding at a Higher Level
         











Figure 3.19    Varying Levels of Folding
         











Figure 3.20    Sort from the Toolbar Menu under Analysis/Display
         











Figure 3.21    Default or Natural Sorting Applied to the Month Abbreviation
         











Figure 3.22    Custom Sorting
         











Figure 3.23    Sorting Sales Revenue in Descending Order
         











Figure 3.24    Sorting by Group
         











Figure 3.25    Adding a Second Optional Dimension with the Region Color Entry
         











Figure 3.26    Sorting a Chart by a Dimension and Measure
         











Figure 3.27    Applying Sorts to a Crosstab
         











Figure 3.28    Ranking Dialog Box for a Crosstab
         











Figure 3.29    New Conditional Rule Button on the Ribbon Toolbar
         











Figure 3.30    Formatting Rule Editor
         











Figure 3.31    Formatting Rules Display
         











Figure 3.32    Conditional Formatting Rules Applied to a Column in a Table
         











Figure 3.33    Basic Conditional Format Setup in the Formatting Rule Editor
         











Figure 3.34    Format Header Window
         











Figure 3.35    Report Header Set as Visible in a Report
         











Figure 3.36    Format Cell Appearance
         











Figure 3.37    Display Image Options for Formatting a Cell
         











Figure 4.1    The Web Intelligence Report Panel in Design Mode
         











Figure 4.2    The Web Intelligence Report Panel in Reading Mode
         











Figure 4.3    Design Button Allows Access to Structure Only Mode
         











Figure 4.4    Application Mode Menu in the HTML Viewer
         











Figure 4.5    Formatting Toolbar in Design Mode
         











Figure 4.6    File Tab
         











Figure 4.7    Properties Tab
         











Figure 4.8    Report Element Tab
         











Figure 4.9    Format Tab
         











Figure 4.10    Data Access Tab
         











Figure 4.11    Analysis Tab
         











Figure 4.12    Page Setup Tab
         











Figure 4.13    Side Panel - Document Summary
         











Figure 4.14    Available Objects
         











Figure 4.15    Example of Three Report Tabs
         











Figure 4.16    Actions Available When Right-Clicking on the Report Tab
         











Figure 4.17    Menu to Access the Formula Bar
         











Figure 4.18    Formula Bar Expanded
         











Figure 4.19    View Modes Available in Web Intelligence
         











Figure 4.20    Status Bar
         











Figure 4.21    Status Bar Menu
         











Figure 4.22    Selecting a Table Displays Additional Tabs on the Report Element Toolbar
         











Figure 4.23    Align Types from the Position Tab under the Report Element Tab
         











Figure 4.24    Relative Position Properties for a Table
         











Figure 4.25    Formatting Toolbar
         











Figure 4.26    Applying Formatting from One Cell to Another
         











Figure 4.27    Purge Menu under the Data Access Tab
         











Figure 4.28    Expanded More Button under the Functions Tab
         











Figure 4.29    Sum Table Column
         











Figure 4.30    Adjusting Page Margins
         











Figure 5.1    Tables Available for Displaying Data
         











Figure 5.2    Default Display in the Report Panel
         











Figure 5.3    Finding the Blank Cell Report Element
         











Figure 5.4    Table Layout Subtab in the Report Element Tab











Figure 5.5    Shortcut Icons to Add Report Elements
         











Figure 5.6    Vertical Table Report Element Being Added to a Report
         











Figure 5.7    Dragging and Dropping the State Object to Add It to a Vertical Table
         











Figure 5.8    General Properties of a Vertical Table
         











Figure 5.9    Border Properties of a Vertical Table
         











Figure 5.10    Appearance Properties of a Vertical Table
         











Figure 5.11    Layout Properties of Vertical and Horizontal Tables
         











Figure 5.12    Creating a New Custom Group Based on a Dimension Object
         











Figure 5.13    Managing Custom Groups
         











Figure 5.14    Naming a New Custom Group
         











Figure 5.15    Dimension Objects with Custom Groups Listed
         











Figure 5.16    Assigning Ungrouped Values to be Automatically Grouped
         











Figure 5.17    All Values with a Group Name Assigned
         











Figure 5.18    Custom Group Values in the Data Table
         











Figure 5.19    Interacting with an Existing Custom Group
         











Figure 5.20    Disabled Freeze Icon
         











Figure 5.21    Freeze Options
         











Figure 5.22    Scrolling through a Report with Freeze Header Rows Enabled
         











Figure 5.23    Scrolling through a Report with a Frozen Column
         











Figure 5.24    Horizontal Table Populated with Four Result Objects
         











Figure 5.25    Vertical Table Populated with Four Result Objects
         











Figure 5.26    Cross Table with Two Dimension Objects and a Measure
         











Figure 5.27    Swapping the Dimensions in a Cross Table
         











Figure 5.28    Object Added to an Existing Form Table
         











Figure 5.29    Form Table Displayed with Three Result Objects
         











Figure 5.30    Right-Click Menu with a Table Selected
         











Figure 5.31    Turn Into Window for More Transformations
         











Figure 5.32    Blank Cell Element Provided in the Report Element Tab
         











Figure 5.33    Predefined Cells in the Ribbon Toolbar under the Report Element Tab
         











Figure 5.34    Inserting a Comment from Design Mode
         











Figure 6.1    Adding Common Chart Components from the Report Elements Tab
         











Figure 6.2    Column Chart Dropdown Menu
         











Figure 6.3    More Chart Categories
         











Figure 6.4    Right-Clicking on a Report Canvas and Then Hovering over Insert
         











Figure 6.5    Inserting a Report Element
         











Figure 6.6    Turn Into
         











Figure 6.7    Right-Click Menu for Charts
         











Figure 6.8    Column Chart and 3D Column Chart
         











Figure 6.9    Assigning Data to Chart Elements
         











Figure 6.10    Displaying Data in Dual Value Axes Charts
         











Figure 6.11    Stacked Column Chart and 100% Stacked Column Chart
         











Figure 6.12    Stacked Column Chart with Two Dimensions and Two Measures
         











Figure 6.13    Standard Line Chart and a Line Chart with Dual Axes
         











Figure 6.14    Combined Area Chart and Bar Chart Compared with Same Measures Both Represented as
            Area Charts
         











Figure 6.15    Pie Chart and Donut Chart
         











Figure 6.16    Pie Chart with Variable Slice Depth
         











Figure 6.17    Bar Chart
         











Figure 6.18    The Same Data Represented in a Standard Bar Chart, a Stacked Bar Chart, and a 100%
            Stacked Bar Chart
         











Figure 6.19    Scatter Chart Comparing Margin to Quantity Sold by Product Line
         











Figure 6.20    Bubble Chart Displaying the Correlation of Sales Revenue vs. Margin
         











Figure 6.21    Polar Scatter Plot with Two Measures Plotted
         











Figure 6.22    Polar Bubble Chart with Three Measures Plotted
         











Figure 6.23    A Choropleth Chart Showing Sales Revenue by US State
         











Figure 6.24    Geo Bubble Chart
         











Figure 6.25    Geo Pie Chart Showing Sales Revenue by State and Quarter
         











Figure 6.26    Box Plot
         











Figure 6.27    Radar Chart Showing Sales Revenue by Month
         











Figure 6.28    Tree Map Showing Sales Revenue by State by Quarter
         











Figure 6.29    Heat Map Showing Sales Revenue by Quarter by City
         











Figure 6.30    Tag Cloud Chart Showing Sales Revenue by City
         











Figure 6.31    Vertical (Default) Waterfall Chart and Horizontal Waterfall Chart
         











Figure 6.32    Properties for Calculate and Show the Total and Horizontal Orientation
         











Figure 6.33    Setting Custom Value Colors in a Waterfall Chart
         











Figure 6.34    Speedometer, Linear Gauge, and Angular Gauge
         











Figure 6.35    Tile and Tile with Deviation
         











Figure 6.36    Variables Assigned to the Tile with Deviation Chart
         











Figure 6.37    Values Used in Tile with Deviation Chart
         











Figure 6.38    General and Global Properties of a Column Chart
         











Figure 6.39    Basic Line Chart with and without Property Changes
         











Figure 6.40    Zone Formatting
         











Figure 6.41    Insert Custom Element Button
         











Figure 6.42    Custom Element Displayed in Charts List (Courtesy of Galigeo)
         











Figure 6.43    Custom Element Displayed in Document (Courtesy of Galigeo)
         











Figure 6.44    Custom Elements Property (Courtesy of Graphomate)
         











Figure 7.1    Palette and Style Options on the Global Category for a Column Chart
         











Figure 7.2    Multiple Dimensions Displayed in a Column Chart
         











Figure 7.3    Assigning Multiple Dimension Objects to a Column Chart
         











Figure 7.4    Scale to Page Tab
         











Figure 7.5    Toggling between the Display Formats: Page and Quick Display
         











Figure 7.6    Formatting the Number of the Value Axis Measure Object
         











Figure 7.7    Formatting the Number of a Measure Object in a Chart
         











Figure 7.8    Assigning a Region Color to a Chart
         











Figure 7.9    Column Chart with a Region Color Object Assigned
         











Figure 7.10    Stacking Options
         











Figure 7.11    Column Chart with Stacked Chart Option Selected
         











Figure 7.12    Creating a Custom Color Palette
         











Figure 7.13    Creating a New Custom Color Palette
         











Figure 7.14    Selecting Custom Colors for Your New Custom Palette
         











Figure 7.15    Custom Color Choices - Swatches
         











Figure 7.16    Custom Color Choices - HSV
         











Figure 7.17    Custom Color Choices - HSL
         











Figure 7.18    Custom Color Choices - RGB
         











Figure 7.19    Custom Color Choices - CMYK
         











Figure 8.1    Document Summary Details in the Side Panel
         











Figure 8.2    Document Summary
         











Figure 8.3    Navigation (Report) Map
         











Figure 8.4    Map View for All Input Controls
         











Figure 8.5    Input Control Based on the State Object
         











Figure 8.6    Icons Appearing When Hovering over an Input Control Title in Design Mode
         











Figure 8.7    Changing an Input Control Dependencies to Whole Document
         











Figure 8.8    Input Control Moving from the Report Section to Document-Level Section
         











Figure 8.9    Independent Quarter and Month Input Controls
         











Figure 8.10    Creating an Input Control Group
         











Figure 8.11    Choosing Input Controls to Add to a Control Group
         











Figure 8.12    Grouped Input Controls
         











Figure 8.13    Web Service Publisher
         











Figure 8.14    Defining a New WSDL Name and Description
         











Figure 8.15    Publishing Content as a Web Service
         











Figure 8.16    Arranged by Data Source Option for Arranging Available Objects
         











Figure 8.17    Document Structure and Filters
         











Figure 8.18    Locating the Data Tab from the Applet Viewer
         











Figure 8.19    Data Tab with Query Information
         











Figure 8.20    Data Provider with Data
         











Figure 8.21    Data Values in the City Object
         











Figure 8.22    Opening the Document Properties
         











Figure 8.23    Changing the Default Style of a Report
         











Figure 8.24    Importing, Exporting, and Resetting a Default Style
         











Figure 8.25    Converting a Standard Measure Object from a Number to a Decimal
         











Figure 8.26    Edit as a Geography Menu
         











Figure 8.27    Edit Geography Dialog Box
         











Figure 8.28    Select Level
         











Figure 8.29    Proposed Geographical Mapping
         











Figure 8.30    Choosing Location among More Choices
         











Figure 8.31    Explicitly Adding Latitude and Longitude
         











Figure 8.32    All Values Are Geolocalized
         











Figure 8.33    Geolocalized Dimension Displayed in Available Objects
         











Figure 8.34    Using Geolocalized New Dimension's Details
         











Figure 8.35    Selecting Latutude and Longitude
         











Figure 9.1    Identifying Predefined Filters in the Query Panel
         











Figure 9.2    Properties of the Predefined Christmas Period Filter Object
         











Figure 9.3    Predefined Filter Descriptions
         











Figure 9.4    Applying Filter as Mandatory Query
         











Figure 9.5    Viewing a Dimension Object in the Query Filters Pane
         











Figure 9.6    User-Defined Filter Assignment Types
         











Figure 9.7    Calculator Panel in the Measure Filter
         











Figure 9.8    Removing One or All Filters
         











Figure 9.9    Query Filter Using Matches Pattern and the % Wild Card
         











Figure 9.10    Custom Filter Containing the Wild Cards _ and %
         











Figure 9.11    Matches Pattern Converted to LIKE in Generated SQL
         











Figure 9.12    SQL Generated by the Matches Pattern Operator
         











Figure 9.13    Query Filters Grouped by the AND Operator
         











Figure 9.14    Nested Query Filters
         











Figure 9.15    Creating a New Nested Group with Existing Query Filters
         











Figure 9.16    Removing a Query Filter from a Nested Group
         











Figure 9.17    Locating the Prompt Properties Icon
         











Figure 9.18    Prompt Dialog Box for Configuring Prompted Filters
         











Figure 9.19    Adding Database Ranking in the Query Panel
         











Figure 9.20    Database Ranking Parameters











Figure 9.21    Inserting a Subquery into the Query Filters Pane
         











Figure 9.22    Subquery Example for City and State
         











Figure 9.23    Configuring a Parameter in the Information Design Tool
         











Figure 9.24    Change Filter Type from Constant to Prompt
         











Figure 9.25    Changing the Prompt from New Prompt to Use Universe Parameters
         











Figure 9.26    Sets Creation in Information Design Tool
         











Figure 9.27    Query Panel with BI Sets Displayed as Filters
         











Figure 9.28    Generated SQL
         











Figure 9.29    Selected Members Available for Filter Based on Temporal Set
         











Figure 9.30    Periods Selection
         











Figure 9.31    Combining Filters and Different Filters Based on BI Sets
         











Figure 9.32    Enabling the Filter Bar in Design Mode
         











Figure 9.33    Report Filter Bar with Objects Added
         











Figure 9.34    Adding a Filter to a Report Element
         











Figure 9.35    Report Filter Window and the Filter Map Pane
         











Figure 9.36    Available Objects for Creating a Report Filter
         











Figure 9.37    Assigning an Operator to a Chart Filter
         











Figure 9.38    Adding a New Input Control When Right-Clicking on a Report Element
         











Figure 9.39    Adding a New Input Control from the Toolbar
         











Figure 9.40    Adding a New Input Control from the Side Panel
         











Figure 9.41    Properties When Defining a New Input Control
         











Figure 9.42    Input Control Properties for a Dimension Object (String)
         











Figure 9.43    Entry Field, Combo Box, Radio Button, and List Box Input Controls
         











Figure 9.44    Input Control Properties for a Dimension Object (Numeric) or Measure
         











Figure 9.45    Spinner and Double Slider Input Controls
         











Figure 9.46    Input Control Properties for a Dimension Object (Date)
         











Figure 9.47    Calendar Input Control
         











Figure 9.48    Input Control Properties for a Hierarchy
         











Figure 9.49    Tree List Input Control
         











Figure 9.50    Assigning Report Element Dependencies in an Input Control
         











Figure 9.51    Input Controls Displayed While in Reading Mode
         











Figure 9.52    Editing or Removing an Input Control
         











Figure 9.53    Input Controls Groups with Non-Grouped Controls
         











Figure 9.54    Adding an Input Control Group
         











Figure 9.55    Grouping Input Controls
         











Figure 9.56    Two Input Control Groups
         











Figure 9.57    Configuring the Hide When Feature
         











Figure 9.58    Selecting Objects Used to Filter Data in Element Linking
         











Figure 9.59    Setting Control Properties of Element Link
         











Figure 9.60    Selecting Report Elements as Dependencies of an Element Link
         











Figure 9.61    Series of Report Elements with an Element Linking
         











Figure 9.62    Adding a Dynamic Value to a Chart Title
         











Figure 9.63    Dynamic Chart Title Resulting from an Element Link
         











Figure 9.64    Clearing Element Link Filters
         











Figure 10.1    Lower Profit Margin in Illinois over Previous Year
         











Figure 10.2    Drilling on a Table to Explore the Data Further
         











Figure 10.3    A Query to Analyze Profit Margin by Year and State
         











Figure 10.4    The Scope of Analysis Panel Icon
         











Figure 10.5    Query Panel Showing the Scope of Analysis Pane
         











Figure 10.6    Scope Level in the Scope of Analysis Pane
         











Figure 10.7    Setting the Scope Level to None
         











Figure 10.8    Setting the Scope Level to One
         











Figure 10.9    Setting the Scope Level to Two
         











Figure 10.10    Setting the Scope Level to Three
         











Figure 10.11    Setting a Custom Scope Level
         











Figure 10.12    Changing the Universe Outline to Display by Navigation Paths
         











Figure 10.13    Navigation Paths, or Hierarchies, in the eFashion Universe
         











Figure 10.14    Comparing the Universe Folders and Navigation Paths
         











Figure 10.15    Only Result Objects Are Displayed When Scope of Analysis Is Set
         











Figure 10.16    Available Objects Include Result Objects and Scope of Analysis Objects
         











Figure 10.17    Drill Button on Web Intelligence Toolbar (Reading Mode)
         











Figure 10.18    Drill Button on Web Intelligence Toolbar (Design Mode)
         











Figure 10.19    The Magnifying Glass Icon Signifying That the Tab Is in Drill Mode
         











Figure 10.20    The Filter Bar in Drill Mode
         











Figure 10.21    Drilling Down on the State Dimension
         











Figure 10.22    Drilling from City to Store Name
         











Figure 10.23    Drill Down from Year to Quarter
         











Figure 10.24    Drill Up from Store Name to City
         











Figure 10.25    Adding Lines and Category Dimension Objects to the Scope of Analysis
         











Figure 10.26    Drill By Product Category
         











Figure 10.27    Analyzing eFashion Chicago 33rd Store by Product Category
         











Figure 10.28    Extending the Scope of Analysis
         











Figure 10.29    Extend the Scope of Analysis
         











Figure 10.30    Analyzing by SKU Number by Extending the Scope of Analysis
         











Figure 10.31    Drill Down on Measure Object
         











Figure 10.32    Crosstable after Drill-Down on Measure Object
         











Figure 10.33    Drill Down on Chart Axis
         











Figure 10.34    Multiple Dimensions on the Category Axis of the Chart
         











Figure 10.35    Chart Legends Can Also Be Used for Drilling
         











Figure 10.36    Drill Down Using Line Chart Marker
         











Figure 10.37    Party Pants Margin for eFashion Chicago 33rd
         











Figure 10.38    Drill Snapshot
         











Figure 10.39    Taking a Snapshot Exits Drill Mode
         











Figure 10.40    Analysis Added to Drill Snapshot Using a Free-Standing Cell
         











Figure 10.41    Use Query Drill Option
         











Figure 10.42    User Settings for Drill Functionality in BI Launch Pad Preferences
         











Figure 11.1    Creating a New Variable Object from the Tab Ribbon
         











Figure 11.2    Formula of the Selected Dimension Object
         











Figure 11.3    Revised Formula in the Selected Dimension Object
         











Figure 11.4    Revising the Formula of a Selected Object in a Cross Table
         











Figure 11.5    Formula Editor in the Create Variable Window
         











Figure 11.6    Create Variable Icon to Convert the Formula into a Variable
         











Figure 11.7    Create Variable Window
         











Figure 11.8    Syntax Help with Functions
         











Figure 11.9    Adding a Custom Group
         











Figure 11.10    Grouping Values
         











Figure 11.11    Naming a Custom Group
         











Figure 11.12    Grouping All Remaining Ungrouped Values
         











Figure 11.13    Renaming or Removing a Custom Group
         











Figure 11.14    Example of Variable Syntax in a Formula
         











Figure 11.15    Right-Clicking on a Variable to Edit, Rename, or Remove
         











Figure 11.16    Adding a New Variable by Right-Clicking on the Variables Folder
         











Figure 11.17    Default Aggregation of a Single Dimension and Measure Object
         











Figure 11.18    Default Aggregation with Two Dimensions and a Measure Object
         











Figure 11.19    Using the In Operator to Aggregate Values for a Specified Dimension
         











Figure 11.20    Calculating a Total within the Block
         











Figure 11.21    Converting a Formula into a Reusable Variable
         











Figure 11.22    Giving a Name to a Formula
         











Figure 11.23    Sales Revenue Totals Divided by Sales Revenue
         











Figure 11.24    Formatting a Column to Percentage Format with Icon
         











Figure 11.25    Highest Sales Revenue for Each Quarter
         











Figure 11.26    Calculating the Maximum Sales Revenue for Each Category Quarterly and within Each
            Year
         











Figure 11.27    Using the ForAll Operator to Remove the Quarter Dimension from the Calculation
         











Figure 11.28    Assign Reference Dialog Box
         











Figure 11.29    Show Referenced Cell
         











Figure 11.30    Using References
         











Figure 12.1    Create Cascading Lists of Values in the Universe Design Tool
         











Figure 12.2    Cascading Lists of Values Window
         











Figure 12.3    Using Cascading Objects as a Prompted Filter
         











Figure 12.4    Prompt Properties
         











Figure 12.5    Hierarchy of Cascading List of Values
         











Figure 12.6    Prompted Filter of Cascading List of Values Object
         











Figure 12.7    Create Variant Dialog Box
         











Figure 12.8    Selecting a BI Variant in Prompt Dialog Box
         











Figure 12.9    Save Prompt Variant Changes Dropdown Menu
         











Figure 12.10    Multidimensional Query Panel
         











Figure 12.11    Aggregated Value Displayed for Hierarchy
         











Figure 12.12    Opening the Member Selector
         











Figure 12.13    The Member Selector
         











Figure 12.14    Right-Click Options Available within the Member Selector
         











Figure 12.15    Searching for Members in the Member Selector
         











Figure 12.16    Select Dropdown Menu
         











Figure 12.17    The Metadata Tab of the Member Selector
         











Figure 12.18    Prompt Tab of a Selected Member
         











Figure 12.19    Prompted Members When Refreshing the Query
         











Figure 12.20    Member Selector Summary
         











Figure 12.21    Hierarchy Display with Collapsed and Elapsed Rows
         











Figure 12.22    SQL Viewer with Custom SQL
         











Figure 12.23    Yellow Icon Indicating Partial Results
         











Figure 12.24    Controls Tab in the Universe Parameters











Figure 12.25    Purge Button in Data Access
         











Figure 12.26    Progress Window
         











Figure 12.27    Proposed Options for Cancelled Query
         











Figure 13.1    Selecting the SAP BEx Query
         











Figure 13.2    Query Panel for SAP BEx Direct Access
         











Figure 13.3    Member Display Mode Menu
         











Figure 13.4    Data Retrieved from SAP BEx Query
         











Figure 13.5    SAP BW Direct Access: Set Variables before Query Panel
         











Figure 13.6    Multiple-Operator Variable
         











Figure 13.7    Set Variables Icon in Query Panel Toolbar
         











Figure 13.8    SAP BW Direct Access: Set Variables from Query Panel
         











Figure 13.9    Information Design Tool Query Panel on Universe Authored on an SAP BEx Query
         











Figure 13.10    Universe (UNV) Displaying SAP BW Hierarchies in Query Panel
         











Figure 13.11    SAP HANA Direct Access: View Selection
         











Figure 13.12    Multidimensional Query Panel in SAP HANA Direct Access
         











Figure 13.13    Relational Query Panel in SAP HANA Direct Access
         











Figure 13.14    SAP HANA Direct Access: Set Variables before Query Panel
         











Figure 13.15    SAP HANA Direct Access: Set Variables from Query Panel
         











Figure 13.16    SAP HANA Direct Access: Prompts at Query Time
         











Figure 13.17    SAP HANA Online Tab
         











Figure 13.18    Web Intelligence Status Bar in SAP HANA Online Mode
         











Figure 13.19    SAP HANA View Displayed in SAP HANA Online Mode
         











Figure 13.20    Objects Arranged by Navigation Paths in SAP HANA Online Mode
         











Figure 13.21    Options in SAP HANA Online Mode
         











Figure 13.22    A Table and a Chart with Partial Result in SAP HANA Online Mode
         











Figure 13.23    Disconnect from SAP HANA Online Mode Confirmation
         











Figure 13.24    Variables and Input Parameters Set in Universe
         











Figure 14.1    Adding a Combined Query to Create a Query Union
         











Figure 14.2    Combined Query Added to the Universe Outline
         











Figure 14.3    Adding a New Query from the Query Panel
         











Figure 14.4    Adding a New Data Provider from the Report Panel
         











Figure 14.5    Adding a New Data Provider from Data Mode
         











Figure 14.6    Single Query from the eFashion Universe
         











Figure 14.7    Running Both Queries
         











Figure 14.8    Choosing How Data from the New Query Is Displayed
         











Figure 14.9    Available Objects Arranged by Alphabetical Order
         











Figure 14.10    Available Objects Arranged by Query
         











Figure 14.11    Available Objects Arranged by Data Source
         











Figure 14.12    Add a New SAP HANA Online Data Source
         











Figure 14.13    Available Objects from Two SAP HANA Online Data Sources
         











Figure 14.14    Query Tab Contextual Menu
         











Figure 14.15    Selecting a Query to Refresh from the Report Panel
         











Figure 14.16    Objects in a Table from Two Unsynchronized Queries
         











Figure 14.17    Merge Data Providers Button on Toolbar
         











Figure 14.18    Selecting Objects to Merge
         











Figure 14.19    Merged Dimension Displayed in Available Objects
         











Figure 14.20    Synchronized Data Providers
         











Figure 14.21    Merging Dimensions from the Available Objects Pane
         











Figure 14.22    Adding an Object to an Existing Merged Dimension
         











Figure 14.23    Merged Dimension Object Added
         











Figure 14.24    Merged, Geographical Dimensions
         











Figure 14.25    Impact of the Extend Merged Dimension Values Setting
         











Figure 14.26    Using ForceMerge through a Variable
         











Figure 14.27    Merged Dimension Properties
         











Figure 14.28    Unmerging a Merged Dimension
         











Figure 14.29    Removing an Object from a Merged Dimension
         











Figure 14.30    Merging Variables
         











Figure 14.31    Change Source Wizard
         











Figure 14.32    Strategy Selection
         











Figure 14.33    Suggested Mapping
         











Figure 14.34    Individual Object Mapping
         











Figure 15.1    Adding a Hyperlink While Designing a Report in the HTML Client
         











Figure 15.2    Add Document Link Commands in the HTML Client
         











Figure 15.3    Linking to a Document in the HTML Client
         











Figure 15.4    Choosing a Document to Link To
         











Figure 15.5    Configuring Properties of a New Hyperlink
         











Figure 15.6    Linking to a Target Area or Report Part
         











Figure 15.7    Creating a Hyperlink to a Prompted Web Intelligence Report
         











Figure 15.8    Select Prompts Window
         











Figure 15.9    Creating a Hyperlink Based on the State Object
         











Figure 15.10    Adding a New Hyperlink While Editing a Report
         











Figure 15.11    Adding a New Hyperlink in the Applet Viewer
         











Figure 15.12    Adding Hyperlinks Using Icon in the Ribbon
         











Figure 15.13    Dynamic Elements Menu
         











Figure 15.14    Available Objects
         











Figure 15.15    Formula Editor
         











Figure 15.16    Parsed URL Example
         











Figure 15.17    Hyperlink Parsed in the Applet Viewer
         











Figure 15.18    Document Link Command in BI Launch Pad
         











Figure 15.19    Generated URL
         











Figure 16.1    BI Launch Pad Initial View
         











Figure 16.2    Header Panel
         











Figure 16.3    Applications Menu on Header Panel
         











Figure 16.4    Documents Tab
         











Figure 16.5    Folders Drawer
         











Figure 16.6    Toolbar
         











Figure 16.7    View Menu
         











Figure 16.8    New Menu
         











Figure 16.9    Organize Menu
         











Figure 16.10    Send Menu
         











Figure 16.11    More Actions Menu
         











Figure 16.12    Details Panel
         











Figure 16.13    Pin This Tab Option
         











Figure 16.14    Preferences for Locales and Time Zone
         











Figure 16.15    Change Enterprise Password
         











Figure 16.16    Corporate Categories
         











Figure 16.17    Column Filters Option
         











Figure 16.18    Confirming the Delete Operation
         











Figure 16.19    Restoring a Document from the Recycle Bin
         











Figure 16.20    Web Intelligence Viewer Toolbar in Reading Mode
         











Figure 16.21    Additional Menu Options
         











Figure 17.1    BI Workspace on the BI Launch Pad Applications Menu
         











Figure 17.2    BI Workspaces Toolbar
         











Figure 17.3    Two-Layer Hierarchy
         











Figure 17.4    Tab Options
         











Figure 17.5    Column Layout
         











Figure 17.6    Template Layout
         











Figure 17.7    Freeform Layout
         











Figure 17.8    Template Modules in the Module Library
         











Figure 17.9    BI Launch Pad Modules in the Module Library
         











Figure 17.10    Public Modules in the Module Library
         











Figure 17.11    Private Modules in the Module Library
         











Figure 17.12    BI Workspaces in the Module Library
         











Figure 17.13    Document Explorer in the Module Library
         











Figure 17.14    BI Workspaces Preferences in the BI Launch Pad
         











Figure 17.15    BI Launch Pad Module Application
         











Figure 17.16    Text Modules and Compound Modules
         











Figure 17.17    Creating a Text Module Using HTML
         











Figure 17.18    Viewing a Text Module Using HTML
         











Figure 17.19    Web Intelligence Document with a Tag Cloud Chart
         











Figure 17.20    Editing an Existing BI Workspace
         











Figure 17.21    Adding a New Subtab
         











Figure 17.22    Naming the New Subtab
         











Figure 17.23    Choosing the Layout
         











Figure 17.24    Dragging Desired Web Intelligence Document to BI Workspaces Tab
         











Figure 17.25    Right-Clicking on the Desired Report Part
         











Figure 17.26    Editing the Report Part
         











Figure 17.27    Review Properties on Content Tab
         











Figure 17.28    Modify Properties on Layout Tab
         











Figure 17.29    Exit Edit Mode
         











Figure 17.30    Saving Changes on the BI Workspaces Toolbar
         











Figure 17.31    Saved BI Workspace
         











Figure 17.32    Setting a Custom Home Tab in BI Launch Pad General Preferences
         











Figure 17.33    Selecting Content for a Custom Home Tab
         











Figure 17.34    Workspace Selected as a Custom Home Tab
         











Figure 17.35    BI Workspace as the New Default Home Tab
         











Figure 17.36    Printing BI Workspaces
         











Figure 17.37    Printing Options
         











Figure 17.38    Creating a Source Document
         











Figure 17.39    Creating a Target Document with a Prompt
         











Figure 17.40    Creating a Second Target with a Prompt
         











Figure 17.41    A Two-Column Layout with All Three Web Intelligence Reports
         











Figure 17.42    Content Linking Pop-Up
         











Figure 17.43    A Selection in the Category Summary Updates the Category Detail and Category Chart
            (Casual Dresses)
         











Figure 17.44    A Selection in the Category Summary Updates the Category Detail and Category Chart
            (Party Pants)
         











Figure 18.1    Shortcut Command from the Organize Menu
         











Figure 18.2    Hyperlink Command from the New Menu on the BI Launch Pad Toolbar











Figure 18.3    Hyperlink Properties
         











Figure 18.4    Search Box in the Search Drawer (on the Left) and Top Right Corner
         











Figure 18.5    Quick Search
         











Figure 18.6    Search Results
         











Figure 18.7    Filter Option in Title Column
         











Figure 18.8    Filter Option in Type Column
         











Figure 18.9    Filter Option in Last Run Column
         











Figure 18.10    Discussion Thread
         











Figure 18.11    Comment Added on a Cell and Displayed When Hovering the Mouse
         











Figure 18.12    Comment Inserted in a Document
         











Figure 18.13    Discussion through Comments
         











Figure 18.14    Additional Column to Display Cell Comments
         











Figure 18.15    Sample Report with Data Tracking
         











Figure 18.16    Track Button in Design Mode
         











Figure 18.17    Data Tracking Options Dialog Box
         











Figure 18.18    Dedicated Icon for Report with Track Data Changes
         











Figure 18.19    Data Tracking Formatting Options
         











Figure 18.20    Visible Changes When Tracking Data Changes
         











Figure 19.1    Export Element to Enterprise Dialog Box
         











Figure 19.2    Shared Elements Used by the Document
         











Figure 19.3    Document Shared Elements Updated in the BI Platform Repository
         











Figure 19.4    Shared Elements Browse Pane Toolbar
         











Figure 19.5    Search Shared Elements
         











Figure 19.6    BI Inbox
         











Figure 19.7    Send to BI Inbox Settings
         











Figure 19.8    Send To Email Options
         











Figure 19.9    Send To FTP Server Options
         











Figure 19.10    Send To File System Options
         











Figure 19.11    Placeholders List
         











Figure 19.12    Save Document Dialog Box in Web Intelligence Java Applet
         











Figure 19.13    Save Document—Query Dialog Box in Web Intelligence Applet
         











Figure 19.14    Export Dialog Box in Web Intelligence HTML
         











Figure 19.15    Schedule Command from the Actions BI Launch Pad Toolbar
         











Figure 19.16    Recurrence - Once Options
         











Figure 19.17    Recurrence - Hourly Options
         











Figure 19.18    Recurrence - Daily Options
         











Figure 19.19    Recurrence - Weekly Options
         











Figure 19.20    Recurrence - Monthly Options
         











Figure 19.21    Recurrence - Nth Day of the Month Options
         











Figure 19.22    Recurrence - First Monday of the Month Options
         











Figure 19.23    Recurrence - Last Day of the Month Options
         











Figure 19.24    Recurrence - X Day of Nth Week of the Month Options
         











Figure 19.25    Recurrence - Calendar Options
         











Figure 19.26    Scheduling - Server Group Options
         











Figure 19.27    View Latest Instance Command
         











Figure 19.28    History View
         











Figure 20.1    Sample eFashion Publication
         











Figure 20.2    Select Publication from the New Shortcut Icon in BI Launch Pad
         











Figure 20.3    Publication General Properties
         











Figure 20.4    Source Documents
         











Figure 20.5    Source Document Selection
         











Figure 20.6    Source Documents
         











Figure 20.7    Enterprise Recipients
         











Figure 20.8    Personalization with a Global Profile
         











Figure 20.9    Personalization with a Local Profile
         











Figure 20.10    Web Intelligence Report Dynamic Recipient Provider
         











Figure 20.11    Choosing eFashion Dynamic Recipient List Report
         











Figure 20.12    Selecting the Data Source Name for the Document
         











Figure 20.13    Map Fields from the Source Document
         











Figure 20.14    Personalizing Dynamic Recipients with Local Profile
         











Figure 20.15    Formats
         











Figure 20.16    Destinations
         











Figure 20.17    Prompts
         











Figure 20.18    Delivery Rules
         











Figure 20.19    Recurrence
         











Figure 20.20    Events
         











Figure 20.21    Scheduling Server Group
         











Figure 20.22    Advanced Options
         











Figure 20.23    Summary Screen
         











Figure 20.24    Test Mode
         











Figure 20.25    BI Inbox in the SAP BusinessObjects Mobile BI Application (iOS Shown)
         











Figure 20.26    Web Intelligence-Based Publication Delivered to the SAP BusinessObjects Mobile BI
            Inbox (iOS Shown)
         











Figure 21.1    Web Intelligence Rich Client Interface
         











Figure 21.2    Web Intelligence View and Modify Preferences for the Rich Client
         











Figure 21.3    Initial Options When Opening Web Intelligence Rich Client
         











Figure 21.4    Offline Mode
         











Figure 21.5    Standalone Mode
         











Figure 21.6    Universe Dialog Box: Importing
         











Figure 21.7    Web Intelligence Rich Client Menu
         











Figure 21.8    Open Documents from Server Dialog Box
         











Figure 21.9    Web Intelligence Save Document Dialog Box
         











Figure 21.10    Save as Excel
         











Figure 21.11    Save as PDF
         











Figure 21.12    Publish Document Dialog Box
         











Figure 21.13    Print Icon
         











Figure 21.14    Print Dialog Box
         











Figure 21.15    Email Attachment Format Options
         











Figure 21.16    Web Intelligence Rich Client Viewing Options
         











Figure 22.1    New BI Launch Pad Login Page
         











Figure 22.2    New BI Launch Pad Home Page
         











Figure 22.3    Web Intelligence Document Contextual Menu
         











Figure 22.4    SAP Web Intelligence Interactive Viewer
         











Figure 22.5    Fading Toolbar and Zoom Slider
         











Figure 22.6    Web Intelligence Interactive Viewer Side Panel
         











Figure 22.7    Expanded and Collapsed Hierarchy Levels in a Crosstable
         











Figure 22.8    Prompts Dialog Box
         











Figure 22.9    Create Variant Screen
         











Figure 22.10    Filters Toolbar with Prompts, Document, and Report Input Control
         











Figure 22.11    Prompts Summary from Filters Bar
         











Figure 22.12    Modifying an Input Control (Slider)
         











Figure 22.13    Answering Group Input Controls
         











Figure 22.14    Drill in Filters Toolbar
         











Figure 22.15    Linked Element in Filters Toolbar
         











Figure 22.16    Sort Dialog Box
         











Figure 22.17    Sort on Crosstable
         











Figure 22.18    Sort Applied on a Column
         











Figure 22.19    Rank Dialog Box
         











Figure 22.20    Schedule Dialog Box
         











Figure 22.21    Schedule Tab
         











Figure 22.22    Web Intelligence Application Preferences
         











Figure 23.1    Live Office Ribbon from within Excel
         











Figure 23.2    Authentication to the BI Platform from SAP Live Office
         











Figure 23.3    Choosing a Universe in the Live Office Insert Wizard
         











Figure 23.4    Universe Query Panel
         











Figure 23.5    Prompt Properties
         











Figure 23.6    Specify Prompt Values
         











Figure 23.7    Summary
         











Figure 23.8    Choosing a Document in the Live Office Insert Wizard
         











Figure 23.9    Answering Contexts
         











Figure 23.10    Answering Prompts
         











Figure 23.11    Choosing Report Elements
         











Figure 23.12    Summary before Inserting Web Intelligence Content
         











Figure 23.13    Modify Object Menu
         











Figure 23.14    Set Prompt Properties
         











Figure 23.15    General Tab in Options Dialog Box
         











Figure 23.16    View Tab in Options Dialog Box
         











Figure 23.17    Enterprise Tab in Options Dialog Box
         











Figure 23.18    Refresh Options Box
         











Figure 23.19    Object Properties Dialog Box
         











Figure 23.20    Refresh Object Properties Box
         











Figure 24.1    Tables Viewed in the BI Launch Pad











Figure 24.2    Tables Viewed on SAP BusinessObjects Mobile











Figure 24.3    Three-Dimensional Pie Chart in BI Launch Pad
         











Figure 24.4    Three-Dimensional Pie Chart Viewed in SAP BusinessObjects Mobile
         











Figure 24.5    Mobile Categories in the BI Launch Pad
         











Figure 24.6    Categories in an SAP BusinessObjects Mobile Application
         











Figure 24.7    The 2 × 3 Grid Viewed in the BI Launch Pad
         











Figure 24.8    The 3 × 3 Grid Viewed in the BI Launch Pad
         











Figure 24.9    The 2 × 3 Grid in SAP BusinessObjects Mobile with the Mobile Category
         











Figure 24.10    The 2 × 3 Grid in SAP BusinessObjects Mobile with the MobileDesigned Category (Portrait
            Orientation)
         











Figure 24.11    The 2 × 3 Grid in SAP BusinessObjects Mobile with the MobileDesigned Category (Landscape
            Orientation)
         











Figure 24.12    The 3 × 3 Grid Using the Mobile Category
         











Figure 24.13    The 3 × 3 Grid Using the MobileDesigned Category (Portrait Orientation)
         











Figure 24.14    The 3 × 3 Grid Using the MobileDesigned Category (Landscape Orientation)
         











Figure 24.15    Exploration of Mobile-Only Analytic Types in the eFashion Query
         











Figure 24.16    Formula for Current Year's Revenue
         











Figure 24.17    Formula for Previous Year's Revenue
         











Figure 24.18    Formula for Lowest Annual Revenue
         











Figure 24.19    Formula for Highest Annual Revenue
         











Figure 24.20    Formula for Average Yearly Revenue
         











Figure 24.21    Formula for Revenue Percentage Growth
         











Figure 24.22    Sparkline Table Design
         











Figure 24.23    Sparkline Formula: Area











Figure 24.24    Sparkline (Area) Displayed on a Mobile Device
         











Figure 24.25    Sparkline (Line) Formula
         











Figure 24.26    Sparkline (Line) Displayed on a Mobile Device
         











Figure 24.27    Bullet Graph Table Design
         











Figure 24.28    Bullet Graph Block Name
         











Figure 24.29    Bullet Graph Displayed in SAP BusinessObjects Mobile
         











Figure 24.30    Micro Bar Chart Design











Figure 24.31    Micro Bar Chart Block Name
         











Figure 24.32    Micro Bar Chart Displayed on an SAP BusinessObjects Mobile Tablet
         











Figure 24.33    Scorecard Table Design











Figure 24.34    Scorecard with Trend Icon Block Name
         











Figure 24.35    Scorecard with Trend Icon
         











Figure 24.36    Scorecard with Arrow Block Name
         











Figure 24.37    Scorecard with Arrow Displayed on SAP BusinessObjects Mobile
         











Figure 24.38    Scorecard with Button Block Name
         











Figure 24.39    Scorecard with Button Displayed in SAP BusinessObjects Mobile
         











Figure 24.40    Report Linking: Hyperlinks in Source Report
         











Figure 24.41    Report Linking: Prompted Destination Report
         











Figure 24.42    Mobile Input Controls
         











Figure 24.43    Report Filtered Using Input Control
         











Figure 24.44    Sample Mobile Thumbnails
         











Figure 24.45    URL for Mobile Thumbnail Image in Keywords Field
         











Figure A.1    Report Conversion Tool Login Page
         











Figure A.2    Desktop Intelligence Documents Selection
         











Figure B.1    Web Intelligence Security Rights in the CMC
         



























































