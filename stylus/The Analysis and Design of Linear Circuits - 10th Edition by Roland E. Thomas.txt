


















Table of Contents


Cover


Title Page


Copyright Page


Dedication Page


Preface


CHAPTER 1 INTRODUCTION


1-1 About This Book


1-2 Symbols and Units


1-3 Circuit Variables


1-4 Computational and Simulation Software Introduction


Summary


Problems


Integrating Problems




CHAPTER 2 BASIC CIRCUIT ANALYSIS


2-1 Element Constraints


2-2 Connection Constraints


2-3 Combined Constraints


2-4 Equivalent Circuits


2-5 Voltage and Current Division


2-6 Circuit Reduction


2-7 Computer-Aided Circuit Analysis


Summary


Problems


Integrating Problems




CHAPTER 3 CIRCUIT ANALYSIS TECHNIQUES


3-1 Node-Voltage Analysis


3-2 Mesh-Current Analysis


3-3 Linearity Properties


3-4 Thévenin and Norton Equivalent Circuits


3-5 Maximum Signal Transfer


3-6 Interface Circuit Design


Summary


Problems


Integrating Problems




CHAPTER 4 ACTIVE CIRCUITS


4-1 Linear Dependent Sources


4-2 Analysis of Circuits with Dependent Sources


4-3 The Operational Amplifier


4-4 OP AMP Circuit Analysis


4-5 OP AMP Circuit Design


4-6 OP AMP Circuit Applications


Summary


Problems


Integrating Problems




CHAPTER 5 SIGNAL WAVEFORMS


5-1 Introduction


5-2 The Step Waveform


5-3 The Exponential Waveform


5-4 The Sinusoidal Waveform


5-5 Composite Waveforms


5-6 Waveform Partial Descriptors


Summary


Problems


Integrating Problems




CHAPTER 6 CAPACITANCE AND INDUCTANCE


6-1 The Capacitor


6-2 The Inductor


6-3 Dynamic OP AMP Circuits


6-4 Equivalent Capacitance and Inductance


Summary


Problems


Integrating Problems




CHAPTER 7 FIRST- AND SECOND-ORDER CIRCUITS


7-1 RC and RL Circuits


7-2 First-Order Circuit Step Response


7-3 Initial and Final Conditions


7-4 First-Order Circuit Response to Exponential and Sinusoidal Inputs


7-5 The Series RLC Circuit


7-6 The Parallel RLC Circuit


7-7 Second-Order Circuit Step Response


Summary


Problems


Integrating Problems




CHAPTER 8 SINUSOIDAL STEADY-STATE RESPONSE


8-1 Sinusoids and Phasors


8-2 Phasor Circuit Analysis


8-3 Basic Phasor Circuit Analysis and Design


8-4 Circuit Theorems with Phasors


8-5 General Circuit Analysis with Phasors


8-6 Energy and Power


Summary


Problems


Integrating Problems




CHAPTER 9 LAPLACE TRANSFORMS


9-1 Signal Waveforms and Transforms


9-2 Basic Properties and Pairs


9-3 Pole - Zero Diagrams


9-4 Inverse Laplace Transforms


9-5 Circuit Response Using Laplace Transforms


9-6 Initial and Final Value Properties


Summary


Problems


Integrating Problems





              CHAPTER 10
              s
              -DOMAIN CIRCUIT ANALYSIS
            


10-1 Transformed Circuits


10-2 Basic Circuit Analysis in the s Domain


10-3 Circuit Theorems in the s Domain


10-4 Node-Voltage Analysis in the s Domain


10-5 Mesh-Current Analysis in the s Domain


10-6 Summary of s - Domain Circuit Analysis


Summary


Problems


Integrating Problems




CHAPTER 11 NETWORK FUNCTIONS


11-1 Definition of a Network Function


11-2 Network Functions of One- and Two-Port circuits


11-3 Network Functions and Impulse Response


11-4 Network Functions and Step Response


11-5 Network Functions and Sinusoidal Steady-State Response


11-6 Impulse Response and Convolution


11-7 Network Function Design and Evaluation


Summary


Problems


Integrating Problems




CHAPTER 12 FREQUENCY RESPONSE


12-1 The Electromagnetic Spectrum and Frequency-Response Descriptors


12-2 Bode Diagram Descriptors


12-3 First-Order Low-Pass and High-Pass Responses


12-4 Bandpass and Bandstop Responses


12-5 The Frequency Response of RLC Circuits


12-6 Bode Diagrams


12-7 Frequency Response and Step Response


Summary


Problems


Integrating Problems




CHAPTER 13 FOURIER SERIES


13-1 Overview of Fourier Series


13-2 Fourier Coefficients


13-3 Waveform Symmetries


13-4 Circuit Analysis Using the Fourier Series


13-5 RMS Value and Average Power


Summary


Problems


Integrating Problems




CHAPTER 14 ACTIVE FILTER DESIGN


14-1 Active Filters


14-2 Second-Order Low-Pass and High-Pass Filters


14-3 Second-Order Bandpass and Bandstop Filters


14-4 Low-Pass Filter Design


14-5 Low-Pass Filter Evaluation


14-6 High-Pass Filter Design and Evaluation


14-7 Bandpass and Bandstop Filter Design


Summary


Problems


Integrating Problems




CHAPTER 15 MUTUAL INDUCTANCE AND TRANSFORMERS


15-1 Coupled Inductors


15-2 The Dot Convention


15-3 Energy Analysis


15-4 The Ideal Transformer


15-5 Linear Transformers


Summary


Problems


Integrating Problems




CHAPTER 16 AC POWER SYSTEMS


16-1 Average and Reactive Power


16-2 Complex Power


16-3 Single-Phase Circuit Analysis


16-4 Single-Phase Power Flow


16-5 Balanced Three-Phase Circuits


16-6 Three-Phase Circuit Analysis


16-7 Three-Phase Power Flow


Summary


Problems


Integrating Problems




CHAPTER 17 TWO-PORT NETWORKS


17-1 Introduction


17-2 Impedance Parameters


17-3 Admittance Parameters


17-4 Hybrid Parameters


17-5 Transmission Parameters1


17-6 Two-Port Conversions and Connections


Summary


Problems


Integrating Problems




CHAPTER 18 FOURIER TRANSFORMS


18-1 Introduction to Fourier Transforms


18-2 Circuit Analysis Using Fourier Transforms


18-3 Impulse Response and Convolution


18-4 Parseval's Theorem


Summary


Problems


Integrating Problems




Appendix A: SOLUTION OF LINEAR EQUATIONS


Appendix B: BUTTERWORTH AND CHEBYSHEV POLES


Appendix C: BEHAVIORALLY MOTIVATED LEARNING


Appendix D: COMPUTATIONAL TOOLS


Appendix F: COMPLEX NUMBERS


Appendix G: STANDARD VALUES AND REFERENCES


Appendix H: ANSWERS TO SELECTED PROBLEMS


Index


End User License Agreement




List of Illustrations



Chapter 1



Figure 1-1


Figure 1-2


Figure 1-3 Voltage and current reference marks for a two-terminal device.


Figure 1-4 Ground symbol indicates a common voltage reference point.


Figure 1-5


Figure P1-7


Figure P1-10


Figure P1-14


Figure P1-15


Figure P1-16


Figure P1-21





Chapter 2



Figure 2-1 Voltage and current reference marks for a two-terminal device.


Figure 2-2 The resistor: (a) Circuit symbol. (b) i-v characteristics. (c) Carbon or film resistors. (d) Wire-wound resistors.


 
                  Figure 2-3 Circuit symbols: (a) Open-circuit symbol. 
                   
                  (b) Short-circuit symbol.   
                


Figure 2-4


Figure 2-5 The circuit symbol and i-v characteristics of an ideal switch: (a) Switch OFF. (b) Switch ON. (c) Toggle switch. (d) DIP switches. (e) Rocker switch. (f) SPDT switch. (g) DPDT switch.


Figure 2-6 The analog switch: (a) Normally open model. (b) Normally closed model. (c) Double throw model. (d) Model with finite OFF resistance. (e) Model with finite ON resistance.


Figure 2-7 Circuit symbols and i-v characteristic of an ideal independent voltage source (a) Time-varying. (b) Constant (Battery). (c) Constant voltage source i-v characteristics. (d) Time-varying or constant source. (e) Constant current source i-v characteristics.


Figure 2-8


Figure 2-9 Circuit symbols for ideal and practical independent sources: (a) Ideal voltage source. (b) Practical voltage source. (c) Ideal current source. (d) Practical current source.


Figure 2-10  Symbols used in circuit diagrams: (a) Electrical connection. (b) Crossover with no connection. (c) Jack connection. (d) Control line. (e) Power supply connection.


Figure 2-11 Circuit for demonstrating Kirchhoff's current law.


Figure 2-12


Figure 2-13 Circuit for demonstrating Kirchhoff's voltage law.


Figure 2-14


Figure 2-15


Figure 2-16 A parallel connection.


Figure 2-17 A series connection.


Figure 2-18


Figure 2-19


Figure 2-20 (a) Circuit used to demonstrate combined constraints.


Figure 2-20 (b) Revised circuit used to demonstrate combined constraints.


Figure 2-21 Circuit used to demonstrate combined constraints.


Figure 2-22


Figure 2-23


Figure 2-24


Figure 2-25


Figure 2-26 A series resistance circuit: (a) Original circuit. (b) Equivalent circuit.


Figure 2-27 A parallel resistance circuit: (a) Original circuit with resistors replaced by their conductance equivalent. (b) Equivalent conductance circuit. (c) Original circuit with resistors. (d) Equivalent resistance circuit.


Figure 2-28


Figure 2-29


Figure 2-30


Figure 2-31


Figure 2-32 Practical source models that are equivalent when Eq. (2-24) is satisfied.


Figure 2-33 The i-v characteristics of practical sources in Figure 2-32.


Figure 2-34


Figure 2-35 Equivalent circuit of a voltage source and a resistor in parallel.


Figure 2-36 Equivalent circuit of a current source and a resistor in series.


Figure 2-37 Summary of two-terminal equivalent circuits.


Figure 2-38 A voltage divider circuit.


Figure 2-39


Figure 2-40


Figure 2-41


Figure 2-42 The potentiometer: (a) circuit symbol. (b) Single-turn potentiometer. (c) Multiple-turn potentiometer. (d) Trim pots. (e) Typical application.


Figure 2-43


Figure 2-44


Figure 2-45 A current divider circuit.


Figure 2-46 Two-path current divider circuit.


Figure 2-47


Figure 2-48


Figure 2-49


Figure 2-50


Figure 2-51


Figure 2-52 A ladder circuit.


Figure 2-53


Figure 2-54


Figure 2-55


Figure 2-56


Figure 2-57


Figure 2-58


Figure 2-59


Figure 2-60 Flow diagram for circuit simulation programs.


Figure 2-61


Figure 2-62


Figure 2-63


Figure 2-64


Figure P2-5


Figure P2-6


Figure P2-9


Figure P2-11


Figure P2-12


Figure P2-13


Figure P2-14


Figure P2-16


Figure P2-17


Figure P2-18


Figure P2-21


Figure P2-22


Figure P2-23


Figure P2-24


Figure P2-25


Figure P2-26


Figure P2-27


Figure P2-28


Figure P2-29


Figure P2-30


Figure P2-31


Figure P2-32


Figure P2-33


Figure P2-34


Figure P2-36


Figure P2-37


Figure P2-38


Figure P2-39


Figure P2-40


Figure P2-41


Figure P2-42


Figure P2-43


Figure P2-44


Figure P2-45


Figure P2-46


Figure P2-47


Figure P2-48


Figure P2-49


Figure P2-50


Figure P2-51


Figure P2-52


Figure P2-53


Figure P2-2


Figure P2-55


Figure P2-56


Figure P2-57


Figure P2-58


Figure P2-63


Figure P2-64


Figure P2-65


Figure P2-66


Figure P2-67


Figure P2-68


Figure P2-69


Figure P2-70


Figure P2-73





Chapter 3



Figure 3-1 Node-voltage definition and notation.


Figure 3-2 Two possible connections of a two-terminal element.


Figure 3-3


Figure 3-4


Figure 3-5 Circuit for demonstrating node-voltage analysis.


Figure 3-6


Figure 3-7


Figure 3-8 Circuit for demonstrating how to write node-voltage equations by inspection.


Figure 3-9


Figure 3-10


Figure 3-11


Figure 3-12


Figure 3-13 Three methods of treating voltage sources in node analysis.


Figure 3-14


Figure 3-15


Figure 3-16


Figure 3-17


Figure 3-18


Figure 3-19 (a) Meshes in a planar circuit. (b) Relationship between mesh and element currents.


Figure 3-20


Figure 3-21 Circuit for demonstrating mesh-current analysis.


Figure 3-22


Figure 3-23 Example of a supermesh.


Figure 3-24


Figure 3-25


Figure 3-26


Figure 3-27


Figure 3-28 Block diagram representation of the proportionality property.


Figure 3-29 Examples of circuit exhibiting proportionality: (a) Voltage divider. (b) Block diagram for (a). (c) Current divider. (d) Block diagram for (c).


Figure 3-30


Figure 3-31


Figure 3-32


Figure 3-33 Block diagram representation of the additivity property.


Figure 3-34 (a) Circuit used to demonstrate superposition. (b) Block diagram.


Figure 3-35 Turning off an independent source: (a) Voltage source. (b) Current source.


Figure 3-36 Circuit analysis using superposition: (a) Original circuit. (b) Current source off. (c) Voltage source off.


Figure 3-37


Figure 3-38


Figure 3-39


Figure 3-40


Figure 3-41 A two-terminal interface.


Figure 3-42 Equivalent circuits for the source:


Figure 3-43 Loads used to find Thévenin and Norton equivalent circuits: (a) Open circuit yields the Thévenin voltage. (b) Short circuit yields the Norton current. (c) Measuring vOC and iSC using a DMM.


Figure 3-44 Example of finding the Thévenin and Norton equivalent circuits: (a) The given circuit. (b) Open circuit yields the Thévenin voltage. (c) Short circuit yields the Norton current. (d) Thévenin equivalent circuit. (e) Norton equivalent circuit.


Figure 3-45


Figure 3-46


Figure 3-47


Figure 3-48


Figure 3-49


Figure 3-50


Figure 3-51 Using superposition to prove Thévenin's theorem.


Figure 3-52


Figure 3-53


Figure 3-54


Figure 3-55 Graphical analysis of a nonlinear circuit: (a) Given circuit. (b) Load line. (c) Nonlinear device's i-v characteristics. (d) Q-point.


Figure 3-56


Figure 3-57 Two-terminal interface for deriving the maximum signal transfer conditions.


Figure 3-58 Normalized plots of current, voltage, and power versus RL/RT.


Figure 3-59 A general interface circuit and a few examples: (a) Simple pass-through (often omitted), (b) series resistor, (c) parallel resistor, (d) L-pad left, (e) L-pad right.


Figure 3-60 L-pad for matching amplifier output to speakers.


Figure 3-61


Figure 3-62


Figure 3-63


Figure 3-64


Figure 3-65


Figure 3-66


Figure 3-67


Figure 3-68 300 Ω to 75 Q adapter.


Figure 3-69


Figure 3-70 Switchable in-line attenuator.


Figure 3-71


Figure 3-72


Figure P3-1


Figure P3-2


Figure P3-3


Figure P3-4


Figure P3-6


Figure P3-7


Figure P3-8


Figure P3-9


Figure P3-10


Figure P3-11


Figure P3-13


Figure P3-14


Figure P3-15


Figure P3-16


Figure P3-17


Figure P3-18


Figure P3-19


Figure P3-20


Figure P3-21


Figure P3-22


Figure P3-26


Figure P3-27


Figure P3-28


Figure P3-29


Figure P3-30


Figure P3-31


Figure P3-32


Figure P3-33


Figure P3-34


Figure P3-35


Figure P3-37


Figure P3-39


Figure P3-40


Figure P3-41


Figure P3-42


Figure P3-43


Figure P3-45


Figure P3-46


Figure P3-47


Figure P3-48


Figure P3-50


Figure P3-51


Figure P3-52


Figure P3-53


Figure P3-54


Figure P3-56


Figure P3-57


Figure P3-58


Figure P3-59


Figure P3-60


Figure P3-61


Figure P3-63


Figure P3-64


Figure P3-65


Figure P3-66


Figure P3-67


Figure P3-68


Figure P3-69


Figure P3-70


Figure P3-71


Figure P3-73


Figure P3-74


Figure P3-76


Figure P3-78


Figure P3-79


Figure P3-80


Figure P3-81


Figure P3-82


Figure P3-83





Chapter 4



Figure 4-1 Dependent source circuit symbols: (a) Block diagram of a gain stage. (b) Current-controlled voltage source. (c) Voltage-controlled voltage source. (d) Current-controlled current source. (e) Voltage-controlled current source.


Figure 4-2 Turning off the independent source affects the dependent source.


Figure 4-3 (a) A circuit with a dependent source. (b) Equivalent block diagram.


Figure 4-4


Figure 4-5


Figure 4-6 (a) Circuit used to demonstrate effects of feedback.


Figure 4-7


Figure 4-8


Figure 4-9


Figure 4-10


Figure 4-11


Figure 4-12


Figure 4-13


Figure 4-14


Figure 4-15


Figure 4-16


Figure 4-17


Figure 4-18


Figure 4-19


Figure 4-20


Figure 4-21 (a) Circuitsymbol for the BJT. (b) TIP 31C Power transistor. (c) 2N3055 High-voltage power transistor. (d) 2N3904 Small-signal transistor.


Figure 4-22 Circuit models for BJT operating modes: (a) Active mode. (b) Cutoff mode. (c) Saturation mode.


Figure 4-23 BJT common-emitter circuit.


Figure 4-24 Output responses of the BJT circuit in Figure 4-23. The trace labeled υCE is the υCE output, while the trace labeled iC is the collector current, iC. This is called the circuit's transfer characteristics.


Figure 4-25


Figure 4-26


Figure 4-27 Examples of OP AMP types and packaging: (a) Dual-in-line (DIP) 8-pin UA741 general-purpose OP AMP. (b) 14-pin (DIP) LF444QML quadruple low-power JFET OP AMP. (c) Discrete-component high-performance audio amplifier John Hardy 990+. (d) Surface mount LM224K quadruple general-purpose OP AMP. (e) 8-pin TO-3 package allowing for direct contact with heat sink for dual high-power OPA2541 OP AMP. (f) Military grade TO-99 package LM741 high-reliability OP AMP.


Figure 4-28 The OP AMP: (a) Circuit symbol. (b) Pin-out diagram for an eight-pin DIP package.


Figure 4-29 OP AMP voltage and current definitions:


Figure 4-30 (a) OP AMP transfer characteristics.


Figure 4-30 (b) Dependent-source model of an OP AMP operating in the linear mode.


Figure 4-31 Ideal OP AMP characteristics.


Figure 4-32 The noninverting amplifier circuit.


Figure 4-33


Figure 4-34 The noninverting amplifier circuit with the dependent-source model.


Figure 4-35


Figure 4-36 (a) Source-load interface with a voltage follower. (b) Interface without the voltage follower.


Figure 4-37


Figure 4-38


Figure 4-39 The inverting amplifier circuit.


Figure 4-40


Figure 4-41


Figure 4-42


Figure 4-43 The inverting summer.


Figure 4-44


Figure 4-45


Figure 4-46 The differential amplifier.


Figure 4-47


Figure 4-48 Summary of basic OP AMP signal-processing circuits.


Figure 4-49 (a) Circuit. (b) Block diagram.


Figure 4-50


Figure 4-51


Figure 4-52 General OP AMP circuit analysis.


Figure 4-53


Figure 4-54


Figure 4-55


Figure 4-56


Figure 4-57


Figure 4-58


Figure 4-59


Figure 4-60 (a) A 4-bit digital-to-analog converter (DAC). (b) 8-bit digital-to-analog converter. (c) 32-bit digital-to-analog converter. (d) 16-bit digital-to-analog converter development board.


Figure 4-61 A binary-weighted summer DAC.


Figure 4-62 AnR-2R ladder DAC.


Figure 4-63 Transducer interface circuit.


Figure 4-64 Block diagram of typical instrumentation system.


Figure 4-65 Photodiode transducer characteristics.


Figure 4-66 Photodiode interface circuit realization: (a) Block diagram. (b) Circuit realization.


Figure 4-67


Figure 4-68


Figure 4-69


Figure 4-70 Passive transducers: (a) Photoresistors.9 (b) Strain gauges.


Figure 4-71 Methods for adding an external voltage to passive transducers: (a) voltage divider. (b) Wheatstone bridge circuit.


Figure 4-72


Figure 4-73


Figure 4-74


Figure 4-75


Figure 4-76


Figure 4-77


Figure 4-78


Figure 4-79


Figure 4-80 (a) An OP AMP comparator. (b) An image of a TI LM111 Comparator. (c) Multisim circuit symbol for a comparator.


Figure 4-81


Figure 4-82


Figure 4-83 Zero-crossing detector: (a) Circuit. (b) Signals.


Figure 4-84 Modified zero-crossing detector: (a) Circuit. (b) Signals. (c) Multisim circuit. (d) Input/output waveforms.


Figure 4-85 An analog-to-digital converter (ADC).


Figure 4-86 (a) Flash ADC diagram. (b) Eight-bit flash ADC IC.


Figure 4-87


Figure 4-88


Figure P4-1


Figure P4-2


Figure P4-3


Figure P4-4


Figure P4-5


Figure P4-6


Figure P4-7


Figure P4-8


Figure P4-9


Figure P4-10


Figure P4-11


Figure P4-12


Figure P4-13


Figure P4-14


Figure P4-15


Figure P4-17


Figure P4-18


Figure P4-19


Figure P4-21


Figure P4-23


Figure P4-27


Figure P4-28


Figure P4-31


Figure P4-32


Figure P4-33


Figure P4-34


Figure P4-35


Figure P4-36


Figure P4-37


Figure P4-38


Figure P4-39


Figure P4-40


Figure P4-41


Figure P4-42


Figure P4-43


Figure P4-44


Figure P4-45


Figure P4-46


Figure P4-51


Figure P4-55


Figure P4-57


Figure P4-58


Figure P4-60


Figure P4-62


Figure P4-63


Figure P4-67


Figure P4-68


Figure P4-69


Figure P4-70


Figure P4-71


Figure P4-72


Figure P4-76


Figure P4-77


Figure P4-79


Figure P4-80


Figure P4-81





Chapter 5



Figure 5-1 A constant or dc waveform.


Figure 5-2 Some example waveforms.


Figure 5-3 (a) Approximation to a step function. (b) Typical representation.


Figure 5-4 Effect of time shifting on the step function waveform.


Figure 5-5


Figure 5-6


Figure 5-7 Rectangular pulse waveforms and the impulse.


Figure 5-8


Figure 5-9


Figure 5-10 (a) Unit ramp waveform. (b) General ramp waveform.


Figure 5-11


Figure 5-12


Figure 5-13


Figure 5-14 The exponential waveform.


Figure 5-15 (a) Construct of a decaying exponential waveform. (b) Typical representation. (c) Composite waveforms showing final result.


Figure 5-16


Figure 5-17


Figure 5-18 (a) Effect of different time constants on the exponential waveform. (b) Effect oftime shifting on the exponential waveform.


Figure 5-19


Figure 5-20


Figure 5-21


Figure 5-22 The eternal sinusoid.


Figure 5-23 Effect of time shifting on the sinusoidal waveform.


Figure 5-24


Figure 5-25


Figure 5-26


Figure 5-27 The signum waveform.


Figure 5-28 The exponential rise waveform.


Figure 5-29


Figure 5-30


Figure 5-31 The damped ramp waveform.


Figure 5-32 The damped sine waveform.


Figure 5-33


Figure 5-34


Figure 5-35 The double exponential waveform.


Figure 5-36


Figure 5-37


Figure 5-38


Figure 5-39 Maximum value (VMAX), minimum value (VMIN), peak value (VP), and peak-to-peak value (VPP).


Figure 5-40


Figure 5-41


Figure 5-42


Figure 5-43


Figure 5-44


Figure 5-45


Figure P5-2


Figure P5-6


Figure P5-7


Figure P5-10


Figure P5-12


Figure P5-13


Figure P5-14


Figure P5-17


Figure P5-18


Figure P5-23


Figure P5-24


Figure P5-25


Figure P5-26


Figure P5-27


Figure P5-28


Figure P5-29


Figure P5-30


Figure P5-31


Figure P5-32


Figure P5-35


Figure P5-36


Figure P5-37


Figure P5-39


Figure P5-42


Figure P5-44


Figure P5-46


Figure P5-49


Figure P5-50





Chapter 6



Figure 6-1 The capacitor: (a) Parallel plate device. (b) Circuit symbols.


Figure 6-2 Photos of real capacitors: (a) Electrolytics. (b) Oil-filled high-voltage. (c) Ultracapacitors. (d) Surface mount. (e) Trimmer capacitors. (f) Film capacitors. (g) Air-tunable. (h) Ceramic.


Figure 6-3 (a) Graphical representations of the linear relationships evident in a capacitor: υC(t) vs q(t) or dυC(t)/dt vs iC(t). (b) Circuit symbol showing capacitor voltage and current.


Figure 6-4


Figure 6-5


Figure 6-6


Figure 6-7


Figure 6-8


Figure 6-9 (a) Magnetic flux surrounding a current-carrying coil. (b) Circuit symbol showing inductor current and voltage.


Figure 6-10 Photos of real inductors: (a) Air core. (b) Toroidal. (c) Choke. (d) Surface mount. (e) High-current radial power. (f) Bobbin-wound choke. (g) Color-coded axial.


Figure 6-11 Graphical representations of the linear relationships evident in an inductor: iL(t) vs λ(t) or diL(t)/dt vs υL(t).


Figure 6-12


Figure 6-13


Figure 6-14


Figure 6-15


Figure 6-16


Figure 6-17 The inverting OP AMP integrator.


Figure 6-18 Summary of basic OP AMP signal-processing circuits, can also be found in Appendix G.


Figure 6-19


Figure 6-20


Figure 6-21


Figure 6-22


Figure 6-23


Figure 6-24


Figure 6-25


Figure 6-26 Capacitors connected in parallel. (a) Given circuit. (b) Equivalent circuit.


Figure 6-27 Capacitors connected in series. (a) Given circuit. (b) Equivalent circuit.


Figure 6-28


Figure 6-29


Figure 6-30


Figure 6-31


Figure 6-32


Figure P6-4


Figure P6-5


Figure P6-13


Figure P6-14


Figure P6-15


Figure P6-16


Figure P6-19


Figure P6-20


Figure P6-22


Figure P6-23


Figure P6-26


Figure P6-28


Figure P6-30


Figure P6-31


Figure P6-32


Figure P6-34


Figure P6-37


Figure P6-38


Figure P6-40


Figure P6-42


Figure P6-43


Figure P6-44


Figure P6-46


Figure P6-47


Figure P6-48


Figure P6-49


Figure P6-50


Figure P6-51


Figure P6-54


Figure P6-55


Figure P6-56


Figure P6-58





Chapter 7



Figure 7-1 Flow diagram for dynamic circuit analysis.


Figure 7-2 First-order circuits: (a) RC series circuit. (b) RL parallel circuit.


Figure 7-3 First-order zero-input responses. (a) RC circuit. (b) RL circuit.


Figure 7-4


Figure 7-5


Figure 7-6


Figure 7-7


Figure 7-8


Figure 7-9


Figure 7-10 First-order OP AMP RC circuit.


Figure 7-11


Figure 7-12


Figure 7-13 (a) RC circuit driven by a step input. (b) RC circuit driven by a step input.


Figure 7-14 Step response of a typical first-order circuit.


Figure 7-15


Figure 7-16


Figure 7-17


Figure 7-18


Figure 7-19


Figure 7-20 Solving a switched dynamic circuit using the initial and final conditions.


Figure 7-21 Two responses in the RC circuit of Figure 7-20.


Figure 7-22


Figure 7-23


Figure 7-24


Figure 7-25


Figure 7-26


Figure 7-27


Figure 7-28


Figure 7-29


Figure 7-30


Figure 7-31


Figure 7-32


Figure 7-33


Figure 7-34


Figure 7-35


Figure 7-36 The series RLC circuit.


Figure 7-37


Figure 7-38 The parallel RLC circuit.


Figure 7-39


Figure 7-40


Figure 7-41


Figure 7-42


Figure 7-43


Figure 7-44


Figure 7-45


Figure 7-46


Figure 7-47


Figure P7-3


Figure P7-4


Figure P7-5


Figure P7-6


Figure P7-7


Figure P7-8


Figure P7-9


Figure P7-10


Figure P7-11


Figure P7-12


Figure P7-13


Figure P7-16


Figure P7-19


Figure P7-20


Figure P7-21


Figure P7-22


Figure P7-23


Figure P7-24


Figure P7-25


Figure P7-26


Figure P7-29


Figure P7-30


Figure P7-35


Figure P7-40


Figure P7-41


Figure P7-42


Figure P7-43


Figure P7-45


Figure P7-46


Figure P7-47


Figure P7-48


Figure P7-49


Figure P7-50


Figure P7-51


Figure P7-52


Figure P7-55


Figure P7-59


Figure P7-60


Figure P7-61


Figure P7-62


Figure P7-64


Figure P7-65


Figure P7-66


Figure P7-68


Figure P7-69


Figure P7-70


Figure P7-71


Figure P7-72


Figure P7-73


Figure P7-74





Chapter 8



Figure 8-1 Phasor diagram.


Figure 8-2 Complex exponential Vejωt.


Figure 8-3


Figure 8-4


Figure 8-5


Figure 8-6


Figure 8-7 Phasor i-υ characteristics of the resistor.


Figure 8-8 Phasor i-υ characteristics ofthe inductor.


Figure 8-9 Phasor i-υ characteristics of the capacitor.


Figure 8-10 Magnitude of the impedance of passive circuit elements versus frequency. Basic concept of resonance ω0 occurs when |ZL| = |ZC|.


Figure 8-11


Figure 8-12


Figure 8-13 Flow diagram for phasor circuit analysis.


Figure 8-14 A series connection of impedances.


Figure 8-15


Figure 8-16


Figure 8-17


Figure 8-18 Impedance bridge.


Figure 8-19 Maxwell bridge.


Figure 8-20 Parallel connection of impedances.


Figure 8-21


Figure 8-22


Figure 8-23


Figure 8-24


Figure 8-25


Figure 8-26


Figure 8-27


Figure 8-28


Figure 8-29


Figure 8-30


Figure 8-31


Figure 8-32


Figure 8-33


Figure 8-34


Figure 8-35


Figure 8-36


Figure 8-37


Figure 8-38


Figure 8-39


Figure 8-40 Thévenin and Norton equivalent circuits in the phasor analysis.


Figure 8-41


Figure 8-42


Figure 8-43


Figure 8-44


Figure 8-45


Figure 8-46


Figure 8-47 An example node.


Figure 8-48 An example mesh.


Figure 8-49


Figure 8-50


Figure 8-51


Figure 8-52


Figure 8-53


Figure 8-54


Figure 8-55


Figure 8-56


Figure 8-57


Figure 8-58


Figure 8-59


Figure 8-60


Figure 8-61


Figure 8-62


Figure 8-63


Figure 8-64 Resistor power and energy in the sinusoidal steady state.


Figure 8-65 Inductor power and energy in the sinusoidal steady state.


Figure 8-66 Capacitor power and energy in the sinusoidal steady state.


Figure 8-67


Figure 8-68


Figure 8-69 A source-load interface in the sinusoidal steady state.


Figure 8-70


Figure 8-71


Figure P8-4


Figure P8-11


Figure P8-13


Figure P8-14


Figure P8-16


Figure P8-17


Figure P8-18


Figure P8-19


Figure P8-20


Figure P8-22


Figure P8-25


Figure P8-26


Figure P8-29


Figure P8-31


Figure P8-32


Figure P8-33


Figure P8-34


Figure P8-35


Figure P8-36


Figure P8-38


Figure P8-39


Figure P8-40


Figure P8-41


Figure P8-43


Figure P8-44


Figure P8-45


Figure P8-46


Figure P8-49


Figure P8-50


Figure P8-51


Figure P8-52


Figure P8-53


Figure P8-54


Figure P8-55


Figure P8-56


Figure P8-57


Figure P8-58


Figure P8-59


Figure P8-60


Figure P8-61


Figure P8-62


Figure P8-63


Figure P8-64


Figure P8-65


Figure P8-67


Figure P8-69


Figure P8-70


Figure P8-71


Figure P8-72


Figure P8-73


Figure P8-74


Figure P8-75


Figure P8-76


Figure P8-77





Chapter 9



Figure 9-1 Flow diagram of dynamic circuit analysis with Laplace transforms.


Figure 9-2 (a-c) Pole-zero diagrams in the s plane.


Figure 9-3


Figure 9-4


Figure 9-5


Figure 9-6


Figure 9-7


Figure 9-8


Figure 9-9


Figure 9-10 First-order RC circuit.


Figure 9-11


Figure 9-12


Figure 9-13


Figure 9-14


Figure 9-15


Figure P9-17


Figure P9-32


Figure P9-33


Figure P9-34


Figure P9-37


Figure P9-38


Figure P9-41


Figure P9-43


Figure P9-45


Figure P9-47


Figure P9-56


Figure P9-57





Chapter 10



Figure 10-1 Flow diagram for s-domain circuit analysis.


Figure 10-2 s-Domain models of independent sources.


Figure 10-3 s-Domain models of dependent sources and OP AMPs.


Figure 10-4 s-Domain models of passive elements using voltage sources for initial conditions.


Figure 10-5 s-Domain models of passive elements using current sources for initial conditions.


Figure 10-6


Figure 10-7


Figure 10-8


Figure 10-9


Figure 10-10 Series equivalence in the s domain.


Figure 10-12


Figure 10-13


Figure 10-14


Figure 10-15


Figure 10-16


Figure 10-17


Figure 10-18


Figure 10-19


Figure 10-20 Using superposition to find the zero-state and zero-input responses.


Figure 10-21


Figure 10-22


Figure 10-23


Figure 10-24


Figure 10-25


Figure 10-26 Thévenin and Norton equivalent circuits in the s domain.


Figure 10-27


Figure 10-28


Figure 10-29


Figure 10-30


Figure 10-31 An example node.


Figure 10-32


Figure 10-33


Figure 10-34 s-plane geometry relating α and β to ζ and ω0


Figure 10-35


Figure 10-36


Figure 10-37


Figure 10-38


Figure 10-39


Figure 10-40 An example mesh.


Figure 10-41


Figure 10-42


Figure 10-43


Figure 10-44


Figure 10-45 Form of the natural response corresponding to different pole locations.


Figure 10-46 Summary of Chapter 10 examples.


Figure 10-47 Pole loci on a circle of radius ω0.


Figure P10-2


Figure P10-3


Figure P10-4


Figure P10-5


Figure P10-6


Figure P10-7


Figure P10-8


Figure P10-9


Figure P10-10


Figure P10-11


Figure P10-12


Figure P10-13


Figure P10-14


Figure P10-15


Figure P10-16


Figure P10-18


Figure P10-20


Figure P10-21


Figure P10-22


Figure P10-24


Figure P10-25


Figure P10-26


Figure P10-27


Figure P10-28


Figure P10-29


Figure P10-31


Figure P10-32


Figure P10-34


Figure P10-35


Figure P10-36


Figure P10-37


Figure P10-39


Figure P10-40


Figure P10-41


Figure P10-43


Figure P10-45


Figure P10-46


Figure P10-47


Figure P10-48


Figure P10-49


Figure P10-50


Figure P10-51


Figure P10-53


Figure P10-54


Figure P10-55


Figure P10-56


Figure P10-57


Figure P10-59


Figure P10-61


Figure P10-62


Figure P10-63


Figure P10-64


Figure P10-65


Figure P10-66


Figure P10-67





Chapter 11



Figure 11-1 Block diagram for an s-domain input-output relationship.


Figure 11-2


Figure 11-3 A one-port circuit.


Figure 11-4 Two-port circuits and transfer functions.


Figure 11-5 Basic divider circuits. (a) Voltage divider. (b) Current divider.


Figure 11-6 Basic OP AMP circuits. (a) Inverting amplifier. (b) Noninverting amplifier.


Figure 11-7


Figure 11-8


Figure 11-9


Figure 11-10


Figure 11-11


Figure 11-12


Figure 11-13


Figure 11-14


Figure 11-15 Two-port circuits connected in cascade.


Figure 11-16 Cascade connection with voltage follower isolation.


Figure 11-17


Figure 11-18


Figure 11-19 Block diagram of impulse response: (a) In the t domain. (b) In the s domain.


Figure 11-20


Figure 11-21


Figure 11-22 Relationships between step and impulse responses, and the transfer function in the t and s domains.


Figure 11-23


Figure 11-24


Figure 11-25 Step response showing rise time (TR), delay time (TD), and overshoot.


Figure 11-26 Block diagram of sinusoidal steady-state response showing how the transfer function of the linear circuit T(s) affects the input sinusoidal signal to produce the output sinusoid.


Figure 11-27


Figure 11-28


Figure 11-29 Input-output relationships in the t domain and the s domain.


Figure 11-30 Graphical interpretation of convolution.


Figure 11-31


Figure 11-32 Cascade connection transfer functions.


Figure 11-33 (a and b) Circuit realizations of T(s) = K/(s + α) for K ≤ α.


Figure 11-34 Circuit realizations of T(s) = Ks/ (s + α) for K ≤ 1.


Figure 11-35 Circuit realization of TV(s) = K/(s + α for K > α.


Figure 11-36


Figure 11-37


Figure 11-38 Inverting OP AMP circuit realizations of T(s) = - K(s + γ)/(s + α).


Figure 11-39


Figure 11-40


Figure 11-41


Figure 11-42


Figure 11-43 Second-order circuit realizations.


Figure 2-44


Figure 11-45


Figure 11-46


Figure 11-47


Figure 11-48


Figure 11-49


Figure 11-50


Figure 11-51 Clock distribution network.


Figure 11-52 Two-stage RC circuit model.


Figure 11-53 Step responses showing clock skew.


Figure P11-1


Figure P11-2


Figure P11-3


Figure P11-4


Figure P11-5


Figure P11-6


Figure P11-7


Figure P11-8


Figure P11-9


Figure P11-10


Figure P11-11


Figure P11-12


Figure P11-13


Figure P11-14


Figure P11-15


Figure P11-16


Figure P11-18


Figure P11-21


Figure P11-28


Figure P11-29


Figure P11-30


Figure P11-31


Figure P11-32


Figure P11-36


Figure P11-52


Figure P11-59


Figure P11-60


Figure P11-64


Figure P11-65


Figure P11-68


Figure P11-69


Figure P11-70


Figure P11-71


Figure P11-73


Figure P11-74


Figure P11-75





Chapter 13



Figure 13-1 Examples of periodic waveforms.


Figure 13-2


Figure 13-3


Figure 13-4 Fourier coefficients for some periodic waveforms.


Figure 13-5 Amplitude and phase spectra.


Figure 13-6


Figure 13-7


Figure 13-8 Linear circuit with a periodic input.


Figure 13-9


Figure 13-10


Figure 13-11


Figure 13-12


Figure 13-13


Figure 13-14


Figure 13-15 Sampled signal.


Figure 13-16 Antialiasing filter.


Figure P13-3


Figure P13-4


Figure P13-6


Figure P13-7


Figure P13-8


Figure P13-9


Figure P13-19


Figure P13-20


Figure P13-22


Figure P13-30


Figure P13-34


Figure P13-35


Figure P13-37


Figure P13-38





Chapter 14



Figure 14-1 A cascade connection.


Figure 14-2 Second-order low-pass gain responses.


Figure 14-3 Second-order low-pass circuits.


Figure 14-4


Figure 14-5


Figure 14-6


Figure 14-7


Figure 14-8 Second-order high-pass gain responses.


Figure 14-9 Second-order high-pass circuits.


Figure 14-10


Figure 14-11


Figure 14-12


Figure 14-13 Second-order bandpass gain responses.


Figure 14-14 Second-order bandpass circuit.


Figure 14-15


Figure 14-16 Second-order bandstop gain responses.


Figure 14-17 Second-order bandstop circuit.


Figure 14-18


Figure 14-19


Figure 14-20


Figure 14-21


Figure 14-22 Low-pass filter specification and responses.


Figure 14-23 First-order low-pass cascade filter responses.


Figure 14-24


Figure 14-25 (a) First-order low-pass circuit.


Figure 14-25 (b) Circuit realization and response.


Figure 14-26


Figure 14-27 First-order cascade and Butterworth low-pass filter responses for n = 4.


Figure 14-28 Butterworth low-pass filter responses.


Figure 14-29 How a third-order Butterworth response is constructed. (a) pole-zero diagram (b) Bode diagram.


Figure 14-30 Design sequence for Example 14-7.


Figure 14-31


Figure 14-32


Figure 14-33


Figure 14-34 Chebyshev passband gain responses.


Figure 14-35 Butterworth and Chebyshev low-pass filter responses for n = 4.


Figure 14-36 Chebyshev low-pass filter responses.


Figure 14-37 Design sequence for Example 14-8.


Figure 14-38 How a third-order Chebyshev response is constructed. (a) Pole-zero diagram, (b) Bode diagram.


Figure 14-39


Figure 14-40 First-order cascade, Butterworth, and Chebyshev gain responses for n = 3.


Figure 14-41 First-order cascade, Butterworth, and Chebyshev pole locations for n = 3.


Figure 14-42 First-order cascade, Butterworth, and Chebyshev step responses for n = 3.


Figure 14-43


Figure 14-44


Figure 14-45 High-pass filter specification and responses.


Figure 14-46 First-order high-pass cascade filter responses.


Figure 14-47


Figure 14-48 Butterworth high-pass filter responses.


Figure 14-49


Figure 14-50 Design sequence for Example 14-11.


Figure 14-51


Figure 14-52


Figure 14-53 Chebyshev highpass filter responses.


Figure 14-54


Figure 14-55 Cascade connection of high-pass and low-pass filters.


Figure 14-56


Figure 14-57 Parallel connection of high-pass and low-pass filters.


Figure 14-58


Figure 14-59


Figure P14-4


Figure P14-5


Figure P14-8


Figure P14-9


Figure P14-10


Figure P14-13


Figure P14-38


Figure P14-46


Figure P14-47


Figure P14-48


Figure P14-50


Figure P14-51


Figure P14-52


Figure P14-53


Figure P14-54


Figure P14-55


Figure P14-56


Figure P14-57





Chapter 15



Figure 15-1 (a) Inductors separated, only self-inductance present. (b) Inductors coupled, both self- and mutual inductance present.


Figure 15-2 Winding orientations and corresponding reference dots.


Figure 15-3 All possible current and voltage reference marks for a fixed winding orientation.


Figure 15-4


Figure 15-5


Figure 15-6


Figure 15-7


Figure 15-8 Photos of transformers: (a) Typical powerline distribution (step-down) transformer. (b) Large power (step-up) transformer. (c) Common iron-core (step-up or step-down) transformer.


Figure 15-9 Transformer connected at a source-load interface.


Figure 15-10


Figure 15-11 Dot convention for transformers using phasors.


Figure 15-12 Typical transformer application using phasors.


Figure 15-13


Figure 15-14


Figure 15-15


Figure 15-16 The autotransformer connection.


Figure 15-17 Phasor circuit model of the two-winding transformer.


Figure 15-18


Figure 15-19


Figure 15-20


Figure 15-21 A ground loop.


Figure 15-22 Isolation transformers. (a) Surface mount. (b) Circuit diagram for (a). (c) Wide-band or in-line.


Figure 15-23 A mast antenna.


Figure 15-24 An Austin transformer.


Figure P15-1


Figure P15-4


Figure P15-6


Figure P15-7


Figure P15-8


Figure P15-9


Figure P15-11


Figure P15-12


Figure P15-17


Figure P15-18


Figure P15-20


Figure P15-24


Figure P15-26


Figure P15-27


Figure P15-31


Figure P15-34


Figure P15-35


Figure P15-36


Figure P15-37





Chapter 16



Figure 16-1 (a) A two-terminal interface.


Figure 16-1 (b) Relationship between current and voltage phase angles.


Figure 16-2 Power triangles.


Figure 16-3 A two-terminal impedance.


Figure 16-4


Figure 16-5


Figure 16-6


Figure 16-7


Figure 16-8 Residential power distribution circuit.


Figure 16-9 A simple electrical power system.


Figure 16-10 Circuit used for power factor correction.


Figure 16-11 Three-phase power transmission tower.


Figure 16-12 Voltages and currents associated with three-phase circuits.


Figure 16-13 Two possible phase sequences (a) Positive. (b) Negative.


Figure 16-14 Phasor diagram showing phase and line voltages for the positive phase sequence.


Figure 16-15 (a) A Y-connected source. (b) A A-connected source.


Figure 16-16 (a) A Y-connected load. (b) A A-connected load.


Figure 16-17


Figure 16-18


Figure 16-19 (a) Balanced Y-Y circuit. (b) Line currents and phase voltages in a Y-Y circuit.


Figure 16-20


Figure 16-21 A Y-Y circuit with line impedances.


Figure 16-22 AY-A circuit.


Figure 16-23 A balanced three phase circuit.


Figure 16-24


Figure 16-25 A balanced three-phase power system used for power flow analysis.


Figure 16-26 A single line representation of the circuit in Figure 16-25.


Figure 16-27


Figure 16-28


Figure P16-1


Figure P16-3


Figure P16-11


Figure P16-13


Figure P16-14


Figure P16-15


Figure P16-17


Figure P16-20


Figure P16-22


Figure P16-30


Figure P16-42


Figure P16-45


Figure P16-49


Figure P16-51


Figure P16-53


Figure P16-57





Chapter 17



Figure 17-1 A two-port network.


Figure 17-2


Figure 17-3


Figure 17-4


Figure 17-5


Figure 17-6


Figure 17-7


Figure 17-8


Figure 17-9


Figure 17-10


Figure 17-11


Figure 17-12


Figure 17-13


Figure 17-14


Figure 17-15 Atwo-terminal interface.


Figure 17-16


Figure P17-1


Figure P17-2


Figure P17-3


Figure P17-4


Figure P17-6


Figure P17-9


Figure P17-10


Figure P17-12


Figure P17-14


Figure P17-16


Figure P17-23


Figure P17-27


Figure P17-32





Chapter 18



Figure 18-1


Figure 18-2


Figure 18-3


Figure 18-4


Figure 18-5


Figure 18-6


Figure 18-7 Waveform and Fourier transform of the unit impulse signal.


Figure 18-8 Waveforms of the signum and doublesided exponential signals.


Figure 18-9 Example of duality property of Fourier transforms.


Figure 18-10 Example of scaling property of Fourier transforms.


Figure 18-11


Figure 18-12


Figure 18-13 Impulse response of an ideal low-pass filter.


Figure 18-14


Figure P18-17


Figure P18-18


Figure P18-19


Figure P18-21


Figure P18-22


Figure P18-23


Figure P18-29


Figure P18-39






Guide


Cover


Table of Contents




NOTICE
This accessible media has been made available to people with bona fide disabilities that affect reading.  This
      notice tells you about restrictions on the use of this accessible media, which could be a book, a periodical, or other content.

Copyright Notice

Title:
The Analysis and Design of Linear Circuits


Author:
Roland E. Thomas, Albert J. Rosa, Gregory J. Toussaint


Copyright
2023 by John Wiley & Sons Ltd

This notice is not part of the copyrighted work, which begins below after the phrase "Begin Content".
Bookshare distributes this accessible media under restrictions set forth either in copyright law or in an
        agreement with the copyright owner.  If you are not a person with a print disability, or an agency serving
        people with print disabilities, you should not use this accessible media and should destroy this content.  You
        are not allowed to redistribute content derived from this accessible media to anybody else, with one exception:
        we allow hardcopy Braille books prepared from Accessible Media to be provided to other blind people.
Access to accessible media through Bookshare is a valuable right and privilege.  Protect this access for the
        print disabled community by complying with these restrictions!
You, your parents, or your school (or agency) signed a Bookshare agreement.  For the full text of the current
        version of the Member Agreements, please visit www.bookshare.org/Agreements.  This information in this accessible
        media file does not in any way change the terms of your Agreement with Bookshare.


Limitation of Liability; Indemnity by User
Most authors and publishers do not have control over the content available through Bookshare.  By downloading and
        using this material, you agree that neither Bookshare nor the authors or original publishers of the materials
        shall be financially responsible for any loss or damage to you or any third parties caused by the failure or
        malfunction of the Bookshare Web Site (www.bookshare.org) or because of any inaccuracy or lack of completeness
        of any content that you download from the Web Site.
BOOKSHARE, AND THE AUTHORS, PUBLISHERS AND COPYRIGHT OWNERS OF THE MATERIALS, SHALL NOT IN ANY CASE BE LIABLE FOR
        DIRECT, INDIRECT, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES, WHETHER BASED ON CONTRACT, TORT OR ANY OTHER
        LEGAL THEORY, IN CONNECTION WITH OR ARISING OUT OF THE FURNISHING OF CONTENT, THE FUNCTIONING OF THE WEB SITE,
        OR ANY OTHER ASPECT OF YOUR USE OF THE WEB SITE AND THE CONTENTS PROVIDED HEREUNDER.
You agree to indemnify and hold Bookshare and Benetech, the Web Site provider, harmless from any liability,
        loss, cost, damage or expense, including reasonable attorney's fees, that result from any claim made by any
        author, publisher or copyright owner that you, or any one acquiring copies of copyrighted materials downloaded
        from the Web Site through you, is not print disabled or otherwise entitled to download and use the digital
        materials from the Bookshare Web Site.  This indemnity includes any claims arising out of any breach of your
        obligations under your Member Agreement, whether by reason of misuse, negligence or otherwise.


Permitted Use; Limited Waiver of Privacy Principles and Laws
You are permitted under this restricted license to use this digital copy for your own personal use.  However,
        any further reproduction, distribution, or any commercial usage requires the express, prior consent of the
        copyright holder.
This material contains digital watermarks and fingerprints designed to identify this material as a Bookshare
        digital material that was specifically downloaded by you.  It is generally illegal to delete or modify these
        watermarks and fingerprints, as well as being in violation of the terms of your Member Agreement.  Your
        Member Agreement expressly authorizes us to include these security devices, solely for this use, as an express
        exception to current and future privacy laws relating to protection of personal information data.  Should any
        future privacy law or regulation preclude the use of this personal data for purposes of tracking the downloading
        and use of these materials and enforcing the limitations of relevant copyright law or the Member Agreement,
        your right to use these materials will terminate on the effective date of any such law or regulation.
This material was downloaded by ali akbary and is digitally fingerprinted in the manner described above.


Book Quality
Bookshare is interested in improving book quality over time, if you can help us by providing any book quality
        feedback, we'll work hard to make those changes and republish the books.


Report book quality issue


See all reported book quality issues



Begin Content

              Title Page
            


Copyright


Dedication


Preface


Begin Reading


Appendix A: Solution of Linear Equations


Appendix B: Butterworth and Chebyshev Poles


Appendix C: Behaviorally Motivated Learning


Appendix D: Computational Tools


Appendix F: Complex Numbers


Appendix G: Standard Values and References


Appendix H: Answers to Selected Problems


Index


End User License Agreement




Pages


i


ii


iii


iv


v


vi


vii


viii


ix


x


xi


xii


1


2


3


4


5


6


7


8


9


10


11


12


13


P-1


P-2


P-3


15


16


17


18


19


20


21


22


23


24


25


26


27


28


29


30


31


32


33


34


35


36


37


38


39


40


41


42


43


44


45


46


47


48


49


50


51


52


53


54


55


56


57


58


59


60


61


62


P-5


P-6


P-7


P-8


P-9


P-10


P-11


P-12


P-13


P-14


P-15


63


64


65


66


67


68


69


70


71


72


73


74


75


76


77


78


79


80


81


82


83


84


85


86


87


88


89


90


91


92


93


94


95


96


97


98


99


100


101


102


103


104


105


106


107


108


109


110


111


112


113


114


115


116


117


118


119


120


121


122


123


124


P-17


P-18


P-19


P-20


P-21


P-22


P-23


P-24


P-25


P-26


P-27


P-28


P-29


125


126


127


128


129


130


131


132


133


134


135


136


137


138


139


140


141


142


143


144


145


146


147


148


149


150


151


152


153


154


155


156


157


158


159


160


161


162


163


164


165


166


167


168


169


170


171


172


173


174


175


176


177


178


179


180


181


182


183


184


185


186


187


188


189


190


191


192


193


194


195


196


197


198


199


200


201


202


203


204


205


206


P-31


P-32


P-33


P-34


P-35


P-36


P-37


P-38


P-39


P-40


P-41


P-42


P-43


P-44


207


208


209


210


211


212


213


214


215


216


217


218


219


220


221


222


223


224


225


226


227


228


229


230


231


232


233


234


235


236


237


238


239


240


P-45


P-46


P-47


P-48


P-49


P-50


P-51


P-52


241


242


243


244


245


246


247


248


249


250


251


252


253


254


255


256


257


258


259


260


261


262


263


264


265


266


267


268


269


270


P-53


P-54


P-55


P-56


P-57


P-58


P-59


P-60


271


272


273


274


275


276


277


278


279


280


281


282


283


284


285


286


287


288


289


290


291


292


293


294


295


296


297


298


299


300


301


302


303


304


305


306


307


308


309


310


311


312


313


314


315


316


317


318


319


320


321


322


323


324


325


326


327


328


329


330


331


332


333


334


335


336


P-61


P-62


P-63


P-64


P-65


P-66


P-67


P-68


P-69


P-70


P-71


P-72


337


338


339


340


341


342


343


344


345


346


347


348


349


350


351


352


353


354


355


356


357


358


359


360


361


362


363


364


365


366


367


368


369


370


371


372


373


374


375


376


377


378


379


380


381


382


383


384


385


386


387


388


389


390


391


392


393


394


395


396


397


398


399


P-73


P-74


P-75


P-76


P-77


P-78


P-79


P-80


P-81


P-82


P-83


401


402


403


404


405


406


407


408


409


410


411


412


413


414


415


416


417


418


419


420


421


422


423


424


425


426


427


428


429


430


431


432


433


434


435


436


437


438


439


440


P-85


P-86


P-87


P-88


P-89


P-90


P-91


441


442


443


444


445


446


447


448


449


450


451


452


453


454


455


456


457


458


459


460


461


462


463


464


465


466


467


468


469


470


471


472


473


474


475


476


477


478


479


480


481


482


483


484


485


486


P-93


P-94


P-95


P-96


P-97


P-98


P-99


P-100


P-101


P-102


P-103


487


488


489


490


491


492


493


494


495


496


497


498


499


500


501


502


503


504


505


506


507


508


509


510


511


512


513


514


515


516


517


518


519


520


521


522


523


524


525


526


527


528


529


530


531


532


533


534


535


536


537


538


539


540


541


P-105


P-106


P-107


P-108


P-109


P-110


P-111


P-112


P-113


543


544


545


546


547


548


549


550


551


552


553


554


555


556


557


558


559


560


561


562


563


564


565


566


567


568


569


570


571


572


573


574


575


576


577


578


579


580


581


582


583


584


585


586


587


588


589


590


591


592


593


594


595


596


597


598


599


600


601


P-115


P-116


P-117


P-118


P-119


P-120


P-121


P-122


P-123


P-124


P-125


603


604


605


606


607


608


609


610


611


612


613


614


615


616


617


618


619


620


621


622


623


624


625


626


627


628


629


630


631


632


633


P-127


P-128


P-129


P-130


P-131


P-132


635


636


637


638


639


640


641


642


643


644


645


646


647


648


649


650


651


652


653


654


655


656


657


658


659


660


661


662


663


664


665


666


667


668


669


670


671


672


673


674


675


676


677


678


679


680


681


682


683


684


685


686


687


688


689


690


691


692


693


694


695


696


697


698


699


700


P-133


P-134


P-135


P-136


P-137


P-138


P-139


P-140


701


702


703


704


705


706


707


708


709


710


711


712


713


714


715


716


717


718


719


720


721


722


723


724


725


726


727


P-141


P-142


P-143


P-144


729


730


731


732


733


734


735


736


737


738


739


740


741


742


743


744


745


746


747


748


749


750


751


752


753


754


755


756


757


758


759


760


761


762


763


764


765


766


P-145


P-146


P-147


P-148


P-149


P-150


767


768


769


770


771


772


773


774


775


776


777


778


779


780


781


782


783


784


785


P-151


P-152


P-153


787


788


789


790


791


792


793


794


795


796


797


798


799


800


801


802


803


804


805


806


807


808


809


810


811


812


813


814


P-155


P-156


P-157


A-1


A-2


A-3


A-4


A-5


A-6


A-7


B-1


B-2


B-3


B-4


C-1


C-2


C-3


D-1


D-2


D-3


D-4


D-5


D-6


D-7


D-8


D-9


D-10


D-11


D-12


D-13


D-14


D-15


D-16


D-17


D-18


D-19


D-20


D-21


D-22


D-23


D-24


D-25


D-26


D-27


D-28


D-29


D-30


D-31


D-32


D-33


D-34


D-35


D-36


D-37


D-38


D-39


D-40


D-41


D-42


D-43


D-44


D-45


D-46


D-47


D-48


D-49


D-50


D-51


D-52


D-53


D-54


D-55


D-56


D-57


D-58


D-59


D-60


D-61


D-62


D-63


D-64


D-65


D-66


D-67


D-68


D-69


D-70


D-71


D-72


D-73


D-74


D-75


D-76


D-77


D-78


D-79


D-80


D-81


D-82


D-83


D-84


D-85


D-86


D-87


D-88


D-89


D-90


D-91


D-92


D-93


D-94


D-95


D-96


D-97


D-98


D-99


D-100


D-101


D-102


D-103


D-104


D-105


D-106


D-107


D-108


D-109


D-110


D-111


D-112


D-113


D-114


D-115


D-116


D-117


D-118


D-119


D-120


D-121


D-122


D-123


D-124


D-125


D-126


D-127


D-128


D-129


D-130


D-131


D-132


D-133


D-134


D-135


D-136


D-137


D-138


D-139


D-140


D-141


D-142


D-143


D-144


D-145


D-146


D-147


D-148


D-149


D-150


D-151


D-152


D-153


D-154


D-155


D-156


F-1


F-2


F-3


F-4


G-1


G-2


G-3


G-4


G-5


G-6


G-7


H-1


H-2


H-3


H-4


H-5


H-6


H-7


H-8


H-9


H-10


H-11


H-12


H-13


H-14


H-15


H-16


H-17


H-18


H-19


H-20


H-21


H-22


H-23


H-24


H-25


H-26


H-27


H-28


H-29


H-30


H-31


H-32


H-33


H-34


H-35


H-36


H-37


H-38


H-39


H-40


H-41


H-42


H-43


H-44


H-45


H-46


H-47


H-48


H-49


H-50


H-51


H-52


H-53


H-54


H-55


H-56


H-57


H-58


H-59


H-60


H-61


H-62


H-63


H-64


I-1


I-2


I-3


I-4


I-5


I-6


I-7


I-8


I-9


I-10















The Analysis and Design of Linear Circuits



 


Tenth Edition


 




Roland E. Thomas


              Professor Emeritus
              
United States Air Force Academy





Albert J. Rosa


              Professor Emeritus
              
University of Denver





Gregory J. Toussaint


              Civilian Employee
              
United States Air Force




 
 
 
 
 
















        This edition first published 2023
        
        © 2023 John Wiley & Sons Ltd
      

Edition History

© 2019, 2016, 2012, 2009, 2005, 2003, 2000


        All rights reserved. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any form or by any means, electronic, mechanical, photocopying, recording or otherwise, except as permitted by law. Advice on how to obtain permission to reuse material from this title is available at
        http://www.wiley.com/go/permissions
        .
      

        The right of Roland E. Thomas, Albert J. Rosa and Gregory J. Toussaint
        
1

        to be identified as the author of this work has been asserted in accordance with law.
      

Registered Offices

        John Wiley & Sons, Inc., 111 River Street, Hoboken, NJ 07030, USA
        
        John Wiley & Sons Ltd, The Atrium, Southern Gate, Chichester, West Sussex, PO19 8SQ, UK
      

Editorial Office

        The Atrium, Southern Gate, Chichester, West Sussex, PO19 8SQ, UK
      

        For details of our global editorial offices, customer services, and more information about Wiley products visit us at
        www.wiley.com
        .
      
Wiley also publishes its books in a variety of electronic formats and by print-on-demand. Some content that appears in standard print versions of this book may not be available in other formats.

Limit of Liability/Disclaimer of Warranty

        While the publisher and authors have used their best efforts in preparing this work, they make no representations or warranties with respect to the accuracy or completeness of the contents of this work and specifically disclaim all warranties, including without limitation any implied warranties of merchantability or fitness for a particular purpose. No warranty may be created or extended by sales representatives, written sales materials or promotional statements for this work. The fact that an organization, website, or product is referred to in this work as a citation and/or potential source of further information does not mean that the publisher and authors endorse the information or services the organization, website, or product may provide or recommendations it may make. This work is sold with the understanding that the publisher is not engaged in rendering professional services. The advice and strategies contained herein may not be suitable for your situation. You should consult with a specialist where appropriate. Further, readers should be aware that websites listed in this work may have changed or disappeared between when this work was written and when it is read. Neither the publisher nor authors shall be liable for any loss of profit or any other commercial damages, including but not limited to special, incidental, consequential, or other damages.
      

Library of Congress Cataloging-in-Publication Data


        Names: Thomas, Roland E., 1930- author. | Rosa, Albert J., 1942- author. | Toussaint, Gregory J., author.
        
        Title: The analysis and design of linear circuits / Roland E. Thomas, Professor Emeritus, United States Air Force Academy, Albert J. Rosa, Professor Emeritus, University of Denver, Gregory J. Toussaint, Civilian Employee, United States Air Force.
        
        Description: Tenth edition. | Hoboken, NJ, USA : John Wiley & Sons, Inc., 2023. | Includes bibliographical references and index.
        
        Identifiers: LCCN 2023010335 (print) | LCCN 2023010336 (ebook) | ISBN 9781119913023 (paperback) | ISBN 9781119913047 (adobe pdf) | ISBN 9781119913443 (epub)
        
        Subjects: LCSH: Electric circuits, Linear-Design and construction. | Electric circuit analysis.
        
        Classification: LCC TK454 .T466 2023 (print) | LCC TK454 (ebook) | DDC 621.319/2-dc23/eng/20230307
        
        LC record available at
        https://lccn.loc.gov/2023010335

        LC ebook record available at
        https://lccn.loc.gov/2023010336

SENIOR EDITORIAL DIRECTOR  Margaret Cummins
PUBLISHER            Aileen Storry
ASSISTANT EDITOR        Michelle Dunckley
SENIOR MANAGING EDITOR   Judy Howarth
PRODUCTION EDITOR      Mustaq Ahamed

        Cover Design: Wiley
        
        Cover Image: © supakritpumpy/Getty Images
      



Note




1

          The content presented in this text represents the author's personal views and not necessarily those of the Department of Defense or of the Air Force.
        










 
 
 


To our wives, Kathleen and Tricia, and in memory of Ron Thomas who was instrumental in imagining this text and who served as our mentor for the first eight editions. And to his wife, Juanita, who assisted Ron with the proofing and editing of the first seven editions.














PREFACE




What Is Different about This Text?
Look around. Electrical technology is all around us. Today we talk about smart phones, 5G communications, electric vehicles (EV), wireless charging, drones, self-driving cars, solar power, windmill power generators, fiber communications, the internet of things (IoT), petaflop processors, cloud storage, gigabit laptops, automated factories, robots, radar, sonar, remote controls, distant learning and working, instrumentation of all kinds, and smart this or that. This technology is entwined in almost everything we use. Electrical engineers use it, mechanical engineers use it, aerospace engineers use it, and computer engineers use it - anyone who works with or creates modern technology uses it. This text will serve as a bridge to uncovering the basics of these electrical technologies.
But this text goes further than other circuit analysis texts in that it serves the desire of up-and-coming engineers to be creative. Most circuits texts do not focus on this basic desire, rather spend their pages teaching why and how electric circuits work without affording the student an opportunity to put this learning into practice. This text focuses on the art and science of design - creating a solution to a task or need. But it does not stop there. There are often several solutions to a problem. The question then arises - which solution should I choose? The answer is how to evaluate different solutions against the constraints of the problem. Do I minimize power usage, physical size, weight, standard parts, manufacturing ease, or whatever the need is?
We have learned over the last nine editions of the increasing importance and use of computers and software. Key software used in circuit analysis and design has become available for free or at very deep discounts for students. This edition of our text includes more software examples, exercises, and discussions geared to making the study of circuits more in line with the interests of today's student and their future employers. However, learning to solve problems using software tools, while often fun and exciting to today's students, often does not offer the same insight garnered using simple tools like manual-calculations and calculators. We have recognized that just using software does not replace the intuition that engineers must develop to analyze, design, and make smart judgments about alternate working solutions. We worked hard to meld manual solutions with the use of software throughout and point out the sources of potential errors.

          The tenth edition of
          The Analysis and Design of Linear Circuits
          improves on earlier editions and remains friendly to users who prefer a Laplace-Early approach championed in our first edition, or those favoring the more traditional Phasor-First approach to ac circuits. A later section discusses how to use this text to pursue either approach using three different focuses. In this edition, we include skills-level
          
          examples, exercises, and problems that can help develop the student's confidence in mastering the different objectives. The tenth edition assumes the same student prerequisites as past editions and continues to rely on students having access to personal computational tools. This edition targets students of all engineering disciplines who need an introductory circuit analysis course of one or two terms. The tenth edition continues the authors' combined commitment to providing a modern, different, and innovative approach to teaching analysis, design, and design evaluation of electric circuits, especially in the spirit of today's evolving technologies.
        


Continuing Features Objectives

          This text remains structured around a sequence of carefully defined cognitive learning objectives and related evaluation tools based on Bloom's Taxonomy of Educational Objectives
          
1

          . The initial learning objectives focus on enabling skills at the first three levels of the taxonomy that we call Chapter Learning Objectives. As students demonstrate mastery of these lower levels, they are introduced to higher-level objectives involving analysis, synthesis (design), and evaluation. Each learning objective is explicitly stated in terms of expected student proficiency in the Chapter Openers and are repeated in the homework sections. Then each is followed by homework problems specifically designed to evaluate student mastery of the objective. This framework has been a standard feature of all ten editions of this book and has allowed us to maintain a consistent level of expected student performance over the years. These objectives make it easier to assess student learning and prepare for accreditation reviews. Specifically, there are seven Student Outcomes required to fulfill ABET's 2022-23 Criterion 3. Proper use of this text will facilitate the following two:
        

"The program must have documented student outcomes that support the program educational objectives. Attainment of these outcomes prepares graduates to enter the professional practice of engineering.




1.

an ability to identify, formulate, and solve complex engineering problems by applying principles of engineering, science, and mathematics.



2.

an ability to apply engineering design to produce solutions that meet specified needs with consideration of public health, safety, and welfare, as well as global, cultural, social, environmental, and economic factors."


And it can be used to support item "d" in Criterion 5, Curriculum:

" The curriculum must include:





d.


a culminating major engineering design experience that 1) incorporates appropriate engineering standards and multiple constraints, and 2) is based on the knowledge and skills acquired in earlier course work.






          Integrating Problems
        
Every homework section ends with integrating problems that test mastery of concepts that cover several objectives. These more in-depth problems test whether the student has not only mastered individual objectives in the chapter but also was able to integrate knowledge across several objectives from one or more chapters.


Circuit Analysis and Design

          Our experience convinces us that an interweaving of analysis and design topics reinforces a student's grasp of circuit analysis fundamentals. Early involvement in design provides motivation as students apply their newly acquired analysis tools to practical situations. Using computer computational (MATLAB) or simulation (Multisim) software to verify their designs gives students an early degree of confidence that they have actually created a solution that meets stated specifications. Ideally, a supporting laboratory program where students actually build and test their designs provides the final confirmation that they can create useful products. Design efforts as described in this text are very useful in helping to meet ABET's design Criterion 3(2) noted earlier. We identify design examples, exercises, and homework problems with an icon
          
          .
        


Design Evaluation

          Realistic design problems rarely have unique solutions, so it is natural for students to wonder if their design is a good one. Using smart judgment to compare alternative solutions is a fundamental trait of good engineering. The evaluation of alternative designs introduces students to real-world engineering practice. Our text includes judgment problems that ask students, for example, to evaluate an "off-the-shelf" design and ask if it could meet a specific need. In such problems, we ask the student "would you buy it?", or "would you buy it if one change was allowed to be made to it?" Alternately, we ask students to compare two or three "solutions" and ask which best meets the given criteria. Including design and the evaluation of design in an introductory course helps to convince students that circuit courses are not simply vehicles for teaching routine skills such as node-voltage and mesh-current analyses, but also a vehicle for learning and practicing engineering judgment which is, in part, an art that needs to be practiced. Although this philosophy is implicit in all previous editions, this edition offers expanded coverage of design and evaluation among the worked examples, exercises, and homework problems. We use software extensively to help students visualize specifications, alternatives, and their design results. This, in turn, helps them to create better designs and make smart choices between competing designs. Evaluation generally involves the practical side of design and can support ABET Criterion 3(2) and contribute to Criterion 5(d). We identify evaluation examples, exercises, and homework problems with an icon
          
          .
        


The OP AMP

          A central feature of this text continues to be an early introduction and integrated treatment of the ideal OP AMP. The modular form of OP AMP circuits simplifies analog circuit analysis and design by minimizing the effects of loading, which is an interaction among circuit components. This feature allows the interconnection of simple building blocks to produce complex signal processing functions that are
          
          especially useful to instrumentation and signal shaping applications. The close agreement between theory, simulation, and hardware allows students to analyze, design, and successfully build useful OP AMP circuits in the laboratory. The text covers numerous OP AMP applications, such as digital-to-analog conversion, transducer interface circuits, comparator circuits, block diagram realization, first-order filters, and multiple-pole active filters, and some OP AMP limitations, such as loading, saturation, and gain-bandwidth product. These applications, which have been again expanded in this new edition, are especially useful to students from other engineering disciplines that require knowledge of instrumentation, filtering, or signal processing.
        


Signals and Signal Processing

          We begin our treatment of dynamic circuits with a separate chapter on waveforms and signal characteristics. This chapter gives students early familiarity with important input and output signals encountered in the study of linear circuits. Introducing signals at the beginning of dynamic circuit analysis lets students become comfortable with time-varying signals without having to simultaneously deal with applying them to circuits. A further emphasis on signal processing and systems is achieved through the use of block diagrams, input-output relationships, phasors, and transforms methods. The ultimate goal is for students to understand that time-domain waveforms and frequency-domain transforms are simply alternative ways to characterize signals and signal processing with each domain approach providing different insight to the circuit's performance. Viewing signals in both domains naturally leads to discussions of important concepts such as signal bandwidth, signal sampling, and reciprocal spreading. It is also useful knowledge in choosing alternative design approaches to multipole filters which we introduce in
          Chapter 14
          .
        


Laplace Transforms

          Laplace transforms are used to solve differential equations using algebraic techniques. In circuits, Laplace transforms are used to treat important concepts such as zero-state and zero-input responses, impulse and step responses, convolution, frequency response, and filter design. Tools such as pole-zero diagrams and Bode plots permit deeper insight to frequency- and time-domain concepts. An important pedagogical question is where Laplace transforms should be taught—in the Circuits course, the Signals and Systems course, a Differential Equations course, or elsewhere? The traditional approach in circuits has been to first teach phasors and use them to study ac circuit analysis, steady-state ac power, polyphase circuit analysis, magnetically coupled circuits, and frequency response. This extended treatment of phasor analysis means that Laplace transforms are often delayed to the last weeks of the second semester and treated as an advanced topic along with Fourier methods and two-port networks. Typically, then, Laplace transforms are taught in earnest in a Signals and Systems course, where their linkage to phasors is often overlooked. We have long advocated an early Laplace approach, one in which Laplace transforms are introduced and applied to circuit analysis
          before
          phasors are introduced. The advantage of treating Laplace-based circuit analysis first is that once mastered, it makes learning phasor-based analysis easier and more intuitive. Students quickly make the connection between phasor analysis and the concepts of network functions, transient response, and sinusoidal steady-state response developed through
          s
          -domain circuit analysis. We do not claim that Laplace analysis is more fundamental or even more important than phasor analysis. We do claim that the learning effort needed to master both phasor analysis and Laplace analysis is not a zero-sum game. Our
          
          experience is that less classroom time is needed to ensure mastery of both methods of analysis when Laplace transform analysis is treated before phasor analysis. Emphasizing transform methods in the circuit course also better prepares students to handle the profusion of transforms they will encounter in subsequent Signals and Systems courses.
        


Computer Tools

          Our philosophy recognizes that today students come to the Circuits course being comfortable using a computer. Many already know how to use several computer tools such as spreadsheets and word processing. Some may be familiar with math solvers and possibly simulation software. One of our goals is to help them learn how to effectively use these tools. Knowing when to use these tools and how to interpret the results is essential to understanding circuits. We use three types of computer programs in this text to illustrate computer-aided circuit analysis, namely spreadsheets (Excel
          ®
          ), math solvers (MATLAB
          ®
          ), and circuit simulators (Multisim
          ®
          ). Beginning with
          Chapter 1
          , examples, exercises, and homework problems related to computer-aided circuit analysis are integrated into all chapters. The purpose of the examples is to show students how to develop a problem-solving style that includes the intelligent use of the productivity tools routinely used by practicing engineers. Exercises following most examples help students immediately practice the software skill demonstrated in the example. There are 88 examples and 89 exercises that use computer tools in their solution more than double the last edition. There are 354 homework problems that require the use of a computer tool and are identified by a computer icon (
          
          ).
        

          We have created supplemental
          Appendix D
          that includes additional examples that make use of software tools. This approach of integrating software tools into circuits directly supports ABET's Criterion 5:
          The curriculum must include: b. a minimum of 45 semester credit hours (or equivalent) of engineering topics appropriate to the program, consisting of engineering and computer sciences and engineering design, and utilizing modern engineering tools.



Application Examples
The text has many examples that link directly to practical uses. The purpose of these examples is to show that the topics being covered are more than a pedagogical exercise. These real-world examples find use in common applications and products. There are practical examples on how to install a level 2 charging system for an EV in a household power system. How a sonar works to detect fish, how a drone's altimeter might work, or how a collision avoidance system might be designed. How to correctly sample a heart-rate monitor. How the Navy communicates to their submarines, and why 5G communications are so desirable. We spend a large section on how to instrument sensors of all kinds including thermal, light, strain, acceleration, and pressure. We identify 36 Application Examples more attuned to electronics. They include topics, such as cathode ray tubes (CRT), batteries, source-load interfacing, bipolar junction transistor (BJT) operation, digital multimeters, common-mode rejection ratio (CMRR) in instrumentation amplifiers, attenuation pads, electrocardiograph (ECG), and clock timing waveforms, three on how to obtain a waveform equation from an oscilloscope, sample-hold circuits, resonance, impedance bridge, gain-bandwidth product, digital filtering, frequency content of a full-wave rectifier, isolation and auto-transformers, and others.




          Text Appendices
        

          Since many students may need to review topics, obtain additional insight, or find a quick reference to a solution, template, or a table, we have included eight appendices. One on the solution of linear equations (A), one on Butterworth and Chebyshev Poles (B), one appendix on Behaviorally Motivated Learning (C), one on computational tools (D), one with all the Exercises worked out (E), one on a review of Complex Numbers (F), and an important one on Standard Values and References (G) that is linked to examples, exercises, and problems that request use of standard parts. Appendix (H) provides Answers to Selected Problems with the problems identified in the homework section with an icon (
          
          ). Additional supplementary materials for instructors are available at
          www.wiley.com/go/Thomas/linearcircuits10e
          .
        


New Features of the Tenth Edition Color
The use of color has been enhanced throughout the new edition. Both the eBook and the printed text are in full color. This should improve both readability and add clarity to the topics, circuits, software outputs, and graphs used.


Skills — Building Examples, Exercises, and Problems and Bloom's Taxonomy

          Learning engineering subjects requires skill-building. Engineering topics build upon one another starting with physics and mathematics. Then one learns the basics, learns to apply them, expands their knowledge and practices what one has learned. There appears to be a pattern to learning and in 1956 Benjamin Bloom wrote
          The Taxonomy of Educational Objectives,
          referenced earlier, that attempted to codify how one learns. The
          Cognitive
          taxonomy or domain has six levels: Knowledge, Comprehension, Application, Analysis, Synthesis (Design), and Evaluation. The last two, Design and Evaluation, are often intertwined. This text is organized following this taxonomy.
        
We start topics by referring back to earlier discussions that are relevant on the current topic. Then, as a means of helping students build confidence, we use detailed worked-out Examples, generally at the Comprehension and Application level. Almost every Example is followed by one or more Exercises with answers that instill confidence that they have mastered the topic. Should a student still be perplexed on how the answer was obtained, every Exercise is worked out in detail in Appendix E. Homework problems are also similarly organized based on each learning objective starting with easier problems and becoming increasingly challenging.


Circuit Design and Design Evaluation
Our emphasis on creating solutions and choosing the better or best one has been-strengthened with the inclusion of 142 design examples and exercises and 260 design homework problems. There are dozens of design evaluation examples, exercises, and homework problems. In this edition, there are 46 evaluation examples and exercises and 109 homework problems that require applying judgment. These are at the highest levels of the taxonomy.




          Frequency Response and Active Filters
        

          We have continued to improve
          Chapter 12
          on frequency response. We added a section on the electromagnetic spectrum and its importance with current technology and eliminated detailed hand-drawing of Bode diagrams in favor of software results. In
          Chapter 14
          on active filters, we have continued our integration of software to assist the student in understanding frequency behavior through Bode diagrams and pole-zero diagrams. Users have told us that
          Chapter 14
          , which emphasizes First-Order Cascade, Butterworth, and Chebyshev Type 1 filters, often proves useful to students in subsequent design courses where knowledge of active filters may be needed. As a result, we have expanded our coverage of active multi-pole notch and tuned filters. And we added a brief overview of Bessel, Butterworth, Chebyshev Types I and II, Biquad, and Elliptic filters. Both chapters have more design and evaluation examples as well as more homework problems. These chapters are excellent means of understanding the frequency behavior of circuits.
        


Mutual Inductance and Transformers
In the chapter on mutual inductance and transformers, we added an Application Example on wireless energy transmission, which is increasingly important for the remote charging of electric vehicles and other devices. In addition, we have added more simulation examples to this chapter.


AC Power Systems

          We have improved
          Chapter 16
          , on three-phase ac power circuits, to make it more inline with what today's students should know. We added a discussion on today's power issues such as renewables, transmission, and sustainability. We continued our focus away from phasor circuit analysis toward power flow and systems, both single-phase and three-phase, with new simulation examples and exercises. We simplified the power flow discussion while placing greater emphasis on the fact that power flow does not require phasors. Power flow in a balanced three-phase circuit can be determined using only the magnitudes of the line voltage and line current. We added more computer simulation examples, exercises, and problems.
        


Two-Ports

          We built a better bridge to earlier discussions on two ports in
          Chapter 11
          and provided more purpose for studying the subject. We have added discussion, examples, and exercises to illustrate that two-port parameters are not just another way to find voltage and current responses. Rather, their primary utility is to determine global circuit properties such as voltage gain, current gain, feedback, and Thévenin equivalence. We have added more simulation examples to this chapter.
        


Fourier Transforms

          We improved
          Chapter 18
          on Fourier Transforms. This chapter can serve as a bridge to a Signals and Systems course as it contains the development of Fourier transforms and properties, the relationship between Fourier and Laplace transforms, the use of Fourier transforms in circuit analysis, and a discussion of Parseval's theorem. We added useful MATLAB examples applying
          fourier
          and
          ifourier
          functions to help solve transform problems.
        




          Using This Edition for Laplace Early
        

          The tenth edition is designed as were all our previous editions, so that it can be used as a Laplace Early version as well as a traditional Phasor First version. The phasor analysis chapter (
          Chapter 8
          ) comes before the study of Laplace transform techniques (
          Chapters 9
          -
          11
          ). Those wishing to follow the traditional approach can follow the tenth edition chapter organization through
          Chapter 8
          , on phasor analysis, with a possible delaying of
          Chapter 7
          until the second semester. Those choosing a Laplace Early approach can follow the present chapter organization through
          Chapter 7
          , skip
          Chapter 8
          , and proceed directly to the Laplace chapters.
        

          The current edition includes an introduction to phasor analysis in Section 11-5, dealing with the sinusoidal steady state. As a result, Laplace Early users can study phasor analysis in
          Chapter 8
          at any point after
          Chapter 11
          . The following table shows suggested chapter sequencing for the traditional and Laplace Early approaches for three different subject matter emphases. The second author used the Traditional-Electronics sequence at the USAF Academy and has used the Laplace Early-Systems sequence at the University of Denver. Enough material is available in the text and in the appendices to allow the construction of other topic sequences. Other organizational options are available in the Instructor Manual.
        



Emphasis
Semester 1
Semester 2





Traditional (Phasor First)



Power
1
2
3
4
5
6
8/7
7/8
15
16
9
10
11
12


Systems
1
2
3
4
5
6
8/7
7/8
9
10
11
12
13
18


Electronics
1
2
3
4
5
6
8/7
7/8
9
10
11
12
14
15/17



Laplace Early



Power
1
2
3
4
5
6
7
9
10
11
12
8
15
16


Systems
1
2
3
4
5
6
7
9
10
11
12
13
18
8/15


Electronics
1
2
3
4
5
6
7
9
10
11
12
14
15
17





Use of Software in This Edition

          Software use throughout the text has been significantly increased and strengthened to include many new MATLAB, Multisim, and Excel examples to help practice using the software. Although there are many simulation products that can be used, in this edition, we chose National Instrument's Multisim
          ®
          because of its ease of use, low cost, breadth of problems it can easily be used on, the ability to insert virtual laboratory instruments in a circuit, and its easy integration with another NI product LabView
          ®
          . There is an expanded supplemental
          Appendix D
          to simplify students' use of software. There are 354 homework problems that suggest solutions using MATLAB, Multisim, or both.
        


Acknowledgments

          Individuals at John Wiley & Sons, Inc. involved with this edition include Aileen Storry, Publisher, Judy Howarth, Senior Managing Editor; Michelle Dunckley, Assistant Editor for Electrical Engineering; and Mustaq Ahamed, Production
          
          Editor. Over the years, numerous faculty, engineers, staff, students, and others have helped shape this work in too many ways to list. In particular, we would like to acknowledge the contributions of the following individuals to whom we are indebted: Robert M. Anderson, Iowa State University; Doran J. Baker, Utah State University; James A. Barby, University of Waterloo; William E. Bennett, United States Naval Academy; Maqsood A. Chaudhry, California State University at Fullerton; Michael Chier, Milwaukee School of Engineering; Don E. Cottrell, University of Denver; Robert Curtis, Ohio University; Michael L. Daley, University of Memphis; Ronald R. Delyser, University of Denver; Prasad Enjeti, Texas A&M University; John C. Getty, University of Denver; James G. Gottling, Ohio State University; Frank Gross, Florida State University; Robert Kotiuga, Boston University; Hans H. Kuehl, University of Southern California; K.S.P. Kumar, University of Minnesota; Nicholas Kyriakopoulos, George Washington University; Michael Lightner, University of Colorado at Boulder; Jerry I. Lubell, Jaycor; Reinhold Ludwig, Worcester Polytechnic Institute; Lloyd W. Massengill, Vanderbilt University; Frank L. Merat, Case Western Reserve University; Richard L. Moat, Motorola; Gene Moriarty, San Jose State University; Dudley Outcalt, Milwaukee School of Engineering; Anil Pahwa, Kansas State University; Michael Polis, Oakland University; Pradeep Ramuhalli, Michigan State University; William Rison, New Mexico Institute of Mining and Technology; Martin S. Roden, California State University at Los Angeles; Pat Sannuti, the State University of New Jersey; Alan Schneider, University of California at San Diego; Ali O. Shaban, California Polytechnic State University; Jacob Shekel, Northeastern University; Kadagattur Srinidhi, Northeastern University; Peter J. Tabolt, University of Massachusetts at Boston; Len Trombetta, University of Houston; David Voltmer, Rose-Hulman Institute of Technology; Bruce F. Wollenberg, University of Minnesota; Robert Whitman, University of Denver; Albert Batten, USAF Academy; Daniel Pack, USAF Academy; Michael Drew, USAF Academy; Alan R. Klayton, USAF Academy; Anne Clark, USAF Academy; Glen Dudevoir, USAF Academy; and Robert A. Weller, Vanderbilt University. Special recognition goes to Suzanne Ingrao, Production Manager for editions three through six of this text, and to James K. Kang of California State University at Pomona for his meticulous editing of the homework solutions for the fourth through seventh editions, and to Salomon Oldak of California State University at Pomona for doing the same for the eighth edition.
        
And we want to acknowledge, our senior partner Roland Thomas, who passed away at the time the ninth edition was released. He was both our inspiration and mentor, and we miss him.



Note




1

              Bloom, B. S., Englehart, M. D., Furst, E. J., Hill, W. H., & Krathwohl, D. R. (1956).
              The Taxonomy of Educational Objectives, Handbook I: The Cognitive Domain.
              New York: David McKay Co., Inc. For more in-depth understanding of how we integrate
              Behaviorally Motivated Learning
              into our text see
              Appendix C
              .
            
















CHAPTER 1

INTRODUCTION




The electromotive action manifests itself in the form of two effects which I believe must be distinguished from the beginning by a precise definition. I will call the first of these "electric tension," the second "electric current."


            André-Marie Ampère, 1820,
            
            French Mathematician/Physicist
          









Some History Behind This Chapter
André Ampère (1775-1836) was the first to recognize the importance of distinguishing between the electrical effects we now call voltage and current. He also invented the galvanometer, the forerunner of today's voltmeter and ammeter. A natural genius, he had mastered all the then-known mathematics by age 12. He is best known for defining the mathematical relationship between electric current and magnetism, now known as Ampère's law.











Why This Chapter Is Important Today
Welcome to the study of Linear Circuits. In this chapter, you are introduced to the lexicon of electrical engineering. You will learn both the terminology and the variables that will be used throughout the book. Important concepts introduced here are voltage, current, and power. The reference marks used to define them, and a voltage benchmark called ground. In addition, you will gain an initial appreciation of the value of the computational software that is common in the electrical engineering profession.











Chapter Sections



1-1 About This Book






1-2 Symbols and Units






1-3 Circuit Variables






1-4 Computational and Simulation Software Introduction














Chapter Learning Objectives

1-1
              Electrical Symbols and Units (
              Sect. 1-2
              )
            
Given an electrical quantity described in terms of words, scientific notation, or decimal prefix notation, convert the quantity to an alternative description.

1-2
              Circuit Variables (
              Sect. 1-3
              )
            

              Given any two of the three signal variables (
              i
              ,
              u
              ,
              p
              ) or the two basic variables (
              q
              ,
              w
              ), find the magnitude and direction (sign) of the unspecified variables.
            

1-3
              Software Introductions (
              Sect. 1-4
              ,
              Appendix D
              )
            

              Given a simple computational problem, use MATLAB as an appropriate engineering tool to solve the problem. (We will introduce the use of Multisim to solve simulation problems starting in
              Chapter 2
              .)
            









          1-1 About This Book
        

          The basic purpose of this book is to introduce the analysis and design of linear circuits. Circuits are important in electrical engineering because they process electrical signals that carry energy and information. For the present, we can define a
          circuit
          as an interconnection of electrical devices and a
          signal
          as a time-varying electrical entity. For example, the information stored on an optical disk is recovered in the optical disk player (e.g., Blu-Ray) as electronic signals, initially stored as discrete (digital) data that are processed by circuits to generate continuous (analog) audio and video outputs. In an electrical power system, some form of energy (coal, natural gas, nuclear, wind, solar, hydro, chemical, etc.) is converted to electrical form and transferred to loads, where the energy is converted into the form (mechanical, light, heat, etc.) required by the customer. The optical disk player and the electrical power system both involve circuits that process and transfer electrical signals carrying energy and information. Electrical signals are also very important to other engineering disciplines. For example, mechanical engineers use various transducers to measure stress, strain, fluid flow, or temperature and apply the electrical results as inputs for analysis and control. Aeronautical engineers will instrument wind tunnels to measure airfoil performance and entire airplanes for fly-by-wire operations. Bio-engineers will use computed tomography (CT) scans, electrocardiograms (EKGs), magnetic resonance imaging (MRI), and all types of imaging to detect and help cure biological functions. Civil engineers will use sensors to measure the performance of bridges and structures. Systems engineers will measure product flow and control of operations. In general, the outputs of transducers, images, and sensors are converted from continuous electrical signals to digital signals and processed using computers.
        

          In this textbook, we are primarily interested in
          linear circuits.
          An important feature of a linear circuit is that the amplitude of the output signal is proportional to the input signal amplitude. The proportionality property of linear circuits greatly simplifies the process of circuit analysis and design. Most circuits are linear only within a restricted range of signal levels. When driven outside this range, they become nonlinear, and proportionality no longer applies. Although we will treat a few examples of nonlinear circuits, our attention is focused on circuits operating within their linear range.
        

          Our study also deals with interface circuits. For the purposes of this book, we define an
          interface
          as a pair of accessible terminals at which signals may be observed or specified. The interface idea is particularly important with integrated circuit (IC) technology. Integrated circuits involve many thousands, indeed millions, of interconnections, but only a small number are accessible to the user. Designing systems using integrated circuits involves interconnecting complex circuits that have only a few accessible terminals. This often includes relatively simple circuits whose purpose is to change signal levels or formats. Such interface circuits are intentionally introduced to ensure that the appropriate signal conditions exist at the connections between complex integrated circuits.
        
Today's engineers analyze and design circuits using software tools. Using mathematical analysis tools such as MATLAB, MathCad, and Mathematica as well as circuit simulation tools such as National Instrument's NI Multisim (Electronic Workbench) and Cadence (OrCAD), engineers can improve their understanding and results. As you proceed through this textbook, we help you develop the software skills necessary to become practiced in linear circuit design. Although there are many different software programs that you can use effectively to develop these skills, we will concentrate on MATLAB and Multisim, and to a lesser extent, Excel.



            Course Objectives
          

            This book is designed to help you develop the knowledge and application skills needed to solve three types of circuit problems: analysis, design, and evaluation. An
            analysis
            problem involves finding the output signals of a given circuit with known input signals. Circuit analysis is the foundation for understanding the interaction of signals and circuits. A
            design
            problem involves devising one or more circuits that perform a given signal-processing function. Usually, there are several possible solutions to a design problem. This leads to an
            evaluation
            problem, which involves picking the best solution from among several candidates using factors such as cost, power consumption, and part counts. In real life, the engineer's role is a blend of analysis, design, and evaluation, and in practice, the boundaries between these categories are often blurred.
          

            This textbook contains many worked examples to help you develop your problemsolving skills. The
            examples
            include a problem statement and provide the intermediate steps needed to obtain the final answer. The examples often treat analysis problems, although design and evaluation examples are included. This text also contains a number of
            exercises
            that include only the problem statement and the final answer. You should use the exercises to test your understanding of the circuit concepts discussed in the preceding section. Solutions to all Exercises are available in Appendix E.
          

            Throughout we will show you where it is useful to turn to software to help solve problems, be they analysis, design, or evaluation. The computer icon
            
            identifies examples, exercises, and problems that are best solved using software tools.
          


Chapter Objectives
At the start of each chapter, we provide three motivational aspects for what you are about to learn. First, we present a brief perspective of a key historical figure important to the content of the chapter. Second, we give an overview of why this chapter is important to your study. Third, we introduce you to the learning objectives for the chapter.

            The
            chapter learning objectives
            are a carefully structured set of enabling skills. They are introduced in the chapter opener and repeated in more detail at the end of each chapter. Collectively, these objectives represent the basic knowledge and understanding needed to master the topics covered in each chapter. In the problems section, the objectives explicitly state the expected behavior, followed by a graduated set of homework problems designed to help you assess your level of achievement. Each objective also lists worked examples and exercises in the text that help you work the related homework problems. Once you understand the chapter learning objectives, you can move on to the
            integrating problems
            at the very end of the problems section. These problems require mastery of several chapter learning objectives from the present and prior chapters and provide an opportunity to test your ability to deal with comprehensive, integrative problems. Throughout the text, when appropriate, we label the primary purpose of the example, exercise, course-learning problem, or chapter-integrating problem with the symbol
            
            for analysis,
            
            for design, or
            
            for evaluation.
          


Summary
At the end of each chapter, a summary of the salient points discussed in the chapter serves as a review of what was most important.


Assessment and Accreditation

            Material in this textbook can be used effectively in a properly designed course to support ABET accreditation criteria associated with comprehension, use of modern
            
            tools, design, evaluation, and real-world constraints. Additional accreditation and assessment guidance is provided in the Instructors Manual.
          



1-2 Symbols and Units
Throughout this textbook, we will use the international system (SI) of units. The SI system includes six fundamental units: meter (m), kilogram (kg), second (s), ampere (A), kelvin (K), and candela (cd). All the other units of measure can be derived from these six.

          Like all disciplines, electrical engineering has its own terminology and symbology. The symbols used to represent some of the more important physical quantities and their units are listed in
          Table 1-1
          . It is not our purpose to define these quantities here or to offer this list as an item for memorization. Rather, the purpose of this table is merely to list in one place all the electrical quantities used in this book.
        

          Numerical values in engineering range over many orders of magnitude. Consequently, the system of standard decimal prefixes in
          Table 1-2
          is used. These prefixes on a unit abbreviation symbol indicate the power of 10 that is applied to the numerical value of the quantity.
        

          Both tables are reproduced in
          Appendix G
          STANDARD VALUES AND REFERENCES.
          








Table
                      1-1
                    

Some Important Quantities, Their Symbols, and Unit Abbreviations








Q
uantity


S
ymbol


U
nit


U
nit
A
bbreviation





Time

t

second
s


Frequency (cyclic or natural)

f

hertz
Hz


Radian frequency
ω
radian/second
rad/s


Phase angle
θ, ϕ
degree or radian
° or rad


Energy

w

joule
J


Power

p

watt
W


Charge

q

coulomb
C


Current

i

ampere
A


Electric field



volt/meter
V/m


Voltage

v, v

volt
V


Impedance

Z

ohm
Ω


Admittance

Y

siemens
S


Resistance

R

ohm
Ω


Conductance

G

siemens
S


Reactance

X

ohm
Ω


Susceptance

B

siemens
S


Inductance, self

L

henry
H


Inductance, mutual

M

henry
H


Capacitance

C

farad
F


Magnetic flux
ϕ
weber
Wb


Flux linkages
λ
weber-turns
Wb-t


Power ratio


                    PR
                    dB


bel
B












                        T
                        able

                      1-2
                    


Standard Decimal Prefixes









M
ultiplier


P
refix


A
bbreviation






                  10
                  21

zetta

Z




                  10
                  18

exa
E



                  10
                  15

peta
P



                  10
                  12

tera
T



                  10
                  9

giga
G



                  10
                  6

mega
M



                  10
                  3

kilo
k



                  10
                  -1

deci
d



                  10
                  -2

centi
c



                  10
                  -3

milli
m



                  10
                  -6

micro
µ



                  10
                  -9

nano
n



                  10
                  -12

pico
p



                  10
                  -15

femto
f



                  10
                  -18

atto
a



                  10
                  -21

zepto
z











Exercise 1-1



              Given the pattern in the statement 1 kΩ = 1 kilohm = 1 × 10
              3
              ohms, fill in the blanks in the following statements using the standard decimal prefixes.
            

 
                (a)  ______ = _______ = 7×10  
                -6   
                amperes  
              
(b)  20.0 dB = _______ = ______
(c)  3.6 ms = _______ = ______
(d)  ______ = 30 picofarads = ______
 
                (e)  ______ = ______ = 50 × 10 
                9   
                hertz 
              


Answers:


(a)  7.0 µA = 7 microamperes
(b)  20.0 decibels = 2 bels
 
                (c)  3.6 milliseconds = 3.6 × 10    
                -3 
                seconds    
              
    
                (d)  30 pF = 30.0 × 10  
                -12   
                farads 
              
(e)  50.0 GHz = 50 gigahertz








1-3 Circuit Variables

          The underlying physical variables in the study of electronic systems are
          charge
          and
          energy.
          The idea of electrical charge explains the very strong electrical forces that occur in nature. To explain both attraction and repulsion, we say that there are two kinds of charge — positive and negative. Like charges repel, whereas unlike charges attract each other. The symbol
          q
          is used to represent charge. If the amount of charge is varying with time, we emphasize the fact by writing
          q
          as a function of
          t
          or
          q
          (
          t
          ). In the SI system, charge is measured in
          coulombs
          (abbreviated C). The smallest quantity of charge in nature is an electron's charge (q
          
E

          = - 1.6 × 10
          -19
          C). Thus, there are 1/|
          q
E
          | =6.25 × 10
          18
          electrons in 1 coulomb of charge.
        


          Electrical charge is a rather cumbersome variable to measure in practice. Moreover, in most situations, the charges are moving, so we find it more convenient to measure the amount of charge passing a given point per unit time. If
          q
          (
          t
          ) is the cumulative charge passing through a point, we define a signal variable
          i
          called
          current
          as follows:
        



(1-1)





          Current is a measure of the flow of electrical charge. It is the time rate of change of charge passing a given point in a circuit. The physical dimensions of current are coulombs per second. In the SI system, the unit of current is the
          ampere
          (abbreviated A). That is,
        



Since there are two types of electrical charge (positive and negative), there is a bookkeeping problem associated with the direction assigned to the current. In engineering, it is customary to define the direction of current as the direction of the net flow of positive charge. Since electrons have negative charge, they move in the opposite direction of the current.

          A second signal variable called
          
            voltage (
            v
            )
          
          is related to the change in energy that would be experienced by a charge as it passes through a circuit. The symbol
          w
          is commonly used to represent energy. In the SI system of units, energy carries the units of
          joules
          (abbreviated J). If a small charge
          dq
          were to experience a change in energy
          dw
          in passing from point A to point B in a circuit, then the voltage
          v
          between A and B is defined as the change in energy per unit charge. We can express this definition in differential form as
        



(1-2)





          Voltage does not depend on the path followed by the charge
          dq
          in moving from point A to point B. Furthermore, there can be a voltage between two points even if there is no charge motion, since voltage is a measure of how much energy
          dw
          would be involved if a charge
          dq
          was moved. The dimensions of voltage are joules per coulomb. The unit of voltage in the SI system is the
          volt

1

          (abbreviated V). That is,
        




          The third circuit variable
          p
          is called
          power.
          Power is defined as the time rate of change of energy.
        



(1-3)





          The dimensions of power are joules per second, which in the SI system is called a
          watt

2

          (abbreviated W). In electrical circuits, it is useful to relate the power associated with a device or element to the signal variables current and voltage. Using the chain rule,
          Eq. (1-3)
          can be written as
        


(1-4)




          Now using
          Eqs. (1-1)
          and
          (1-2)
          , we obtain
        


(1-5)





          The electrical power associated with a situation is determined by the product of voltage and current. The total energy
          w
T
          transferred during the period from
          t
1
          to
          t
2
          is found by solving for
          dw
          in
          Eq. (1-3)
          and then integrating
        


(1-6)



In sum, the three key circuit variables—current, voltage, and power—are measured as follows: current at individual points, voltage always between two points, and power at an element or device.












                    APPLICATION
                    EXAMPLE 1-1


For nearly a century, visual displays of alternating signals on televisions, oscilloscopes, radar screens, and so on were seen using a cathode ray tube or CRT. In Europe, it was called the Braun tube named after its German inventor Ferdinand Braun in 1897. However, it was J. J. Thomson, an English physicist, who was able to show how to deflect cathode rays, a fundamental function of the modern CRT. In its basic operation, an electron beam is produced from a heated filament connected to a negative voltage called the cathode. These energized electrons are then accelerated by a positive voltage, placed at a screen called the anode that is located some distance away inside an evacuated container, usually made of glass, called a vacuum tube. These electrons pass through the anode and strike a phosphorescent screen exciting the phosphor and producing light at the spot they strike. Another voltage placed across the neck of the CRT can cause the beam to be deflected in proportion to the signal applied, thereby allowing the signal to be visualized. Today, scanned beams are still used for ion implantation in the manufacture of integrated circuits.

                  Consider the simplified diagram of a CRT shown in
                  Figure 1-1
                  . If the electron beam carries 10
                  14
                  electrons per second and is accelerated by a voltage of 50 kV, find the power in the beam.
                








FIGURE 1-1














SOLUTION:



              Since current is the rate of positive charge flow, its direction is opposite that of the electron beam, as shown in
              Figure 1-1
              . The electrons are flowing to the right from the cathode toward the anode, but the current
              i
              is flowing to the left toward the cathode. We can find the magnitude of the current by multiplying the magnitude of the charge of an electron
              q
E
              by the rate of electron flow
              dn
E
              /
              dt.




Therefore, the beam power is


■



















                  EXAMPLE 1-2
                

                  The current through a circuit element is 50 mA. Find the total charge and the number of electrons transferred during a period of 100 ns or 10
                  -7
                  s.
                







SOLUTION:



              The relationship between current and charge is given in
              Eq. (1-1)
              as
            




              Since the current
              i
              is given, we calculate the charge transferred
              q
T
              by solving this equation for
              dq
              and then integrating
            




              There are 1/|
              q
E
              | =6.25 × 10
              18
              electrons/coulomb, so the number of electrons transferred is
            


■














FIGURE 1-2














Exercise 1-2


A device dissipates 100 W of power. How much energy is delivered to it in 10 seconds?
Answers:
1 kJ



Note:


              1 W-s = 1 J
            












Exercise 1-3


              The graph in
              Figure 1-2(a)
              shows the charge
              q
              (
              t
              ) flowing past a point in a wire as a function of time.
            


                (a)  Find the current
                i
                (
                t
                ) at
                t
                = 1, 2.5, 3.5, 4.5, and 5.5 ms.
              

                (b)  Sketch the variation of
                i
                (
                t
                ) versus time.
              


Answers:


(a)  -10 nA, + 40 nA, 0 nA, -20 nA, 0 nA

                (b)  The variations in
                i
                (
                t
                ) are shown in
                Figure 1-2(b)
                .
              







The Passive Sign Convention

            We have defined three circuit variables (current, voltage, and power) using two basic variables (charge and energy). Charge and energy, like mass, length, and time, are basic concepts of physics that provide the scientific foundation for electrical engineering. However, engineering problems rarely involve charge and energy directly, but are usually stated in terms of voltage, current, and power. The reason for this is
            
            simple: The circuit variables are much easier to measure and therefore are the most useful working variables in engineering practice.
          

            At this point, it is important to stress the physical differences between current and voltage variables. Current is a measure of the time rate of charge passing a point in a circuit. We think of current as a
            through variable,
            since it describes the flow of electrical charge through a point in a circuit. On the other hand, voltage is not measured at a single point, but rather between two points or across an electrical device. Consequently, we think of voltage as an
            across variable
            that inherently involves two points.
          








FIGURE 1-3




Voltage and current reference marks for a two-terminal device.




            The arrow below the
            i
            (
            t
            ) and the plus and minus symbols across the
            v
            (
            t
            ) in
            Figure 1-3
            are
            reference marks
            that define the positive directions for the current and voltage associated with an electrical device. These reference marks do not represent an assertion about what is happening physically in the circuit. The response of an electrical circuit is determined by physical laws, not by the reference marks assigned to the circuit variables.
          

            The reference marks are benchmarks assigned at the beginning of the analysis. When the actual direction and reference direction agree, the answers found by circuit analysis will have positive algebraic signs. When they disagree, the algebraic signs of the answers will be negative. For example, if circuit analysis reveals that the current variable in
            Figure 1-3
            is positive [i.e.,
            i
            (
            t
            ) > 0], then the sign of this answer, together with the assigned reference direction, indicates that the current passes through point A in
            Figure 1-3
            from left to right. Conversely, when analysis reveals that the current variable is negative, then this result, combined with the assigned reference direction, tells us that the current passes through point A from right to left. In summary, the algebraic sign of the answer together with arbitrarily assigned reference marks tells us the actual directions of a voltage or current variable.
          

            In
            Figure 1-3
            , the current reference arrow enters the device at the terminal marked with the plus voltage reference mark. This orientation is called the
            passive sign convention.
            Under this convention, the power
            p
            (
            t
            ) is positive when the device absorbs power and is negative when it delivers power to the rest of the circuit. Since
            p
            (
            t
            ) =
            v
            (
            t
            ) ×
            i
            (
            t
            ), a device absorbs power when the voltage and current variables have the same algebraic sign and delivers power when they have opposite signs. Certain devices, such as heaters (a toaster, for example), can only absorb power. The voltage and current variables associated with these devices must always have the same algebraic sign. On the other hand, a battery absorbs power [
            p
            (
            t
            ) > 0] when it is being charged and delivers power [
            p
            (
            t
            ) < 0] when it is discharging. Thus, the voltage and current variables for a battery can have either the same or opposite algebraic signs.
          
In a circuit, some devices absorb power and others deliver power, but the sum of the power in all of the devices in the circuit is zero. This is more than just a conservation-of-energy concept. When electrical devices are interconnected to form a circuit, the only way that power can enter or leave the circuit is via the currents and voltages at device terminals. The existence of a power balance in a circuit is one method of checking calculations.

            The passive sign convention is used throughout this book. It is also the convention used by circuit simulation computer programs.
            
3

            To interpret correctly the results of circuit analysis, it is important to remember that the reference marks (arrows and plus/minus signs) are reference directions, not indications of the circuit response. The actual direction of a response is determined by comparing its reference direction
            
            with the algebraic signs of the result predicted by circuit analysis based on physical laws.
          


Ground

            Since voltage is defined between two points, it is often useful to define a common voltage reference point called
            ground.
            The voltages at all other points in a circuit are then defined with respect to this common reference point. We indicate the voltage reference point using the ground symbol G shown in
            Figure 1-4
            . Under this convention, we sometimes refer to the variables
            v
A
            (
            t
            ),
            v
B
            (
            t
            ), and
            v
C
            (
            t
            ) as the voltages at points A, B, and C, respectively. This terminology appears to contradict the fact that voltage is an across variable that involves two points. However, the terminology means that the variables
            v
A
            (
            t
            ),
            v
B
            (
            t
            ), and
            v
C
            (
            t
            ) are the voltages defined between points A, B, and C
            and
            the common voltage reference point at point G.
          








FIGURE 1-4




Ground symbol indicates a common voltage reference point.




            Using a common reference point for across variables is not an idea unique to electrical circuits. For example, the elevation of a mountain is the number of feet or meters between the top of the mountain and a common reference point at sea level. If a geographic point lies below sea level, then its elevation is assigned a negative algebraic sign. So it is with voltages. If circuit analysis reveals that the voltage variable at point A is negative [i.e.,
            v
A
            (
            t
            ) < 0], then this fact together with the reference marks in
            Figure 1-4
            indicates that the potential at point A is less than the ground potential.
          








FIGURE 1-5



















EXAMPLE 1-3



Figure 1-5
                    shows a circuit formed by interconnecting five devices, each of which has two terminals. A voltage and current variable has been assigned to each device using the passive sign convention. The working variables for each device are observed to be as follows:
                  





D
evice
                          1
                        

D
evice
                          2
                        

D
evice
                          3
                        

D
evice
                          4
                        

D
evice
                          5
                        





v

+ 100 V
?
+ 25 V
+ 75 V
-75 V



i

?
+ 5 mA
+5 mA
?
+5 mA



p

- 1 W
+ 0.5 W
?
+ 0.75 W
?




(a)  Find the missing variable for each device and state whether the device is absorbing or delivering power.
(b)  Check your work by showing that the sum of the device powers is zero.








SOLUTION:




                  (a)  We use
                  p
                  =
                  vi
                  to solve for the missing variable since two of the three circuit variables are given for each device.
                  


                        Device 1 :
                        i
1
                        =
                        p
1
                        /
                        v
1
                        = -1/100 = -10 mA [
                        p
                        (
                        t
                        ) < 0, delivering power]
                      



                        Device 2 :
                        v
2
                        =
                        p
2
                        /
                        i
2
                        = 0.5/0.005 = 100 V [
                        p
                        (
                        t
                        ) > 0, absorbing power]
                      



                        Device 3 :
                        p
3
                        =
                        v
3
i
3
                        = 25 × 0005 = 0.125 W [
                        p
                        (
                        t
                        ) > 0, absorbing power]
                      



                        Device 4 :
                        i
4
                        =
                        p
4
                        /
                        v
4
                        = 0.75/75 = 10 mA [
                        p
                        (
                        t
                        ) > 0, absorbing power]
                      



                        Device 5 :
                        p
5
                        =
                        u
5
i
5
                        = -75 × 0.005 = -0.375 W [
                        p
                        (
                        t
                        ) < 0, delivering power]
                        





                  (b)  Summing the device powers yields
                  





                        This example shows that the sum of the powers absorbed by devices is equal in magnitude to the sum of the powers supplied by devices. A power balance always exists in the types of circuits treated in this book and can be used as an overall check of circuit analysis calculations.
                        ■


















Exercise 1-4


The working variables of a set of two-terminal electrical devices are observed to be as follows:






d
                        evice
                      
                      1
                    


d
                        evice
                      
                      2
                    


d
                        evice
                      
                      3
                    


d
                        evice
                      
                      4
                    


d
                        evice
                      
                      5
                    





v

+ 10 V
?
- 15 V
+ 5 V
?



i

- 3 A
- 3 A
+ 10 mA
?
- 12 mA



p

?
+ 40 W
?
+ 10 mW
- 120 mW



Using the passive sign convention, find the magnitude and sign of each unknown variable and state whether the device is absorbing or delivering power.

Answers:


                Device 1:
                p
                = - 30 W (delivering power); Device 2:
                v
                = - 13.3 V (absorbing power); Device 3:
                p
                = - 150 mW (delivering power); Device 4:
                i
                = +2mA (absorbing power); Device 5:
                v
                = +10 V (delivering power)
              








1-4 Computational and Simulation Software Introduction
The problems presented in this chapter are relatively straightforward and are solvable with simple hand calculations or by using a scientific or engineering calculator. As we increase our knowledge of electrical devices, their properties, and the circuits created by connecting them together, the nature of the associated problems will become more difficult. To solve these problems, tools that are more sophisticated are required. Extremely valuable tools for electrical and computer engineers are computational and simulation software that can perform all of the mathematical calculations associated with a problem and displays the results in several ways that assist in the analysis and design of circuits. To have a complete education, an engineer must be familiar with the contemporary software tools common to the profession. Although there are many competitive choices available, a common tool in engineering for mathematical computations is MATLAB, created by The MathWorks, Inc., and one for simulation is NI Multisim by National Instruments.

          We introduce MATLAB as an efficient, programmable tool to perform calculations associated with engineering problems. This software is well established in the industry and has complete documentation to support users, ranging from novices to experts. As with any new tool, it requires an investment of time and effort to learn how to apply it correctly and efficiently. This investment will pay off in the end by
          
          offering the following advantages that come from using and mastering the MATLAB software:
        

Calculating results faster with higher accuracy
Performing simulations efficiently
Solving more complex problems
Examining many design options quickly
Visualizing results professionally


          Similarly, we introduce Multisim in
          Section 2-7
          as a method to graphically draw circuits and have the software analyze the circuit in several ways. Like MATLAB, learning Multisim requires a bit of effort, but the end results are a quick way to study the behavior of the circuits in question. Simulation software offers the following advantages:
        

Rapid analysis of circuit variables, such as voltage, current, and power
Validation of circuit designs
Ability to modify designs quickly and accurately to explore and evaluate many possible solutions
Producing visible graphical results of desired analyses


Appendix D
          offers a brief introduction to using the MATLAB and Multisim software for engineering problems and provides worked examples for key topics in each chapter. Combined with the help files and tutorials available with each software package, the appendix provides a starting point of where to find applications of these powerful computational or simulation tools. Mastering each tool will require significant practice and experience. To provide opportunities to practice and additional exposure to these software products, every chapter in this book will demonstrate specific features of the appropriate software and how they can be applied to efficiently solve electrical engineering problems. In addition, selected problems at the end of each chapter specifically request solutions using MATLAB or Multisim to reinforce the important features of the software in a deliberate, developmental manner. Whenever an Example, Exercise, or Problem uses or recommends the use of software in its solution, the computer icon
          
          will be displayed.
        


Summary


            Circuits are important in electrical engineering because they process signals that carry energy and information. A
            circuit
            is an interconnection of electrical devices. A
            signal
            is an electrical current or voltage that carries energy or information. An
            interface
            is a pair of accessible terminals at which signals may be observed or specified.
          

            This book defines overall course objectives at the analysis, design, and evaluation levels. In
            circuit analysis,
            the circuit and input signals are given and the object is to find the output signals. The object of
            circuit design
            is to devise one or more circuits that produce prescribed output signals for given input signals. The
            evaluation
            problem involves appraising alternative circuit designs using criteria such as cost, power consumption, and parts count.
          

            Charge (
            q
            ) and energy (
            w
            ) are the basic physical variables involved in electrical phenomena. Current (
            i
            ), voltage (
            v
            ), and power (
            p
            ) are the derived variables used in circuit analysis and design. In the SI system, charge is measured in coulombs (C), energy in joules (J), current in amperes (A), voltage in volts (V), and power in watts (W).
          

Current
            is defined as
            dq/dt
            and is a measure of the flow of electrical charge.
            Voltage
            is defined as
            dw/dq
            and is a measure of the energy required to move a small charge from one point to another.
            Power
            is defined as
            dw/dt
            and is a measure of the rate at which energy is being transferred. Power is related to current and voltage as
            p
            =
            vi
            .
          

            The
            reference marks
            (arrows and plus/minus signs) assigned to a device are reference directions, not
            
            indications of the way a circuit responds. The actual direction of the response is determined by comparing the reference direction and the algebraic sign of the answer found by circuit analysis using physical laws.
          

            Under the
            passive sign convention,
            the current reference arrow is directed toward the terminal with the positive voltage reference mark. Under this convention, the device power is positive when it absorbs power and is negative when it delivers power. When current and voltage have the same (opposite) algebraic signs, the device is absorbing (delivering) power.
          
Engineers use computational software, such as MATLAB, to increase the speed and accuracy of calculations. Engineers use simulation software, such as Multisim, to model the behavior of circuits. Software is useful for performing circuit simulations and for expanding the complexity of problems that can be solved in a reasonable amount of time. Learning and exploiting the advantages of computational and simulation software are critical skills for engineers, and MATLAB and Multisim are common tools for electrical and computer engineers.




            Chapter 1 Problems
          

            Problems with answers are indicated by
            
            and are found in
            Appendix H
            .
          






                Objective 1-1 Electrical Symbols and Units (
                Sect. 1-2
                )
              
Given an electrical quantity described in terms of words, scientific notation, or decimal prefix notation, convert the quantity to an alternate description.

                See
                Exercise 1-1
                .
              








1-1
              Express the following quantities to the nearest standard prefix using no more than three digits.
              

(a)
                  3600 s
                

(b)
                  5 × 10
                  13
                  W
                

(c)
                  850,000 Hz
                

(d)
                  68 × 10
                  -12
                  F
                



1-2
              Express the following quantities to the nearest standard prefix using no more than three digits.
              

(a)
                  0.00067 A
                

(b)
                  5.67 × 10
                  -3
                  H
                

(c)
                  1,850,000 C
                

(d)
                  33,330 Ω
                




1-3
              An ampere-hour (Ah) meter measures the time integral of the current in a conductor. During an 8-hour period, a certain meter records 5400 Ah. Find the number of coulombs that flowed through the meter during the recording period.
            

1-4
              Fill in the blanks in the following statements.
              

(a)
                  To convert capacitance from femtofarads to microfarads, multiply by _______.
                

(b)
                  To convert resistance from megohms to kilohms, multiply by _______.
                

(c)
                  To convert voltage from millivolts to volts, multiply by _______.
                

(d)
                  To convert frequency from kilohertz to gigahertz, multiply by _______.
                





                1-5
              
              Place in increasing value the following:
              

(a)
                  1500 mΩ
                

(b)
                  0.1632 Ω
                

(c)
                  0.00112 kΩ
                

(d)
                  0.0000016 MΩ
                









                Objective 1-2 Circuit Variables (
                Sect. 1-3
                )
              

                Given any two of the three signal variables (
                i
                ,
                v
                ,
                p
                ) or the two basic variables (
                q
                ,
                w
                ), find the magnitude and direction (sign) of the unspecified variables.
              

                See
                Examples 1-1
                to
                1-3
                and
                Exercises 1-2
                to
                1-4
                .
              







1-6
              The net positive charge flowing through a device is
              q
              (
              t
              ) = 20 + 4
              t
              mC. Find the current through the device.
            


1-7
Figure P1-7
              shows a plot of the net positive charge flowing in a wire versus time. Sketch the corresponding current during the same period of time.
            









FIGURE P1-7









1-8
              The net negative charge flowing through a device varies as
              q
              (
              t
              ) =5.0
              t
2
              C. Find the current through the device at
              t
              = 0, 1.0, and 2.0 s.
            


1-9
              The charge flowing through a device is
              q
              (
              t
              ) = 1-
              
                e
                -


                1000
                t

µ
              C. What will the current be after 1.6094 ms?
            

1-10
              The 12-V automobile battery in
              Figure P1-10
              has an output capacity of 100 Ah when connected to a head lamp that absorbs 200 W of power. The car engine is not running and therefore not charging the battery. Assume the battery voltage remains constant.
              

(a)
                  Find the current supplied by the battery and determine how long can the battery power the headlight.
                

(b)
                  A 100-W device is connected through the utility port. How long can the battery power both the headlight and the device?
                











FIGURE P1-10










1-11
              The current through a device is zero for
              t
              < 0 and is
              i
              (
              t
              ) =5
              
                e
                -


                3
                t

              A for
              t
              ≥ 0. Find the charge
              q
              (
              t
              ) flowing through the device for
              t
              ≥ 0.
            

1-12
              When illuminated the
              i-v
              relationship for a photocell is
              i
              =
              
                e
                v
                -
              
              10 A. For
              v
              = -2, 1, and 2.5 V, find the device power and state whether it is absorbing or delivering power.
            


1-13
              The maximum current allowed by a device's power rating is limited by a 10-mA fuse. When the device is connected to a 5-V source, what is the maximum power the device can dissipate?
            


1-14
              Traffic lights are being converted from incandescent bulbs to LED arrays to save operating and maintenance costs. Typically, each incandescent light uses three 116-W bulbs, one for each color R, Y, and G. A competing LED array consists of 106 LEDs with each LED requiring 12 V and drawing 80 mA of current. There are three arrays per light, namely R, Y, and G (
              Figure P1-14
              ). A small city has 2560 traffic signals. Since one light is always on 24/7, how much can the city save in one year if the city buys their electricity at 11.2 cents/kWh?
            









FIGURE P1-14










1-15
              Two electrical devices are connected as shown in
              Figure P1-15
              . Using the reference marks shown in the figure, find the power transferred and state whether the power is transferred from A to B or B to A when
              

(a)
v
                  = +12 V and
                  i
                  = - 1.2 A
                

(b)
v
                  = +80V and
                  i
                  = +10 mA
                

(c)
v
                  = -240V and
                  i
                  = - 12 mA
                

(d)
v
                  = -15 V and
                  i
                  = - 300 µA
                











FIGURE P1-15










1-16
Figure P1-16
                shows an electric circuit with a voltage and a current variable assigned to each of the six devices. The device voltages and currents are observed to be as follows:
              





v
                      (V)
                    

i
                      (A)
                    


v
                      (V)
                    

i
                      (A)
                    




Device 1
15
-1
Device 4
-10
-1


Device 2
5
1
Device 5
20
-3


Device 3
10
2
Device 6
20
2



Find the power associated with each device and state whether the device is absorbing or delivering power. Use the power balance to check your work.










FIGURE P1-16










1-17
Figure P1-16
              shows an electric circuit with a voltage and a current variable assigned to each of the six devices. Use power balance to find
              v
4
              when
              v
1
              =24 V,
              i
1
              = - 2.1A,
              p
2
              = 30 W,
              p
3
              = 10 W,
              i
4
              = 1.07 A, and
              p
5
              =
              p
6
              =2.5 W. Is device 4 absorbing or delivering power?
            

1-18
              An ion implanter is used to accelerate electrons to crash into a silicon wafer to study the effects of electron radiation damage on the devices on the wafer. If the beam carries 10
              16
              electrons per second and is accelerated by a 350 kV source, find the current and power in the beam.
            







                Objective 1-3 Software Introduction (
                Sect. 1-4
                ,
                Appendix D
                )
              

                Given a simple computational problem, use MATLAB as an appropriate engineering tool to solve the problem. (We will introduce Multisim problems starting in
                Chapter 2
                .)
              

                Examples and Exercises throughout the text. See
                Appendix D
                .
              









1-19
              Repeat Problem 1-16 using MATLAB to perform the calculations. Create a vector for the voltage values,
              
v
                = [15 5 10-10 20 20]
              
              , and a vector for the current values,
              
i
                = [-1 1 2 -1 -3 2]
              
              . Compute the corresponding vector for the power values,
              p,
              using element-by-element multiplication (.*) and then use the sum command to verify the power balance.
            



Integrating Problems


              1-20
              
              Power Ratio (
              PR
              ) in dB
              
              A stereo amplifier takes the output of a CD player, for example, and increases the power to an audible level. Suppose the output of the CD player is 25 mW and the desired audible output is 100 W per stereo channel, find the power ratio of the amplifier per channel in decibels (dB), where the power ratio in dB is
            







1-21

              AC to DC Converter
              
              A manufacturer's data sheet for the converter in
              Figure P1-21
              states that the output voltage is
              v
dc
              = 12 V when the input voltage
              v
ac
              = 120 V. When the load draws a current
              i
dc
              = 18 A, the input power is
              p
ac
              = 360 W. Find the efficiency η =
              p
out
              /
              p
in
              of the converter.
            









FIGURE P1-21









1-22

              Charge-Storage Device
              
              A capacitor is a two-terminal device that can store electric charge. In a linear capacitor, the amount of charge stored is proportional to the voltage across the device. For a particular device the proportionality is
              q
              (
              t
              ) = 10
              -7
v
              (
              t
              ). If
              v
              (
              t
              ) = 0 for
              t
              < 0 and
              v
              (
              t
              ) = 10(1 - e-
              
                5000
                t

              ) for
              t
              ≥ 0, find the energy stored in the device at
              t
              = 100 µs.
            

1-23

              Light Source Decision
              
              You need to provide sufficient light for a work area, and you determine that 1600 lumens would be adequate. You discover that there are four competing light sources that can deliver that amount of light: a 100 W incandescent bulb, a 100 W halogen bulb, a 32 W compact fluorescent lamp (CFL), and a 16.5 W light-emitting diode (LED) lamp. Each has advantages and disadvantages. You build the following table to help you make a decision. Considering the overall cost over the stated lifetime of each light source, which would you recommend if electricity costs 12 cents/kWh?
            





B

                    ulb
                    t
                    ype
                  


C

                    ost per
                    l
                    amp
                  


P

                    ower
                    u
                    sed
                  


A

                    verage
                    l
                    ifetime
                  





Incandescent
$2.50
100 W
2500 hr


Halogen
$5.25
100 W
3,000 hr


CFL
$14.00
32 W
10,000 hr


LED
$9.00
16.5 W
25,000 hr





1-24

              Ground Selection
              
              A circuit consists of five voltages, namely,
              v
a
              ,
              v
b
              ,
              v
c
              ,
              v
d
              , and
              v
e
              . The voltage from
              v
a
              to
              v
b
              is -5 V, from
              v
b
              to
              v
c
              is 10 V, from
              v
a
              to
              v
e
              is -2 V, and from
              v
b
              to
              v
d
              is 8 V.
              

(a)
                  If one wanted to eliminate negative voltages, which voltage would be best to select as ground?
                

(b)
                  What would all the remaining voltages be with your ground selection?
                






Notes




1

                The volt is named after the Italian physicist, Alessandro Volta (1745-1827), for the discovery of a practical source of current—the battery.
              


2

                The watt is named after the Scottish inventor and mechanical engineer, James Watt (1736-1819), who is credited for inventing the steam engine and enabling the Industrial Revolution.
              


3

                We discuss computer-aided circuit analysis in
                Sections 1-4
                and
                2-7
                .
              

















CHAPTER 2

BASIC CIRCUIT ANALYSIS




The equation S=A/L shows that the current of a voltaic circuit is subject to a change, by each variation originating either in the magnitude of a tension or in the reduced length of a part, which latter is itself again determined, both by the actual length of the part as well as its conductivity and its section.


            Georg Simon Ohm, 1827,
            
            German Mathematician/Physicist
          









Some History Behind This Chapter
Georg Simon Ohm (1789-1854) discovered the law that now bears his name in 1827. His results drew heavy criticism and were not generally accepted for many years. Fortunately, the importance of his contribution was eventually recognized during his lifetime. He was honored by the Royal Society of England in 1841 and appointed a Professor of Physics at the University of Munich in 1849. The unit of resistance was named after Professor Ohm in 1862 by the British Association Committee.








Why This Chapter Is Important Today
A circuit is an interconnection of electric devices that performs a useful function. This chapter introduces some basic tools you will need to analyze and design electric circuits. You will also be introduced to several important electric devices that control currents and voltages in a circuit. These devices range from everyday things like batteries to special integrated circuits that meter out predetermined voltages or currents.
To analyze these circuits efficiently, we can use computer-based tools, such as MATLAB for mathematical computations and Multisim for circuit simulations. These programs are powerful tools that are common in both academic and commercial applications.








Chapter Sections



2-1 Element Constraints






2-2 Connection Constraints






2-3 Combined Constraints






2-4 Equivalent Circuits






2-5 Voltage and Current Division






2-6 Circuit Reduction






2-7 Computer-Aided Circuit Analysis











Chapter Learning Objectives

2-1
              Element Constraints (
              Sect. 2-1
              )
            

              Given a two-terminal element with one or more electrical variables specified, namely
              i
              ,
              v
              , or
              p
              , use the element
              i - v
              constraint to find the magnitude and direction of the unknown variables.
            

2-2
              Connection Constraints (
              Sect. 2-2
              )
            
Given a circuit composed of two-terminal elements:

(a) Identify nodes and loops in the circuit.
(b) Identify elements connected in series and in parallel.
(c) Use Kirchhoff's laws (KCL and KVL) to find selected signal variables.


2-3
              Combined Constraints (
              Sect. 2-3
              )
            
Given a linear resistance circuit, use the element constraints and connection constraints to find selected signal variables.

2-4
              Equivalent Circuits (
              Sect. 2-4
              )
            

(a) Given a circuit consisting of linear resistors, find the equivalent resistance between a specified pair of terminals.
(b) Given a circuit consisting of a source-resistor combination, find an equivalent source-resistor circuit.


2-5
              Voltage and Current Division (
              Sect. 2-5
              )
            

(a) Given a linear resistance circuit with elements connected in series or parallel, use voltage or current division to find specified voltages or currents.
(b) Design a voltage or current divider that delivers specified output signals.


2-6
              Circuit Reduction (
              Sect. 2-6
              )
            
Given a linear resistance circuit, find selected signal variables using successive application of series and parallel equivalence, source transformations, and voltage and current division.

2-7
              Computer-Aided Circuit Analysis (
              Sect. 2-7
              )
            
Given an appropriate linear circuit, use circuit simulation and/or computational software to solve for the desired response.




2-1 Element Constraints


          A
          circuit
          is a collection of interconnected electrical devices. An electrical
          device
          is a component that is treated as a separate entity. The rectangular box in
          Figure 2-1
          is used to represent any one of the two-terminal devices used to form circuits. A two-terminal device is described by its
          
i-v

characteristic,
          that is, by the relationship between the voltage across and current through the device. In most cases, the relationship is complicated and nonlinear, so we use a linear model that approximates the dominant features of a device.
        








FIGURE 2-1



Voltage and current reference marks for a two-terminal device.





          To distinguish between a device (the real thing) and its model (an approximate stand-in), we call the model a circuit
          element.
          Thus, a device is an article of hardware described in manufacturers' catalogs and parts specifications. An element is a model described in textbooks on circuit analysis. This book is no exception, and a catalog of circuit elements will be introduced as we go on.
        


The Linear Resistor

          The first element in our catalog is a linear model of the device described in
          Figure 2-2
          . The actual
          i-v
          characteristic of this device is shown in
          Figure 2-2
          (b). To model this curve accurately across the full operating range shown in the figure would require at least a cubic equation. However, the graph in
          Figure 2-2
          (b) shows that a straight line is a good approximation to the
          i-v
          characteristic if we operate the device within its linear range. The power rating of the device limits the range over which the
          i-v
          characteristics can be represented by a straight line through the origin.
        










FIGURE 2-2



The resistor: (a) Circuit symbol. (b) i-v characteristics. (c) Carbon or film resistors. (d) Wire-wound resistors.





          For the passive sign convention used in
          Figure 2-2
          (a), the equations describing the
          linear resistor
          element are
        



(2-1)





          where
          R
          and
          G
          are positive constants that are reciprocally related:
        


(2-2)




          The relationships in
          Eq. (2-1)
          are collectively known as
          Ohm's law.
          The parameter
          R
          is called
          resistance
          and has the unit
          ohms,
          Ω. The parameter
          G
          is called
          conductance,
          with the unit
          siemens,
          S. In earlier times, the unit of conductance was cleverly called the mho, with the unit abbreviation symbol
          
          ("ohm" spelled backward and the ohm symbol upside down). Note that Ohm's law presumes that the passive sign convention is used to assign the reference marks to voltage and current.
        

          The Ohm' s law model is represented graphically by the straight line in
          Figure 2-2
          (b). The
          i-v
          characteristic for the Ohm's law model defines a circuit element that is said to be linear and bilateral.
          Linear
          means that the defining characteristic is a straight line through the origin. Elements whose characteristics do not pass through the origin or are not a straight line are said to be
          nonlinear. Bilateral
          means that the
          i-v
          characteristic curve has odd symmetry about the origin.
          
1

          With a bilateral resistor, reversing the polarity of the applied voltage reverses the direction but not the magnitude of the current, and vice versa. The net result is that we can connect a bilateral resistor into a circuit without regard to which terminal is which. This is
          
          important because devices such as diodes and batteries are not bilateral, and we must carefully identify each terminal.
        

Figure 2-2
          (c) and (d) shows photos of discrete resistor devices.
        

          The power associated with the resistor can be found from
          p
          =
          vi
          . Using
          Eq. (2-1)
          to eliminate
          v
          from this relationship yields
        



(2-3)





          or using the same equations to eliminate
          i
          yields
        



(2-4)





          Since the parameter
          R
          is positive, these equations tell us that the power is always nonnegative. Under the passive sign convention, this means that the resistor
          always absorbs or consumes power.













EXAMPLE 2-1


A 2.2-kΩ resistor has 12 V impressed across its terminals. Find the current through the resistor and the power it dissipates.



SOLUTION:



                By Ohm's law
                i
                =
                v/R.
                Therefore,
                i
                = 12/2200 = 0.00545 = 5.45 mA. The power dissipated is found using
                Eq. (2-3)
p
                =
                i
2
R
                = (0.00545)
                2
                2200 = 65.4 mW, which is the same answer we get if we were to use
                Eq. (2-4)
p
                =
                
                  v
                  2
                  /R
                
                = 12
                2
                /2200 = 65.4 mW or
                Eq. (1-5)
p
                =
                iv
                = 0.00545 × 12 = 65.4 mW.
                ■















Exercise 2-1


A 6-V lantern battery powers a light bulb that draws 3 mA of current. What is the resistance of the lamp? How much power does the lantern use?


Answers:



R
              = 2 kΩ;
              p
              = 18 mW
            













EXAMPLE 2-2
A resistor operates as a linear element as long as the voltage and current are within the limits defined by its power rating. Suppose that we have a 47-kΩ resistor with a power rating of 0.25 W. Determine the maximum current and voltage that can be applied to the resistor and have it remain within its linear operating range.



SOLUTION:



                Using
                Eq. (2-3)
                to relate power and current, we obtain
              




                Similarly, using
                Eq. (2-4)
                to relate power and voltage, we obtain
              




                As a check: (0.00231 A) × (108 V) = 0.2495 W
                ■













Exercise 2-2


              What is the maximum current that can flow through a ⅛-W, 6.8-kΩ resistor? What is the maximum voltage that can be across it?
            


Answers:



i
MAX
              = 4287 mA;
              v
MAX
              = 2915 V
            




Open and Short Circuits

          The next two circuit elements can be thought of as limiting cases of the linear resistor. Consider a resistor
          R
          with a voltage
          v
          applied across it. Let's calculate the current
          i
          through the resistor for different values of resistance. If
          v
          = 10 V and
          R
          = 1Ω, using Ohm's law we readily find that
          i
          = 10 A. If we increase the resistance to 100Ω, we find
          i
          has decreased to 0.1 A or 100 mA. If we continue to increase
          R
          to 1 MΩ,
          i
          becomes a very small 10 µA. Continuing this process, we arrive at a condition where
          R
          is very nearly infinite and
          i
          just about zero. When the current
          i
          = 0, we call the special value of resistance (i.e.,
          R
          = ∞Ω) an
          open circuit.
          Similarly, if we reduce
          R
          until it approaches zero, we find that the voltage is very nearly zero. When
          v
          = 0, we call the special value of resistance (i.e.,
          R
          = 0Ω) a
          short circuit.
          The circuit symbols for these two elements are shown in
          Figure 2-3
          . In circuit analysis, the elements in a circuit model are assumed to be interconnected by zero-resistance wire (that is, by short circuits).
        








FIGURE 2-3



Circuit symbols: (a) Open-circuit symbol. (b) Short-circuit symbol.






Fuses

          A fuse is a safety device that is designed to protect a circuit from too much current. A classic fuse consists of a metal strip with a defined resistance usually mounted between a pair of electrical terminals, and (usually) enclosed by a noncombustible housing, for example, glass. The fuse is arranged in series to carry all the current passing through the protected circuit. The resistance of the element generates heat due to the current flow. The size and construction of the element are designed so that the heat produced for a normal current does not cause the element to attain a high temperature. If too high a current flows, the element rises to a higher temperature and melts, which opens the circuit and stopping the current flow into the circuit. Fuses are rated by the maximum current that can safely pass through them.
          Figure 2-4
          (a) shows the circuit symbol for a fuse, whereas
          Figure 2-4
          (b) shows a photo of a simple fuse as might be used in an electric circuit.
        








FIGURE 2-4









The Ideal Switch

          A switch is a familiar device with many applications in electrical engineering. The
          ideal switch
          can be modeled as a combination open- and short-circuit element.
          Figure 2-5
          (a) and (b) shows the circuit symbol and the
          i-v
          characteristics of an ideal switch. When the switch is open or OFF,
          Figure 2-5
          (a),
        








FIGURE 2-5



The circuit symbol and i-v characteristics of an ideal switch: (a) Switch OFF. (b) Switch ON. (c) Toggle switch. (d) DIP switches. (e) Rocker switch. (f) SPDT switch. (g) DPDT switch.






(2-5a)




          and when it is closed or ON,
          Figure 2-5
          (b),
        



(2-5b)




 
          When the switch is closed, the voltage across the element is zero and the element will pass any current that may result. When open, the current is zero and the element will withstand any voltage across its terminals. The power is always zero for the ideal switch, since the product
          vi  
          = 0 when the switch is either open (   
          i  
          = 0) or closed (   
          u   
          = 0). Actual switch devices have limitations, such as the maximum current they can safely carry when closed and the maximum voltage they can withstand when open. The switch is operated (opened or closed) by some external influence, such as a mechanical motion, temperature, pressure, or an electrical signal.
        


Figure 2-5 
          (c) shows an actual toggle switch, which is simply used to turn things ON and OFF,
          Figure 2-5 
          (d) shows DIP (dual in-line package) switches designed for use on a printed circuit board, and
          Figure 2-5   
          (e) shows a rocker switch. 
        
The ideal switch is also a basic concept in digital circuits, where OFF usually represents a logic 0 state and ON represents a logic 1 state.
  
          Switches come in a variety of types. The one we just studied is called a single pole single throw (SPST), as shown in
          Figure 2-5   
          (a) and (b). Some other common switches are the single pole double throw (SPDT) in
          Figure 2-5
          (f) and the double pole double throw (DPDT) in    
          Figure 2-5  
          (g). In the DPDT switch, one toggle moves both switches together. In
          Figure 2-5    
          (g), both switches move from A to B when the switch is thrown, but one can connect DPDT switches where one switch moves from A to B while the other moves from B to A.
        





    
              APPLICATION  
              EXAMPLE 2-3

   
              The   
              analog switch   
              is an important device found in analog-to-digital interfaces.  
              Figure 2-6
              (a) and (b) shows the two basic versions of the device. In either type, the switch is actuated by applying a voltage to the terminal labeled
              gate.
              The switch in
              Figure 2-6
              (a) is said to be
              normally open
              because it is open when no voltage is applied to the gate terminal and closes when voltage is applied. The switch in
              Figure 2-6
              (b) is said to be
              normally closed
              because it is closed when no voltage is applied to the controlling gate and opens when voltage is applied.
            

Figure 2-6
              (c) shows an application in which complementary analog switches are controlled by the same gate. When gate voltage is applied, the upper switch closes and the lower opens so that point A is connected to point C. Conversely, when no gate voltage is applied, the upper switch opens and the lower switch closes to connect point B to point C. In the analog world, this arrangement is called a double throw switch since point C can be connected to two other points. In the digital world, it is called a two-to-one multiplexer (or MUX) because it allows you to select the analog input at point A or point B under control of the digital signal applied to the gate.
            

              In many applications, an analog switch can be treated as an ideal switch. In other cases, it may be necessary to account for its nonideal characteristics. When the switch is open, an analog switch acts like a very large resistance (
              R
OFF
              ), as suggested in
              Figure 2-6
              (d). This resistance is negligible because it ranges from perhaps 10
              9
              to 10
              11
              Ω. When the switch is closed it acts like a small resistor (
              R
ON
              ), as suggested in
              Figure 2-6
              (e). Depending on other circuit resistances, it may be necessary to account for
              R
ON
              , because it ranges from perhaps a few mΩ to as high as 100 Ω.
            










FIGURE 2-6



The analog switch: (a) Normally open model. (b) Normally closed model. (c) Double throw model. (d) Model with finite OFF resistance. (e) Model with finite ON resistance.






          This example illustrates how ideal switches and resistors can be combined to model another electrical device. It also suggests that no single model can serve in all applications. It is up to the engineer to select a model that adequately represents the actual device in each application.
        


Ideal Sources

          The signal and power sources required for the operation of electronic circuits are modeled using two elements:
          voltage sources
          and
          current sources.
          These sources can produce either constant or time-varying signals.
          Figure 2-7
          shows the circuit symbols and
          i-v
          characteristics of an ideal voltage and an ideal current source. The symbol in
          Figure 2-7
          (a) represents either a time-varying or constant voltage source. The battery symbol in
          Figure 2-7
          (b) is used exclusively for a constant voltage source. There is no separate symbol for a constant current source.
        

          The
          i-v
          characteristic of an
          ideal voltage source
          in
          Figure 2-7
          (c) is described by the following element equations:
        


(2-6)




          The element equations mean that the ideal voltage source produces
          u
S
          volts across its terminals and will supply whatever current may be required by the circuit to which it is connected.
        








FIGURE 2-7



Circuit symbols and i-v characteristic of an ideal independent voltage source (a) Time-varying. (b) Constant (Battery). (c) Constant voltage source i-v characteristics. (d) Time-varying or constant source. (e) Constant current source i-v characteristics.





          The
          i-v
          characteristic of an
          ideal current source
          in
          Figure 2-7
          (e) is described by the following element equations:
        


(2-7)




          The ideal current source produces
          i
S
          amperes in the direction of its arrow symbol and will furnish whatever voltage is required by the circuit to which it is connected.
        

          The voltage or current produced by these ideal sources is called a
          forcing function
          or a
          driving function
          because it represents an input that causes a circuit response. When the voltage or current varies with time, it is customary to write
          v
          (
          t
          ) or
          i
          (
          t
          ).
        












EXAMPLE 2-4



                  Given an ideal voltage source with the time-varying voltage
                  v
S
                  (
                  t
                  ) shown in
                  Figure 2-8
                  (a), sketch its
                  i-v
                  characteristic at the times
                  t
                  = 0, 1, and 2 ms.
                









FIGURE 2-8









SOLUTION:




                At any instant in time, the time-varying source voltage has only one value. We can treat the voltage and current at each instant of time as constants representing a snapshot of the source
                i-v
                characteristic. For example, at
                t
                = 0, the equations defining the
                i-v
                characteristic are
                v
S
                = 5 V and
                i
                = any value.
                Figure 2-8
                (b) shows the
                i-v
                relationship at the other instants of time. Notably, the voltage source
                i-v
                characteristic at
                t
                = 1 ms (
                u
S
                = 0 and
                i
                = any value) is the same as that of a short circuit [see
                Eq. (2-5b)
                or
                Figure 2-3
                (b)]. We will use this knowledge in
                Chapter 3
                .
                ■















Exercise 2-3



              A digital clock is a voltage that switches between two values at a constant rate that is used to time digital circuits. A particular clock switches between 0 V and 5 V every 10 µs. Sketch the clock's
              i-v
              characteristics for the times when the clock is at 0 V and at 5 V.
            


Answers:



              On a standard
              i-v
              graph, a vertical line through the origin for the times the clock is at 0 V and a vertical line crossing at 5 V when the clock is at 5 V.
            










FIGURE 2-9



Circuit symbols for ideal and practical independent sources: (a) Ideal voltage source. (b) Practical voltage source. (c) Ideal current source. (d) Practical current source.






Practical Sources

          The practical models for voltage and current sources in
          Figure 2-9
          may be more appropriate in some situations than the ideal models used up to this point. These circuits are called practical models because they more accurately represent the characteristics of real-world sources than do the ideal models. It is important to remember that models are interconnections of elements, not devices. For example, the resistance in a model does not always represent an actual resistor. As a case in point, the resistances
          R
S
          in the practical source models in
          Figure 2-9
          do not represent physical resistors but are circuit elements used to account for resistive effects within the source devices being modeled. As a result, these resistances place a limit on the performance of any practical source.
        

          The linear resistor, open circuit, short circuit, ideal switch, ideal voltage source, and ideal current source are the initial entries in our catalog of circuit elements. In
          Chapter 4
          , we will develop models for active devices such as the transistor and OP AMP. Models for dynamic elements such as capacitors and inductors are introduced in
          Chapter 6
          .
        


2-2 Connection Constraints

          In the previous section, we considered individual devices and models. In this section, we turn our attention to the constraints introduced by interconnections of devices to form circuits. The laws governing circuit behavior are based on the meticulous work
          
          of the German scientist Gustav Kirchhoff (1824-1887).
          Kirchhoff's laws
          are derived from conservation laws as applied to circuits. They tell us that element voltages and currents are forced to behave in certain ways when the devices are interconnected to form a circuit. These conditions are called
          connection constraints
          because they are based only on the circuit connections, not on the specific devices in the circuit.
        

          In this book, we will indicate that crossing wires are connected (electrically tied together) using the dot symbol, as in
          Figure 2-10
          (a). Sometimes, crossing wires are not connected (electrically insulated) but pass over or under each other. Since we are restricted to drawing wires on a planar surface, we will indicate unconnected crossovers by
          not
          placing a dot at their intersection, as indicated in the left of
          Figure 2-10
          (b). Other books sometimes show unconnected crossovers using the semicircular "hopover" shown on the right of
          Figure 2-10
          (b). In engineering systems, two or more separate circuits are often tied together to form a larger circuit (for example, the interconnection of two integrated circuit packages). Interconnecting different circuits forms an
          interface
          between the circuits. The special
          jack
          or interface symbol in
          Figure 2-10
          (c) is used in this book because interface connections represent important points at which the interaction between two circuits can be observed or specified. On certain occasions, a control line is required to show a mechanical or other nonelectrical dependency.
          Figure 2-10
          (d) shows how this dependency is indicated in this book.
          Figure 2-10
          (e) shows how power supply connections are often shown in electronic circuit diagrams. The implied power supply connection is indicated by an arrow pointing to the supply voltage, which may be given in numerical (+15 V) or symbolic form (+
          V
CC
          ).
        








FIGURE 2-10



Symbols used in circuit diagrams: (a) Electrical connection. (b) Crossover with no connection. (c) Jack connection. (d) Control line. (e) Power supply connection.




The treatment of Kirchhoff's laws uses the following definitions:


            • A
            circuit
            is an interconnection of electrical devices.
          

            • A
            node
            is an electrical juncture of two or more devices.
          

            • A
            loop
            is a closed path formed by tracing through an ordered sequence of nodes without passing through any node more than once.
          









FIGURE 2-11



Circuit for demonstrating Kirchhoff's current law.





          While it is customary to designate the juncture of two or more elements as a node, it is important to realize that a node is not confined to a point but includes all the zero-resistance wire from the point to each element. In the circuit of
          Figure 2-11
          , there are only three different nodes:
          A
          ,
          B
          and
          C
          . The points 2, 3, and 4, for example, are part of node B, whereas the points 5, 6, 7, and 8 are all part of node C.
        


Kirchhoff's Current Law


          Kirchhoff's first law is based on the principle of conservation of charge.
          Kirchhoff's current law (KCL)
          states that
        




the algebraic sum of the currents entering a node is zero at every instant.





          In forming the algebraic sum of currents, we must take into account the current reference direction associated with each device. If the current reference direction is into the node, then we assign a positive sign to the corresponding current in the algebraic sum. If the reference direction is away from the node, we assign a negative sign. Applying this convention to the nodes in
          Figure 2-11
          , we obtain the following set of KCL connection equations:
        



(2-8)





          The KCL equation at node A does not mean that the currents
          i
1
          and
          i
2
          are both negative. The minus signs in this equation simply mean that the reference direction for each current is directed away from node A. Likewise, the equation at node B could be written as
        


(2-9)



This form illustrates an alternative statement of KCL:




The sum of the currents entering a node equals the sum of the currents leaving the node.




There are two algebraic signs associated with each current in the application of KCL. First is the sign given to a current in writing a KCL connection equation. This sign is determined by the orientation of the current reference direction relative to a node. The second sign is determined by the actual direction of the current relative to the reference direction. The actual direction is found by solving the set of KCL equations, as illustrated in the following example.












EXAMPLE 2-5



                  Given
                  i
1
                  = +4 A,
                  i
3
                  = +1 A,
                  i
4
                  = +2 A in the circuit shown in
                  Figure 2-11
                  , find
                  i
2
                  and
                  i
5
                  .
                







SOLUTION:



              Using the node A constraint in
              Eq. (2-8)
              yields
            




              The sign outside the parentheses comes from the node A KCL connection constraint in
              Eq. (2-8)
              . The sign inside the parentheses comes from the actual direction of the current. Solving this equation for the unknown current, we find that
              i
2
              = - 4 A. In this case, the minus sign indicates that the actual direction of the current
              i
2
              is directed upward in
              Figure 2-11
              , which is opposite to the reference direction assigned. Using the second KCL equation in
              Eq. (2-8)
              , we can write
            




              which yields the result
              i
5
              = - 1A.
            

              Again, the signs inside the parentheses are associated with the actual direction of the current, and the signs outside come from the node B KCL connection constraint
              
              in
              Eq. (2-8)
              . The minus sign in the final answer means that the current
              i
5
              is directed in the opposite direction from its assigned reference direction. We can check our work by substituting the values found into the node C constraint in
              Eq. (2-8)
              . These substitutions yield
            




              as required by KCL. Given three currents, we determined all the remaining currents in the circuit using only KCL without knowing the element constraints.
              ■







          In
          Example 2-5
          , the unknown currents were found using only the KCL constraints at nodes A and B. The node C equation was shown to be valid, but it did not add any new information. If we look back at
          Eq. (2-8)
          , we see that the node C equation is the negative of the sum of the node A and B equations. In other words, the KCL connection constraint at node C is not independent of the two previous equations. This example illustrates the following general principle:
        




In a circuit containing a total of N nodes there are only N - 1 independent KCL connection equations.





          Current equations written at
          N -
          1 nodes contain all the independent connection constraints that can be derived from KCL. To write these equations, we select one node as the reference or ground node and then write KCL equations at the remaining
          N -
          1 nonreference nodes.
        








FIGURE 2-12















Exercise 2-4



              Refer to
              Figure 2-12
              .
            

(a) Write KCL equations at nodes A, B, C, and D.

                (b) Given
                i
1
                = -1 mA,
                i
3
                =05 mA,
                i
6
                = 02 mA, find
                i
2
                ,
                i
4
                , and
                i
5
                .
              
(c) Identify which equation is redundant.

Answers:


                (a) Node A: -
                i
1
                -
                i
2
                = 0; node B:
                i
2
                -
                i
3
                -
                i
4
                = 0; node C:
                i
4
                -
                i
5
                -
                i
6
                = 0; node D:
                i
1
                +
                i
3
                +
                i
5
                +
                i
6
                =0
              

                (b)
                i
2
                = 1 mA;
                i
4
                =05 mA;
                i
5
                =03 mA
              
(c) Any one node equation is redundant. The redundant equation can be found by solving the remaining node equations.











FIGURE 2-13



Circuit for demonstrating Kirchhoff's voltage law.






Kirchhoff's Voltage Law

          The second of Kirchhoff's circuit laws is based on the principle of conservation of energy.
          Kirchhoff's voltage law (KVL)
          states that
        




the algebraic sum of all the voltages around a loop is zero at every instant.





          For example, three loops are shown in the circuit of
          Figure 2-13
          . In writing the algebraic sum of voltages, we must account for the assigned reference marks. As a loop is traversed, a positive sign is assigned to a voltage when we go from a "+" to "-" reference mark. When we go from "-" to "+," we use a minus sign. Traversing the
          
          three loops in
          Figure 2-13
          in the indicated clockwise direction yields the following set of KVL connection equations:
        



(2-10)




There are two signs associated with each voltage. The first is the sign given the voltage when writing the KVL connection equation. The second is the sign determined by the actual polarity of a voltage relative to its assigned reference polarity. The actual polarities are found by solving the set of KVL equations, as illustrated in the following example.












EXAMPLE 2-6



                  Given
                  v
1
                  =5 V,
                  v
2
                  = -3 V, and
                  v
4
                  = 10 V in the circuit shown in
                  Figure 2-13
                  , find
                  v
3
                  and
                  v
5
                  .
                







SOLUTION:



              Inserting the given numerical values into
              Eq. (2-10)
              yields the following KVL equation for loop 1:
            




              The sign outside the parentheses comes from the loop 1 KVL constraint in
              Eq. (2-10)
              . The sign inside comes from the actual polarity of the voltage. This equation yields
              v
3
              = + 8 V. Using this value in the loop 2 KVL constraint in
              Eq. (2-10)
              produces
            




              The result is
              v
5
              = - 2 V. The minus sign here means that the actual polarity of
              v
5
              is the opposite of the assigned reference polarity indicated in
              Figure 2-13
              . The results can be checked by substituting all the aforementioned values into the loop 3 KVL constraint in
              Eq. (2-10)
              . These substitutions yield
            




              as required by KVL.
              ■







          In
          Example 2-6
          , the unknown voltages were found using only the KVL constraints for loops 1 and 2. The loop 3 equation was shown to be valid, but it did not add any new information. If we look back at
          Eq. (2-10)
          , we see that the loop 3 equation is equal to the sum of the loop 1 and 2 equations. In other words, the KVL connection constraint around loop 3 is not independent of the previous two equations. This example illustrates the following general principle:
        




In a circuit containing a total of E two-terminal elements and N nodes, there are only E - N+1 independent KVL connection equations.





          Writing voltage summations around a total of
          E - N
          + 1
          different
          loops produces all the independent connection constraints that can be derived from KVL. A
          sufficient condition
          for loops to be different is that each contains at least one element that is not contained in any other loop. In simple circuits with no crossovers, the open space between elements or "window panes" produces
          E - N
          + 1 independent loops. However, finding all the loops in a more complicated circuit can be a nontrivial problem.
        


Discussion:


            For planar circuits, the kind encountered in this text, the number of independent loops is simply the number of "window panes." Hence, in
            Figure 2-13
            , there are three loops but only
            
            two window panes. The same is true for
            Figures 2-14
            and
            2-15
            .
            Figure 2-18
            (c) has three window panes but seven loops. The number of window panes simply identifies the number of independent KVL equations one can write. One can use any of the different loops as long as one does not exceed the number of independent equations. Choosing the right loops can at times simplify the solution to the problem.
          









FIGURE 2-14













Exercise 2-5

              Find the voltages
              v
x
              and
              v
y
              in
              Figure 2-14
              .
            


Answers:



v
x
              =+8V;
              v
y
              = +5V
            








Exercise 2-6

              Find the voltages
              v
x
              ,
              v
y
              , and
              v
z
              in
              Figure 2-15
              .
            


Answers:



v
x
              = +25 V;
              v
y
              =+5 V;
              v
z
              = +10 V.
              

Note:


              One might wonder how there can be a voltage across an open circuit. One should recall that an open circuit is a special case of a resistor with infinite resistance and a real element, it is reasonable that KVL yields the voltage
              v
z
              .
            










FIGURE 2-15









Parallel and Series Connections
Two types of connections occur so frequently in circuit analysis that they deserve special attention: parallel and series.

          Elements are said to be connected in
          parallel
          when they form a loop containing no other elements. For example, loop A in
          Figure 2-16
          contains only elements 1 and 2. As a result, the KVL connection constraint around loop A is
        


(2-11)











FIGURE 2-16



A parallel connection.





          which yields
          v
1
          =
          v
2
          . In other words, in a parallel connection, KVL requires equal voltages across the elements. Loop B in
          Figure 2-16
          contains only two elements and although visibly they do not look as if they are in parallel, a KVL analysis quickly shows that
          v
2
          =
          v
3
          and, therefore, elements 2 and 3 are in parallel. The parallel connection is not restricted to two elements. As a result, in this circuit, we have
          v
1
          =
          v
2
          =
          v
3
          , and we say that elements 1, 2, and 3 are connected in parallel. In general, then, any number of elements connected between two common nodes are in parallel, and as a result, the same voltage appears across each of them. Existence of a parallel connection does not depend on the graphical position of the elements. For example, the position of elements 1 and 3 could be switched, and the three elements are still connected in parallel.
        

          Two elements are said to be connected in
          series
          when they have one common node to which no other element with current flowing through it is connected. In
          Figure 2-17
          (a), elements 1 and 2 are connected in series, since only these two elements are connected at node A. Applying KCL at node A yields
        


(2-12)




          In a series connection, KCL requires equal current through each element. Any number of elements can be connected in series. For example, element 3 in
          Figure 2-17
          (a) is connected in series with element 2 at node B, and KCL requires
          i
2
          =
          i
3
          . Therefore, in this circuit
          i
1
          =
          i
2
          =
          i
3
          , we say that elements 1, 2, and 3 are connected in series, and the same current exists in each of the elements. In general, elements are connected in series when they form a single path between two nodes such that only elements in the path are connected to the intermediate nodes along the path. Existence of a series connection does not depend on the graphical position of the elements. Hence, if
          
          the positions of elements 1 and 3 were switched, the three elements would still be in series.
        








FIGURE 2-17



A series connection.





Figure 2-17
          (b) shows a common connection variation. Element 4 is connected at node A between elements 1 and 2. In general, elements 1 and 2 would not be in series since more than two elements connect at the same node. However, in this case, we see that the current through element 4 is zero and, therefore,
          v
4
          is also zero. KCL tells us that all of the current that flows through element 1 must flow through element 2. In this case, elements 1 and 2 behave as if they were in series.
        












EXAMPLE 2-7



                  Identify the elements connected in parallel and in series in each of the circuits in
                  Figure 2-18
                  .
                







SOLUTION:



              In
              Figure 2-18
              (a), elements 1 and 2 are connected in series at node A and elements 3 and 4 are connected in parallel between nodes B and C. In
              Figure 2-18
              (b), elements 1 and 2 are connected in series at node A, as are elements 4 and 5 at node D. There are no single elements connected in parallel in this circuit. In
              Figure 2-18
              (c), there are no elements connected in either series or parallel. It is important to realize that in some circuits there are elements that are not connected in either series or in parallel.
              ■














FIGURE 2-18












Exercise 2-7

              Identify the elements connected in series or parallel when a short circuit is connected between nodes A and B in each of the circuits of
              Figure 2-18
              .
            
Answers:

              Circuit in
              Figure 2-18
              (a): Elements 1, 3, and 4 are all in parallel.
            

              Circuit in
              Figure 2-18
              (b): Elements 1 and 3 are in parallel; elements 4 and 5 are in series.
            

              Circuit in
              Figure 2-18
              (c): Elements 1 and 3 are in parallel; elements 4 and 6 are in parallel.
            
Note that in all three circuits the short circuit is connected across element 2 causing the voltages at nodes A and B to be the same. Since the voltage across an element is zero, there can be no power produced or absorbed by that element. One can say that element 2 has been "shorted out" and effectively removes element 2 from the circuit.










Exercise 2-8



              Identify the elements in
              Figure 2-19
              that are connected in (a) parallel, (b) series, or (c) neither.
            
Answers:

(a) The following elements are in parallel: 1, 8, and 11; 3, 4, and 5.
(b) The following elements are in series: 9 and 10; 6 and 7.
(c) Only element 2 is not in series or parallel with any other element.









FIGURE 2-19










Discussion:

The ground symbol indicates the reference node. When ground symbols are shown at several nodes, the nodes are effectively connected together by a short circuit to form a single node. One may wonder why would there be more than one ground in a circuit. The reason is usually to simplify the drawing especially in larger circuits.





2-3 Combined Constraints
The usual goal of circuit analysis is to determine the currents or voltages at various places in a circuit. This analysis is based on constraints of two distinctly different types. The element constraints are based on the models of the specific devices connected in the circuit. The connection constraints are based on Kirchhoff's laws and the circuit connections. The element equations are independent of the circuit connections. Likewise, the connection equations are independent of the devices in the circuit. Taken together, however, the combination of the element and connection constraints supply the equations needed to describe a circuit.

          Our study of the combined constraints begins by considering the simple but important example in
          Figure 2-20
          (a). This circuit is driven by a current source
          i
S
          and the resulting responses are current/voltage pairs (
          i
x
          ,
          v
x
          ) and (
          i
O
          ,
          v
O
          ). The reference marks for the response pairs have been assigned using the passive sign convention.
        








FIGURE 2-20



(a) Circuit used to demonstrate combined constraints.




To solve for all four responses, we must write four equations. The first two are the element equations



(2-13)





          The first element equation states that the response current
          i
x
          and the input driving force
          i
S
          are equal in magnitude and direction. The second element equation is Ohm's law relating
          v
O
          and
          i
O
          under the passive sign convention.
        

          The connection equations are obtained by applying Kirchhoff's laws. The circuit in
          Figure 2-20
          has two elements (
          E
          = 2) and two nodes (
          N
          = 2), so we need
          E - N
          + 1 = 1 KVL equation and
          N -
          1 = 1 KCL equation. Selecting node B as the reference node, we apply KCL at node A and apply KVL around the loop to write
        



(2-14)






          We now have two element constraints in
          Eq. (2-13)
          and two connection constraints in
          Eq. (2-14)
          , so we can solve for all four responses in terms of the input driving force
          i
S
          . Combining the KCL connection equation and the first element equation yields
          i
O
          = -
          i
x
          = -
          i
S
          . Substituting this result into the second element equation (Ohm's law) produces
        



(2-15)





          The minus sign in this equation does not mean that
          v
O
          is always negative. Nor does it mean the resistance is negative; it cannot be. It means that when the input driving force
          i
S
          is positive, then the response
          v
O
          is negative, and vice versa. This sign reversal is a result of the way we assigned reference marks at the beginning of our analysis. The reference marks defined the circuit input and outputs in such a way that
          i
S
          and
          v
O
          always have opposite algebraic signs. Put differently,
          Eq. (2-15)
          is an input-output relationship, not an element
          i-v
          relationship.
        












EXAMPLE 2-8




                    (a) Find the responses
                    i
x
                    ,
                    v
x
                    ,
                    i
O
                    , and
                    v
O
                    in the circuit in
                    Figure 2-20
                    (a) when
                    i
S
                    = +2 mA and
                    R
                    = 2 kΩ.
                  

                    (b) Repeat for
                    i
S
                    = -2 mA.
                  








SOLUTION:




                (a) From
                Eq. (2-13)
                , we have
                i
x
                =
                i
S
                = +2 mA and
                v
O
                = 2000
                i
O
                . From
                Eq. (2-14)
                , we have
                i
O
                = -
                i
x
                = -2 mA and
                v
x
                =
                v
O
                . Combining these results, we obtain
                




                (b) In this case,
                i
x
                =
                i
S
                = -2 mA,
                i
O
                = -
                i
x
                = - (-0.002) = +2 mA, and
                





              This example confirms that the algebraic signs of the outputs
              v
x
              ,
              v
O
              , and
              i
O
              are always the opposite from that of the input driving force
              i
S
              .
              ■














FIGURE 2-20



(b) Revised circuit used to demonstrate combined constraints.









Exercise 2-9

              A 1-kΩ resistor
              R
R
              is inserted between nodes A and B in
              Figure 2-20
              (a) as shown in
              Figure 2-20
              (b).
            

              The voltage across it is labeled
              v
R
              and the current through it is labeled
              i
R
              . Write a set of element and connection constraints defining the circuit. Then, find
              i
x
              ,
              u
x
              ,
              i
O
              ,
              i
R
              ,
              v
R
              , and
              u
O
              if
              i
S
              = 1 mA and
              R
              = 2 kΩ.
            
Answers:

              Element constraints:
              i
S
              =
              i
x
              = 1 mA;
              v
R
              =
              i
R
R
R
              = 1000 x
              i
R
              ;
              v
O
              =
              i
O
R
              = 2000 ×
              i
O


              Connection constraints: -
              i
S
              -
              i
R
              -
              i
O
              = 0; -
              v
x
              +
              v
R
              = 0; -
              v
R
              +
              v
O
              =0
            

i
x
              = 1 mA;
              i
R
              = - 667 µA;
              i
O
              = - 333 µA;
              v
O
              =
              v
R
              =
              v
x
              = - 667 mV
            










FIGURE 2-21



Circuit used to demonstrate combined constraints.





          Let us now look at the single-loop circuit shown in
          Figure 2-21
          . We start analyzing this circuit by assigning reference marks for the voltage and current at each element. There is no right or wrong way; however, for each element, the current and voltage must follow the passive sign convention. We will discuss how to do this further after
          Exercise 2-12
          . Then, using these definitions, we can write the element constraints as
        



(2-16)






          These equations describe the three devices and do not depend on how the devices are connected in the circuit.
        

          The connection equations are obtained from Kirchhoff's laws. To apply these laws, we must first label the different loops and nodes. The circuit contains
          E
          = 3 elements and
          N
          = 3 nodes, so there are
          E - N
          + 1 = 1 independent KVL constraints and
          N -
          1 = 2 independent KCL constraints. There is only one loop, but there are three nodes in this circuit. We will select one node as the reference point and write KCL equations at the other two nodes. Any node can be chosen as the reference, so we select node C as the reference node and indicate this choice by drawing the ground symbol there. The connection constraints are
        



(2-17)




These equations are independent of the specific devices in the circuit. They depend only on Kirchhoff's laws and the circuit connections.

          This circuit has six unknowns: three element currents and three element voltages. Taken together, the element and connection equations give us six independent equations. For a network with (
          N
          ) nodes and (
          E
          ) two-terminal elements, we can write (
          N
          - 1) independent KCL connection equations, (
          E
          -
          N
          + 1) independent KVL connection equations, and (
          E
          ) element equations. The total number of equations generated is
        




          The grand total is then (2
          E
          ) combined connection and element equations, which is exactly the number of equations needed to solve for the voltage across and current through every element—a total of (2
          E
          ) unknowns.
        










EXAMPLE 2-9

                  Find all of the element currents and voltages in
                  Figure 2-21
                  for
                  V
O
                  = 10 V,
                  R
1
                  =2000 Ω, and
                  R
2
                  =3000 Ω.
                







SOLUTION:



              Substituting the element constraints from
              Eq. (2-16)
              into the KVL connection constraint in
              Eq. (2-17)
              produces
            




              This equation can be used to solve for
              i
              1 since the second KCL connection equation requires that
              i
2
              =
              i
1
              .
            



In effect, we have found all of the element currents since the elements are connected in series. Hence, collectively the KCL connection equations require that



Substituting all of the known values into the element equations gives





              Every element voltage and current has been found. Note the analysis strategy used. We first found all the element currents and then used these values to find the element voltages.
              ■












Exercise 2-10

              The wire connecting
              R
1
              to node B in
              Figure 2-21
              is broken. What would you measure for
              i
A
              ,
              v
1
              ,
              i
2
              , and
              u
2
              ? Is KVL violated? Where does the source voltage appear across?
            


Answers:



i
A
              =
              i
2
              = 0 A,
              v
1
              =
              v
2
              = 0V. KVL is not violated. The voltage
              V
O
              appears across the open (broken) circuit.
            















EXAMPLE 2-10




                  Use element and connection equations to find the voltages across the resistors in
                  Figure 2-22
                  .
                







SOLUTION:


A complete description of this circuit involves four element equations and four connection equations. The element equations are








FIGURE 2-22










The four connection equations are



Combining the last element equation and the KVL equation around loop 1 shows that




              which is nothing more than a statement that the voltage source and
              R
3
              are connected in parallel. Using this result in the loop 2 equation yields
              v
1
              +
              v
2
              =
              v
3
              = 30 V. Substituting the first two element equations into this equation produces
            




              But the KCL equation at node B points out that
              i
1
              =
              i
2
              , and this result reduces to 300
              i
2
              = 30 or
              i
1
              =
              i
2
              =0.1 A. Finally, the first two element equations yield
            




              In summary, the voltages across the three resistors are
              v
1
              =10V
              , v
2
              = 20 V, and
              v
3
              =30V.
              ■












Exercise 2-11

              Repeat the problem of
              Example 2-10
              if the 30-V voltage source is replaced with a 2-mA current source with the arrow pointing up toward node A.
            


Answers:



v
1
              =100mV,
              v
2
              =200mV,
              v
3
              = 300mV
            










FIGURE 2-23

















EXAMPLE 2-11

                  Use element and connection equations to find the voltages across and the currents through each of the elements in
                  Figure 2-23
                  .
                







SOLUTION:



              A complete description of this circuit involves 2
              E
              equations where
              E
              = 4 (two
              R
              s and one each voltage and current sources). There are four element equations and four connection equations. The four element equations are
            



The four connection equations are




              Combining the equation for loop 1 and the
              v
              A element constraint yields
            



From the element equation for the 33-kΩ resistor, we find



Using the KCL equation at node B, we find



Using the element constraint for the 22-kΩ resistor we find



Now from the loop 2 equation, we can find the voltage across the current source



And from the KCL equation for node A, we find the current through the voltage source



In sum, the following values have been found


■














Exercise 2-12




              In
              Figure 2-24
              , write a loop equation around loop 1 and a node equation at node A. Then, if
              i
1
              = 200 mA and
              i
3
              = - 100 mA, use the appropriate element equations to find the voltages
              v
x
              and
              v
y
              .
            


Answers:



              Loop 1: -
              v
x
              +
              v
1
              +
              v
2
              = 0; Node A:
              i
1
              -
              i
2
              -
              i
3
              =0;
              v
x
              = 35V;
              v
y
              = 35V.
            










FIGURE 2-24









Assigning Reference Marks
In all of our previous examples and exercises, the reference marks for the element currents (arrows) and voltages (+ and -) were given. When reference marks are not shown on a circuit diagram, they must be assigned by the person solving the problem. Beginners sometimes wonder how to assign reference marks when the actual voltage polarities and current directions are unknown. It is important to remember that the reference marks do not indicate what is actually happening in the circuit. They are benchmarks assigned at the beginning of the analysis. If it turns out that the actual direction and reference direction agree, then the algebraic sign of the response will be positive. If they disagree, the algebraic sign will be negative. In other words, the sign of the answer together with assigned reference marks tell us the actual voltage polarity or current direction.

          In this book, the reference marks always follow the passive sign convention. This means that for any given two-terminal element we can arbitrarily assign either the + voltage reference mark or the current reference arrow, but not both. For example, we can arbitrarily assign the voltage reference marks to the terminals of a two-terminal device. Once the voltage reference is assigned, however, the passive sign convention requires that the current reference arrow be directed into the element at the terminal with the + mark. On the other hand, we could start by arbitrarily selecting the terminal at which the current reference arrow is directed into the device. Once the current reference is assigned, however, the passive sign convention requires that the + voltage reference be assigned to the selected terminal. See
          Figure 2-25(a)
          and
          (b)
          .
        












FIGURE 2-25







Following the passive sign convention avoids confusion about the direction of power flow in a device. In addition, the element constraints, such as Ohm's law, assume that the passive sign convention is used to assign the voltage and current reference marks to a device.
The next example illustrates the assignment of reference marks.












EXAMPLE 2-12




                  Find the voltages across the resistors and current sources in
                  Figure 2-25
                  (c).
                







SOLUTION:



              No voltage reference marks are given in
              Figure 2-25
              (c), so we assign those shown in
              Figure 2-25
              (d). Because of the passive sign convention, the voltages assigned to the three current sources must also be assigned as shown. Once the voltage marks for
              v
1
              ,
              v
2
              , and
              v
3
              are assigned, the passive sign convention requires that the current reference directions for
              i
1
              ,
              i
2
              , and
              i
3
              be assigned as shown in
              Figure 2-25
              (e). KCL can be used to find the resistor currents directly. Using KCL at node A gives 2 -
              i
1
              - 3 = 0; hence
              i
1
              = -1 A. KCL applied at node C yields 3 +
              i
3
              - 5 = 0; hence
              i
3
              = 2 A. Finally, at node B, KCL requires
              i
1
              -
              i
2
              - i
              3
              = 0; hence
              i
2
              =
              i
1
              -
              i
3
              = -1 -2= -3 A. Given the three resistor currents, we use Ohm's law to find the three resistor voltages.
            




              The plus on the numerical value of
              v
3
              means that the assigned reference marks agree with the actual voltage polarity. The minus sign on the numerical values of
              v
1
              and
              v
2
              mean that the assigned marks and physical reality disagree. This disagreement does not mean that the assigned marks for
              v
1
              and
              v
2
              are wrong. Reference marks are not predictions. They are definitions that allow us to correctly formulate circuit equations and interpret the numerical results of circuit analysis.
            

              The voltages across the current sources can now be found by applying KVL around the three loops shown in
              Figure 2-25
              (e).
            



Using the resistor voltages found above, we have





Figure 2-25
              (f) shows the numerical values of all the voltages and currents, some of which are negative. Again, the negative values do not mean that the voltage reference marks originally assigned in
              Figure 2-25
              (d) are incorrect.
              ■














Exercise 2-13



              In
              Figure 2-25
              (c), the 2-A source is replaced by a 100-V source with the + terminal at the top, and the 3-A source is removed, that is, replaced by an open circuit. Find the current and its direction through the voltage source.
            


Answer:




i

Voltage Source
              =2.33 A up.
            




2-4 Equivalent Circuits

          The analysis of a circuit can often be made easier by replacing part of the circuit with one that is equivalent but simpler. The underlying basis for two circuits to be equivalent is contained in their
          i-v
          relationships.
        




Two circuits are said to be equivalent if they have identical i-v characteristics at a specified pair of terminals.




In other words, when two circuits are equivalent, the voltage and current at an interface do not depend on which circuit is connected to the interface.








FIGURE 2-26



A series resistance circuit: (a) Original circuit. (b) Equivalent circuit.






Equivalent resistance

          The two resistors in
          Figure 2-26
          (a) are connected in series between a pair of terminals A and B. The objective is to simplify the circuit without altering the electrical behavior of the rest of the circuit.
        
The KVL equation around the loop from A to B is



(2-18)





          Since the two resistors are connected in series, the same current
          i
          exists in both. Applying Ohm's law, we get
          v
1
          =
          R
1
i
          and
          v
2
          =
          R
2
i
          . Substituting these relationships into
          Eq. (2-18)
          and then simplifying yields
        





          We can write this equation in terms of an equivalent resistance
          R
EQ
          as
        



(2-19)





          This result means that the circuits in
          Figure 2-26
          (a) and (b) have the same
          i-v
          characteristic at terminals A and B. As a result, the response of the rest of the circuit is unchanged when the series connection of
          R
1
          and
          R
2
          is replaced by a resistance R
          EQ
          .
        

          In deriving the equivalence of two resistors in parallel, it is illustrative to use conductances. The parallel connection of two conductances in
          Figure 2-27
          (a) is the dual
          
2

          of the series circuit in
          Figure 2-26
          (a). Again, the objective is to replace the parallel connection by a simpler equivalent circuit without altering the response of the rest of the circuit.
        
A KCL equation at node A produces



(2-20)





          Since the conductances are connected in parallel, the voltage
          u
          appears across both. Applying Ohm's law, we obtain
          i
1
          =
          G
1
v
          and
          i
2
          =
          G
2
v
          . Substituting these relationships into
          Eq. (2-20)
          and then simplifying yields
        











FIGURE 2-27



A parallel resistance circuit: (a) Original circuit with resistors replaced by their conductance equivalent. (b) Equivalent conductance circuit. (c) Original circuit with resistors. (d) Equivalent resistance circuit.





          This result can be written in terms of an equivalent conductance
          G
EQ
          as follows:
        



(2-21)





          This result means that the circuits in
          Figure 2-27
          (a) and (b) have the same
          i-v
          characteristic at terminals A and B. As a result, the response of the rest of the circuit is unchanged when the parallel connection of
          G
1
          and
          G
2
          is replaced by a conductance
          G
EQ
          .
        

          Since conductance is not normally used to describe a resistor, we can derive the same relationship using resistors.
          Figure 2-27
          (c) shows the same circuit using resistors. Recall from
          Eq. (2-4)
          that we can rewrite
          Eq. (2-21)
          as an equivalent resistance
          R
EQ
          = 1/
          G
EQ
          . That is,
        



(2-22)





          where the symbol "||" is shorthand for "in parallel." The expression on the far right in
          Eq. (2-22)
          is called the product over the sum rule for two resistors in parallel. This result is shown in
          Figure 2-27
          (d).
        



Caution:


          The product over sum rule applies only to two resistors connected in parallel. When more than two resistors are in parallel, we must use the following general result to obtain the equivalent resistance:
        


(2-23)










Exercise 2-14




              Find the equivalent resistance for each of the circuits in
              Figure 2-28
              .
            


Answers:















FIGURE 2-28



















EXAMPLE 2-13



                  Find the equivalent resistance for the circuits in
                  Figure 2-29
                  (a) and
                  (b)
                  .
                







SOLUTION:



              In the circuit of
              Figure 2-29
              (a), the two 100-Ω resistors on the right of the circuit are in parallel and combine using
              Eq. (2-22)
              to 50Ω as shown in
              Figure 2-29
              (c). This new resistor is connected to the remaining 100-Ω resistor. These two resistors are in series and add as per
              Eq. (2-19)
              as shown in
              Figure 2-29
              (e). The equivalent resistance
              R
EQ
              of the circuit of
              Figure 2-29
              (a) is 150 Ω.
            








FIGURE 2-29








              The circuit of
              Figure 2-29
              (b) requires a few extra steps. Starting at the farthest right, we see that the 5.6-kΩ resistor and the 10-kΩ resistor are in series. They add to equal 15.6 kΩ as shown in
              Figure 2-29
              (d). This new resistor is in parallel with the 10-kΩ resistor in the center of the circuit. The new 15.6-kΩ resistor and the 10-kΩ resistor combine to yield 6.09 kΩ as shown in
              Figure 2-29
              (f). The two resistors at the leftmost part of the circuit, that is, the 2.2-kΩ and the 3.3-kΩ resistors are in parallel. These can combine as a 1.32-kΩ resistor as shown in
              Figure 2-29
              (d). Finally, the 1.32-kΩ resistor and the 6.09-kΩ resistor are in series and can be combined resulting in a
              R
EQ
              =741 kΩ as shown in
              Figure 2-29
              (g).
              ■

















EXAMPLE 2-14


                  Given the circuit in
                  Figure 2-30
                  (a),
                


                    (a) Find the equivalent resistance
                    R
EQ1
                    connected between terminals A and B.
                  

                    (b) Find the equivalent resistance
                    R
EQ2
                    connected between terminals C and D.
                  

                    (c) Select values for
                    R
1
                    ,
                    R
2
                    , and
                    R
3
                    so that
                    R
EQ1
                    = 2kΩ and
                    R
EQ2
                    = 500 Ω.
                  








SOLUTION:



              First, we note that resistors
              R
2
              and
              R
3
              are connected in parallel. Applying the product over sum rule [
              Eq. (2-22)
              ], we obtain
            




              As an interim step, we redraw the circuit, as shown in
              Figure 2-30
              (b).
            








FIGURE 2-30









                (a) To find the equivalent resistance between terminals A and B, we note that
                R
1
                and the equivalent resistance
                R
2
                ||
                R
3
                are connected in series. The total equivalent resistance
                R
EQ1
                between terminals A and B is
                




                (b) Looking between terminals C and D yields a different result. In this case
                R
1
                is not involved since there is an open circuit (an infinite resistance) between terminals A and B. Therefore, only
                R
2
                ||
                R
3
                affects the resistance between terminals C and D. As a result,
                R
EQ2
                is simply
                




                (c) Start with
                R
EQ2
                . The parallel combination of
                R
2
                and
                R
3
                must equal 500 Ω. The easiest way is to select
                R
2
                =
                R
3
                = 1 kΩ. Since
                R
1
                is connected to an open circuit it does not affect
                R
EQ2
                . For
                R
EQ1
,
R
1
                must add to 500 Ω to equal 2kΩ. Select
                R
1
                = 1.5 kΩ.
              


              This example shows that equivalent resistance depends on the pair of terminals involved.
              ■














FIGURE 2-31












Exercise 2-15

              Find the equivalent resistance between terminals A-C, B-D, A-D, and B-C in the circuit in
              Figure 2-30
              .
            


Answers:













Exercise 2-16

              Find the equivalent resistance between terminals A-B, A-C, A-D, B-C, B-D, and C-D in the circuit of
              Figure 2-31
              . For example,
              
R

A-B
              = (80||80) + 60 = 100Ω
              .



Answers:









          One final
          
note

          on checking numerical calculations of equivalent resistance. When several resistances are connected in parallel, the equivalent resistance must be smaller than the smallest resistance in the connection. Conversely, when several resistances are connected in series, the equivalent resistance must be larger than the largest resistance in the connection. Also, when there are
          n
          same-value resistors
          R
          connected in series, the equivalent resistance is
          R
EQ
          =
          nR.
          When there are
          n
          same-value resistors
          R
          connected in parallel, the equivalent resistance is
          R
EQ
          =
          R/n.









FIGURE 2-32




                  Practical source models that are equivalent when
                  Eq. (2-24)
                  is satisfied.
                






Equivalent sources

          The practical source models introduced previously are shown in
          Figure 2-32
          . These models consist of an ideal voltage source in series with a resistance and an ideal current source in parallel with a resistance. We now determine the conditions under which the practical voltage source and the practical current sources are equivalent.
        

Figure 2-32
          shows the two practical sources connected between terminals labeled A and B. A parallel analysis of these circuits yields the conditions for equivalency at terminals A and B. First, Kirchhoff's laws are applied as
        



Next, Ohm's law is used to obtain




          Combining these results, we find that the
          i
          -
          v
          relationships of each of the circuits at terminals A and B are
        




          These
          i
          -
          v
          characteristics take the form of the straight lines shown in
          Figure 2-33
          . The two lines are identical when the intercepts are equal. This requires that
          v
S
          /
          R
1
          =
          i
S
          and
          v
S
          =
          i
S
R
2
          , which, in turn, requires that
        



(2-24)












FIGURE 2-33




                  The i-v characteristics of practical sources in
                  Figure 2-32
                  .
                





          When conditions in
          Eq. (2-24)
          are met, the response of the rest of the circuit is unaffected when we replace a practical voltage source by an equivalent practical current source, or vice versa. Exchanging one practical source model for an equivalent model is called
          source transformation.




Caution:


          Source transformation means that either model will deliver the same voltage and current to the rest of the circuit. Hence, a circuit connected to either cannot tell which practical circuit it is connected to. It
          does not
          mean that the two models are identical in every way. For example, when the rest of the circuit is an open circuit, there is no current in the resistance of the practical voltage source, and hence no
          i
2
R
          power loss. However, the current in the practical current source is not zero when the load is an open circuit. Thus, equivalent sources do not usually have the same internal power loss even though they deliver the same current and voltage to the rest of the circuit. Suppose a problem requires the determination of the power supplied by a practical voltage source connected to a resistive load. It would be incorrect to do a source transformation and use the transformed current times the original voltage to find the power. It would also be incorrect to find the power supplied by the practical current source since it usually is not the same as that delivered by the equivalent voltage source (see
          Example 2-15
          ).
        








FIGURE 2-34



















EXAMPLE 2-15





                    (a) Convert the practical voltage source into the left of nodes A and B in
                    Figure 2-34
                    (a) to an equivalent current source.
                  

                    (b) Suppose the practical voltage source is connected to a 5
                    -
                    Ω load across nodes A and B. How much power is provided by the voltage source?
                  








SOLUTION:




                (a) Using
                Eq. (2-24)
                , we have
                



                  The equivalent practical current source is shown in
                  Figure 2-34
                  (b) to the left of nodes A and B.
                


                (b) The power provided by the source is equal to the 50-V source times the current flowing through it. The current is found by a loop equation as follows:
                


The power provided by the voltage source then is


■










Discussion:

As noted earlier, multiplying the voltage of the voltage source by the current of the transformed current source does not produce the correct answer:
          50 × 5 = 250
          W, not 166 W. However, one may be fooled into thinking that the power delivered by the transformed current source is equal to that delivered by the original voltage source. To demonstrate that this is not correct, combine the
          5-Ω
          load connected in parallel with the
          10-Ω
          source resistance to get an equivalent resistance of
          333 Ω.
          Find the voltage across the equivalent
          3.33-Ω
          resistance using Ohm's law:





The power provided by the equivalent current source then is





This is not equivalent to the correct answer of 166 W.


Transformed sources are valuable tools, as we will see, but one must remember that the transformation creates an equivalent circuit only from the perspective of the rest of the circuit and not between the transformed sources.







Exercise 2-17
A practical current source consists of a 2-mA ideal current source in parallel with a 500-Ω resistance. (a) Find the equivalent practical voltage source. Then (b), connect a 1-kΩ resistor in parallel with the first and find the power delivered by the current source. Finally (c), find the power delivered by the equivalent voltage source. Why the difference?
Answers:

(a) The equivalent is a 1-V ideal voltage source in series with a 500-Ω resistance.
(b) The power supplied by the current source is 1.33 mW.

                (c) The power delivered by the transformed source is 667 µW. A source transformation only guarantees that the load, the 1-kΩ resistor, receives the same
                i
                ,
                v
                , and
                p
                .
              





Other source transformations


Figure 2-35
          shows another source transformation in which a voltage source and resistor in parallel is replaced by a voltage source acting alone. The two circuits are equivalent because the
          i-v
          constraint at the input to the rest of the circuit is
          v
          =
          v
S
          in both circuits. In other words, the response of the rest of the circuit is unchanged if a resistor in parallel with a voltage source is removed from the circuit. However, removing the resistor does reduce the total current supplied by the voltage source by
          v
S
          /
          R
          . While the resistor does not affect the current and voltage delivered to the rest of the circuit, it does dissipate power that must be supplied by the source.
        








FIGURE 2-35



Equivalent circuit of a voltage source and a resistor in parallel.





          The dual situation is shown in
          Figure 2-36
          . In this case, a current source connected in series with a resistor can be replaced by a current source acting alone because the
          i-v
          constraint at the input to the rest of the circuit is
          i
          =
          i
S
          for both circuits. In other words, the response of the rest of the circuit is unchanged if a resistor in series with a current source is removed from the circuit.
        








FIGURE 2-36



Equivalent circuit of a current source and a resistor in series.





          Again, while the equivalent current source does not reduce the total current delivered to the rest of the circuit, it does reduce the voltage supplied by the current source by
          i
S
R
          and the power it must supply.
        


Summary of Equivalent Circuits

Figure 2-37
          is a summary of two-terminal equivalent circuits involving resistors and sources connected in series or parallel. The series and parallel equivalences in the first row and the source transformations in the second row are used regularly in subsequent discussions. The last row in
          Figure 2-37
          presents additional source transformations that reduce series or parallel connections to a single ideal current or voltage source. Proof of these equivalences involves showing that the final single-source circuits have the same
          i-v
          characteristics as the original connections. The details of such a derivation are left as an exercise for the reader.
        
There are several other circuit combinations that involve equivalent circuits that we should mention. The first is what happens if we connect two or more voltage sources in parallel? Practical sources, such as real, same-value batteries, are often connected in parallel to achieve more current. However, ideal sources are capable, by their definition, of providing whatever current the load requires, hence, multiple, same-value, voltage sources can be replaced by a single voltage source of that value. However, one cannot connect ideal voltage sources of different values, including a short circuit, in parallel since this would violate KVL. The dual is also true for ideal current sources connected in series. Same-value current sources can be replaced by a single current source of that value, while connecting ideal current sources of different values would violate KCL.








FIGURE 2-37



Summary of two-terminal equivalent circuits.











Exercise 2-18




              Find the equivalent circuit for each of the following:
            

(a) Three ideal 1.5-V batteries connected in series.
(b) A 5-mA current source in series with a 100-kΩ resistor.
(c) A 40-A ideal current source in parallel with an ideal 10-A current source.
(d) A 100-V source in parallel with two 10-kΩ resistors.
(e) An ideal 15-V source in series with an ideal 10-mA source.
(f) A 15-V ideal source and a 5-V ideal source connected in parallel.

Answers:

(a) One 4.5-V voltage source.
(b) A single 5-mA current source.
(c) One 50-A current source.
(d) A single 100-V voltage source.
(e) A 15-V source in series with a 10-mA source. An ideal voltage and current sources cannot be combined.
(f) This is not a possible combination since KVL would be violated.







          2-5 Voltage and Current Division
        
We complete our treatment of series and parallel circuits with a discussion of voltage and current division. These two analysis tools find wide application in circuit analysis and design.


Voltage Division

          Voltage division provides a simple way to find the voltage across each element in a series circuit.
          Figure 2-38
          shows a circuit that lends itself to solution by voltage division. Applying KVL around the loop in
          Figure 2-38
          yields
        








FIGURE 2-38



A voltage divider circuit.






(2-25)




          The elements in
          Figure 2-38
          are connected in series, so the same current
          i
          exists in each of the resistors. Using Ohm's law, we find that
        


(2-26)




          Solving for
          i
          yields
        


(2-27)



Once the current in the series circuit is found, the voltage across each resistor is computed using Ohm's law:


(2-28)





(2-29)





(2-30)




          Looking over these results, we see an interesting pattern. In a series connection, the voltage across each resistor is equal to its resistance divided by the equivalent series resistance of the connection times the voltage across the series circuit. Thus, the general expression of the
          voltage division rule
          is
        



(2-31)




In other words, the total voltage divides among the series resistors in proportion to their resistance over the equivalent resistance of the series connection. The following examples show several applications of this rule.












EXAMPLE 2-16



                  Find the voltage across the 330-Ω resistor in the circuit of
                  Figure 2-39
                  .
                







SOLUTION:


Applying the voltage division rule, we find that


■














FIGURE 2-39














Exercise 2-19



              Find the voltages
              v
x
              ,
              v
y
              , and
              v
z
              in the circuit of
              Figure 2-39
              . Show that the sum of all the voltages across each of the individual resistors equals the source voltage.
            


Answers:



v
x
              = 1.98 V,
              v
y
              = 11.11 V, and
              v
z
              =4.36 V. 1.98 + 11.11 + 4.36 + 6.55 = 24 V, Q.E.D.
            















                  DESIGN EXAMPLE 2-17
                


                  Using only the available 20% tolerance
                  
3

                  standard-value resistors in
                  Appendix G
                  , design a voltage divider to obtain 2.9 V±20% from a 5-V source using only two resistors.
                







SOLUTION:



              Use the voltage-divider relationship to determine the ratio your design needs to achieve 2.9 = 5 ×
              x, x
              = 0.58.
            




              where
              R
O
              is the output resistor and
              R
S
              is the source resistor. We need an output resistor that is 138 times the source resistor. If we had any value of resistor we wanted, the problem would be easy—select
              R
O
              as 138 kΩ and
              R
S
              as 1 kΩ. But we are restricted to ±20% values. If we choose
              R
S
              = 1 kΩ, the nearest value of
              R
O
              is 1.5 kΩ. This would yield an output of 30 V within the ±20%, even if both resistors are near the end of their range the output can be as large as 346 V or as small as 2.50 V, both are still within the desired range of 232 to 348 V.
              ■














              Design Exercise 2-20
            

              Using only the available 10% tolerance resistors in
              Appendix G
              , design a voltage divider to obtain 6.5 V ±10% from a 20-V source using only two resistors.
            


Answer:



              The best choice is
              R
O
              =2.7 kΩ and
              R
S
              = 5.6 kΩ. Alternately,
              R
O
              = 3.3kΩ and
              R
S
              =6.8 kΩ are also acceptable.
            


Discussion:

One could scale those resistor pairs by factors of 10 and the desired voltage would be the same. For example, R
O
              =
              27 k
              Ω
              and R
S
              =
              56 k
              Ω
              , or R
O
              =
              270
              Ω
              and R
S
              =
              560
              Ω
              . However, the current flowing through the circuit would also change by a multiple of 10. What is the consequence of the change? The higher the current the more power the source needs to supply. If the source is a battery, the more power it supplies the quicker the battery would drain. Even if the source is not a battery, the cost of providing more power could be a factor. So, one might assume that it is always better to choose the largest resistors to minimize the power that needs to be provided. But that is not always the case. Some loads need a minimum amount of power to operate. Hence, the goal is to provide the minimum amount of power while still allowing the load to work.











FIGURE 2-40

















EXAMPLE 2-18

                  Select a value for the resistor
                  R
x
                  in
                  Figure 2-40
                  so
                  v
O
                  =8V.
                







SOLUTION:



              The unknown resistor is in parallel with the 10-kΩ resistor. Since voltages across parallel elements are equal, the voltage
              v
O
              = 8 V appears across both. We first define an equivalent resistance
              R
EQ
              =
              R
x
              ||10 kΩ as
            





              We write the voltage division rule in terms of
              R
EQ
              as
            




              which yields
              R
EQ
              = 8 kΩ. Finally, we substitute this value into the equation defining
              R
EQ
              and solve for
              R
X
              to obtain
              R
X
              = 40 kΩ.
              ■












Exercise 2-21

              In
              Figure 2-40
R
x
              = 10 kΩ. The output voltage
              v
O
              = 20 V. Find the voltage source that would produce that output.
              (Hint:
              It is not 10 V.)
            


Answer:


Voltage source = 28 V.










FIGURE 2-41

















EXAMPLE 2-19

                  Use the voltage division rule to find the output voltage
                  v
O
                  of the circuit in
                  Figure 2-41
                  .
                







SOLUTION:



              At first glance, it appears that the voltage division rule does not apply since the resistors are not connected in series. However, the current through
              R
3
              is zero since the output of the circuit is an open circuit. Therefore, Ohm's law shows that
              v
3
              =
              R
3
i
3
              = 0. Applying KCL at node A shows that the same current exists in
              R
1
              and
              R
2
              since the current through
              R
3
              is zero. Applying KVL around the output loop shows that the voltage across
              R
2
              must be equal to
              v
O
              since the voltage across
              R
3
              is zero. In essence, it is as if
              R
1
              and
              R
2
              were connected in series. Therefore, voltage division can be used and yields the output voltage as
            




              The reader should carefully review the logic leading to this result because voltage division applications of this type occur frequently.
              ■












Exercise 2-22

              In
              Figure 2-41
              , suppose that a resistor
              R
4
              is connected across the output. What value should
              R
4
              be if we want ½
              v
S
              to appear between node A and ground?
            


Answer:

















FIGURE 2-42



The potentiometer: (a) circuit symbol. (b) Single-turn potentiometer. (c) Multiple-turn potentiometer. (d) Trim pots. (e) Typical application.










              APPLICATION
              EXAMPLE 2-20


              The operation of a potentiometer is based on the voltage division rule. The device is a three-terminal element that uses voltage (potential) division to meter out a fraction of the applied voltage. Simply stated, a
              potentiometer
              is an adjustable voltage divider.
              Figure 2-42
              shows the circuit symbol of a potentiometer, photos of three different types of actual potentiometers, and a typical application.
            


              The voltage
              v
O
              in
              Figure 2-42
              (e) can be adjusted by turning the shaft on the potentiometer to move the wiper arm contact. Using the voltage division rule, the voltage
              v
O
              is found as
            


(2-32)




              Adjusting the movable wiper arm all the way to the top makes
              R
1
              zero, and voltage division yields
            


(2-33)




              In other words, 100% of the applied voltage is delivered to the rest of the circuit. Moving the wiper all the way to the bottom makes
              R
1
              equal to
              R
TOTAL
              , and voltage division yields
            


(2-34)




              This opposite extreme delivers zero voltage. By adjusting the wiper arm position, we can obtain an output voltage anywhere between zero and the applied voltage
              v
S
              . When the wiper is positioned halfway between the top and bottom, we naturally expect to obtain half of the applied voltage. Setting
              
              yields
            


(2-35)



as expected. The many applications of the potentiometer include volume controls, voltage balancing, and fine-tuning adjustment.








Exercise 2-23

              Ten volts (
              v
S
              ) are connected across the 10-kΩ potentiometer (
              R
TOTAL
              ) shown in
              Figure 2-42
              (e). A load resistor of 10 kΩ is connected across its output. At what resistance should the wiper (
              R
TOTAL
              -
              R
1
              ) be set so that 2 V appears at the output,
              v
O
              ?
            


Answer:



R
TOTAL
              -
              R
1
              =2.36 kΩ.
            










FIGURE 2-43












Exercise 2-24

              For the circuit shown in
              Figure 2-43
              , (a) find the values of the output
              v
O
              as the potentiometer is moved across its range. (b) Then, determine the value of
              v
O
              if the potentiometer is set to exactly halfway of its range. (c) Now, determine the range of power
              p
S
              that the source must deliver as the wiper is moved across its range. (d) Finally, how much power does the source deliver when the potentiometer is set to halfway?
            


Answer:



              (a) 0 ≤
              v
O
              ≤ 15 V. (b) When the potentiometer is set to halfway,
              v
O
              = 6 V. (c) The source power
              p
S
              ranges from 90 mW to 45 mW. (d)
              p
S
              = 54 mW.
            















                  DESIGN EXAMPLE 2-21
                

                  Design a voltage divider that will provide 5.5V±5% from a 9-V battery using only the ±10% standard-value resistors (see
                  Appendix G
                  ). The current from the source should be at or below 0.5 mA to avoid draining the source too quickly.
                








SOLUTION:


The percentage of the 9-V source desired is



Using the voltage division rule, we want




              Selecting
              R
1
              =1 kΩ and
              R
2
              = 1.5 kΩ, both of which are standard values, provides an output voltage of
            




              This result is well within the range of acceptable values of 5.225 V ≤
              v
O
              ≤ 5775 V.
            
Checking to see what the current drain on the source is, we use Ohm's law.




              This fails to meet the second requirement, a current less than or equal to 0.5 mA. Our choice of resistors is too small. Selecting
              R
1
              =10 kΩ and
              R
2
              = 15 kΩ, both also standard values, provides the same ratio but a current of only 0.36 mA, thus meeting both requirements. Some other
              R
1
              -
              R
2
              pairs that would work are 22 kΩ and 33 kΩ, 47 kΩ and 68 kΩ, and 100 kΩ and 150 kΩ.
              Figure 2-44
              shows the design task and our chosen result.
            








FIGURE 2-44







The designer should be aware that the actual resistor values must be checked to verify the final design stays within the 5% tolerance for the output voltage.

              In design, one must start somewhere and make an assumption. Testing the assumption may result in the realization that the assumption was wrong and a new assumption must be made. Design by its nature is often an iterative process.
              ■








Current Division

          Current division is a simple way to find the current through each element of a parallel circuit. It is the dual of voltage division, so we will observe some similarities in the form of the equations for the two approaches.
          Figure 2-45
          shows a parallel circuit that lends itself to solution by current division. Applying KCL at node A yields
        











FIGURE 2-45



A current divider circuit.






          The voltage
          v
          appears across all three resistances since they are connected in parallel. Using Ohm's law, we can write
        




          and solve for
          v
          as
        




          Given the voltage
          v,
          the current through any element is found using Ohm's law as
        


(2-36)





(2-37)





(2-38)











FIGURE 2-46



Two-path current divider circuit.





          These results show that the source current is divided among the parallel resistors in proportion to their
          conductances
          divided by the equivalent conductances in the parallel connection. Thus, the general expression for the current through the
          k
          th resistor is given by the
          current division rule
          as
        


(2-39)




          Comparing this equation with
          Eq. (2-31)
          for voltage division, we see how similar they look. In essence, if you know one rule you know the other: Replace
          v
          with
          i
          and
          R
          with
          G
          in the voltage division rule to obtain the current division rule, and vice versa. This is one of the strengths of the concept of duality.
        

          For the two-resistor case in
          Figure 2-46
          , the current
          i
1
          is found using current division as
        



(2-40)





          Similarly, the current
          i
2
          in
          Figure 2-46
          is found to be
        



(2-41)





          These two results lead to the following
          two-path current division rule
          : When a circuit can be reduced to two equivalent resistances in parallel, the current through one
          
          resistance is equal to the other resistance divided by the sum of the two resistances times the total current entering the parallel combination.
        



Caution:


Equations (2-40)
          and
          (2-41)
          apply only when the circuit is reduced to two parallel paths in which one path contains the desired current and the other path is the equivalent resistance of all other paths.
        












EXAMPLE 2-22



                  Find the current
                  i
x
                  in
                  Figure 2-47
                  (a).
                







SOLUTION:



              To find
              i
x
              , we reduce the circuit to two paths, a path containing
              i
x
              and a path equivalent to all other paths, as shown in
              Figure 2-47
              (b). Now we can use the two-path current divider rule as
            


■














FIGURE 2-47












Exercise 2-25


                (a) Find
                i
y
                and
                i
z
                in the circuit of
                Figure 2-47
                (a).
              

                (b) Show that the sum of
                i
x
                ,
                i
y
                , and
                i
z
                equals the source current.
              

Answers:


                (a)
                i
y
                = 125 A;
                i
z
                =25A
              

                (b)
                i
x
                +
                i
y
                +
                i
z
                =5 A
              











Exercise 2-26



              The circuit in
              Figure 2-48
              shows a delicate device that is modeled by a 90-Ω equivalent resistance. The device requires a current of 1 mA to operate properly. A 1.5-mA fuse is inserted in series with the device to protect it from overheating. The resistance of the fuse is 10 Ω. Without the shunt resistance
              R
x
              , the source would deliver 5 mA to the device, causing the fuse to blow. Inserting a shunt resistor
              R
x
              diverts a portion of the available source current around the fuse and device. Select a value of
              R
x
              so only 1 mA is delivered to the device.
            








FIGURE 2-48









Answer:



R
x
              = 12.5 Ω
            















                    APPLICATION
                    EXAMPLE 2-23



                  Batteries chemically produce electricity that is used to power many portable devices including cell phones, tablet computers, flashlights, hearing aids, back-up power, and automobiles to mention just a few. Batteries are rated in both voltage and ampere-hours. A typical car battery delivers a nominal 12 V for 70 A-hrs while an
                  
                  alkaline AAA-cell delivers 1.5 V for 1.2 A-hrs. A lithium/manganese dioxide 3-V "123" battery delivers a nominal 3 V for 1.5 A-hrs. Tesla uses a proprietary "18650" lithium-ion battery that delivers 3.8 V for up to 3.4 A-hrs. Batteries are not ideal sources; they are all real or practical sources of energy and must be modeled as an ideal voltage source in series with a resistor. The series resistor models the battery's
                  internal resistance,
                  which can vary from a few milliohms for a car battery to as high as 100 ohms for a hearing-aid battery. As a battery ages, especially in use, its internal resistance increases decreasing its usefulness. Therefore, it is good practice to measure a battery's voltage while under load since measuring the battery's voltage with an open circuit could indicate a good voltage regardless of its internal resistance. The following example looks at the effect of a battery's internal resistance on the current available to a load.
                
A car battery of 12.6 V and an internal resistance of 25 mΩ delivers 100 mA to accessories and 210 A to the starter motor of a 6-cylinder car. Find the resistance of the starter motor.







SOLUTION:



Figure 2-49
              (a) shows the circuit in question. There are several ways to tackle this problem. Let's solve it two ways. For our first approach, we will do a source transformation as shown in
              Figure 2-49
              (b). We know that the total current delivered to the loads is 210.1 A. We can use a current divider,
              Eq. (2-41)
              , to find the total resistance of the loads.
            




              Solving for
              R
Loads
              yields 34.97 mΩ.
            
Ohm's law can be used to find the voltage across the total load



Ohm's law can again be used to find the resistance of the starter motor



A second, somewhat simpler, approach is to realize that 210.1 A are flowing through the source resistance. This results in a voltage drop of











FIGURE 2-49









              By KVL, this leaves 12.6-5.2525 = 7.3475 V across the loads. We can then solve for
              R
Motor
              as before and find it to be 34.98 mΩ.
              ■














Exercise 2-27



              Repeat the problem of
              Example 2-23
              if the battery's internal resistance increases to 70 mΩ. Will there be sufficient current available to start the car?
            


Answer:


A source transformation can quickly show that there will be a maximum of only 180 A available for the motor and accessories. The battery is insufficient to power the starting motor and accessories and driver will hear that stomach-wrenching sound. Rrrrrr-rrr-rr-ugh!










                APPLICATION
                EXAMPLE 2-24



              The
              R -
              2R ladder circuit in
              Figure 2-50
              is a
              binary current divider
              that finds applications in digital-to-analog signal conversion. The operation of this circuit can be explained using current division together with series and parallel equivalent resistance. The equivalent resistance connected to ground at node 3 is 2
              R
              ||2
              R
              =
              R
              , which means that the equivalent resistance seen to the right of node 2 of
              R
              +
              R
              =2
              R.
              This in turn means that the total equivalent resistance connected to ground at node 2 is 2
              R
              ||2
              R
              =
              R
              and hence the equivalent resistance seen to the right of node 1 of
              R
              +
              R
              = 2
              R
              . The net result is that the equivalent resistance seen to the right of each numbered node is 2
              R.









FIGURE 2-50








              The reference current
              I
REF
              entering node 1 divides equally between the two available 2
              R
              paths with the result that
              i
1
              =
              I
REF
              /2, and the current into node 2 is also
              i
1
              =
              I
REF
              /2. At node 2 this current again divides equally between the two 2
              R
              paths with the result that
              i
2
              =
              i
1
              /2 =
              I
REF
              /4 and the current into node 3 is
              i
2
              =
              I
REF
              /4. Finally, at node 3 this current divides equally once more so that
              i
3
              =
              i
2
              /2 =
              I
REF
              /8. In sum, the currents in the 2
              R
              resistors connected to ground are all of the form
              i
k
              =
              I
REF
              /2
              
k

              , where
              k
              is the node number to which the resistor is connected. Thus, the
              R -
              2
              R
              ladder circuit produces signals (currents in this case) that decrease in a binary fashion as we proceed down the ladder.
            

              Clearly, the
              R
              - 2
              R
              ladder can be extended to a larger number of nodes. Commercially available integrated circuit ladders have as many as twelve-numbered nodes producing binary currents ranging from
              I
REF
              /2 to
              I
REF
              /4096. The advantage of this circuit is that it produces this wide range of precisely related signals using only two values of resistance, namely
              R
              and 2
              R.
              This greatly simplifies the fabrication of the
              R -
              2
              R
              ladder in integrated circuit form.
            











Exercise 2-28


                (a) Find the currents
                i
S
                ,
                i
1
                ,
                i
2
                , and
                i
3
                in the
                R-
                2
                R
                circuit shown in
                Figure 2-51
                .
              

                (b) If
                i
S
                =
                i
REF
                as noted in
                Example 2-24
                , are the found currents proportional as expected?
              

Answers:


                (a)
                i
S
                = 33.3 mA,
                i
1
                = 16.7 mA,
                i
2
                = 8.33 mA, and
                i
3
                = 4.17 mA.
              

                (b) Yes.
                i
1
                =
                i
REF
                /2,
                i
2
                =
                i
REF
                /4, and
                i
3
                =
                i
REF
                /8.
              









FIGURE 2-51









Discussion:


                The R-2R
                
                circuits shown in
                Figures 2-50
                and
                2-51
                are called "ladder circuits" because they look like a ladder laying on its side. These will be studied in greater depth in the next section.
              





2-6 Circuit Reduction

          The concepts of series/parallel equivalence, voltage/current division, and source transformations can be used to analyze
          ladder circuits
          of the type shown in
          Figure 2-52
          . The basic analysis strategy is to reduce the circuit to a simpler equivalent in which the output is easily found by voltage or current division or Ohm's law. There is no fixed pattern to the reduction process, and much depends on the insight of the analyst. In any case, with circuit reduction, we work directly with the circuit model, and so the process gives us insight into circuit behavior.
        








FIGURE 2-52



A ladder circuit.




With circuit reduction, the desired unknowns are found by simplifying the circuit and, in the process, eliminating certain nodes and elements. However, we must be careful not to eliminate a node or element that includes the desired unknown voltage or current. The next three examples illustrate circuit reduction. The final example shows that rearranging the circuit can simplify the analysis.












EXAMPLE 2-25



                  Use series and parallel equivalence to find the output voltage
                  v
O
                  and the input current
                  i
S
                  in the ladder circuit shown in
                  Figure 2-53
                  (a).
                







SOLUTION:



              One approach is to combine parallel resistors and use voltage division to find
              v
O
              and then combine all resistances into a single equivalent to find the input current
              i
S
              .
              Figure 2-53
              (b) shows the step required to determine the equivalent resistance between the terminals B and ground. The equivalent resistance of the parallel 2
              R
              and
              R
              resistors is
            





              The reduced circuit in
              Figure 2-53
              (b) is a voltage divider. Notice that the two nodes needed to find the voltage
              v
O
              , nodes B and ground, have been retained. The unknown voltage is found in terms of the source voltage as
            




              The input current is found by combining the equivalent resistance found previously with the remaining resistor
              R
              to obtain
            




              Application of series/parallel equivalence has reduced the ladder circuit to the single equivalent resistance shown in
              Figure 2-53
              (c). Using Ohm's law, the input current is
            




              Notice that the reduction step between
              Figure 2-53
              (b) and (c) eliminates node B, so the output voltage
              v
O
              must be calculated before this reduction step is taken.
              ■














FIGURE 2-53












Exercise 2-29

              In
              Figure 2-53
              ,
              R
              =15 kΩ. The voltage source
              v
S
              = 5V. Find the power delivered to the circuit by the source.
            


Answer:



p
S
              =1 mW
            













EXAMPLE 2-26

                  Use source transformations to find the output voltage
                  v
O
                  and the input current
                  i
S
                  in the ladder circuit shown in
                  Figure 2-54
                  (a).
                







SOLUTION:



Figure 2-54
              shows another way to reduce the circuit analyzed in
              Example 2-25
              . Breaking the circuit at points X and Y in
              Figure 2-54
              (a) produces a voltage source
              v
S
              in series with a resistor
              R.
              Using source transformation, this combination can be replaced by an equivalent current source in parallel with the same resistor, as shown in
              Figure 2-54
              (b).
            



Caution:


              The current source
              v
S
              /
              R
              is
              not
              the input current
              i
S
              , as is indicated in
              Figure 2-54
              (b). Applying the two-path current division rule to the circuit in
              Figure 2-54
              (b) yields the input current
              i
S
              as
            




              The three parallel resistances in
              Figure 2-54
              (b) can be combined into a single equivalent conductance without eliminating the node pair used to define the output voltage
              v
O
              . Using parallel equivalence, we obtain
            











FIGURE 2-54









              which yields the equivalent circuit in
              Figure 2-54
              (c). The current source
              v
S
              /
              R
              determines the current through the equivalent resistance in
              Figure 2-54
              (c). The output voltage is found using Ohm's law.
            




              Of course, these results are the same as the result obtained in
              Example 2-25
              , except that here they were obtained using a different sequence of circuit reduction steps.
              ■














              Design Exercise 2-30
            

              In
              Figure 2-54
              (a) with
              v
S
              = 10 V, select a standard value of
              R
              from ±10% Table in
              Appendix G
              so that
              v
O
              = 4 V and
              p
S
              ≤ 1 mW.
            


Answer:



              Since
              
              irrespective of the value of
              R
              , it might seem that any value would work. The power needs to be less than 1 mW, so the value of
              R
              needs to be greater than 60 kΩ. From
              Appendix G
              , select 68 kΩ or any larger standard value.
            













EXAMPLE 2-27

                  Find x in the circuit shown in
                  Figure 2-55
                  (a).
                







SOLUTION:



              In the two previous examples, the unknown responses were defined at the circuit input and output. In this example, the unknown voltage appears across a 10-Ω resistor in the center of the network. The approach is to reduce the circuit at both ends while retaining the 10-Ω resistor defining
              v
x
              . Applying a source transformation to
            








FIGURE 2-55









              the left of terminals X-Y and a series reduction to the two 10-Ω resistors on the far right yields the reduced circuit shown in
              Figure 2-55
              (b). The two pairs of 20-Ω resistors connected in parallel can be combined to produce the circuit in
              Figure 2-55
              (c). At this point, there are several ways to proceed. For example, a source transformation at the points W-Z in
              Figure 2-55
              (c) produces the circuit in
              Figure 2-55
              (d). Using voltage division in
              Figure 2-55
              (d) yields
              v
x
              ,
            




              Yet another approach is to use the two-path current division rule in
              Figure 2-55
              (c) to find the current
              i
x
              ,
            




              Then, applying Ohm's law to obtain
              v
x
              ,
            


■














FIGURE 2-56














Exercise 2-31



              Find
              v
x
              and
              i
x
              using circuit reduction on the circuit in
              Figure 2-56
              .
            


Answers:



v
x
              =3.33 V;
              i
x
              = 0.444 A
            










FIGURE 2-57














Exercise 2-32



              Find
              v
x
              ,
              v
y
              , and
              i
x
              using circuit reduction on the circuit in
              Figure 2-57
              .
            


Answers:



v
x
              = - 3.09 V;
              v
y
              = 9.21 V;
              i
x
              = - 7.163 mA
            











FIGURE 2-58



















EXAMPLE 2-28




                  Using circuit reduction, find
                  v
O
                  in
                  Figure 2-58
                  (a).
                







SOLUTION:



              One way to solve this problem is to notice that the source branch and the leftmost two-resistor branch are connected in parallel between node A and ground. Switching the order of these branches and replacing the two resistors by their series equivalent yields the circuit of
              Figure 2-58
              (b). A source transformation yields the circuit in
              Figure 2-58
              (c). This circuit contains a current source
              v
S
              /2
              R
              in parallel with two 2
              R
              resistances whose equivalent resistance is
            




              Applying a source transformation to the current source
              v
S
              /2
              R
              in parallel with
              R
EQ
              results in the circuit of
              Figure 2-58
              (d), where
            




              Finally, applying voltage division in
              Figure 2-58
              (d) yields
            


■












Exercise 2-33

              Find the voltage across the current source in
              Figure 2-59
              .
            


Answer:



v
S
              = -0.225 V
            










FIGURE 2-59









2-7 Computer-Aided Circuit Analysis

          In this text, we use three types of computer programs to illustrate computer-aided circuit analysis, namely spreadsheets, math solvers, and circuit simulators. Practicing engineers routinely use these tools to analyze and design circuits, so it is important to learn how to use them effectively. The purpose of including computer examples in this book is to help you develop an analysis style that includes the intelligent use of computer tools. As you develop your style, always keep in mind that computer tools are not problem solvers.
          You
          are the problem solver. Computer tools can be very useful, even essential, once you have defined the problem. However, they do not substitute for an understanding of the fundamentals needed to formulate the problem, identify a practical approach, and interpret analysis results.
        
There are about 100 worked examples and exercises in the text that use computer tools. The spreadsheet examples use Microsoft Excel Version 2017. The math solver examples use MATLAB Release 2021a by The MathWorks, Inc. The circuit simulation examples use NI Multisim Education Edition 14.2 by National Instruments.


          Our objective is to illustrate the effective use of computer tools rather than develop your ability to operate these specific software programs. Although this book provides examples as helpful starting points, it does not emphasize the details of how to operate any of these software tools. We assume that you learned how to operate computer tools in previous courses or have enough familiarity with your computer's operating system to learn how to do so using online tutorials or any of a number of commercially available manuals.
        

          The following discussion gives a brief overview of circuit simulation and of applying a math solver to a circuit analysis problem. Many more examples will follow in subsequent chapters.
          Appendix D
          provides additional information on computer programs that support circuit analysis.
        


Circuit Simulation Using Circuit Simulation Software

          Most circuit simulation programs are based on a circuit analysis package called SPICE, which is an acronym for
          S
          imulation
          P
          rogram with
          I
          ntegrated
          C
          ircuit
          E
          mphasis.
          Figure 2-60
          is a block diagram summarizing the major features of a SPICE-based circuit simulation program. The inputs are a circuit diagram and the type of analysis required. In contemporary programs, the circuit diagram is drawn on the monitor screen using a graphical schematic editor. When the circuit diagram is complete, the input processor performs a
          schematic capture,
          a process that documents the circuit in what is called a
          netlist.
          To initiate circuit simulation, the input processor sends the netlist and analysis commands to the simulation processor. If the netlist file is not properly prepared, the simulation will not run or (worse) will return erroneous results. Hence, it is important to check the netlist and your circuit to be sure that the circuit it defines is the one you want to analyze.
        
The simulation processor uses the netlist together with data from the device library to formulate a set of equations that describes the circuit. The simulation processor then solves the equations, writes a dc analysis summary to a standard SPICE output file, and writes the other analysis results to a response data file. For simple dc analysis, the desired response data are accessible by examining the SPICE output file. For other types of analysis, the output processor can be used to generate graphical plots of the data in the response data file.
There are numerous circuit simulation software products available to students - also to professionals - that simplify the analysis, design, and evaluation of electronic








FIGURE 2-60



Flow diagram for circuit simulation programs.






          circuits. In creating this text, we looked at several competing products (there are more): OrCAD by Cadence, Multisim by National Instruments, 123D Circuits by AutoDesk, Proteus by LabCenter, LT Spice Simulator by Linear Technologies, and PartSim by Aspen Core. All of these can be used successfully to solve the problems in this text. Students can choose whichever product suits them or their instructor. We chose National Instrument's Multisim because of its ease of use, low cost, breath of problems it can easily be used on, the ability to insert virtual laboratory instruments in a circuit, and its easy integration with another NI product, LabView.
        

          National Instrument's
          Multisim
          offers a student-friendly tool to simulate electronic circuits.
          Appendix D
          provides many examples that use Multisim to simulate circuit performance and can be used by the student to see how circuit simulation works for different circuits and analyses. In general, Multisim is used to view currents, voltages, and powers at various nodes or devices in a circuit. The following example illustrates the main steps in solving a circuit analysis problem via simulation.
        













EXAMPLE 2-29



                  Use Multisim to find the voltages and currents for the circuit in
                  Figure 2-22
                  (
                  Example 2-10
                  ).
                







SOLUTION:


There are two methods to simulate your results using Multisim. We will cover both of them. In the first method, we use instruments much like you would use in the laboratory to view the simulation results. In the second method, we will define the variables we wish to simulate and view the results on a spreadsheet. For the first method, the main steps required to solve this problem using Multisim are as follows:



1.

                Graphically draw the circuit schematic using Multisim's Design board.
              


2.

                Add whatever instruments you wish to view the results on.
              


3.

                Tell the program what type of simulation is desired.
              


4.

                Simulate the circuit (Run) and view the results.
                ■








          Begin by creating the circuit schematic by using the "Place" menu option and placing the appropriate components (three resistors, a dc voltage source, and a ground on the workspace). Click on the resistor values and adjust each to match the problem. Do the same for the voltage source. Then, using the "Simulate" menu under "Instruments," select the instruments (Digital Multimeters or DMMs) you wish to use to measure the three currents and two unknown voltages. Connect each part and the instruments using the wiring tool. Recall that you must intercept the wires to measure current—
          a through variable—
          when connecting the DMM as an ammeter.
          Figure 2-61
          shows the resulting Multisim schematic. Once the circuit is wired, click on each instrument to view the setup for each instrument. Select "A" to measure current and "V" to measure voltage. Note that the physical layout of the Multisim schematic looks different than that of
          Figure 2-22
          . Multisim does not allow for diagonal part placement. Although they look different, the two circuits have the same connections and are electrically and functionally equivalent. You can verify this fact by writing device and connection equations for both of the circuits.
        
The next step is simply to run your simulation by hitting the little green "Run" triangle. The DMMs will display the desired parameters as shown in the figure. Note that you must click on the little red square inside the "interactive" box to stop the simulation.








FIGURE 2-61









          The second method requires a little more effort to set up but yields more detailed results. Proceed as follows:
        



1.

            Graphically draw the desired circuit using Multisim's Design board as with the earlier method but do not include any of the instruments. It will be useful to label the nodes with a reference name. To do this double click on each node and a window opens called "Net Properties." Give the node your "Preferred net name"
            v
1
            in our case, and check the box "Show net name." Repeat for the second node
            v
2
            . This should result in the circuit shown in
            Figure 2-62
            (a).
          


2.

            Next we ask Multisim to perform the desired analysis. Under "Simulate" (circled on
            Figure 2-62
            (a)) select "Analysis and simulation." A new window opens. Select under "Active Analysis" "DC Operating Point" and the window lets you select the variables in the circuit that you wish to evaluate. See
            Figure 2-62
            (b). Select all the currents, the source power, and the voltages
            v
1
            and
            v
2
            as seen in
            Figure 2-62
            (c). As will be a common case in subsequent analyses, the voltage across
            R
1
            is not readily accessible. Multisim lets one insert an expression using the variables available to calculate the desired parameter, in this case the voltage across
            R
1
            . Select "Add expression" and a small window opens that lets you enter the desired expression; see
            Figure 2-62
            (d). The voltage across
            R
1
            is the voltage
            v
1
            -
            v
2
            . We need to enter this expression by selecting V(v1) from the "Variables" list and then "Copy variable to expression." Then under "Functions" select the minus sign "-" and "Copy function to expression." Then select V(v2) and place
            
            it in the expression. In the box labeled "Expression:" you should see V(v1) - V(v2). Select "OK" and the expression will appear in the "Selected variables for analysis" as seen in
            Figure 2-62
            (c).
            







FIGURE 2-62










3.

            At the bottom of the window (
            Figure 2-62
            (c)), there is a "Run" button. Press that and a new window called "Grapher View" opens with all the analysis performed. See
            Figure 2-63
            (a). If you double click on the table, a new window opens that lets you set the precision of your answer. It defaults to five places and we chose two. If you wish to see the results in black on white rather than white on black, press the double square located under "Cursor." Note that these results can be exported to Excel. Under "Tools" in Grapher View select "Export to Excel." The resulting spreadsheet is shown in
            Figure 2-63
            (b).
          

One could even ask Multisim to calculate the power delivered by the source "P(V1)." It returns -6 W, the negative sign indicating that the source delivers power to the circuit.








FIGURE 2-63















              Exercise 2-34
            


              Use Multisim to find all the voltages and currents in the circuit of
              Figure 2-47
              (a) (
              Example 2-22
              ).
            


Answer:



              See
              Figure 2-64
              .
            




Comparison of Computer-Based Techniques

          We applied two Multisim-based approaches to solve the circuit analysis problem originally presented as
          Example 2-10
          . Both approaches efficiently arrived at a complete and correct solution and may offer some advantages over the manual approach presented in
          Example 2-10
          . It is also possible to solve this problem using a math solver such as MATLAB discussed in
          Chapter 1
          . As you explore these tools, you will develop the experience and judgment to know when each tool is appropriate to assist in solving a problem. The circuit simulation tools allow for visual representations of the circuits and efficiently compute numerical solutions when all of the parameter values are known. A math solver quickly manipulates a set of equations to find a solution, but you must relate the numerical results back to the original schematic to get a full representation of the answer. Math solver software can offer distinct advantages over circuit simulation software when the circuit contains parameter values expressed as variables such as
          R, v
          , or
          i
          rather than numeric values. The circuit simulation software cannot directly handle this type of the problem, but the math solver software accommodates it with only minor changes, as we will explore in
          Chapter 3
          . As we develop circuit analysis and design techniques throughout the text, we will continue to emphasize the advantages and disadvantages of the various computer-based tools so that you can expand your judgment and efficiently apply the appropriate tools for each problem. No matter what technique one uses, good "engineering sense" must predominate. Results that just do not seem right should be challenged and verified. As you grow in knowledge and experience, you will develop and enhance this important engineering characteristic.
        








FIGURE 2-64









Summary



            An
            electrical device
            is a real physical entity, whereas a
            circuit element
            is a mathematical or graphical model that approximates major features of the device.
          
Two-terminal circuit elements are represented by a circuit symbol and are characterized by a single constraint imposed on the associated current and voltage variables.

            An
            electrical circuit
            is an interconnection of electrical devices. The interconnections form nodes and loops.
          

            A
            node
            is an electrical juncture of the terminals of two or more devices. A
            loop
            is a closed path formed by tracing through a sequence of devices without passing through any node more than once.
          

            Device interconnections in a circuit lead to two connection constraints:
            Kirchhoff's current law (KCL)
            states that the algebraic sum of currents at a node is zero at every instant; and
            Kirchhoff's voltage law (KVL)
            states that the algebraic sum of voltages around any loop is zero at every instant.
          

            A pair of two-terminal elements are connected in
            parallel
            if they form a loop containing no other elements. The same voltage appears across any two elements connected in parallel.
          

            A pair of two-terminal elements are connected in
            series
            if they are connected at a node to which no other elements are connected. The same current exists in any two elements connected in series.
          

            Two circuits are said to be
            equivalent
            if they each have the same
            i-v
            constraints at a specified pair of terminals.
          

            Series and parallel equivalence and
            voltage
            and
            current division
            are important tools in circuit analysis and design.
          

Source transformation
            changes a voltage source in series with a resistor into an equivalent current source in parallel with a resistor, or vice versa.
          

Circuit reduction
            is a method of solving for selected signal variables in ladder circuits. The method involves sequential application of the series/parallel equivalence rules, source transformations, and the voltage/ current division rules. The reduction sequence used depends on the variables to be determined and the structure of the circuit and is not unique.
          

Computer-aided circuit analysis
            applies spreadsheets, circuit simulation, or math solver software to analyze circuit problems efficiently. The tools allow for visual solutions and can eliminate the need to perform tedious or lengthy manual calculations.
          






        Chapter 2 Problems
      






            Objective 2-1 Element Constraints (
            Sect. 2-1
            )
          

            Given a two-terminal element with one or more electrical variables specified, use the element
            i-v
            constraint to find the magnitude and direction of the unknown variables.
          

            See
            Examples 2-1
            to
            2-4
            and
            Exercises 2-1
            to
            2-3
            .
          





2-1
          The current through a 47-kΩ resistor is 2.2 mA. Find the voltage across the resistor.
        

2-2
          The voltage across a particular resistor is 8.85 V and the current is 305 µA. What is the actual resistance of the resistor? Using
          Appendix G
          , what is the likely standard value of the resistor, if the resistor's tolerance is 5%, 10%, or 20%?
        


2-3
          You can choose to connect either a 3.3-kΩ resistor or a 33-kΩ resistor across a 5-V source. Which will draw the least current from the source? What is that current?
        

2-4
          A ½-A fuse has a nominal resistance of 256 mΩ. How much voltage is dropped across the fuse at maximum current?
        


2-5
          In
          Figure P2-5
          , the resistor dissipates 50 W.
          

(a)
              Find
              R
x
              .
            

(b)
              Will the fuse blow?
            









FIGURE P2-5









2-6
          In
          Figure P2-6
          find
          R
x
          and the power supplied by the source.
          







FIGURE P2-6










2-7
(a)
          A resistor found in the lab has three red stripes followed by a silver stripe. An ohmmeter measures its resistance as 2.56 kΩ. Is the resistor properly color coded?
        

(b)
          You need a 56-kΩ resistor ±5%. What color code should you look for?
          
            (See
            Appendix G
            for color code.)
          


2-8
          A 10-Ω wire-wound power resistor is needed as a load in an audio system. At peak power the load can have up to 3 A flowing through it. What is the minimum power rating that the resistor can have?
        


2-9
Figure P2-9
          shows the circuit symbol for a class of two-terminal devices called diodes. The
          i-v
          relationship for a specific
          pn
          junction diode is
          i
          = 5 × 10
          -17
          (
          e

            40
            v

          - 1) A.
          

(a)
              Use this equation to find
              i
              and
              p
              for
              v
              = 0, ±0.1, ±0.2, ±0.4, ±0.8, and ±1.0V. Use these data to plot the
              i-v
              characteristic of the element.
            

(b)
              Is the diode linear or nonlinear, bilateral or nonbilateral, and active or passive?
            

(c)
              Use the diode model to predict
              i
              and
              p
              for
              v
              = 5 V. Do you think the model applies to voltages in this range?
            

(d)
              Repeat (c) for
              v
              = - 5 V.
            









FIGURE P2-9









2-10
          A thermistor is a temperature-sensing element composed of a semiconductor material, which exhibits a large change in resistance proportional to a small change in temperature. A particular thermistor has a resistance of 5kΩ at 25°C. Its resistance is 340Ω at 100°C. Assuming a straight-line relationship between these two values, at what temperature will the thermistor's resistance equal 1 kΩ?
          





                Objective 2-2 Connection Constraints (
                Sect. 2-2
                )
              
Given a circuit composed of two-terminal elements:

(a) Identify nodes and loops in the circuit.
(b) Identify elements connected in series and in parallel.
(c) Use Kirchhoff's laws (KCL and KVL) to find selected signal variables.


                See
                Examples 2-5
                to
                2-7
                and
                Exercises 2-4
                to
                2-8
                .
              





2-11
          In
          Figure P2-11
          :
          

(a)
              Identify the elements that are in series and/or in parallel.
            

(b)
              How many nodes and loops are there?
            

(c)
              If
              i
2
              = -6 A and
              i
3
              = 2 A. Find
              i
1
              and
              i
4
              .
            









FIGURE P2-11










2-12
          In
          Figure P2-12
          determine which elements are in series, parallel, or neither. How many different nodes and loops are there in the circuit? Then if
          v
2
          = 3V and
          v
3
          = 5V, find
          v
1
          ,
          v
4
          , and
          v
5
          .
          







FIGURE P2-12










2-13
          In
          Figure P2-13
          ,
          i
2
          = -50 mA and
          i
4
          = 15 mA. Find
          i
1
          and
          i
3
          .
          







FIGURE P2-13









2-14
          For the circuit in
          Figure P2-14
          :
          

(a)
              Identify the nodes and at least five loops in the circuit.
            

(b)
              Is a loop made up of elements 1, 5, 4, and 3 a real loop?
            

(c)
              Is a loop made up of elements 2, 4, 6, and 3 a real loop?
            

(d)
              Identify any elements connected in series or in parallel.
            

(e)
              Repeat (d) if element 3 becomes a short circuit.
            

(f)
              Write KCL and KVL connection equations for the circuit.
            









FIGURE P2-14










2-15
          In
          Figure P2-14
v
2
          = 30V,
          v
3
          = - 20 V, and
          v
4
          =6V.  Find
          v
1
          ,
          v
5
          , and
          v
6
          .
        

2-16
          The circuit in
          Figure P2-16
          is organized around the three signal lines A, B, and C.
          

(a)
              Identify the nodes and at least five loops in the circuit.
            

(b)
              Write KCL connection equations for the circuit.
            

(c)
              If
              i
1
              = -30 mA,
              i
2
              = - 18 mA, and
              i
3
              = 75 mA, find
              i
4
              ,
              i
5
              , and
              i
6
              .
            

(d)
              Show that the circuit in
              Figure P2-16
              is identical to that in
              Figure P2-14
              .
            









FIGURE P2-16











2-17
(a)
          Are any of the elements in
          Figure P2-17
          in series or parallel? If so, identify the ones that are.
          

(b)
              Then if
              v
2
              =10V
              , v
4
              = 10V, and
              v
5
              = 5V, find
              v
1
              ,
              v
3
              , and
              v
6
              .
            

(c)
              Suppose that element 3 becomes shorted, i.e.,
              v
3
              =0V. Repeat part (a).
            

(d)
              Suppose one of the wires connecting element 6 to therest of the circuit broke, i.e.,
              R
wire
              = ∞Ω.
              Repeat part (a).










FIGURE P2-17









2-18
          Are any of the elements in
          Figure P2-18
          in series or parallel? If so, identify the ones that are. Then if
          i
1
          = - 5 mA,
          i
2
          = 10 mA, and
          i
3
          = -15 mA, find
          i
4
          and
          i
5
          .
          







FIGURE P2-18










2-19
(a)
          Use the passive sign convention to assign voltage variables consistent with the currents in
          Figure P2-18
          . Write three KVL connection equations using these voltage variables.
        

(b)
          If
          v
          5 = 0 V, what can be said about the voltages across all the other elements?
        

2-20
          The KVL equations for a two-loop circuit are:
          


Draw the circuit diagram and indicate the reference directions for the element voltages.






                Objective 2-3 Combined Constraints (
                Sect. 2-3
                )
              
Given a linear resistance circuit, use the element constraints and connection constraints to find selected signal variables.

                See
                Examples 2-8
                to
                2-12
                and
                Exercise 2-9
                to
                2-13
                .
              





2-21
          For the circuit in
          Figure P2-21
          , write a complete set of connection and element constraints and then find
          i
x
          ,
          v
x
          , and
          p
S
          .
          







FIGURE P2-21









2-22
          Find
          v
x
          and
          i
x
          in
          Figure P2-22
          . Remove the 33-kΩ resistor and repeat. What effect did removing the 33-kΩ resistor have on
          v
x
          and
          i
x
          ? Did the power supplied by the source change?
          







FIGURE P2-22










2-23
          A modeler wants to light his model building using miniature grain-of-wheat light bulbs connected in parallel as shown in
          Figure P2-23
          . He uses two 1.5-V "C-cells" to power his lights. He wants to use as many lights as possible but wants to limit his current drain to 500 µA to preserve the batteries. If each light has a resistance of 50 kΩ, how many lights can he install and still be under his current limit?
          







FIGURE P2-23









2-24
          In
          Figure P2-24
          :
          

(a)
              Assign a voltage and current variable to every element.
            

(b)
              Use KVL to find the voltage across each resistor.
            

(c)
              Use Ohm's law to find the current through each resistor.
            

(d)
              Use KCL to find the current through each voltage source.
            









FIGURE P2-24











2-25
          Find the power provided by the source and the current through the 68-kΩ resistor in
          Figure P2-25
          .
          







FIGURE P2-25









2-26
Figure P2-26
          shows a subcircuit connected to the rest of the circuit at four points.
          

(a)
              Use element and connection constraints to find
              v
x
              and
              i
x
              .
            

(b)
              Show that the sum of the currents into the rest of the circuit is zero.
            

(c)
              Find the voltage
              v
A
              with respect to the ground in the circuit.
            









FIGURE P2-26










2-27
Figure P2-27
          shows a resistor with one terminal connected to ground and the other connected to an arrow. The arrow symbol is used to indicate a connection to one terminal of a voltage source whose other terminal is connected to ground. The label next to the arrow indicates the source voltage at the ungrounded terminal. Find the voltage across, current through, and power dissipated in the resistor.
          







FIGURE P2-27









2-28
          A circuit similar to the one shown in
          Figure P2-28
          is used in flash comparator circuits studied later. Find the voltages
          v
1
          ,
          v
2
          , and
          v
3
          .
          







FIGURE P2-28













                Objective 2-4 Equivalent Circuits (
                Sect. 2-4
                )
              

(a) Given a circuit consisting of linear resistors, find the equivalent resistance between a specified pair of terminals.
(b) Given a circuit consisting of a source-resistor combination, find an equivalent source-resistor circuit.


                See
                Examples 2-13
                to
                2-15
                and
                Exercises 2-14
                to
                2-18
                .
              





2-29
          Find the equivalent resistance
          R
EQ
          in
          Figure P2-29
          .
          







FIGURE P2-29









2-30
          Find the equivalent resistance
          R
EQ
          in
          Figure P2-30
          .
          







FIGURE P2-30











2-31
Figure P2-31
          shows a circuit with two switches.
          

(a)
              How would you select the switches (open or closed) to achieve an
              R
EQ
              of 167 Ω
              ?


(b)
              How would you select the switches (open or closed) to achieve an
              R
EQ
              of 100 Ω
              ?


(c)
              How would you select the switches (open or closed) to achieve an
              R
EQ
              of 200 Ω
              ?


(d)
              How would you select the switches (open or closed) to achieve an
              R
EQ
              of 267 Ω
              ?










FIGURE P2-31









2-32
          Find
          R
EQ
          between nodes A and B for each of the circuits in
          Figure P2-32
          . What conclusion can you draw about resistors of the same value connected in parallel?
          







FIGURE P2-32










2-33
          In
          Figure P2-33
          find the equivalent resistance between terminals A-B, A-C, A-D, B-C, B-D, and C-D when the switch is open. Repeat for when the switch is closed.
          







FIGURE P2-33









2-34
          In
          Figure P2-34
          find the equivalent resistance between terminals A-B, A-C, A-D, B-C, B-D, and C-D.
          







FIGURE P2-34










2-35
          Using no more than four 1-kΩ resistors, all but one of the following equivalent resistors can be constructed: 1 kΩ,2kΩ
          ,
          500 Ω
          ,
          1.5 kΩ
          ,
          2.5 kΩ,3kΩ
          ,
          333 Ω
          ,
          250 Ω
          ,
          1.33 kΩ
          ,
          2.33 kΩ
          ,
          and 4 kΩ
          .
          Which one cannot be constructed with only four 1-kΩ resistors? Show how you would construct the others.
        

2-36
          Do a source transformation at terminals A and B for each practical source in
          Figure P2-36
          .
          







FIGURE P2-36










2-37
          Find the equivalent circuit at terminals A-B for each of the circuits shown in
          Figure P2-37
          .
          







FIGURE P2-37










2-38

          In
          Figure P2-38
          select a value for
          R
X
          so that
          R
EQ1
          = 73 kΩ. Then find
          R
EQ2








FIGURE P2-38










2-39
          Two 10-kΩ potentiometers (a variable resistor whose value between the two ends is 10 kΩ and between one end and the wiper—the third terminal—can range from 0Ω to 10 kΩ) are connected as shown in
          Figure P2-39
          . What is the range of
          R
EQ
          ?
          







FIGURE P2-39









2-40
          Find the equivalent practical voltage source of the circuit shown in
          Figure P2-40
          .
          







FIGURE P2-40










2-41
          Find the equivalent resistance between terminals A and B in
          Figure P2-41
          .
          







FIGURE P2-41













                Objective 2-5 Voltage and Current Division (
                Sect. 2-5
                )
              

(a) Given a linear resistive circuit with elements connected in series or parallel, use voltage or current division to find specified voltages or currents.
(b) Design a voltage or current divider that delivers specified output signals.


                See
                Examples 2-16
                to
                2-24
                and
                Exercises 2-19
                to
                2-26
                .
              




2-42
          Use voltage division in
          Figure P2-42
          to find
          v
x
          ,
          v
y
          , and
          v
z
          : Then show that the sum of these voltages equals the source voltage.
          







FIGURE P2-42










2-43
          Use current division in
          Figure P2-43
          to find
          i
x
          ,
          i
y
          , and
          i
z
          . Then show that the sum of these currents equals the source current.
          







FIGURE P2-43










2-44
          Find
          i
x
          ,
          i
y
          , and
          i
z
          in
          Figure P2-44
          .
          







FIGURE P2-44










2-45
          Find
          v
O
          in the circuit of
          Figure P2-45
          .
          







FIGURE P2-45









2-46

          You wish to drive a 1-kΩ load from your car battery as shown in
          Figure P2-46
          . The load needs 5 V across it to operate correctly. Where should the wiper on the potentiometer be set (
          R
x
          ) to obtain the desired output voltage?
          







FIGURE P2-46










2-47

          Design a circuit that will deliver 3 V ±5% to a 1-kΩ load from a 10-V source. The practical source has a 50-Ω series resistor. The load needs at least 1 mA to function properly. Use ±5% resistors from
          Appendix G
          in your solution.
          







FIGURE P2-47









2-48

Figure P2-48
          shows a voltage bridge circuit, that is, two voltage dividers in parallel with a source
          v
S
          . One resistor
          R
X
          is variable. The goal is often to "balance" the bridge by making
          v
x
          = 0V. Derive an expression for
          R
X
          in terms of the other resistors for when the bridge is balanced.
          







FIGURE P2-48










2-49

          Consider the circuit in
          Figure P2-49
          . The task is to deliver 25 V to the load. For each of the two interfaces provided, determine the value of
          R
P
          or
          R
S
          needed to deliver the desired voltage to the load. Which interface results in the least power needed from the source?
          







FIGURE P2-49










2-50

          Select a value of
          R
x
          in the circuit of
          Figure P2-50
          so that
          v
L
          = 4 V. Validate your answer using Multisim.
          







FIGURE P2-50













                Objective 2-6 Circuit Reduction (
                Sect. 2-6
                )
              


                Given a linear resistive circuit, find selected signal variables using successive application of series and parallel equivalence, source transformations, and voltage and current division.
              

                See
                Examples 2-25
                to
                2-28
                and
                Exercises 2-27
                to
                2-31
                .
              





2-51
          Use circuit reduction to find
          v
x
          and
          i
x
          in
          Figure P2-51
          .
          







FIGURE P2-51










2-52
          Use circuit reduction to find
          v
x
          ,
          i
x
          , and
          p
x
          in
          Figure P2-52
          . Repeat using Multisim.
          







FIGURE P2-52










2-53
          Use circuit reduction to find
          v
x
i
x
          , and
          p
x
          in
          Figure P2-53
          .
          







FIGURE P2-53









2-54
          Find
          R
X
          in the circuit of
          Figure P2-54
          .
          







FIGURE P2-54










2-55
          Use source transformation to find
          i
x
          in
          Figure P2-55
          .
          







FIGURE P2-55









2-56
          Select a value for
          R
x
          so that
          i
x
          = 0 A in
          Figure P2-56
          .
          







FIGURE P2-56











2-57
          The current through
          R
L
          in
          Figure P2-57
          is 200 mA. Use source transformations to find
          R
L
          . Validate your answer using Multisim.
          







FIGURE P2-57










2-58

          The box in the circuit in
          Figure P2-58
          is a resistor,
          R
X
          , whose value can be anywhere between 100Ω and 1 MΩ.
          

(a)
              Use circuit reduction to find the range of values of
              v
X
              .
            

(b)
              Use Multisim's "Parameter Sweep" analysis to show the variation of the output
              v
X
              with respect to
              R
X
              .
            

(c)
              Use the results and the cursor to find the value of
              R
X
              that yields a
              v
X
              of 10 V. Repeat for 5 V and again for 2.5 V.
              
                (
                Hint
                : In drawing your circuit use any value resistor as
                R
X
                . Label
                v
X
                on your diagram by clicking on the node. Then under "Analyses and simulations" select "Parameter Sweep." Under "Device type" select "Resistor" from the pull-down menu. Then select the resistor you want to vary,
                R
X
                , in the diagram. Select "resistance" for the "Parameter" option. Under "Points to sweep" select "Decade" under "Sweep variation type." Then start the sweep at 100 Ω and the stop 1 MΩ. To smooth out the curve select "5" under "Number of points per decade." The "Analysis to sweep" is DC Operating Point. Then go up to the top of the Parameter Sweep window and select the Output tab. Choose
                v
X
                as the output you want Multisim to plot versus the
                R
X
                . Then press "Run.")
              










FIGURE P2-58













                Objective 2-7 Computer-Aided Circuit Analysis (
                Sect. 2-7
                )
              


                Given an appropriate linear circuit, use circuit simulation and/ or computational software to solve for the desired response.
              

                See
                Example 2-29
                and
                Exercise 2-32
                and also examples in
                Appendix D
                .
              






2-59
          Use Multisim to find all the currents and voltages in the  circuit of
          Figure P2-54
          .
        


2-60
          Use Multisim to find all the currents and voltages in the circuit of
          Figure P2-55
          .
        



2-61
          Use Multisim to find
          i
x
          ,
          v
x
          , and
          p
x
          in the circuit of
          Figure P2-52
          .
        


2-62
          Use Multisim to show the power balance in the circuit of
          Figure P2-51
          , that is, that the sum of the power in the circuit equals zero.
        



2-63
          Consider the circuit of
          Figure P2-63
          .
          

(a)
              Use MATLAB to find all of the voltages and currents in the circuit and find the power provided by the source.
            

(b)
              Use MATLAB to find the input resistance that the source sees,
              R
IN
              .
            









FIGURE P2-63











Integrating Problems



2-64

          Source and Design Selection.
          
            You are a head intern overseeing three junior interns. A sensor that is modeled by a 100-Ω resistor requires five volts to operate correctly. You ask the three interns to design a power circuit for the sensor. Their designs are shown in
            Figure P2-64
            . The sources all have a 50-Ω internal resistance which needs to be accounted for. Choose the best design considering parts, source and load power, load voltage, standard values, etc. Explain your choice.
          








FIGURE P2-64









2-65

          Nonlinear Device Characteristics
          
            The circuit in
            Figure P2-65
            is a parallel combination of a 75-Ω linear resistor and a varistor whose
            i-v
            characteristic is
            i
V
            = 38×10
            -3
v
3
            . For a small voltage, the varistor current is quite small compared to the resistor current. For large voltages, the varistor dominates because its current increases more rapidly with voltage.
          


(a)
              Plot the
              i-v
              characteristic of the parallel combination.
            

(b)
              State whether the parallel combination is linear or nonlinear, active or passive, and bilateral or nonbilateral.
            

(c)
              Find the range of voltages over which the resistor current is at least 10 times as large as the varistor current.
            

(d)
              Find the range of voltages over which the varistor current is at least 10 times as large as the resistor current.
            









FIGURE P2-65









2-66

          Center Tapped Voltage Divider
          
Figure P2-66
            shows a voltage divider with the center tap connected to ground. Derive equations relating
            v
A
            and
            v
B
            to
            v
S
            ,
            R
1
            , and
            R
2
            .
          








FIGURE P2-66










2-67

          Thermocouple Alarm Sensor
          
            A type-K thermocouple produces a voltage that is proportional to temperature. The characteristic of a type-K thermocouple is shown in
            Figure P2-67
            (a). In an application, this transducer is used to detect when the temperature reaches 1250°C and then to cause a safety shutoff to trip and stop an operation. The safety shutoff can be modeled by a 5-kΩ input resistance, while the transducer can be modeled by a variable voltage source,
            v
            (T), in series with a resistance of 33 Ω to account for the transducer's wires and internal resistance as shown in
            Figure P2-67
            (b). The safety shutoff will trip when exactly 10 mV is applied. Select an appropriate resistance
            R
            that will cause the safety shutoff to trip at exactly 1250°C.
          








FIGURE P2-67









2-68

          Active Transducer
          
Figure P2-68
            shows an active transducer whose resistance
            R
            (
            V
T
            ) varies with the transducer voltage
            V
T
            as
            R
            (
            V
T
            ) = 0.5
            V
T
2
            + 1. The transducer supplies a current to a 12-Ω load. At what voltage will the load current equal 100 mA?
          








FIGURE P2-68










2-69

          Interface Circuit Choice
          
            You have a practical current source that can be modeled as a 15-V ideal source in series with a 1-kΩ source resistor. You need to use your source to drive a 1-kΩ load that requires exactly 3 V across it. Two solutions are provided to you as shown in
            Figure P2-69
            . Validate that both meet the requirement, then select the best solution, and give the reason for your choice. Consider part count, standard parts, accuracy of meeting the spec, power consumed by the source, etc. Validate your results using Multisim.
          








FIGURE P2-69









2-70

          Programmable Voltage Divider
          
Figure P2-70
            shows a programmable voltage divider in which digital inputs
            b
0
            and
            b
1
            control complementary analog switches connecting a multitap voltage divider to the analog output
            v
O
            .
          

            The switch positions in the figure apply when digital inputs are low. When inputs go high the switch positions reverse. Find the analog output voltage for (
            b
1
            ,
            b
0
            ) = (0,0), (0,1), (1,0), and (1,1) when
            V
REF
            = 12V.
          








FIGURE P2-70










2-71



          Analog Voltmeter Design
          
Figure P2-71
            (a) shows a voltmeter circuit consisting of a D'Arsonval meter, two series resistors, and a two-position selector switch. A current of
            I
FS
            = 400 µA produces full-scale deflection of the D'Arsonval meter, whose internal resistance is
            R
M
            = 25Ω.
          


(a)

              Select the series resistance
              R
1
              and
              R
2
              so that a voltage
              v
x
              = 100 V produces full-scale deflection when the switch is in position A, and voltage
              v
x
              = 10 V produces full-scale deflection when the switch is in position B.
            

(b)

              What is the voltage across the 20-kΩ resistor in
              Figure P2-71
              (b)? What is the voltage when the voltmeter in part (a) is set to position A and connected across the 20-kΩ resistor? What is the percentage error introduced connecting the voltmeter?
            

(c)

              A different D'Arsonval meter is available with an internal resistance of 100 Ω and a full-scale deflection current of 100 µA. If the voltmeter in part (a) is redesigned using this D'Arsonval meter, would the error found in part (b) be smaller or larger? Explain.
            









FIGURE P2-71










2-72

          MATLAB Function for Parallel Equivalent Resistors
          Create a MATLAB function to compute the equivalent resistance of a set of resistors connected in parallel. The function has a single input, which is a vector containing the values of all of the resistors in parallel, and it has a single output, which is the equivalent resistance. Name the function "EQparallel" and test it with at least three different resistor combinations. At least one test should have three or more resistor values.



2-73

          Finding an Equivalent Resistance Using Multisim
          
            Use Multisim to find the equivalent resistance at terminals A and B of the resistor mesh shown in
            Figure P2-73
            . (
            Hint:
            Use a 1-V dc source and measure the current provided by the source.)
          








FIGURE P2-73









2-74

          e-Car Battery Pack
          An all-electric roadster requires a battery module that can deliver 375 V and 90 kWh. A battery manufacturer can deliver a single Li-ion cell that produces 3.7 V at 3400 mAh. Design a suitable module by combining sufficient cells to meet the specification. How many total cells are needed for the application?






Notes




1

          A curve
          i
          =
          f
          (
          v
          ) has odd symmetry if
          f
          (-
          v
          ) = -
          f
          (
          v
          ).
        


2

          Dual circuits have identical behavior patterns when we interchange the roles of the following parameters: (1) voltage and current, (2) series and parallel, and (3) resistance and conductance. In later chapters, we will see duality exhibited by other circuit parameters as well.
        


3

          Discrete standard-value resistors, such as those listed in
          Appendix G
          , are typically rated with a tolerance of 20%, 10%, 5%, or other. The value of a given resistor, say 1 kΩ, represents a nominal value of resistance of 1000 Ω. Depending on the resistor's tolerance, it can vary by the range of the tolerance. Hence, a 1-kΩ resistor of 20% tolerance can vary between ±20% of the nominal value or from 800 to 1200 Ω.
        













CHAPTER 3

CIRCUIT ANALYSIS TECHNIQUES






Assuming any system of linear conductors connected in such a manner that to the extremities of each one of them there is connected at least one other, a system having electromotive forces E
1
            ,
            E
2
            ,
            E
3
            ...,
            no matter how distributed, we consider two points A and A
            ′
            belonging to the system and having potentials V and V
            ′
            . If the points A and A
            ′
            are connected by a wire ABA
            ′,
            which has a resistance r, with no electromotive forces, the potentials of points A and A
            ′
            assume different values from V and V
            ′,
            but the current i flowing through this wire is given by i
            = (
            V - V
            ′)/(
            r
            +
            R
            )
            in which R represents the resistance of the original wire, this resistance being measured between the points A and A
            ′,
            which are considered to be electrodes.


            Leon Charles Thévenin, 1883,
            
            French Telegraph Engineer
          






Some History Behind This Chapter
Leon Charles Thévenin (1857-1926), a distinguished French telegraph engineer and teacher, was led to his theorem in 1883 following an extensive study of Kirchhoff's laws. Norton's theorem, the dual of Thévenin's theorem, was not proposed until 1926 by Edward L. Norton, an American electrical engineer working on long-distance telephony. Curiously, it turns out that the basic concept had been discovered earlier by Hermann von Helmholtz while studying electricity in animal tissue. Electrical engineering tradition credits Thé-venin and Norton, perhaps because they worked in areas that offered practical applications for their results.









Why This Chapter Is Important Today
In this chapter you advance to studying general methods of analyzing circuits and to the major theorems that describe linear circuits. These theorems are conceptual tools that give new insight into circuit behavior. Most importantly, you will be introduced to the design of interface circuits; your first exposure to devising a circuit to perform a predetermined function.









Chapter Sections



3-1 Node-Voltage Analysis






3-2 Mesh-Current Analysis






3-3 Linearity Properties






3-4 Thévenin and Norton Equivalent Circuits






3-5 Maximum Signal Transfer






3-6 Interface Circuit Design












Chapter Learning Objectives

3-1
              General Circuit Analysis (
              Sectsx. 3-1
              and
              3-2
              )
            
Given a linear resistance circuit:

(a) (Formulation) Write node-voltage or mesh-current equations for the circuit.
(b) (Solution) Solve the equations from (a) for selected signal variables or input-output relationships using classical or software computational techniques.


3-2
              Linearity Properties (
              Sect. 3-3
              )
            
Given a linear resistance circuit:

(a) Use the proportionality principle to find selected signal variables.
(b) Use the superposition principle to find selected signal variables.


3-3
              Thévenin and Norton Equivalent Circuits (
              Sect. 3-4
              ) Given a linear resistance circuit:
            

(a) Find the Thévenin or Norton equivalent at a specified pair of terminals.
(b) Use the Thévenin or Norton equivalent to find the signals delivered to linear or nonlinear loads.


3-4
              Maximum Signal Transfer (
              Sect. 3-5
              )
            
Given a linear resistance circuit:

(a) Find the maximum voltage, current, and power available at a specified pair of terminals.
(b) Find the resistive loads required to obtain the maximum available signal levels.


3-5
              Interface Circuit Design (
              Sect. 3-6
              )
            
Given the signal transfer goals at a source-load interface, design one or more two-port interface circuits to achieve the goals and evaluate the alternative design solutions.






          3-1 Node-Voltage Analysis
        

          Before describing node-voltage analysis, we first review the foundation for every method of circuit analysis. As noted in
          Sect. 2-3
          , circuit behavior is based on constraints of two types: (1) connection constraints (Kirchhoff's laws) and (2) device constraints (element
          i-v
          relationships). As a practical matter, however, using element voltages and currents to express the circuit constraints produces a large number of equations that must be solved simultaneously to find the circuit responses. For example, a circuit with only six devices requires us to treat 12 equations with 12 unknowns. Although this is not an impossible task using software tools such as MATLAB, it is highly desirable to reduce the number of equations that must be solved simultaneously.
        
You should not abandon the concept of element and connection constraints. This method is vital because it provides the foundation for all methods of circuit analysis. In subsequent chapters, we use element and connection constraints many times to develop important ideas in circuit analysis.








FIGURE 3-1




Node-voltage definition and notation.




          Using node voltages instead of element voltages as circuit variables can reduce the number of equations that must be treated simultaneously. To define a set of node voltages, we first select a reference node, usually ground. The
          node voltages
          are then defined as the voltages between the remaining nodes and the selected reference node.
          Figure 3-1
          shows the notation used to define node-voltage variables. In this figure, the reference node is indicated by the ground symbol, and the node voltages are identified by a voltage symbol next to all the other nodes. This notation means that the positive reference mark for the node voltage is located at the node in question, whereas the negative mark is at the reference node. Obviously, any circuit with
          N
          nodes involves
          N -
          1 node voltages since one node, the reference node, is known.
        

          A fundamental property of node voltages needs to be covered at the outset. Suppose we are given a two-terminal element whose element voltage is labeled
          v
1
          . Suppose further that the terminal with the plus reference mark is connected to a node, say node A. The two cases shown in
          Figure 3-2
          are the only two possible ways the other element terminal can be connected. In case A, the other terminal is connected to the reference node, in which case KVL requires
          v
1
          =
          v
A
          . In case B, the other terminal is connected to a nonreference node, say node B, in which case KVL requires
          v
1
          =
          v
A
          -
          v
B
          . This example illustrates the following fundamental property of node voltages:
        








FIGURE 3-2




Two possible connections of a two-terminal element.






If the Kth two-terminal element is connected between nodes X and Y, then the element voltage can be expressed in terms of the two node voltages as






(3-1)









                where X is the node connected to the positive reference for element voltage v
                K
                .
              




Equation (3-1)
          is a KVL constraint at the element level. If node
          Y
          is the reference node, then by definition
          
            v
            Y

          = 0 and
          Eq. (3-1)
          reduces to
          
            v
            K

          =
          
            v
            X

          . On the other hand, if node
          X
          is the reference node, then
          
            v
            X

          = 0 and therefore
          
            v
            K

          = -
          
            v
            Y

          . The minus sign occurs here because the positive reference for the element is connected to the reference node. In any case, the important fact is that the voltage across any two-terminal element can be expressed as the difference of two node voltages, one of which may be zero.
        






Exercise 3-1


              The circuit of
              Figure 3-3
              is referred to as a "bridge circuit" because element 3
              bridges
              across two nodes that are connected to the reference node. We will examine circuits of this type later in several chapters. For now, if the reference node is 0 V and node voltages in the bridge are
              v
A
              = 5V,
              v
B
              = 10 V, and
              v
C
              = - 3 V, find the element voltages.
            
Answers:

v
1
              = 10 V;
              v
2
              = 3 V;
              v
3
              = 13 V;
              v
4
              = 8 V;
              v
5
              = - 5 V
            










FIGURE 3-3














Exercise 3-2




              For the circuit in
              Figure 3-4
              , first find the node voltages and then find
              v
X
              and
              v
Y
              .
            
Answers:

v
A
              = 5 V,
              v
B
              = -4 V,
              v
C
              = 6 V,
              v
D
              = 0 V (ground).
              v
X
              =
              v
A
              -
              v
B
              = 9 V and
              v
Y
              =
              v
A
              -
              v
C
              = - 1 V.
            










FIGURE 3-4








Formulating Node-Voltage Equations
To formulate a circuit description using node voltages we use element and connection analysis, except that the KVL connection equations are not explicitly written. Instead, we use the fundamental property of node analysis to express the element voltages in terms of the node voltages.

            The circuit in
            Figure 3-5
            demonstrates the formulation of node-voltage equations. In
            Figure 3-5
            , we have identified a reference node (indicated by the ground symbol), four element currents (
            i
0
            ,
            i
1
            ,
            i
2
            , and
            i
3
            ), and two node voltages (
            v
A
            and
            v
B
            ).
          








FIGURE 3-5




Circuit for demonstrating node-voltage analysis.



The KCL constraints at the two nonreference nodes are as follows:



(3-2)





Using the fundamental property of node analysis, we use the element equations to relate the element currents to the node voltages.



(3-3)






            We have written six equations in six unknowns—four element currents and two node voltages. The element equations on the right side of
            Eqs. (3-3)
            involve unknown node voltages and the input signal
            i
S
            . Substituting the device constraints in
            Eqs. (3-3)
            into the KCL connection constraints in
            Eqs. (3-2)
            yields
          



which can be arranged in the following standard form:



(3-4)




In this standard form, all of the unknown node voltages are grouped on one side and the independent sources on the other. This will facilitate the analysis.


            By systematically eliminating the element currents, we have reduced the circuit description to two linear equations in the two unknown node voltages. The coefficients in the equations on the left side (1/
            R
1
            + 1/
            R
2
            , 1/
            R
2
            , 1/
            R
2
            + 1/
            R
3
            ) depend only on circuit parameters, whereas the right side contains the known input driving force
            i
S
            .
          

            As noted previously, every method of circuit analysis must satisfy KVL, KCL, and the device
            i-v
            relationships. In developing the node-voltage equations in
            Eqs. (3-4)
            , it may appear that we have not used KVL. However, KVL is satisfied because the equations
            v
1
            =
            v
A
            ,
            v
2
            =
            v
A
            -
            v
B
            , and
            v
3
            =
            v
B
            were used to write the right side of the element equations in
            Eqs. (3-3)
            . The KVL constraints do not appear explicitly in the formulation of node equations, but they are implicitly included when the fundamental property of node analysis is used to write the element voltages in terms of the node voltages.
          
In summary, four steps are needed to develop node-voltage equations.



STEP 1


                Select a reference node. Identify a node voltage at each of the remaining
                N-
                1 nodes and a current with every element in the circuit.
              



STEP 2


                Write KCL connection constraints in terms of the element currents at the
                N-
                1 nonreference nodes.
              



STEP 3


                Use the
                i-v
                relationships of the elements and the fundamental property of node analysis to express the element currents in terms of the node voltages.
              



STEP 4


                Substitute the element constraints from step 3 into the KCL connection constraints from step 2 and arrange the resulting
                N-
                1 equations in a standard form.
              



            Writing node-voltage equations leads to 
            N- 
            1 equations that must be solved simultaneously. If we write the element and connection constraints in terms of element voltages and currents, we must solve 2
            E 
            simultaneous equations. The node-voltage method reduces the number of linear equations that must be solved simultaneously to
            N-  
            1. The reduction from   
            2E  
            to   
            N-   
            1 is particularly impressive in circuits with a large number of elements (large
            E
            ) connected in parallel (small 
            N 
            ). 
          












EXAMPLE 3-1


  
                    Formulate node-voltage equations for the bridge circuit in
                    Figure 3-6   
                    . 
                  













FIGURE 3-6









SOLUTION:





STEP 1


                    The reference node, node voltages, and element currents are shown in
                    Figure 3-6
                    .
                  



STEP 2

The KCL constraints at the three nonreference nodes are as follows:







STEP 3

We write the element equations in terms of the node voltages and input signal sources.







STEP 4

Substituting the element equations into the KCL constraints and arranging the result in standard form yields three equations in the three unknown node voltages.





The three equations in three unknowns can be written in matrix form. Missing terms are zeros in the matrix.




                This matrix equation is of the form
                Ax
                =
                b,
                where
                A
                is a 3 × 3 square matrix describing the circuit,
                x
                is a 3 × 1 column matrix of unknown node voltages, and
                b
                is a 3 × 1 column matrix of known inputs. Note that matrix
                A
                is symmetrical, that is, the terms on either side of the major diagonal, shown as a dashed line through the matrix, are the same.
                ■














Exercise 3-3


                For the circuit in
                Figure 3-6
                replace the current source
                i
S2
                with a resistor
                R
5
                .
              


                  (a) Using the same node designations and reference node, formulate node-voltage equations for the modified circuit. Place the result in matrix form
                  Ax
                  =
                  b.


                  (b) Is the resulting
                  A
                  matrix symmetrical?
                

Answers:


                  (a)
                  

(b) Yes; see terms on either side of the diagonal above.











Exercise 3-4


                Formulate node-voltage equations for the circuit in
                Figure 3-7
                and place the results in matrix form
                Ax
                =
                b.
                Is the resulting matrix
                A
                symmetrical?
              
Answers:



Yes, the matrix is symmetrical










FIGURE 3-7









Writing Node-Voltage Equations by Inspection


            The node-voltage equations derived in
            Example 3-1
            have a symmetrical pattern, as shown by the dashed line drawn along the major diagonal. The coefficient of
            v
B
            in the node A equation and the coefficient of
            v
A
            in the node B equation are each the negative of the conductance connected between the nodes (-1/
            R
1
            ). Likewise, the coefficients of
            v
C
            in the node A equation and
            v
A
            in the node C equation are -1/
            R
2
            . The coefficients of
            v
A
            in the node A equation,
            v
B
            in the node B equation, and
            v
C
            in the node C equation are the sum of the conductances connected to the node in question. The two missing terms or zeros also fall symmetrically about the diagonal.
          

            This symmetrical pattern always occurs in circuits containing only resistors and independent current sources. To understand why, consider any general two-terminal resistance
            R
            with one terminal connected to, say, node A. Then, according to the fundamental property of node analysis, there are only two possibilities. The other terminal of
            R
            is either connected to the reference node, in which case the current
            
leaving

            node A via resistance
            R
            is
          




            or to another nonreference node, say, node B, in which case the current
            
leaving

            node A via
            R
            is
          




            The pattern for node equations follows from these observations. The sum of the currents
            
leaving

            any node A via resistances is
          



1.
v
A
                times the sum of conductances connected to node A.
              



2.
                Minus
                v
B
                times the sum of conductances connected between nodes A and B.
              



3.
                Minus similar terms for all other nodes connected to node A by conductances.
              


Because of KCL, the sum of currents leaving node A via resistances plus the sum of currents directed away from node A by independent current sources must equal zero.

            Understanding the aforementioned process allows us to write node-voltage equations by inspection without going through the intermediate steps involving the KCL constraints and the element equations or even labeling currents. For example, the circuit in
            Figure 3-8
            contains two independent current sources and four resistors. Starting with node A, the sum of conductances connected to node A is l/
            R
1
            + 1/
            R
2
            . The conductance between nodes A and B is 1/
            R
2
            . The reference direction for the source current
            i
S1
            is into node A and for
            i
S2
            is directed away from node A. Pulling all of the observations together, we write the sum of currents directed out of node A as
          



(3-5)












FIGURE 3-8




Circuit for demonstrating how to write node-voltage equations by inspection.




            Similarly, the sum of conductances connected to node B is 1/
            R
2
            + 1/
            R
3
            + 1/
            R
4
            , the conductance connected between nodes B and A is again 1/
            R
2
            , and the source current
            i
S2
            is directed toward node B. These observations yield the following node-voltage equation.
          



(3-6)





            Rearranging
            Eqs. (3-5)
            and
            (3-6)
            in standard form yields
          


(3-7)





            In the matrix form
            Ax
            =
            b,
            where
            A
            is a 2 × 2 square matrix describing the circuit,
            x
            is a 2 × 1 column matrix of unknown node voltages, and
            b
            is a 2 × 1 column matrix of known inputs, we can express the equations as
          




            We have two symmetrical equations in the two unknown voltages. The equations are symmetrical as seen by the dashed line because the resistance
            R
2
            connected between nodes A and B appears as the cross-coupling term in each equation.
          












EXAMPLE 3-2



                    Formulate node-voltage equations for the bridge-T circuit in
                    Figure 3-9
                    .
                  













FIGURE 3-9









SOLUTION:



                The total conductance connected to node A is 1/(2
                R
                ) + 2/
                R
                = 2.5/
                R
                , to node B is 1/(2
                R
                ) + 2/
                R
                + 1/(2
                R
                ) = 3/
                R
                , and to node C is 2/
                R
                + 1/
                R
                + 1/(2
                R
                ) = 3.5/
                R.
                The conductance connected between nodes A and B is
                1
                /(2
                R
                ), between nodes A and C is 2/
                R
                , and between nodes B and C is 1/(2
                R
                ). The independent current source is directed into node A. By inspection, the node-voltage equations are as follows:
              




                Written in matrix form
                Ax= b,





                Note that the
                A
                matrix is symmetrical.
                ■















Exercise 3-5



                Formulate node-voltage equations for the circuit in
                Figure 3-10
                .
              
Answers:













FIGURE 3-10










Solving Linear Algebraic Equations

            So far we have dealt only with the problem of formulating node-voltage equations. To complete a circuit analysis problem, we must solve these linear equations for selected responses. A system of linear algebraic equations can be solved through manual calculations or with the aid of a computer. Skilled engineers should be familiar with both techniques and should develop the judgment to know when each type of
            
            approach is appropriate. In choosing between manual and computer-aided methods, you may consider the following four factors:
          

The number of unknown responses (the order of the problem)
The number of parameters in symbolic versus numeric form
Your skill in performing manual calculations
The availability of and your proficiency with computer tools


            In general, you can efficiently use manual techniques to solve lower-order problems with numeric parameters. Cramer's rule and Gaussian elimination are standard mathematical tools commonly used for manual solutions.
            Appendix A
            provides a brief review of these techniques.
          

            As the order of the problem increases or if symbolic parameters are present, it usually becomes more efficient to use an advanced calculator or computer tools, such as MATLAB, to find the desired responses. Many scientific handheld calculators have a built-in capability to solve linear equations when all of the parameter values are numeric. Alternatively, circuit simulation software such as Multisim can be a good choice for solving circuit equations when all of the parameters have numeric values. MATLAB can efficiently solve linear systems of equations with either numeric or symbolic parameter values. To include symbolic parameters in MATLAB code, use either the sym or syms command to define the parameters and then proceed with the normal matrix-based solution to the problem. See
            Appendix D
            for additional guidance using MATLAB.
          

            Earlier in this section, we formulated node-voltage equations for the circuit in
            Figure 3-5
            [see
            Eqs. (3-4)
            ].
          




            This problem is formulated with two unknown responses (
            v
A
            and
            v
B
            ) and has three symbolic parameters
            (R
1
            ,
            R
2
            , and
            R
3
            ). In this case, Cramer's rule would be a suitable manual technique for finding the responses, but we will illustrate the solution using MATLAB to handle the symbolic parameters.
            

Note:


            MATLAB uses the
            Courier
            font in displaying its commands, codes, and results.
          
First, define the symbolic parameters:

syms R1 R2 R3 iS real


            Now formulate the problem in matrix notation, using the
            Ax
            =
            b
            structure as follows:
          




The resulting solutions are given by




We can write these solutions compactly as





            The results express the two node voltages in terms of the circuit parameters and the input signals. Given the two node voltages
            v
A
            and
            v
B
            , we can now determine every element voltage and every current using Ohm's law and the fundamental property of node voltages.
          




            In solving the node equations, we left everything in symbolic form to emphasize that the responses depend on the values of the circuit parameters
            R
1
            ,
            R
2
            , and
            R
3
            ) and the input signal (
            i
S
            ). Even when numerical values are given, it is sometimes useful to leave some parameters in symbolic form to obtain input-output relationships or to reveal the effect of specific parameters on the circuit response.
          












EXAMPLE 3-3


                    Given the bridge-T circuit in
                    Figure 3-11
                    , find the input resistance
                    R
IN
                    seen by the current source and the output voltage
                    v
O
                    . Solve this problem by hand and then using MATLAB.
                  










FIGURE 3-11









SOLUTION:



                In
                Example 3-2
                , we formulated node-voltage equations for this circuit as follows:
              




                First we will solve the problem using Cramer's rule (See
                Appendix A
                ) and then we will solve it again using MATLAB.
              

                The input resistance
                R
IN
                is the ratio
                
                , whereas the output voltage is simply
                v
C
                .
              

                We solve for both
                v
A
                and
                v
C
                using Cramer's rule as follows:
              

                Rewrite the three node equations after multiplying both sides of each equation by
                R
                as follows:
              





                Then write as a matrix
                Ax=b




Then








                And
              




                Now using MATLAB, we solve for the voltages
                v
A
                and
                v
C
                beginning with
                v
A
                as follows:
              




The result is given by




which can be expressed compactly as:



The input resistance can be found by adding the following to the code:




which yields




                The output voltage is
                v
C
                , which we found at the same time as
                v
A
                above.
              




This result is given by




which can be expressed compactly as


■














Exercise 3-6


                Solve the node-voltage equations in
                Exercise 3-5
                for
                v
O
                in
                Figure 3-10
                .
              
Answers:

v
O
                = 1000(
                i
S1
                -3
                i
S2
                )/7 V
              










Exercise 3-7



                Use node-voltage equations to solve for
                v
1
,
v
2
,
                and
                i
3
                in
                Figure 3-12
                (a) below.
              
Answers:

v
1
                = 12 V;
                v
2
                = 32V;
                i
3
                = -10 mA
              











Exercise 3-8


                Solve
                Exercise 3-7
                using Multisim.
              


Answer:



Figure 3-12
                (b) shows the results. Note that the current
                i
3
                is negative because the referenced direction is opposite of the actual direction of the current through
                R
3
                . The multimeter was connected to correspond to the reference direction.
              








FIGURE 3-12











Node Analysis with Voltage Sources
Up to this point, we have analyzed circuits containing only resistors and independent current sources. Applying KCL in such circuits is simplified because the sum of currents at a node only involves the output of current sources or resistor currents expressed in terms of the node voltages. Adding voltage sources to circuits modifies node analysis procedures because the current through a voltage source is not directly related to the voltage across it. While initially it may appear that voltage sources complicate the situation, they actually simplify node analysis by reducing the number of equations required.

Figure 3-13
            shows three ways to deal with voltage sources in node analysis. Method 1 uses a source transformation to replace the voltage source and series resistance with an equivalent current source and parallel resistance. We can then formulate node equations at the remaining nonreference nodes in the usual way. The source transformation eliminates node C, so there are only
            N
            - 2 nonreference nodes left in the circuit. Obviously, method 1 only applies when there is a resistance in series with the voltage source.
          

            Method 2 in
            Figure 3-13
            can be used whether or not there is a resistance in series with the voltage source. When node B is selected as the reference node, then by definition
            
v
B
            = 0 and the fundamental property of node voltages says that
            v
A
            =
            v
S
            . We do not need a node-voltage equation at node A because its voltage is known to be equal to the source voltage. We write the node equations at the remaining
            N
            - 2 nonreference nodes in the usual way. In the final step, we move all terms involving
            v
A
            to the right side, since it is a known input and not an unknown response. Method 2 reduces the number of node equations by 1 since no equation is needed at node A.
          








FIGURE 3-13




Three methods of treating voltage sources in node analysis.




            The third method in
            Figure 3-13
            is needed when neither node A nor node B can be selected as the reference and the source is not connected in series with a resistance. In this case, we combine nodes A and B into a
            supernode,
            indicated by the boundary in
            Figure 3-13
            . We use the fact that KCL applies to the currents penetrating this boundary to write a node equation at the supernode. We then write node equations at the remaining
            N
            - 3 nonreference nodes in the usual way. We now have
            N
            - 3 node equations plus one supernode equation, leaving us one equation short of the
            N -
            1 required. Using the fundamental property of node voltages, we can write
          


(3-8)




            The voltage source inside the supernode constrains the difference between the node voltages at nodes A and B. The voltage source constraint provides the additional relationship needed to write
            N -
            1 independent equations in
            N -
            1 node voltages.
          
For reference purposes, we will call these modified node equations, since we either modify the circuit (method 1), use voltage source constraints to define node voltage at some nodes (method 2), or combine nodes to produce a supernode (method 3). The three methods are not mutually exclusive. We frequently use a combination of methods, as illustrated in the following examples.












EXAMPLE 3-4



                    Use node-voltage analysis to find
                    v
O
                    in the circuit in
                    Figure 3-14
                    (a).
                  










FIGURE 3-14










SOLUTION:



                The circuit in
                Figure 3-14
                (a) has four nodes, so we appear to need
                N
                - 1 = 3 node-voltage equations. However, applying source transformations to the two voltage sources (method 1) produces the two-node circuit in
                Figure 3-14
                (b). For the modified circuit, we need only one node equation,
              




                To find the output voltage, we solve for
                v
B
                :
              




                Because of the two voltage sources, we need only one node equation in what appears to be a four-node circuit. The two voltage sources have a common node, so the number of unknown node voltages is reduced from three to one. The general principle illustrated is that the number of independent KCL constraints in a circuit containing
                N
                nodes and
                N
V
                voltage sources is
                N -
                1 -
                N
V
                .
                ■







            As an alternative to source transformations, for this circuit we can also apply the second method for treating voltages sources in node analysis. Since both voltage sources are connected to ground nodes,
            v
A
            and
            v
C
            are defined by the two voltage sources, that is,
            v
A
            =
            v
S1
            and
            v
C
            =
            v
S2
            . This then leaves
            v
B
            as the only unknown. We can write the equation for
            v
B
            as follows:
          




            Solving for
            v
B




which, as before, simplifies to











FIGURE 3-14














Exercise 3-9


                In
                Figure 3-14
                (a),
                v
S1

=
                  24
                
                V,
                v
S2
                = - 12 V,
                R
1
                = 3.3 kΩ,
                R
2
                = 5.6 kΩ, and
                R
3
                = 10 kΩ. Find
                v
O
                using Multisim.
              
Answers:

v
O
                = 8.82 V. See
                Figure 3-14
                (c).
              
















EXAMPLE 3-5


                    Use node-voltage analysis to find
                    v
X
                    in the circuit of
                    Figure 3-15
                    (a).
                  










FIGURE 3-15









SOLUTION:


Since the circuit does not have a ground designated, we must choose a reference node to start the node-voltage analysis. In theory, any node can be chosen as a ground, but some ground choices are better than others. Choosing a ground wisely can simplify the calculations required to find a solution. Recognize that the ground node is our zero voltage reference. Hence, selecting a node at the minus terminal of a voltage source immediately determines the voltage at the positive node to be the value of the source. In our circuit, selecting node C as our ground automatically tells us that node B is equal to 10 V. If we chose node A or node D as our reference, we would only know that the voltage between nodes B and C is equal to 10 V, which does not simplify our analysis. We could choose node B as our ground and we would automatically know that node C is equal to - 10 V. This choice is acceptable, but we prefer to work with positive voltages, so node C is a better option.
Having wisely chosen node C as our ground, we can write the following two node-voltage equations:



Collecting like terms, moving the known sources to the right side, and multiplying both equations by 1000



We can write these two equations as a matrix and solve it using Cramer's rule




                Therefore,
                v
X
                =
                V
A
                -
                V
D
                = -13.044 V.
                ■














FIGURE 3-15














                  Exercise 3-10
                  



                For the circuit of
                Figure 3-15
                (a), find
                i
X
                and
                p
X
                . Repeat using Multisim.
              
Answers:

i
X
                = 869.6 µA and
                p
X
                = -209 mW; see
                Figure 3-15
                (b).
              

















EXAMPLE 3-6




                    Find the input resistance of the circuit in
                    Figure 3-16
                    (a). Solve the problem using MATLAB.
                  










FIGURE 3-16









SOLUTION:



                Method 1 for handling voltage sources will not work here because the source in
                Figure 3-16
                (a) is not connected in series with a resistor. Method 2 will work in this case because the voltage source is connected to the reference node. As a result, we can eliminate one node equation since the node A voltage is
                v
A
                =
                v
S
                . By inspection, the four remaining node equations are as follows:
              




                We apply the equation
                v
A
                =
                v
S
                to incorporate the source voltage and eliminate
                v
A
                from the equations. With this change, we can simplify the equations and write them in matrix form (note the symmetry) as follows:
              




                In this standard form of
                Ax
                =
                b,
                we can now use MATLAB to efficiently solve for all of the node voltages. The MATLAB code required to do this is shown below.
              




The resulting solutions are given by






                We can write these results compactly as
              



To solve for the input resistance, we need to calculate the input current:



Using the MATLAB results, we get



such that


■















                  Exercise 3-11
                  



                For the circuit in
                Figure 3-16
                (a) let
                v
S
                = 120 V and
                R
                = 4 kΩ.
              

(a) Use Multisim to simulate the circuit, and find all of the node voltages and the input current.

                  (b) Verify that the results for the node voltages agree with the numeric expressions determined in the solution of
                  Example 3-6
                  .
                

                  (c) Use the input current to calculate
                  R
IN
                  and compare it with that found in
                  Example 3-6
                  .
                









FIGURE 3-16







Answers:


                  (a) See Multisim results shown in
                  Figure 3-16
                  (b) and (c).
                

                  (b) From the calculations in
                  Example 3-6
                  using
                  v
S
                  = 120 V, we get
                  


The Multisim voltages are the same.



                  (c) Using the input voltage and input current found in the Multisim simulation,
                  R
IN
                  for
                  R
                  = 4kΩ results in
                  
                  , compared to
                  
                  . Again, they are the same.
                

















EXAMPLE 3-7



                    For the circuit in
                    Figure 3-17
                    ,
                  

(a) Formulate node-voltage equations.

                      (b) Solve for the output voltage
                      v
O
                      using
                      R
1
                      =
                      R
4
                      = 2 kΩ and
                      R
2
                      =
                      R
3
                      = 4 kΩ.
                    











FIGURE 3-17









SOLUTION:



                (a) The voltage sources in
                Figure 3-17
                do not have a common node, and we cannot select a reference node that includes both sources. Selecting node D as the reference forces the condition
                v
B
                =
                v
S2
                (method 2) but leaves the other source
                v
S1
                ungrounded. Similarly, we could have equally chosen node C and forced
                v
A
                =
                v
S1
                , but it would have left the other source
                v
S2
                ungrounded. Neither is better, hence proceed with our first choice. We surround the ungrounded source, and all wires leading to it, by the supernode boundary shown in
                Figure 3-17
                (method 3). KCL applies to the four element currents that penetrate the supernode boundary, and we can write
              

i
1
                +
                i
2
                +
                i
3
                +
                i
4
                = 0
              
These currents can easily be expressed in terms of the node voltages:




                But since
                v
B
                =
                v
S2
                , the standard form of this equation is
              




                We have one equation in the two unknown node voltages
                v
A
                and
                v
C
                . Applying the fundamental property of node voltages inside the supernode, we can write
              




That is, the ungrounded voltage source constrains the difference between the two unknown node voltages inside the supernode. It thereby supplies the relationship needed to obtain two equations in two unknowns.
(b) Inserting the given numerical values yields




                To find the output
                v
O
                , we need to solve these equations for
                v
C
                . The second equation yields
                v
A
                =
                v
C
                +
                v
S1
                , which, when substituted into the first equation, gives the required output:
              


■














FIGURE 3-18














Exercise 3-12



                For the circuit in
                Figure 3-18
                (a),
              


                  (a) Find
                  v
O
                  when element
                  E
                  is a 10-kΩ resistor.
                

                  (b) Find
                  v
O
                  when element
                  E
                  is a 4-mA independent current source with reference arrow pointing left.
                

                  (c) If element
                  E
                  is a resistor
                  R
                  , what value is required for
                  R
                  such that
                  v
O
                  is 2 V?
                

Answers:



                  (a) 253 V
                
(b) - 17.3 V
(c) 115 KΩ












Exercise 3-13




                For the circuit in
                Figure 3-18
                (a),
              


                  (a) Find
                  v
O
                  when element
                  E
                  is an open circuit.
                

                  (b) Find
                  v
O
                  when element
                  E
                  is a 10-V independent voltage source with the positive reference on the right.
                
(c) Validate parts (a) and (b) using Multisim.

Answers:

(a) 1.92 V
(b) 12.96 V

                  (c) See
                  Figure 3-18
                  (b)
                











FIGURE 3-18









Summary of Node-Voltage Analysis
We have seen that node-voltage equations are very useful in the analysis of a variety of circuits. These equations can always be formulated using KCL, the element constraints, and the fundamental property of node voltages. When in doubt, always fall back on these principles to formulate node equations in new situations. With practice and experience, however, we eventually develop an analysis approach that allows us to recognize shortcuts in the formulation process. The following guidelines summarize our approach and may help you develop your own analysis style:



1.
                Simplify the circuit by combining elements in series and parallel wherever possible.
              



2.
                If not specified, select a reference node so that as many voltage sources as possible are directly connected to the reference.
              



3.
                Node equations are required at supernodes and all other nonreference nodes except those that are directly connected to the reference by voltage sources.
              



4.
                Use KCL to write node equations at the nodes identified in step 3. Express element currents in terms of node voltages or the currents produced by independent current sources.
              



5.
                Write expressions relating the node voltages to the voltages produced by independent voltage sources.
              



6.
                Substitute the expressions from step 5 into the node equations from step 4 and arrange the resulting equations in standard form.
              



7.
                Solve the equations from step 6 for the node voltages of interest. Manual techniques may be efficient for lower-order problems. Computer tools, such as MATLAB or Multisim, are usually more practical and faster for higherorder problems.
              





3-2 Mesh-Current Analysis

          Mesh currents are analysis variables that are useful in circuits containing many elements connected in series. To review terminology, a loop is a closed path formed by passing through an ordered sequence of nodes without passing through any node
          
          more than once. A mesh is a special type of loop that does not enclose any elements. For example, loops A and B in
          Figure 3-19
          are meshes, while the loop Q is not a mesh because it encloses an element,
          
X.



          Mesh-current analysis is restricted to planar circuits. A
          planar circuit
          can be drawn on a flat surface without crossovers in the "window pane" fashion shown in
          Figure 3-19
          . To define a set of variables, we associate a
          mesh current
          (
          i
A
          ,
          i
B
          ,
          i
C
          , etc.) with each window pane and assign a reference direction. The reference directions for all mesh currents are customarily taken in a clockwise sense. There is no momentous reason for this, except perhaps tradition.
        

          We think of these mesh currents as circulating through the elements in their respective meshes, as suggested by the reference directions shown in
          Figure 3-19
          (a). We should emphasize that this viewpoint is not based on the physics of circuit behavior. There are not red and blue electrons running around that somehow get assigned to mesh currents
          i
A
          or
          i
B
          . Mesh currents are variables used in circuit analysis. They are only somewhat abstractly related to the physical operation of a circuit and may be impossible to measure directly. For example, there is no way to cut the circuit in
          Figure 3-19
          to insert an ammeter that measures only
          i
E
          .
        








FIGURE 3-19




(a) Meshes in a planar circuit. (b) Relationship between mesh and element currents.




          Mesh currents have a unique feature that is the dual of the fundamental property of node voltages. If we examine
          Figure 3-19
          , we see the elements around the perimeter are contained in only one mesh, whereas those in the interior are in two meshes. In a planar circuit, any given element is contained in at most two meshes. When an element is in two meshes, the two mesh currents circulate through the element in opposite directions. In such cases, KCL declares that the net current through the element is the difference of the two mesh currents.
        
These observations lead us to the fundamental property of mesh currents:



If the Kth two-terminal element is contained in meshes X and Y, then the element current can be expressed in terms of the two mesh currents as






(3-9)









                where X is the mesh whose reference direction agrees with the reference direction of i
                K
                .
              




Equation (3-9)
          is a KCL constraint at the element level. Consider the two element currents in
          Figure 3-19
          (b),
          i
N
          and
          i
M
          . If the element is contained in only one mesh, then
          i
K
          =
          i
X
          or
          i
K
          = -
          i
Y
          , depending on whether the reference direction for the element current agrees or disagrees with the reference direction of the mesh current. Hence,
          i
N
          is opposite to the direction of the mesh current
          i
J
          , so we write
          i
N
          = -
          i
J
          . Whereas,
          i
M
          has two mesh currents contributing to it,
          i
F
          and
          i
J
          . In this case we write
          i
M
          =
          i
F
          -
          i
J
          . The key idea is that the current through every two-terminal element in a planar circuit can be expressed in terms of no more than two mesh currents.
        








FIGURE 3-20














Exercise 3-14



              In
              Figure 3-20
              , the mesh currents are
              i
A
              = 10 A,
              i
B
              = 5 A, and
              i
C
              = -3 A. Find the element currents
              i
1
              through
              i
6
              and show that KCL is satisfied at nodes A, B, and C.
            
Answers:

i
1
              = - 10 A;
              i
2
              = 13A;
              i
3
              = 5A;
              i
4
              = 8 A;
              i
5
              = 5A;
              i
6
              = - 3A
            

              At node A:
              i
1
              +
              i
2
              +
              i
6
              = 0; at node B: -
              i
2
              +
              i
3
              +
              i
4
              = 0; at node C: -
              i
4
              +
              i
5
              -
              i
6
              = 0
            



-10 + 13-3 = 0;
-13 + 5 + 8 = 0;
-8 + 5-(-3) = 0





To use mesh currents to formulate circuit equations, we use elements and connection constraints, except that the KCL constraints are not explicitly written. Instead, we use the fundamental property of mesh currents to express the element voltages in terms of the mesh currents. By doing so we avoid using the element currents and work only with the element voltages and mesh currents.


          For example, the planar circuit in
          Figure 3-21
          can be analyzed using the mesh-current method. In the figure, we have defined two mesh currents and five element voltages. We write KVL constraints around each mesh using the element voltages.
        


(3-10)












FIGURE 3-21




Circuit for demonstrating mesh-current analysis.



Using the fundamental property of mesh currents, we write the element voltages in terms of the mesh currents and input voltages:



(3-11)




We substitute these element equations into the KVL connection equations and arrange the result in standard form.



(3-12)




We have completed the formulation process with two equations in two unknown mesh currents.

          As we have previously noted, every method of circuit analysis must satisfy KCL, KVL, and the element
          i-v
          relationships. When formulating mesh equations, it may appear that we have not used KCL. However, writing the element constraints in the form in
          Eq. (3-11)
          requires the KCL equations
          i
1
          =
          i
A
          ,
          i
2
          =
          i
B
          , and
          i
3
          =
          i
A
          -
          i
B
          . Mesh-current analysis implicitly satisfies KCL when the element constraints are expressed in terms of the mesh currents. In effect, the fundamental property of mesh currents ensures that the KCL constraints are satisfied.
        

          We use MATLAB to solve for the mesh currents in
          Eq. (3-12)
          :
        




MATLAB returns:




Which can be simplified as:



(3-13)







(3-14)





Equations (3-13)
          and
          (3-14)
          can now be substituted into the element constraints in
          Eq. (3-11)
          to solve for every voltage in the circuit. For instance, the voltage across
          R
3
          is
        



(3-15)






          You are invited to show that the result in
          Eq. (3-15)
          agrees with the node analysis result obtained in
          Example 3-4
          for the same circuit.
        
The mesh-current analysis approach just illustrated can be summarized in four steps:



STEP 1

Identify a mesh current with every mesh and a voltage across every circuit element.



STEP 2

Write KVL connection constraints in terms of the element voltages around every mesh.



STEP 3


              Use KCL and the
              i-v
              relationships of the elements to express the element voltages in terms of the mesh currents.
            



STEP 4

Substitute the element constraints from step 3 into the connection constraints from step 2 and arrange the resulting equations in standard form.



          The number of mesh-current equations derived in this way equals the number of KVL connection constraints in step 2. When discussing combined constraints in
          Chapter 2
          , we noted that there are
          E
          -
          N
          + 1 independent KVL constraints in any circuit. Using the window panes in a planar circuit generates
          E
          -
          N
          + 1 independent mesh currents. Mesh-current analysis works best when the circuit has many elements (
          E
          large) connected in series (
          N
          also large).
        
Since Multisim uses node-voltage analysis to solve for node voltages, the currents that it solves for are branch currents that may be composed of one or two mesh currents. One can calculate the mesh currents from the information provided by Multisim if desired.

Writing Mesh-Current Equations by Inspection

            The mesh equations in
            Eq. (3-12)
            have a symmetrical pattern that is similar to the coefficient symmetry observed in node equations. The coefficients of
            i
B
            in the first equation and
            i
A
            in the second equation are the negative of the resistance common to meshes A and B. The coefficients of
            i
A
            in the first equation and
            i
B
            in the second equation are the sum of the resistances in meshes A and B, respectively.
          

            This pattern will always occur in planar circuits containing resistors and independent voltage sources when the mesh currents are defined in the window panes of a planar circuit, as shown in
            Figure 3-19
            . To see why, consider a general resistance
            R
            that is contained in, say, mesh A. There are only two possibilities.
            R
            is either not contained in any other mesh, in which case the voltage across it is
          




or contained in only one adjacent mesh, say mesh B, in which case the voltage across it is




These observations lead to the following conclusions. The voltage across resistance in mesh A involves the following terms:



1.
i
A
                times the sum of the resistances in mesh A.
              



2.
                Minus
                i
B
                times the sum of resistances common to mesh A and mesh B.
              



3.
                Minus similar terms for any other mesh adjacent to mesh A with a common resistance.
              


The sum of the voltages across resistors plus the sum of the independent voltage sources around mesh A must equal zero.
The aforementioned process makes it possible for us to write mesh-current equations by inspection without going through the intermediate steps involving the KVL connection constraints and the element constraints.












EXAMPLE 3-8




                    For the circuit of
                    Figure 3-22
                    ,
                  

(a) Formulate mesh-current equations.

                      (b) Find the output
                      v
O
                      using
                      R
1
                      =
                      R
4
                      = 2 kΩ and
                      R
2
                      =
                      R
3
                      = 4 kΩ using MATLAB.
                    











FIGURE 3-22









SOLUTION:




                  (a) To write mesh-current equations by inspection, we note that the total resistances in meshes A, B, and C are
                  R
1
                  +
                  R
2
                  ,
                  R
3
                  +
                  R
4
                  , and
                  R
2
                  +
                  R
3
                  , respectively. The resistance common to meshes A and C is
                  R
2
                  . The resistance common to meshes B and C is
                  R
3
                  . There is no resistance common to meshes A and B. Using these observations, we write the mesh equations as follows:
                





The algebraic signs assigned to voltage source terms follow the passive convention for the mesh current in question. Arranged in standard form, these equations become




Coefficient symmetry greatly simplifies the formulation of these equations compared with the more fundamental, but time-consuming, process of writing element and connection constraints. Inserting the numerical values into these equations yields



Putting these three mesh equations in matrix form produces a symmetrical matrix




                This is a matrix equation of the form
                Ax
                =
                B,
                where
              




                Using MATLAB to solve for the mesh currents, we first enter the
                A
                matrix with the statement
              





                The elements in the
                B
                matrix are the symbolic variables
                v
S1
                and
                v
S2
                . These quantities are not unknowns, but symbols that represent all possible values of the input voltages. Define the symbolic variables with the statement
              






                and then create the
                B
                matrix:
              




Solve for the unknown mesh currents using matrix division,




which yields





                The elements of the column vector
                x
                are the three unknown mesh currents expressed in terms of the input voltages. The output voltage in
                Figure 3-22
                is written in terms of the mesh currents as
                v
O
                =
                R
4
i
B
                . We know
                R
4
                = 2 kΩ, so in MATLAB we can compute the output voltage as
              




which yields




We can write this answer compactly as




                The result from the mesh-current analysis obtained here is the same as the node-voltage result obtained in
                Example 3-7
                . Either approach produces the same answer, but which method do you think is easier?
                ■














Exercise 3-15


                Using the circuit of
                Figure 3-18
                (see
                Exercises 3-12
                and
                3-13
                ), use mesh-current analysis to find the current through the 4-kΩ resistor and the voltage
                v
O
                when the element
                E
                is
              

(a) a 10-kΩ resistor
(b) a 10-V independent voltage source with the positive reference on the right.

Answers:

(a) 949.4 µA and 2.53 V
(b) 740.7 µA and 12.96 V





Mesh Equations with Current Sources

            In developing mesh analysis, we assumed that circuits contain only voltage sources and resistors. This assumption simplifies the formulation process because the sum of voltages around a mesh is determined by voltage sources and the mesh currents through resistors. A current source complicates the picture because the voltage across it is not directly related to its current. We need to adapt mesh analysis to
            
            accommodate current sources just as we revised node analysis to deal with voltage sources.
          
There are three ways to handle current sources in mesh analysis:



1.
                If the current source is connected in parallel with a resistor, then it can be converted to an equivalent voltage source by source transformation. Each source conversion eliminates a mesh and reduces the number of equations required by one. This method is the dual of method 1 for node analysis.
              



2.
                If a current source is contained in only one mesh, then that mesh current is determined by the source current and is no longer an unknown. We write mesh equations around the remaining meshes in the usual way and move the known mesh current to the source side of the equations in the final step. The number of equations obtained is one less than the number of meshes. This method is the dual of method 2 for node analysis.
              



3.
                Neither of the first two methods will work when a current source is contained in two meshes or is not connected in parallel with a resistance. In this case we create a
                super-mesh
                by excluding the current source and any elements connected in series with it, as shown in
                Figure 3-23
                . We write one mesh equation around the supermesh using the currents
                i
A
                and
                i
B
                . We then write mesh equations of the remaining meshes in the usual way. This leaves us one equation short because parts of meshes A and B are included in the supermesh. However, the fundamental property of mesh currents relates the currents
                i
S
                ,
                i
A
                , and
                i
B
                as
              





This equation supplies the one additional relationship needed to get the requisite number of equations in the unknown mesh currents.



The aforementioned three methods are not mutually exclusive. We can use more than one method in a circuit, as the following examples illustrate.








FIGURE 3-23




Example of a supermesh.















                      EXAMPLE 3-9
                      



                    Use mesh-current equations to find
                    i
O
                    in the circuit in
                    Figure 3-24
                    (a). Verify your answer using Multisim.
                  










FIGURE 3-24









SOLUTION:



                The current source in this circuit can be handled by a source transformation (method 1). The 2-mA source in parallel with the 4-kΩ. resistor in
                Figure 3-24
                (a) can be replaced by an equivalent 8-V voltage source in series with the same resistor, as shown in
                Figure 3-24
                (b). In this circuit, the total resistance in mesh A is 6 kΩ, the
                
                total resistance in mesh B is 11 kΩ, and the resistance contained in both meshes is 2 kΩ. By inspection, the mesh equations for this circuit are as follows:
              




                Solving for the two mesh currents yields
                i
A
                = 0.6290 mA and
                i
B
                = - 0.6129 mA. By KCL, the desired current is
                i
O
                =
                i
A
                -
                i
B
                = 1.2419 mA. The given circuit in
                Figure 3-24
                (a) has three meshes and one current source. The source transformation leading to
                Figure 3-24
                (b) produces a circuit with only two meshes. The general principle illustrated is that the number of independent mesh equations in a circuit containing
                E
                elements,
                N
                nodes, and
                N
I
                current sources is
                E
                -
                N
                + 1 -
                N
I
                . Multisim results are shown in
                Figure 3-24
                (c).
                ■














FIGURE 3-24













Exercise 3-16


                In
                Figure 3-24
                , replace the 5-V source with a 1-mA dc current source with the arrow pointing up. Use source transformations to reduce the circuit to a single mesh and then solve for
                i
O
                .
              
Answers:
1.545 mA. If you got a different answer, check it with Multisim.
















EXAMPLE 3-10



                    Use mesh-current equations to find
                    v
O
                    in
                    Figure 3-25
                    .
                  










FIGURE 3-25









SOLUTION:



                Source transformation (method 1) is not possible here since neither current source is connected in parallel with a resistor. We see that
                i
A
                =
                i
S1
                (method 2). However, the current source
                i
S2
                is in both mesh B and mesh C, so we exclude this element and create the supermesh (method 3) shown in the figure. The sum of voltages around the supermesh is:
              



The supermesh voltage constraint yields one equation in the three unknown mesh currents. Applying KCL to each of the current sources yields




                Because of KCL, the two current sources force constraints that supply two more equations. Using these two KCL constraints to eliminate
                i
A
                and
                i
B
                from the super-mesh KVL constraint yields
              



Hence, the required output voltage is


■














FIGURE 3-26













Exercise 3-17


                Use a supermesh and mesh analysis to find the mesh currents in
                Figure 3-26
                (a).
              
Answers:

i
A
                = +2 mA;
                i
B
                = -1 mA;
                i
C
                = - 2 mA.
              










Exercise 3-18



                Use mesh current analysis to find the voltages across the two current sources in
                Figure 3-26
                (a). Validate your answer using Multisim.
              
Answers:

v
3mA
                = -8 V,
                v
2mA
                = -6 V; see
                Figure 3-26
                (b).
              










FIGURE 3-26













Exercise 3-19


                Write a set of mesh-current equations for the circuit in
                Figure 3-27
                . Do not solve the equations.
              
Answers:













FIGURE 3-27














Exercise 3-20



                Use mesh-current equations to find
                v
O
                in
                Figure 3-27
                .
              
Answers:

v
O
                = (
                v
1
                +
                v
2
)/
                4
              




Summary of Mesh-Current Analysis
Mesh-current equations can always be formulated from KVL, the element constraints, and the fundamental property of mesh currents. When in doubt, always fall back on these principles to formulate mesh equations in new situations. The following guidelines summarize an approach to formulating mesh equations for resistance circuits:



1.
                Simplify the circuit by combining elements in series or parallel wherever possible.
              



2.
                Mesh equations are required for supermeshes and all other meshes except those where current sources are contained in only one mesh.
              



3.
                Use KVL to write mesh equations for the meshes identified in step 2. Express element voltages in terms of mesh currents or the voltage produced by independent voltage sources.
              



4.
                Write expressions relating the mesh currents to the currents produced by independent current sources.
              



5.
                Substitute the expressions from step 4 into the mesh equations from step 3 and place the result in standard form.
              



6.
                Solve the equations from step 5 for the mesh currents of interest. Manual techniques may be efficient for lower-order problems. Computer tools, such as MATLAB or Multisim, are usually more practical and faster for higher-order problems.
              





3-3 Linearity Properties

          This book treats the analysis and design of
          linear circuits.
          A circuit is said to be linear if it can be adequately modeled using only linear elements and independent sources. The hallmark feature of a linear circuit is that outputs are linear functions of the inputs. Circuit
          inputs
          are the signals produced by external sources, and
          outputs
          are any other designated signals caused by the inputs. Mathematically, a function is said to be linear if it possesses two properties—homogeneity and additivity. In linear circuits,
          homogeneity
          means that the output is proportional to the input.
          Additivity
          means that the output
          
          due to two or more inputs can be found by adding the outputs obtained when each input is applied separately. Mathematically, these properties are written as follows:
        


(3-16)



and


(3-17)




          where
          K
          is a scalar constant. In circuit analysis, the homogeneity property is called
          proportionality,
          while the additivity property is called
          superposition.


The Proportionality Property

            The
            proportionality property
            applies to linear circuits with only one input. For linear resistive circuits, proportionality states that every input-output relationship can be written as
          



(3-18)





            where
            x
            is the input current or voltage,
            y
            is an output current or voltage, and
            K
            is a constant. The block diagram in
            Figure 3-28
            describes this linear input-output relation-ship. In a block diagram, the lines headed by arrows indicate the direction of signal flow. The arrow directed into the block indicates the input, while the output is indicated by the arrow directed out of the block. The variable names written next to these lines identify the input and output signals. Each of these can be either a voltage or a current. The scalar constant
            K
            written inside the block indicates that the input signal
            x
            is multiplied by
            K
            to produce the output signal as
            y=Kx.









FIGURE 3-28




Block diagram representation of the proportionality property.




            The concept of proportionality is a central and recurring theme in linear circuit design. The ratio of the output to the input is a concept that dominates much of circuit analysis and design. We will analyze and design circuits that achieve desired
            K
            values. In this chapter, we restrict the value to
            K
            ≤ 1, but beginning in the next chapter we will treat circuits with
            K
            values that can be greater than one. In later chapters, we will learn to design and analyze circuits using complex ratios that vary with time or frequency.
          



Caution:


            Proportionality only applies when the input and output are current or voltage. It does not apply to output power since power is equal to the product of current and voltage. In other words, output power is not linearly related to the input current or voltage.
          

            We have already seen several examples of proportionality. For instance, using voltage division in
            Figure 3-29
            (a) produces
          



which means





            as shown in
            Figure 3-29
            (b). Similarly, applying current division to the circuit of
            Figure 3-29
            (c)
          



so that











FIGURE 3-29




Examples of circuit exhibiting proportionality: (a) Voltage divider. (b) Block diagram for (a). (c) Current divider. (d) Block diagram for (c).




            as shown in
            Figure 3-29
            (d). In these two examples, the proportionality constant
            K
            is dimensionless because the input and output have the same units. In other situations,
            K
            could have the units of ohms or siemens when the input and output have different units.
          







Exercise 3-21



                Refer to the block diagram shown in
                Figure 3-28
                .
              


                  (a) A certain linear device has a
                  K
                  of 0.35. Its output is 6 V. What is the input that will produce that output?
                
(b) A different linear device outputs 910 mA when its input is 1 A. What will be its output when the input to the device is 300 mA?

Answers:

(a) 17.1 V
(b) 273 mA











Exercise 3-22


                Suppose the voltage divider shown in
                Figure 3-29
                (a) has a
                K
                of 0.75. How would one go about changing the
                K
                so that it will have a
                K
                of 0.8?
              
Answers:

                Either increase the output resistor [
                R
2
                in
                Figure 3-29
                (a)] or reduce the input resistor (
                R
1
                in the same figure) so that the ratio
                R
2
                /(
                R
1
                +
                R
2
                ) = 0.8.
              
















DESIGN EXAMPLE 3-11


                    Design a circuit that has a
                    K
                    =
                    v
O
                    /
                    v
S
                    = 0.67 using standard value resistors. (See
                    Appendix G
                    .)
                  




SOLUTION:



                Since
                K
                is less than one we can use the voltage divider shown in
                Figure 3-29
                (a), that is,
              




                There are many possible combinations. If we have access to 5% tolerance resistors, one choice is to select
                R
2
                = 20 kΩ and solve for
                R
1
                . In this case,
                R
1
                = 10 kΩ. If we must use 20% tolerance resistors, choose
                R
2
                = 68 kΩ and
                R
1
                = 33 kΩ.
                ■















                Design
                Exercise 3-23


                Design a circuit that has
                K
                =
                i
O
                /
                i
S
                = 0.9 using 5% tolerance standard value resistors. (See
                Appendix G
                .)
              
Answers:

                There are many solutions using the circuit of
                Figure 3-29
                (c). One is to select
                R
1
                = 91 kΩ and
                R
2
                = 10 kΩ.
              



            The next example illustrates that the proportionality constant
            K
            can be positive, negative, or even zero.
          











EXAMPLE 3-12


                    You are given the bridge circuit of
                    Figure 3-30
                    (a).
                  


                      (a) Find the proportionality constant
                      K
                      in the input-output relationship
                      v
O
                      =
                      Kv
S
                      .
                    

                      (b) Find the sign of
                      K
                      when
                      R
2
R
3
                      >
                      R
1
R
4
                      ,
                      R
2
R
3
                      =
                      R
1
R
4
                      , and
                      R
2
R
3
                      <
                      R
1
R
4
                      .
                    
(c) Draw a block diagram of this relationship.





SOLUTION:




                (a) We observe that the circuit consists of two voltage dividers. Applying the voltage division rule to each side of the bridge circuit yields
              



The fundamental property of node voltages allows us to write





                Substituting the equations for
                v
A
                and
                v
B
                into this KVL equation yields
              




                (b) The proportionality constant
                K
                can be positive, negative, or zero. Specifically,
              





                When the products of the resistances in opposite legs of the bridge are equal, then
                K =
                0 and the bridge is said to be balanced.
              

                (c) See
                Figure 3-30
                (b).
                ■














FIGURE 3-30













Exercise 3-24


                In
                Figure 3-30
                (a), select values of
                R
                so that
                K
                = - 0.333.
              
Answers:

R
1
                =
                R
2
                =
                R
3
                = 1 kΩ and
                R
4
                = 5 kΩ. Many other solutions are possible.
              




Unit Output Method

            The
            unit output method
            is an analysis technique based on the proportionality property of linear circuits. The method involves finding the input-output proportionality constant
            K
            by assuming an output of one unit and determining the input required to produce that unit output. This technique is most useful when applied to ladder circuits, and it involves the following steps:
          



1.
                A unit output is assumed; that is,
                v
O
                = 1V or
                i
O
                = 1A.
              



2.
                The input required to produce the unit output is then found by successive application of KCL, KVL, and Ohm's law.
              



3.
                Because the circuit is linear, the proportionality constant relating input and output is
              






            Given the proportionality constant
            K
            , we can find the output for any input using
            Eq. (3-18)
            .
          
In a way, the unit output method solves the circuit response problem backward—that is, from output to input—as illustrated by the next example.












EXAMPLE 3-13




                    Use the unit output method to find
                    v
O
                    in the circuit shown in
                    Figure 3-31
                    (a).
                  










FIGURE 3-31









SOLUTION:



                We start by assuming
                v
O
                = 1V, as shown in
                Figure 3-31
                (b). Then, using Ohm's law, we find
                i
O
                .
              




                Next, using KCL at node B, we find
                i
1
                .
              





                Again, using Ohm's law, we find
                v
1
                .
              





                Then, writing a KVL equation around loop L2, we find
                v
2
                as
              





                Again, using Ohm's law, we find
                i
2
                as
              



Next, writing a KCL equation at node A yields




Using Ohm's law one last time,





                We can now find the source voltage
                v
S
                by applying KVL around loop L1:
              




                A 3-V source voltage is required to produce a 1-V output. From this result, we calculate the proportionality constant
                K
                to be
              




                Once
                K
                is known, the output for the specified 5-V input is
                
                .
                ■














Exercise 3-25


                Find
                v
O
                in the circuit of
                Figure 3-31
                (a) when
                v
S
                is - 5 V, 10 mV, and 3 kV.
              
Answers:

v
O
                = - 1.667 V; 3.333 mV; 1 kV
              











Exercise 3-26




                For the circuit in
                Figure 3-32
                (a),
              


                  (a) Use the unit output method to find
                  K
                  =
                  i
O
                  /
                  i
IN


                  (b) Then, use the proportionality constant
                  K
                  to find
                  i
O
                  for the input current shown in the figure.
                
(c) Draw a block diagram to show the results of parts (a) and (b).

Answers:


                  (a)
                  K
                  =
                  1
                  /
                  4


                  (b)
                  i
O
                  = 0.15 mA
                

                  (c) See
                  Figure 3-32
                  (b)
                











FIGURE 3-32









Additivity Property

            The
            additivity property
            states that any output current or voltage of a linear resistive circuit with multiple inputs can be expressed as a linear combination of the several inputs:
          



(3-19)





            where
            x
1
            ,
            x
2
            ,
            x
3
            ,... are current or voltage inputs, and
            K
1
            ,
            K
2
            ,
            K
3
            ,... are constants that depend on the circuit parameters.
            Figure 3-33
            shows how we represent this relationship in block diagram form. Again the arrows indicate the direction of signal flow and the
            K
            's within the blocks are scalar multipliers. The circle in
            Figure 3-33
            is a new block diagram element called a summing point that implements the operation
            
            . Although the block diagram in
            Figure 3-33
            is nothing more than a pictorial representation of
            Eq. (3-19)
            , the diagram often helps us gain a clearer picture of how signals interact in different parts of a circuit.
          








FIGURE 3-33




Block diagram representation of the additivity property.




            To illustrate this property, we analyze the two-input circuit in
            Figure 3-34
            (a) using node-voltage analysis. Applying KCL at node A, we obtain
          



Moving the inputs to the right side of this equation yields




            Since
            v
O
            =
            v
A
            , we obtain the input-output relationship in the form
          



(3-20)





            This result shows that the output is a linear combination of the two inputs. Note that
            K
1
            is dimensionless since its input and output are voltages, and that
            K
2
            has the units of
            
            ohms since its input is a current and its output is a voltage. A representative block diagram is shown in
            Figure 3-34
            (b).
          








FIGURE 3-34




(a) Circuit used to demonstrate superposition. (b) Block diagram.





Superposition Principle

            Since the output in
            Eq. (3-19)
            is a linear combination, the contribution of each input source is independent of all other inputs. This means that the output can be found by finding the contribution from each source acting alone and then adding the individual responses to obtain the total response. This suggests that the output of a multiple-input linear circuit can be found by the following steps:
          



STEP 1

"Turn off" all independent sources except one and find the output of the circuit due to that source acting alone.



STEP 2

Repeat the process in step 1 until each independent source has been turned on with all other sources turned off and the output due to that source found.



STEP 3

The total output with all independent sources turned on is the algebraic sum of the outputs caused by each source acting alone.



            These steps describe a circuit analysis technique called the
            superposition principle.
            Before applying this method, we must discuss what happens when a voltage or current source is "turned off."
          

            The
            i-v
            characteristics of voltage and current sources are shown in
            Figure 3-35
            . A voltage source is "turned off" by setting its voltage to zero (
            v
S
            = 0). This step translates the voltage source
            i-v
            characteristic to the
            i
            -axis, as shown in
            Figure 3-35
            (a). In
            Chapter 2
            , we found that a vertical line on the
            i
            -axis is the
            i-v
            characteristic of a short circuit. Similarly, "turning off" a current source (
            i
S
            = 0) in
            Figure 3-35
            (b) translates its
            i-v
            characteristic to the
            v
            -axis, which is the
            i-v
            characteristic of an open circuit. Therefore, when a voltage source is "turned off" we replace it by a short circuit, and when a current source is "turned off" we replace it by an open circuit.
          








FIGURE 3-35




Turning off an independent source: (a) Voltage source. (b) Current source.




            The superposition principle is now applied to the circuit in
            Figure 3-34
            to duplicate the response in
            Eq. (3-20)
            , which was found by node analysis.
            Figure 3-36
            shows the steps involved in applying superposition to the circuit in
            Figure 3-34
            .
            Figure 3-36
            (a) shows that the circuit has two input sources. We will first "turn off"
            i
S
            and replace it with an open circuit, as shown in
            Figure 3-36
            (b). The output of the circuit in
            
Figure 3-36
            (b) is called
            v
O1
            and represents that part of the total output caused by the voltage source. Using voltage division in
            Figure 3-36
            (b) yields
            v
O1
            as
          




            Next, we "turn off" the voltage source and "turn on" the current source, as shown in
            Figure 3-36
            (c). Using Ohm's law, we get
            v
O2
            =
            i
O2
R
2
            . We use current division to express
            i
O2
            in terms of
            i
S
            to obtain
            v
O2





            Applying the superposition principle, we find the response with both sources "turned on" by adding the two responses
            v
O1
            and
            v
O2
            .
          




            This superposition result is the same as the circuit reduction result given in
            Eq. (3-20)
            and can be represented by the same block diagram shown in
            Figure 3-34
            (b).
          








FIGURE 3-36




Circuit analysis using superposition: (a) Original circuit. (b) Current source off. (c) Voltage source off.















EXAMPLE 3-14



Figure 3-37
                    (a) shows a resistance circuit used to implement a signal-summing function. Use superposition to show that the output
                    v
O
                    is a weighted sum of the inputs
                    v
S1
                    ,
                    v
S2
                    , and
                    v
S3
                    .
                  




SOLUTION:



                To determine
                v
O
                using superposition, we first turn off sources 1 and 2 (
                v
S1
                = 0 and
                v
S2
                = 0) to obtain the circuit in
                Figure 3-37
                (b). This circuit is a voltage divider in which the output leg consists of two equal resistors in parallel. The equivalent resistance of the output leg is
                R
                / 2, so the voltage division rule yields
              



Because of the symmetry of the circuit, it can be seen that the same technique applies to all three inputs; therefore,



Applying the superposition principle, the output with all sources "turned on" is




                That is, the output is proportional to the sum of the three input signals with
                K
1
                =
                K
2
                =
                K
3
                =
                1
                /
                3
                .
                ■














FIGURE 3-37














Exercise 3-27



                The circuit of
                Figure 3-38
                contains two
                R
                -2
                R
                modules. Use superposition to find
                v
O
                .
              
Answers:













Exercise 3-28



                Repeat
                Exercise 3-27
                with the voltage source
                v
S2
                replaced by a current source
                i
S2
                with the current reference arrow directed toward ground.
              


Answer:















FIGURE 3-38



















EXAMPLE 3-15




                    Use the principle of superposition to find the voltage
                    v
X
                    in
                    Figure 3-39
                    (a). Validate your answer using Multisim.
                  










FIGURE 3-39









SOLUTION:



                To find
                v
X
                , we will turn off each source one at a time starting with the voltage source as shown in
                Figure 3-39
                (b). We chose to find the voltage
                v
Xi
                by first determining the
                
                current
                i
X2
                and then using Ohm's law, as shown in
                Figure 3-39
                (c). The circuit to the right of the 50-Ω resistor consists of two 100-Ω resistors in parallel. This result, then, is in series with the 50-Ω resistor. This combination equals 100 Ω. At node A, the current
                i
X1
                is exactly half of the source current or 0.6 A because the source current divides equally between two paths with the same equivalent resistances. At node B, the current divides equally again, since both path resistances equal 100 Ω, resulting in
                i
X2
                = 0.3A. Then by Ohm's law
              





                To find the contribution due to the voltage source, we set the current source to zero as shown in
                Figure 3-39
                (d). The circuit to the left of the source's 100-Ω resistor can be combined resulting in an equivalent resistance of 60 Ω. The problem of finding
                v
Xv
                then reduces to a simple voltage divider as shown in
                Figure 3-39
                (e).
              




                The desired voltage
                v
X
                can be found by algebraically adding the two contributions as
              




                To validate our answer with Multisim, we draw the two superposition circuits as shown in
                Figure 3-39
                (f). We used both the multimeters and the DC Operating Point Analysis, although redundant, to demonstrate the validity of superposition. The multimeters show that
                v
Xi
                and
                v
Xv
                are the same as calculated by hand. Using the DC Operating Point Analysis, we can also have Multisim add the voltages, again giving the same overall result of -15 V. As a final check, you can construct the original circuit in 3-39(a) to verify the overall result.
                ■














FIGURE 3-39














Exercise 3-29



                Use the principle of superposition to find the current
                i
X
                in
                Figure 3-40
                .
              
Answers:

i
Xi
                = 0.8 A,
                i
Xv
                = 0.4 A,
                i
X
                = 1.2 A
              










FIGURE 3-40








            The preceding examples and exercises illustrate use of the superposition theorem to analyze multiple-input linear circuits. You should not conclude that this is the
            
            primary application of this concept. In fact, superposition is not a particularly attractive method, since a circuit with
            N
            signal sources requires
            N
            different circuit analyses to obtain the final result. Unless the circuit is relatively simple, superposition may not reduce the analysis effort compared with, say, node-voltage analysis or a software tool. Rather, superposition is an important property of linear circuits used primarily as a conceptual tool to develop other circuit analysis and design techniques and as an aid in understanding the effect that different sources have on an output.
          



3-4 Thévenin and Norton Equivalent Circuits

          An
          interface
          is a connection between circuits. Circuit interfaces occur frequently in electrical and electronic systems, so special analysis methods are used to handle them. For the two-terminal interface shown in
          Figure 3-41
          , we normally think of one circuit as the source S and the other as the load L. We think of signals as being produced by the source circuit and delivered to the load circuit. The source-load interaction at an interface is one of the central problems of circuit analysis and design. The properties at an interface often are critical specifications used in having, say, a third party provide a device or a subsystem that connects to an existing system. Interface specifications are usually contractual requirements that the third-party provider must meet.
        








FIGURE 3-41




A two-terminal interface.




          The Thévenin and Norton equivalent circuits shown in
          Figure 3-42
          are valuable tools for dealing with circuit interfaces. The conditions under which these equivalent circuits exist can be stated as a theorem:
        




If the source circuit in a two-terminal interface is linear, then the interface signals v and i do not change when the source circuit is replaced by its Thévenin or Norton equivalent circuit.




The equivalence requires the source circuit to be linear but places no restriction on the linearity of the load circuit. Later in this section, we consider cases in which the load is nonlinear. In subsequent chapters, we will study circuits in which the loads are linear energy storage elements called capacitors and inductors.

          The Thévenin equivalent circuit consists of a voltage source (
          v
T
          ) in series with a resistance (
          R
T
          ). The Norton equivalent circuit is a current source (
          i
N
          ) in parallel with a resistance (
          R
N
          ). Note that the Thévenin and Norton equivalent circuits are practical sources in the sense discussed in
          Chapter 2
          .
        

          The two circuits, Thévenin and Norton, have the same
          i-v
          characteristics, since replacing one by the other leaves the interface signals unchanged. To derive the equivalency conditions, we apply KVL and Ohm's law to the Thévenin equivalent in
          Figure 3-42
          (a) to obtain its
          i-v
          relationship at the terminals A and B:
        



(3-21)













FIGURE 3-42




Equivalent circuits for the source:
(a) Thévenin equivalent.
(b) Norton equivalent.




          Next, applying KCL and Ohm's law to the Norton equivalent in
          Figure 3-42
          (b) yields its
          i-v
          relationship at terminals A and B:
        



(3-22)





          Solving
          Eq. (3-22)
          for
          v
          yields
        



(3-23)






          The Thévenin and Norton circuits have identical
          i-v
          relationships. Comparing
          Eqs. (3-21)
          and
          (3-23)
          , we conclude that
        



(3-24)





          In essence, the Thévenin and Norton equivalent circuits are related by the source transformation studied in
          Chapter 2
          . We do not need to find both equivalent circuits. Once one of them is found, the other can be determined by a source transformation. The Thévenin and Norton circuits involve four parameters (
          v
T
          ,
          R
T
          ,
          i
N
          ,
          R
N
          ), and
          Eq. (3-24)
          provides two relations between the four parameters. Therefore, only two parameters are needed to specify either equivalent circuit. Since Thévenin and Norton equivalent circuits are, well, equivalent, one uses whichever one is more useful for the task.
        

          In circuit analysis problems, it is convenient to use the short-circuit current and open-circuit voltage to specify Thévenin and Norton circuits. The circuits in
          Figure 3-43
          (a) show that when the load is an open circuit the interface voltage equals the Thévenin voltage; that is,
          v
OC
          =
          v
T
          , since there is no voltage across
          R
T
          when
          i
          = 0. Similarly, the circuits in
          Figure 3-43
          (b) show that when the load is a short circuit the interface current equals the Norton current; that is,
          i
SC
          =
          i
N
          , since all the source current
          i
N
          is diverted through the short-circuit load.
        
In summary, the parameters of the Thévenin and Norton equivalent circuits at a given interface can be found by determining the open-circuit voltage and the short-circuit current.



(3-25)











                APPLICATION
                EXAMPLE 3-16



              Thévenin measurements can be made in the laboratory or in the field with a simple digital multimeter (DMM). Look at
              Figure 3-43
              (c). If one sets the DMM to read
              
              voltage, then the multimeter acts like an open circuit
              
1

              and the meter reading will be the circuit's open-circuit voltage
              v
OC
              . Setting the DMM to read current makes the DMM act like a short circuit
              
2

              and the meter reading will be the circuit's short-circuit current. The circuit's Thévenin resistance can then be found using
              Eq. (3-25)
              .
            










FIGURE 3-43




Loads used to find Thévenin and Norton equivalent circuits: (a) Open circuit yields the Thévenin voltage. (b) Short circuit yields the Norton current. (c) Measuring v
OC
and i
SC
using a DMM.




Applications of Thévenin and Norton Equivalent Circuits

            ReplacingacomplexcircuitbyitsThéveninorNortonequivalentcangreatlysimplify the analysis and design of interface circuits. For example, suppose we need to select a load resistance in
            Figure 3-44
            (a) so the source circuit to the left of the interface A-B delivers 4 V to the load. This task is easily handled once we have the Thévenin or Norton equivalent for the source circuit.
          








FIGURE 3-44




Example of finding the Thévenin and Norton equivalent circuits: (a) The given circuit. (b) Open circuit yields the Thévenin voltage. (c) Short circuit yields the Norton current. (d) Thévenin equivalent circuit. (e) Norton equivalent circuit.




            To obtain the Thévenin and Norton equivalents, we need
            v
OC
            and
            i
SC
            . The open-circuit voltage
            v
OC
            is found by disconnecting the load at the terminals A and B, as shown in
            Figure 3-44
            (b). The voltage across the 15-Ω resistor is zero because the open circuit causes the current through the resistor to be zero. The open-circuit voltage at the interface is the same as the voltage across the 10-Ω, resistor. Using voltage division, this voltage is
          





            Next, we find the short-circuit current
            i
SC
            using the circuit in
            Figure 3-44
            (c). We do a source transformation of the 15-V source and the series 5-Ω resistor as shown in the figure. Then, we apply current division to find the short-circuit current as follows:
          



Finally, we compute the Thévenin and Norton resistances as




            The resulting Thévenin and Norton equivalent circuits are shown in
            Figure 3-44
            (d) and (e).
          

            It is now an easy matter to select a load
            R
L
            so that 4 V is supplied to the load. Using the Thévenin equivalent circuit, the problem reduces to a voltage divider:
          




            Solving for
            R
L
            yields
            R
L
            = 12.2 Ω.
          
The Thévenin and Norton equivalent can always be found from the open-circuit voltage and short-circuit current at the interface. The following examples illustrate other methods of determining these equivalent circuits.












                    DESIGN EXAMPLE 3-17
                  


                    Find the Thévenin equivalent at nodes A and B for the circuit in
                    Figure 3-45
                    (a). Then select an appropriate load so that exactly 1 mA flows through it.
                  










FIGURE 3-45









SOLUTION:


We start by finding the Thévenin circuit. The open-circuit voltage can be found using a voltage divider as:



The short-circuit current is found by placing a short circuit connecting nodes A and B and finding the current flowing through that short circuit. The short circuit is in parallel with the 15-kΩ resistor thereby effectively removing it from the circuit. The short-circuit current is thus found using Ohm's law as:



The Thévenin resistance is then found as:




                The Thévenin equivalent circuit is shown in
                Figure 3-45
                (b).
              

                We can now easily select a resistor
                R
L
                that will have 1 mA flowing through it using Ohm's law. See
                Figure 3-45
                (c).
              




                Solving for
                R
L
                yields
                R
L
                = 1.2 kΩ
                ■















Exercise 3-30



                Find the Thévenin equivalent at nodes A and B for the circuit in
                Figure 3-46
                .
              
Answers:

v
T
                = 4.14 V;
                R
T
                = 5.01 kΩ
              










FIGURE 3-46



















EXAMPLE 3-18




                      (a) Find the Thévenin equivalent circuit of the source circuit to the left of the interface in
                      Figure 3-47
                      (a).
                    
(b) Use the Thévenin equivalent to find the power delivered to two different loads. The first load is a 10-kΩ resistor and the second is a 5-V voltage source whose positive terminal is connected to the upper interface terminal.











FIGURE 3-47









SOLUTION:



                (a) To find the Thévenin equivalent, we use the sequence of circuit reductions shown in
                Figure 3-47
                . In
                Figure 3-47
                (a), the 15-V voltage source in series with the 3-kΩ resistor to the left of terminals A and B is replaced by a 3-kΩ resistor in parallel with an
                
                equivalent current source with
                i
S
                = 15/3000 = 5 mA. In
                Figure 3-47
                (b), looking to the left of terminals C and D, we see two resistors in parallel whose equivalent resistance is (3kΩ) || (6 kΩ) = 2 kΩ. We also see two current sources in parallel whose equivalent is
                i
S
                = 5 mA - 2 mA = 3 mA. This equivalent current source is shown in
                Figure 3-47
                (c) to the left of terminals C and D.
                Figure 3-47
                (d) shows this current source converted to an equivalent voltage source
                v
S
                = 3 mA × 2 kΩ = 6 V in series with 2 kΩ. In
                Figure 3-47
                (d), the three resistors are connected in series and can be replaced by an equivalent resistance
                R
EQ
                = 2 kΩ + 3 kΩ + 4 kΩ = 9 kΩ. This step produces the Thévenin equivalent shown in
                Figure 3-47
                (e).
              



Note:


                The steps leading from
                Figure 3-47
                (a) to (e) involve circuit reduction techniques studied in
                Chapter 2
                , so we know that this approach works best on ladder circuits like the one in
                Figure 3-47
                (a).
              

                (b)
                Figure 3-48
                shows the Thévenin equivalent found in part (a) (
                Figure 3-47
                (e)) and the two loads. When the load is a 10-kΩ resistor, the interface current is
                i
                = (6)/(9000 + 10,000) = 0.3158 mA, and the power delivered to the load is
                i
2
R
L
                = 0.9973 mW. When the load is a 5-V source, the interface voltage and current are
                v
                = 5 V and
                i
                = (6-5/9000 = 0.1111 mA, and the power to the load is
                v × i
                = 0.5555 mW. Since
                p
                > 0 in the latter case, we see that the voltage source load is absorbing power rather than delivering power. A practical example of this situation is a battery charger.
              



Caution:


                The Thévenin equivalent allows us to calculate the power delivered to a load, but it does not tell us what power is dissipated in the original source circuit. For instance, if the load in
                Figure 3-47
                (e) is an open circuit, then no power is dissipated in the Thévenin equivalent since
                i
                = 0. This does not mean that the power dissipated in the original source circuit is zero, as we can easily see by looking back at
                Figure 3-47
                (a). The Thévenin equivalent circuit has the same
                i-v
                characteristic at the interface, but it does not duplicate the internal characteristics of the original source circuit.
                ■














FIGURE 3-48














                Design
                Exercise 3-31


                For the Thévenin circuit of
                Figure 3-48
                , select a load
                R
L
                so that 2.5 V are delivered across it. Choose
                R
L
                from the 10% values given in
                Appendix G
                . What will be the actual value of voltage delivered to the load?
              
Answers:

R
L
                = 6.8 kΩ;
                v
L
                = 2.58 ± 10% V
              

















EXAMPLE 3-19




                      (a) Find the Norton equivalent of the source circuit to the left of the interface in
                      Figure 3-49
                      .
                    
(b) Use Multisim to verify your result.

                      (c) Find the interface current
                      i
                      when the power delivered to the load is 5W.
                    











FIGURE 3-49









SOLUTION:



                (a) The circuit reduction method will not work here since the source circuit is not a ladder. In this example, we write mesh-current equations and solve directly for the source circuit
                i-v
                relationship. We only need to write equations for meshes A and B since the 2-A current source determines the mesh C current. The voltage sums around these meshes are as follows:
              






                But since
                i
B
                =
                i
                and the current source forces the condition
                i
C
                = - 2, these equations have the form
              





                Solving for the currents in terms of
                v
                yields
              




                At the interface, the
                i
                -
                v
                relationship of the source circuit is
                i
                = -1.5-
                v
                /60.
                Equation (3-22)
                gives the
                i-v
                relationship of the Norton circuit as
                i
                =
                i
N
                -
                v/R
N
                . By direct comparison, we conclude that
                i
N
                = -1.5 A and
                R
N
                = 60 Ω. This equivalent circuit is shown in
                Figure 3-50
                (a).
              

                (b) We can use Multisim in much the same way as we can find a circuit's Thévenin equivalent in the laboratory or in the field as shown in
                Figure 3-43
                (c) using a multimeter.
                Figure 3-50
                (b) shows how one can easily find a circuit's open-circuit voltage (
                v
OC
                ) and its short-circuit current (
                i
SC
                ) using Multisim. The Thévenin resistance can then easily be calculated using
                R
T
                =
                v
OC
                /
                i
SC
                .
              








FIGURE 3-50








                (c) When 5 W is delivered to the load, we have
                vi
                = 5 or
                v
                = 5/
                i.
                Substituting
                v =
                5/
                i
                into the source
                i-v
                relationship
                i
                = -15 -
                v
                /60 yields the quadratic equation
              





                whose roots are
                i
                = -0.05778 A and -1.442 A. Thus, there are two values of interface current that deliver 5 W to the load.
                ■








Derivation of Thévenin's Theorem

            The derivation of Thévenin's theorem is based on the superposition principle. We begin with the circuit in
            Figure 3-51
            (a), where the source circuit S is linear. Our approach is to use superposition to show that the source circuit and the Thévenin circuit have the same
            i-v
            relationship at the interface. To find the source circuit
            i-v
            relationship, we first disconnect the load and apply a current source
            i
TEST
            , as shown in
            Figure 3-51
            (b). Using superposition to find
            v
TEST
            , we first turn
            i
TEST
            off and leave all the sources inside S on, as shown in
            Figure 3-51
            (c). Turning a current source off leaves an open circuit, so
          






            Next, we turn
            i
TEST
            back on and turn off all of the independent sources inside S. Since the source circuit S is linear, it reduces to the equivalent resistance shown in
            Figure 3-51
            (d) when all internal sources are turned off. Using Ohm's law, we write
          





            The negative sign in this equation results from the reference directions originally assigned to
            i
TEST
            and
            v
TEST
            in
            Figure 3-51
            (b). Using the superposition principle, we find the
            i-v
            relationship of the source circuit at the interface to be
          





            This equation has the same form as the
            i-v
            relationship of the Thévenin equivalent circuit in
            Eq. (3-21)
            when
            v
TEST
            =
            v
            ,
            i
TEST
            =
            i
            ,
            v
OC
            =
            v
T
            , and
            R
T
            =
            R
EQ
            .
          

            The derivation points out another method of finding the Thévenin resistance. As indicated in
            Figure 3-51
            (d), when all the independent sources are turned off, the
            i-v
            relationship of the source circuit reduces to
            v
            = -
            iR
EQ
            . Similarly, the
            i-v
            relationship of a Thévenin equivalent circuit reduces to
            v
            = -
            iR
T
            when
            v
T
            = 0. We conclude that
          


(3-26)




            We can find the value of
            R
T
            by determining the resistance seen looking back into the source circuit with all independent sources turned off. For this reason, the Thévenin resistance
            R
T
            is sometimes called the
            lookback resistance.

The next example shows how lookback resistance contributes to finding a Thévenin equivalent circuit.








FIGURE 3-51




Using superposition to prove Thévenin's theorem.














EXAMPLE 3-20



                      (a) Find the Thévenin equivalent of the source circuit to the left of the interface in
                      Figure 3-52
                      (a).
                    
(b) Use the Thévenin equivalent to find the voltage delivered to the load.











FIGURE 3-52









SOLUTION:



                (a) The source circuit in
                Figure 3-52
                (a) is treated in
                Example 3-14
                by using superposition to calculate the open-circuit voltage between terminals A and B. Using the results from
                Example 3-14
                , we have
              





                Turning all sources off in
                Figure 3-52
                (a) leads to the resistance circuit in
                Figure 3-52
                (b). Looking back into the source circuit in
                Figure 3-52
                (b), we see three equal resistances connected in parallel whose equivalent resistance is
                R/
                3. Hence, the Thévenin resistance is
              




                (b) Given the Thévenin circuit parameters
                v
T
                and
                R
T
                , we apply voltage division in
                Figure 3-52
                (a) to find the interface voltage.
              




                The interface voltage is proportional to the sum of the three source voltages. The proportionality constant
                K
                =
                R
L
                /(3
                R
L
                +
                R
                ) depends on both the source and the load since these two circuits are connected at the interface.
                ■














Exercise 3-32


                For the circuit of
                Figure 3-53
                , find the Thévenin equivalent circuit seen by
                R
L
                . Then, use the equivalent circuit to find the load power
                p
L
                when
                R
L
                = 50 Ω, 100 Ω, and 500 Ω.
              
Answers:

v
T
                = 25 V,
                R
T
                = 100 Ω
              

p
L50Ω
                = 1.38 W,
                p
L100Ω
                = 1.56 W,
                p
L500Ω
                = 0.868 W
              

Note that the power delivered to the load appears to peak somewhere near
                100 Ω.
                We will look at the concept of maximum power transfer in the next section.











FIGURE 3-53













Exercise 3-33



                  (a) Find the Thévenin and Norton equivalent circuits seen by the load in
                  Figure 3-54
                  .
                
(b) Find the voltage, current, and power delivered to a 50-Ω load resistor.

Answers:


                  (a)
                  v
T
                  = - 30 V;
                  i
N
                  = - 417 mA;
                  R
N
                  =
                  R
T
                  = 72 Ω
                

                  (b)
                  v
                  = - 123 V;
                  i
                  = - 246 mA;
                  p
                  = 3.03 W
                











Exercise 3-34


                Find the current and power delivered to an unknown load in
                Figure 3-54
                when
                v
                = + 6V.
              
Answers:













FIGURE 3-54









Application to Nonlinear Loads

            Thévenin and Norton equivalent circuits can be used to find the response of a two-terminal nonlinear element (NLE). The method of analysis is a straight forward application of device and interface
            i-v
            characteristics. An interface is defined at the terminals of the nonlinear element, and the linear part of the circuit is reduced to the Thévenin equivalent in
            Figure 3-55
            (a). The
            i-v
            relationship of the Thévenin equivalent can be written with interface current as the dependent variable:
          



(3-27)





            This is the equation of a straight line in the
            i-v
            plane shown in
            Figure 3-55
            (b). The line intersects the
            i
            -axis (
            v
            = 0) at
            i
            =
            v
T
            /
            R
T
            =
            i
SC
            and intersects the
            v
            -axis (
            i
            = 0) at
            v
            =
            v
T
            =
            v
OC
            . This line could logically be called the source line since it is determined by the Thévenin parameters of the source circuit. Logic notwithstanding, electrical engineers call this the
            load line
            for reasons that have blurred with the passage of time.
          









FIGURE 3-55




Graphical analysis of a nonlinear circuit: (a) Given circuit. (b) Load line. (c) Nonlinear device's i-v characteristics. (d) Q-point.




            The nonlinear element has the
            i-v
            characteristic shown in
            Figure 3-55
            (c). Mathematically, this nonlinear characteristic has the form
          



(3-28)





            To find the circuit response, we must solve
            Eqs. (3-27)
            and
            (3-28)
            simultaneously. Computer software tools like MATLAB can easily solve this problem when a numerical expression for the function
            f
            (
            v
            ) is known explicitly. However, in practice an approximate graphical solution is often adequate, particularly when
            f(v
            ) is given only in graphical form.
          
The developers of SPICE software packages like Multisim work hard to create software models of the myriad of electronic devices used in circuit design—yet, even with their best efforts, devices are often very nonlinear and difficult to model accurately. No matter what software model one uses, there is always a possibility of error. That is why circuits are first modeled using software and then built and tested in the laboratory to validate the design.

            In
            Figure 3-55
            (d), we superimpose the load line on the
            i-v
            characteristic curve of the nonlinear element. The two curves intersect at the point
            i
            =
            i
NLE
            and
            v
            =
            v
NLE
            ,
            
            which yields the values of interface variables that satisfy both the source constraints in
            Eq. (3-27)
            and the nonlinear element constraints in
            Eq. (3-28)
            . In the terminology of electronics, the point of intersection is called the operating point or
            Q-point,
            where "Q" stands for "quiescent."
          












EXAMPLE 3-21



                    Find the voltage, current, and power delivered to the diode in
                    Figure 3-56
                    (a). The diode's
                    i
                    -
                    v
                    characterististics are given in
                    Figure 3-56
                    (b).
                  










FIGURE 3-56









SOLUTION:


We first find the Thévenin equivalent of the circuit to the left of terminals A and B. By voltage division, the open-circuit voltage is



When the voltage source is turned off, the lookback equivalent resistance seen between terminals A and B is



The source circuit load line is given by




                This line intersects the
                i
                -axis (
                v
                = 0) at
                i
                =
                i
SC
                = 2.5/60 = 41.7 mA and intersects the
                u
                -axis (
                i
                = 0) at
                v
                =
                v
0C
                = 2.5 V.
                Figure 3-56
                (b) superimposes the source circuit load line on the diode's
                i-v
                curve. The intersection (Q-point) is at
                i=i
D
                =15 mA and
                v
                =
                v
D
                = 16 V. This is the point (
                i
D
                ,
                v
D
                ) at which both the source and diode device constraints are satisfied. Finally, the power delivered to the diode is given by
              





                Because of the nonlinear element, the proportionality and superposition properties do not apply to this circuit. For instance, if the source voltage in
                Figure 3-56
                (a) is decreased from 5V to 2.5V, the diode current and voltage do not decrease by one-half. Try it.
                ■















Exercise 3-35




                Suppose for the circuit shown in
                Figure 3-56
                (a) that the diode's
                i-v
                characteristics can be modeled by the following equation:
              





                where
                v
                is given in volts and
                i
                is given in amperes. Note that these
                i-v
                characteristics are for a different diode from that shown in
                Figure 3-56
                (b). Use manual calculations or the MATLAB function solve to find the exact operating point for this circuit.
              
Answers:

v
D
                = 1.77 V;
                i
D
                = 12.1 mA
              


In summary, any two of the following parameters determine the Thévenin or Norton equivalent circuit at a specified interface:


The open-circuit voltage at the interface


The short-circuit current at the interface


The source circuit lookback resistance
              xs
            


            Alternatively, for ladder circuits, the Thévenin or Norton equivalent circuit can be found by a sequence of circuit reductions (see
            Example 3-18
            ). For general circuits, they can always be found by directly solving for the
            i-v
            relationship of the source circuit using node-voltage or mesh-current equations that include the interface current and voltage as unknowns (see
            Example 3-19
            ).
          

            Simulation software such as Multisim can be used to find the Thévenin or Norton equivalent circuit (see
            Example 3-19
            ). Or alternately, in the field or laboratory, the equivalent circuit parameters can be measured using appropriate instruments such as a multimeter for dc circuits.
          



3-5 Maximum Signal Transfer

          An interface is a connection between two circuits at which the signal levels may be observed or specified. In this regard, an important consideration is the maximum signal levels that can be transferred across a given interface. This section defines the maximum voltage, current, and power available at an interface between a
          fixed source
          and an
          adjustable load.


          For simplicity we will treat the case in which both the source and load are linear resistance circuits. The source can be represented by a Thévenin equivalent and the load by an equivalent resistance
          R
L
          , as shown in
          Figure 3-57
          . For a fixed source, the parameters
          v
T
          and
          R
T
          are given and the interface signal levels are functions of the load resistance
          R
L
          .
        








FIGURE 3-57




Two-terminal interface for deriving the maximum signal transfer conditions.



By voltage division, the interface voltage is



(3-29)





          For a fixed source and a variable load, the voltage will be a maximum if
          R
L
          is made very large compared with
          R
T
          . Ideally,
          R
L
          should be made infinite (an open circuit), in which case
        


(3-30)




          Therefore, the maximum voltage available at the interface is the source open-circuit voltage
          v
OC
          .
        
The current delivered at the interface is



(3-31)





          For a fixed source and a variable load, the current will be a maximum if
          R
L
          is made very small compared with
          R
T
          . Ideally,
          R
L
          should be zero (a short circuit), in which case
        


(3-32)





          Therefore, the maximum current available at the interface is the source short-circuit current
          i
SC
          .
        

          The power delivered at the interface is equal to the product
          v
          ×
          i
          . Using
          Eqs. (3-29)
          and
          (3-31)
          , the power is
        



(3-33)





          For a given source, the parameters
          v
T
          and
          R
T
          are fixed and the delivered power is a function of a single variable
          R
L
          . The condition for maximum voltage (
          R
L
          → ∞) and the condition for maximum current (
          R
L
          = 0) both produce zero power. The value of
          R
L
          that maximizes the power lies somewhere between these two extremes. To find this value, we differentiate
          Eq. (3-33)
          with respect to
          R
L
          and solve for the value of
          R
L
          for which
          dp/dR
L
          = 0.
        


(3-34)




          Clearly, the derivative is zero when
          R
L
          =
          R
T
          . Therefore,
          maximum power transfer
          occurs when the load resistance equals the Thévenin resistance of the source. When the condition
          R
L
          =
          R
T
          exists, the source and load are said to be
          matched.


          Substituting the condition
          R
L
          =
          R
T
          back into
          Eq. (3-33)
          shows the maximum power to be
        


(3-35)




          Since
          v
T
          =
          i
N
R
T
          , this result can also be written as
        


(3-36)



or



(3-37)





          These equations are consequences of what is known as the
          maximum power transfer theorem:





A source with a fixed Thévenin resistance R


T


delivers maximum power to an adjustable load R


L


when R


L

              =
              
R


T

              .
              
3




To summarize, at an interface with a fixed source,



1.

            The maximum available voltage is the open-circuit voltage.
          


2.

            The maximum available current is the short-circuit current.
          


3.

            The maximum available power is the product of one-half the open-circuit voltage times one-half the short-circuit current.
          


Figure 3-58
          shows plots of the interface voltage, current, and power as functions of
          R
L
          /
          R
T
          . The plots of
          v
          /
          v
OC
          ,
          i
          /
          i
SC
          , and
          p
          /
          p
MAX
          are normalized to the maximum
          
          available signal levels, so the ordinates in
          Figure 3-58
          range from 0 to 1. The plot of the normalized power
          p
          /
          p
MAX
          in the neighborhood of the maximum is not a particularly strong function of
          R
L
          /
          R
T
          . Changing the ratio
          R
L
          /
          R
T
          by a factor of 2 in either direction from the maximum reduces
          p
          /
          p
MAX
          by less than 20%. The normalized voltage
          v
          /
          v
OC
          is within 20% of its maximum when
          R
L
          /
          R
T
          = 4. Similarly, the normalized current is within 20% of its maximum when
          R
L
          /
          R
T
          =
          1
          /
          4
          . In other words, for some designs, we can get close to the maximum signal levels with load resistances that only approximate the theoretical requirements.
        








FIGURE 3-58




Normalized plots of current, voltage, and power versus R
L
              /
              R
T
              .
            














EXAMPLE 3-22



                  A source circuit with
                  v
T
                  = 25 V and
                  R
T
                  = 60 Ω drives a load with
                  R
L
                  = 30Ω.
                

(a) Determine the maximum signal levels available from the source circuit.
(b) Determine the actual signal levels delivered to the load.





SOLUTION:


(a) The maximum available voltage and current are as follows:




              The maximum available power is found using
              Eq. (3-37)
              .
            



(b) The actual signal levels delivered to the 30-Ω load are as follows:




              Although these levels are less than the maximum available values, the power delivered to the 30-Ω load is nearly 90% of the maximum.
              ■















Exercise 3-36


A source circuit delivers 4V when a 50-Ω resistor is connected across its output and 5V when a 75-Ω resistor is connected. Find the maximum voltage, current, and power available from the source.
Answers:
10V; 133 mA; 333 mW




          Remember that the maximum signal levels just derived are for a fixed source resistance and an adjustable load resistance. This situation often occurs in communication systems where devices such as antennas, transmitters, receivers, and signal generators have fixed source resistances such as 50, 75, 300, or 600 ohms. In such cases, the load resistance is selected to achieve the desired interface conditions, which often involves matching. For example, transmitting antennas are matched to the transmitter. Receivers are matched to receiving antennas. Signal generators used to test both receiving and transmitting systems are matched to the system's resistance.
        

          Matching source and load applies when the load resistance
          R
L
          in
          Figure 3-57
          is adjustable and the Thévenin source resistance
          R
T
          is fixed. When
          R
L
          is fixed and
          R
T
          is adjustable, then
          Eqs. (3-29)
          ,
          (3-31)
          , and
          (3-33)
          point out that the maximum voltage, current, and power are delivered when the Thévenin source resistance is zero. If the source circuit at an interface is adjustable, then ideally the Thévenin source resistance should be zero, which is not possible. In
          Chapter 4
          , we will see that OP AMP circuits approach this ideal.
        


3-6 Interface Circuit Design

          The maximum signal levels discussed in the previous section place bounds on what is achievable at an interface. However, those bounds are based on a fixed source and an adjustable load. In practice, there are circumstances in which the source or the load, or both, can be adjusted to produce prescribed interface signal levels or neither can be adjusted. Sometimes it is necessary to insert a circuit between the source and the load to achieve the desired results.
          Figure 3-59
          shows the general situations and some examples of resistive interface circuits. By its nature, the inserted circuit has two terminal pairs, or interfaces, at which voltage and current can be observed or specified. These terminal pairs are also called
          ports,
          and the interface circuit is referred to as a
          two-port network.
          The port connected to the source is called the input, and the port connected to the load is called the output. The purpose of this two-port network is to make certain that the source and load interact in a prescribed way.
        








FIGURE 3-59




A general interface circuit and a few examples: (a) Simple pass-through (often omitted), (b) series resistor, (c) parallel resistor, (d) L-pad left, (e) L-pad right.




          There is near-infinite number of interface circuits that one can use or devise to meet the many interfacing challenges an analog design engineer faces. The five shown in
          Figure 3-59
          represent the simplest ones. The pass-through is used when the load or the source can be varied by the designer—in practice it may actually not even be shown since it is a simple connection between the source and the load (Examples 3-23 and 3-24). The series and parallel interfaces are used to help deliver a particular current, voltage, or power to a fixed load from a fixed source. In general, the series interface works best when the load is powered by a voltage source and a parallel interface works best when the load is powered by a current source (Examples 3-25 and 3-26). The L-pads are used in helping to match the fixed source and fixed
          
          load resistances and deliver specific voltages, currents, or power (Examples 3-27 to 3-29). A common example is matching a stereo amplifier to a speaker—see
          Figure 3-60
          . A more complex interface circuit is the bridge-T considered in
          Example 3-31
          . That interface serves as an attenuation pad to reduce the signal by a fixed amount while maintaining the input and output resistances. In the following section we will see how to design these interface circuits for various applications.
        








FIGURE 3-60




L-pad for matching amplifier output to speakers.




Basic Circuit Design Concepts
Before we treat examples of different interface situations, you should recognize that we are now discussing a limited form of circuit design, as contrasted with circuit analysis. Although we use circuit analysis tools in design, there are important differences. A linear circuit analysis problem generally has a unique solution. A circuit design problem may have many solutions or even no solution given the constraints provided. The maximum available signal levels found in the preceding section provide bounds that help us test for the existence of a solution. Generally, there will be several ways to meet the interface constraints, and it then becomes necessary to evaluate the alternatives using other factors, such as cost, power consumption, or reliability.

            At this point in our study, resistors are the only elements we can use to design interface circuits. In subsequent chapters, we will introduce other devices, such as OP AMPs (
            Chapter 4
            ), capacitors and inductors (
            Chapter 6
            ) and transformers (
            Chapter 15
            ). For this chapter, in a design situation, the engineer must choose the resistance values in a proposed circuit. This decision is influenced by a host of practical considerations, such as standard values and tolerances, power ratings, temperature sensitivity, cost, and fabrication methods. We will occasionally introduce some of these considerations into our design examples. Gaining a full understanding of these practical matters is not one of our objectives. Rather, our goal is simply to illustrate how different constraints can influence the design process.
          












DESIGN EXAMPLE 3-23


                    Select the load resistance in
                    Figure 3-61
                    so that the interface signals are in the range defined by
                    v
                    ≥ 4 V and
                    i
                    ≥ 30 mA.
                  










FIGURE 3-61









SOLUTION:


In this design problem, the source circuit is given and we are free to select the load. For a fixed source, the maximum signal levels available at the interface are as follows:



The bounds given as design requirements are below the maximum available signal levels, so we should be able to find a suitable resistor. Using voltage division, the interface voltage constraint requires



or





                This condition yields
                R
L
                ≥ 400/6 ≥ 66.7 Ω. The interface current constraint can be written as
              



or






                which requires
                R
L
                ≤ 7/0.03 ≤ 233 Ω. In theory, any value of
                R
L
                between 66.7 Ω and 233 Ω will work. However, to allow for parameter variations we select
                R
L
                = 150 Ω because it lies at the arithmetic midpoint of the allowable range and is a standard value of resistance (see
                Appendix G
                ). The interface in this example is a simple pass-through as shown in
                Figure 3-59
                (a).
                ■
















                  Design
                  Exercise 3-37



                Select
                R
L
                in
                Figure 3-61
                so that 190 ± 10% mW are delivered to the load. Select a 10% resistor from
                Appendix G
                that will provide the desired power.
              
Answers:

R
L
                = 33 Ω (187 mW or 270 Ω (197 mW. The 270-Ω load requires the source to deliver less power to the total circuit,
                P
S270
                = 270 mW versus
                P
S33
                = 752 mW, and generally is the better solution. The interface in this exercise is a simple pass-through as shown in
                Figure 3-59
                (a).
              
















                    DESIGN EXAMPLE 3-24
                  

                    Select a 5% standard-value load resistor
                    R
L
                    from
                    Appendix G
                    for the circuit in
                    Figure 3-62
                    (a) that will result in 10 V ±
                    5%
                    delivered across it.
                  




SOLUTION:



                Start by finding the Thévenin equivalent circuit that
                R
L
                sees. The Thévenin voltage is found using a voltage divider
              




                We can find
                R
T
                by the look-back method
              





                Using the Thévenin circuit we just found (see
                Figure 3-62
                (b)), we find the maximum voltage possible by choosing
                R
L
                to be an open circuit. By inspection, we determine that
                v
MAX
                = 20 V. Hence, it is possible to find a suitable resistor to deliver 10 V.
              








FIGURE 3-62








                Using voltage division with the Thévenin circuit, we find
                R
L
                as follows:
              




                From the table in
                Appendix G
                , we find that a 5% 3.6-kΩ resistor is available. Using it as our choice, we find that the resistance can vary as 3.42 kΩ ≤
                R
L
                ≤ 3.78 kΩ. Therefore, the output voltage can vary as 966 V ≤
                v
L
                ≤ 1016 V. This is within the 10 V ± 5% required of 9.5 V ≤
                v
O
                ≤ 10.5 V.
              

                Our interface is a simple pass-through as shown in
                Figure 3-59
                (a).
                ■















                Design
                Exercise 3-38


                For the circuit in
                Figure 3-62
                (a), select a load resistor so that 5 mA flows through it. Repeat the task for 6 mA.
              
Answers:

R
L
                = 340 Ω for 5 mA. The maximum current available,
                i
SC
                , is 5.46 mA, hence there is no resistor that can result in 6 mA flowing through it.
              











                Design
                Exercise 3-39



                For the circuit of
                Figure 3-62
                (a), determine the maximum power available, and if sufficient, select a resistive load that will dissipate 20 mW.
              
Answers:


P

MAX
                = 27.3 mW;
                R
L
                = 1.169 kΩ or 11.50 kΩ
              
















                    DESIGN EXAMPLE 3-25
                  
A light-emitting diode (LED) converts electric current into an optical signal. LEDs operate at low signal levels with voltages from about 1V to perhaps 3 V and at currents between about 10 mA and 40 mA. Voltages or currents above these levels may damage or destroy the device.

Figure 3-63
                    shows an LED operating at
                    v
                    = 1.5 V and connected to a 5-V source by an interface circuit. Design the interface circuit so that the LED current is
                    i
                    = 15 mA ± 10% using one or more of the following standard resistors: 110 Ω, 160 Ω, 240 Ω, 360 Ω, and 510 Ω. These resistors all have a tolerance of ±5%, which you must account for in your design.
                  










FIGURE 3-63









SOLUTION:


If the source is directly connected to the LED, the delivered current would be




                This much current would destroy (vaporize?) the device. The series resistor
                R
1
                interface [
                Figure 3-59
                (b)] is needed to limit the current to the prescribed level. Applying KVL around the series loop yields
              





                Setting
                i
                = 15 mA and solving for
                R
1
                yields
              




                The nearest standard value listed is 240 Ω±5%, which means that
                R
1
                would fall in the range 228 ≤
                R
1
                < 252 Ω. At the end points of this range, the LED current is
              




                Both of these values are within the 15 mA± 10% tolerance on the LED current.
                ■















                Design
                Exercise 3-40


                Suppose the source circuit in
                Figure 3-63
                is now 12 V in series with a 5-Ω source resistor. The same LED is used. How does the solution change?
              
Answers:

R
1
                = 695 Ω. If we are restricted to using the resistors specified, then there are at least two reasonable solutions. First, we could use a 510-Ω resistor in series with a 160-Ω resistor to give a total resistance of 670 Ω. Another option would be to combine a 510-Ω resistor in series with a parallel combination of two 360-Ω resistors to give a total resistance of 690 Ω. These options satisfy the constraints, even if we account for the resistor tolerances.
              

















DESIGN AND EVALUATION EXAMPLE 3-26



                    Design two versions of the interface circuit in
                    Figure 3-64
                    that deliver
                    v
2
                    = 5 V to the 200-Ω load. Evaluate the two designs in terms of power loss in the interface circuit.
                  










FIGURE 3-64









SOLUTION:


If the 15-V source is directly connected to the load, the delivered voltage would be



An interface circuit is required to reduce this voltage to the prescribed 5-V level.

                The figure shows two possible interface circuits [
                Figure 3-59
                (b) and (c)]. In either case
              




                In the series case,
                i
1
                =
                i
2
                = 0025, and the same current flows through all elements in the loop. Applying KVL to the series loop
              





                and solving for
                R
1
                ,
              




                In the parallel case,
                v
1
                =
                v
2
                = 5 V. Applying KCL to the parallel resistor
                R
2





                and solving for
                R
2
                ,
              




                We have two alternative designs, both of which deliver
                v
2
                = 5 V to the 200-Ω load.
              
In practice, engineers use additional factors to evaluate alternatives that meet the same design goal. The power dissipation in the interface circuit is an important factor for two reasons. First, less interface dissipation means less power demand on the source. Second, less dissipation in the interface resistors means they can have lower power ratings, which are generally less expensive.

                In the series case, the power dissipated in
                R
1
                is
                
                = 0219 W. In the parallel case, the power dissipated in
                R
2
                is
                
                . Clearly, the power dissipation factor strongly favors the series design in this case.
                ■
















                Design and Evaluation Exercise 3-41
              

                A Norton source of 300 mA in parallel with a 50-Ω source resistor provides current to a load
                R
L
                = 200 Ω. Your task is to design an interface so that 5 V± 10% are delivered to the load.
              


                  (a) Using the series resistor
                  R
S
                  interface shown in
                  Figure 3-59
                  (b), select a 10% resistor from
                  Appendix G
                  that will provide the desired voltage.
                

                  (b) Using the parallel resistor
                  R
P
                  interface shown in
                  Figure 3-59
                  (c), select a 10% resistor from
                  Appendix G
                  that will provide the desired voltage.
                
(c) Select the solution, series or parallel, that causes the source to provide the desired voltage while delivering the least power. Calculate the power in each case to defend your choice.



                Answers:
              


                  (a)
                  R
S
                  = 350 Ω; hence choose 330-Ω resistor (
                  v
L
                  = 5.17 V).
                

                  (b)
                  R
P
                  = 28.57 Ω; hence choose 27-2 resistor (
                  v
L
                  = 4.84 V).
                

                  (c)
                  p
S
                  = 4.11 W;
                  p
p
                  = 1.45 W; hence choose the parallel solution.
                



Discussion:


                  This is the same problem with the same numbers as in
                  Example 3-26
                  except that a Norton source provides the energy rather than the voltage source (do a source transformation on the Thévenin source in
                  Example 3-26
                  ). As expected, the interfaces are the same. Yet in this case, the parallel solution requires the source to deliver less power than the series solution. What these two exercises point out is that equivalent sources are equivalent only to the rest of the circuit and not internally. One cannot do a source transformation and then use the transformed source to determine the power the original source provides.
                

















DESIGN EXAMPLE 3-27


                    Design the interface circuit in
                    Figure 3-65
                    so that the 40-V source delivers
                    v
2
                    = 2 V to the output load and the resistance seen at the input port is
                    R
IN
                    = 300 Ω.
                    

Note:


                    This is a classic case of matching the source to the load. For example, many high-frequency (HF) radio antennas are 300 Ω while the receiver is 50 Ω. Design
                    Exercise 3-44
                    asks to match a 300-Ω TV antenna to a 75-Ω HDTV set. Matching avoids a signal loss otherwise caused by the mismatch.
                  










FIGURE 3-65









SOLUTION:


This example places constraints at both the output port and the input port of the interface circuit. In most cases, two independent constraints cannot be satisfied using only one resistor in the interface circuit. To see why, suppose we use a single 650-Ω series resistor in the interface circuit. By voltage division, the output voltage would be




                as required. However, the input resistance would be
                R
IN
                = 650 + 50 = 700 Ω, which does not meet the input port requirement of 300 Ω.
              

                To meet both requirements, we need a two-resistor L-circuit such as the one shown
                Figure 3-59
                (d). To design this circuit, we first define
                R
EQ
                =
                R
2
                ||50. Using this notation, the input port constraint is
                R
IN
                =
                R
1
                +
                R
EQ
                = 300 Ω and the output port constraint becomes
              




                But
                R
1
                +
                R
EQ
                = 300; hence, the output constraint reduces to 40
                R
EQ
                = 2 × 600, which means that
                R
EQ
                = 30 Ω. By definition,
              




                which leads to 50
                R
2
                = 1500 + 30
                R
2
                , or
                R
2
                = 75 Ω. Finally, since
                R
EQ
                = 30 Ω, the input port constraint then tells us that
                R
1
                = 300 -
                R
EQ
                = 270 Ω. In sum, the L-circuit in the figure with
                R
1
                = 270 Ω and
                R
2
                = 75 Ω will meet both the input port and the output port constraints.
                ■















                Design
                Exercise 3-42



                Repeat
                Example 3-27
                with the desired
                v
                2 = 10 V instead of 2 V.
              
Answers:

R
2
                = - 75 Ω; since a resistor cannot be negative, it is not possible.
              
















                    EVALUATION EXAMPLE 3-28
                  

                    In
                    Example 3-27
                    , we designed the interface circuit in
                    Figure 3-65
                    to meet the requirements
                    v
2
                    = 2 V and
                    R
IN
                    = 300 Ω. It is claimed that the interface circuit in
                    Figure 3-66
                    meets the same requirements.
                  


                      (a) Verify that the circuit in
                      Figure 3-66
                      produces
                      v
2
                      = 2 V and
                      R
IN
                      = 300 Ω.
                    
(b) It is desired that the 50-Ω load "see" a low output resistance. Which of these two circuits best meets this requirement?











FIGURE 3-66









SOLUTION:



                (a) The circuit in
                Figure 3-66
                meets the input port constraint since
              



as required. Using this fact and voltage division, we find the voltage at the input port of the interface circuit to be



Using this voltage as the input to the voltage divider made up of the 450-Ω series resistor and the 50-Ω load gives




                This verifies that the circuit in
                Figure 3-66
                produces
                v
2
                = 2V and
                R

IN

                = 300 Ω.
              

                (b) To compare the output resistances, we turn the 40-V source off (replace it by a short) and find the lookback resistance seen at the output port. For the circuit in
                Figure 3-65
                ,
              




                For the circuit in
                Figure 3-66
                ,
              




                The circuit of
                Figure 3-65
                is much closer to the desired resistance seen by the load and is the better choice.
                ■















                Evaluation
                
                  Exercise 3-43
                  



                Use Multisim to determine which solution,
                Figure 3-65
                or
                Figure 3-66
                , requires less power from the source.
              
Answers:
Both require the same power, 2.667 W.


Discussion:

In fact, one need not do any analysis or simulation if the only question to answer is which is lower. In the preceding example, it was shown that both circuits met the same requirements, in particular that R

IN

                = 300 Ω.
                Since both circuits met that requirement exactly, both would have the same source current, namely
                40/(300 + 300) = 66.67 mA,
                and therefore, the same power. Of course, the simulation would verify that fact.

















DESIGN EXAMPLE 3-29



                    Design the interface circuit in
                    Figure 3-67
                    so the 50-Ω load "sees" a Thévenin resistance of 50 Ω between terminals C and D, while simultaneously the input voltage source "sees" an input resistance of 300 Ω between terminals A and B. Meeting these two constraints produces matched conditions at the input and output ports of the interface circuit.
                  




SOLUTION:



                To meet the two constraints in this example, the interface circuit should be a two-resistor L-circuit. We have chosen the L-circuit configuration shown in
                Figure 3-59
                (d) for the following reasons. The source must see a larger resistance (300 Ω) at the input port than the load sees at the output port (50 Ω). This indicates that the source should "look" into a large series resistor
                R
1
                while the load "looks" into a smaller parallel resistor
                R
2
                .
              
The design constraints in this example can be expressed in equation form. At the input port (terminals A and B), the equation is



At the output port (terminals C and D), the equation is



The design requirements reduce to two equations in two unknowns. What could be simpler?








FIGURE 3-67









                These equations can easily be solved using a program like MATLAB. Solving them using pencil and paper is a bit of a chore. At this point, we encourage you to think about the problem in physical terms. For instance, if we simply set
                R
                2 = 50, then the conditions at terminals C and D will be met, at least approximately. With
                R
                2 = 50 Ω, the requirement at terminals A and B reduces to
                R
AB
                =
                R
1
                +50||50 =
                R
1
                + 25 = 300 Ω. In other words, by physical reasoning we conclude that
                R
1
                = 275 Ω and
                R
2
                = 50 Ω is an approximate solution. How good is the approximation?
              

                These values yield input and output resistances of
                R
AB
                = 300 Ω as required, and
              



This value is not exactly 50 Ω, but it is within 10% of the desired value. Since electrical components may have tolerances in the 10% range, a design based on our first-guess approximation might be adequate.

                Our first-guess solution can also serve as the starting place for improving the design. The fact that
                R
                CD = 46 Ω tells us that
                R
                2 = 50 Ω is just a bit too low. Suppose we increase
                R
2
                slightly to, say,
                R
2
                = 56 (a standard value—see
                Appendix G
                ). Then, at the input port, we have
              




                which would require
                R
1
                = 273.58 Ω. The nearest standard value to this is
                R
1
                = 270 Ω. Using the standard values
                R
1
                = 270 Ω and
                R
2
                = 56 Ω as our second guess, the input and output resistances are
              




                both of which are within 2% of the desired values. Thus, finding an approximate solution can serve as the first step in the design process. Performing the first step is often the most creative and challenging part of circuit design.
                ■














FIGURE 3-68




                300 Ω
                to
                75 Q
                adapter.











Design Exercise 3-44



                A common problem is interfacing a TV antenna's 300-Ω line to a 75-Ω cable input on an HDTV set. Repeat
                Example 3-29
                for this particular interface. See
                Figure 3-68
                for a photo of such a device.
              
Answers:


R

1=
                259.8 Ω;
                R
2
                = 86.6 Ω
              











                  APPLICATION
                  EXAMPLE 3-30



                The source-load interface in
                Figure 3-69
                serves to introduce an important concept that we will encounter many times in subsequent chapters. By simple voltage division, the interface voltage is
              











FIGURE 3-69









                If the source is ideal (
                R
T
                = 0), then the interface voltage is
                v
                =
                v
T
                regardless of the value of the load
                R
L
                . Conversely, if the load is an open circuit (
                R
L
                = ∞), then the interface voltage is
                v
                =
                v
T
                regardless of the value of the source resistance
                R
T
                . Real-world applications typically fall between these two extremes with the result that
                v
                ≤
                v
T
                . Since
                v
T
                =
                v
OC
                =
                v
MAX
                , interface voltage is generally less than the maximum available voltage. The reduction in interface voltage is an example of an effect called
                loading.
                In general
              




Loading is the reduction in load voltage due to the effect of load resistance on the signal source driving it.





                A loading problem is fundamentally different than the fixed-source, maximum power transfer problem. With loading, the source and load are both adjustable and the question is how they should be chosen to
                minimize loading.
                The undesirable effects of loading can be mitigated by making
                R
T
                ≪
                R
L
                either by reducing the output resistance of the source or by increasing the load resistance, or both. As a rule of thumb, the loading effect is less than 10% when
                R
L
                ≥ 10
                R
T
                and less than 1% when
                R
L
                ≥ 100
                R
T
                . The usefulness of OP AMPs studied in the next chapter is due in part to their ability to significantly reduce loading.
              










Exercise 3-45


                Suppose
                R
T
                = 200 Ω and the loading effect should be less than 1%. What should be the smallest value for
                R
L
                ?
              
Answers:

R
L
                ≥ 20 kΩ
              

















                      APPLICATION
                      EXAMPLE 3-31



                    An
                    attenuation pad
                    is a two-port resistance circuit that provides a nonadjustable reduction in signal level while also providing resistance matching at the input and output ports. Attenuators are used in numerous applications such as in audio recording studios to reduce the signal coming from a microphone into an audio mixer. A picture of a typical commercial in-line attenuator is shown in
                    Figure 3-70
                    (a).
                  








FIGURE 3-70




Switchable in-line attenuator.





Figure 3-70
                    (b) shows the circuit of a particular attenuation pad. The manufacturer's data sheet for this pad specifies the following characteristics at the input and output ports:
                  




Port


Characteristics


Condition


Value


Units





Output
Thévenin voltage
600-Ω source connected at the input port

v
S
                          /4
                        
V


Output
Thévenin resistance
600-Ω source connected at the input port
600
Ω


Output
Attenuation
600-Ω load connected at the output port



dB


Input
Input resistance
600-Ω load connected at the output port
600
Ω



Use Multisim to verify these characteristics.










FIGURE 3-71









SOLUTION:



                Multisim can readily be used to calculate the two-port characteristics of the pad shown in
                Figure 3-70
                (b). To find the Thévenin voltage and resistance, draw the circuit in Multisim without the 600-Ω load as shown in
                Figure 3-71
                . Since Multisim needs an input to do a simulation, connect a 1-V source to the input. Copy the circuit a second time. Connect a multimeter (DMM) across the output of each circuit. In the
                
                first case, connect the multimeter as an ammeter (a short) to measure
                i
SC
                . In the second case, connect the meter as a voltmeter (an open) to measure
                v
OC
                . Simulate the circuit. The ammeter reads 4167 µA, while the voltmeter reads 250 mV, a quarter of the input voltage
                v
S
                . Recalling that the Thévenin resistance is given by
                R
T
                =
                v
OC
                /
                i
SC
                , we calculate that
                R
T
                = 600 Ω. Both
                u
T
                and
                R
T
                are as specified.
              

                To determine if the pad actually attenuates the input signal by 12 dB and if the input sees 600 Ω, we copy the circuit a third time, remove the DMM, and add the 600-Ω load to the circuit, as would be expected in the attenuation application. We can calculate the input resistance by knowing the current provided by the source to the circuit and the voltage of the input to the pad. The current through the first 600-Ω resistor (
                R
12
                in the figure) is the current provided by the source to the pad. The voltage at the input node to the pad is labeled INPUT in
                Figure 3-71
                . We can ask Multisim to do the calculation for us by adding the following expression to the DC Operating Point Analysis request: V(input)/I(R12). The attenuation (gain) in decibels of the pad is found as
              




                On the circuit the output voltage is labeled OUTPUT and the input voltage is taken at the node labeled INPUT. We ask Multisim to do the calculation as 20*log (V(input)/V(output)). Simulating the circuit Multisim returns 600 Ω for the input resistance as specified. For the attenuation Multisim calculates -12.04 dB, also as specified. Hence, we can conclude that all specifications are met by the device.
                ■

















                  Evaluation
                  Exercise 3-46


The manufacturer's data sheet for the following O-pad used to attenuate the signal from a 150-Ω microphone to a 1500-Ω preamp load specifies the following characteristics at the input and output ports:




Port


Characteristics


Condition


Value


Units





Output
Thévenin voltage
150-Ω source microphone connected at the input port

                      0.031
                      v
S
                      /±5%
                    
V


Output
Thévenin resistance
150-Ω source microphone connected at the input port
1500 ±5%
Ω


Output
Attenuation
150-Ω preamp load connected at the output port



dB


Input
Input resistance
1500-Ω preamp load connected at the output port
150 + 5%
Ω




                Use Multisim to simulate the schematic provided by the manufacturer shown in
                Figure 3-72
                and determine if the specifications are met.
              








FIGURE 3-72







Answers:
All specifications are met.




Summary



Node-voltage analysis
              involves identifying a reference node and the node to datum (Ground) voltages at the remaining
              N -
              1 nodes. The KCL connection constraints at the
              N -
              1 nonreference nodes combined with the element constraints written in terms of the node voltages produce
              N -
              1 linear equations in the unknown node voltages.
            

Mesh-current analysis
              involves identifying mesh currents that circulate around the perimeter of each mesh in a planar circuit. The KVL connection constraints around
              E
              -
              N
              + 1 meshes combined with the element constraints written in terms of the mesh currents produce
              E
              -
              N
              + 1 linear equations in the unknown mesh currents.
            
Node and mesh analysis can be modified to handle both types of independent sources using a combination of three methods: (1) source transformations, (2) selecting circuit variables so independent sources specify the values of some of the unknowns, and (3) using supernodes or supermeshes.

              A circuit is
              linear
              if it contains only linear elements and independent sources. For single-input linear circuits, the
              proportionality property
              states that any output is proportional to the input. For multiple-input linear circuits, the
              superposition principle
              states that any output can be found by summing the outputs produced when each input acts alone.
            

              A
              Thévenin equivalent circuit
              consists of a voltage source in series with a resistance. A
              Norton equivalent circuit
              consists of a current source in parallel with a resistor. The Thévenin and Norton equivalent circuits are related by a source transformation.
            

              The parameters of the Thévenin and Norton equivalent circuits can be determined using any two of the following: (1) the open-circuit voltage at the interface, (2) the short-circuit current at the interface, and (3) the equivalent or
              lookback resistance
              of the source circuit with all independent sources turned off.
            

              The parameters of the Thévenin and Norton equivalent circuits can also be determined using circuit reduction methods or by directly solving for the source
              i-v
              relationship using node-voltage or mesh-current analysis.
            

              For a fixed source and an adjustable load, the maximum interface signal levels are
              v
MAX
              =
              v
OC
              (
              R
L
              = ∞),
              i
MAX
              =
              i
SC
              (
              R
L
              = 0), and
              p
MAX
              =
              v
OC
i
SC
              /4 (
              R
L
              =
              R
T
              ). When
              R
L
              =
              R
T
              , the source and load are said to be matched.
            
Interface signal transfer conditions are specified in terms of the voltage, current, or power delivered to the load. The design constraints depend on the signal conditions specified and the circuit parameters that are adjustable. Some design requirements may require a two-port interface circuit. An interface design problem may have one, many, or no solutions.





            Chapter 3 Problems
          






                Objective 3-1 General Circuit Analysis (
                Sects. 3-1
                and
                3-2
                )
              
Given a circuit:

(a) (Formulation) Write node-voltage or mesh-current equations for the circuit.
(b) (Solution) Solve the equations from (a) for selected signal variables or input-output relationships using classical or software computational techniques.


                Node-voltage method: See
                Examples 3-1
                to
                3-7
                and
                Exercises 3-2
                to
                3-13
                .
              

                Mesh-current method: See
                Examples 3-8
                to
                3-10
                and
                Exercises 3-14
                to
                3-20
                .
              





3-1
              Formulate node-voltage equations for the circuit in
              Figure P3-1
              . Arrange the results in matrix form
              Ax
              =
              b.








FIGURE P3-1









3-2


(a)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-2
                  . Arrange the results in matrix form
                  Ax
                  =
                  b.


(b)
                  Solve these equations for
                  o
A
                  and
                  v
B
                  .
                

(c)
                  Use these results to find
                  v
x
                  and
                  i
x
                  .
                









FIGURE P3-2










3-3


(a)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-3
                  .
                

(b)
                  Solve these equations for
                  v
A
                  and
                  v
B
                  .
                

(c)
                  Use these results to find
                  v
x
                  and
                  i
x
                  .
                









FIGURE P3-3









3-4


(a)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-4
                  . Arrange the results in matrix form
                  Ax
                  =
                  b.


(b)
                  Solve these equations for
                  v
A
                  and
                  v
C
                  .
                

(c)
                  Use these results to find
                  v
x
                  and
                  i
x
                  .
                









FIGURE P3-4









3-5

              The following are a set of node-voltage equations; draw the circuit they represent.
              




3-6



(a)
                  Choose a ground wisely and formulate node-voltage equations for the circuit in
                  Figure P3-6
                  .
                

(b)
                  Solve for
                  v
x
                  and
                  i
x
                  .
                

(c)
                  Validate your answers using Multisim.
                









FIGURE P3-6









3-7




(a)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-7
                  .
                

(b)
                  Use MATLAB to find symbolic expressions for the node voltages in terms of the parameters in the circuit.
                

(c)
                  Find numeric values for
                  v
A
                  ,
                  v
B
                  , and
                  v
C
                  when
                  R
1
                  = 10 kΩ,
                  R
2
                  = 15 kΩ,
                  R
3
                  = 22 kΩ,
                  R
4
                  = 33 kΩ,
                  i
S1
                  = 10 mA, and
                  i
S2
                  = 30 mA.
                


(d)
                  Use Multisim to verify your solution to part (c) is correct.
                









FIGURE P3-7










3-8



(a)
                  Formulate node-voltage equations for the bridge circuit in
                  Figure P3-8
                  .
                

(b)
                  Solve for
                  v
x
                  and
                  i
x
                  when
                  R
1
                  =
                  R
4
                  = 1 kΩ,
                  R
2
                  =
                  R
3
                  = 1.5 kΩ,
                  R
x
                  = 680 Ω, and
                  v
S
                  = 12V.
                

(c)
                  Repeat (b) when
                  R
4
                  is a variable resistor that varies from 10 Ω to 100 kΩ. At what value of
                  R
4
                  is the voltage across
                  R
x
                  = 0 V? Use Multisim to find the value by either varying
                  R
4
                  by trial and error to approach the answer or using a "Parameter sweep" found under Analyses. To use the latter, proceed as follows: Under "Parameter sweep" select "Device type:"
                  Resistor
                  ; "Name:" your name for our R4; "Parameter (what you wish to vary):"
                  resistance
                  ; "Present value:" Any value within your range - say, 1.5 kΩ. Under "Points to sweep", choose "Decade" sweep variation type. "Start" at 10 Ω; "Stop" at 100 kΩ. Use
                  100 points per decade
                  - Multisim automatically calculates the increment. Under "More Options" choose "DC Operating Point". Then go to the output tab under the Parameter Sweep window. Since you want the voltage across the 680-Ω resistor, create an expression for it, such as
                  V(2) - V(3)
                  if those are the node names of the two nodes determining the resistor voltage. Choose "Run." Grapher View will plot a graph of the resistance value versus the voltage across the 680-Ω resistor. Make sure the grid lines are shown on your graph. Use the cursor to find the value of resistance that causes the voltage to go to zero.
                

(d)
                  Repeat the sweep changing
                  R
x
                  from 680 Ω to 1 Ω, 100 Ω, 10 kΩ, 1 MΩ, and 1 GΩ. What value of
                  R
4
                  makes
                  v
x
                  go to zero in each case? What is the range of
                  v
x
                  in each case? What conclusions can you reach?
                









FIGURE P3-8









3-9




(a)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-9
                  . (
                  Hint
                  : Use a supernode.)
                

(b)
                  Solve for
                  v
X
                  and
                  i
x
                  .
                

(c)
                  Verify your results using Multisim.
                









FIGURE P3-9









3-10


(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-10
                  . Arrange the results in matrix form
                  Ax = b
                  .
                

(b)
                  Solve for
                  i
A
                  and
                  i
B
                  .
                

(c)
                  Use these results to find
                  v
x
                  and
                  i
x
                  .
                









FIGURE P3-10









3-11



(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-11
                  . Arrange the results in matrix form
                  Ax = b
                  .
                

(b)
                  Solve for
                  i
A
                  , and
                  i
B
                  .
                

(c)
                  Use these results to find
                  v
x
                  and
                  i
x
                  .
                









FIGURE P3-11









3-12
              Sometimes intuition is simpler than using either mesh-current or node-voltage analysis. Reduce the circuit in
              Figure P3-11
              into a single loop and find the voltage between
              v
a
              and
              v
b
              .
            

3-13




(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-13
                  .
                

(b)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-13
                  .
                

(c)
                  Which set of equations would be easier to solve? Why?
                

(d)
                  Using MATLAB, find
                  v
x
                  and
                  i
x
                  in terms of the mesh-current variables.
                

(e)
                  Using MATLAB, find
                  v
x
                  and
                  i
x
                  in terms of the node-voltage variables.
                









FIGURE P3-13









3-14



(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-14
                  . (
                  Hint:
                  Use a supermesh.)
                

(b)
                  Reduce the circuit to one node using source transformations and solve for the node voltage
                  v
A
                  .
                

(c)
                  Solve for
                  v
x
                  and
                  i
x
                  when
                  R
1
                  = 2.7 kΩ,
                  R
2
                  = 1.5 kΩ,
                  R
3
                  = 680 Ω,
                  R
4
                  = 2.2 kΩ,
                  i
S
                  = 10 mA,
                  v
S1
                  = 5V, and
                  v
S2
                  = 10V.
                

(d)
                  Use Multisim to verify your results in part (c).
                









FIGURE P3-14









3-15




(a)
                  Formulate mesh-current equations for the circuit in Figure P3-15.
                

(b)
                  Use MATLAB to find symbolic expressions for
                  v
x
                  and
                  i
x
                  in terms of the parameters in the circuit.
                

(c)
                  Find numeric values for
                  v
x
                  and
                  i
x
                  when
                  R
1
                  =
                  R
2
                  = 8.2 kΩ,
                  R
3
                  = 22 kΩ,
                  R
4
                  = 33 kΩ,
                  i
S
                  = 2.5 mA,
                  v
S1
                  = 15V, and
                  v
S2
                  = 5 V.
                

(d)
                  Find the power supplied by
                

(e)
                  Use Multisim to verify your solutions to parts (c) and (d) are correct.
                









FIGURE P3-15









3-16
              The circuit in
              Figure P3-16
              seems to require two super-meshes since both current sources appear in two meshes. However, sometimes rearranging the circuit diagram will eliminate the need for a supermesh.
              

(a)
                  Show that supermeshes can be avoided in
                  Figure P3-16
                  by rearranging the connection of resistor
                  R
6
                  .
                

(b)
                  Formulate mesh-current equations for the modified circuit as redrawn in part (a).
                

(c)
                  Solve for
                  v
x
                  when
                  R
1
                  =
                  R
2
                  =
                  R
3
                  =
                  R
4
                  = 1 kΩ,
                  R
5
                  =
                  R
6
                  = 10 kΩ,
                  i
S1
                  = 100 mA, and
                  i
S2
                  = 50 mA.
                









FIGURE P3-16









3-17




(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-17
                  .
                

(b)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-17
                  .
                

(c)
                  Which set of equations would be easier to solve? Why?
                

(d)
                  Find
                  v
x
                  and
                  i
x
                  using whichever method you prefer.
                









FIGURE P3-17









3-18

              Use simple engineering intuition to find the input resistance of the circuit in
              Figure P3-18
              . Use either node-voltage or mesh-current analysis to prove your intuition.
              







FIGURE P3-18












3-19
              Use
              Figure P3-19
              and MATLAB to solve the following problems:
              

(a)
                  Using mesh-current analysis, find a symbolic expression for
                  i
A
                  in terms of the circuit parameters.
                

(b)
                  Compute the ratio
                  v
S
                  /
                  i
A
                  .
                

(c)
                  Find a symbolic expression for the equivalent resistance of the circuit by combining resistors in series and parallel. Compare your answer to the results from part (b).
                









FIGURE P3-19










3-20


(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-20
                  .
                

(b)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-20
                  .
                

(c)
                  Which set of equations would be easier to solve? Why?
                

(d)
                  Use Multisim to find the node voltages
                  v
A
                  and
                  v
B
                  and the mesh currents
                  i
A
                  ,
                  i
B
                  , and
                  i
C
                  in
                  Figure P3-20
                  .
                









FIGURE P3-20












3-21


(a)
                  Formulate mesh-current equations for the circuit in
                  Figure P3-21
                  . Arrange the results in matrix form
                  Ax = b.


(b)
                  Use MATLAB and mesh-current analysis to solve for the mesh currents
                  i
A
                  ,
                  i
B
                  ,
                  i
C
                  , and
                  i
D
                  .
                

(c)
                  Formulate node-voltage equations for the circuit in
                  Figure P3-21
                  . Arrange the results in matrix form
                  Ax = b
                  .
                

(d)
                  Use MATLAB and node-voltage analysis to solve for the mesh currents
                  i
A
                  ,
                  i
B
                  ,
                  i
C
                  , and
                  i
D
                  and compare the effort required with each technique, that is, mesh-current versus node-voltage analysis.
                

(e)
                  Use Multisim to verify your results in the previous two parts.
                









FIGURE P3-21















                Objective 3-2 Linearity Properties (
                Sect. 3 - 3
                )
              
Given a linear resistance circuit:

(a) Use the proportionality principle to find selected signal variables.
(b) Use the superposition principle to find selected signal variables.


                See
                Examples 3-11
                to
                3-13
                and
                Exercises 3-21
                to
                3-26
                for proportionality.
              

                See
                Examples 3-14
                and
                3-15
                , and
                Exercises 3-27
                to
                3-29
                for superposition.
              




3-22


(a)
                  Find
                  v
O
                  for the block diagram shown in
                  Figure P3-22
                  (a).
                

(b)
                  Find the proportionality constant
                  K
                  for the circuit in
                  Figure P3-22
                  (b).
                

(c)
                  Find the proportionality constant
                  K
                  for the circuit in
                  Figure P3-22
                  (c).
                









FIGURE P3-22










3-23


              Design a voltage-divider circuit that will realize the block diagram in
              Figure P3-22
              (a).
            

3-24

              Design a current-divider circuit that will realize the block diagram in
              Figure P3-22
              (b).
            

3-25


              Using a single resistor, design a circuit that will realize the block diagram in
              Figure P3-22
              (c).
            

3-26


(a)
                  Find the proportionality constant
                  K
                  =
                  i
O
                  /
                  v
S
                  for the circuit in
                  Figure P3-26
                  .
                

(b)
                  What are the units associated with the
                  K
                  you found?.
                

(c)
                  If
                  v
S
                  = 10 V, what is
                  i
O
                  ?.
                









FIGURE P3-26









3-27



(a)
                  Find the proportionality constant
                  K
                  =
                  i
O
                  /
                  i
S
                  for the circuit in
                  Figure P3-27
                  .
                

(b)
                  Replace the current source with a voltage source plus side up, and find
                  K
                  =
                  i
O
                  /
                  v
S
                  .
                









FIGURE P3-27









3-28

              Find the proportionality constant
              K
              =
              v
O
              /
              v
S
              for the circuit in
              Figure P3-28
              . Then select values for the resistors so that
              v
O
              is - 01
              v
S
              .
              







FIGURE P3-28










3-29
              Use the unit output method to find
              K
              and
              v
O
              in
              Figure P3-29
              .
              







FIGURE P3-29









3-30
              Use the unit output method to find
              K
              in
              Figure P3-30
              . Then select a value for
              v
S
              that will produce an output current of
              i
O
              = 250 mA.
              







FIGURE P3-30









3-31

              Use the unit output method to find
              K
              in
              Figure P3-31
              . Then find
              v
O
              for the input provided.
              







FIGURE P3-31










3-32
              Use the superposition principle to find
              v
O
              in
              Figure P3-32
              .
              







FIGURE P3-32









3-33

              Use the superposition principle to find
              v
X
              and
              i
X
              in
              Figure P3-33
              .
              







FIGURE P3-33









3-34
              Use the superposition principle to find
              v
O
              in
              Figure P3-34
              .
              







FIGURE P3-34











3-35
              Use the superposition principle to find
              i
O
              in
              Figure P3-35
              . Verify your answer using Multisim.
              







FIGURE P3-35









3-36

              A linear circuit containing two sources drives a 100-Ω load resistor. Source number 1 delivers 1 W to the load when source number 2 is off. Source number 2 delivers 9 W to the load when source number 1 is off. Find the power delivered to the load when both sources are on. (
              Hint:
              The answer is not 10 W. Why?)
            


3-37
              A block diagram of a linear circuit is shown in
              Figure P3-37
              . When
              v
S
=
              20 V and
              i
S
              = 40 mA, the output voltage
              v
O
              = 20 V. The output voltage is 80 V when the voltage source is off or
              v
S
              = 0 V and the current source is
              i
S
              = 20 mA. Find the values of
              K
1
              and
              K
2
              . Then find the output voltage when
              v
S
              = 20 V and
              i
S
              = - 20 mA.
              







FIGURE P3-37









3-38
              A certain linear circuit has four input voltages and one output voltage
              v
O
              . The following table lists the output for different values of the four inputs. Find the input-output relationship for the circuit. Specifically, find an expression for
              v
O
              in terms of the four input voltages. Then draw a block diagram of the circuit.
            






v
S1
                    (V)
                  



v
S2
                    (V)
                  



v
S3
                    (V)
                  



v
S4
                    (V)
                  



v
0
                    (V)
                  





2
4
-4
1
20


1
2
2
1.5
-4


1
4
2
2
-1


0
5
3
-1
3









                Objective 3-3 Thévenin and Norton Equivalent Circuits (
                Sect. 3-4
                )
              
Given a linear resistance circuit:



                  (a) Find the Thévenin or Norton equivalent at a specified pair of terminals.
                
(b) Use the Thévenin or Norton equivalent to find the signals delivered to linear or nonlinear loads.


                See
                Examples 3-16
                to
                3-21
                and
                Exercises 3-30
                to
                3-35
                .
              




3-39

              For the circuit in
              Figure P3-39
              , find the Thévenin and Norton equivalent circuits.
              







FIGURE P3-39









3-40
              For the circuit in
              Figure P3-40
              , find the Thévenin and Norton equivalent circuits.
              







FIGURE P3-40









3-41




(a)
                  Find the Thévenin or Norton equivalent circuit seen by
                  R
L
                  in
                  Figure P3-41
                  .
                

(b)
                  Select a 5% value of
                  R
L
                  from
                  Appendix G
                  that will result in an
                  i
L
                  of 1 mA ±5%. Show that the specification is met.
                









FIGURE P3-41









3-42



(a)
                  Find the Thévenin equivalent circuit seen by
                  R
L
                  in
                  Figure P3-42
                  .
                

(b)
                  Repeat (a) using Multisim. (See
                  Example 3-30
                  .)
                

(c)
                  Find the voltage across the load and the power delivered to it when
                  R
L
                  = 5 Ω, 12.5 Ω, and 20 Ω.
                









FIGURE P3-42










3-43
              Find the Norton equivalent seen by
              R
L
              in
              Figure P3-43
              . Find the current through the load when
              R
L
              = 5kΩ, 10 kΩ, and 47 kΩ.
              







FIGURE P3-43









3-44
              The Thévenin equivalent parameters of a two-terminal source are
              v
T
              = 5 V and
              R
T
              = 150 Ω. Find the minimum allowable load resistance if the delivered load voltage must exceed 3.5 V.
            



3-45


(a)
                  Create the circuit shown in
                  Figure P3-45
                  in Multisim. Do a parameter sweep of the load resistor
                  R
L
                  (arbitrarily set to 1 kΩ) from 1 kΩ to 10 MΩ and plot its power
                  p
L
                  . Using the cursor find the value of
                  R
L
                  that results in the most power delivered to it.
                

(b)
                  Calculate the Thévenin resistance using the lookback method that
                  R
L
                  sees. How does that value compare to the maximum power observed on the Multisim graph?.
                









FIGURE P3-45









3-46



(a)
                  Use Multisim to find the Norton equivalent at terminals A and B in
                  Figure P3-46
                  . (
                  Hint:
                  Use the multimeter to find the open-circuit voltage and short-circuit current at the requisite terminals.)
                

(b)
                  Use the Norton equivalent circuit found in part (a) to determine the power dissipated in
                  R
L
                  when it is equal to 37 kΩ.
                

(c)
                  Use Multisim to simulate both the original and the Norton equivalent circuits with
                  R
L
                  = 37 kΩ. Verify that the power dissipated by the load is the same in both situations.
                









FIGURE P3-46









3-47

              The circuit in
              Figure P3-47
              was solved earlier using superposition (Problem 3-34). In this problem solve for the voltage across the load resistor
              v
L
              by first finding the Thévenin equivalent circuit seen by the load resistor. Find
              v
L
              when
              R
L
              = 2.5 kΩ. (
              Hint
              : Use the lookback method to find
              R
T
              .)
              







FIGURE P3-47









3-48
              Assume that
              Figure P3-48
              represents a model of the auxiliary output port of a car. The output current is
              i
              = 2 A when measured by a very low-resistance ammeter. The voltage is
              V
              = 12 V when measured by a very high-input resistance voltmeter. Suppose you wanted to charge a 6-V battery by connecting the battery at the port, how much current would the port deliver to the battery?
              







FIGURE P3-48









3-49

              The
              i-v
              characteristic of the active circuit represented by
              Figure P3-48
              is 5
              v
              + 500
              i
              = 100. Find the output voltage when a 100-Ω resistive load is connected.
            


3-50

              You have successfully completed the first course in Circuits I, and as part of an undergraduate work-study program your former professor has asked you to help her grade a Circuits I quiz. On the quiz, students were asked to find the power supplied by the source both to the 10-kΩ load (
              R
L
              ) and to the entire circuit as shown in
              Figure P3-50
              . Your professor asks you to help her by creating a grading sheet.
              

(a)
                  Solve the quiz and establish reasonable A, B, C, D, and F cuts for incorrect solutions.
                

(b)
                  A particular student correctly finds the Thévenin equivalent circuit seen by the resistive load and calculates the power to the load using
                  v
T
2
                  /
                  R
L
                  . He then does a source transformation, correctly finding the Norton equivalent of the circuit. He calculates the source power using
                  v
T
                  ×
                  i
N
                  . What grade would you give him?
                

(c)
                  Another student finds
                  p
L
                  = 5.625 mW and
                  p
S
                  = 22.5 mW, but provides no work to justify her answers. What grade would you give her?
                

(d)
                  A third student first finds the Norton equivalent, and then finds the current through the load using a current divider and calculates the power in the load using
                  i
L

2

                  R
                  
L

                  . He figures correctly what the parallel voltage would be across the Norton circuit and the load
                  v
L
                  , and then calculates
                  p
S
                  =
                  i
N
                  ×
                  v
L
                  . What grade would you give him?
                









FIGURE P3-50









3-51



(a)
                  Use a sequence of source transformations and the lookback method to find the Thévenin equivalent at terminals A and B in
                  Figure P3-51
                  .
                

(b)
                  Then select a resistor to connect across A and B so that 3 V appears across it.
                

(c)
                  Suppose the 1-A current source is replaced by an ideal 10-V voltage source with the plus side up. How does this alter the Thévenin circuit?
                









FIGURE P3-51









3-52
              The circuit in
              Figure P3-52
              provides power to a number of loads connected in parallel. The circuit is protected by a 1-mA fuse with a nominal 100-Ω resistance. Each load is 10 kΩ. What is the maximum number of loads the circuit can drive without blowing the fuse?
              







FIGURE P3-52









3-53

              You need to determine the Thévenin equivalent circuit of a more complex linear circuit. A technician tells you she made two measurements using her DMM on the circuit. The first was with a 10-kΩ load and the load current
              i
L
              was 91 µA; the second was with a 1-kΩ load and the load voltage
              v
L
              was 124 mV. Calculate the Thévenin equivalent circuit as shown in
              Figure P3-53
              .
              







FIGURE P3-53









3-54

              A blue LED is connected across a two-terminal source whose Thévenin equivalent is
              v
T
              = 3 V and
              R
T
              = 10 Ω. The
              i-v
              characteristic of the LED is
              i
              = 10
              -12
              (
              e

                10
                v

              - 1).
              Figure P3-54
              shows the LED's
              i-v
              characteristic. Using either MATLAB or a graphical approach, determine the voltage across and current through the LED.
              







FIGURE P3-54









3-55

              A non-linear device has the following
              i-v
              characteristics
              i
              = 2.6 × 10
              -5
v
3
              . It is connected to a Thévenin circuit with a
              v
T
              = 150 V and an
              R
T
              = 8Ω. Using MATLAB find the current through and the voltage across the non-linear device.
            


3-56
              Find the Norton equivalent seen by
              R
L
              in
              Figure P3-56
              .
              
                Select the value of
                R
L
                so that
              


(a)
                  3 V is delivered to the load.
                

(b)
                  300 mA is delivered to the load.
                

(c)
                  100 mW is delivered to the load.
                









FIGURE P3-56















                Objective 3 - 4 Maximum Signal Transfer (
                Sect. 3 - 5
                )
              
Given a linear resistance circuit:

(a) Find the maximum voltage, current, and power available at a specified pair of terminals.
(b) Find the resistive loads required to obtain the maximum available signal levels.


                See
                Example 3-22
                and
                Exercise 3-36
                .
              





3-57
              For the circuit of
              Figure P3-57
              , find the value of
              R
L
              that will result in
              

(a)
                  Maximum voltage. What is that voltage?
                

(b)
                  Maximum current. What is that current?
                

(c)
                  Maximum power. What is that power?
                









FIGURE P3-57









3-58
              For the circuit of
              Figure P3-58
              , find the value of
              R
L
              that will result in:
              

(a)
                  Maximum voltage. What is that voltage?
                

(b)
                  Maximum current. What is that current?
                

(c)
                  Maximum power. What is that power?
                









FIGURE P3-58









3-59


              The resistance
              R
              in
              Figure P3-59
              is adjusted until maximum power is delivered to the load consisting of
              R
              and the 12-kΩ resistor in parallel.
              

(a)
                  Find the required value of
                  R.


(b)
                  How much power is delivered to the load?
                

(c)
                  Validate your answer using Multisim.
                

(d)
                  How much power is delivered to the right 12-kΩ resistor in the load?
                

(e)
                  Compare this value to the power that would be delivered to the load if the resistor
                  R
                  did not exist.
                

(f)
                  If the sole purpose of resistor
                  R
                  is to have the source deliver the most power to the right 12-kΩ resistor, did it achieve the goal?
                









FIGURE P3-59









3-60
              Find the value of
              R
              in the circuit of
              Figure P3-60
              so that maximum power is delivered to the load. What is the value of the maximum power?
              







FIGURE P3-60









3-61




(a)
                  Using Multisim and doing a parameter sweep from 1 Ω. to 1 MΩ
                  .
                  of
                  R
S
                  for the circuit of
                  Figure P3-61
                  , find the value of
                  R
S
                  that will result in the maximum power delivered to the 2-kΩ load.
                

(b)
                  Explain how varying
                  R
S
                  effects the power delivered to the load.
                









FIGURE P3-61










3-62

              A 1-kΩ load needs 10 mA to operate correctly. Design a practical power source to provide the needed current. The smallest source resistance you can practically design for is 50 Ω, but you can add any other series resistance if you need to.
            



3-63
              A10-V source is shown in
              Figure P3-63
              that is used to power a 100-Ω load. Clearly, the load does not match the source resistance for maximum power. A young engineer decides to obtain maximum power from the source by adding a 100-Ω shunt resistor across the load. Has he achieved his goal of having the load obtain maximum power from the source? Explain.
              







FIGURE P3-63















                Objective 3-5 Interface Circuit Design and Evaluation (
                Sect. 3-6
                )
              
Given the signal transfer goals at a source-load interface, design one or more two-port interface circuits to achieve the goals and evaluate the alternative design solutions.

                See
                Examples 3-23
                to
                3-31
                and
                Exercises 3-37
                to
                3-46
                .
              




3-64


(a)

                  Select
                  R
L
                  and design an interface circuit for the circuit shown in
                  Figure P3-64
                  so that the load voltage is 2 V.
                

(b)
                  Suppose that the load was set at 15 kΩ. Now design an appropriate interface so that the load voltage is 2 V.
                









FIGURE P3-64










3-65

              A particular instrument can be modeled as a 470-Ω resistor. It is protected by a 50-mA fuse with negligible resistance. It needs 1W to operate correctly. The available source can be modeled as a 120-V source with a 100-Ω series resistor as shown in
              Figure P3-65
              . Design a suitable interface that will not cause the fuse to blow yet deliver 1 W to the instrument.
              







FIGURE P3-65









3-66


              There is a need to deliver 5 V to a 100-Ω load. There are two sources available that can satisfy the task as shown in
              Figure P3-66
              .
              

(a)

                  Design an appropriate interface for each source. The goal is to minimize the power provided by the source while delivering 5 V to the load.
                

(b)

                  As in many design situations, there is often more than one possible solution. Can either source be used and still obtain the minimum power? Discuss.
                









FIGURE P3-66









3-67


              Design the interface circuit in
              Figure P3-67
              so that the voltage delivered to the load is
              v
              = 10V ± 10%. Use one or more of only the following standard resistors: 1.3 kΩ, 2 kΩ, 3 kΩ, 4.3 kΩ, 6.2 kΩ, and 9.1 kΩ. These resistors all have a tolerance of ± 5%, which you must account for in your design. Repeat the problem if the desired load voltage is 43 V ±10%.
              







FIGURE P3-67










3-68


              In this problem, you will design two interface circuits that deliver 15 V to the 5-kΩ load shown in
              Figure P3-68
              .
              

(a)

                  Design a series resistor interface to meet the requirement.
                

(b)

                  Convert the source circuit to its Norton equivalent and then design a parallel resistor interface to meet the requirements.
                

(c)

                  If minimizing the power that the voltage source delivers is the primary consideration, which of your two designs best meets the requirement?
                









FIGURE P3-68












3-69
              The bridge-T attenuation pad shown in
              Figure P3-69
              was found in a drawer. You need an attenuation pad that would match to a 75-Ω source and a 75-Ω load and provide for a - 12-dB drop of signal (reduction of four times). Use Multisim to determine if the device will work.
              







FIGURE P3-69









3-70


              Design two interface circuits in
              Figure P3-70
              so that the power delivered to the load is 100 mW. In one case use a series interface resistor, and in the second case use a parallel resistor to attain the same result. Evaluate your interface circuits and determine which one results in the source delivering less power.
              







FIGURE P3-70









3-71


              Design the interface circuit in
              Figure P3-71
              so that
              R
IN
              = 100 Ω and the current delivered to the 50-Ω load is
              i
              = 50 mA. (
              Hint
              : Use an L-pad.)
              







FIGURE P3-71









3-72

              Design the interface circuit in
              Figure P3-71
              so that
              R
OUT
              = 50 Ω and the voltage delivered to the 50-Ω load is
              v
              = 2.5V. (
              Hint
              : Use an L-pad.)
            

3-73


              It is claimed that both interface circuits in
              Figure P3-73
              will deliver
              v
              = 5 V to the 75-Ω load. Verify this claim. Which interface circuit consumes the least power? Which has an output resistance that best matches the 75-Ω load?
              







FIGURE P3-73











Integrating Problems


3-74


              Attenuator Analysis
              
                In
                Figure P3-74
                , a two-port attenuator connects a 600-Ω source to a 600-Ω load. Find the power delivered to the load in terms of
                v
S
                . Remove the attenuator and find the power delivered to the load when the source is directly connected to the load. By what fraction does the attenuator reduce the power delivered to the 600-Ω load? Express the fraction in dB. Verify your results using Multisim.
              








FIGURE P3-74











3-75
              Attenuator Design
              

                Use the general procedure shown in Application
                Example 3-31
                to design a 75 Ω to 75 Ω,< - 20 dB attenuator with the following characteristics:
              






Port


Characteristics


Condition


Value


Units





Output
Thévenin voltage
75-Ω source connected at the input port

v
T
                  <
                  v
S
                  /10
                
V


Output
Thévenin resistance
75-Ω source connected at the input port
75
Ω


Output
Attenuation
75-Ω load connected at the output port



dB


Input
Input resistance
75-Ω load connected at the output port
75
Ω



Use Multisim to verify that your design meets these characteristics.


3-76

              Interface Circuit Design
              
                Using no more than three 75-Ω resistors, design the interface circuit in
                Figure P3-76
                so that
                v
                ≤ 4 V and
                i
                ≤ 50 mA regardless of the value of
                R
L
                .
              








FIGURE P3-76









3-77

              Battery Design
              
                A satellite requires a battery with an open-circuit voltage
                v
OC
                = 36 V and a Thévenin resistance
                R
T
                ≤ 10 2. The battery is to be constructed using series and parallel combinations of one of two types of cells. The first type has
                v
OC
                = 9V,
                R
T
                = 4Ω, and a weight of 30 g. The second type has
                v
OC
                = 4V,
                R
T
                = 2Ω, and a weight of 18 g. Design a minimum weight battery that meets the open-circuit voltage and Thévenin resistance requirements.
              


3-78

              Design Evaluation
              
                A requirement exists for a circuit to deliver 0 to 6 V to a 100-Ω load from a 24-V source rated at 3.0 W. Two proposed circuits are shown in
                Figure P3-78
                . Which one would you choose and why?
              








FIGURE P3-78









3-79

              Design Interface Competition
              
                The output of a transistorized power supply is modeled by the Norton equivalent circuit shown in
                Figure P3-79
                . Two teams are competing to design the interface circuit so that 25 mW ± 10% is delivered to the 1-kΩ load resistor. Their designs are shown in
                Figure P3-79
                . Which solution is better considering the use of standard values, number of parts, and power required by the source? Would your choice be different if the power had to be within ±5%?
              








FIGURE P3-79










3-80



              Analysis of Competing Interface Circuits Using MATLAB
              
Figure P3-80
                displays two generalized interface circuit designs. In both circuits, resistors
                R
1
                and
                R
2
                connect a Thévenin equivalent circuit to a load resistor. Using MATLAB, develop symbolic expressions for the load current,
                i
L
                , and the input resistance,
                R
IN
                , for each circuit in terms of the given parameters. Using these two expressions, now use the MATLAB command solve to solve for
                R
1
                and
                R
2
                in terms of
                i
L
                and
                R
IN
                . Let
                v
T
                = 15V,
                R
T
                = 100 Ω,
                R
L
                = 50 Ω,
                i
L
                = 50 mA, and
                R
IN
                = 100 Ω. Can you use both types of interface circuits to find suitable values for
                R
1
                and
                R
2
                to meet these specifications? Compare your interface design(s) with the solution to Problem 3-71.
              








FIGURE P3-80










3-81


              Minimum Power Transfer Using Multisim
              Figure P3-81
              shows a circuit with two sources, a fixed load and a resistor
              R
              . Select
              R
              for
              minimum
              power transfer to the load. Simulate in Multisim using the "Parameter sweep" under "Analyses" and do a linear sweep for
              R
              from 10 2 to 1 M2. Plot the power transferred to the load
              p
4k
              versus the variable
              R
              . Find the minimum value of
              p
4k
              vs
              R
              . Narrow your sweep to obtain an accurate value of
              R
              . Then using the value of
              R
              that you found either by hand calculation or using the DC Operating Point Analysis, explain why the minimum occurs.
              







FIGURE P3-81









3-82

              Noninverting Summer
              
                A
                noninverting summer
                interface device is shown in
                Figure P3-82
                . Of importance is that the input to the device has infinite resistance—that is, no current flows into the device. The output voltage for this configuration is two times the input voltage. Develop a relationship for the voltage
                v
L
                across
                R
L
                with respect to the two input voltages and the two input resistances.
              








FIGURE P3-82









3-83


              Two-Way Splitter
              
Figure P3-83
                shows a two-way splitter. It takes the input
                V
IN
                and splits it in half delivering it to outputs 1 and 2. The input source resistance and each of the output resistances are 75 Ω. Design the splitter so that each output sees 75 Ω and the input sees 75 Ω. Validate your design using Multisim. Also show that half of the input voltage is delivered to each output. (
                Hint:
                Assume
                V
S
                = 300 V.)
              








FIGURE P3-83













Notes




1

              The open-circuit resistance of a DMM is not infinite, but varies with the quality of the DMM from 10
              7
              to 10
              11
              Ω.
            


2

              Similarly, the short-circuit resistance of a DMM is not zero, but varies with the quality of the DMM from 10
              -1
              to 10 Ω.
            


3

              An ideal voltage source is a perfect voltage source that has zero internal resistance, hence
              R
T
              = 0. Equation (3-35) points out if
              R
T
              = 0, then this implies an infinite
              p
MAX
              . Infinite power is a physical impossibility, which reminds us that all ideal circuit models have some physical limitations. Since there are no realizable ideal sources, there will always be a finite source resistance associated with the "ideal" source.
            
















CHAPTER 4

ACTIVE CIRCUITS




Then came the morning of Tuesday, August 2, 1927, when the concept of the negative feedback amplifier came to me in a flash while I was crossing the Hudson River on the Lackawanna Ferry, on my way to work.


            Harold S. Black, 1927,
            
            American Electrical Engineer
          









Some History Behind This Chapter

              The integrated circuit operational amplifier (OP AMP) is the workhorse of present-day linear electronic circuits. However, to operate as a linear amplifier, the OP AMP must be provided with "negative feedback." The negative feedback amplifier is one of the key electronic inventions of all time. During the 1920's, Harold S. Black (1898-1983) had been working at Bell Labs for several years without much success on the problem of improving the performance of vacuum tube amplifiers in telephone systems. The feedback amplifier solution came to him suddenly on the way to work. He realized that by utilizing negative feedback, he could obtain a desired reduction in distortion at the expense of a sacrifice in amplification. He documented his invention by writing the key concepts of negative feedback on his morning copy of the
              New York Times.
              His invention paved the way for the development of worldwide communication systems and spawned completely new areas of technology, such as feedback control systems and robotics. Two other achievements were necessary before low-noise amplifiers could become practical and commonplace: the invention of the transistor by John Bardeen, Walter Brattain, and William Shockley in 1947, and the invention of the integrated circuit by Jack S. Kilby in 1958.
            












Why This Chapter Is Important Today
This is an important chapter for all engineering disciplines. You will be introduced to modern electronic devices and how they can be modeled. The utility of these devices will be apparent when you design OP AMP circuits that provide signal conditioning for analog-to-digital or digital-to-analog applications, audio systems, optical, pressure, acceleration, thermal, and physical sensors, and all types of instrumentation systems used in many of today's highly technical devices from smart phones to EV's. You will also be introduced to criteria used to evaluate alternative designs. That is, you will begin to function as an engineer making judgments about the best solution to a problem.












Chapter Sections



4-1 Linear Dependent Sources






4-2 Analysis of Circuits with Dependent Sources






4-3 The Operational Amplifier






4-4 OP AMP Circuit Analysis






4-5 OP AMP Circuit Design






4-6 OP AMP Circuit Applications















Chapter Learning Objectives

4-1
              Linear Active Circuits (
              Sects. 4-1
              and
              4-2
              )
            
Given a linear resistance circuit containing dependent sources, find selected output signals, input-output relationships, or input-output resistances.

4-2
              OP AMP Circuit Analysis (
              Sects. 4-3
              and
              4-4
              )
            
Given a linear resistance circuit containing OP AMPs, find selected output signals or input-output relationships.

4-3
              OP AMP Circuit Design (
              Sect. 4-5
              )
            
Given an input-output relationship, design resistive OP AMP circuits that implement the relationship. Evaluate the alternative designs using stated criteria.

4-4
              OP AMP Circuit Applications (
              Sect. 4-6
              )
            
Apply concepts of OP AMP analysis and design to create, analyze, or evaluate circuits that perform a specific interface, function, or task.









          4-1 Linear Dependent Sources
        

          This chapter treats the analysis and design of circuits containing active devices, such as transistors or operational amplifiers (OP AMPs). An
          active device
          is a component that requires an external power supply to operate correctly. An
          active circuit
          is one that contains one or more active devices. An important property of active circuits is that they are capable of providing signal amplification, one of the most important signal-processing functions in electrical engineering. Linear active circuits are governed by the proportionality property, so their input-output relationships are of the form
          y
          =
          Kx.
          The term
          signal amplification
          means the proportionality factor
          K
          is greater than 1 when the input
          x
          and output
          y
          have the same dimensions. A block diagram of this function is shown in
          Figure 4-1
          (a). It is the same diagram as first introduced in
          Figure 3-28
          . In that chapter, the gain was limited to be |
          K
          | ≤ 1. With active circuits, the gain is limited by the circuit's configuration and by the limitations of the actual physical devices or the external power supply. Therefore, an active circuit can deliver more signal voltage, current, and power at its output than it receives from the input signal. The passive resistance circuits studied thus far cannot amplify voltage, current, or power.
        

          Active devices operating in a linear mode are modeled using resistors and one or more of the dependent sources shown in
          Figure 4-1
          . A
          dependent source
          is a voltage or current source whose output is controlled by a voltage or current in a different part of the circuit. As a result, there are four possible types of dependent sources: a current-controlled voltage source (CCVS), a voltage-controlled voltage source (VCVS), a current-controlled current source (CCCS), and a voltage-controlled current source (VCCS). The properties of these dependent sources are very different from those of the independent sources described in
          Chapter 2
          . The output voltage (current) of an independent voltage (current) source is a specified value that does not depend on the circuit to which it is connected. To distinguish between the two types of sources, the dependent sources are represented by the diamond symbols in
          Figure 4-1
          , in contrast to the circle symbols used for independent sources.
        







FIGURE 4-1



Dependent source circuit symbols: (a) Block diagram of a gain stage. (b) Current-controlled voltage source. (c) Voltage-controlled voltage source. (d) Current-controlled current source. (e) Voltage-controlled current source.






Caution:


          In this book, we use the diamond symbol shown in
          Figure 4-1
          to represent a dependent source. However, this representation is not universal. Some other texts use circles and some use rectangles, while others use diamonds. Software simulators also are varied. Multisim and CircuitLab use diamond symbols, while OrCAD uses circle symbols.
        

          A
          linear dependent source
          is one whose output is proportional to the controlling voltage or current. The defining relationship for dependent sources in
          Figure 4-1
          are all of the form
          y
          =
          Kx,
          where
          x
          is the controlling variable,
          y
          is the source output variable, and
          K
          is the proportionality factor. Each type of dependent source is characterized by a proportionality factor, either μ, β,
          r
          , or
          g.
          These parameters are often called simply the
          gain
          of the controlled source. Strictly speaking, the parameters μ and β are dimensionless quantities called the
          voltage gain
          and
          current gain,
          respectively. The parameter
          r
          has the dimensions of ohms and is called the
          transresistance,
          a contraction of transfer resistance. The parameter
          g
          is called
          transconductance,
          a contraction of transfer conductance, and has the dimensions of siemens.
        
Although dependent sources are elements used in circuit analysis, they are conceptually different from the other circuit elements we have studied. The linear resistor and ideal switch are models of actual devices called resistors and switches. However, you will not find dependent sources listed in electronic part catalogs. For this reason, dependent sources are more abstract, since they are not models of identifiable physical devices. Dependent sources are used in combination with other circuit elements to create models of active devices.


          In
          Chapter 3
          , we found that a voltage source acts as a short circuit when it is turned off. Likewise, a current source behaves as an open circuit when it is turned off. The same results apply to dependent sources, with one important difference. Dependent sources cannot be turned on and off individually because they depend on excitation supplied by independent sources.
        

          Some consequences of this dependency are illustrated in
          Figure 4-2
          . When the independent current source is turned ON in a CCVS, KCL requires that
          i
1
          =
          i
S
          ≠ 0 as shown in
          Figure 4-2
          (a). Through controlled source action, the current controlled voltage source is ON and its output is
          υ
O
          =
          ri
1
          =
          ri
S
          . When the independent current source is OFF, it acts as an open circuit and KCL requires that
          i
1
          =
          i
S
          = 0. This causes the dependent source to be OFF and its output is
          υ
O
          =
          ri
1
          = 0. When the independent current source is OFF, the dependent voltage source acts as a short circuit.
        

          When the independent voltage source is turned ON in a VCCS, KVL requires that
          υ
1
          =
          υ
S
          ≠ 0 as shown in
          Figure 4-2
          (b). Through controlled source action, the voltage controlled current source is ON and its output is
          i
O
          =
          gυ
1
          =
          gυ
S
          . When the independent voltage source is OFF, it acts as a short circuit and KVL requires that
          υ
1
          = 0. The dependent source is now OFF and its output is
          i
O
          =
          gυ
1
          = 0. When the independent voltage source is OFF, the dependent current source acts as an open circuit. We can show that a CCCS and a VCVS would behave similarly.
        

          In other words, turning the independent source on and off turns the dependent source on and off as well. We must be careful when applying the superposition principle and Thévenin's theorem to active circuits, since the state of a dependent source depends on the excitation supplied by independent sources. To account for this possibility, we modify the superposition principle to state that the response due to all
          independent
          sources acting simultaneously is equal to the sum of the responses due to each
          independent
          source acting one at a time.
        







FIGURE 4-2



Turning off the independent source affects the dependent source.





4-2 Analysis of Circuits with Dependent Sources
With certain modifications, the analysis tools developed for passive circuits apply to active circuits as well. Circuit reduction applies to active circuits, but in so doing we must not eliminate the control variable for a dependent source. As noted previously, when applying the superposition principle or Thévenin's theorem, we must remember that dependent sources cannot be turned on and off independently since their states depend on excitation supplied by one or more independent sources. Applying a source transformation to a dependent source is sometimes helpful, but again we must not lose the identity of a controlling signal for a dependent source. Methods like node and mesh analysis can be adapted, as we will see, to include dependent sources as well.

          However, the main difference is that the properties of active circuits can be significantly different from those of the passive circuits treated in
          Chapters 2
          and
          3
          . Our analysis examples are chosen to highlight these differences.
        

          Consider the circuit of
          Figure 4-3
          (a). In this dependent-source circuit, the dependent source, a VCVS, is shown highlighted in the center box. To the left, usually, there is a
          source circuit
          that provides the input to the dependent source. To the right is the
          load circuit
          that receives the result of the dependent source. Let us analyze this circuit and find the voltage gain
          K
          =
          υ
O
          /
          υ
S
          .
        







FIGURE 4-3



(a) A circuit with a dependent source. (b) Equivalent block diagram.





          We recognize the load circuit as a voltage divider. That is,
        




          Note that the dependent source's output is negative, with the plus sign on the bottom and the negative sign on the top. This was done intentionally to point out that in many active devices there is a sign inversion that is modeled by inverting the sign of the dependent source. To continue our analysis, we need to find a relationship between the dependent source's control variable
          υ
x
          and the input
          υ
S
          . A KVL around the input loop is
        




          Now, since the circuit is an open at
          υ

x

          ,
          i
S
          = 0. This makes
          υ

x

          =
          υ
S
          and therefore,
        



And finally,




          This is shown as a block diagram in
          Figure 4-3
          (b). Let us look at what happens when we give values to the various parameters. Let all of the resistors equal 1 kΩ and μ =10
          5
          .
          K
          in this example would be -50,000. If in our example we let
          υ
S
          = 100 μV, our output
          υ
O
          would be −5 V. The circuit has amplified the input by 50,000 times! What makes this even more remarkable is that due to the open circuit
          i
S
          , the source current, is zero. The source is not providing any power to the circuit. Nor is there any current
          i
x
          flowing between the input and output circuits. Yet, it should be clear that there is power provided to the load. This example serves to point out that there is something else at play. The dependent source does not rely on the input for its output power. Yes, the input provides the signal that will be amplified or attenuated by the dependent source, but the output power is obtained from a secondary source driving the dependent source that makes all this possible.
          
1









FIGURE 4-4


















EXAMPLE 4-1



                  Determine the current, voltage, and power delivered to the 500-Ω output load in
                  Figure 4-4
                  Then find the power gain defined as
                  p
o
                  /
                  p
S
                  .
                







SOLUTION:



              The control current
              i
x
              is found using current division in the input circuit as:
            



(4-1)






              Similarly, the output current
              i
O
              is found using current division in the output circuit as:
            



(4-2)





              At node A, KCL requires that
              i
y
              = −48
              i
x
              . Combining this result with
              Eqs. (4-1)
              and
              (4-2)
              yields the output current
            



(4-3)





              The output voltage
              υ
O
              is found using Ohm's law as follows:
            



(4-4)





              The input-output relationships in
              Eqs. (4-3)
              and
              (4-4)
              are of the form
              y
              =
              Kx
              with
              K
              < 0. The proportionality constants are negative because the reference direction for
              i
O
              in
              Figure 4-4
              is the opposite of the orientation of the dependent source reference arrow. As noted earlier and worth repeating, active circuits often produce negative values of
              K,
              which means that the input and output signals have opposite algebraic signs. Circuits for which
              K
              < 0 are said to provide
              signal inversion.
              In the analysis and design of active circuits, it is important to keep track of signal inversions.
            

              Using
              Eqs. (4-3)
              and
              (4-4)
              , the power delivered to the 500-Ω load in
              Figure 4-4
              is given by
            


(4-5)



The independent source at the input delivers its power to the parallel combination of 50 Ω and 25 Ω. Hence, the input power supplied by the independent source is given by



Given the input power and output power, we find the power gain in the circuit as:




              A power gain greater than unity means that the circuit delivers more power at its output than it receives from the input source. At first glance this appears to be a violation of energy conservation, until we remember that dependent sources are models of active devices that require an external power supply to operate.
              ■













FIGURE 4-5













Exercise 4-1



              Find the output
              υ
O
              in terms of the input
              υ
S
              in the circuit in
              Figure 4-5
              . Then if
              R
S 
              = 
              R
P  
              = 100 Ω,   
              R
C   
              =   
              R
L 
              = 1 kΩ, and 
              r 
              = 1 kΩ, find the gain   
              K 
              =   
              υ

o
    
              /  
              υ

s
    
              for the circuit. 
            
Answers:









Node-Voltage Analysis with Dependent Sources
Node analysis of active circuits is much the same as for passive circuits except that we must account for the additional constraints caused by the dependent sources.

            For example, let us look at using node analysis to continue our study of the circuit first discussed in
            Figure 4-3
            . As shown in
            Figure 4-6(a)
            , we have inserted a resistor
            
R
F
            between the source circuit and the load circuit. This simple insertion is an example of the major reason for the great value of active circuits. Let us analyze this circuit to find
            K
            =
            υ
O
            /
            υ
S
            and see why.
          







FIGURE 4-6



(a) Circuit used to demonstrate effects of feedback.



There are five nodes in this circuit. We have selected a ground and labeled the remaining four nodes. We notice that all four nodes can be related to other parameters in the circuit as follows:



Since nodes A and c are connected to sources, there are only two unknown nodes, B and D. At node B, we can write the following node equation:



At node D we write as



Solving for x in the node B equation, we get




            Solving the node D equation for
            υ
O
            , we get
          




            Substituting our results for
            υ

x

            and solving for
            υ
O
            , we get
          




            And
            K
            equals
          




            This gain can be represented by the block diagram shown in
            Figure 4-6(b)
            .
          







FIGURE 4-6







            This equation looks a bit intimidating at first, but with some analysis it makes a lot of sense. If we let
            R
F
            become an open circuit, that is,
            R
F
            is infinite, the circuit is the same as our circuit in
            Figure 4-3
            , our gain
            K
            =
            υ
O
            /
            υ
S
            becomes
          





            which is exactly the same response we found earlier. This value of
            K
            is the maximum gain possible with this circuit. What is important to realize is that by selecting
            R
F
            , you now have control of the gain (
            K
            ) of the circuit from 0 to the maximum value of
            K
            above. For example, if we set all the resistors to 100 Ω and μ to 10
            5
            —a reasonable gain for an OP AMP—we can generate the graph shown in
            Figure 4-6(c)

2

            . By choosing
            R
F
            , we can obtain whatever gain we wish up to 50,000. Two gains are shown: -200 by choosing
            R
F
            = 163 kΩ and -20,000 by selecting
            R
F
            = 6.7MΩ.
          







FIGURE 4-6







            The key element
            R
F
            is called the
            feedback
            resistor. Feedback is the reason for the success of many analog circuit designs. It is important to realize that feedback often causes the current
            i
x
            to not be zero. With feedback the output circuit directs, or "feeds," back some of its voltage or current to the input circuit and helps the circuit designer achieve the output desired. We will study many more examples of feedback later in this and subsequent chapters.
          






Exercise 4-2


                Use the graph in
                Figure 4-6(c)
                to select a value of
                R
F
                so that the gain is -5000, -25,000, and - 40000.
              


Answer:



R
F
                = 1 MΩ,10 MΩ, and 40 MΩ, respectively.
              













Exercise 4-3


                With all other resistors set to 1 kΩ and
                μ
                = 10
                5
                , select an appropriate value for
                R
F
                in
                Figure 4-6(a)
                so that the gain |
                K
                | can never be larger than 10,000, or smaller than 50.
              


Answer:



                Use a 100.1-kΩ fixed resistor in series with a 24-MΩ variable resistor for
                R
F
                .
                



















EXAMPLE 4-2


                    For the summer circuit of
                    Figure 4-7
                    , use node-voltage analysis to find expressions for the unknown node voltages. Write your results as a matrix in
                    Ax
                    =
                    b
                    form.
                  












FIGURE 4-7








SOLUTION:



                The circuit in
                Figure 4-7
                has five nodes. Selecting node E as the reference, each independent voltage source has one terminal connected to ground.
              

                These connections force the conditions
                υ
A
                =
                υ
S1
                and
                υ
B
                =
                υ
S2
                . Therefore, we only need to write node equations at nodes C and D because voltages at nodes A and B are already known.
              

                Node analysis involves expressing element currents in terms of the node voltages and applying KcL at each unknown node. The sum of the currents
                leaving
                node C is
              



Similarly, the sum of currents leaving node D is



These two node equations can be rearranged into the following form:



(4-6)





                Note that we could write these two symmetrical node equations by inspection if the dependent current source β
                i
B
                had been an independent source. But it is not independent, so we must express its constraint in terms of the unknown node voltages. Applying the fundamental property of node voltages and Ohm's law, the current
                i
B
                can be written in terms of the node voltages as follows:
              




                Substituting this expression for
                i
B
                into
                Eqs. (4-6)
                and putting the results in standard form yields
              



(4-7)




And in matrix form




                The result in
                Eqs. (4-7)
                involves two equations in two unknowns—the node voltages—and includes the effect of the dependent source. However, notice that
                
                the matrix is
                not
                symmetrical. The dependent source constraint destroys the coefficient symmetry. The resultant equations can be readily solved using simple substitution or MATLAB.
              

                This example illustrates a general approach to writing node-voltage equations for circuits with dependent sources. We start out treating the dependent sources as if they are independent sources and write node equations for the resulting passive circuit using the inspection method developed in
                Chapter 3
                . This step produces a set of symmetrical node-voltage equations with the independent and dependent source terms on the right-hand side. Then, we express the dependent source terms in terms of the unknown node voltages and move them to the left-hand side of the equations with the other terms involving the unknown node voltages. This step destroys the coefficient symmetry but leads to a set of node-voltage equations that describe the active circuit.
                ■













Exercise 4-4


                For the circuit in
                Figure 4-7
                , use the node-voltage equations in
                Eqs. (4-7)
                to find the output voltage
                υ
O
                when
                R
1
                = 1 kΩ,
                R
2
                = 3 kΩ,
                R
B
                = 100 kΩ,
                R
P
                = 1.3kΩ,
                R
E
                = 3.3kΩ, and β = 50.
              


Answers:





This circuit is a signal summer that does not involve a signal inversion. The fact that the output is a linear combination of the two inputs reminds us that the circuit is linear.

















EXAMPLE 4-3


                    For the circuit in
                    Figure 4-8
                    find the voltage gain
                    K
v
                    =
                    υ
O
                    /
                    υ
S
                    , and the current gain
                    K
i
                    =
                    i
O
                    /
                    i
S
                    using node-voltage analysis.
                  












FIGURE 4-8








SOLUTION:



                There are three nodes in this circuit. If we select the bottom node as our reference, the remaining two nodes are defined by the voltage sources. That is,
                υ
A
                =
                υ
S
                and
                υ
B
                = -μ
                υ
x
                .
              

                By node analysis, the voltage
                υ
x
                is
              




                Solving for
                υ
x
                yields
              



The output voltage is directly across the dependent source, hence,




                Substituting our expression for
                υ
x
                , we get
              



The voltage gain is given by



This result tells us that for positive values of μ greater than one, the voltage gain is always more than one regardless of μ.


                To find the current gain, we note that by Ohm's law
              



And




                Substituting for
                υ
x
                , we get
              



And



The current gain is given by




                The magnitude of the current gain could, in theory, range from 0 to ∞, depending on μ,
                R
F
                , and
                R
L
                . Of course, practical considerations will limit the current, and hence, the gain.
                ■













Exercise 4-5



                  (a) Formulate node-voltage equations for the circuit in
                  Figure 4-9
                  .
                

                  (b) Solve the node-voltage equations for
                  υ
O
                  and
                  i
O
                  in terms of
                  i
S
                  .
                

Answers:


                  (a)
                  


                  (b)
                  














FIGURE 4-9



















EXAMPLE 4-4



                    Determine the output voltage of the circuit shown in
                    Figure 4-10
                    (a) using Multisim.
                  







SOLUTION:



Figure 4-10
                (b) shows the symbols used in Multisim to represent the four dependent sources. These elements are found in the "Components" and then "Source" library as shown in
                Figure 4-10
                (b) under either "Controlled Voltage Sources" or
                
                "Controlled Current Sources." The input ports shown as rectangles are either open circuits for the voltage-controlled elements or short circuits for the current-controlled devices. The output ports are voltage sources or current sources depending on the controlled variable. Note that the controlled sources in Multisim are indicated by diamonds as we use in the text. All four dependent sources are characterized by a single parameter located next to the dependent source. The gain is set by simply clicking on the value and entering the desired gain for μ, β,
                g
                , or
                r
                depending on the type of dependent source. The dimensions of the gain depend on the dimensions of the signals at the input and output ports. As we will see in subsequent examples, these elements are combined with circuit elements to model active devices such as transistors and OP AMPs.
              







FIGURE 4-10







                For the problem at hand, we used the VCVS-dependent model and set the gain at 100. The resulting circuit is shown in
                Figure 4-10
                (c) with the desired output response displayed on the voltmeter as
                υ
O
                = 4V.
                ■














Exercise 4-6


                Find
                i
O
                using Multisim for the circuit of
                Figure 4-11(a)
                .
                








FIGURE 4-11













FIGURE 4-11








Answer:



i
O
                = -9 A. See
                Figure 4-11(b)
                .
              



















EXAMPLE 4-5


                    The circuit in
                    Figure 4-12(a)
                    is a model of an inverting OP AMP circuit that we will study starting in
                    Section 4-3
                    .
                  


                      (a) Use node-voltage analysis to find the output
                      υ
O
                      in terms of the input
                      υ
S
                      .
                    
(b) Evaluate the input-output relationship found in part (a) as the gain μ becomes very large.

                      (c) Assume
                      R
1
                      =
                      R
2
                      = 100 Ω, μ = 1000, and
                      R
4
                      = 1 kΩ. Use Multisim to show the effect of the feedback resistor
                      R
3
                      by plotting the output gain
                      K
                      =
                      υ
O
                      /
                      υ
S
                      for
                      R
3
                      varying from 10 Ω to 100 MΩ.
                    













FIGURE 4-12








SOLUTION:





                    (a) Applying a source transformation to the independent source leads to the modified three-node circuit shown in
                    Figure 4-12(b)
                    . With the indicated
                    
                    reference node, the dependent voltage source constrains the voltage at node B. The control voltage is
                    υ
x
                    =
                    υ
A
                    , and the controlled source forces the node B voltage to be
                  



Thus, node A is the only independent node in the circuit. We can write the node A equation by inspection as



Substituting in the control source constraint yields the standard form for this equation:




                    We end up with only one node equation even though at first glance the given circuit appeared to need three node equations. The reason is that there are two voltage sources in the original circuit in
                    Figure 4-12(a)
                    . Since the two sources share the reference node, the number of unknown node voltages is reduced from three to one. The general principle illustrated is that the number of independent KCL constraints in a circuit containing
                    N
                    nodes and
                    N
V
                    voltage sources (dependent or independent) is
                    N
                    - 1 -
                    N
V
                    . The one-node equation can easily be solved for the output voltage
                    υ
O
                    =
                    υ
B
                    as follows:
                  




                    The minus signs means the circuit provides signal inversion, which is caused by the reference polarity of the controlled source. The output voltage does not depend on the load resistor
                    R
4
                    , since the load is connected across an ideal (though dependent) voltage source.
                  



                    (b) For large values of μ, we have
                    
                    and the input-output relationship reduces to
                  




                    That is, when the active device gain is large, for example, in OP AMP circuits, μ can range from 10
                    3
                    to 10
                    7
                    , the voltage gain of the active circuit depends on the ratio of two resistances. We will encounter this situation again with OP AMP circuits, specifically, the inverting OP AMP.
                  



                    (c)
                    Figure 4-12(c)
                    shows the original circuit drawn in Multisim and the results of our analyses. The analysis was done using the "Parameter Sweep" found under "Analyses." Using the "Decade" sweep variation, we swept resistor
                    R
3
                    from 10 Ω
                    
                    to 100 MΩ using 100 points per decade. Once the sweep was completed, we accessed the "Trace" properties and adjusted the axes to suit including choosing the logarithmic option for the bottom feedback resistor axis. We used the cursor to find the value of
                    R
3
                    that resulted in a gain of - 200. We found that
                    R
3
                    = 33.37 kΩ, so that a standard 33-kΩ resistor would work. What value of
                    R
3
                    would you need for a gain of - 400? (200.21 kΩ, you can use a 200-kΩ standard value resistor.)
                    ■















FIGURE 4-12












Exercise 4-7



                  (a) Find an expression for
                  i
O
                  and
                  υ
O
                  in terms of
                  R
F
                  ,
                  R
O
                  ,
                  υ
S
                  , and μ for the dependent source circuit in
                  Figure 4-13(a)
                  .
                

                  (b) Use Multisim to plot the output voltage
                  υ
O
                  versus
                  R
F
                  if
                  R
O
                  = 1kΩ,
                  υ
S
                  = 10V, and μ = 1000.
                



Answer:




                  (a)
                  


                  (b) See
                  Figure 4-13(b)
                  .
                













FIGURE 4-13













FIGURE 4-13










            Mesh-Current Analysis with Dependent Sources
          

            Mesh-current analysis of active circuits follows the same pattern noted for node-voltage analysis. We initially treat the dependent sources as independent sources and write the mesh equations of the resulting passive circuit using the inspection method from
            Chapter 3
            . We then account for the dependent sources by expressing their constraints in terms of unknown mesh currents. The following example illustrates the method.
          












EXAMPLE 4-6




                      (a) Formulate mesh-current equations for the circuit in
                      Figure 4-14
                      .
                    

                      (b) Use the mesh equations to find
                      υ
O
                      and
                      R
IN
                      when
                      R
1
                      = 50 Ω,
                      R
2
                      = 1 kΩ,
                      R
3
                      = 100 Ω,
                      R
4
                      = 5kΩ, and
                      g
                      = 100 mS.
                    













FIGURE 4-14









SOLUTION:





                    (a) Applying source transformation to the parallel combination of
                    R
3
                    and
                    gυ
x
                    in
                    Figure 4-14
                    (a) produces the dependent voltage source
                    R
3
gυ
x
                    = μ
                    υ
x
                    in
                    Figure 4-14
                    (b).
                  

                    In the modified circuit, we have identified two mesh currents. Initially treating the dependent source (
                    gR
3
                    )
                    υ
x
                    as an independent source leads to two symmetrical mesh equations.
                  




                    The control voltage
                    υ
x
                    can be written in terms of mesh currents as
                  




                    Substituting this equation for
                    υ
x
                    into the mesh equations and putting the equations in standard form yields
                  



The resulting mesh equations are not symmetrical because of the controlled source.


(b) Substituting the numerical values into the mesh equations gives



Solving for the two mesh currents using Cramer's rule yields



The output voltage and input resistance are found using ohm's law as follows:


■
















Exercise 4-8


                Write a set of node-voltage equations and use them to find
                υ
O
                and
                R
IN
                for the circuit in
                Figure 4-14
                (a). Use the parameter values given in
                Example 4-6
                and node
                υ
A
                .
              
Answers:

                We can write the node-voltage equations and the relationship of
                υ
x
                and the node voltages as follows:
              




                Solving these equations, we get
                υ
O
                =0.904
                υ
S
                and
                R
IN
                = 10.95 kΩ.
              


















EXAMPLE 4-7


                    The circuit in
                    Figure 4-15
                    inside the shaded square is a model of a bipolar junction transistor (BJT) operating in the active mode. Use mesh analysis to find the transistor base current
                    i
B
                    .
                  












FIGURE 4-15








SOLUTION:



                The two mesh currents in
                Figure 4-15
                are labeled
                i
1
                and
                i
2
                to avoid possible confusion with the transistor base current
                i
B
                . As drawn, the circuit requires a supermesh since the dependent current source β
                i
B
                is included in both meshes and is not connected in parallel with a resistor. A supermesh is created by combining meshes 1 and 2 after excluding the series subcircuit consisting of β
                i
B
                and
                R
C
                . Beginning at the bottom of the circuit, we write a KVL mesh equation around the super-mesh using unknowns
                i
1
                and
                i
2
                :
              




                This KVL equation provides one equation in the two unknown mesh currents. Since the two mesh currents have opposite directions through the dependent current source β
                i
B
                , the currents
                i
1
                ,
                i
2
                , and β
                i
B
                are related by KcL as
              




                This constraint supplies the additional relationship needed to obtain two equations in the two unknown mesh-current variables. Since
                i
B
                = -
                i
1
                , the preceding KCL constraint means that
                i
2
                = (β + 1)
                i
1
                . Substituting
                i
2
                = (β + 1)
                i
1
                into the supermesh KVL equation and solving for
                i
B
                yields
              


■













Exercise 4-9


                Use mesh analysis to find the current
                i
O
                in
                Figure 4-16(a)
                when the element
                E
                is a dependent current source 2
                i
x
                with the reference arrow directed down. Validate your answer using Multisim.
                








FIGURE 4-16













FIGURE 4-16








Answer:



                - 857 μA; See
                Figure 4-16(b)
                .
              













Exercise 4-10


                Use mesh analysis to find the current
                i
o
                in
                Figure 4-16(a)
                when the element
                E
                is a dependent voltage source 2000
                i
x
                with the plus reference at the top.
              


Answer:


-0222mA



















                    APPLICATION
                    EXAMPLE 4-8


                    The circuit in
                    Figure 4-17(a)
                    represents a small-signal model of a field-effect transistor (FET) amplifier with two inputs,
                    υ
S1
                    and
                    υ
S2
                    . Use Multisim to solve for the input-output relationship of the circuit. (
                    Hint:
                    Use superposition to find the respective gains due to the two sources, for example,
                    υ
S1
                    = 1 V and
                    υ
S2
                    = 0 V, and vice versa.)
                  












FIGURE 4-17













FIGURE 4-17









SOLUTION:


Since the circuit is linear, the input-output relationship is of the form




                Using the superposition principle as suggested, let us find the gain
                K
1
                by setting
                υ
S1
                = 1 V and
                υ
S2
                = 0 V and solving for
                υ
O
                (node 4). The gain
                K
2
                is then found by setting
                υ
S1
                = 0 V and
                υ
S2
                = 1 V and again solving for
                υ
O
                .
                Figure 4-17(b)
                shows a Multisim circuit diagram for both cases and the resulting outputs on the multimeters. From these simulations, you can determine that
                K
1
                = 10 and
                K
2
                = -10.
              
The input-output relationship for the circuit is found as




                The circuit provides to the output the difference of the signals applied to the two inputs. It also can provide gain,
                K
                = 10, in this example. It is a model of a
                differential
                amplifier of a type often used as the input stage of an OP AMP, and the gain provided must be identical to both inputs. The next exercise looks at what happens if the gains are even slightly different. We study about differential amplifiers later in this chapter.
                ■














Exercise 4-11


                It is very important in designing differential amplifiers that the two transistors be matched in every way so that the outputs are balanced. Use Multisim to determine the relationship in the circuit of
                Figure 4-17(a)
                if the transconductance of FET G2 is 2.9 mS rather than 3 mS.
                








FIGURE 4-17








Answer:



υ
O
                = 9.832
                υ
S1
                - 9.829
                υ
S2
                . Equal inputs will not receive equal gains. See
                Figure 4-17(c)
                .
              







Thévenin Equivalent Circuits with Dependent Sources

            To find the Thévenin equivalent of an active circuit, we must leave the independent sources on or else supply excitation from an external test source. This means that the Thévenin resistance cannot be found by the lookback method because that method requires that all independent sources be turned off. Turning off the independent sources deactivates the dependent sources as well and can result in a profound change in the input and output characteristics of an active circuit. Thus, there are two ways of finding active circuit Thévenin equivalents. We can either find the open-circuit voltage and short-circuit current at the interface or directly solve for the interface
            i
            -
            υ
            relationship.
          











EXAMPLE 4-9


                    Find the input resistance of the circuit in
                    Figure 4-18
                    .
                  












FIGURE 4-18








SOLUTION:



                With the independent source turned off (
                i
IN
                =
                i
S
                = 0), the resistance seen at the input port is
                R
E
                since the dependent current source β
                i
IN
                is inactive and acts like an open circuit. Applying KCL at node A with the input source turned on yields
              





                By Ohm's law, the input voltage is
              



Hence, the active input resistance is




                The circuit in
                Figure 4-18
                is a model of a transistor circuit in which the gain parameter β typically lies between 50 and 250. The input resistance with external excitation is (β + 1)
                R
E
                , which is significantly higher from the value of
                R
E
                without external excitation. A higher
                R
IN
                helps the transistor reduce the effects of loading on the input source.
                ■













Exercise 4-12


                In the circuit of
                Figure 4-18
                , replace the input current source with a practical voltage source
                υ
S
                with the positive terminal up and a source resistor
                R
S
                . Find the voltage gain
                υ
S
                /
                υ
O
                if
                R
S
                = 50 Ω,
                R
E
                = 560 Ω,
                R
L
                = 1kΩ, and β = 100.
              


Answer:























EXAMPLE 4-10


                    Find the Thévenin equivalent at the output interface of the circuit in
                    Figure 4-19
                    .
                  












FIGURE 4-19








SOLUTION:



                In this circuit, the controlled voltage
                υ
x
                appears across an open circuit between nodes A and B. By the fundamental property of node voltages,
                υ
x
                =
                υ
S
                -
                υ
O
                . With the load disconnected and the input source turned off (
                υ
x
                = 0), the dependent voltage source μ
                υ
x
                acts like a short circuit, and the Thévenin resistance looking back into the output port is
                R
O
                . With the load connected and the input source turned on, the sum of currents leaving node B is
              




                Using the relationship
                υ
x
                =
                υ
S
                -
                υ
O
                to eliminate
                υ
x
                and then solving for
                υ
O
                produces the
                i-υ
                characteristic at the output interface as
              




                The
                i-υ
                relationship of a Thévenin circuit is
                υ
                =
                υ
T
                -
                iR
T
                . By direct comparison, we find the Thévenin parameters of the active circuit to be
              




                The circuit in
                Figure 4-19
                is a model of an OP AMP circuit called a voltage follower. The resistance
                R
O
                for a general-purpose OP AMP is around 100 Ω, while the gain μ is about 10
                5
                . Thus, the active Thévenin resistance of the voltage follower is not 100 Ω, as the lookback method suggests, but is only a milliohm. A low output resistance reduces the loading effect caused by connecting a load to the output.
                ■














Exercise 4-13


                Find the input resistance and output Thévenin equivalent of the circuit in
                Figure 4-20
                .
              
Answers:















FIGURE 4-20















FIGURE 4-21



(a) Circuitsymbol for the BJT. (b) TIP 31C Power transistor. (c) 2N3055 High-voltage power transistor. (d) 2N3904 Small-signal transistor. (e) 2N2222 Switching transistor.















                      APPLICATION
                      EXAMPLE 4-11


We have defined four linear dependent sources and shown how to analyze circuits containing these active elements. In this and the next section, we show how dependent sources are used to model semiconductor devices like transistors and OP AMPs. The transistor model used here describes the voltages and currents at its external terminals. The model does not describe the transistor's physical structure or internal charge flow. Those subjects are left to subsequent courses in semiconductor materials and devices.

                    The two basic transistor types are the
                    bipolar junction transistor
                    (BJT) and the
                    field effect transistor
                    (FET). Both types have several possible operating modes, each with a different set of i-u characteristics. This is something new in our study. Up to this point the characteristics of circuit elements have been fixed. With the transistor we encounter a device whose
                    i-υ
                    characteristics can change. We concentrate on the BJT because its
                    i-υ
                    characteristics are much easier to understand than the FET. Because it is easier to understand, the simpler BJT best serves as a prelude to our study of the OP AMP—an important semiconductor device that also has several possible operating modes.
                  

                    The circuit symbol of the BJT is shown in
                    Figure 4-21
                    (a). The device has three terminals called the
                    emitter (E),
                    the
                    base (B),
                    and the
                    collector (C).
                    The voltages BE and CE are called the
                    base-emitter
                    and c
                    ollector-emitter
                    voltages, respectively. The three currents
                    i
E
                    ,
                    i
B
                    , and
                    i
C
                    are called the emitter, base, and collector currents. Photos of real devices are shown in
                    Figures 4-21
                    (b) through
                    4-21
                    (e).
                  
Applying KCL to the BJT as a whole yields




                    which means that only two of the three currents can be independently specified. We normally work with
                    i
B
                    and
                    i
C
                    , and use KCL to find
                    i
E
                    when it is needed.
                  

                    The BJT's large-signal model is defined in terms of input signals
                    i
B
                    and
                    υ
BE
                    , and output signals
                    i
C
                    and
                    υ
CE
                    . For the BJT symbol shown in
                    Figure 4-21
                    (a), the model applies to a region in which these signals are never negative. Within this region there are three possible operating modes. The
                    active mode
                    is the dominant feature of a BJT. In this mode the collector current
                    i
C
                    is controlled by the base current
                    i
B
                    and
                    υ
BE
                    is constant.
                  



(4-8)





                    The proportionality factor β is called the
                    forward current gain
                    and typically ranges from about 50 to several hundreds. The constant
                    V
γ
                    is called the
                    threshold voltage,
                    which is normally less than a volt.
                    Figure 4-22
                    (a) shows the circuit elements that model the active mode
                    i-υ
                    characteristics as defined in
                    Eq. (4-8)
                    . In the active mode,
                    i
B
                    and
                    υ
CE
                    are determined by the interaction of these
                    i-υ
                    characteristics with the rest of the circuit.
                    


                    Two additional operating modes exist at the boundary of the BJT's operating region. When
                    i
B
                    = 0 and
                    i
C
                    = 0, the transistor is in the
                    cutoff mode
                    and the device acts like an open circuit between the collector and emitter. When
                    υ
CE
                    = 0 and
                    υ
BE
                    =
                    V
γ
                    , the transistor is in the
                    saturation mode,
                    and the device acts like a short circuit between the collector and emitter. These two modes are summarized as follows:
                  



(4-9)





Figure 4-22
                    (b) and (c) show the circuit elements that model the
                    i-υ
                    characteristics defined in
                    Eq. (4-9)
                    .
                  

                    The circuit in
                    Figure 4-22
                    (b) points out that in the cutoff mode,
                    υ
CE
                    must equal the open-circuit voltage available from the external circuit. The circuit in
                    Figure 4-22
                    (c) points out that in the saturation mode,
                    i
C
                    must equal the short-circuit current available from the external circuit. The net result is that the BJT's output variables must fall within the following bounds:
                  



(4-10)





                    where
                    υ
OC
                    and
                    i
SC
                    are the open-circuit voltage and short-circuit current available between the collector and emitter terminals. In the cutoff mode, the transistor outputs
                    i
C
                    and
                    υ
CE
                    are equal to their respective cutoff bounds. In saturation mode, the outputs equal their saturation bounds. In the active mode, the outputs fall between the cutoff and saturation bounds.
                  

                    With this background we are prepared to analyze the transistor circuit in
                    Figure 4-23
                    .
                    
3

                    The objective of our analysis is to find the outputs
                    i
C
                    and
                    υ
CE
                    . To do this we must know the transistor's operating mode. To find the operating mode we make use of the following two facts:
                  



1.
                        The lower bounds in
                        Eq. (4-10)
                        mean that
                        i
C
                        and
                        υ
CE
                        cannot be negative.
                      



2.
                        The upper bounds in
                        Eq. (4-10)
                        depend on the rest of the circuit.
                      



                    For the circuit in
                    Figure 4-23
                    , these upper bounds are
                    υ
OC
                    =
                    V
CC
                    and
                    i
SC
                    =
                    V
CC
                    /
                    R
C
                    .
                  

                    Our analysis strategy
                    assumes
                    the device is in the active mode and uses the active mode device equations to find
                    i
C
                    . According to
                    Eq. (4-8)
                    the active mode element equations are
                    υ
BE
                    =
                    V
γ
                    and
                    i
C
                    = β
                    i
B
                    . Using these element constraints and applying KVL around the input loop in
                    Figure 4-23
                    yields the collector current as
                  



(4-11)





                    This equation indicates that if
                    υ
S
                    >
                    V
γ
                    then,
                    i
C
                    > 0. However, if
                    υ
S
                    <
                    V
γ
                    , then
                    i
C
                    < 0, which would violate its cutoff bound. Thus, if the input voltage
                    υ
S
                    is greater than the threshold voltage
                    V
γ
                    , then the BJT can be in the active mode. But if
                    υ
S
                    <
                    V
γ
                    , the BJT is in the cutoff mode and the outputs equal their cutoff bounds in
                    Eq. (4-10)
                    , namely
                    i
C
                    = 0 and
                    υ
CE
                    =
                    υ
OC
                    =
                    V
CC
                    .
                  







FIGURE 4-22



Circuit models for BJT operating modes: (a) Active mode. (b) Cutoff mode. (c) Saturation mode.










FIGURE 4-23



BJT common-emitter circuit.





                    When
                    υ
S
                    >
                    V
γ
                    ,
                    Eq. (4-11)
                    predicts a positive collector current that increases linearly with
                    υ
S
                    . To find the collector-emitter voltage, we apply KVL around the output loop in
                    Figure 4-23
                    to obtain
                  



(4-12)





                    This equation predicts that
                    υ
CE
                    > 0 as long as
                    i
C
                    <
                    V
CC
                    /
                    R
C
                    . But
                    V
CC
                    /
                    R
C
                    is the short-circuit current available from the external circuit. Thus, as long as
                    υ
S
                    >
                    V
γ
                    and
                    i
C
                    <
                    i
SC
                    , the BJT is in the active mode and
                    Eqs. (4-11)
                    and
                    (4-12)
                    correctly predict the outputs
                    i
C
                    and
                    υ
CE
                    . However, if
                    Eq. (4-11)
                    predicts that
                    i
C
                    >
                    i
SC
                    , then
                    Eq. (4-12)
                    says that
                    υ
CE
                    < 0. Both of these results violate the saturation bounds in
                    Eq. (4-10)
                    . When this happens, the BJT is actually in the saturation mode and the outputs equal their saturation bounds in
                    Eq. (4-10)
                    , namely
                    i
C
                    =
                    i
SC
                    =
                    V
CC
                    /
                    R
C
                    and
                    υ
CE
                    = 0.
                  

Figure 4-24
                    summarizes this discussion using graphs of the outputs
                    υ
CE
                    and
                    i
C
                    versus the input voltage
                    υ
S
                    . When
                    υ
S
                    <
                    V
γ
                    , the BJT is in the cutoff mode and the outputs are
                    i
C
                    = 0 and
                    υ
CE
                    =
                    υ
OC
                    =
                    V
CC
                    . When
                    υ
S
                    >
                    V
γ
                    , the BJT enters the active mode and the outputs
                    i
C
                    and
                    υ
CE
                    are governed by
                    Eqs. (4-11)
                    and
                    (4-12)
                    . Under these equations,
                    i
C
                    increases linearly as
                    υ
S
                    increases, with the result that
                    υ
CE
                    decreases linearly. The collector current continues to increase as
                    υ
S
                    increases until it reaches its saturation bound at
                    i
C
                    =
                    i
SC
                    . At that point, the transistor switches into the saturation mode and thereafter the outputs remain constant at
                    i
C
                    =
                    i
SC
                    =
                    V
CC
                    /
                    R
C
                    and
                    υ
CE
                    = 0.
                  
In digital applications the input voltage drives the transistor between the cutoff and saturation modes passing through the active mode as quickly as possible. In analog circuit applications, the transistor remains in the active mode where the slope of the transfer characteristic provides voltage amplification. In the next section, we find that the OP AMP has similar transfer characteristics.

                    Suppose that the circuit parameters in
                    Figure 4-23
                    are β = 100,
                    V
γ
                    = 0.7 V,
                    R
B
                    = 100 kΩ,
                    R
C
                    = 1 kΩ, and
                    V
CC
                    = 5 V. Find
                    i
C
                    and
                    υ
CE
                    when
                    υ
S
                    = 2 V. Repeat when
                    υ
S
                    = 6 V.
                  







SOLUTION:



                Since
                υ
S
                = 2 V is greater than
                V
γ
                = 07 V, the transistor is
                not
                in the cutoff mode. We assume that it is in the active mode and use
                Eq. (4-11)
                to calculate
                i
C
                .
              





                The available short-circuit current is
                i
SC
                =
                V
CC
                /
                R
C
                = 5 mA. Since the calculated
                i
C
                is less than
                i
SC
                , the transistor is in fact in the active mode and we use
                Eq. (4-12)
                to find
                υ
CE
                .
              




                For
                υ
S
                = 2 V, the transistor is in the active mode and the outputs are
                i
C
                = 1.3 mA and
                υ
CE
                = 3.7 V.
              

                For
                υ
S
                = 6 V, we again assume that the transistor is in the active mode and calculate the collector current from
                Eq. (4-11)
                .
              




                The calculated
                i
C
                is greater than the available
                i
SC
                . For this input the transistor is in the saturation mode and the outputs equal their saturation bounds, namely
                i
C
                =
                i
SC
                = 5 mA and
                υ
CE
                = 0.
                ■













FIGURE 4-24




                  Output responses of the BJT circuit in
                  Figure 4-23
                  . The trace labeled υ
                
CE
is the υ
CE

                  output, while the trace labeled
                  i
C
                  is the collector current, i
                
C
                .
                This is called the circuit's transfer characteristics.











Design Exercise 4-14



                The known parameters in
                Figure 4-25
                are β = 100,
                V
γ
                = 0.7 V,
                R
C
                = 1 kΩ, and
                V
CC
                = 5 V. The circuit is to function as a digital inverter that meets two conditions:
              



1.

                  An input of
                  υ
S
                  = 0 V must produce an output of
                  υ
CE
                  = 5 V.
                



2.

                    An input of
                    υ
S
                    = 5 V must produce an output of
                    υ
CE
                    = 0 V
                  

                    Select a value of
                    R
B
                    so that the circuit meets these conditions.
                  




Answer:





Any reasonable value less than 86 kΩ (say 56 kΩ, a standard value) will work.












FIGURE 4-25














Design Exercise 4-15



                Your task is to design a transistor gain stage with a voltage gain (
                K
                ) of -150. The transistor you have available has a β of 90. Use the circuit in
                Figure 4-26
                , and select appropriate values for
                R
L
                and
                R
E
                . Start by first finding the voltage gain
                K
                =
                υ
O
                /
                υ
IN
                . Since the circuit is driven by a current source, there is no
                R
B
                to consider.
              


Answers:



K
                = -β
                R
L
                /(β + 1)
                R
E


R
E
                = 1 kΩ and
                R
L
                = 152 kΩ, respectively, and other solutions are possible.
              












FIGURE 4-26









4-3 The Operational Amplifier

          The integrated circuit OP AMP is the premier linear active device in present-day analog circuit applications. The term
          operational amplifier
          was apparently first used in a 1947 paper by John R. Ragazzini and his colleagues, who reported on work carried out for the National Defense Research Council during World War II. The paper described high-gain dc amplifier circuits that perform mathematical operations (addition, subtraction, multiplication, division, integration, etc.); hence the name
          operational amplifier.
          For more than a decade the most important applications were general- and
          
          special-purpose analog computers using vacuum tube amplifiers. In the early 1960s general-purpose, discrete-transistor OP AMPs became readily available, and by the mid-1960s the first commercial integrated circuit OP AMPs entered the market. The transition from vacuum tubes to integrated circuits decreased the size, power consumption, and cost of OP AMPs by nearly three orders of magnitude. By the early 1970s the integrated circuit version became the dominant active device in analog circuits.
        

          The device itself is a complex array of transistors, resistors, diodes, and capacitors, all fabricated and interconnected on a tiny silicon chip.
          Figure 4-27
          shows examples of ways OP AMPs are packaged for use in circuits. In spite of its complexity, the device can be modeled by rather simple
          i-υ
          characteristics. We do not need to concern ourselves with what is going on inside the package; rather, we treat the OP AMP using a behavioral model that constrains the voltages and currents at the external terminals of the device.
        







FIGURE 4-27



Examples of OP AMP types and packaging: (a) Dual-in-line (DIP) 8-pin UA741 general-purpose OP AMP. (b) 14-pin (DIP) LF444QML quadruple low-power JFET OP AMP. (c) Discrete-component high-performance audio amplifier John Hardy 990+. (d) Surface mount LM224K quadruple general-purpose OP AMP. (e) 8-pin TO-3 package allowing for direct contact with heat sink for dual high-power OPA2541 OP AMP. (f) Military grade TO-99 package LM741 high-reliability OP AMP.




OP AMP Notation

            Certain matters of notation and nomenclature must be discussed before developing a circuit model for the OP AMP. The OP AMP is a five-terminal device, as shown in
            Figure 4-28
            (a). The "+" and "-" symbols identify the input terminals and are a shorthand notation for the noninverting and inverting input terminals, respectively. These "+" and "-" symbols identify the two input terminals and have nothing to do with the polarity of the voltages applied. The other terminals are the output,
            υ
O
            , and the positive and negative supply voltages, usually labeled +
            V
CC
            and -
            V
CC
            . While some OP AMPs have more than five terminals, these five are always present and are the only ones we will use in this text.
            Figure 4-28
            (b) shows how these terminals are arranged in a common eight-pin integrated circuit package.
          







FIGURE 4-28



The OP AMP: (a) Circuit symbol. (b) Pin-out diagram for an eight-pin DIP package.




            The two power supply terminals in
            Figure 4-28
            are not usually shown in circuit diagrams. Be assured that they are always there because the external power supplies
            
            are required for the OP AMP to operate as an active device. The power required for signal amplification comes through these terminals from an external power source. The +
            V
CC
            and -
            V
CC
            voltages applied to these terminals also determine the upper and lower limits on the OP AMP output voltage.
          

Figure 4-29
            (a) shows a complete set of voltage and current variables for the OP AMP, while
            Figure 4-29
            (b) shows the abbreviated set of signal variables we will use. All voltages are defined with respect to a common reference node, usually ground. Voltage variables
            υ
P
            ,
            υ
N
            , and
            υ
O
            are defined by writing a voltage symbol beside the corresponding terminals. This notation means the "+" reference mark is at the terminal in question and the "-" reference mark is at the reference or ground terminal. In this book, the reference directions for the currents are directed in at input terminals and out at the output. At times the abbreviated set of current variables may appear to violate KCL. For example, a global KCL equation for the complete set of variables in
            Figure 4-29
            (a) is
          



(4-13)





            A similar equation using the shorthand set of current variables in
            Figure 4-29
            (b) reads
          


(4-14)




            This equation is
            not
            correct, since it does not include all the currents. What is more important, it implies that the output current comes from the inputs. In fact, this is wrong. The input currents are very small, ideally zero. The output current comes from the supply voltages, as
            Eq. (4-13)
            points out, even though these terminals are not shown on the abbreviated circuit diagram.
          







FIGURE 4-29



OP AMP voltage and current definitions: (a) Complete set. (b) Shorthand set.





Transfer Characteristics

            The dominant feature of the OP AMP is the transfer characteristic shown in
            Figure 4-30(a)
            . This characteristic provides the relationships between the
            noninvert-ing input
υ
P
            , the
            inverting input
υ
N
            , and the
            output voltage
υ
O
            . The transfer characteristic is divided into three regions or modes called
            +saturation, -saturation,
            and
            linear.
            In the linear region, the OP AMP is a
            differential amplifier
            because the output is proportional to the difference between the two inputs. The slope of the line in the linear range is called the voltage gain. In this linear region the input-output relation is
          



(4-15)





            The voltage gain of an OP AMP is very large, usually greater than 10
            5
            . As long as the net input (
            υ
P
            -
            υ
N
            ) is very small, the output will be proportional to the input. However, when
            A
            |
            υ
P
            -
            υ
N
            | >
            V
CC
            , the OP AMP is saturated and the output voltage is limited by the supply voltages (less some small internal losses).
          







FIGURE 4-30



(a) OP AMP transfer characteristics.




            In the previous section, we stated that the transistor has three operating modes. The input-output characteristic in
            Figure 4-30(a)
            points out that the OP AMP also has three operating modes:
          




1.

                + Saturation mode when
                A
                (
                υ
P
                -
                υ
N
                ) >
                V
CC
                and
                υ
O
                = +
                V
CC
                .
              




2.

                - Saturation mode when
                A
                (
                υ
P
                -
                υ
N
                ) <  -
                V
CC
                and
                υ
O
                = -
                V
CC
                .
              




3.

                Linear mode when
                A
                |
                υ
P
                - -
                υ
N
                | <
                V
CC
                and
                υ
O
                =
                A
                (-
                υ
P
                -
                υ
N
                ).
              



            Usually we analyze and design OP AMP circuits using the model for the linear mode. When the operating mode is not given, we use a self-consistent approach similar to the one used for the transistor. That is,
            
            we assume that the OP AMP is in the linear mode and then calculate the output voltage
            υ
O
            . If it turns out that -
            V
CC
            <
            υ
O
            < +
            V
CC
            , then the assumption is correct and the OP AMP is indeed in the linear mode. If
            υ
O
            < -
            V
CC
            , then the assumption is wrong and the OP AMP is in the -saturation mode with
            υ
O
            = -
            V
CC
            . If
            υ
O
            > +
            V
CC
            , then the assumption is wrong and the OP AMP is in the +saturation mode with
            υ
O
            = +
            V
CC
            .
          


Ideal OP AMP Model

            A dependent-source model of an OP AMP operating in its linear range is shown in
            Figure 4-30(b)
            . This model includes an input resistance (
            R
I
            ), an output resistance (
            R
O
            ), and a voltage-controlled voltage source whose gain is
            A
            .
            
4

            Numerical values of these OP AMP parameters typically fall in the following ranges:
          



Clearly, high input resistance, low output resistances, and high voltage gain are the key attributes of an OP AMP.







FIGURE 4-30



(b) Dependent-source model of an OP AMP operating in the linear mode.




            The dependent-source model can be used to develop the
            i-υ
            relationships of the ideal model. For the OP AMP to operate in its linear mode, the output voltage is bounded by
          




            Using
            Eq. (4-15)
            , we can write this bound as
          




            The supply voltage
            V
CC
            can vary with different OP AMPs but often is 15 V, while
            A
            is a very large number, usually 10
            5
            or greater. consequently, linear operation requires that
            υ
P
            «
            υ
N
            . In the ideal OP AMP model, the voltage gain is assumed to be infinite (
            A
            → ∞), in which case linear operation forces
            υ
P
            =
            υ
N
            . The input resistance
            R
I
            of the ideal OP AMP is assumed to be infinite, so the currents entering input terminals are zero. In summary, the
            i-υ
            relationships of the
            ideal model
            of the OP AMP are as follows:
          



(4-16)





            The implications of these element equations are illustrated on the OP AMP circuit symbol in
            Figure 4-31
            .
          







FIGURE 4-31



Ideal OP AMP characteristics.




            At first glance the element constraints of the ideal OP AMP appear to be fairly useless. They look more like connection constraints and are totally silent about the output quantities (
            υ
O
            and
            i
O
            ), which are usually the signals of greatest interest. They seem to say that the OP AMP input terminals are simultaneously a short circuit (
            υ
P
            =
            i
N
            ) and an open circuit (
            i
P
            =
            i
N
            = 0). In practice, however, the ideal model of the OP AMP is very useful because in linear applications feedback is always present.
            
            That is, for the OP AMP to operate in a linear mode, it is necessary for there to be feedback paths from the output to one or both of the inputs. These feedback paths ensure that
            υ
P
            «
            υ
N
            and make it possible for us to analyze OP AMP circuits using the ideal OP AMP element constraints in
            Eq. (4-16)
            .
          


Noninverting OP AMP

            To illustrate the effects of feedback, let us find the input-output characteristics of the circuit in
            Figure 4-32
            . In this circuit the voltage divider provides a feedback path from the output to the inverting input.
            
5

            Since the ideal OP AMP draws no current at either input (
            i
P
            =
            i
N
            = 0), we can use voltage division to determine the voltage at the inverting input:
          



(4-17)




The input source connection at the noninverting input requires the condition



(4-18)





            The ideal OP AMP element constraints demand that
            υ
P
            =
            υ
N
            ; therefore, we can equate the right sides of
            Eqs. (4-17)
            and
            (4-18)
            to obtain the input-output relationship of the overall circuit.
          



(4-19)











FIGURE 4-32



The noninverting amplifier circuit.




            The preceding analysis illustrates a general strategy for analyzing OP AMP circuits. We use normal circuit analysis methods to express the OP AMP input voltages
            υ
P
            and
            υ
N
            in terms of circuit parameters. We then use the ideal OP AMP constraint
            υ
P
            =
            υ
N
            to solve for the overall circuit input-output relationship.
          

            The circuit in
            Figure 4-32
            (a) is called a
            noninverting amplifier.
            The input-output relationship is of the form
            υ
O
            =
            Kυ
S
            , which reminds us that the circuit is linear.
            Figure 4-32
            (b) shows the functional building block for this circuit, where the proportionality constant
            K
            is
          



(4-20)





            In an OP AMP circuit the proportionality constant
            K
            is sometimes called the
            closed-loop
            gain, because it defines the input-output relationship when the feedback loop is connected (closed).
          

            When discussing OP AMP circuits, it is necessary to distinguish between two types of gains. The first is the large open-loop voltage gain provided by the OP AMP device itself. The second is the closed-loop voltage gain of the OP AMP circuit with a negative feedback path. Note that
            Eq. (4-20)
            indicates that the circuit gain is determined by the resistors in the feedback path, not by the value of the OP AMP gain. The gain in
            Eq. (4-20)
            is really the voltage division rule upside down. Variation of the value of
            K
            depends on the tolerance on the resistors in the feedback path, not the variation in the value of the OP AMP's gain. In effect, feedback
            
            converts the OP AMP's very large but variable gain into a much smaller but well-defined gain.
          

            Let us look at a first example of a noninverting OP AMP. consider the circuit shown in
            Figure 4-33
            (a). Let us find the output voltage, the output current, the voltage gain, the output power, and the power gain.
          







FIGURE 4-33







            The circuit we just studied is contained within the shaded area. There is an input source and an output load. The gain of the OP AMP circuit is found using
            Eq. (4-20)
            as
          




            The output voltage is found by substituting into
            Eq. (4-19)
            , but there is a possible complication. In the derivation of
            Eq. (4-19)
            , the input was connected directly to the noninverting terminal. In this circuit there is a 1-kΩ resistor between the source and the OP AMP. Doing a KVL at the input yields
          




            But we recall that for an ideal OP AMP
            i
P
            =
            i
N
            = 0. Therefore, there is no voltage drop across the 1-kΩ resistor so that the input voltage is impressed directly across the OP AMP.
            Eq. (4-19)
            holds. The output voltage is found as
          



We calculate the output current by using Ohm's Law as follows:




            The output power is simply
            p
O
            =
            υ
O
            ×
            i
O
            = 5 × 500 μ = 25 mW. It does not make sense to talk about power gain with these types of circuits. since the input current
            i
P
            is zero, the source does not provide any power to the circuit. This would appear to say that this circuit has infinite power gain. Of course that is not true. There is a power source driving the OP AMP that is indeed providing the necessary power to the load and it has limitations.
          













                      DESIGN
                      EXAMPLE 4-12



                    Design an amplifier with a gain of
                    K
                    = 10.
                  







SOLUTION:



                Using a noninverting OP AMP circuit, the design problem is to select the values of the resistors in the feedback path. From
                Eq. (4-20)
                the design constraint is
              




                We have one constraint with two unknowns. Arbitrarily selecting
                R
2
                = 10 kΩ, we find
                R
1
                = 90 kΩ. These resistors would normally have low tolerances (±1% or less) to produce a precisely controlled closed-loop gain.
              



Note:


                The problem of choosing resistance values in OP AMP circuit design problems deserves some discussion. Although values of resistance from a few ohms to several hundred megohms are commercially available, we generally limit ourselves to the range from about 1 kΩ to perhaps 10 MΩ. The lower limit of 1 kΩ is imposed in
                
                part because of power dissipation in the resistors. Typically, we use resistors with ¼-W power ratings or less. The maximum voltage in OP AMP circuits is often around 15 V. The smallest ¼-W resistance we can use is
                R
MIN
                > (15)
                2
                /0.25 = 900 Ω, or about 1kΩ. The upper bound of 10 MΩ comes about because surface leakage makes it difficult to maintain the tolerance in a high-value resistor. High-value resistors are also noisy, which leads to problems when they are connected in the feedback path. The 1-kΩ to 10-MΩ range should be used as a guideline, not an inviolate design rule. Actual design choices are influenced by system-specific factors and changes in technology.
                ■














                Design
                Exercise 4-16



(a) Design a noninverting amplifier circuit with a gain of 7 ± 10% using standard 10% resistors.

                    (See
                    Appendix G
                    for standard values.)
                  



                    (b) If the OP AMP is powered by a
                    V
CC
                    = ±15 V, what is the maximum input that will keep the OP AMP in its linear region?
                  


Answers:



                    (a) Referring to
                    Figure 4-32
                    (a),
                    R
1
                    = 22kΩ and
                    R
2
                    = 3.3 kΩ or
                    R
1
                    = 27kΩ and
                    R
2
                    = 4.7 kΩ. other combinations are possible.
                  



                    (b) -2.14 V ≤
                    υ
S
                    ≤ + 2.14 V
                  
















                Design
                Exercise 4-17

There is a need for an OP AMP noninverting amplifier with a gain of 05. Design such a circuit.


Answer:



                It is not possible to design a noninverting amplifier with a gain less than one.
                
                , hence
                K
                ≥ 1.
                

Note:


                If the sign of the gain is not important, we can achieve the desired gain with an inverting amplifier or if the sign is important, with a voltage follower followed by a voltage divider. Both of these OP AMP configurations will be studied later.
              







Effects of Finite OP AMP Gain
The ideal OP AMP model has an infinite gain. Actual OP AMP devices have very large, but finite voltage gains. We now address the effect of large but finite gain on the input-output relationships of OP AMP circuits.

            The circuit in
            Figure 4-34
            shows a finite gain OP AMP circuit model in which the input resistance
            R
I
            is infinite. The actual values of OP AMP input resistance range from 10
            6
            to 10
            12
            so no important effect is left out by ignoring this resistance. Examining the circuit, we see that the noninverting input voltage is determined by the independent voltage source. The inverting input can be found by voltage division, since the current
            i
N
            is zero. In other words,
            Eqs. (4-17)
            and
            (4-18)
            apply to this circuit as well.
          







FIGURE 4-34



The noninverting amplifier circuit with the dependent-source model.




            We next determine the output voltage in terms of the con-trolled-source voltage using voltage division on the series connection of the three resistors
            R
O
            ,
            R
1
            , and
            R
2
            :
          





            Substituting
            υ
P
            and
            υ
N
            from
            Eqs. (4-17)
            and
            (4-18)
            yields
          



(4-21)





            The intermediate result in
            Eq. (4-21)
            shows that feedback is present since
            υ
O
            appears on both sides of the equation. Solving for
            υ
O
            yields
          



(4-22)





            In the limit, as
            A
            → ∞,
            Eq. (4-22)
            reduces to
          




            where
            K
            is the closed-loop gain we previously found using the ideal OP AMP model.
          

            To see the effect of a finite
            A
            , we ignore
            R
O
            in
            Eq. (4-22)
            since it is generally quite small compared with
            R
1
            +
            R
2
            . With this approximation
            Eq. (4-22)
            can be written in the following form:
          


(4-23)




            When written in this form, we see that the closed-loop gain reduces to
            K
            as
            A
            → ∞. Moreover, we see that the finite-gain model yields a good approximation to the ideal model results as long as
            K
            ≪
            A
            . In other words, the ideal model yields good results as long as the closed-loop gain is much less than the open-loop gain of the OP AMP device. One practical rule of thumb is to limit the closed-loop gain to less than 1% of the OP AMP gain (i.e.,
            K
            <
            A
            /100).
          

            The feedback path also affects the active output resistance. To see this, we construct a Thévenin equivalent circuit using the open-circuit voltage and the short-circuit current. Equation (4-23) is the open-circuit voltage, and we need only find the short-circuit current. Connecting a short-circuit at the output in
            Figure 4-34
            forces
            υ
N
            = 0 but leaves
            υ
P
            =
            υ
S
            . Therefore, the short-circuit current is
          



As a result, the Thévenin resistance is




            When
            K
            ≪
            A
            , this expression reduces to
          





            The OP AMP circuit with feedback has an output Thévenin resistance that is much smaller than the output Thévenin resistance of the OP AMP device itself. In fact, the Thévenin resistance is very small since
            R
O
            is typically less than 100 Ω and
            A
            is greater than 10
            5
            .
          

            At this point we can summarize our discussion. We introduced the OP AMP as an active five-terminal device including two supply terminals not normally shown on the circuit diagram. We then developed an ideal model of this device that is used to analyze and design circuits that have feedback. Feedback must be present for the device to operate in the linear mode. The most dramatic feature of the ideal model is the assumption of infinite gain. Using a finite-gain model, we found that the ideal model predicts the circuit input-output relationship quite closely as long as the circuit gain
            K
            is much smaller than the OP AMP gain
            A.
            We also discovered that the Thévenin output resistance of an OP AMP with feedback is essentially zero.
          

            In the rest of this book we use the ideal
            i-υ
            constraints in
            Eq. (4-16)
            to analyze OP AMP circuits. The OP AMP circuits have essentially zero output resistance, which means that the output voltage does not change with different loads. Unless otherwise stated, from now on the term OP
            AMP
            refers to the ideal model.
          



4-4 OP AMP Circuit Analysis

          OP AMP circuit analysis takes advantage of OP AMP building blocks that are connected together in
          cascade
          (similar to series) to perform signal analysis functions that are too complex for any one building block alone. This approach greatly simplifies the analysis and design of these types of circuits. The reason this works is that OP AMP building blocks, as we saw, have very low output resistances enabling other circuits to be connected to their outputs without altering the function of either building block. In some cases, a passive circuit's signal processing function can be unintentionally altered by connecting that circuit to another. When this effect occurs, the circuit is said to be "loaded," and the effect needs to be considered. Some OP AMP building blocks, such as the noninverter just studied, also have very high input resistances. This feature enables them to be connected to the output of circuits that are sensitive to loading, such as voltage dividers, without affecting their signal processing function. In this section, we introduce four more building blocks to complement the noninverter just studied. These are the
          voltage follower
          , the
          inverting amplifier
          , the
          summer
          , and the
          sub-tractor.
          The key to using the building block approach is to recognize the feedback pattern and to isolate the basic circuit as a building block. The first example illustrates this process.
        

Cascade Connection

            Signal processing often involves a cascade connection in which the output, usually a voltage, of one circuit is the input to the next circuit. Ideally, the function performed by one cascaded circuit does not affect the signal processing of the other. Hence, if one circuit was designed to add two inputs, say
            υ
S1
            and
            υ
S2
            , and the second circuit to multiply the output of the first circuit by
            K,
            the output of the second circuit would be
            υ
O
            =
            K
            (
            υ
S1
            +
            υ
S2
            ). When this occurs, we say that there is no loading. The outputs of the OP AMP circuits that we will cover in this section have no loading occurring at their outputs. The same is not always true for their inputs, and we will learn how to mitigate loading when it occurs.
            

Note:


            Cascading circuits refers only to connecting building blocks together in a series-type fashion. It does not guarantee that there will be no loading.
            













EXAMPLE 4-13



                    Find the input-output relationship, that is, the
                    K
                    of the circuit in 4-35(a).
                  














FIGURE 4-35








SOLUTION:



                As we look at the circuit, we can recognize a voltage divider and a noninverting OP AMP—two separate building blocks. Since the noninverter draws no current from the voltage divider, the output of the divider is unaltered and impressed on the input to the OP AMP at
                υ
P
                . Each building block has its own gain:
                K
VD
                for the voltage divider and
                K
AMP
                for the noninverter.
                Figure 4-35
                (b) shows the two building blocks in cascade. That is, the output of the first building block becomes the input of the second. We can find the gain of the voltage divider as follows:
              




                Since the noninverting amplifier has zero output resistance, the load
                R
L
                has no effect on the output voltage
                υ
O
                . Using
                Eq. (4-19)
                , the gain of the noninverting amplifier circuit is
              



The overall circuit gain is found as




                The gain
                K
CIRCUIT
                is the product of
                K
VD
                times
                K
AMP
                because the amplifier circuit does not load the voltage divider circuit since
                i
P
                = 0.
              

                The cascaded circuit we just analyzed had no loading. The joint output was simply the product of each individual circuit or stage. Let us look at what happens if we reverse the circuits as shown in
                Figures 4-35
                (c) and
                (d)
                . The input S goes directly into
                υ
P
                , and the gain of that stage remains the same as before
              




                The voltage divider is connected to the output of the noninverting amplifier. If the load
                R
L
                was missing or near infinite, then the output would be the same as before. But with a finite
                
                  R
                  L
                  ,
                
                the voltage divider is loaded. The output of the voltage divider is
              





                And the gain
                K
CIRCUIT
                is
              




                The gain is clearly not the same. The order of the stages can have a significant effect on the performance of the circuit. We will see the effect more clearly in the following exercise.
                ■













Exercise 4-18



                  (a) Find
                  υ
O
                  in
                  Figure 4-35
                  (a) when
                  R
1
                  =
                  R
2
                  = 1 kΩ,
                  υ
S
                  = 1 V,
                  R
3
                  =
                  R
4
                  = 1 kΩ, and
                  R
L
                  = 100 Ω.
                

                  (b) Find
                  υ
O
                  in
                  Figure 4-35
                  (c) when
                  R
1
                  =
                  R
2
                  = 1 kΩ,
                  υ
S
                  = 1 V,
                  R
3
                  =
                  R
4
                  = 1 kΩ, and
                  R
L
                  = 100 Ω.
                

Answers:


                  (a)
                  υ
O
                  = 1 V
                

                  (b)
                  υ
O
                  = 166 mV
                








Voltage Follower

            The OP AMP in
            Figure 4-36
            (a) is connected as a
            voltage follower
            also called a
            buffer.
            in this case, the feedback path is a direct connection from the output to the inverting input. The feedback connection forces the condition
            υ
N
            =
            υ
O
            . The input current
            i
P
            = 0, so there is no voltage across the source resistance
            R
S
            . Applying KVL, we have the input condition
            υ
P
            =
            υ
S
            . The ideal OP AMP model requires
            υ
P
            =
            υ
N
            , so we conclude that
            υ
O
            =
            υ
S
            . By inspection, the closed-loop gain is
            K
            — 1. Since the output exactly equals the input, we say that the output follows the input (hence the name
            voltage follower
            ).
          

            The voltage follower is used in interface circuits because it isolates the source from the load. Note that the input-output relationship
            υ
O
            =
            υ
S
            does not depend on the source or load resistance. When the source is connected directly to the load, as in
            Figure 4-36
            (b), the voltage delivered to the load depends on
            R
S
            and
            R
L
            . The source and load interaction limits the signals that can be transferred across the interface, as discussed in
            Chapter 3
            . When the voltage follower is inserted between the source and load, the signal levels are limited by the capability of the OP AMP.
          







FIGURE 4-36



(a) Source-load interface with a voltage follower. (b) Interface without the voltage follower.




            By ohm's law, the current delivered to the load is
            i
O
            =
            υ
O
            /
            R
L
            . But since
            υ
O
            =
            υ
S
            , the output current can be written in the form
          



Applying KCL at the reference node, we discover an apparent dilemma:





            For the ideal model
            i
P
            = 0, but the preceding equations say that
            i
O
            cannot be zero unless
            υ
S
            is zero. It appears that KCL is violated.
          
The dilemma is resolved by noting that the circuit diagram does not include the supply terminals. The output current comes from the power supply, not from the input. This dilemma arises only at the reference node (the ground terminal). In OP AMP circuits, as in all circuits, KCL must be satisfied. However, we must be alert to the fact that a KCL equation at the reference node could yield misleading results because the power supply terminals are not usually included in circuit diagrams.







                Design
                Exercise 4-19


                There is a need for an OP AMP noninverting amplifier with a gain of 008. Design such a circuit. Use the results of
                Example 4-13
                as a guide.
              


Answer:



                Use a voltage divider with
                R
1
                = 10 kΩ and
                R
2
                = 870 Ω cascaded by a follower.
              













                APPLICATION
                EXAMPLE 4-14

Digital (or even analog) Multimeters (DMMs) are ubiquitous engineering tools. They can be purchased for as little as $10 to as much as several thousand dollars. Most popular models are in the range of $100 to $200 and are hand-held portables. Clearly there must be differences to warrant such a wide range of prices. These differences are durability, accuracy, functions, input resistance, and battery or plug-in powered, to mention a few. For this discussion let us focus on input resistance.

                Consider the circuit of
                Figure 4-37
                (a). A particular DMM is used to measure the voltage across the 10-MΩ resistor. The anticipated voltage was 8 V. However, the meter reads 6 V. The meter has an internal resistance that is in parallel with the resistor that is being measured and is significantly altering the reading. One can calculate the internal resistance of the meter
                R
M
                using voltage division as follows:
              







FIGURE 4-37









where




                Solving for
                R
M
                , we find that
                R
M
                = 10 MΩ.
              


                The reason for the problem is that the current splits at node A sending some through the DMM. In theory, with a perfect DMM all of the current would flow through the load.
              

                The problem can be solved by inserting a follower in front of the DMM as shown in
                Figure 4-37
                (b). Better DMMs have a follower in the front end to permit them to measure voltages across high resistances. The down side is that a follower requires power to operate. It should be noted that most voltage measurements are made across resistors significantly smaller than 10 MΩ, negating the need for a follower.
              













Exercise 4-20


                A DMM with a known internal resistance of 12.5 MΩ is used to measure voltages across several resistors in the circuit shown in
                Figure 4-38
                . What voltage will be measured on the DMM across each resistor?
              
Answers:



Resistor
Expected Voltage (V)
Measured Voltage (V)
Percent Error




50 kΩ
0.237
0.236
0.41


10 MΩ
47.4
45.5
4.01


500 kΩ
2.37
2.28
3.68















FIGURE 4-38












Exercise 4-21


                The circuits inFigure4-36 have
                υ
S
                = 1.5 V,
                R
S
                = 2 kΩ, and
                R
L
                = 1 kΩ. Compute the maximum power available from the source. Compute the power absorbed by the load resistor in the direct connection in
                Figure 4-36
                (b) and in the voltage follower circuit in
                Figure 4-36
                (a). Discuss any differences.
              


Answers:



p
max
                = 281 μW;
                p
Ldirect
                = 250 μW;
                p
lopamp
                = 2250 μW
              


Discussion:

With the direct connection, the power delivered to the load is less than the maximum power available. With the voltage follower circuit, the power delivered to the load is greater than the maximum value specified by the maximum power transfer theorem. However, the maximum power transfer theorem does not apply to the voltage follower circuit since the load power comes from the OP AMP power supply rather than from the signal source.








The Inverting Amplifier

            The circuit in
            Figure 4-39
            is called an
            inverting amplifier.
            The key feature of this circuit is that the input signal and the feedback are both applied at the inverting input. Since the noninverting input is grounded we have P = 0 an observation we will use shortly. The sum of currents entering node A can be written as
          



(4-24)





            The element constraints for the OP AMP are
            υ
P
            =
            υ
N
            and
            i
P
            =
            i
N
            = 0. Since
            υ
P
            = 0, it follows that
            υ
N
            = 0. Substituting the OP AMP constraints into
            Eq. (4-24)
            and solving for the input-output relationship yields
          


(4-25)










FIGURE 4-39



The inverting amplifier circuit.





            This result is of the form
            υ
O
            =
            Kυ
S
            , where
            K
            is the closed-loop gain. However, in this case the voltage gain
            K
            = -
            R
2
            /
            R
1
            is negative, indicating a signal inversion (hence the name
            inverting amplifier
            or simply, an inverter). We use the block diagram symbol in
            Figure 4-39
            (b) to indicate either the inverting or the noninverting OP AMP configuration.
          

            In both cases of inverting and noninverting amplifiers or any OP AMP circuit, one must realize that OP AMPs, even ideal ones, have limitations on their outputs. A significant limitation is that an OP AMP's output is limited by the power supplied to it. That is, for an OP AMP to operate in its linear range as seen earlier in
            Figure 4-30(a)
            , its output must lie between ±
            V
CC
            . Hence, if we have an OP AMP driven by, say,
            V
CC
            = ±12 V, its output cannot exceed ±12 V. If we have a onesided OP AMP, useful in digital applications, with +
            V
CC
            of 5 V and -
            V
CC
            of 0 V, its output can only lie in that range. If we try to exceed those limits, the OP AMP will saturate at +
            V
CC
            or -
            V
CC
            .
          






Exercise 4-22


                The switch in
                Figure 4-40
                moves from A to B. What is the output voltage
                υ
O
                when the switch is in position A and in position B?
              
Answers:

                Switch in position A,
                υ
O
                = -10 V.
              

                Switch in position B,
                υ
O
                = -15 V, because the OP AMP is saturated.
              












FIGURE 4-40













                Design
                Exercise 4-23


                A 2-mV signal
                υ
S
                needs to be amplified by a gain of -450±10% using standard 10% resistors from
                Appendix G
                . Design an appropriate circuit to amplify the signal.
              


Answer:



                Because the gain needs to be negative, an inverting amplifier like that shown in
                Figure 4-39
                (a) is used with
                R
2
                = 470 kΩ and
                R
1
                = 1 kΩ. This produces a gain of -470, well within the 10% tolerance.
              






            Let us look at another feature of the inverting OP AMP that should be understood. The OP AMP constraints mean that the input current
            i
1
            in
            Figure 4-39
            (a) is
          




            This, in turn, shows that the input resistance seen by the source
            υ
S
            is
          


(4-26)




            In other words, the inverting amplifier has a finite input resistance determined by the external resistor
            R
1
            .
          
The next example shows that the finite input resistance must be taken into account when analyzing circuits with OP AMPs in the inverting amplifier configuration.











EXAMPLE 4-15


                    Find the input-output relationship of the circuit in
                    Figure 4-41
                    (a).
                  







SOLUTION:



                The circuit to the right of node B is an inverting amplifier. The load resistance
                R
L
                has no effect on the circuit transfer characteristics since the OP AMP has zero output resistance. However, the source circuit to the left of node B is influenced by the input
                
                resistance of the inverting amplifier circuit. The effect can be seen by constructing a Thévenin equivalent of the circuit to the left of node B, as shown in
                Figure 4-41
                (b). By inspection of
                Figure 4-41
                (a),
              







FIGURE 4-41










                In
                Figure 4-41
                (b) the Thévenin resistance is connected in series with the input resistor
                R
3
                , yielding the equivalent resistance
                R
EQ
                =
                R
T
                +
                R
3
                shown in
                Figure 4-41
                (c). This reduced circuit is in the form of an inverting amplifier, so we can write the input-output relationship relating
                υ
O
                and
                υ
T
                as
              





                The overall input-output relationship from the input source
                υ
S
                to the OP AMP output oo is obtained as follows:
              




                It is important to note that the overall gain is
                not
                the product of the source circuit voltage gain
                R
2
                /(
                R
1
                +
                R
2
                ) and the inverting amplifier gain -
                R
4
                /
                R
3
                . In this circuit, the two building blocks interact because the input resistance of the inverting amplifier circuit loads the source circuit.
                ■













Exercise 4-24



                  (a) Find the voltage gain
                  K
                  =
                  υ
O
                  /
                  υ
S
                  for the circuit in
                  Figure 4-42
                  .
                

                  (b) Insert a follower at node
                  A
                  , and repeat. Why is there a difference?
                

Answers:


                  (a)
                  K
                  = -2.89
                

                  (b)
                  K
                  = -4.04. By inserting the follower, the first voltage divider was not loaded by the 15-kΩ input resistor to the inverter.
                













FIGURE 4-42








The Summing Amplifier

            The
            summing amplifier
            or
            adder
            circuit is shown in
            Figure 4-43
            (a). This circuit has two inputs connected at node A, which is called the
            summing point.
            since the noninverting input is grounded, we have the condition
            υ
P
            = 0. This configuration is similar to the inverting amplifier, so we start by applying KCL to write the sum of currents entering the node A summing point.
          



(4-27)











FIGURE 4-43



The inverting summer.





            With the noninverting input grounded, the OP AMP element constraints are
            υ
N
            =
            υ
P
            = 0 and
            i
N
            = 0. Substituting these OP AMP constraints into
            Eq. (4-27)
            , we can solve for the circuit input-output relationship.
          



(4-28)





            The output is a weighted sum of the two inputs. The scale factors (or gains, as they are called) are determined by the ratio of the feedback resistor
            R
F
            to the input resistor for each input: that is,
            K
1
            = -
            R
F
            /
            R
1
            and
            K
2
            = -
            R
F
            /
            R
2
            . In the special case
            R
1
            =
            R
2
            = R,
            Eq. (4-28)
            reduces to
          




            In this special case the output is proportional to the sum of the two inputs (hence the name
            summing amplifier
            or, more precisely,
            inverting summer).
            A block diagram representation of this circuit is shown in
            Figure 4-43
            (b).
          

            The summing amplifier in
            Figure 4-43
            has two inputs, so there are two gains to contend with, one for each input. The input-output relationship in
            Eq. (4-28)
            is easily generalized to the case of
            n
            inputs as
          



(4-29)





            where
            R
F
            is the feedback resistor and
            R
1
            ,
            R
2
            ,...,
            R

n

            are the input resistors for the
            n
            input voltages
            υ
1
            ,
            υ
2
            ,...,
            υ

n

            . You can easily verify this result by expanding the KCL sum in
            Eq. (4-27)
            to include
            n
            inputs, invoking the OP AMP constraints, and then solving for
            υ
O
            .
          






Exercise 4-25


                In
                Figure 4-43
                ,
                υ
1
                = 0.6 V,
                υ
2
                = 0.4 V,
                R
1
                = 3.3 kΩ,
                R
2
                = 4.7 kΩ, and
                R
F
                = 15 kΩ. Find
                υ
O
                .
              


Answer:



υ
O
                = -4.0 V
              



















                    DESIGN EXAMPLE 4-16
                  
Design an inverting summer that implements the input-output relationship










SOLUTION:


The design problem involves selecting the input and feedback resistors so that





                One solution is arbitrarily to select
                R
F
                -65 kΩ the product of 13 × 5, which yields
                R
1
                = 13 kΩ and
                R
2
                = 5 kΩ. The resulting circuit is shown in
                Figure 4-44
                (a). The design can be modified to use standard resistance values for resistors with ±5% tolerance (see
                Appendix G
                ). Selecting the standard value
                R
F
                = 56 kΩ requires
                R
1
                = 11.2 kΩ and
                R
2
                = 4.31 kΩ. The nearest standard values are 11 kΩ and 4.3 kΩ. The resulting circuit shown in
                Figure 4-44
                (b) incorporates standard value resistors and produces gains of
                K
1
                = -56/11 =  -5.09 and
                K
2
                = -56/4.3 = -13.02. These nominal gains are within 2% of the values in the specified input-output relationship.
                ■













Exercise 4-26



                  (a) Find
                  υ
O
                  in
                  Figure 4-44
                  (a) when
                  υ
1
                  = 2 V and
                  υ
2
                  = -0.5 V.
                

                  (b) If
                  υ
1
                  = 400 mV and
                  V
CC
                  = ±15 V, what is the maximum value of
                  υ
2
                  for linear mode operation?
                

                  (c) If
                  υ
1
                  = 500 mV and
                  V
CC
                  = ±15 V, what is the minimum value of
                  υ
2
                  for linear mode operation?
                

Answers:

(a) -3.5 V; (b) 1 V; (c) -1.346 V













FIGURE 4-44













FIGURE 4-45












                APPLICATION
                EXAMPLE 4-17

Inverting amplifiers of the type discussed above have the ability to be easily designed with outputs being the weighted sum of the various inputs. While this type of OP AMP Summer is the most common by far, there is occasionally the need for a noninverting summer. In this example, we analyze a noninverting summer and discuss the advantages and disadvantages of this summer versus the inverting summer.

                Consider the circuit of
                Figure 4-45
                and find the input-output relationship.
              

                One should recognize the shaded area of the figure as being that of a noninverting amplifier with gain
                
                , and
                υ
O
                =
                K
                ×
                υ
P
                , where
                υ
P
                acts as the summing terminal of the circuit as well as the noninverting input terminal of the OP AMP.
              

                We can find the voltage at
                υ
P
                using superposition. For the contribution of
                υ
1
                we set all sources except
                υ
1
                to zero and solve for the voltage
                υ
P1





                Similarly for the contribution of
                υ
2




And so forth, until all input sources have been accounted for. Then using the additive property of linear circuits, we obtain the final result




                While this appears to be a simple result, calculating weighted gains for each input is not so simple, especially if there are more than two or three inputs. If all the inputs are
                
                to have the same gain then selecting all source resistors to be equal, makes the circuit useful and easy to use. For example, consider a three-input noninverting summer with all source resistors equal. Using our previous result for
                N
                = 3, we get
              



So that our final result is




                The designer can choose the OP AMP gain
                K
                to produce the overall gain desired. If, for example, one wanted an overall gain of 10, one would choose
                K
                = 30, resulting in
              



In summary, the noninverting summer has the advantage of being able to sum multiple inputs with all positive gains using a single OP AMP. Its main disadvantage is that the design process of selecting resistors to achieve specific gain values can be significantly more complicated.













Exercise 4-27

Design a noninverting summer for four inputs with equal gains of 50.


Answer:


Select all source resistors equal and then make the gain of the OP AMP 200.







The Differential Amplifier

            The circuit in
            Figure 4-46
            (a) is called a
            differential amplifier
            or
            subtractor.
            Like the summer, this circuit has two inputs, one applied at the inverting input and one at the
            
            noninverting input of the OP AMP. The input-output relationship can be obtained using the superposition principle.
          







FIGURE 4-46



The differential amplifier.




            First, we turn off source
            υ
2
            , in which case there is no excitation at the noninverting input and
            υ
P
            = 0. In effect, the noninverting input is grounded and the circuit acts like an inverting amplifier with the result that
          



(4-30)





            Next, turning
            υ
2
            back on and turning
            υ
1
            off, we see that the circuit looks like a non-inverting amplifier with a voltage divider connected at its input. This case was treated in
            Example 4-13
            , so we can write
          



(4-31)





            Using superposition, we add outputs in
            Eqs. (4-30)
            and
            (4-31)
            to obtain the output with both sources on:
          



(4-32)





            where
            K
1
            and
            K
2
            are the inverting and noninverting gains.
            Figure 4-46
            (b) shows how the differential amplifier is represented in a block diagram. For the special case of
            R
3
            /
            R
1
            =
            R
4
            /
            R
2
            ,
            Eq. (4-32)
            reduces to
          


(4-33)




            In this case the output is proportional to the difference between the two inputs (hence the name
            differential amplifier
            or
            subtractor
            ).
          






Exercise 4-28



                  (a) Find the input-output relationship of the subtractor circuit in
                  Figure 4-47
                  .
                

                  (b) If
                  V
CC
                  = ±15 V and
                  υ
1
                  = 3 V, what is the allowable range of
                  υ
2
                  for linear operation of the OP AMP?
                

Answers:


                  (a)
                  υ
O
                  = -4
                  υ
1
                  + 3
                  υ
2
                  ; (b) -1 V ≤
                  υ
2
                  ≤ 9 V
                













FIGURE 4-47








Basic OP AMP Building Blocks

            The block diagram representations of the basic OP AMP circuit configurations are shown in
            Figure 4-48
            . The noninverting and inverting amplifiers are represented as gain blocks. The inverting summer, subtractor, and noninverting summer require both gain blocks and the summing point symbol. Considerable care must be used when translating from a block diagram to a circuit, or vice versa, since
            
            some gain blocks involve negative gains. For example, the gains of the inverting summer are negative. The required minus sign is sometimes moved to the summing point and the value of
            K
            within the gain block changed to a positive number. since there is no standard convention for doing this, it is important to keep track of the signs associated with gain blocks and summing points.
          







FIGURE 4-48



Summary of basic OP AMP signal-processing circuits.





            The OP AMP building blocks in
            Figure 4-48
            can be interconnected to obtain complex signal-processing functions. These interconnects do not change the input-output relationships of each block, provided the connections are all between outputs and inputs. Each of the building blocks in
            Figure 4-48
            is a feedback circuit with an OP AMP output. These feedback circuits have insignificant output resistances and can drive any load within the OP AMP's output current capacity.
            
6

            In other words, the building block outputs act like ideal voltage sources just like the voltage sources connected to the block inputs. This observation leads to the following conclusion:
          




Connecting the output of one building block circuit to an input of another does not change the signal-processing function performed by either circuit.




This property allows us to find the function performed by an interconnection using the functions performed by the individual building blocks. Conversely, this property allows us to design an interconnection by breaking a required function down into separate building block functions.











EXAMPLE 4-18


                    Derive an expression for
                    υ
O
                    in
                    Figure 4-49
                    (a) in terms of the two inputs. Draw a block diagram representative of the circuit.
                  












FIGURE 4-49



(a) Circuit. (b) Block diagram.





SOLUTION:



                The circuit is an interconnection of two basic building blocks: a three-input summer and a noninverting amplifier. The circuit meets the connection requirement since building block outputs are connected to other building block inputs. The node voltage
                υ
A
                in the figure is the output of the summer. The summer inputs are a fixed 5-V source, a signal source
                υ
S
                and the noninverting amplifier output
                υ
O
                . Using the inverting summer input-output relationship in
                Eq. (4-29)
                , we have as shown in
                Figure 4-49
                (b)
              





                The summer output
                υ
A
                is the input to the noninverting amplifier whose voltage gain is
                K
                = 3. Using the input-output relationship of the noninverting amplifier, we have
              




                Solving for
                υ
O
                yields
              




                The signal-processing function on the interconnection was found using the input-output relationships of the individual building blocks. The method even works with a feedback path because the 20-kΩ resistor is connected from the noninverting amplifier output to the input of the inverting summer. The block diagram is shown in
                Figure 4-49
                (b).
                ■













Exercise 4-29


                Derive an expression for
                υ
O
                in
                Figure 4-50
                in terms of the inputs
                υ
1
                and
                υ
2
                .
              







FIGURE 4-50








Answer:



υ
O
                = 8
                υ
1
                - 4
                υ
2




















EXAMPLE 4-19



                    Derive an expression for the output
                    v
O
                    in the two OP AMP subtractor circuit in
                    Figure 4-51
                    in terms of the two inputs
                    υ
1
                    and
                    υ
2
                    .
                  












FIGURE 4-51








SOLUTION:



                The circuit is an interconnection of a noninverting amplifier and an inverting amplifier with an additional signal
                υ
2
                applied at its noninverting input. The voltage
                υ
A
                shown in the figure is the output of the noninverting amplifier:
              




                We use superposition to find
                υ
O
                . First, set
                υ
2
                = 0, which connects the noninverting input of the second stage to ground. In this case, the second stage acts like an inverting amplifier whose input is
                υ
A
                and whose output is the response due to
                υ
1
                acting alone:
              





                Next, set
                υ
1
                = 0 which sets
                υ
A
                = 0 in turn. In effect this connects resistor
                R
3
                to ground. In this case, the second stage acts like a noninverting amplifier whose input is
                υ
2
                and whose output is the response due to
                υ
2
                acting alone:
              



Applying superposition, the total output is




                where -
                K
1
                and
                K
2
                are the inverting and noninverting gains, respectively.
              

                The dual OP AMP circuit in
                Figure 4-51
                performs the same signal-processing function as the single OP AMP subtractor circuit in
                Figure 4-48
                . Why use two OP AMPs to obtain a function that can be achieved using only one? The answer is that both input signals in
                Figure 4-51
                are applied to noninverting OP AMP inputs that have very high input resistances. This means that the two-OP AMP subtractor does not load the input signal sources. The basic subtractor in
                Figure 4-48
                has finite input resistances that may load the input signal sources. This difference could be important when the input signal sources have high Thévenin resistances.
                ■















                Design and Evaluation
                Exercise 4-30


                We have looked at two ways to design subtractor circuits—the more common way as shown in
                Figure 4-46
                and the less common way as shown in
                Figure 4-51
                . Your task is to design OP AMP circuits that meet the following expression:
                υ
O
                = -20
                υ
1
                + 10
                υ
2
                using both realizations. At least one resistor in each circuit must be 1 kΩ. The remaining resistors should be selected from the standard 5% values from
                Appendix G
                . Then list pros and cons for each approach.
              


Answers:



                Single-OP AMP approach:
                R
1
                = 1 kΩ,
                R
2
                = 20 kΩ,
                R
3
                = 11kΩ, and
                R
4
                = 10 kΩ. Advantages: fewer parts, less power required (one versus two OP AMPs), and simpler design. Disadvantage: low input resistance may result in loading.
              

                Two-OP AMP approach:
                R
1
                = 9.1 kΩ,
                R
2
                = 11 kΩ,
                R
3
                = 1 kΩ, and
                R
4
                = 9.1 kΩ. Advantage: high input resistance allows for connecting to almost any source circuit. Disadvantages: more parts, more power required, and a slightly more complicated design.
              
Other design values are possible.












FIGURE 4-52



General OP AMP circuit analysis.





Node-Voltage Analysis with OP AMPS

            There are many useful OP AMP circuits that are not simply interconnections of basic building blocks. In such cases we use a modified form of node-voltage analysis that is based on the OP AMP connections in
            Figure 4-52
            . The overall circuit contains
            N
            nodes, including the three associated with the OP AMP. Normally the objective is to find the OP AMP output voltage
            υ
O
            relative to the reference node (ground). We assign node voltage variables to the
            N
            -1 nonreference nodes, including a variable at the OP AMP output. However, an ideal OP AMP acts like a dependent voltage source connected between
            
            the output terminal and ground. As a result, the OP AMP output voltage is determined by the other node voltages, and so we do not need to write a node equation at the OP AMP output node.
          

            We formulate node equations at the other
            N
            - 2 nonreference nodes in the usual way. Since there are
            N
            - 1 node voltages, we seem to have more unknowns than equations. However, the OP AMP forces the condition
            υ
P
            =
            υ
N
            in
            Figure 4-52
            . This eliminates one unknown node voltage since these two nodes are forced to have identical voltages. Finally, remember that the ideal OP AMP draws no current at its inputs (
            i
P
            =
            i
N
            = 0) in
            Figure 4-52
            , so these currents can be ignored when formulating node equations.
          
The following steps outline an approach to the formulation of node equations for OP AMP circuits:

STEP 1

              Identify a node voltage at all nonreference nodes, including OP AMP outputs, but do
              not
              formulate node equations at the OP AMP output nodes.
            


STEP 2

              Formulate node equations at the remaining nonreference nodes and then use the ideal OP AMP voltage constraint
              υ
P
              =
              υ
N
              to reduce the number of unknowns.
            













EXAMPLE 4-20



                    Derive an expression for
                    υ
O
                    in
                    Figure 4-53
                    in terms of the inputs
                    υ
1
                    and
                    υ
2
                    .
                  












FIGURE 4-53








SOLUTION:



                This circuit is not an interconnection of OP AMP building blocks because the resistor
                R
                2 is connected between two inputs. We use the node-voltage method outlined above to find the required input-output relationship.
              

STEP 1

                  The circuit has a total of six nonreference nodes as shown in the figure. Nodes B and E are OP AMP outputs while nodes A and F are connected to ground by the input voltage sources
                  υ
2
                  and
                  υ
1
                  , respectively. As a result, we only need node equations at C and D. Writing the sum of currents leaving these nodes
                






                  yields two equations in the four node voltages
                  υ
B
                  ,
                  υ
C
                  ,
                  υ
D
                  , and
                  υ
E
                  .
                


STEP 2

                  The noninverting OP AMP inputs are connected to independent voltages sources
                  υ
2
                  and
                  υ
1
                  . The OP AMP voltage constraints (
                  υ
P
                  =
                  υ
N
                  ) mean that
                  υ
D
                  =
                  υ
1
                  and
                  υ
C
                  =
                  υ
2
                  . These constraints eliminate
                  υ
C
                  and
                  υ
D
                  as unknowns and reduce the two node equations to
                






                  The node-voltage formulation method outlined above leads to two equations in the two unknown node voltages
                  υ
B
                  and
                  υ
E
                  .
                


                We solve the node C equation for
                υ
B





                and the node D equation for
                υ
E






                Using the fundamental property of node voltages yields the required output as
              




                The circuit in
                Figure 4-53
                is a differential amplifier of the form
                υ
O
                =
                K
                (
                υ
2
                -
                υ
1
                ) in which the input voltages
                υ
1
                and
                υ
2
                are applied at noninverting OP AMP inputs that have very high input resistances. The circuit is the first stage of a commercially available integrated circuit called an instrumentation amplifier. We will use this circuit later.
                
■
















Design Exercise 4-31



                Select values of
                R
1
                ,
                R
2
                , and
                R
3
                in
                Figure 4-53
                so that
                υ
O
                = 50(
                υ
2
                -
                υ
1
                ).
              


Answer:



                Selecting
                R
1
                =
                R
3
                = 24.5 kΩ and
                R
2
                = 1 kΩ is one of many possible solutions.
              








4-5 OP AMP Circuit Design

          This section is dedicated to OP AMP circuit
          design.
          Unlike circuit
          analysis,
          where we are asked to find the single correct input-output relationship for a given circuit configuration, circuit design asks us to create a circuit that will realize a desired input-output relationship. Successful OP AMP circuit designs are accomplished by interconnecting the various building blocks studied (inverter, noninverter, follower, summer, subtractor, and more to come). The design process is greatly simplified by the nearly one-to-one correspondence between the actual OP AMP circuits and their building-block equivalents. However, unlike analysis problems, design problems rarely have a unique solution since there are usually several OP AMP circuits that can meet the design objective. This prompts the question, which is the better or best design solution? Sometimes the choice is obvious; at other times it is not. Making the right choice is the highest level of learning—a key objective of every nascent engineer—and is called
          evaluation
          (the art of making smart engineering decisions). We have already seen some application of this skill in
          Chapter 3
          with respect to choosing the better interface. Engineers are often faced with selecting the best solution from several possibilities. In making their recommendations, engineers consider many factors, including economic considerations (purchase, maintenance, disposal, and replacement costs), environmental issues (power used, recyclability, pollution produced), ergonomics and aesthetics, reliability (durability, maintainability, and accuracy), number of parts, uniqueness of parts, physical properties (size, shape, and weight), dependability of the vendor, and availability over time. In making a decision, it is essential that one knows the appropriate factors to consider and their respective importance to the application. In this section and the next, we will look at some of these issues.
        












EVALUATION EXAMPLE 4-21


                  In a particular application, it is necessary to implement the block diagram shown in
                  Figure 4-54
                  . The maximum individual OP AMP gain cannot exceed ±2000. The input resistance of the first signal stage must be at least 10 kΩ. The nominal input signal
                  υ
1
                  is 1 μV.
                

                  Two vendors have provided competitive solutions, shown in
                  Figure 4-55
                  . Choose the best solution based on achieving the desired output considering: cost, parts count, variety of parts needed, and power usage.
                












FIGURE 4-54













FIGURE 4-55









SOLUTION:



              Referring to the block diagram, we determine what output the circuit is supposed to deliver. We see that the input is multiplied by 10
              6
              and then added to -2.6 V. Hence, we must have a circuit that has the following input-output relation:
            




              Also, the input signal that must be amplified is small, only around 1 μ V, and therefore it needs a large gain to make it usable (
              K
              = 10
              6
              ). The input resistance must be at least 10 kΩ, probably to avoid loading from
              υ
1
              . The individual OP AMPs cannot have a gain magnitude exceeding 2000. At some point in the design, the 2.6-V source will need to be subtracted from the amplified
              υ
1
              .
            
Let us analyze each vendor's submission to see first if the circuits meet the required specifications.


Vendor A



              This vendor chose a straightforward approach, splitting the gain across two OP AMP stages. At
              υ
A
              the output is -1000
              υ
1
              . This is then input to an inverting summer along with the 26 V. The input from
              υ
A
              is given a gain of −1000 while the 26-V input is given a gain of −1. The end result is the following expression for
              υ
O
              :
            



Checking the other criteria; (a) the input to the first signal stage is 10 kΩ, right at the limit; (b) total parts, 7; (c) different parts, 5; (d) power requirement, two OP AMPs; and (e) cost, $15.


Vendor B



              This vendor took a nontraditional approach. The vendor split the gain across two OP AMPs but used a noninverter for the first stage followed by a subtractor. The input to
              
              the inverting terminal seems uncommon and needs to be analyzed to see if it works. The first stage provides an output gain at
              υ
A
              of 1001. We need to see what the inputs to the subtractor are before we can determine the output. We start by doing a Thévenin equivalence at
              υ
B
              . We get
              υ
T
              = 2.597 mV and
              R
T
              = 100 Ω || 100 kΩ = 99.9 Ω.
            
Next, we look at the subtractor relationship:




              We note that
              R
2
              = 10 MΩ. The other resistance will take some work to calculate.
              R
1
              is the input resistance at the inverting terminal. We see that it is 10 kΩ plus
              R
T
              , or 10,099.9 Ω. Now
              R
3
              is the series resistance connected to the noninverting terminal, or 0 Ω, while
              R
4
              is the resistance from the noninverting terminal to ground—an open circuit, or ∞ Ω. Substituting these values into our subtractor equation, we get
            



This vendor's solution is close but not exact. The gain is off by 0.8% and the constant is off by 12%. Checking the other criteria: (a) the input to the first signal stage is into a noninverting stage or about ∞ Ω, so there are no concerns with loading; (b) total parts, 8, (c) different parts, 5, (d) power requirement two OP AMPs; and (e) cost, $12.


Discussion:

Vendor A's circuit meets all of the specifications exactly, but it costs more than Vendor B's circuit. Vendor B's solution, on the other hand, is not exact, but the errors are small. Vendor B uses one extra part, but three of the parts are the same, while Vendor A's circuit has only two parts that are the same. Both use two OP AMPs and, since the power supplies to the OP AMPs usually are the largest sources of power usage, they are equal on this criterion. The bottom line: if the number of circuits being purchased is small, then Vendor A provides the simpler and most accurate design. If the number is large so that cost becomes a significant factor and the small errors can be tolerated, then choose Vendor B.
■















Exercise 4-32



              Assume that the input to each of the circuits of the
              Evaluation Example 4-21
              is 1 μV.
            


(a) Use the results in the example to obtain a desired output for each circuit.


(b) Then using Multisim, generate the actual outputs for each circuit.


(c) Comment on your findings.









FIGURE 4-56













FIGURE 4-56







              Answers:
            


                (a) As designed Vendor A's circuit should produce
                υ
O
                = −1.6 V; Vendor B's
                υ
O
                = −1.578 V.
              

                (b) Using Multisim (See
                Figure 4-56
                ) Vendor A's circuit produces
                υ
O
                = −1.597 V; Vendor B's
                υ
O
                = −1.577 V.
              
(c) Both circuits produce results that are close to the calculated values. Vendor A'sis within 0.2% of the desired results, while Vendor B's is within 1.5%.





















DESIGN AND EVALUATION EXAMPLE 4-22


                  Design the interface circuit in
                  Figure 4-57
                  so that 200 mW is delivered to the 500-Ω load.
                












FIGURE 4-57








SOLUTION:


The maximum power available from the 5-V source is





              which is less than the required 200-mW output. This means that the interface circuit must contain an active device that provides voltage gain. To determine the required voltage gain, we express the output power as
            




              which yields the required output voltage as
              
              . Since the input is a 5-V source, we need overall voltage gains of
              K
              = ±2. We can get these gains using either the noninverting amplifier or the inverting amplifier shown in the figure.
            

First Design


              The noninverting amplifier shown in the figure has very high input resistance; hence,
              i
1
              = 0 and
              υ
1
              = 5 V. To get a voltage gain of
              K
              = + 2, we need (1 +
              R
2
              /
              R
1
              ) = 2. Selecting
              R
1
              =
              R
2
              = 10 kΩ completes the design. Many other choices of resistors are possible.
            

Second Design


              The inverting amplifier shown in the figure has an input resistance of
              R
3
              ; hence, the input current is not zero, and
              υ
1
              = 5-50
              i
1
              < 5 V. In other words, the interface circuit loads the input source. However, if we specify that
              R
3
              ≫ 50 Ω, the effect of loading can be ignored since
              i
1
              ≈ 0 and the input voltage is essentially 5 V. Neglecting the effect of loading, a voltage gain of
              K
              = -2 requires
              R
4
              /
              R
3
              = 2. Selecting
              R
3
              = 25 kΩ and
              R
4
              = 50 kΩ completes the design. Many other choices of resistors are possible as long as
              R
3
              ≫ 50 Ω.
              ■













Exercise 4-33


              Using the circuits and analyses shown in Design
              Example 4-22
              , how much power is being provided by the signal source in each design? What is providing the power to the load?
            


Answers:



              In circuit 1 the signal source is providing zero power. In circuit 2 the signal source is providing
              p
S
              =
              υ
2
1
              /
              R
3
              W. In each case, the power for the load is being supplied by the OP AMP's ±V
              CC
              sources.
            




















DESIGN AND EVALUATION EXAMPLE 4-23

Design a circuit using OP AMPs that implements the input-output relationship










SOLUTION:


We will show two ways to solve this design problem and then discuss each design.


First Design


Rewriting the required input-output relationship as




              suggests an inverting summer with three inputs -
              υ
1
              , -
              υ
2
              , and
              υ
3
              with summing gains of -5, -4, and -2, respectively.
              Figure 4-58
              (a) is a block diagram of this approach and
              Figure 4-58
              (b) is an OP AMP circuit that implements the block diagram. This design requires three OP AMPs and eight resistors.
            


Second Design


Rewriting the required input-output relationship as




              suggests an inverting summer with two inputs [-2.5
              υ
1
              - 2
              υ
2
              ] and
              υ
3
              , both with a summing gain of -2. The input [-2.5
              υ
1
              - 2
              υ
2
              ] can be obtained using a second inverting
              
              summer whose inputs are
              υ
1
              and
              υ
2
              .
              Figure 4-58
              (c) is a block diagram of this approach and
              Figure 4-58
              (d) is an OP AMP circuit that implements the block diagram. This design requires two OP AMPs and six resistors.
            







FIGURE 4-58








Discussion:

This example illustrates again that there are often several ways to solve a given design problem. This leads to the question of how to choose between different design solutions. Candidate designs are evaluated using criteria beyond the fact that they implement a given signal-processing function. One common measure is to choose the design that uses the fewest components. Applying this "smallest part count" criteria in this example leads us to choose the second design.



                Using this criterion, it is important to understand the impact of part count on the cost of fabricating a circuit. Reducing part count does much more than simply reduce component costs. It also (and often more importantly) reduces printed circuit board or integrated chip space, assembly costs, packaging costs, testing, and logistics costs.
                ■


















Evaluation and Design Exercise 4-34



              There is a requirement for a circuit that implements the block diagram in
              Figure 4-59
              (a). A new intern proposed the solution in
              Figure 4-59
              (b). The breadboard prototype of this circuit failed to pass testing.
            

(a) Why did the prototype fail?
(b) Simplify the block diagram.
(c) Design a correct circuit from the simplified diagram.








FIGURE 4-59






Answers:

(a) First, the noninverter produces a gain of 11, not 10. Second, the gain from the noninverter into the inverting summer is -5, not -20. Third, the 5-V source is inverted resulting in a final value of +5 V instead of -5 V. And fourth, a common error for new students, the inverting summer has the "+" and "-" terminals reversed.

                (b) The desired output is
                υ
O
                = -210
                υ
1
                - 5 V. The simplified diagram is shown in
                Figure 4-59
                (c).
              

                (c) This simplified diagram can be designed with a single inverting summer. See
                Figure 4-59
                (d).
              










          4-6 OP AMP Circuit Applications
        
OP AMP circuits are fundamental building blocks in a wide range of signal-processing applications, especially instrumentation, status monitoring, process control, filtering, digital-to-analog conversion, and analog-to-digital conversion. This section provides a brief introduction to three of these applications.

Digital-to-Analog Conversion

            A digital-to-analog converter (DAC) has become a very common device. Its purpose is to convert digital signals—binary 1s and 0s—to an analog or continuous format. DACs are mixed-signal devices: the input to a DAC is a digital signal and the output is an analog signal. DACs are used extensively in robotics, audio applications, and communications, especially in highdefinition digital television and cell phone applications.
            Figure 4-60
            shows a simplified block diagram of this device along with photos of commercially available DACs. For the purpose of the following discussion, we will focus on four-bit devices, although typical devices are generally eight-bit, 10-bit, 12-bit, or even 32-bit. The block diagram in
            Figure 4-60
            (a) has a four-bit digital input (
            b
1
            ,
            b
2
            ,
            b
3
            ,
            b
4
            ) and analog output
            υ
O
            , and a fixed reference voltage
            V
REF
            . The input bits can each have only one of two values: a high or logic "1" or a low or logic "0." The input-output relationship of the four-bit converter can be written as follows:
          



(4-34)





            Bit
            b
1
            is called the most significant bit (MSB) because it carries the largest weight in this sum. Conversely, bit
            b
4
            is called the least significant bit (LSB) because it carries the smallest weight.
          







FIGURE 4-60



(a) A 4-bit digital-to-analog converter (DAC). (b) 8-bit digital-to-analog converter. (c) 32-bit digital-to-analog converter. (d) 16-bit digital-to-analog converter development board.




            For example, a four-bit DAC with
            K
            = 0.5 and
            V
REF
            = 10 V and a digital input (0, 1, 0, 1) produces an analog output of
          




            Similarly, inputs of (0, 1,1,1) and (1, 1, 0, 0) produce outputs of 4375 V and 7.5 V, respectively. With a four-bit converter, there are 2
            4
            = 16 possible input codes and hence 16 possible analog output levels. The
            full-scale output
            of a DAC is defined as the output when the input bits are all 1 (
            υ
O
            = 9.375 V in this example). The
            resolution
            of a DAC is defined as the change in the analog output caused by an input change of one LSB (0.625 V in this example). We can think of resolution as the voltage increment between adjacent output levels.
          

            The
            N
            -bit converter generalization of the four-bit input-output relationship in
            Eq. (4-34)
            is
          



(4-35)





            Integrated circuit DACs are available with inputs of
            N
            = 8 to
            N
            = 32 bits. Increasing the number of bits improves the conversion precision since the resolution is inversely proportional to 2
            
N
              -1
            
            . For this reason, DAC resolution is often somewhat loosely quoted in terms of bits.
          


            We can now discuss two OP AMP circuits that implement
            Eq. (4-35)
            for
            N
            = 4. The first method uses the four-input OP AMP summer in
            Figure 4-61
            . The summer inputs
            υ
1
            ,
            υ
2
            ,
            υ
3
            , and
            υ
4
            are applied to the binary-weighted input resistors
            R
            , 2
            R
            , 4
            R
            , and 8
            R
            , respectively. The output of the summer is related to these inputs by the input-output relationship in
            Eq. (4-29)
            .
          







FIGURE 4-61



A binary-weighted summer DAC.










FIGURE 4-62



AnR
                -
                2R ladder DAC.







            The input voltages are determined by switches controlled by the input bits
            b
1
            ,
            b
2
            ,
            b
3
            , and
            b
4
            . When a bit is low (0),the switch is in the lower position, connecting the related input to ground. When a bit is high (1), the switch is in the upper position, connecting the related input to the reference voltage
            V
REF
            . In other words, an input voltage is zero when its control bit is 0 and equal to
            V
REF
            when its control bit is 1. In effect, the input voltages are related to the input bits as
            υ
k
            =
            b
k
V
REF
            . As a result, we can write the summer output as
          




            This result is of the form of
            Eq. (4-35)
            with
            N
            = 4 and
            K
            = -
            R
F
            /
            R
            .
          

            A four-bit DAC can also be realized using the
            R
            - 2
            R
            ladder circuit in
            Figure 4-62
            . In this case the voltage inputs
            υ
1
            ,
            υ
2
            ,
            υ
3
            , and
            υ
4
            are applied to the 2
            R
            legs of the ladder. The OP AMP's noninverting input is connected to ground (
            υ
P
            = 0). Since
            υ
N
            =
            υ
P
            = 0, node A in
            Figure 4-62
            is a "virtual" ground. In other words, the
            R
            - 2
            R
            ladder is effectively shorted to ground at node A. The short-circuit current the ladder delivers to this virtual short can be shown to be
          




            Since node A is a virtual ground, the current through the feedback resistor is
            i
F
            =
            υ
O
            /
            R
F
            . For an ideal OP AMP,
            i
N
            = 0, so the KCL constraint at node A requires
            i
F
            +
            i
SC
            = 0, or
          




            Solving for
            υ
O
            leads to the following results:
          





            The input voltages
            υ
1
            ,
            υ
2
            ,
            υ
3
            , and
            υ
4
            are defined by the same switching arrangement as the inverting summer DAC in
            Figure 4-61
            . Hence, they are related to the input bits as
            υ

k

            =
            b

k

V
REF
            , and the output voltage becomes
          




            This result is of the form of
            Eq. (4-35)
            with
            N
            = 4 and
            K
            =
            R
F
            /2
            R
            .
          

            In theory, the four-bit inverting summer DAC in
            Figure 4-61
            could be extended to a larger number of bits. However, the range of input resistances rapidly gets out of hand. For example, a 10-bit DAC would require input resistances ranging from
            R
            to 1024
            R
            . With integrated circuit technology it is virtually impossible to maintain tight resistance tolerances over a wide range of resistance values.
          

            The four-bit
            R
            - 2
            R
            ladder DAC in
            Figure 4-62
            can be extended to a larger number of bits using only two values of resistance, namely
            R
            and 2
            R
            . The absolute value of
            R
            does not matter. What matters is that the added resistances stand in a two-to-one ratio. Controlling the ratio of two resistances is much easier to accomplish with integrated circuit technology than controlling the absolute value of a resistance. This fact accounts for the widespread use of
            R
            -2
            R
            ladder architecture in integrated circuit DACs.
          







Exercise 4-35



                The
                R
                - 2
                R
                ladder DAC in
                Figure 4-62
                has
                R
F
                = 40 kΩ,
                R
                = 10 kΩ, and
                V
REF
                = -3 V. Find the full-scale output and resolution of the converter.
              


Answers:


11.25V; 0.75V













Exercise 4-36

A student chooses to design a 6-bit weighted summer DAC for a project. The requirement is to have errors of 1% or less. What tolerance (accuracy) must the resistors used in the design have to meet the requirement?


Answers:



                Assume we can control the value for
                R
                in the design. Whatever value the designer chooses for
                R,
                the 32
                R
                resistor must meet the tolerance specification. Therefore, the tolerance for
                R
                is at most 0.03125%. An
                R
                - 2
                R
                design is likely the better option.
              







Instrumentation Systems

            One of the most interesting and useful applications of OP AMP circuits is for instrumentation systems that collect and process data about physical phenomena. This section is most useful to engineering disciplines of all types because whatever physical phenomenon needs to be sensed, it can be sensed successfully with electrical-output transducers. This then simplifies the processing of the sensed data. The
            instrumentation system
            typically connects an input transducer to a desired output in a meaningful way. An
            input transducer
            in this text is a device that converts some physical quantity, such as temperature, light intensity, stress, strain, pressure, rotation, acceleration, or velocity, to an electrical signal. In many applications, the end result of an instrumentation system provides a signal to an output transducer. An
            output transducer
            performs the opposite conversion of the input transducer by using electrical signals to generate a physical quantity such as an optical, audio, or mechanical response.
          

            In an instrumentation system, an input transducer generates an electrical signal that describes some ongoing physical phenomenon in a proportional way. The transducer signal is processed by OP AMP circuits studied here and provided to an output
            
            transducer for observation, recording, listening, or, very frequently, processing by an analog-to-digital converter (ADC). In the last case, the output of an ADC is usually sent to a computer or microprocessor. often the output signal can be used in a feedback control system to monitor, regulate, and control the physical process itself.
          







FIGURE 4-63



Transducer interface circuit.










FIGURE 4-64



Block diagram of typical instrumentation system.




            The starting point in instrumentation system design is the transducer. In general, there are two basic types of transducers:
            active transducers,
            which produce a voltage or current proportional to the physical parameter being sensed, and
            passive transducers,
            which change a parameter, such as resistance or conductance, in proportion to the physical parameter being sensed but do not directly produce an output voltage or current. Active transducers usually produce outputs that are quite small—in the millivolt or microvolt range or in the microampere or nanoampere range. Active transducers often need considerable amplification to make their signals useful. Passive transducers, on the other hand, often have effects that are more dramatic. A photoresistor, for example, can change the resistance over four, five, or even six orders of magnitude, but it does not produce an output on its own. Passive transducers need to have an external power source to produce a voltage or current that is proportional to the physical parameter.
          

            The block diagram in
            Figure 4-63
            shows an instrumentation system in its simplest form. The objective of the system is to deliver an output signal,
            υ
O
            , that is related to the physical quantity measured by the input transducer,
            υ
TR
            . In many instrumentation systems, the transducer is known and is assumed to be linear over the desired range of measurements. The desired output is also assumed to be linear. The task is to design the interface circuit between the input and output. Suppose the input transducer converts a physical variable
            x
            into an electrical voltage
            υ
TR
            . For many transducers this voltage is of the form
          




            where
            m
            is a calibration constant and
            b
            is a constant offset or
            bias.
            With active transducers, the voltage is usually quite small and must be amplified by some gain
            K
            to meet the needs of the rest of the system. The amplified signal includes a component proportional to the physical variable,
            K
            (
            mx
            ), and an amplified bias component,
            K
            (
            b
            ). We can introduce another bias voltage,
            V
b
            , to compensate for the
            K
            (
            b
            ) term and yield an output voltage,
            υ
O
            , which is aligned with the needs of the rest of the system.
            Figure 4-64
            is a block diagram of the typical signal processing steps that need to be designed. To summarize, the input transducer voltage,
            υ
TR
            , is amplified by
            K
            and then a bias voltage,
            V
b
            , is applied to make the signal the proper level for the output
            υ
O
            :
          



(4-36)





            The gain
            K

mx

            or simply
            K,
            is the ratio of the desired output voltage range to the available voltage range at the input transducer:
          



(4-37)





            A concern in calculating the desired
            K
            is getting the sign correct. In this regard, it is important to keep track of the limits of the range. To do so, it may be helpful to create a table similar to
            Table 4-1
            , where
            p
1
            and
            p
2
            are the physical values measured by the input transducer. The gain
            K
            is then calculated as
          









Table


4-1









Physical Range



                      Lower Physical Value,
                      
p

1




                      Upper Physical Value,
                      
p

2







                    Desired range for
                    υ
O


υ
O
                    (
                    p
1
                    )
                  

υ
O
                    (
                    p
2
                    )
                  



                    Available range at
                    υ
TR


υ
TR
                    (
                    p
1
                    )
                  

υ
TR
                    (
                    p
2
                    )
                  






            For example, if you are designing a system that will read the temperature from 0°C to 100°C and you want 0°C to produce 5 V and 100°C to produce 0 V, create a table similar to
            Table 4-2
            where
            υ
TR
            (0°) and
            υ
TR
            (100°) are the voltage signals the input transducer produces when the temperature is 0°C and 100°C, respectively. The gain is then computed as
          









Table


4-2









Physical Range


0°


100°






                    Desired Range for
                    υ
O


υ
O
                    (0°) = 5 V
                  

υ
O
                    (100°) = 0 V
                  



                    Available Range at
                    υ
TR


υ
TR
                    (0°)
                  

υ
TR
                    (100°)
                  




The physical range is shown above the gain equation for reference and to help keep the voltage values aligned correctly. If you wanted 100°C to produce 5 V and 0°C to produce 0 V, you would reverse the terms on the top of the ratio:





Active Transducers

            To put this procedure into practice, we will consider the specific example of an active transducer.
            Figure 4-65
            shows the characteristics of a light intensity transducer, a photodiode,
            
7

            for example, that converts luminance in the range from 200 to 1000 lumens/m
            2
            to an electrical signal in the range from 4 to 20 mV. The output of the interface circuit is required to drive an ADC whose full-scale input range is 0 to 5 V. The interface circuit must convert a range of 4 mV to 20 mV to a output range of 0 V to 5 V, respectively. We enter these values as shown in
            Table 4-3
            . Inserting these values into
            Eq. (4-36)
            gives
          










FIGURE 4-65



Photodiode transducer characteristics.









Table


4-3









Physical Range



                      200 lumens/m
                      2




                      1000 lumens/m
                      2







                    Desired range for
                    υ
O

0 V
5 V



                    Available range at
                    υ
TR

4 mV
20 mV






            Applying
            Eq. (4-37)
            and carefully aligning our range end points, we get
          




            Inserting this value of
            K
            into the first equation and solving for the bias gives
            V
b
            = −0.004
            K
            = −1.25 V. Thus, the interface circuit must implement an input-output relationship defined by
          



(4-38a)











FIGURE 4-66



Photodiode interface circuit realization: (a) Block diagram. (b) Circuit realization.










FIGURE 4-66



(c) Typical photodiodes.




            To design the interface circuit, we partition the required gain as
            K
            = (-25) × (−12.5) = 312.5. This allows us to get the overall gain of +312.5 using two inverting amplifier stages with gains of −25 and −12.5. We also rewrite the bias voltage as
            V
b
            = (-0.25)5 = -1.25 V. This allows us to get the required bias using an inverting gain of -0.25 and a standard 5-V power supply as the reference source. Inserting these results into
            Eq. (4-38a)
            yields
          



(4-38b)





Figure 4-66(a)
            shows a block diagram of
            Eq. (4-38b)
            while
            Figure 4-66(b)
            shows an OP AMP circuit that implements the block diagram. obviously this design is not unique since we can rearrange
            Eq. (4-38a)
            in many different ways.
            Figure 4-66(c)
            shows various photdiodes.
          














DESIGN AND EVALUATION EXAMPLE 4-24


                    Commercially available temperature transducers, for example, ther-mocouples,
                    
8

                    are shown in
                    Figure 4-67(a)
                    . A particular temperature transducer has the characteristics shown in
                    Figure 4-67
                    (b). Design an OP AMP circuit to interface the transducer output for temperatures ranging from -20°C to 120°C with a panel meter whose full-scale input range is 0 to 3 V. Use a standard 1.5-V battery as the reference source for the required bias. Develop two competing designs and discuss pros and cons of each.
                  












FIGURE 4-67








SOLUTION:



Figure 4-67(b)
                shows that the transducer output voltage ranges from 2.1 V to 0.42 V for the temperature ranging from -20°C to 120°C. The interface circuit must convert a range of 2.1 V to 0.42 V to a ranging of 0 V to 3 V, respectively. Inserting these values into
                Eq. (4-36)
                gives
              




                Calculating the gain
                K,





                Inserting this value of
                K
                into the first equation and solving for the bias gives
                V
b
                = -2.1
                K
                = 3.75 V. The bias voltage can be rewritten as
                V
b
                = 3.75 = (2.5)1.5 V, which means we need a gain of 2.5 to get the required bias from the specified 1.5-V battery reference source. Thus, the interface circuit must realize the following input-output relationship.
              



Looking at the required relationship, we can see that a subtractor circuit can realize the desired input-output relationship. We know two ways to design subtractor circuits—the basic one-OP AMP circuit and the two-OP AMP subtractor. We can design our circuit using each approach and compare the results.







FIGURE 4-67








First Design



                The required function is of the form
                υ
O
                = -
                K
1
υ
1
                +
                K
2
υ
2
                , where
                K
1
                = 1.786,
                υ
1
                =
                υ
TR
                ,
                K
2
                = 2.5, and
                υ
2
                = 1.5 V. This function can be realized using the basic subtractor
                
                building block in
                Figure 4-68
                (a). Equation (4-32) relates the two gains to the sub-tractor circuit parameters as
              




                The gain
                K
1
                = 1.786 can be realized by selecting
                R
2
                = 10 kΩ and
                R
1
                = 0.56
                R
2
                = 5.6kΩ. Using these values in the
                K
                2 equation produces
              




                Solving for
                R
4
                yields
                R
4
                = 8.75
                R
3
                . Selecting
                R
3
                = 1 kΩ requires that
                R
4
                = 8.75 kΩ. This completes the first design. Obviously, many other choices are possible.
              







FIGURE 4-68








Second Design



                The required function
                υ
O
                = -
                K
1
υ
1
                +
                K
2
υ
2
                can also be realized using the two-OP AMP subtractor shown in
                Figure 4-68
                (b). This circuit is analyzed in
                Example 4-19
                , where the two gains are related to circuit parameters as
              




                The gain
                K
2
                = 2.5 can be realized by selecting
                R
3
                = 10 kΩ which requires
                R
4
                = 1.5
                R
3
                = 1.5 kΩ. Using these values in the
                K
1
                equation gives
              




                Solving for
                R
1
                yields
                R
1
                = 5.25
                R
2
                . Selecting
                R
2
                = 10 kΩ, requires that
                R
1
                = 52.5 kΩ. This completes the second design. Many other choices are possible.
              


Discussion:


                  In terms ofparts count, both designs use four resistors. The first design uses a one-OP AMP subtractor while the second design uses the two-OP AMP version. This difference makes the first design the best choice under a "smallest parts count" criteria. However, with the two-OP AMP subtractor, both input signals are applied directly to noninverting OP AMP
                  
                  inputs. These inputs have very high input resistances, which means that the second design does not load the transducer or drain energy from the
                
                1.5-V
                battery. This difference could be an important advantage of the second design if the transducer has a high Thévenin resistance or if the interface circuit must operate for extended periods of time with no servicing of the battery.
■














                Design
                Exercise 4-37


                Active pressure transducers often use piezoelectric crystals to convert pressure to an electrical signal.
                Figure 4-69(a)
                shows a few examples. The metal cylinders typically have a crystal inside exposed to the gas or fluid whose pressure needs to be measured.
              
In this exercise, a particular pressure transducer must be connected to a boiler. The selected transducer is linear between 100 and 1000 psi. Specifically, it has the following characteristics: At 100 psi it produces 10 iiV, and at 1000 psi it produces 100 V. The output needs to be connected to a 0-10-V meter so that 100 psi will give a reading of 0 V and 1000 psi a reading of 10 V. Design a suitable interface using OP AMPs that have a maximum closed-loop gain of 2000.
Validate your design using Multisim.


Answer:



K
                = 111, 111 and
                V
b
                = - 1.11 V. One of many possible solutions is shown in
                Figure 4-69(b)
                . Multisim results are shown in
                Figures 4-69
                (c) and
                (d)
                .
              












FIGURE 4-69













FIGURE 4-69










            Passive Transducers
          

            As mentioned previously, passive transducers require an external source to produce a voltage or current that is proportional to the physical parameter being measured. Photoresistors, thermistors, strain gauges, and rotation sensors, e.g. potentiometers, are but a few of the passive transducers that use a variance in resistance to sense a physical parameter.
            Figure 4-70
            shows photos of some passive transducers. In all cases let us look at how the resistance varies with the physical parameter.
          







FIGURE 4-70




                  Passive transducers: (a) Photoresistors.
                  
9

                  (b) Strain gauges.
                









FIGURE 4-70



                  (c) Thermistors
                  
10

                  . (d) Potentiometer.
                





            There are two ways to apply an external source to a passive transducer. The first is using a simple voltage divider, shown in
            Figure 4-71
            (a). This technique is useful when the accuracy of the sensor is not critical and the change in parameter value is significant, as with photoresistors, thermistors, or rotational devices such as potentiometers. The second approach is to use a bridge circuit as shown in
            Figure 4-71
            (b). This technique allows for very precise measurement of small changes in parameter values, such as those created by strain gauges. Let us see an example of each approach.
          







FIGURE 4-71



Methods for adding an external voltage to passive transducers: (a) voltage divider. (b) Wheatstone bridge circuit.















                    DESIGN
                    EXAMPLE 4-25



                    A particular photoresistor varies from 10 MΩ in total darkness to 10 kΩ in bright light. Design an interface system that will produce 5 V when the photoresistor senses bright light and 0 V when it is in total darkness. Show that the design works using Multisim.
                  








SOLUTION:



                Since the photoresistor varies over three orders of magnitude, we can use the voltage divider method shown in
                Figure 4-71
                (a). We select a 10-V source in series with a 10-kΩ reference resistor and the photoresistor as shown in
                Figure 4-72
                (a). The reason for this choice becomes more apparent if we look at the Thévenin equivalent of the circuit as shown in
                Figure 4-72
                (b).
              







FIGURE 4-72







                The Thévenin voltage
                υ
T
                varies from 5 V in bright light to about 10 V in darkness and the Thévenin resistance
                R
T
                varies from 5 kΩ to about 10 kΩ, respectively. These values simplify the design of the interface circuit; namely, the interface circuit must convert a range of 5 V to 10 V to an output range of 5 V to 0 V.
              

                Inserting these values into
                Eq. (4-36)
                gives
              




                Applying
                Eq. (4-37)
                and aligning our range end points, we get
              



The bias is readily calculated as +10 V.

Figure 4-73(a)
                shows a possible interface circuit. Note that the 10-V bias was inverted so that it will add as a positive value. If this is not possible, use an inverter
                
                to change the sign of the bias before applying it to the summer. The large 10-MΩ resistors avoid loading the input to the inverter. Multisim shows the result of the simulation in
                Figure 4-73(b)
                . Note that the output is not linear.
                ■













FIGURE 4-73















                Design and Evaluation
                Exercise 4-38

Use a subtractor to design the interface for the example above. Use Multisim to validate your design. Which is the better design? Explain.


Answer:



                See
                Figure 4-73(c)
                and
                (d)
                . The summer solution has one less resistor, but the subtractor uses a +10 V bias. If a -10 V bias is readily available, the summer is the best solution, otherwise the subtractor is.
              












FIGURE 4-73













                Design
                Exercise 4-39

A 2-kΩ potentiometer is connected to the flaps of an unmanned aerial vehicle (UAV), or drone, to detect their position. When the flaps are at their maximum upward extension of +45°, the potentiometer is at its maximum resistance of 2 kΩ; when the flaps are flat or 0°, the potentiometer is set at 1 kΩ; and when the flaps are at their minimum downward extension of -45°, the potentiometer is at its minimum resistance of 0kΩ. Design an interface to a 0-5 V ADC that gives +45° at 5 V and -45° at 0 V.


Answer:



                One possible design is shown in
                Figure 4-74
                . If there is a concern about loading the input to the ADC, insert a buffer after the potentiometer. Sometimes simplicity is the best solution.
              












FIGURE 4-74






The next example demonstrates the use of a bridge circuit to detect small changes in a passive transducer.













                    DESIGN
                    EXAMPLE 4-26

A strain gauge is a resistive device that measures the elongation (strain) of a solid material caused by applied forces (stress). A typical strain gauge consists of a thin film of conducting material deposited on an insulating substrate. When the gauge is bonded to a member under stress, or bent, its resistance changes by




                    where
                    R
G
                    is the resistance of the gauge with no applied stress and Δ
                    L
                    /
                    L
                    is the elongation of the material expressed as a fraction of the unstressed length
                    L
                    . The change in resistance Δ
                    R
                    is only a tenth of an ohm or so, which is far too little to be measured with an ohmmeter. To detect such a small change, the strain gauge is placed in a Wheatstone bridge circuit like the one shown in
                    Figure 4-71
                    (b). The bridge contains fixed resistors
                    R
A
                    and
                    R
B
                    , two matched strain gauges
                    R
G1
                    [the reference resistor in
                    Figure 4-71
                    (b)] and
                    R
G2
                    [the passive transducer or sensor in
                    Figure 4-71
                    (b)], and a precisely controlled reference voltage
                    V
REF
                    . The values of
                    R
A
                    and
                    R
B
                    are chosen so that the bridge is balanced (
                    υ
TR
                    = 0) when no stress is applied. When stress is applied, the resistance of the stressed gauge changes to
                    R
G2
                    + Δ
                    R
                    and the bridge is unbalanced (
                    υ
TR
                    ≠ 0). The differential signal (
                    υ
TR
                    ) indicates the strain resulting from the applied stress. See
                    Figure 4-75
                    .
                  

                    Design an OP AMP circuit to translate strains in the range 0 < Δ
                    L/L
                    < 0.02% into an output voltage in the range 0 V <
                    υ
O
                    < 5 V, for
                    R
G
                    = 120 Ω and
                    V
REF
                    = 25 V.
                  












FIGURE 4-75








SOLUTION:



                With external stress applied, the resistance
                R
G2
                changes to
                R
G2
                + Δ
                R
                . Applying voltage division to each leg of the bridge yields
              




                The differential voltage (
                υ
2
                -
                υ
1
                ) =
                υ
TR
                can be written as
              




                To achieve bridge balance in the unstressed state, we select
                R
G1
                =
                R
G2
                =
                R
A
                =
                R
B
                =
                R
G
                , in which case the differential voltage reduces to
              




                Thus, the differential voltage is directly proportional to the strain Δ
                L/L.
                However, for
                V
REF
                = 25 V and Δ
                L/L
                = 0.02%, the differential voltage is only (
                V
REF
                ) (Δ
                L/L
                ) = 25 × 0.0002 = 5 mV. To obtain the required 5-V output we need a voltage gain of 1000:
              




                The bias voltage,
                V
b
                , is zero in this case.
                








FIGURE 4-76







                The OP AMP subtractor is specifically designed to amplify differential signals. Selecting
                R
1
                =
                R
3
                = 10 kΩ and
                R
2
                =
                R
4
                = 10 MΩ produces an input-output relationship for the subtractor circuit of
              




Figure 4-76
                shows the basic design.
              
The input resistance of the subtractor circuit must be large to avoid loading the bridge circuit. The Thévenin resistance looking back into the bridge circuit is as follows:



This value is small compared with the 10-kΩ input resistance of the subtracter's inverting input.


Discussion:


                  The transducer in this example is the resistor R
                  G2
                  . In the unstressed state, the voltage across this resistor is υ
                
2
                = 12.5 V.
                
                  In the stressed state the voltage is
                  υ
2

                = 12.505 V.
                In other words, the transducer's
                5-mV
                signal component is accompanied by a very large bias. We cannot amplify the
                12.5-V
                bias component by K
                = 1000
                
                  before subtracting it out since it will saturate the OP AMP. By using a bridge circuit in which υ
                  1

                = 12.5V,
                
                  the bias is eliminated at the input and the OP AMP processes the differential signal
                  υ
2
                  -
                  υ
1
                  =
                  υ
TR

                .
                The situation illustrated in this example is actually quite common. Consequently, the first amplifier stage in most instrumentation systems is a differential amplifier that removes the transducer bias.
■














Exercise 4-40


                Using the circuit shown in
                Figure 4-76
                , simulate the effect in Multisim varying the strain gauge
                R
G2
                from 120 Ω to 120 1 Ω in increments of 0.001 Ω. Plot the resulting output versus percent of stress (Δ
                L/L
                ).
              


Answer:



                See
                Figure 4-77
                .
                













FIGURE 4-77













                  APPLICATION
                  EXAMPLE 4-27



                Instrumentation amplifiers are used as we have seen to provide signal processing of gain and bias to transducer outputs in preparation for use in ADC and other output devices. A well-designed instrumentation amplifier provides very high gain, very high common-mode rejection ratio, and very high input resistance, among other more subtle features best left for future study. Using active transducers can be difficult if they have a high source resistance or a source resistance that varies with the transducer's output voltage. A traditional differential amplifier shown in
                Figure 4-46
                has the potential problem of loading the transducer because of its finite input resistance. A better solution is a two-stage configuration using the OP AMP circuit analyzed in
                Example 4-20
                followed by a differential amplifier, as shown in
                Figure 4-78(a)
                .
              

                The instrumentation amplifier consists of two differential amplifiers each with a potential gain. The first stage acts like a pair of buffers (remove
                R
g
                and that can be easily seen) to provide a very high input resistance thereby minimizing loading problems. The second stage is a common differential amplifier that enables easy resistance connection to the output. Both stages can have gain. The first stage's gain was found in
                Example 4-20
                as
                
                , while the second stage has gain
                K
2
                =
                K
                . A necessary condition for a high-quality instrumentation amplifier is a high common mode rejection ratio (CMRR). The CMRR of a differential amplifier measures the ability of the amplifier to reject input signals common to both inputs. A high CMRR
                
                is important in applications where the signal of interest, say, the transducer'ssmall voltage change, is superimposed on a larger voltage offset, or when the key information is contained in the voltage difference between two signals. To ensure this quality, the resistors
                R
                must be carefully matched. If not, the gain of one input side over the other could mask the actual information change desired. Since most instrumentation amplifiers are manufactured on a single semiconductor chip, resistors can be made nearly identical and, if necessary, laser-trimmed. An interesting and useful feature is that the resistor
                R
g
                can be external of the chip and a potentiometer used to vary the gain. Since this resistance occurs only once in the gain relationship, it does not need to be carefully matched. The advantages of this two-stage configuration are that the input has very high input resistance and the two stages can help distribute the gain if a very high gain is needed. Many commercial manufacturers employ this architecture for their instrumentation amplifiers, such as Analog Devices, Linear Technology, Maxim Integrated Products, National Semiconductor, and Texas Instruments.
              







FIGURE 4-78







                As a real example, consider just one of hundreds of instrumentation amplifiers available: the Analog Devices Low-Cost Low Power Instrumentation Amplifier
                AD620.
                The amplifier is small and is packaged in an 8-lead PDIP as seen in
                Figure 4-78(b.)
                The amplifier's pin-out is shown in
                Figure 4-78(c)
                . Note that pins are readily available for the user to select and connect
                R
G
                external to the chip to control its gain. Its spec sheet shows a comparison of AD620 to a "Homebrew" design (
                Figure 4-78(d)
                ), which is very similar to the one in
                Figure 4-78(a)
                that we are studying. Their design being manufactured on a single wafer with some enhancements results in improved specs but is overall similar. The comments extracted verbatim from their spec sheet state:
              





                        The AD620 is a monolithic instrumentation amplifier based on a modification of the classic three OP AMP approach. Absolute value trimming allows the user to program gain accurately (to 0.15% at G = 100) with only one resistor. Monolithic construction and laser wafer trimming allow the tight matching and tracking of circuit components, thus ensuring the high level of performance inherent in this circuit.
                        












FIGURE 4-78




















                Design
                
                  Exercise 4-41
                  



                Design an instrumentation amplifier using the configuration of
                Figure 4-78
                that has a gain of 10
                5
                . Let
                R
TR
                = 100 Ω. Note that no single stage can have a gain greater than 10
                4
                . Verify your solution using Multisim.
              


Answer:



                Choose
                R
                = 10 kΩ,
                KR
                = 5 MΩ,
                R
g
                = 100 Ω as one possible solution. See Multisim simulation in
                Figure 4-79
                .
              







FIGURE 4-79















            Comparator Circuits
          

            A comparator is a mixed-signal device whose digital output is either high or low depending on the relative amplitudes of two analog inputs. For example, the open-loop (no feedback) OP AMP circuit in
            Figure 4-80
            functions as a comparator. In the absence of feedback, the OP AMP is driven into one of its two saturation modes by the analog inputs
            υ
P
            and
            υ
N
            . Specifically, if
            υ
P
            >
            υ
N
            , the OP AMP is in positive saturation with
            υ
O
            = +
            V
CC
            . Conversely, if
            υ
P
            <
            υ
N
            , the OP AMP is in negative saturation with
            υ
O
            = -
            V
CC
            .
          

            In digital logic terminology, the comparator output is said to be a logic high (1) when
            υ
P
            >
            υ
N
            and a logic low (0) when
            υ
P
            <
            υ
N
            . The output voltage levels associated with the high and low states are usually denoted as
            V
OH
            and
            V
OL
            , respectively. These levels are determined by the positive and negative power supply voltages, which can be different from the ±15 V commonly used in linear applications of OP AMPs. A useful comparator power configuration uses a unipolar supply of 0 and +5 V, which allows for an immediate interface to digital logic. Although the standard OP AMPs discussed for linear operation, such as the uA741 studied earlier, can be used in comparator applications, they are not ideal for switching between ±
            V
CC
            because of the slow switching times. Comparator families such as the LM111 are designed expressly for comparator applications.
          













DESIGN EXAMPLE 4-28


                    A commercial oven that heats a critical product cannot exceed a predetermined temperature. A temperature sensing thermocouple circuit produces a voltage proportional to the oven temperature. The output voltage varies linearly from 0 V at 0°C to 12 V at 1000°C. Design a circuit that will detect when a set temperature is exceeded and will output 0 V. That output will then shut off the +15-V power to the relay that is normally ON and controls the 240-V power to the oven. once the relay trips, it needs to be reset manually.
                    Figure 4-81
                    (a) shows the diagram of the task.
                  












FIGURE 4-80



(a) An OP AMP comparator. (b) An image of a TI LM111 Comparator. (c) Multisim circuit symbol for a comparator.










FIGURE 4-81









SOLUTION:



                The comparator circuit in
                Figure 4-81
                (b) is used to detect whenever the signal applied to
                υ
N
                goes above a preset voltage that is connected to
                υ
P
                . The preset voltage is controlled by a potentiometer that outputs 0-15 V depending on how it is set. Whenever the temperature of the oven exceeds the set threshold temperature, the comparator switches and the relay trips, which turn off the oven. An example isshowninFigure4-81(c). The desired maximum temperature
                V
REF
                is set to produce 10 V. Starting at room temperature the oven heats up the thermocouple circuit and outputs an increasing voltage
                υ
temp
                . When the temperature in the oven reaches the set temperature, the comparator outputs 0 V and the oven starts to cool off.
                ■













Exercise 4-42


                Find the comparator output voltage in
                Figure 4-82
                for the following:
              



                    (a)
                    υ
1
                    = 2 V,
                    υ
2
                    = 3 V,
                    V
CC
                    = 5 V
                  



                    (b)
                    υ
1
                    = 0 V,
                    υ
2
                    = −3 V,
                    V
CC
                    = 10 V
                  



                    (c)
                    υ
1
                    = −2 V,
                    υ
2
                    = −3 V,
                    V
CC
                    = 3 V
                  


Answers:



                    (a)
                    υ
O
                    = 0 V; (b)
                    υ
O
                    = 10 V; (c)
                    υ
O
                    = 3 V
                  














FIGURE 4-82







Figure 4-83
            (a) shows a comparator circuit often called a
            zero-crossing detector.
            A time-varying analog signal is applied to the noninverting input [
            υ
P
            =
            υ
S
            (
            t
            )], and the inverting input is connected to ground (
            υ
N
            = 0). In this configuration the comparator output is
            υ
O
            = +
            V
CC
            when
            υ
S
            (
            t
            ) > 0 and
            υ
O
            = -
            V
CC
            when
            υ
S
            (
            t
            ) < 0.
            Figure 4-83
            (b) shows plots of the input and output signals versus time for
            υ
S
            (
            t
            ) = 10 sin(π
            t
            ) V and
            V
CC
            = 15 V. In digital logic terms, the comparator output changes state (toggles) whenever the analog input passes through zero; hence the name
            zero-crossing detector.
            This circuit is also called a
            polarity detector
            because the digital output is high when the polarity of the analog input is positive and low when the polarity is negative.
          







FIGURE 4-83



Zero-crossing detector: (a) Circuit. (b) Signals.




            A modified version of the zero-crossing detector is shown in
            Figure 4-84
            (a). A time-varying analog signal is still applied to the noninverting input [
            υ
P
            =
            υ
S
            (
            t
            )] as
            

            before, and the modification connects a fixed reference voltage to the inverting input (
            υ
N
            =
            V
REF
            ). In this configuration the comparator output is
            υ
O
            = +
            V
CC
            when
            υ
S
            (
            t
            ) >
            V
REF
            and
            υ
O
            = -
            V
CC
            when
            υ
S
            (
            t
            ) <
            V
REF
            . In effect the applied reference voltage shifts the switching threshold from zero to
            V
REF
            .
            Figure 4-84
            (b) shows how the threshold shift changes the output signal for
            υ
S
            (
            t
            ) = 10sin(π
            t
            ) V,
            V
CC
            = 15 V, and
            V
REF
            = 5 V.
          







FIGURE 4-84



Modified zero-crossing detector: (a) Circuit. (b) Signals. (c) Multisim circuit. (d) Input/output waveforms.




            Multisim allows us to simulate the same circuit using the virtual comparator model.
            Figure 4-84
            (c) shows the circuit. The COMPARATOR_VIRTUAL needs to be set to the parameters of the problem. Click on the symbol and a window comes up. Select "Value." We need to set the Positive and Negative supply voltages. In this problem, we set them at +15 V and −15 V. You can ignore all the other settings for this problem. For the input, select the AC_VOLTAGE from the SIGNAL_VOLTAGE_SOURCES not the AC_POWER from the POWER_SOURCES. This will be clear in the next chapter on signals. Click on the source and set the parameters of the ac voltage as follows: Voltage (Pk) 10 V and Frequency (F) 50 Hz. Disregard the rest. Under "Simulate," select "Transient" since we want to view the response versus time. Set the End time (STOP) at 0.05 s. And to smooth the curve, select the Maximum time step (TMAX) at 1e-06 s. Then go to output and select the three curves we want to see: The 10 V sinusoidal input signal voltage vIN, the reference signal voltage vREF (5 V), and the comparator output vOUT. Select "RUN" and Grapher View will display the graph shown in
            Figure 4-84
            (d).
          


Analog-to-Digital Converter (ADC)

            An analog-to-digital converter (ADC) is a mixed-signal device that converts an analog input into a multibit digital output.
            Figure 4-85
            is a block diagram ofan ADC with an analog input
            υ
S
            (
            t
            ), a four-bit digital output (
            b
1
            ,
            b
2
            ,
            b
3
            ,
            b
4
            ), and a fixed reference voltage
            V
REF
            . The output bits can have only one of two values: a high (1) or a low (0). The code used by these bits to represent the analog input depends on the architecture of the ADC.
          







FIGURE 4-85



An analog-to-digital converter (ADC).




            The circuit in
            Figure 4-86
            (a) is a four-comparator ADC that converts the analog input
            υ
S
            (
            t
            ) into a four-bit digital output. The analog input is applied to the noninverting input of each of the comparators. A fixed reference voltage is applied to a voltage divider string. Successive taps on the voltage divider supply a reference voltage to the inverting input of the comparators. These reference voltages are all different, and each is larger than the reference voltage of the comparator immediately below it.
          

            The output of any one comparator is high (1) when the analog input exceeds its applied reference voltage; otherwise it is low (0). When
            υ
S
            (
            t
            ) < 0.2
            V
REF
            , the input is smaller than all of the reference voltages, so the digital output is (0,0,0,0). When 0.2
            V
REF
            <
            υ
S
            (
            t
            ) < 0.4
            V
REF
            , the digital output is (0,0,0,1). In this range, the input exceeds the reference voltage of the lower comparator, so its output switches to
            b
4
            = 1. The outputs of the other comparators remain at zero since the input is smaller than their reference voltages. When 0.4
            V
REF
            <
            υ
S
            (
            t
            ) < 0.6
            V
REF
            , the output is (0,0,1,1) because the input exceeds the reference voltages of the bottom two comparators but not the top two. These observations reveal a pattern that is summarized in
            Table 4-4
            .
          

            The circuit in
            Figure 4-86
            (a) is called a
            flash converter
            because the comparators operate in parallel and the conversion takes place almost instantaneously. The circuit divides the input amplitude range into five bins and converts each bin into a unique four-bit code. The
            full-scale input range
            is the voltage range over which
            
            the input amplitude falls within one of the bins (0 to
            V
REF
            in this example). This range can obviously be increased by increasing the reference voltage. The price of doing so is reduced
            resolution,
            defined as the largest input voltage change that falls entirely within one bin (0.2
            V
REF
            in this example). Resolution can be improved by expanding the voltage divider string and adding more comparators. Some integrated circuit flash converters have as many as 256 comparators. An example of an eight-bit flash converter is shown in
            Figure 4-86
            (b).
          






Table


4-4










Digital Outputs




Analog Input Range



b
1




b
2




b
3




b
4







                    0 <
                    υ
S
                    < 0.2
                    V
REF

0
0
0
0



                    0.2
                    V
REF
                    <
                    υ
S
                    < 0.4
                    V
REF

0
0
0
1



                    0.4
                    V
REF
                    <
                    υ
S
                    < 0.6
                    V
REF

0
0
1
1



                    0.6
                    V
REF
                    <
                    υ
S
                    < 0.8
                    V
REF

0
1
1
1



                    0.8
                    V
REF
                    <
                    υ
S
                    <
                    V
REF

1
1
1
1





            The pattern of 1s and 0s in
            Table 4-4
            is called a
            thermometer code
            because the number of 1s increases monotonically as
            υ
S
            increases, like the way the mercury column in a thermometer increases with temperature. Integrated circuit flash converters have built-in decoders that convert the thermometer code into a standard binary code. The flash converter is by far the fastest ADC architecture.
          







FIGURE 4-86



(a) Flash ADC diagram. (b) Eight-bit flash ADC IC.










Exercise 4-43



                The reference voltage in
                Figure 4-86
                (a) is
                V
REF
                = 15 V. What are the output codes corresponding to
                υ
S
                = 1, 2, 5, 10, and 14 V?
              


Answers:


(0,0,0,0); (0,0,0,0); (0,0,0,1); (0,1,1,1); (1,1,1,1)

















                    APPLICATION
                    EXAMPLE 4-29


                    A last example on analog-to-digital conversion shows how an analog signal is converted to digital and then reconverted back to its analog form.
                    Figure 4-87
                    shows the basic process. We will use six bits to demonstrate this example.
                  







SOLUTION:



                For our input, we will use a triangular wave. This waveform will be studied along with many others in the next chapter. We will build our ADC and DAC in Multisim as shown in
                Figure 4-88(a)
                . Starting with the ADC, we will use six-bit for more resolution. We will use a
                V
REF
                of 14 V so that the input to each comparator is 2 V different from the next. For our input
                υ
S
                (
                t
                ), we choose from the place Component under SIG-NAL_V0LTAGE_S0URCES the TRIANGULAR VOLTAGE. Clicking on the circuit element under "Value," we set up the source so that its amplitude is 14 V, its period is 1 s, and its Fall time is 0.5 s. This will allow the output to start at 0 V rise to 14 V in half a second and return to 0 V in another half second. During that time, our ADC will sense when the voltage reaches 2 V, 4 V, 6 V, 8 V, 10 V, and 12 V. Each comparator output (b
                1
                , b
                2
                ...b
                6
                ) is either a logic 1 (5 V) or a logic 0 (0 V). For this example, these are connected directly to their respective inputs on the DAC. For
                
                the DAC, we use a six-bit
                R
                -2
                R
                configuration. Since the DAC inverts the output, we invert it back through a second inverter and use a
                K
                of 2.
              







FIGURE 4-87













FIGURE 4-88







                To run the simulation, we open "Analyses and simulation" and select "Transient." We set the Start time at 0 s and the End time after one cycle of the triangular wave at 1 s. The maximum step time of 10 us is adequate. For the Output, we select the input
                
v
S

                and the output
                
v
O

                . We then run the simulation.
                Figure 4-88(b)
                is the result. The triangular wave is roughly simulated by the stepped output, but it is not very accurate.
                
                Even a six-bit ADC provides relatively poor resolution. Audio systems use a 24-bit ADC and some purists even use a 32-bit ADC. Also note that because we are using the thermometer code approach for encoding the signal, the step sizes in the output waveform are not uniform. other approaches for encoding the signal will reduce the error between the input and output signals.
              







FIGURE 4-88







                Finally, we can plot the input versus each of the ADC comparator outputs. Each comparator switches from 0 to 5 V when its reference voltage is reached, 2 V, 4 V...12 V. We can see that progression occurring in
                Figure 4-88(c)
                .
                ■











          Summary
        


            A
            linear dependent source
            generates a voltage or a current whose value is proportional to a voltage or current at another point in a circuit. There are four such sources: the current-controlled voltage source, the voltage-controlled voltage source, the current-controlled current source, and the voltage-controlled current source.
          
Circuits containing dependent sources can be analyzed by node-voltage or mesh-current methods. Such circuits can have input-output relationships that produce voltage, current, or power gain. The presence of feedback can dramatically influence the input and output resistances of active circuits.

            The OP
            AMP
            is an active device with five terminals called the inverting input, the noninverting input, the output, and two power supply terminals. The device is a high-gain differential amplifier with three possible operating modes: +saturation, -saturation, and linear. The output predicted by the linear mode circuit model is compared with known bounds to determine the actual operating mode.
          

            The ideal OP AMP model has an infinite voltage gain, an infinite input resistance, and zero output resistance. The
            i
            -
            υ
            characteristics of an ideal OP AMP are
            i
P
            =
            i
N
            = 0 and
            υ
P
            =
            υ
N
            . The ideal model is a good working approximation in linear applications.
          

            The four basic OP AMP circuit building blocks are the
            inverting amplifier,
            the
            noninverting amplifier,
            the
            inverting summer,
            and the
            subtractor.
            The analysis or design of complex OP AMP circuits can be based on these four building blocks provided the interconnections are made between the output of one to the input of another.
          
Important applications of OP AMPs include interface circuits, digital-to-analog converters, instrumentation systems, and comparator circuits.
Multisim is useful in verifying and visualizing OP AMP designs.





          Chapter 4 Problems
        






              Objective 4-1 Linear Active Circuits (
              Sects. 4-1
              , and
              4-2
              )
            
Given a linear resistance circuit containing dependent sources, find selected output signals, input-output relationships, or input-output resistances.

              See
              Examples 4-1
              to
              4-11
              and
              Exercises 4-1
              to
              4-14
              .
            







4-1
            Find the voltage gain
            υ
O
            /
            υ
S
            and current gain
            i
O
            /
            i
X
            in
            Figure P4-1
            for
            r
            = 20 kΩ.
            






FIGURE P4-1








4-2
            Find the voltage gain
            υ
O
            /
            υ
1
            and the current gain
            i
O
            /
            i
S
            in
            Figure P4-2
            . For
            i
S
            = 10 mA, find the power supplied by the input current source and the power delivered to the 2-kΩ output resistor.
            






FIGURE P4-2










4-3
            For the circuit in
            Figure P4-3
            :
            

(a)
                Formulate node-voltage equations, do not solve them.
              

(b)
                Perform a source transformation on the input and dependent-source circuits and then formulate a mesh-current analysis of the modified circuit, but do not solve.
              

(c)
                Use whichever approach is simplest and solve for
                υ
O
                and
                i
O
                .
              

(d)
                Let
                i
S
                = 1 mA and use Multisim to simulate both circuits. Do you get the same results?
              








FIGURE P4-3








4-4
            Find the voltage gain
            υ
O
            /
            υ
S
            in
            Figure P4-4
            .
            






FIGURE P4-4








4-5


(a)
                Find an expression for the current gain
                i
O
                /
                i
S
                in
                Figure P4-5
                (a).
              

(b)
                Find an expression for the current gain
                i
O
                /
                i
S
                in
                Figure P4-5
                (b).
              

(c)
                Simulate both circuits in Multisim.
                

Note:


                Both of these circuits emulate simple transistor configurations. In (a), the circuit is called a common emitter configuration and is often used as a Follower. In (b), the transistor is connected as a common base configuration and is used to provide current gain.
                






FIGURE P4-5










4-6


(a)
                Find the voltage
                υ
O
                in
                Figure P4-6
                .
                


(b)
                Validate your answer by simulating the circuit in Multisim.
                






FIGURE P4-6













4-7


(a)
                Find an expression for the gain
                i
O
                /
                υ
S
Figure P4-7
                in terms of
                R
X
                .
              

(b)
                Select a value for
                R
X
                so that the gain is -0.002.
              

(c)
                Simulate the circuit in Multisim and perform a parameter sweep on
                R
X
                from 10 Ω to 10 MΩ and using the cursor to find the required value of
                R
X
                . How does your answer compare with part (b)?
                






FIGURE P4-7











4-8


(a)
                Find an expression for the voltage gain
                υ
O
                /
                υ
S
                in
                Figure P4-8
                .
              

(b)
                Let
                R
S
                = 1 kΩ,
                R
L
                = 100 Ω and μ = 50. Find the voltage gain
                υ
O
                /
                υ
S
                as a function of
                R
F
                . What is the voltage gain when
                R
F
                is an open circuit, a short circuit, and for
                R
F
                = 100 Ω?
              

(c)
                Simulate the circuit in Multisim and perform a parameter sweep on
                R
F
                from 0.1 Ω to 10 kΩ. Use the cursor to find your output at
                R
F
                = 100 Ω. How does your answer compare with part (b)?
                






FIGURE P4-8












4-9
            Consider the dependent source circuit of
            Figure P4-9
            .
            

(a)
                Find a relationship between the transconductance
                g
                and the output
                v
O
                .
              

(b)
                Use this relationship to find the value of
                g
                that would give
                v
O
                = 1 V, 5 V, and 10 V.
              

(c)
                Validate your answers using Multisim. Use the parameter sweep on the dependent source. Assume that
                g
                can vary from 0.01 S to 10 S. Plot
                v
O
                vs
                g
                .
                






FIGURE P4-9










4-10
            Find the Thévenin equivalent circuit that the load
            R
L
            sees in
            Figure P4-10
            . Repeat the problem with
            R
F
            replaced by an open circuit.
            






FIGURE P4-10









4-11
            For the circuit in
            Figure P4-11
            :
            

(a)
                Find the Thévenin equivalent circuit that the load
                R
L
                sees.
              

(b)
                Then if
                R
P
                =
                R
S
                =
                R
L
                = 200Ω,
                r
                = 5 kΩ, and
                υ
S
                = 2 V, find the power delivered to the load resistor.
                






FIGURE P4-11










4-12

            You are a teaching assistant and you administered a quiz for your instructor. The quiz asked the students to find the input resistance to the circuit in
            Figure P4-12
            . One of your students said the answer is trivial. No input means that the dependent source was off, and since it is a current source, it would be an open circuit. Hence, the answer is obviously 2kΩ. Is the student correct?
            






FIGURE P4-12









4-13
            Find the Norton equivalent circuit seen by the load in
            Figure P4-13
            .
            







FIGURE P4-13








4-14
            Find the Thévenin equivalent circuit seen by the load in
            Figure P4-14
            .
            






FIGURE P4-14









4-15
            The circuit parameters in
            Figure P4-15
            are
            R
B
            = 90 kΩ,
            R
C
            = 3.3 kΩ, β = 110,
            V
γ
            = 0.7 V, and
            V
CC
            = 15 V. Find
            i
C
            and
            υ
CE
            for
            υ
S
            = 0.5 V. Repeat for
            υ
S
            = 4 V and 6 V.
            






FIGURE P4-15








4-16

            The circuit parameters in
            Figure P4-15
            are
            R
C
            = 2 kΩ, β = 90,
            V
γ
            = 0.7 V, and
            V
CC
            = 5 V. Select a value of
            R
B
            such that the transistor is in the saturation mode when
            υ
S
            ≥ 2 V.
          


4-17
            The parameters of the transistor in
            Figure P4-17
            are β = 100 and
            V
γ
            = 0.7 V. Find
            i
C
            and
            υ
CE
            for
            υ
S
            =0.8 V. Repeat for
            υ
S
            = 2.5V.
            






FIGURE P4-17








4-18
            An emergency indicator light uses a bright 15 V @ 0.5 W LED indicator. It is to be ON when a digital output is high (5 V). The digital circuit does not have sufficient power to turn on the LED directly. However, as is common practice, a transistor driver is used as a digital switch. Select
            R
B
            in the circuit of
            Figure P4-18
            so as to drive the transistor into saturation causing it to act as a short circuit between the LED and ground when the digital output is high. The Thévenin equivalent for the digital circuit is also shown in the figure.
            






FIGURE P4-18












                  Objective 4-2 OP AMP Circuit Analysis (
                  Sects. 4-3
                  and
                  4-4
                  )
                

                  Given a linear resistance circuit containing OP AMPs, find selected output signals or input-output relationships. See
                  Examples 4-12
                  to
                  4-20
                  and
                  Exercises 4-15
                  to
                  4-31
                  .
                








4-19
            Find the voltage gain of each OP AMP circuit shown in
            Figure P4-19
            .
            






FIGURE P4-19








4-20

            Considering simplicity and standard 10% tolerance resistors from
            Appendix G
            as major constraints, design circuits
            
            with a single OP AMP that produce the following voltage gains ±10%: -50, +201, -0.91, -1000, +0.8, -1, +1.
          


4-21

            Two OP AMP circuits are shown in
            Figure P4-21
            . Both claim to produce a gain of either ±100.
            

(a)
                Show that the claim is true.
              

(b)
                A practical source with a series resistor of 1 kΩ is connected to the input of each circuit. Does the original claim still hold? If it does not, explain why.
                






FIGURE P4-21










4-22

            Suppose the output of the practical source shown in
            Figure P4-21
            needs to be amplified by -10
            4
            and you can use only the two circuits shown. How would you connect the circuits to achieve this? Explain why.
          



4-23


(a)
                Find the voltage gain
                υ
O
                /
                υ
S
                in
                Figure P4-23
                . What is the range of the input that can be amplified without causing the OP AMP to saturate?
              

(b)
                Validate your answers by simulating the circuit in Multisim. Sweep the voltage source from -5 V to +5 V.
                






FIGURE P4-23










4-24



(a)
                Using only one OP AMP, design a simple circuit that has a variable gain from -10 to -500.
              

(b)
                Using only one OP AMP, design a simple circuit that has a variable gain from +10 to +500.
              




4-25

            Using only one OP AMP per circuit with a
            V
CC
            of ±15 V, design circuits that realize the following equations:
            




4-26

            Two non-OP AMP circuits need to be connected in cascade. Explain why using a follower is more useful than simply connecting the two circuits using wires. Are there any downsides to using a follower?
          


4-27
            For the circuit in
            Figure P4-27
            :
            

(a)
                Find
                υ
O
                in terms of
                υ
S
                .
              

(b)
                Find
                i
O
                for
                υ
S
                = 1 V. Repeat for
                υ
S
                = 3 V.
                






FIGURE P4-27











4-28
            For the circuit in
            Figure P4-28
            :
            

(a)
                Find
                υ
O
                in terms
                υ
S
                .
              

(b)
                Find
                i
O
                and
                υ
O
                for
                υ
S
                = 1 V. Repeat for
                υ
S
                = 2 V.
              

(c)
                Validate your answers using Multisim.
              

(d)
                What could you do to avoid saturating the OP AMP?
                






FIGURE P4-28











4-29

            Design two circuits to produce the following out-put:
            υ
O
            = 2
            υ
1
            - 4
            υ
2
            .
            

(a)
                In your first design, use a standard subtractor.
              

(b)
                In your second design, both inputs must be into high input resistance amplifiers to avoid loading.
              



4-30

            Design a noninverting summer for five inputs with equal gains of 5.
          


4-31
            For the circuit in
            Figure P4-31
            :
            

(a)
                Find
                υ
O
                in terms of the inputs
                υ
1
                and
                υ
2
                .
              

(b)
                If
                υ
1
                = 1 V, what is the range of values
                υ
2
                can have without saturating the OP AMP?
                






FIGURE P4-31










4-32
            Find
            υ
O
            in terms of the inputs
            υ
1
            ,
            υ
2
            , and
            υ
3
            in
            Figure P4-32
            .
            






FIGURE P4-32






            (
            Hint
            : Use superposition.)
          


4-33
            The switch in
            Figure P4-33
            is open. Find
            υ
O
            in terms of the inputs
            υ
S1
            and
            υ
S2
            . Repeat with the switch closed.
            






FIGURE P4-33









4-34



(a)
                Design an OP AMP circuit that realizes the block diagram shown in
                Figure P4-34
                . Do not use more than two OP AMPs in your design.
              

(b)
                Can you do the design with only one OP AMP?
              

(c)
                Simulate your results using Multisim. Assume all sources are 1 V.
                






FIGURE P4-34











4-35

            Design an OP AMP circuit that realizes the block diagram shown in
            Figure P4-35
            . The OP AMPs that you must use have a maximum gain of 3000.
            






FIGURE P4-35








4-36

            For the circuit in
            Figure P4-36
            :
            

(a)
                Find
                υ
O
                in terms of
                υ
S1
                and
                υ
S2
                .
              

(b)
                Select values so that
                υ
O
                =
                υ
S1
                + 9
                υ
S2
                .
                







FIGURE P4-36












4-37
            The circuit in
            Figure P4-37
            has a diode in its feedback path and is called a "log-amp" because its output is proportional to the natural log of the input.
            

(a)
                Show that
                
                if the
                i
                -
                υ
                characteristics of the diode is
                
                .
              

(b)
                Using MATLAB plot
                υ
O
                versus
                υ
S
                for
                R
S
                = 15 kΩ,
                I
O
                = 3 × 10
                -14
                A, and
                V
T
                = 0.026 V. Plot your results on a semilog plot for 10
                -6
                V ≤
                υ
S
                ≤ 100 V.
                






FIGURE P4-37










4-38


(a)
                Use node-voltage analysis to find the input-output relationship or
                K
                of the circuit in
                Figure P4-38
                .
              

(b)

                Select values for the resistors so that
                K
                = -100.
                






FIGURE P4-38











4-39
            For the circuit of
            Figure P4-39
            :
            

(a)
                With
                υ
2
                = 2 V, find the output in terms of
                υ
1
                . Is there a value of
                υ
1
                that would cause the output to saturate?
              

(b)
                Draw a block diagram for the circuit.
              

(c)
                With
                υ
1
                = 2 V, find the output in terms of
                υ
2
                . Is there a value of
                υ
2
                that can keep the output from saturating?
              

(d)
                Draw a block diagram for the circuit.
                






FIGURE P4-39










4-40
            For the circuit of
            Figure P4-40
            :
            

(a)
                Find the output in terms of
                υ
S
                .
              

(b)
                Draw a block diagram for the circuit.
                






FIGURE P4-40











4-41
            For the block diagram of
            Figure P4-41
            :
            

(a)
                Find an expression for
                υ
O
                in terms of
                υ
1
                and
                υ
2
                .
              

(b)

                Design a suitable circuit that realizes the block diagram using only one OP AMP.
                






FIGURE P4-41










4-42


            A certain transducer, shown in
            Figure P4-42
            , needs a circuit that realizes the following interface
            υ
O
            = 1000
            υ
TR
            + 0.75 V. A search in a vendor's catalog showed that their INTERFACE #126, with properly defined resistors and a suitable bias voltage, could work.
            

(a)

                Determine the output that the proposed interface can deliver and decide if this could be used to achieve the desired interface.
              


(b)
                Assuming that the circuit could be useful, select appropriate values for the resistors and an appropriate bias voltage to meet the specifications.
                

Caution:


                loading could be an issue.
                






FIGURE P4-42











4-43

            On a quiz, an instructor asked the students to draw a circuit that would realize the block diagram shown in
            Figure P4-43
            (a). One student drew the circuit shown in
            Figure P4-43
            (b). Another student drew the circuit in
            Figure P4-43
            (c). Determine the correct solution, and grade the two students.
            






FIGURE P4-43








4-44

            On an exam, students were asked to design an efficient solution for the following relationship:
            υ
2
            = 3
            υ
1
            + 15. Two of the designs are shown in
            Figure P4-44
            . Which, if any, of the designs are correct and what grade would you award each student?
            






FIGURE P4-44









4-45

            For the circuit of
            Figure P4-45
            :
            

(a)
                Simplify the circuit to using only one OP AMP.
              

(b)
                Draw a representative block diagram for the circuit.
                






FIGURE P4-45










4-46

            Faced with having to construct the circuit in
            Figure P4-46
            (a), a student offers to build the circuit in
            Figure P4-46
            (b) claiming that it performs the same task. As the teaching assistant in the course, do you agree with the student's claim?
            







FIGURE P4-46












                  Objective 4-3 OP AMP Circuit Design and Evaluation (
                  Sect. 4-5
                  )
                
Given an input-output relationship, design resistive OP AMP circuits that implement the relationship. Evaluate the alternative designs using stated criteria.

                  See
                  Examples 4-21
                  to
                  4-23
                  and
                  Exercises 4-32
                  to
                  4-34
                  .
                








4-47

            Design a single OP AMP amplifier with a voltage gain of -2500 and an input resistance greater than 3 kΩ using standard 5% resistance values not greater than 10 MΩ.
          

4-48

            Design an OP AMP amplifier with a voltage gain of 5 using only 15-kΩ resistors and one OP AMP.
          


4-49

            Using a single OP AMP, design a circuit with inputs
            υ
1
            and
            υ
2
            and an output
            υ
O
            =
            υ
2
            - 5
            υ
1
            . The input resistance seen by each input should be greater than 1 kΩ.
          

4-50



(a)
                Using two OP AMPs, design an OP AMP circuit with inputs
                υ
1
                ,
                υ
2
                , and 100 mV and an output of
                υ
O
                = -3
                υ
1
                + 2
                υ
2
                - 300 mV.
              

(b)
                Assuming that you can invert any input, repeat the design using only one OP AMP.
              




4-51

            The OP AMP circuit shown in
            Figure P4-51
            has the following input-output relationship:
            



R
Y
              was accurately measured to be 12.247 kΩ. Select all the other resistors so that
              υ
O
              = -
              υ
S
              .
            







FIGURE P4-51









4-52

            Design a cascaded OP AMP circuit that will produce the output
            υ
O
            = 25 × 10
            9
υ
S
            + 2.5 V. The maximum gain for the OP AMPs available is 10,000. The input stage must have an input resistance of 1 kΩ or greater. Because of the high gain, limit the value of resistors to 5.6 MΩ.
          


4-53

            Design a cascaded OP AMP circuit that will produce the following output
            υ
O
            = -3.5 × 10
            6
υ
S
            - 1.5 V. The maximum gain for an OP AMP is 10,000. The input stage must have an input resistance of 1 kΩ or greater. The only voltage source available is the ±15 V used to power the OP AMPs.
          

4-54

            Using the instrumentation amplifier shown in
            Figure 4-78
            (
            Example 4-27
            ), design a circuit that will produce the output
            υ
O
            = 5 × 10
            5
            (
            υ
1
            -
            υ
2
            ). No single OP AMP can have a gain greater than 5000.
          


4-55
            Design the interface circuit in
            Figure P4-55
            so that the output is
            υ
2
            = 10
            4
υ
1
            - 5.0 V.
            






FIGURE P4-55








4-56


(a)

                Design a circuit that can produce
                υ
O
                = 2000
                υ
TR
                - 2.6 V using two OP AMPs. The input resistance must be greater than 10 kΩ. for
                υ
TR
                . The largest resistor you can use is 1 MΩ.
              

(b)
                Repeat using only one OP AMP. What concession to the specifications must be made to permit this?
              





4-57

              A requirement exists for an OP AMP circuit with the input-output relationship
            




              Three proposed designs are shown in
              Figure P4-57
              . As the project engineer, you must recommend one of these circuits for production. Which of these circuits would you recommend for production and why? Do not assume they all work.
              








FIGURE P4-57









4-58

              A requirement exists for an OP AMP circuit to deliver 12 V to a 1-kΩ load using a 4-V source as an input voltage. Two proposed designs are shown in
              Figure P4-58
              . Some characteristics of the OP AMP that must be used in the design are as follows:
            




Characteristic


Min


Typical


Max


Units





Open-loop gain

                    10
                    5


                    2 × 10
                    5

-
V/mV


Input resistance

                    10
                    10


                    10
                    11

-
Ω


Output voltage
-12
-
+15
V


Output current
-
-
25
mA



Which of these circuits would you recommend for production and why?







FIGURE P4-58







              (
              Hint
              : Verify that the circuits perform the required function.)
            






                  Objective 4-4 OP AMP Circuit Applications (
                  Sect. 4-6
                  )
                
Apply concepts of OP AMP analysis and design to create, analyze, or evaluate circuits that perform a specific interface, function, or task.

                  See
                  Examples 4-24
                  to
                  4-28
                  and
                  Exercises 4-35
                  to
                  4-43
                  .
                








4-59
            The analog output of a five-bit DAC is 2.8125 V when the input code is (1, 0, 0, 1, 0). What is the full-scale output of the DAC? How much does the analog output change when the input LSB changes?
          

4-60
            An
            R
            - 2
            R
            DAC is shown in
            Figure P4-60
            . The digital voltages
            υ
1
            ,
            υ
2
            , etc., can be either 5 V for a logic 1 or 0 V for a logic 0. What is the DAC's output when the logic input is (1, 1, 0, 1)?
            






FIGURE P4-60









4-61
            A fifth bit is added to the
            R
            - 2
            R
            DAC shown in
            Figure P4-60
            . What is the maximum possible magnitude of the output voltage? What is the resolution of the revised DAC?
          


4-62




(a)
                  An iron-copper nickel (Fe-CuNi) thermocouple (Type J) needs to be used to measure temperatures between 200°C and 1200°C. Its output will be used as an input to an ADC with a 0-5 V input. The characteristics of various thermocouples are shown in
                  Figure P4-62
                  .
                
Design an interface that will produce a 0 to +5-V output where 0 V refers to 200°C and +5 V refers to 1200°C. The transducer can be modeled as a voltage source in series with a 25-Ω resistor.



(b)
                Simulate the input to the ADC by varying the source commensurate to the range of the thermocouple in Multisim.
                Hint:
                Use DC Sweep.
                






FIGURE P4-62











4-63

            An analog accelerometer produces a continuous voltage that is proportional to acceleration in gravitational units or g.
            Figure P4-63
            shows the characteristics of the accelerometer in question. The curvy trace is the actual characteristics; the straight trace is an acceptable linearized model. Design an instrumentation system that will output - 10 V for - 2g and +10V for 2g. Note that this accelerometer has an output resistance of 32 kΩ.
            






FIGURE P4-63








4-64

            A commercial delivery drone needs a small pressure transducer to measure its altitude. A particular sensor is found that meets the basic specs. It can measure pressures of 15 kPa (2.18 psi) to 115 kPa (16.8 psi) linearly. It requires 5 V to operate, and it outputs 0.2 V at 15 kPa and 4.8 V at 115 kPa. It can be modelled as a Thévenin source that varies from 0.2 to 4.8 V with a
            R
T
            of 750 Ω. The typical pressure at sea level is 101 kPa and changes by -1.2 kPa every 100 m.
            

(a)
                What is the maximum height that the sensor can measure?
              

(b)
                Design a suitable interface that measures the height of the delivery drone between sea level and the maximum height of the sensor. Output the sensor's height measurement to a 0-5 V ADC.
              




4-65

            A medical grade pressure transducer has been developed for use in invasive blood pressure monitoring. The output voltage of the transducer is
            υ
TR
            = (0.06
            P
            - 0.75) mV, where
            P
            is pressure in mmHg. The output resistance of the transducer is 1 kΩ. The blood pressure measurement is to be an input to an existing multisensor monitoring system. This system treats a 1-V input as a blood pressure of 20 mmHg and a 10-V input as a blood pressure of 200 mmHg. Design an OP AMP circuit to interface the new pressure transducer with the existing monitoring system.
          

4-66

            The acid/alkaline balance of a fluid is measured by the pH scale. The scale runs from 0 (extremely acid) to 14 (extremely alkaline), with pH 7 being neutral. A pH electrode is a sensor that produces a small voltage that is directly proportional to the pH of the fluid in a test chamber. For a certain pH electrode, the proportionality factor is 50 mV/pH. A preamplifier is needed to interface this sensor with a variety of laboratory instruments. The output of the preamp must be 1 V when the sensor is immersed in a test solution with pH = 4 and 1.75 V when it is immersed in a solution with pH = 7. Design an amplifier to meet these requirements.
          


4-67

            Your engineering firm needs an instrumentation amplifier that provides the following input-output relationship:
            υ
O
            = 10
            6
υ
TR
            - 3.5 V. The transducer is modeled as a voltage source in series with a resistor that varies with the transducer voltage from 50 Ω to 500 Ω. A vendor is offering the amplifier shown in
            Figure P4-67
            and the vendor agrees to make a single change to the amplifier, if needed, for no cost. Would you recommend buying it? Explain your rationale.
            






FIGURE P4-67









4-68
            A signal
            υ
S
            (
            t
            ) is fed into the circuit as shown in
            Figure P4-68
            . Plot the output
            υ
O
            (
            t
            ).
            






FIGURE P4-68









4-69

            A rocket design team has a need to detect the temperatures in a rocket motor. The combustion chamber is that part of a thrust chamber where the combustion of the propellant takes place. The combustion temperature is much higher than the melting points of most chamber wall materials and reaches a temperature of 3000 K. Therefore, it is necessary either to cool these walls or to stop rocket operation before the critical wall areas become too hot. If the heat transfer is too high and thus the wall temperatures become locally too high, the thrust chamber will fail. The most critical wall regions are at and near the nozzle throat and at the nozzle exit. There are two thermocouples located in a rocket engine, namely, one at the throat and the other at the end of the nozzle exit. Your task is to design an emergency shutoff of the rocket engine if either temperature exceeds 600 K. Shutoff is done by sending a 5-VDC signal to a fuel controller that will immediately stop the flow of fuel and abort the rocket. Use a unipolar comparator powered by a 0- and 5-V supply. Set the comparator reference voltage at 600 K as 1 V. Use the R-type thermocouple shown in
            Figure P4-69
            because of its superior accuracy and stability, especially in a reducing environment as is found in rocket engines.
            






FIGURE P4-69








4-70
            The OP AMP in
            Figure P4-70
            operates as a comparator. Find the output voltage when
            υ
S
            = 9 V. Repeat for
            υ
S
            = -3 V and
            υ
S
            = 12 V.
            






FIGURE P4-70









4-71
            A five-bit flash ADC in Fi gure P4-71 uses a reference voltage of 5 V. Find the output code for the analog inputs
            υ
S
            = 3.5 V, 2.3 V, and 4.9 V. If the reference voltage is changed to 8 V, which of these codes would change?
            






FIGURE P4-71












          Integrating Problems
        



4-72

              Bipolar Power Supply Voltages
            

              The circuit in
              Figure P4-72
              produces bipolar power supply voltages
              V
POS
              > 0 and
              V
NEG
              < 0 from a floating unipolar voltage source
              V
REF
              > 0. Note that the OP AMP output is grounded and that its +
              V
CC
              and -
              V
CC
              terminals are connected to
              V
POS
              and
              V
NEG
              , respectively.
            


(a)
                Show that
                V
POS
                = +
                V
REF
                /2 and
                V
NEG
                = -
                V
REF
                /2 even if the load resistors
                R
POS
                and
                R
NEG
                are not equal.
              

(b)
                If
                R
POS
                and
                R
NEG
                are not equal, a current
                i
G
                must flow into or out of ground. How does the ungrounded voltage source
                V
REF
                supply this ground current?
              

(c)
                In effect, the OP AMP creates a "virtual ground" at point A (
                V
A
                = 0) but draws no current in doing so. Why not just connect point A to a "real ground" and do away with the OP AMP?
                






FIGURE P4-72











4-73

              Electric Scooter Governor
            
A town has a new light rail system. To encourage its use, the town council approved installing electric scooters at each station for riders to rent cheaply to take them to their final destinations. The town hired a small start-up company to provide location finding and speed control for each scooter. The new company determined that they can identify the scooters' locations using a GPS receiver/transponder. Since the location of each scooter is known, the GPS software can also determine the speed limit zone in which the scooter is driving. The GPS unit can then produce a voltage signal that is proportional to the speed limit. For the speed limit, the GPS unit outputs a linear 0 V at 0 miles per hour (mph) to 5 V for 50 mph. You must design a circuit that determines when the scooter's speed is above the limit and then output a 5-V signal. You find a suitable speed sensor that outputs a linear 0-V to 10-V output with a nominal 2-Ω series resistance. The sensor outputs 10 V at 0 mph and 0 V at 100 mph. The maximum speed allowed on each scooter is 55 mph. Design a system to use the sensor's speed output to mesh with the GPS unit's output to send an appropriate overspeed signal to the speed limiting system.



4-74

              High Bias Design Problem
            

              A particular pressure sensor is designed to operate under constant pressure. The task is to detect a pressure increase and sound an alarm. The sensor produces 1 mV at 100 psi, its usual operating pressure, and increases by 1 μV/psi. The design must sound an alarm if the pressure reaches 150 psi. The transducer is modeled as a voltage source with a series resistor that varies with pressure from 50 Ω at 100 psi to 150 Ω at 150 psi. Two types of OP AMPs are available. Type 1 are single-sided, meaning they have a +
              V
CC
              of 5 V and a -
              V
CC
              of 0 V. Type 2 OP AMPs are double-sided with a
              V
CC
              of ±15 V and have a maximum closed-loop gain of 5000. The alarm can be driven with the +5-V available from a saturated type 1 OP AMP. Only ±15-V and +5-V sources are available. Design the alarm circuit.
            



4-75

              Weathervane Azimuth Detection
            
A weathervane turns with the wind direction. The base of the weathervane is connected to a rotary potentiometer without stops, that is, the potentiometer turns from 0 Ω to 10 kΩ linearly clockwise, but jumps to 0 Ω after the maximum resistance is reached and would continue toward 10 kΩ if the weathervane continues to rotate clockwise. The need is to output the voltage from the potentiometer to comparators that will light 2-VDC LEDs. Each LED will correspond to a wind direction, N, NE, E, SE, etc. Set North at 1V (hence it should always be ON as long as the system is ON) and NW at 8 V. As the vane turns clockwise from N to NW, additional LEDs come on. If the vane turns counterclockwise, the LEDs go off as it turns. You have available a 15-VDC supply.



4-76

              Current Switching DAC
            

              The circuit in
              Figure P4-76
              is a four-bit DAC. The DAC output is the voltage
              υ
O
              and the input is the binary code represented by bits
              b
1
              ,
              b
2
              ,
              b
3
              , and
              b
4
              . The input bits are either 0 (low) or 1 (high), and each controls one of the four switches in the figure. When bits are low, their switches are in the left position, directing the 2
              R
              leg currents to ground. When bits are high, their switches move to the right position, directing the 2
              R
              leg currents to the OP AMP's inverting input. The 2R leg currents do not change when switching from left to right because the inverting input is a virtual ground (
              υ
N
              =
              υ
P
              = 0). The purpose of this problem is to show that this constant-current switching produces the following input-output relationship.
            





(a)
                Since the inverting input is a virtual ground, show that the currents in the 2
                R
                legs are
                i
1
                =
                V
REF
                /2
                R
                ,
                i
2
                =
                V
REF
                /4
                R
                ,
                i
3
                =
                V
REF
                /8
                R
                , and
                i
4
                =
                V
REF
                /16
                R
                , regardless of switch positions.
              


(b)
                  Show that the sum of currents at the inverting input is
                




                  where bits
                  b
k
                  (
                  k
                  = 1, 2, 3, 4) are either 0 or 1.
                



(c)
                Use the results in parts (a) and (b) to show that the OP AMP output voltage is as stated above.
                






FIGURE P4-76











4-77
              OP AMP Circuit Analysis and Design
            


(a)

                Find the input-output relationship of the circuit in
                Figure P4-77
                .
              

(b)

                Design a circuit that realizes the relationship found in part (a) using only 15-kΩ resistors and one OP AMP.
              

(c)
                (A) The wire fails (opens) at the
                
                , what is the output then?
                






FIGURE P4-77











4-78

              Instrumentation Amplifier with Alarm
            
Strain gauges measuring the deflection of a sintered metal column are connected to a Wheatstone bridge. The output of the bridge is balanced when there is no strain producing 0 V output. As the column is deflected, the bridge produces 150 μV/22 change caused by the strain gauges. The maximum possible defection would result in a 4-Ω change. Design an instrumentation amplifier that can take the voltage created in the bridge and send it to a 0-5 V ADC, where no deflection produces 0 V at the ADC and maximum deflection produces 5 V. To avoid loading, send the output of the bridge to a very high input resistance differential amplifier. The columns being tested are brittle and can shatter violently if the conditions cause the strain gauges to change by more than 3.9 22. For safety, connect the output of your instrumentation amplifier to a comparator circuit that will trigger an alarm when the strain causes the resistance to change by 3.75 Ω. The alarm needs to be triggered by 15 V.




4-79

              Strain Gauge Instrumentation Amplifier
            

              A strain gauge with an unstressed resistance of 120 Ω is used in a bridge as shown in
              Figure P4-79
              . The reference voltage is +25 V. When fully stressed the resistance of the strain gauge is 120.1 Ω. There is a need to design an instrumentation amplifier as shown in
              Figure P4-79
              so that the output will range from 0 V for no strain to 8 V for maximum strain. This output will eventually be sent to an ADC so that the data can be processed. Design the amplifier and verify your results using Multisim.
            







FIGURE P4-79










4-80

              Transistor Analysis
            

Figure P4-80
              shows two circuits using the same transistor connected in different ways. The transistor has a β of 90 and a
              V
γ
              of 0.7 V. Find the current gain of each circuit
              i
C
              /
              i
B
              for the common emitter and
              i
C
              /
              i
E
              for the common base configuration. Then compute the input resistance of each circuit,
              R
IN
              =
              υ
IN
              /
              i
N
              . Check your answers using Multisim. Comment on the possible uses for each configuration. For the common base configuration, assume that the transistor is in the active mode and that KCL and the current gain relationships are valid, even though the currents are flowing opposite of the normal directions.
              








FIGURE P4-80









4-81

              Temperature Sensor Design
            

              As a young designer at a firm that builds lithium batteries, you are tasked with designing a sensor system that displays the temperature inside the battery pack. The range of temperatures that need to be displayed is from 0°C to 200°C. The output will be to a temperature calibrated 0-5 V meter with 0 V equaling 0°C and 5 V equaling 200°C. In your research, you find two different sensors that meet your needs. One is a thermistor, the other a thermocouple. Their specs are shown in
              Figure P4-81
              .
            







FIGURE P4-81






Design appropriate interface circuits for each sensor. Then evaluate which would be best for your application. The actual cost of each sensor is about the same in large quantities.





Notes




1

              Usually the external power supply is not shown in circuit diagrams. When using a dependent source to model an active circuit, we assume that the external supply and the active device itself can handle whatever power is required by the circuit. When designing the actual circuit, the engineer must make certain that the active device and its power supply operate within their power ratings. For example, in the circuit just analyzed, if the input was a nominal 5 V, the input would want to be amplified by 50,000 times to 250,000 V! Not likely in most systems, rather, the output would simply be limited to the output of the power supply.
            


2

              This is a Multisim-generated graph. We will learn how to produce these and other graphs starting with
              Example 4-4
              .
            


3

              This circuit is called the common-emitter configuration because the emitter terminal is common to the input and output loops.
            


4

              The parameter
              A
              is used in OP AMP notation to define the device's "open-loop" gain, which is equal to u for VcVS models. In real OP AMPs, the open-loop gain listed in reference manuals is generally a minimum rather than an exact value. Hence, a listing for
              A
              equal to, say, 10
              5
              may mean that the device can be expected to have at least that amount of open-loop gain, but could exceed it by a factor of 10 or more. In general, we like to have
              A
              as large as possible. As we will see, it is the "closed-loop" gain that we want to be exact.
            


5

              The feedback must always be to the inverting terminal. otherwise the circuit will be unstable for reasons that we cannot explain based on what we have learned thus far. Further complicating this understanding is that when using the ideal OP AMP model in either Multisim or orCAD, the software does not distinguish between feedback to the positive or negative terminals. This, of course, is not true for a real OP AMP like a uA741 as used in the laboratory, in circuit applications, or in simulations.
            


6

              Maximum OP AMP output currents for general purpose OP AMPs like the uA741 are typically around 20 mA and generally range from 1 to 100 mA.
            


7

              A photodiode is a semiconductor device that absorbs photons and generates electron-hole pairs. The device is designed so that the pairs cannot quickly recombine, but rather produce a current proportional to the intensity of the light striking it.
            


8

              The main type of thermocouples use the Seebeck effect. The Seebeck effect consists simply of welding two dissimilar metal wires together forming a junction at one end. The junction can sense temperature changes and produces a small voltage, generally in millivolts, proportional to the change at the end of the dissimilar wires. Different metals can detect different temperature ranges and are rated by type, such as K, E, J, T, and others.
              Figure P4-62
              shows various thermocouple characteristics.
            


9

              Photoresistors are passive semiconductors that when exposed to photons generate free electron-hole pairs. These added electrons and holes provide additional carriers that act to decrease the resistance of the material. The more intense the light, the more carriers are created and the lower the resistance. Resistance can vary from several megaohms in the dark to a few hundred ohms in bright light. The wavelength of the impinging light can affect its properties.
            


10

              Thermistors are a type of resistor constructed using powdered metal oxides (semiconductors) that produce a wide variation of conduction depending on the temperature. There are two basic types of thermistors: positive temperature coefficient (PTC) and negative temperature coefficient (NTC). PTC thermistors are used in circuits to protect against excessive currents. NTC thermistors are the ones used for temperature measurements. Changes in resistance over several decades versus temperature are common and are accurate to better than ±0.2°C.
            
















CHAPTER 5

SIGNAL WAVEFORMS







Under the sea, under the sea mark how the telegraph motions to me. Under the sea, under the sea signals are coming along.


            James Clerk Maxwell, 1873,
            
            Scottish Physicist and
            
            Occasional Humorous Poet.
          






Some History Behind This Chapter

              James Clerk Maxwell (1831-1879) is considered the unifying founder of the mathematical theory of electromagnetics. This genial Scotsman often communicated his thoughts to friends and colleagues via whimsical poetry. In the short excerpt given above, Maxwell reminds us that the purpose of a communication system (the submarine cable telegraph in this case) is to transmit signals and that those signals must be changing, or
              in motion
              as he put it.
            








Why This Chapter Is Important Today
Up to this, point we have only treated dc signals that are time invariant. These constant signals are a logical place to begin the study of circuit analysis and design. However, to carry information, signals must change, otherwise they keep telling us the same thing over and over again. This chapter introduces the three basic time-varying signals used in the analysis and design of linear circuits. These are the singularity functions, the exponential, and the sinousoidal waveforms.
The chapter also demonstrates how signals can be combined to create more complex signals. Finally, we look at key, though partial, properties of signals that allow us to determine how they might perform without describing the complete signal.








Chapter Sections



5-1 Introduction






5-2 The Step Waveform






5-3 The Exponential Waveform






5-4 The Sinusoidal Waveform






5-5 Composite Waveforms






5-6 Waveform Partial Descriptors











Chapter Learning Objectives

5-1
              Basic Waveforms (
              Sects. 5-2
              ,
              5-3
              , and
              5-4
              )
            
Given an equation, graph, or word description of impulse, step, ramp, exponential, or sinusoid waveforms:

(a) Construct an alternative description of the waveform.
(b) Find the parameters or properties of the waveform.
(c) Construct new waveforms by integrating or differentiating the given waveform.

                (d) Generate the basic waveforms in MATLAB or Mul-tisim and use them appropriately to solve problems or simulate circuits. (See
                Appendix D
                .)
              


5-2
              Composite Waveforms (
              Sect. 5-5
              )
            
Given an equation, graph, or word description of a composite waveform:

(a) Construct an alternative description of the waveform.
(b) Find the parameters or properties of the waveform.

                (c) Generate the composite waveforms in MATLAB or Multisim and use them appropriately to solve problems or simulate circuits. (See
                Appendix D
                .)
              


5-3
              Waveform Partial Descriptors (
              Sect. 5-6
              )
            
Given a complete description of a basic or composite waveform:

(a) Classify the waveform as periodic or aperiodic and causal or noncausal.
(b) Find the applicable partial waveform descriptors.

                (c) Use appropriate software tools to calculate applicable partial waveform descriptors. (See
                Appendix D
                .)
              







          5-1 Introduction
        

          We normally think of a signal as an electrical current
          i
          (
          t
          ) or voltage
          υ
          (
          t
          ). The time variation of the signal is called a waveform. More formally,
        



A
              waveform
              is an equation or graph that defines the signal as a function of time.




          Up to this point, our study has been limited to the type of waveform shown in
          Figure 5-1
          . The three dots at the start of the waveform indicate that the waveform is unchanged from the beginning, while the three dots at the end imply that it will remain the same forever. Waveforms that are constant for all time are called
          dc signals.
          The abbreviation
          dc
          stands for direct current, but it applies to either voltage or current. Mathematical expressions for a dc voltage
          υ
          (
          t
          ) or current
          i
          (
          t
          ) take the form
        


(5-1)



This equation is only a model. No physical signal can remain constant forever. It is a useful model, however, because it approximates the signals produced by physical devices such as batteries or the output of photodiodes.







FIGURE 5-1



A constant or dc waveform.




          There are two matters of notation and convention that must be discussed before continuing. First, quantities that are constant (non-time-varying) are usually represented by uppercase letters (
          V
A
          ,
          I
          ,
          T
O
          ) or lowercase letters in the early part of the alphabet (
          a
          ,
          b
7
          ,
          f
0
          ). Time-varying electrical quantities are represented by the lowercase letters
          i
          ,
          υ
          ,
          p
          ,
          q
          , and
          w
          . The time variation is expressly indicated when we write these quantities as
          υ
1
          (
          t
          ),
          i
A
          (
          t
          ), or
          w
C
          (
          t
          ). Time variation is implicit when they are written as
          υ
1
          ,
          i
A
          , or
          w
C
          .
        

          Second, in a circuit diagram, signal variables are normally accompanied by the reference marks (+, -) for voltage and (⟶) for current. It is important to remember that these reference marks
          do not
          indicate the polarity of a voltage or the direction of current. The marks provide a baseline for determining the sign of the numerical value of the actual waveform. When the actual voltage polarity or current direction coincides with the reference directions, the signal has a positive value. When the opposite occurs, the value is negative.
          Figure 5-2
          shows examples of voltage waveforms, including some that assume both positive and negative values. The bipolar waveforms indicate that the actual voltage polarity is changing as a function of time.
        







FIGURE 5-2



Some example waveforms.





          The waveforms in
          Figure 5-2
          are examples of signals used in electrical engineering. Since there are many such signals, it may seem that the study of signals involves the uninviting task of compiling a lengthy catalog of waveforms. However, it turns out that a long list is not needed. In fact, we can derive most of the waveforms of interest using just three basic signal models: the step, exponential, and sinusoidal functions. The small number of basic signals illustrates why models are so useful to engineers. In reality, waveforms are very complex, but their time variation can be approximated adequately using only a few basic building blocks.
        

          Finally, in this chapter we will focus on the use of voltage
          υ
          (
          t
          ) to represent a signal waveform. Remember, however, that a signal can be either a voltage
          υ
          (
          t
          ) or current
          i
          (
          t
          ).
        


5-2 The Step Waveform

          The first basic signal in our catalog is the step waveform. The general step function is based on the
          unit step function

1

          defined as
        


(5-2)




          The step function waveform is equal to zero when its argument
          t
          is negative and is equal to unity when its argument is positive. Mathematically, the function
          u
          (
          t
          ) has a jump discontinuity at
          t
          = 0.
        

          Strictly speaking, it is impossible to generate a true step function since signal variables like current and voltage cannot jump from one value to another in zero time. Practically speaking, we can generate very good approximations to the step function. What is required is that the time the signal takes to switch from 0 to 1, called the
          transition time,
          be short compared with other response times in the circuit. Actually, the generation of approximate step functions is an everyday occurrence since people frequently turn things like TVs, stereos, computers, cell phones, appliances, and lights on and off.
        

Figure 5-3
          (a) shows how a step might be physically constructed on a circuit diagram. It is assumed that the transition from off to on occurs instantaneously at the time the switch is thrown, that is, at
          t
          = 0 in the figure. The same process is shown more compactly in
          Figure 5-3
          (b).
        

          On the surface, it may appear that the step function is not a very exciting waveform or, at best, only a source of temporary excitement. However, the step waveform is a versatile signal used to construct a wide range of useful waveforms. Multiplying
          u(t)
          by a constant
          V
A
          produces the waveform
        


(5-3)




          Replacing
          t
          by (
          t
          -
          T
S
          ) produces a waveform
          V
A
u
          (
          t
          -
          T
S
          ), which takes on the values
        


(5-4)




          The
          amplitude
V
A
          scales the size of the step discontinuity, and the
          time-shift
          parameter
          T
S
          advances or delays the time at which the step occurs, as shown in
          Figure 5-4
          . The step function transitions when the value of
          t
          makes the argument of the function equal to zero. For example, the function
          υ
          (
          t
          ) = 5
          u
          (
          t
          + 6) V shifts +5 V at
          t
          = -6 s, and
          i
          (
          t
          ) = 2
          u
          (
          t
          - 1) mA shifts + 2 mA at
          t
          = 1 s. A note about signals existing before
          t
          = 0. In engineering and science, zero often is a convenient time selected to indicate a start or
          
          stop of a particular event. All should be familiar with the countdown clock prior to a space launch where a comment like
          t
          - 10 minutes and counting indicates that the launch will occur in 10 minutes. At
          t
          - 10 s, the hydrogen burnoff system is activated in a liquid fuel rocket. But at 10 s before zero, activating the hydrogen burnoff system may be its own
          t
          = 0.
        







FIGURE 5-3


(a) Approximation to a step function. (b) Typical representation.











FIGURE 5-4



Effect of time shifting on the step function waveform.










FIGURE 5-5













FIGURE 5-6







          Amplitude and time-shift parameters are required to define the general step function. The amplitude
          V
A
          carries the units of volts. The amplitude of the step function in electric current is
          I
A
          and carries the units of amperes. The constant
          T
S
          carries the units of time, usually seconds. The parameters
          V
A
          (or
          I
A
          ) and
          T
S
          can be positive, negative, or zero. By combining several step functions, we can represent a number of important waveforms. One possibility is illustrated in the following example:
        












EXAMPLE 5-1



                  Express the waveform in
                  Figure 5-5
                  (a) in terms of step functions.
                




SOLUTION:



              The amplitude of the pulse jumps to a value of 3 V at
              t
              = 1 s; therefore, 3
              u
              (
              t
              - 1) is part of the equation for the waveform. The pulse returns to zero at
              t
              = 3 s, so an equal and opposite step must occur at
              t
              = 3 s. Putting these observations together, we express the rectangular pulse as
            




Figure 5-5
              (b) shows how the two step functions combine to produce the given rectangular pulse.
              ■











Exercise 5-1



              Write an expression using unit step functions for the waveform in
              Figure 5-6
              .
            


Answer:



υ
              (
              t
              ) = 10
              u
              (
              t
              + 2) - 15
              u
              (
              t
              - 2) + 5
              u
              (
              t
              - 4) V
            



The Impulse Function

            The generalization of
            Example 5-1
            is the waveform
          




            This waveform is a rectangular pulse ofamplitude
            V
A
            that turns on at
            t
            =
            T
1
            and offat
            t
            =
            T
2
            . The pulse train and square wave signals in
            Figure 5-2
            can be generated by a series of these pulses. Pulses that turn on at some time
            T
1
            and off at some later time
            T
2
            are sometimes called
            gating
            or
            window functions
            because they are used to enable or inhibit the passage of another signal. That is, only the portion of the signal that lies between the two times is allowed to pass through the "gate" or is visible in the "window."
          


            A unit-area pulse centered on 
            t 
            = 0 is written in terms of step functions as  
          



(5-5)




 
            The pulse in   
            Eq. (5-5)  
            is zero everywhere except in the range -   
            T
            /2 ≤    
            t  
            ≤    
            T   
            /2, where its value is 1/ 
            T    
            . The area under the pulse is 1 because its scale factor is inversely proportional to its duration. As shown in
            Figure 5-7 
            (a), if we half the duration of the pulse and double its height, it maintains its unit area. And if we repeat the process of halving its period and doubling its height, it again maintains the same area. In the limit as the period
            T    
            → 0, the scale factor 1/
            T    
            approaches infinity but the area remains 1. The function obtained in the limit is called a
            unit impulse  
            ,   
            
2
   
            symbolized as δ(   
            t  
            ). The graphical representation of δ(
            t
            ) is shown in
            Figure 5-7
            (b). The impulse is an idealized model of a large-amplitude, short-duration pulse.
          
A formal definition of the unit impulse is


(5-6)




            The first condition says the impulse is zero everywhere except at
            t
            = 0 where it is infinite. The second condition suggests that the unit impulse is the derivative of a unit step function:
          



(5-7)





            The conclusion in
            Eq. (5-7)
            cannot be justified using elementary mathematics since the function
            u
            (
            t
            ) has a discontinuity at
            t
            = 0 and its derivative at that point does not exist in the usual sense. However, the concept can be justified using limiting conditions on continuous functions, as discussed in texts on signals and systems.
            
3

            Accordingly, we defer the question of mathematical rigor to later courses and think of the unit impulse as the derivative of a unit step function. Note that this means that the unit impulse 5(t) has units of reciprocal time, or s
            -1
            .
          

            An impulse of strength
            K
            is denoted
            υ
            (
            t
            ) =
            K
            δ(
            t
            ). Consequently, the scale factor
            K
            has the units of V-s and is the area under the impulse
            K
            δ(
            t
            ). In the graphical representation of the impulse, the value of
            K
            is written in parentheses beside the arrow, as shown in
            Figure 5-7
            (b), one in this example.
          







FIGURE 5-7



Rectangular pulse waveforms and the impulse.










FIGURE 5-8
















EXAMPLE 5-2

                    Calculate and sketch the derivative of the pulse in
                    Figure 5-8
                    (a).
                  




SOLUTION:



                In
                Example 5-1
                the pulse waveform was written as
              



Using the derivative property of the step function, we write




                The derivative waveform consists of a positive-going impulse at
                t
                = 1 s and a negative-going impulse at
                t
                = 3 s.
                Figure 5-8
                (b) shows how the impulse train is represented graphically. The waveform
                υ
                (
                t
                ) has the units of volts (V), so its derivative
                dυ
                (
                t
                )/
                dt
                has the units of V/s.
                ■











FIGURE 5-9













FIGURE 5-10



(a) Unit ramp waveform. (b) General ramp waveform.










                Evaluation Exercise 5-2
              

Figure 5-9
                purports to be an alternative description of an impulse function as ε → 0. Prove or disprove the claim.
              


Answer:



                From the figure, the area of the triangle is
                
                . As ε → 0, the base of the triangle shrinks to zero, but the amplitude grows to infinity. Yet the area always remains at 1. Hence, this is equivalent to the definition of an impulse and proves the claim.
              




The Ramp Function

            The
            unit ramp
            is defined as the integral of a step function:
          


(5-8)




            The unit ramp waveform
            r
            (
            t
            ) in
            Figure 5-10
            (a) is zero for
            t
            < 0 and is equal to
            t
            for
            t
            > 0. Notice that the slope of
            r
            (
            t
            ) is 1 and has the units of time, or seconds, s. A ramp of strength
            K
            is denoted
            υ
            (
            t
            ) =
            Kr
            (
            t
            ), where the scale factor
            K
            has the units of V/s and is the slope of the ramp. The general ramp waveform shown in
            Figure 5-10
            (b), written as
            υ
            (
            t
            ) =
            Kr
            (
            t
            -
            T
S
            ), is zero for
            t
            <
            T
S
            and equal to
            K
            (
            t
            -
            T
S
            ) for
            t
            ≥
            T
S
            . By adding a sequence of ramps, we can create the triangular and sawtooth waveforms shown in
            Figure 5-2
            .
          


Singularity Functions

            The unit impulse, unit step, and unit ramp form a triad of related signals that are referred to as
            singularity functions.
            They are related by integration as
          



(5-9)




or by differentiation as



(5-10)





            These signals are used to generate other waveforms and as test inputs to linear systems to characterize their responses. When applying the singularity functions in circuit analysis, it is important to remember that
            u
            (
            t
            ) is a dimensionless function.
            Eqs. (5-9)
            and
            (5-10)
            point out that δ(
            t
            ) carries the units of s
            -1
            and
            r
            (
            t
            ) carries units of seconds.
            











EXAMPLE 5-3

                    Derive an expression for the waveform for the integral of the pulse shown in
                    Figure 5-11
                    (a). Repeat for the derivative of the pulse.
                  




SOLUTION:



                In
                Example 5-1
                , the pulse waveform was written as
              



Using the integration property of the step function, we write




                The integral is zero for
                t
                < 1 s. For 1 <
                t
                < 3 the waveform is 3(
                t
                - 1). For
                t
                > 3 it is 3(
                t
                - 1) - 3(
                t
                - 3) = 6. These two ramps produce the pulse integral shown in
                Figure 5-11
                (b). The waveform
                υ
                (
                t
                ) has the units of volts (V), so the units of its integral are V-s.
              
Returning to the pulse waveform as



Using the differentiation property of the step function, we write




                The derivative is zero for
                t
                < 1 s. For
                t
                = 1, the waveform is 3δ(
                t
                - 1). For
                t
                = 3, it is -3δ(
                t
                - 3).
              

                These two impulses produce the waveform shown in
                Figure 5-11
                (c). The waveform
                v
                (
                t
                ) has the units of volts (V), therefore the units of its derivative are V/s.
                ■










FIGURE 5-11











Exercise 5-3

                Write an expression using ramp functions to describe the waveform shown in
                Figure 5-12
                .
              


Answer:



υ
                (
                t
                ) =
                r
                (
                t
                + 1) - 2
                r
                (
                t
                - 1) +
                r
                (
                t
                - 3) V
              









FIGURE 5-12
















EXAMPLE 5-4

Figure 5-13
                    (a) shows an ideal electronic switch whose input is a ramp 2
                    r
                    (
                    t
                    ), where the scale factor
                    K
                    = 2 carries the units of V/s. Find the switch output
                    υ
O
                    (
                    t
                    ) when the gate function in
                    Example 5-1
                    , shown in
                    Figure 5-13
                    (b), is applied to the control terminal (G) of the switch.
                  




SOLUTION:



                In
                Example 5-1
                the gate function was written as
              




                The gate function turns the switch on at
                t
                = 1 s and off at
                t
                = 3 s. The output voltage of the switch is
              



Note that the amplitude of the gate function does not influence the magnitude of the output voltage, since it only controls the position of the switch.


                Only the portion of the input waveform within the gate interval appears at the output.
                Figure 5-13
                (b), (c), and (d) show how the gate function
                υ
G
                (
                t
                ) controls the passage of the input signal through the electronic switch.
              







FIGURE 5-13







                This waveform can be written as a sum of singularity functions as follows. First, we write
                υ
O
                (
                t
                ) in terms of a gate function:
              



We then manipulate this equation as follows:



So finally,




                which describes the gated ramp in terms of step and ramp waveforms.
                ■









Exercise 5-4
Express the following signals in terms of singularity functions:


                  (a)
                  


                  (b)
                  


                  (c)
                  


                  (d)
                  


Answers:


                  (a)
                  υ
1
                  (
                  t
                  ) = 4
                  u
                  (
                  t
                  - 2) - 8
                  u
                  (
                  t
                  - 4)
                

                  (b)
                  υ
2
                  (
                  t
                  ) = 4
                  u
                  (
                  t
                  - 2) - 2
                  r
                  (
                  t
                  - 4)
                

                  (c)
                  υ
3
                  (
                  t
                  ) = 4
                  r
                  (
                  t
                  - 2) - 8
                  r
                  (
                  t
                  - 4)
                

                  (c)
                  υ
4
                  (
                  t
                  ) = 4δ(
                  t
                  - 2) - 2
                  u
                  (
                  t
                  - 4)
                






5-3 The Exponential Waveform

          The
          exponential waveform
          is a step function whose amplitude factor gradually decays to zero. The equation for this waveform is
        



(5-11)





          A graph of
          υ
          (
          t
          ) versus
          t
          /
          T
C
          is shown in
          Figure 5-14
          . The exponential starts out like a step function. Because of the
          u
          (
          t
          ) multiplying the exponential, it is zero for
          t
          < 0 and jumps to a maximum amplitude of
          V
A
          at
          t
          = 0 because
          
          . Thereafter, it monotonically decays toward zero as time marches on. The two parameters that define the waveform are the
          amplitude
V
A
          (in volts) and the
          time constant
T
C
          (in seconds). The amplitude of a current exponential would be written
          I
A
          and carry the units of amperes.
        







FIGURE 5-14



The exponential waveform.




          The time constant is of special interest, since it determines the rate at which the waveform decays to zero. An exponential decays to about 36.8% of its initial amplitude
          υ
          (0) =
          V
A
          in one time constant, because at
          
          , or approximately 0368 ×
          V
A
          . At
          t
          = 5
          T
C
          , the value of the waveform is
          V
A
e
-5
          , or
          
          approximately 0.00674
          V
A
          . An exponential signal decays to less than 1% of its initial amplitude in a time span of five time constants. In theory, an exponential endures forever, but practically speaking after about 5
          T
C
          the waveform amplitude becomes negligibly small. We define the
          duration
          of a waveform to be the interval of time outside of which the waveform is everywhere less than a stated value. Using this concept, we say the duration of an exponential waveform is 5
          T
C
          .
        







FIGURE 5-15



(a) Construct of a decaying exponential waveform. (b) Typical representation. (c) Composite waveforms showing final result.




Figure 5-15
          shows how an exponential waveform can be constructed. Note that the unit step multiplies the exponential function and turns it on at
          t
          = 0.
        












EXAMPLE 5-5


                  Plot the waveform
                  υ
                  (
                  t
                  ) = [−17
                  e

                    −100
                    t

                  ]
                  u
                  (
                  t
                  ) V.
                




SOLUTION:



              From the form of
              υ
              (
              t
              ), we recognize that
              V
A
              = −17 V and
              T
C
              = 1/100 s or 10 ms. The minimum value of
              υ
              (
              t
              ) is
              υ
              (0) = -17 V, and the maximum value is approximately 0 V as
              t
              approaches 5
              T
C
              = 50 ms. These observations define appropriate scales for plotting the waveform. Spreadsheet programs are especially useful for the repetitive calculations and graphical functions involved in waveform plotting.
              Figure 5-16
              shows how this example can be handled using Excel. We developed our desired equation by listing our time axis in a column labeled
              t
              (ms). We began with a negative number -2.5 ms because we want to show the effect of the unit step
              u
              (
              t
              ). We plotted the curve for five time constants or 50 ms. In another column labeled - 17
              e

                −100
                t

              , we then wrote our desired equation without the unit step equal to -17*EXP(−100*C3/1000), where C3 was the column with the time axis entry and the division by 1000 scales the time units correctly. Finally, we added the unit step in a third column labeled
              u
              (
              t
              ). In the last column that we labeled
              υ
              (
              t
              ), we brought it all together by
              
              multiplying the desired equation column by the unit step. We then opened the graphing tool and plotted the
              υ
              (
              t
              ) column versus the time column. Note that there is a slope to the line from −1.25 ms and 0. The plotter does not know to stay at
              u
              (
              t
              ) = 0 until the axis, hence the slope. This is a good time to point out that in real practice there are no instantaneous rises and falls, and there will always be a slope. Making this slope as close to perfect (vertical in this case) is a major challenge of engineering.
              ■








FIGURE 5-16















Exercise 5-5

Sketch the waveform described by





Answer:



              See
              Figure 5-17
              .
            









FIGURE 5-17







Properties of Exponential Waveforms

            The
            decrement property
            describes the decay rate of an exponential signal. For
            t
            > 0, the exponential waveform is given by
          



(5-12)





            The step function can be omitted since it is unity for
            t
            > 0. At time
            t
            + Δ
            t
            , the amplitude is
          


(5-13)



The ratio of these two amplitudes is



(5-14)






            The decrement ratio is independent of amplitude and time. In any fixed time period Δ
            t
            , the fractional decrease depends only on the time constant. The decrement property states that the same percentage decay occurs in equal time intervals.
          

            The slope of the exponential waveform (for
            t
            > 0) is found by differentiating
            Eq. (5-12)
            with respect to time:
          



(5-15)





            The
            slope property
            states that the time rate of change of the exponential waveform is inversely proportional to the time constant. Small time constants lead to large slopes or rapid decays, while large time constants produce shallow slopes and long decay times. See
            Figure 5-18
            (a).
          







FIGURE 5-18



(a) Effect of different time constants on the exponential waveform. (b) Effect oftime shifting on the exponential waveform.




Equation (5-15)
            can be rearranged as
          



(5-16)





            When
            υ
            (
            t
            ) is an exponential of the form in
            Eq. (5-12)
            , then
            dυ/dt
            +
            υ
            /
            T
C
            = 0. That is, the exponential waveform is a solution of the first-order linear differential equation in
            Eq. (5-16)
            . We will make use of this fact in
            Chapter 7
            .
          

            The time-shifted exponential waveform is obtained by replacing
            t
            on the right side in
            Eq. (5-11)
            by
            t
            -
            T
S
            . The general exponential waveform is written as
          



(5-17)





            where
            T
S
            is the time-shift parameter for the waveform.
            Figure 5-18
            (b) shows exponential waveforms with the same amplitude and time constant but different values of
            T
S
            . Time shifting translates the waveform to the left or right depending on whether
            T
S
            is negative or positive.
            

Caution:


            The factor
            t
            -
            T
S
            must appear in both the argument of the step function and the exponential, as shown in
            Eq. (5-17)
            .
          












                      APPLICATION
                      EXAMPLE 5-6



                    An oscilloscope is a laboratory instrument that displays the instantaneous value of a waveform versus time.
                    Figure 5-19
                    shows an oscilloscope display of a portion of an exponential waveform. In the figure, the vertical (amplitude) axis is calibrated at 2 V per division, and the horizontal (time) axis is calibrated at 1 ms per division. Find the time constant of the exponential.
                  









FIGURE 5-19









SOLUTION:



                For
                t
                >
                T
S
                , the general expression for an exponential in
                Eq. (5-17)
                becomes
              




                We have only a portion of the waveform, so we do not know the location of the
                t
                = 0 time origin; hence, we cannot find the amplitude
                V
A
                or the time shift
                T
S
                from the display. But, according to the decrement property, we should be able to determine the time constant since the decrement ratio is independent of amplitude and time. specifically,
                Eq. (5-14)
                points out that
              




                Solving for the time constant
                T
C
                yields
              



(5-18)




Taking the starting point at the left edge of the oscilloscope display yields




                Next, defining Δ
                t
                to be the full width of the display produces
              



and




                As a result, substituting into
                Eq. (5-18)
                , the time constant of the waveform is found to be
              




■

 










                Application Exercise 5-6
              

                You are in a circuits laboratory and are required to determine the time constant of a voltage signal. You observe the signal on an oscilloscope as shown in
                Figure 5-20
                . The scope tells you that ground is at 0.3 V. Find its time constant.
              







FIGURE 5-20








Answer:



T
C
                = 2.00 μs
              










                Exercise 5-7
              

Figure 5-21
                shows three exponential waveforms. Match each curve with the appropriate expression.
              



1.





2.





3.











FIGURE 5-21








Answer:



                Waveform (a) =
                υ
2
                (
                t
                ), (b) =
                υ
3
                (
                t
                ), and (c) =
                υ
1
                (
                t
                ).
              








Exercise 5-8


                  (a) An exponential waveform has
                  υ
                  (0) = 1.2 V and
                  υ
                  (3) = 0.5 V. What are
                  V
A
                  and
                  T
C
                  for this waveform?
                

                  (b) An exponential waveform has
                  υ
                  (0) = 5 V and
                  υ
                  (2) = 1.25 V. Find the value of
                  υ
                  (
                  t
                  ) at
                  t
                  = 1 s and
                  t
                  = 4s?
                

                  (c) An exponential waveform has
                  υ
                  (0) = 5 V and an initial (
                  t
                  = 0) slope of -25 V/s. What are
                  V
A
                  and
                  T
C
                  for this waveform?
                

                  (d) An exponential waveform decays to 10% of its initial value in 3 ms. What is
                  T
C
                  for this waveform?
                

                  (e) A waveform has
                  υ
                  (2) = 4 V,
                  υ
                  (6) = 1 V, and
                  υ
                  (10) = 0.5 V. Is it an exponential waveform?
                

Answers:


                  (a)
                  V
A
                  = 1.2 V,
                  T
C
                  = 3.43s
                

                  (b)
                  υ
                  (1) = 2.5 V,
                  υ
                  (4) = 0.3125 V
                

                  (c)
                  V
A
                  = 5 V,
                  T
C
                  = 200 ms
                

                  (d)
                  T
C
                  = 1.303 ms
                
(e) No it violates the decrement property.









Exercise 5-9
Find the amplitude and time constant for each of the following exponential signals:


                  (a)
                  


                  (b)
                  


                  (c)
                  


                  (d)
                  




                Answers:
              


                  (a)
                  V
A
                  = -15 V,
                  T
C
                  = 1 ms
                

                  (b)
                  V
A
                  = 12 mV,
                  T
C
                  = 10 s
                

                  (c)
                  I
A
                  = 15 mA,
                  T
C
                  = 2 ms
                

                  (d)
                  I
A
                  = 4 A,
                  T
C
                  = 5 ms
                






5-4 The Sinusoidal Waveform

          The cosine and sine functions are important in all branches of science and engineering. The corresponding time-varying waveform in
          Figure 5-22
          plays an especially prominent role in electrical engineering.
        







FIGURE 5-22



The eternal sinusoid.




          In contrast with the step and exponential waveforms studied earlier, the sinusoid, like the dc waveform in
          Figure 5-1
          , extends indefinitely in time in both the positive and negative directions. The sinusoid has neither a beginning nor an end. Of course, real signals have finite durations. They were turned on at some finite time in the past and will be turned off at some time in the future. While it may seem unrealistic to have a signal model that lasts forever, it turns out that the eternal sinewave is a very good approximation in many practical applications.
        

          The sinusoid in
          Figure 5-22
          is an endless repetition of identical oscillations between positive and negative peaks. The
          amplitude
V
A
          (in volts) or
          I
A
          (in amperes) defines the maximum and minimum values of the oscillations. The
          period
T
0
          (usually seconds) is the time required to complete one cycle of the oscillation. The sinusoid can be expressed mathematically using either the sine or the cosine function. The choice between the two depends on where we choose to define
          t
          = 0. If we choose
          t
          = 0 at a point where the sinusoid is zero, then it can be written as
        


(5-19a)




          On the other hand, if we choose
          t
          = 0 at a point where the sinusoid is at a positive peak, we can write an equation for it in terms of a cosine function:
        



(5-19b)





          Although either choice will work, it is common practice to choose
          t
          = 0 at a positive peak; hence
          Eq. (5-19b)
          applies. Thus, we will continue to call the waveform a sinusoid even though we use a cosine function to describe it.
        

          As in the case of the step and exponential functions, the general sinusoid is obtained by replacing
          t
          by (
          t
          -
          T
S
          ). Inserting this change in
          Eq. (5-19b)
          yields a general expression for the sinusoid as
        



(5-19c)





          where the constant
          T
S
          is the time-shift parameter.
          Figure 5-23
          shows that the sinusoid shifts to the right when
          T
S
          > 0 and to the left when
          T
S
          < 0. In effect, time shifting causes the positive peak nearest the origin to occur at
          t
          =
          T
S
          .
          








FIGURE 5-23



Effect of time shifting on the sinusoidal waveform.



The time-shifting parameter can also be represented by an angle:



(5-20)





          The parameter ϕ is called the
          phase angle.
          The term
          phase angle
          is based on the circular interpretation of the cosine function. We think of the period as being divided into 2π radians, or 360°. In this sense, the phase angle is the angle between
          t
          = 0 and the nearest positive peak. Comparing
          Eqs. (5-19c)
          and
          (5-20)
          , we find the relation between
          T
S
          and ϕ to be
        



(5-21)





          Changing the phase angle moves the waveform to the left or right, revealing different phases of the oscillating waveform (hence the name
          phase angle).


          The phase angle should be expressed in radians, but is more often reported in degrees. Care should be taken when numerically evaluating the argument of the cosine (2π
          t
          /
          T
0
          + ϕ) to ensure that both terms have the same units. The term 2π
          t
          /
          T
0
          has the units of radians, so it is necessary to convert ϕ to radians when it is given in degrees.
        

          An alternative form of the general sinusoid is obtained by expanding
          Eq. (5-20)
          using the identity cos(
          x
          +
          y
          ) = cos(
          x
          )cos(
          y
          ) - sin(
          x
          )sin(
          y
          ),
        



The quantities inside the brackets in this equation are constants; therefore, we can write the general sinusoid in the following form:



(5-22)






          The two amplitude-like parameters
          a
          and
          b
          have the same units as the waveform (volts in this case) and are called Fourier coefficients.
          
4

          By definition, the Fourier coefficients are related to the amplitude and phase parameters by the equations
        



(5-23)





          The inverse relationships are obtained by squaring and adding the expressions in
          Eq. (5-23)
          :
        



(5-24)





          and by dividing the second expression in
          Eq. (5-23)
          by the first:
        



(5-25)







Caution:


          The inverse tangent function on a calculator has a ±180° ambiguity that can be resolved by considering the signs of the Fourier coefficients
          a
          and
          b.


          It is customary to describe the time variation of the sinusoid in terms of a frequency parameter.
          Cyclic frequency
f
0
          is defined as the number of periods per unit time. By definition, the period
          T
0
          is the number of seconds per cycle; consequently, the number of cycles per second is
        


(5-26)




          where
          f
0
          is the cyclic frequency or simply the frequency. The unit of frequency (cycles per second) is the
          hertz
          (Hz). The
          angular frequency
ω
0
          in radians per second is related to the cyclic frequency by the relationship
        



(5-27)




because there are 2π radians per cycle.

          There are two ways to express the concept of sinusoidal frequency: cyclic frequency (
          f
0
          , hertz) and angular frequency (
          ω
0
          , radians per second). When working with signals, we tend to use the former. For example, radio stations transmit carrier signals at frequencies specified as 690 kHz (AM band) or 101 MHz (FM band) or Wi-Fi as 2.4 GHz or 5 GHz. Radian frequency is more convenient when describing the characteristics of circuits driven by sinusoidal inputs.
        
In summary, there are several equivalent ways to describe the general sinusoid:



To use any one of these expressions, we need three types of parameters:



1.

Amplitude:
            either
            V
A
            or the Fourier coefficients
            a
            and
            b



2.

Time shift:
            either
            T
S
            or the phase angle ϕ
          


3.

Time/frequency:
            either
            T
0
            ,
            f
0
            , or
            ω
0



          In different parts of this book, we use different forms to represent a sinusoid. Therefore, it is important for you to understand thoroughly the relationships among the various parameters in
          Eqs. (5-22)
          through
          (5-27)
          .
        












                  APPLICATION
                  EXAMPLE 5-7


Figure 5-24
                  shows an oscilloscope display of a sinusoid. The vertical axis (amplitude) is calibrated at 5 V per division, and the horizontal axis (time) is calibrated at 0.1 ms per division. Derive an expression for the sinusoid displayed in
                  Figure 5-24
                  .
                









FIGURE 5-24








SOLUTION:


The maximum amplitude of the waveform is seen to be four vertical divisions; therefore,



There are four horizontal divisions between successive zero crossings, which means there are a total of eight divisions in one cycle. The period of the waveform is




              The two frequency parameters are
              f
0
              = 1/
              T
0
              = 1.25 kHz and
              ω
0
              = 2π
              f
0
              = 7854 rad/s. The parameters
              V
A
              ,
              T
0
              ,
              f
0
              , and
              ω
0
              do not depend on the location of the
              t
              = 0 axis.
            

              To determine the time shift
              T
S
              , we need to define a time origin. The
              t
              = 0 axis is arbitrarily taken at the left edge of the display in
              Figure 5-24
              . The positive peak shown in the display is 5.5 divisions to the right of
              t
              = 0, which is more than half a cycle (four divisions). The positive peak closest to
              t
              = 0 is not shown in
              Figure 5-24
              because it must lie beyond the left edge of the display. However, the positive peak shown in the display is located at
              t
              =
              T
S
              +
              T
0
              since it is one cycle after
              t
              =
              T
S
              . We can write
            




              which yields
              T
S
              = 0.55 -
              T
0
              = -025 ms. As expected,
              T
S
              is negative because the nearest positive peak is to the left of
              t
              = 0.
            

              Given
              T
S
              , we can calculate the remaining parameters of the sinusoid as follows:
            





              Finally, the three alternative expressions for the displayed sinusoid are
            




■

 








Exercise 5-10

              Derive an expression for the sinusoid displayed in
              Figure 5-24
              when
              t
              = 0 is placed in the middle of the display.
            


Answer:



υ
              (
              t
              ) = 20 cos(7854
              t
              - 22.5°) V
            








Exercise 5-11
Sketch the waveform described by





Answer:



              See
              Figure 5-25








FIGURE 5-25









Properties of Sinusoids

            In general, a waveform is said to be
            periodic
            if
          




            for all values of
            t
            . The constant
            T
0
            is called the period of the waveform if it is the smallest nonzero interval for which
            υ
            (
            t
            +
            T
0
            ) =
            υ
            (
            t
            ). Since this equality must be valid for all values of
            t
            , it follows that periodic signals must have eternal waveforms that extend indefinitely in time in both directions. Signals that are not periodic are called
            aperiodic,
            for example, an exponential or a step waveform.
          
The sinusoid is a periodic signal since




            But cos(
            x
            + 2π) = cos(
            x
            ). Consequently,
          




            for all
            t
            .
          


            The
            additive property
            of sinusoids states that summing two or more sinusoids with the same frequency yields a sinusoid with different amplitude and phase parameters but the same frequency. To illustrate, consider two sinusoids
          




            The waveform
            υ
3
            (
            t
            ) =
            υ
1
            (
            t
            ) +
            υ
2
            (
            t
            ) can be written as
          




            because cosine and sine are linearly independent functions. We obtain the Fourier coefficients of the sum of two sinusoids by adding their Fourier coefficients, provided the two have the same frequency.
            

Caution:


            The summation must take place with the sinusoids in Fourier coefficient form. sums of sinusoids
            cannot
            be found by adding amplitudes and phase angles.
          











EXAMPLE 5-8



(a) Find the period and the cyclic and radian frequencies for each of the following sinusoids:





                      (b) Find the waveform of
                      υ
3
                      (
                      t
                      ) =
                      υ
1
                      (
                      t
                      ) +
                      υ
2
                      (
                      t
                      ) V.
                    





SOLUTION:




                  (a) The two sinusoids have the same frequency
                  ω
0
                  = 2000 rad/s since a term 2000
                  t
                  appears in the arguments of
                  υ
1
                  (
                  t
                  ) and
                  υ
2
                  (
                  t
                  ). Therefore,
                  f
0
                  =
                  ω
0
                  /2π = 318.3 Hz and
                  T
0
                  = 1/
                  f
0
                  =3.14 ms.
                


                    (b) We use the additive property, since the two sinusoids have the same frequency. Beyond this checkpoint, the frequency plays no further role in the calculation. The two sinusoids must be converted to the Fourier coefficient form using
                    Eq. (5-23)
                    .
                  




                    The Fourier coefficients of the signal
                    υ
3
                    =
                    υ
1
                    +
                    υ
2
                    are found as
                  




                    The amplitude and phase angle of
                    υ
3
                    (
                    t
                    ) are found using
                    Eqs. (5-24)
                    and
                    (5-25)
                    :
                  





                    Two equivalent representations of
                    v
3
                    (
                    t
                    ) are
                  



and






■

 



            The
            derivative
            and
            integral
            properties state that when we differentiate or integrate a sinusoid, the result is another sinusoid with the same frequency:
          




            These operations change the amplitude and phase angle but do not change the frequency. The fact that differentiation and integration preserve the underlying waveform is a key property of the sinusoid. No other periodic waveform has this shape-preserving property. These three properties (additive, derivative, and integral) will be very useful in studying
            phasors
            in
            Chapter 8
            .
          





Exercise 5-12
Write an equation for the waveform obtained by integrating and differentiating the following signals:


                  (a)
                  υ
1
                  (
                  t
                  ) = 30cos(10
                  t
                  - 60°) V
                

                  (b)
                  υ
2
                  (
                  t
                  ) = 3 cos(4000π
                  t
                  ) - 4 sin(4000π
                  t
                  ) V
                

Answers:


                  (a)
                  


                  (b)
                  










Exercise 5-13

                A sinusoid has a period of 5 μs. At
                t
                = 0 the amplitude is 12 V. The waveform reaches its first positive peak after
                t
                = 0 at
                t
                = 4 μs. Find its amplitude, frequency, and phase angle.
              


Answers:



V
A
                = 38.8 V;
                f
0
                = 200 kHz; ϕ = +72°
              











Application Exercise 5-14



                You are in a Circuits laboratory and are required to characterize a voltage signal. You observe the signal on an oscilloscope as shown in
                Figure 5-26
                . You measure the voltage of two adjacent peaks as shown on the figure. Write an expression for the voltage in amplitude-phase form.
                








FIGURE 5-26








Answer:



υ
                (
                t
                ) = 169.7 cos (377
                t
                -  60°) V.
                

Note:


                This is the description of the standard 120-V, 60-Hz commercial voltage for the United States.
              





5-5 Composite Waveforms

          In the previous sections, we introduced the step, exponential, and sinusoidal waveforms. These waveforms are basic signals because they can be combined to synthesize all other signals used in this book. signals generated by combining the three basic waveforms are called
          composite signals.
          This section provides examples ofcomposite waveforms.
        












EXAMPLE 5-9


characterize the composite waveform generated by







SOLUTION:



              The first term in this waveform is simply a step function of amplitude
              V
A
              that occurs at
              t
              = 0. The second term involves the function
              u
              (-
              t
              ), whose waveform requires some discussion. strictly speaking, the general step function
              u
              (
              x
              ) is unity when
              x
              > 0 and zero when
              x
              < 0. That is,
              u
              (
              x
              ) is unity when its argument is positive and zero when it is negative. Under this rule, the function
              u
              (-
              t
              ) is unity when -
              t
              > 0 and zero when -
              t
              < 0, that is,
            




              which is the reverse of the step function
              u
              (
              t
              ).
              Figure 5-27
              shows how the two components combine to produce a composite waveform that extends indefinitely in both directions and has a jump discontinuity of 2
              V
A
              at
              t
              = 0. This composite waveform is called a
              signum
              function.
              ■








FIGURE 5-27



The signum waveform.














Exercise 5-15


Describe the following waveform:





Answer:



              There are only two terms present:
              υ
              (
              t
              ) = -
              V
A
              δ(
              t
              + 1) +
              V
A
              δ(
              t
              - 1) V
            


Discussion:

Each impulse function exists only at one point in time. Since all three impulse functions have a weight of
              1
              they simply multiply the value of the signum function at the time the impulses exist, namely, at t
              = -1, 0,
              and
              +1.
              The values are
              -
              V
A
              , 0,
              and
              +
              V
A
              ,
              respectively. The selective nature of multiplying a function by an impulse is called the

sifting property.















EXAMPLE 5-10
Characterize the composite waveform generated by subtracting an exponential from a step function with the same amplitude.




SOLUTION:


The equation for this composite waveform is




              For
              t
              < 0, the waveform is zero because of the step function. At
              t
              = 0, the waveform is still zero since the step and exponential cancel.
            




              For t ≫
              T
C
              , the waveform approaches a constant value
              V
A
              because the exponential term decays to zero. For practical purposes
              υ(t)
              is within less than 1% of its final value
              V
A
              when
              t
              = 5
              T
C
              . At
              
              . The waveform rises to about 63% of its final value in one time constant. All of the observations are summarized in the plot shown in
              Figure 5-28
              . This waveform is called an
              exponential rise.
              It is also sometimes referred to as a "charging exponential," since it represents the behavior of signals that occur during the buildup of voltage in resistor-capacitor circuits studied in
              chapter 7
              .
            







FIGURE 5-28



The exponential rise waveform.




■

 








Exercise 5-16


                (a) sketch the waveform described by the following:
                




                (b) What is the value of the voltage at
                t
                =
                T
C
                ? And at 5
                T
C
                ?
              

Answers:


                (a) see
                Figure 5-29
                .
              
(b) -4.48 V; -9.90 V










FIGURE 5-29













              Exercise 5-17
            

Figure 5-30
              contains a waveform that is called a double-sided exponential, which is defined as the sum of a normal exponential and a reversed exponential. This waveform is 1 at
              t
              = 0 and decays exponentially to zero in both directions along the time axis. Write an expression for this waveform.
            


Answer:



υ
              (
              t
              ) =
              e

                -α|
                t
                |
              
              V.
            









FIGURE 5-30
















EXAMPLE 5-11

                  Characterize the composite waveform obtained by multiplying the ramp
                  r
                  (
                  t
                  )/
                  T
C
                  times an exponential.
                




SOLUTION:


The equation for this composite waveform is




              For
              t
              < 0, the waveform is zero because of the step function. At
              t
              = 0 the waveform is zero because
              r
              (0) = 0. For
              t
              > 0, there is a competition between two effects—the ramp increases linearly with time while the exponential decays to zero. Since the composite waveform is the product of these terms, it is important to determine which effect dominates. In the limit, as
              t
              → ∞, the product of the ramp and exponential takes on the indeterminate form of infinity times zero. A single application of
              l'Hopital's rule,
              then, shows that the exponential dominates, forcing the
              υ
              (
              t
              ) to zero as
              t
              becomes large. That is, the exponential decay overpowers the linearly increasing ramp, as shown by the graph in
              Figure 5-31
              . The waveform obtained by multiplying a ramp by a decaying exponential is called a
              damped ramp.








FIGURE 5-31



The damped ramp waveform.




■

 








Exercise 5-18
The equation describing a damped ramp is as follows:




(a) Find the time at which the function reaches its maximum value.

                (b) What is the value of
                υ
                (
                t
                ) at the maximum?
              

Answers:


                (a) The maximum occurs at
                t
                =
                T
C
                .
              

                (b)
                υ
                (
                T
C
                ) = 0.368
                V
A
                .
              
















                  EXAMPLE 5-12
                

                  Characterize the composite waveform obtained by multiplying sin
                  ω
0
t
                  by an exponential.
                




SOLUTION:


In this case, the composite waveform is expressed as




Figure 5-32
              shows a graph of this waveform for
              T
0
              = 2
              T
C
              . For
              t
              < 0, the step function forces the waveform to be zero. At
              t
              = 0, and periodically thereafter, the waveform passes through zero because sin(
              nπ
              ) = 0. The waveform is not periodic, however, because the decaying exponential gradually reduces the amplitude of the oscillation. For all practical purposes, the oscillations become negligibly small for
              t
              > 5
              T
C
              . The waveform obtained by multiplying a sinusoid by a decaying exponential is called a
              damped sine.








FIGURE 5-32



The damped sine waveform.




■

 








APPLICATION EXAMPLE 5-13

              Underdamped second-order systems produce the damped sinusoidal waveform shown in
              Figure 5-32
              . When presented with such a display, it may be necessary to determine an expression for the resulting waveform. consider the damped sinusoid shown in
              Figure 5-33
              . We will find an approximate expression.
            







FIGURE 5-33








              We need to determine the waveform's amplitude
              V
A
              , its time constant
              T
C
              , and its oscillatory frequency,
              ω
0
              . We start by estimating the coordinates of the first peak, (0.00075 s, 47 V). To calculate the time constant, we need another peak. We could select the second peak, but if we choose a later peak we can get a more accurate result. Hence, we choose the fourth peak, (0.0195 s, 7.0 V). We can find the time constant from the decrement property noted earlier in
              Example 5-6
Eq. (5-18)
              .
            




              We can use the same two points for finding
              T
0
              . However, we must divide the result by 3 since there are three cycles involved.
            




              Then, we find the radian frequency
              ω
0
              from the period:
            




              Since the waveform has a phase shift, we find the time shift
              T
S
              by measuring the time from when the function is zero to the first peak of the cosine. This was our first peak, 0.00075 s. We can then calculate the phase shift from
              Eq. (5-21)
              :
            



We can then write what we have found thus far in our waveform equation:




              We can find
              V
A
              by substituting a value for
              υ
              (
              t
              ) at a time we know. The easiest is at
              t
              = 0, where
              υ
              (0) ≈ 36 V.
            



Finally, our desired waveform is





Discussion:


                The function used to generate the waveform in
                Figure 5-33
                was
              





The errors are all small, with the phase angle having the largest error of 4%. The size of the errors is, of course, dependent on how accurately one can read the display.












              Application Exercise 5-19
            

              For the damped sinusoid waveform shown in
              Figure 5-34
              , determine an approximate expression for
              υ
              (
              t
              ).
            







FIGURE 5-34








Answer:



              The generating waveform is
              υ
              (
              t
              ) = 100
              e

                -100
                t

              sin(2000
              t
              )
              u
              (
              t
              ) V.
            









FIGURE 5-35



The double exponential waveform.













EXAMPLE 5-14
Characterize the composite waveform obtained as the difference of two exponentials with the same amplitude.




SOLUTION:


The equation for this composite waveform is




              For
              T
1
              >
              T
2
              the resulting waveform is illustrated in
              Figure 5-35
              (plotted for
              T
1
              = 2
              T
2
              ). For
              t
              < 0 the waveform is zero. At
              t
              = 0 the waveform is still zero, since
            




              For
              t
              ≫
              T
1
              the waveform returns to zero because both exponentials decay to zero. For 5
              T
1
              >
              t
              > 5
              T
2
              the second exponential is negligible and the waveform essentially reduces to the first exponential. conversely, for
              t
              ≪
              T
1

              the first exponential is essentially constant, so the second exponential determines the early time variation of the waveform. The exponential that lasts the longest is called the dominant exponential, in this case
              T
1
              . The waveform is called a
              double exponential,
              since both exponential components make important contributions to the waveform.
              ■











              Exercise 5-20
            
A double exponential waveform is given as





                (a) What is the value of
                υ
                (
                t
                ) at the maximum, and at what time does it occur?
              
(b) What is the time constant of the dominant exponential?

                (c) Use MATLAB to plot the curve and verify the results of (a) using the cursor tool.
                Hint:
                see
                Appendix D
                .
              

Answers:


                (a) The maximum value is 3.257 V, and it occurs at
                t
                = 611 μs.
              
(b) The dominant exponential is the first one, since it has the longer time constant of 1 ms versus 400 μs for the second exponential.

                (c) see
                Figure 5-36
                .
              








FIGURE 5-36





















EXAMPLE 5-15


Characterize the composite waveform defined by







SOLUTION:



              The waveform is the sum of a constant (dc) term and three sinusoids at different frequencies. The first sinusoidal component is called the
              fundamental
              because it has the lowest frequency. As a result, the frequency
              f
0
              = 500 Hz is called the
              fundamental frequency.
              The other sinusoidal terms are said to be harmonics because
              
              their frequencies are integer multiples of
              f
0
              . Specifically, the second sinusoidal term is called the
              second harmonic
              (2
              f
0
              = 1000 Hz), while the third term is the
              third harmonic
              (3
              f
0
              = 1500 Hz).
              Figure 5-37
              shows a plot of this waveform. Note that the waveform is periodic with a period equal to that of the fundamental component, namely,
              T
0
              = 1/
              f
0
              = 2 ms. The decomposition of a periodic waveform into a sum of harmonic sinusoids is called a
              Fourier series,
              a topic we will study in detail in
              Chapter 13
              . In fact, the waveform in this example is the first four terms in the Fourier series for a 10-V sawtooth wave of the type shown in
              Figure 5-2
              .
            







FIGURE 5-37







■

 








Exercise 5-21
For the following composite waveforms, determine the maximum amplitude, the approximate duration, and the type of waveform represented:


                (a)
                υ
1
                (
                t
                ) = [25 sin 1000
                t
                ][
                u
                (
                t
                ) -
                u
                (
                t
                − 10)] V
              

                (b)
                υ
2
                (
                t
                ) = [50 cos 1000
                t
                ][
                e

                  −200
                  t

                ]
                u
                (
                t
                ) V
              

                (c)
                i
3
                (
                t
                ) = [3000
                te

                  −1000
                  t

                ]
                u
                (
                t
                ) mA
              

                (d)
                i
4
                (
                t
                ) = 10
                e

                  −5000|
                  t
                  |
                
                A
              

Answers:

(a) 25 V, 10 s, gated sinusoid
(b) 50 V, 25 ms, decaying sinusoid
(c) 1.10 mA, 5 ms, damped ramp
(d) 10 A, 2 ms, double-sided exponential












Exercise 5-22


Characterize the following waveform defined by




              where
              b

n

              = 4
              V
A
              /π
              n
              ,
              V
A
              = 10 V,
              f
0
              = 1000 Hz, and
              n
              = 1, 3, 5, 7, 9, 11... by plotting the first six
              n
              terms for a half period of the fundamental frequency
              f
0
              . (
              Hint:
              Vary
              t
              from 0 to 500 μs in 50 μs steps. Excel is useful here.) What waveform in
              Figure 5-2
              does this function best resemble?
            


Answers:



              A plot using Excel of the odd terms 1 through 11 is shown in
              Figure 5-38
              . The plot resembles a half-cycle of a 10-V 1000-Hz square wave. As the value of
              n
              increases, the plot appears more like a square wave.
            









FIGURE 5-38








5-6 Waveform Partial Descriptors

          An equation or graph defines a waveform for all time. The value of a waveform
          υ
          (
          t
          ) or
          i
          (
          t
          ) at time
          t
          is called the
          instantaneous value
          of the waveform. If one were to replace
          t
          with a particular time and evaluate the equation, one would obtain the value of the waveform for that particular or instant of time. We often use parameters called
          partial descriptors
          that characterize important features of a waveform but do not give a complete description. These partial descriptors fall into two categories: (1) those that describe temporal features and (2) those that describe amplitude features.
        

Temporal Descriptors

            Temporal descriptors identify waveform attributes relative to the time axis. For example, waveforms that repeat themselves at fixed time intervals are said to be
            periodic.
            Stated formally,
          




A signal
υ
                (
                t
                )
                is periodic if υ(t + T
0
                ) =
                υ(t) for all t, where the period
T
0
is the smallest value that meets this condition. Signals that are not periodic are called aperiodic.




            The fact that a waveform is periodic provides important information about the signal but does not specify all of its characteristics. Thus, the fact that a signal is periodic is itself a partial description, as is the value of the period. The eternal sinewave is the premier example of a periodic signal. The square wave and triangular wave in
            Figure 5-2
            are also periodic. Examples of aperiodic waveforms are the step function, exponential, and damped sine.
          

            Waveforms that are identically zero prior to some specified time are said to be
            causal.
            stated formally,
          



A signal
υ
                (
                t
                )
                is causal if there exists a value of T such that
υ
                (
                t
                ) = 0
                for all t
                <
                T; otherwise it is noncausal.




            It is usually assumed that a causal signal is zero for
            t
            < 0, since we can always use time shifting to make the starting point of a waveform at
            t
            = 0. Examples of causal waveforms are the step function, exponential, and damped sine. The eternal sine-wave or a constant dc signal are, of course, noncausal.
          

            Causal waveforms play a central role in circuit analysis. When the input driving force
            x
            (
            t
            ) is causal, the circuit response
            y
            (
            t
            ) must also be causal. That is, a physically realizable circuit cannot anticipate and respond to an input before it is applied. causality is an important temporal feature, but only a partial description of the waveform.
          


Amplitude Descriptors

            Amplitude descriptors are positive scalars that describe signal strength. Generally, a waveform varies between two extreme values denoted as
            V
MAX
            and
            V
MIN
            . The
            peak-to-peak value
            (
            V
PP
            ) describes the total excursion of
            υ
            (
            t
            ) and is defined as
          


(5-28)




            Under this definition,
            V
PP
            is always positive even if
            V
MAX
            and
            V
MIN
            are both negative. The
            peak value
            (
            V
P
            ) is the maximum of the absolute value of the waveform. That is,
          


(5-29)




            The peak value is a positive number that indicates the maximum absolute excursion of the waveform from zero.
            Figure 5-39
            shows examples of these two amplitude descriptors.
          







FIGURE 5-39



Maximum value
                (
                V
MAX
                ),
                minimum value
                (
                V
MIN
                ),
                peak value
                (
                V
P
                ),
                and peak-to-peak value
                (
                V
PP
                ).
              



            The peak and peak-to-peak values describe waveform variation using the extreme values. The average value smooths things out to reveal the underlying waveform baseline. Average value is the area under the waveform over some period of time
            T
            , divided by that time period. Mathematically, we define
            average value
            (
            V
avg
            ) over the time interval
            T
            as
          



(5-30)





            For periodic signals, the period
            T
0
            is used as the averaging interval
            T.



            For some periodic waveforms, the integral in
            Eq. (5-30)
            can be estimated graphically. The net area under the waveform is the area above the time axis minus the area below the time axis. For example, the two waveforms in
            Figure 5-39
            obviously have nonzero average values. The waveform in
            Figure 5-39
            (a) has a negative average value because the negative area below the time axis more than cancels the area above the axis. Similarly, the waveform in
            Figure 5-39
            (b) clearly has a positive average value.
          

            The average value indicates whether the waveform contains a constant, non-time-varying component. The average value is also called the
            dc component
            because dc signals are constant for all t. On the other hand, the
            ac components
            have zero average value and are periodic. For example, the waveform in
            Example 5-15





            has a 5-V average value due to its dc component. This has the effect of shifting the entire waveform up by 5 V. The three sinusoids are ac components because they are periodic and have zero average value. Sinusoids have zero average value because over any given cycle the positive area above the time axis is exactly canceled by the negative area below.
            
5









FIGURE 5-40


















EXAMPLE 5-16



                    Find the peak, peak-to-peak, and average values of the periodic input and output waveforms in
                    Figure 5-40
                    of a half-wave rectifier.
                  




SOLUTION:



                The input waveform is a sinusoid shown in
                Figure 5-40
                (a) whose amplitude descriptors are
              




                The output waveform is obtained by clipping off the negative half-cycle of the input sinusoid shown in
                Figure 5-40
                (c). The amplitude descriptors of the output waveform are
              




                The output has a nonzero average value, since there is a net positive area under the waveform. The upper limit in
                Eq. (5-30)
                can be taken as
                T
0
                /2, since the waveform is zero from
                T
0
                /2 to
                T
0
                .
              




                The signal processor produces an output with a dc value from an input with no dc component. Such circuits are called ac-to-dc converters, much like the plug-ins for cell phones and tablets. The more electronic name for such circuits is rectifiers. Rectifying circuits described in electronics courses produce waveforms like the output in
                Figure 5-40
                (c).
                ■











Exercise 5-23



                For the pulse waveform in
                Figure 5-41
                , find
                V
MAX
                ,
                V
MIN
                ,
                V
pp
                ,
                V
pp
                , and
                V
avg
                .
              


Answers:



V
MAX
                =
                V
A
                ,
                V
MIN
                = -
                V
A
                ,
                V
p
                =
                V
A
                ,
                V
pp
                = 2
                V
A
                ,
                V
avg
                = 0 V
              









FIGURE 5-41










            Root-mean-Square Value
          

            The
            root-mean-square value
            (
            V
rms
            ) is a measure of the average power carried by the signal. The instantaneous power delivered to a resistor
            R
            by a voltage
            υ
            (
            t
            ) is
          



(5-31)





            The average power delivered to the resistor in time span
            T
            is defined as
          



(5-32)





            Combining
            Eqs. (5-31)
            and
            (5-32)
            yields
          



(5-33)





            The quantity inside the large brackets in
            Eq. (5-33)
            is the average value of the square of the waveform. The units of the bracketed term are volts squared. The square root of this term defines the amplitude partial descriptor
            V
rms
            .
          



(5-34)





            The amplitude descriptor
            V
rms
            is called the root-mean-square (rms) value because it is obtained by taking the square root of the average (mean) of the square of the waveform. For periodic signals, the averaging interval is one cycle since such a waveform repeats itself every
            T
0
            seconds.
          

            We can express the average power delivered to a resistor in terms of
            V
rms
            as
          


(5-35)




            The equation for average power in terms of
            V
rms
            has the same form as the power delivered by a dc signal. For this reason, the rms value was originally called the
            effective value,
            although this term is no longer common. If the waveform amplitude is doubled, its rms value is doubled, and the average power is quadrupled. Commercial electrical power systems use transmission voltages in the range of several hundred kilovolts (rms) to efficiently transmit power over long distances.
          










EXAMPLE 5-17

                    Find the average and rms values of the sinusoid and sawtooth waveforms in
                    Figure 5-42
                    .
                  









FIGURE 5-42








SOLUTION:



                As noted previously, the sinusoid has an average value of zero. The sawtooth clearly has a positive average value. By geometry, the net area under one cycle of the sawtooth waveform is
                V
A
T
0
                /2, so its average value is (1/
                T
0
                )(
                V
A
T
0
                /2) =
                V
A
                /2. To obtain the rms value of the sinusoid, we apply
                Eq. (5-34)
                as
                




For the sawtooth waveform, the rms value is found as:




■

 








Exercise 5-24

                Find the peak, peak-to-peak, average, and rms values of the periodic waveform in
                Figure 5-43
                .
              


Answers:














FIGURE 5-43













Exercise 5-25


Classify each of the following signals as periodic or aperiodic and causal or noncausal. Then calculate the average and rms values of the periodic waveforms, and the peak and peak-to-peak values of the other waveforms.


                  (a)
                  υ
1
                  (
                  t
                  ) = 99 cos 3000
                  t
                  - 132 sin 3000
                  t
                  V
                

                  (b)
                  υ
2
                  (
                  t
                  ) = 34[sin 800π
                  t
                  ][
                  u
                  (
                  t
                  ) -
                  u
                  (
                  t
                  - 0.03)] V
                

                  (c)
                  i
3
                  (
                  t
                  ) = 120[
                  u
                  (
                  t
                  + 5) -
                  u
                  (
                  t
                  - 5)]mA
                

                  (d)
                  i
4
                  (
                  t
                  ) = 50 A
                

Answers:


                  (a) Periodic, noncausal,
                  V
avg
                  = 0, and
                  V
rms
                  = 117 V
                

                  (b) Aperiodic, causal,
                  V
p
                  = 34 V, and
                  V
pp
                  = 68 V
                

                  (c) Aperiodic, causal,
                  V
p
                  =
                  V
pp
                  = 120 mA
                

                  (d) Aperiodic, noncausal,
                  V
p
                  = 50 A, and
                  V
pp
                  = 0
                










                APPLICATION
                EXAMPLE 5-18


                The operation of a digital system is coordinated and controlled by a periodic waveform called a clock. The
                clock waveform
                provides a standard timing reference to maintain synchronization between signal-processing results that become valid at different times during the clock cycle. Because of differences in digital circuit delays, there must be agreed-upon instants of time when circuit outputs can be treated as valid. The clock defers further signal processing until slower and faster outputs settle down when the clock signals the start of the next signal-processing cycle.
              

Figure 5-44
                shows an idealized clock waveform as a periodic sequence of rectangular pulses. While we could easily write an exact expression for the clock waveform, we are interested here in discussing its partial descriptors. The first descriptor is the period
                T
0
                or equivalently the
                clock frequency
f
0
                = 1/
                T
0
                . Clock frequency is a common measure of signal-processing speed and can take values into the GHz range. The pulse duration
                T
                is the time interval in each cycle when the pulse amplitude is high (not zero). In waveform terminology, the ratio of the time in the high state to the period, that is,
                T
                /
                T
0
                , is called the
                duty cycle,
                usually expressed as a percentage. The
                pulse edges
                are the transition points at which the pulse changes states. There is a
                rising edge
                at the low-to-high transition and a
                falling edge
                at the high-to-low transition.
              


                The pulse edges define the agreed-upon time instants at which the circuit outputs can be treated as valid inputs to other circuits. This means that circuit outputs must settle down during the time period between successive edges. some synchronous operations are triggered by the rising edge and others by the falling edge. To provide equal settling times for both cases requires equal time between edges. In other words, it is desirable for the clock duty cycle to be 50%. As a result, the clock waveform is essentially a raised square wave whose dc offset equals one half of the peak-to-peak value.
              

                The system clock
                C
0
                in
                Figure 5-44
                is generated at some point in a circuit and then distributed to other locations. The clock distribution network almost invariably introduces delays, as illustrated by
                C
1
                and
                C
2
                in
                Figure 5-44
                .
                
                  Clock delay (
                  t
D
                  )
                
                is defined as the time difference between a clock edge at a given location and the corresponding edge in the system clock at the point where it was generated. Delay is not necessarily a bad thing unless unequal delays cause the edges to be skewed, as indicated by the offset between
                C
1
                and
                C
2
                in
                Figure 5-44
                . When delays are significantly different, there is uncertainty as to instants of time at which further signal processing can safely proceed. This delay dispersion is called
                
                  clock skew (
                  t
S
                  ),
                
                defined as the time difference between a clock edge at a given location and the corresponding edge at another location. controlling clock skew is an important consideration in the design of the clock distribution network in high-speed very-large-scale integrated (VLsI) circuits.
              







FIGURE 5-44







                Thus, partial descriptors of clock waveforms include
                frequency, duty cycle, edges, delay,
                and
                skew.
                The coming chapters treat dynamic circuits that modify input waveforms to produce outputs with different partial descriptors. In particular, dynamic circuit elements cause changes in a clock waveform, especially the partial descriptors of edges, delay, and skew.
              










                  APPLICATION
                  EXAMPLE 5-19


An electrocardiogram (ECG) is a valuable diagnostic tool used in cardiovascular medicine. The ECG is based on the fact that the heart emits measurable bioelectric signals that can be recorded to evaluate the functioning of the heart as a mechanical pump. These signals were first observed in the late 19th century, and subsequent signal processing developments have led to the advanced technology of present-day ECG equipment.
The bioelectric signals of the heart muscle are measured and recorded through the placement of skin electrodes at various sites on the surface of the body. The site selection as well as discussion of the functions of the cardiac muscle are beyond the scope of this example. Rather, our purpose is to introduce some of the useful partial descriptors of ECG waveforms.

                In bioelectric terminology, the normal ECG waveform in
                Figure 5-45
                is composed of a P wave, a QRS complex, and a T wave. This sequence of pulses depicts the electrical activity that stimulates the correct functioning of the cardiac muscle. The flat baseline between successive events is called isoelectric, which means there is no bioelectric activity and the heart muscle returns to a resting state. The body'snatural pacemaker produces a nominally periodic waveform under the resting conditions used with ECG tests.
              







FIGURE 5-45








                Partial waveform descriptors used to analyze ECG waveforms include:
              



1.

                  The
                  heart rate
                  (1/
                  T
0
                  ), which is normally between 60 and 100 beats per minute.
                


2.

                  The
                  PR interval
                  (normally 0.12-0.20 seconds), which is the time between the start of the P wave and the start of the QRS complex.
                


3.

                  The
                  QRS interval
                  (normally 0.06-0.10 seconds), which is the time between onset and end of the QRS complex.
                


4.

                  The
                  ST segment
                  is the signal level between the end of the QRS complex and the start of the T wave. This level should be the same as the isoelectric baseline between successive pulses.
                

Departures from these normal conditions serve as diagnostic tools in cardiovascular medicine. some of the abnormal waveform features of concern include an irregular heart rate, a missing P wave, a prolonged QRS interval, or an elevated ST segment. Departures from nominal conditions allow the trained clinician to diagnose the situation, especially when abnormal features occur in certain combinations. However, it is not our purpose to discuss the medical interpretation of ECG waveform abnormalities. Rather, this example illustrates that bioelectric signals carry information and that the information is decoded by analyzing the signal's partial waveform descriptors.




Signals and Software Tools

            The value of software tools is readily apparent when circuits are tested using a variety of signals. The Multisim software will allow us to rapidly simulate circuit behavior under a variety of excitations such as steps, exponentials, sinusoids, and composite signals.
            Appendix D
            discusses how to use the various signal sources available in Multisim. In addition, the appendix examines the calculating, plotting, and integration functions available in MATLAB to create professional graphs and to efficiently calculate partial waveform descriptors. In the appendix, there are examples, exercises, sample problems, and MATLAB software routines are provided that you can use to help solve problems found in the text.
          



Summary


            A
            waveform
            is an equation or graph that describes a voltage or current as a function of time. Most signals of interest in electrical engineering can be derived using three basic waveforms: singularity functions, exponentials, and sinusoids.
          

            The
            step function
            is defined by its amplitude and time-shift parameters. The impulse, step, and ramp are called
            singularity functions
            and are often used as test inputs for circuit analysis purposes.
          

            The
            exponential
            waveform is defined by its amplitude, time constant, and time-shift parameter. For practical purposes, the duration of the exponential waveform is five time constants.
          

            A
            sinusoid
            can be defined in terms of three types of parameters:
            amplitude
            (either
            V
A
            or the Fourier coefficients
            a
            and
            b
            ),
            time shift
            (either
            T
S
            or the phase angle ϕ), and
            time/frequency
            (either
            T
0
            or
            f
0
            or
            ω
0
            ).
          

            Many
            composite waveforms
            can be derived using the three basic waveforms. some examples are the signum function, damped ramp, damped sinusoid, exponential rise, and double exponential.
          

Partial descriptors
            are used to classify or describe important signal attributes. Two important temporal attributes are
            periodicity
            and
            causality.
            Periodic waveforms repeat themselves every
            T
            0 seconds. causal signals are zero for
            t
            < 0. some important amplitude descriptors are peak value
            V
p
            , peak-to-peak value
            V
pp
            , average value
            V
avg
            , and root-mean-square value
            V
rms
            .
          
Software programs like Multisim and MATLAB can generate appropriate signals for use in simulation, analysis, and computation of circuit responses. MATLAB can perform numeric and symbolic integration to assist with signal analysis.





          Chapter 5 Problems
        






              Objective 5-1 Basic Waveforms (
              Sects. 5-2
              ,
              5-3
              ,
              5-4
              )
            
Given an equation, graph, or word description of a linear combination of step, ramp, exponential, or sinusoid waveforms

(a) Construct an alternative description of the waveform.
(b) Find the parameters or properties of the waveform.
(c) Construct new waveforms by integrating or differentiating the given waveform.

                (d) Generate the basic waveforms in MATLAB or Multisim and use them appropriately to solve problems or simulate circuits. (See
                Appendix D
                .)
              


              See
              Examples 5-1
              to
              5-8
              and
              Exercises 5-1
              to
              5-14
              .
            





5-1
            Sketch the following waveforms:
            

(a)
υ
1
                (
                t
                ) =
                u
                (
                t
                ) -
                u
                (
                t
                - 3) V
              

(b)
υ
2
                (
                t
                ) = 5
                u
                (
                t
                + 1) - 5
                u
                (
                t
                - 2) V
              

(c)
i
3
                (
                t
                ) = -2
                u
                (
                t
                ) -
                u
                (
                t
                - 1) + 3
                u
                (
                t
                - 2) μA
              

(d)
i
4
                (
                t
                ) = 10
                u
                (-
                t
                ) mA
              



5-2
            Using appropriate step functions, write an expression for each waveform in
            Figure P5-2
            .
            






FIGURE P5-2









5-3
            Sketch the following waveforms:
            

(a)
υ
1
                (
                t
                ) = 12-2
                u
                (
                t
                ) V
              

(b)
i
2
                (
                t
                ) = -2
                u
                (
                t
                + 0.003) + 2
                u
                (
                t
                - 0.003) μA
              

(c)
υ
3
                (
                t
                ) =
                t
                [
                u
                (
                t
                - 1) -
                u
                (
                t
                - 2)] mV
              

(d)
i
4
                (
                t
                ) = 5
                u
                (-
                t
                ) A
              



5-4
            Sketch the following waveforms:
            

(a)
υ
1
                (
                t
                ) =
                r
                (
                t
                + 2) -
                r
                (
                t
                - 2) V
              

(b)
υ
2
                (
                t
                ) = 4 +
                r
                (
                t
                + 1) - 2
                r
                (
                t
                - 1) +
                r
                (
                t
                - 3) V
              

(c)



(d)






5-5
            Express each of the following signals as a sum of singularity functions.
            

(a)



(b)



(c)





5-6
            Express the waveform in
            Figure P5-6
            as a sum of singularity functions.
            






FIGURE P5-6









5-7
            Express each of the waveforms in
            Figure P5-7
            as a sum of singularity functions.
            






FIGURE P5-7









5-8
            Using its pulse voltage source, generate on Multisim a waveform
            υ
            (
            t
            ) that starts at
            t
            = 1 ms and consists of a pulse train of 5-V pulses with a 2-ms pulse width that repeat every 8 ms. Display two full pulses.
          


5-9
            Sketch the following exponential waveforms. Find the amplitude and time constant of each waveform.
            

(a)
υ
1
                (
                t
                ) = 5
                e

                  -2
                  t

u
                (
                t
                ) V
              

(b)
υ
2
                (
                t
                ) = 5
                e

                  -2
                  t

u
                (
                t
                - 1) V
              

(c)
υ
3
                (
                t
                ) = 5
                e

                  -2(
                  t
                  -1)
                
u
                (
                t
                ) V
              

(d)
υ
4
                (
                t
                ) = 5
                e

                  -2(
                  t
                  -1)
                
u
                (
                t
                - 1) V
              




5-10
            In the lab, you see the waveform on the oscilloscope shown in
            Figure P5-10
            . Write an expression for the waveform. Note that
            t
            = 0 is on the far-left side of the display.
            (Hint:
Eq. (5-18)
            is useful.)
            






FIGURE P5-10









5-11
            Half-life,
            t
1/2
            , is the time required for a quantity to shrink to half its initial value. Radioactive elements are often defined by their half-life radioactive decay given by
            
            , where
            N
0
            is the initial quantity and τ is the element's mean lifetime. The half-life is related to the mean lifetime by
            t
1/2
            = τ ln 2. suppose a particular element has a half-life of 200 ps. Find the mean lifetime of the decay. If there are 100 gm of a particular element at
            t
            = 0, how many are there after 1 ns?
          

5-12
            Write an expression for the waveform in
            Figure P5-12
            .
            






FIGURE P5-12









5-13

            Design an exponential waveform that fits entirely within the nonshaded region in
            Figure P5-13
            .
            






FIGURE P5-13








5-14

            Design an exponential waveform that fits entirely within the nonshaded region in
            Figure P5-14
            .
            






FIGURE P5-14









5-15
            Find the period, frequency, amplitude, time shift, and phase angle of the following sinusoids.
            

(a)
υ
1
                (
                t
                ) = 240 cos (120π
                t
                ) - 240 sin (120π
                t
                ) V
              

(b)
υ
2
                (
                t
                ) = -30 cos (50 kπ
                t
                ) + 40 sin (50 kπ
                t
                ) V
              




5-16


(a)
                Plot the waveform of each sinusoid in Problem 5-15 by hand.
              

(b)
                Use Multisim to produce the waveform in Problem 5-15(a).
              

(c)
                Use MATLAB to produce the waveform in Problem 5-15(b).
              




5-17
            Write an expression for the sinusoid in
            Figure P5-17
            . What are the phase angle and time shift of the waveform?
            






FIGURE P5-17









5-18
            Write an expression for the sinusoid in
            Figure P5-18
            . What are the phase angle and time shift of the waveform?
            






FIGURE P5-18









5-19
            Find the Fourier coefficients, cyclic frequency, and radian frequency of the following sinusoids:
            

(a)
υ
                (
                t
                ) = 50 cos (100π
                t
                + 36.9°) V
              

(b)
i
                (
                t
                ) = 240 cos (1200π
                t
                - 90°) mA
              




5-20
            For the following sinusoid:
            υ
            (
            t
            ) = 10cos(2π200
            t
            + 60°) V
            

(a)
                Find the Fourier coefficients, cyclic frequency, and radian frequency.
              

(b)
                Plot the waveform by hand.
              

(c)
                Use MATLAB to produce the waveform.
              

(d)
                Use Multisim to produce the waveform.
              







                  Objective 5-2 Composite Waveforms (
                  Sect. 5-5
                  )
                
Given an equation, graph, or word description of a composite waveform

(a) construct an alternative description of the waveform.
(b) Find the parameters or properties of the waveform.

                    (c) Generate the composite waveforms in MATLAB or Multisim and use them appropriately to solve problems or simulate circuits. (see
                    Appendix D
                    .)
                  


                  See
                  Examples 5-9
                  to
                  5-15
                  and
                  Exercises 5-15
                  to
                  5-22
                  .
                






5-21
            Consider the following composite waveforms.
            

(a)
υ
1
                (
                t
                ) = 15[l -
                e

                  -25,000
                  t

                ]
                u
                (
                t
                ) V
              

(a)
υ
2
                (
                t
                ) = -2[
                e

                  -
                  t

                -
                e

                  -5
                  t

                ]
                u
                (
                t
                ) V
              

Sketch each on paper and then generate each using MATLAB and compare the results.



5-22
            Consider the following composite waveforms.
            

(a)
i
1
                (
                t
                ) = 10 + 5 sin(500π
                t
                )
                u
                (
                t
                ) mA
              

(b)
i
2
                (
                t
                ) = 50 [
                e

                  −1000
                  t

                + cos(2000π
                t
                )]
                u
                (
                t
                ) mA
              

Sketch each by hand and then generate each using MATLAB and compare the results.




5-23
            The two signals shown in
            Figure P5-23
            are multiplied together. Write an expression for their output.
            






FIGURE P5-23








5-24
            Write an expression for the composite sinusoidal waveform in
            Figure P5-24
            .
            






FIGURE P5-24









5-25
            Write an expression for the composite sinusoidal waveform in
            Figure P5-25
            .
            






FIGURE P5-25








5-26
            Write an expression for the composite exponential waveform in
            Figure P5-26
            . (
            Hint:
Eq. (5-18)
            might be useful.)
            






FIGURE P5-26










5-27
            Write an expression for the composite exponential waveform in
            Figure P5-27
            .
            






FIGURE P5-27









5-28
            Write an expression for the composite exponential waveform in
            Figure P5-28
            . Then use MATLAB to construct the same waveform and compare the results.
            






FIGURE P5-28









5-29
            For the double exponential
            υ
            (
            t
            ) = -5[
            e

              −α
              t

            -
            e

              −10
              t

            ]
            u
            (
            t
            ) V shown in
            Figure P5-29
            , find α.
            






FIGURE P5-29








5-30
            Write an expression for the damped sine waveform in
            Figure P5-30
            .
            

Note:


            The exponential envelope was added to help in the determination of the damping exponential.
            






FIGURE P5-30









5-31
            A circuit response is shown in
            Figure P5-31
            that occurs when one exponential stops and another begins where the prior one left off. Determine an approximate expression for the waveform.
            






FIGURE P5-31








5-32
            An object-detection radar for a drone sends out the signal shown in
            Figure P5-32
            .
            

(a)
                Write an expression for the first two pulses of the signal.
              

(b)
                To avoid ambiguity, the radar receiver only accepts one pulse at a time. Considering the time for the pulse to reach an object and return to the receiver, what is the maximum distance that the radar can detect an obstacle? (
                Hint:
                The speed of light is 3 × 10
                8
                m/s.)
              








FIGURE P5-32













                  Objective 5-3 Waveform Partial Descriptors (
                  Sect. 5-6
                  )
                
Given a complete description of a basic or composite waveform

(a) Classify the waveform as periodic or aperiodic and causal or noncausal.
(b) Find the applicable partial waveform descriptors.
(c) Use appropriate software tools to calculate applicable partial waveform descriptors.


                  See
                  Examples 5-16
                  to
                  5-19
                  and
                  Exercises 5-23
                  to
                  5-25
                  .
                





5-33
            Find
            V
MAX
            ,
            V
MIN
            ,
            V
p
            ,
            V
pp
            ,
            V
avg
            , and
            V
rms
            for each of the following sinusoids.
            

(a)
υ
1
                (
                t
                ) = 84.84 cos (120π
                t
                ) + 84.84 sin (120π
                t
                ) V
              

(b)
υ
2
                (
                t
                ) = -40 cos (2000π
                t
                ) - 30 sin (2000π
                t
                ) V
              

(c)
υ
3
                (
                t
                ) = 10 + 10 cos (5000π
                t
                + 60°) V
              



5-34
            An exponential waveform given by
            i
            (
            t
            ) = 250
            e

              −1000
              t

u
            (
            t
            ) mA repeats every five time constants.
            

(a)
                Find
                I
p
                ,
                I
pp
                ,
                I
MAX
                , and
                I
MIN
                .
              

(b)
                Find
                I
avg
                and
                I
rms
                .
              

(c)
                Find the period
                T
0
                of the waveform.
              

(d)
                is the waveform causal or noncausal?
              




5-35
            Find
            V
MAX
            ,
            V
MIN
            ,
            V
p
            ,
            V
pp
            ,
            V
avg
            ,
            V
rms
            , and
            T
0
            for the periodic waveform in
            Figure P5-35
            .
            






FIGURE P5-35








5-36
Figure P5-36
            is the result of the sum of a fundamental and one of its harmonics (an integer multiple of the fundamental). Find
            V
MAX
            ,
            V
MIN
            ,
            V
p
            ,
            V
pp
            ,
            V
avg
            ,
            V
rms
            , and
            T
0
            for the waveform.
            






FIGURE P5-36










5-37
Figure P5-37
            displays the response of a circuit to a square wave signal. The response is a periodic sequence of exponential waveforms. Each exponential has a time constant of 1.6 ms.
            

(a)
                Find
                V
MAX
                ,
                V
MIN
                ,
                V
p
                ,
                V
pp
                , and
                T
0
                for the waveform.
              

(b)
                Use MATLAB to find
                V
avg
                and
                V
rms
                .
              








FIGURE P5-37








5-38
            Find
            V
MAX
            ,
            V
MIN
            ,
            V
avg
            , and
            V
rms
            of the offset sine wave
            υ
            (
            t
            ) =
            V
0
            +
            V
A
            cos(2π
            t
            /
            T
0
            ) V in terms of
            V
0
            and
            V
A
            .
          


5-39
            An offset sinewave is input into an inverter with gain of -10. The OP AMP has a
            V
CC
            of ±12 V. The output is shown (
            Figure P5-39
            ).
            

(a)
                Determine the input sinewave and the offset.
              

(b)
                Find the output's
                V
MAX
                ,
                V
MIN
                ,
                V
p
                ,
                V
pp
                ,
                V
avg
                , and
                T
0
                and determine if the waveform is causal or noncausal.
              








FIGURE P5-39








5-40
            A periodic waveform can be expressed as
            υ
            (
            t
            ) = -5 + 20 cos 500π
            t
            - 10 sin 1000π
            t
            + 5 cos 2000π
            t
            V
            

(a)
                What is the period of the waveform? What is the average value of the waveform? What is the amplitude of the fundamental (lowest frequency) component? What is the highest frequency in the waveform?
              

(b)
                Simulate the waveform in MATLAB or Excel and find
                V
MAX
                ,
                V
MIN
                ,
                V
p
                ,
                V
pp
                , and
                V
avg
                .
              





5-41
            Using Multisim, create the following waveforms and state if each waveform is causal or noncausal, periodic or nonperiodic:
            

(a)
                A step voltage switching from 0 to 5 V at
                t
                = 100 ms.
              

(b)
                A triangular wave that has amplitude of 75 V and a period of 10 ms.
              

(c)
                A cosine with amplitude of 100 V, radian frequency of 2000π rad/s, and a phase shift of -45°.
              


(d)
                A positive sawtooth wave with amplitude of 5 V and a period of 100 ms.
              

                (e) A charging exponential starting at - 10 V and growing to + 5 V with a
                T
C
                of 1 s.
              





Integrating Problems




5-42


              CHIRP Signals
            

              Compressed High-Intensity Radiated Pulse (CHIRP) are signals that change frequency and possibly also amplitude. They have uses in radar detection when applied at GHz frequencies. Another common application is with sonar. The navy uses it to detect objects including mines, seabed, outcroppings, and submarines. Sports fishermen use it to detect fish. The CHIRP signal shown in
              Figure P5-42
              is typical of a sonar used for the latter purpose. Low frequencies can penetrate deeper into the water but provide less detail, while higher frequencies provide more detail but do not penetrate as far as its energy is absorbed easier. Hence, CHIRP sonar gives the advantage of both.
            


(a)
                For the one pulse shown in
                Figure P5-42
                , estimate the start and stop frequencies and their respective amplitudes. Why do you think the amplitude is increased?
              

(b)
                Using Multisim's CHIRP source recreate your answer to see if it matches.
              








FIGURE P5-42









5-43

              Exponential Signal Descriptors
            
Several of the time descriptors used in digital data communication systems are based on exponential signals. In this problem, we explore three of these descriptors.


(a)
                The
                time constant of fall
                is defined as the time required for a pulse to fall from 70.7% to 26.0% of its maximum value. Assuming that the pulse decreases as
                
                , find the relationship between the time constant of fall and the time constant of the exponential decay.
              

(b)
                The
                rise time
                of a pulse is the time required for a pulse to rise from10% to 90% of its maximum value. Assuming that the pulse increases as
                
                , find the relationship between rise time and the time constant of the exponential rise.
              

(c)
                The
                leading-edge pulse time
                is defined as the time at which a pulse rises to 50% of its maximum value. Assuming the pulse increases as
                
                , find the relationship between leading-edge pulse time and the time constant of the exponential rise.
              




5-44

              Defibrillation Waveforms
            

              Ventricular fibrillation is a life-threatening loss of synchronous activity in the heart. To restore normal activity, a defibrillator delivers a brief but intense pulse of electrical current through the patient's chest. The pulse waveform is of interest because different waveforms may lead to different outcomes.
              Figure P5-44
              show a waveform known as a
              biphasic truncated exponential
              used in implantable defibrillators. The waveform is an exponential current whose direction of flow reverses after 4 ms and terminates after 8 ms. Write an expression for this waveform using the basic signals discussed in this chapter.
            







FIGURE P5-44










5-45

              Digital Clock Generator
            
Timing digital circuits is vital to the operation of any digital device. Using an ideal OP AMP (running open-loop, i.e., without feedback) and appropriate resistors, design a way to convert a sinusoid into a square wave that varies from 0 V to 5 V with a period of 2 ms. The only nonsinusoidal supply available is a 5-V dc source.




5-46


              Undesired Oscillations
            

              A test is being run in a wind tunnel when a sensor on the trailing edge of a wing produces the response shown in
              Figure P5-46
              . When the sensor output reached 1 V, the test was terminated. You are asked to analyze the results. The oscillation could be tolerated if it never reaches 20 V because the onboard computer can mitigate it. However, the response time for the computer to actuate the compensating aileron is 80 ms. Will the compensation occur in time?
            







FIGURE P5-46










5-47

              Voltmeter Calibration
            
Most dc voltmeters measure the average value of the applied signal. A dc meter that measures the average value can be adapted to indicate the rms value of an ac signal. The input is passed through a rectifier circuit. The rectifier output is the absolute value of the input and is applied to a dc meter whose deflection is proportional to the average value of the rectified signal. The meter scale is calibrated to indicate the rms value of the input signal. A calibration factor is needed to convert the average absolute value into the rms value of the ac signal. What is the required calibration factor for a sinusoid? Would the same calibration factor apply to a square wave?




5-48

              MATLAB Signal Analyzer
            

              Create a MATLAB function to analyze signals represented numerically. The function should have the following two inputs: (1) a vector containing equally spaced samples of the signal of interest and (2) the time step used to sample the signal contained in the vector. The function should display the following descriptors of the signal:
              V
MAX
              ,
              V
MIN
              ,
              V
p
              ,
              V
pp
              ,
              V
avg
              , and
              V
rms
              . The function should also plot the waveform assuming the signal starts at
              t
              = 0.
            



5-49

              ECG Analysis
            

              A simulated ECG signal obtained from a patient is shown in
              Figure P5-49
              . Identify any abnormal pulses. For the normal pulses, estimate the PR interval, the QRS interval, and the ST segment. Does the heart rate fall in the normal range of a healthy individual? (
              Hint:
              See
              Example 5-19
              .)
            







FIGURE P5-49










5-50

              Collision Avoidance Radar
            

              Cars are becoming increasingly autonomous. One necessary accessory is a collision avoidance radar. Such a radar emits a high-frequency modulated pulse traveling at the speed of light (3 × 10
              8
              m/s). The pulse strikes an object and returns to the radar receiver in the car. Based on the speed of the car and how fast the object is approaching the car, electronics will control the car's speed and, if necessary, its brakes.
              Figure P5-50
              shows two consecutive pulses emitted by the radar.
            


(a)
                Write an approximate expression for the waveform from 0 to 2.5 × 10
                -5
                s.
              

(b)
                What is the furthest away the radar can sense an object?
              

(c)
                Use MATLAB to recreate the signal.
                









FIGURE P5-50











Notes




1

              The step function is also referred to as a Heaviside function, after Oliver Heaviside, English electrical engineer (1850-1925). In MATLAB, a step function
              u
              (
              t
              ) is entered as "heaviside(t)".
            


2

              The unit impulse is also referred to as the Dirac delta, after Paul Dirac, the British physicist who introduced it.
            


3

              For example, see Alan V. Oppenheim and Allan S. Willsky,
              Signals and Systems Analysis
              (Englewood Cliffs, N.J.: Prentice Hall, 1983), pp. 22-23. Or for a more modern approach: Continuous Time Impulse Function (February 23, 2021). Retrieved September 25, 2021, from
              https://eng.libretexts.org/@go/page/22842
              .
            


4

              Fourier coefficients are discussed in greater detail in
              chapter 13
              .
            


5

              The dc value of a partial sinusoid, of course, may not be zero. Its value depends on the fraction of the cycle involved.
            
















CHAPTER 6

CAPACITANCE AND INDUCTANCE







From the foregoing facts, it appears that a current of electricity is produced, for an instant, in a helix of copper wire surrounding a piece of soft iron whenever magnetism is induced in the iron; also that an instantaneous current in one or the other direction accompanies every change in the magnetic intensity of the iron.


            Joseph Henry, 1831,
            
            American Physicist
          






Some History Behind This Chapter
Joseph Henry (1797-1878) and the British physicist Michael Faraday (1791-1867) independently discovered magnetic induction almost simultaneously. The quotation above is Henry's summary of the experiments leading to his discovery of magnetic induction. Although Henry and Faraday used similar apparatus and observed almost the same results, Henry was the first to fully recognize the importance of the discovery. The units of circuit inductance (henrys) honors Henry, while the mathematical generalization of magnetic induction is called Faraday's law.









Why This Chapter Is Important Today

              Electric circuits owe much of their utility to devices that store energy, even if only for a short period of time. In this chapter, you will be introduced to two new circuit elements: the capacitor and the inductor. These energy-storing elements lead to circuits that perform various mathematical operations like integration and differentiation. The energy-storing capability makes possible the signal-processing operations in modern communications systems and audio equipment. The inductor gives rise to coupled coils and the transformer that are essential to our audio, remote power charging, and power distribution systems. We will cover these in
              Chapter 15
              .
            









Chapter Sections



6-1 The Capacitor






6-2 The Inductor






6-3 Dynamic OP AMP Circuits






6-4 Equivalent Capacitance and Inductance












Chapter Learning Objectives

6-1
              Capacitor and Inductor Responses (
              Sects. 6-1
              and
              6-2
              )
            

(a) Given the current through a capacitor or an inductor, find the voltage across the element.
(b) Given the voltage across a capacitor or an inductor, find the current through the element.
(c) Find the power and energy associated with a capacitor or inductor.


6-2
              Dynamic OP AMP Circuits (
              Sect. 6-3
              )
            

(a) Given an OP AMP integrator or differentiator, determine the output for specified inputs.

                (b) Given an
                RC
                circuit containing OP AMPs, find the input-output relationship and construct a block diagram.
              

                (c) Design an
                RC
                circuit containing OP AMPs that implements a given input-output relationship.
              


6-3
              Equivalent Inductance and Capacitance (
              Sect. 6-4
              )
            


                (a) Derive equivalence properties of inductors and capacitors or use equivalence properties to simplify
                LC
                circuits.
              

                (b) Given an
                RLC
                circuit with dc inputs, find the dc currents and voltage responses.
              







          6-1 The Capacitor
        

          A capacitor is a dynamic element involving the time variation of an electric field produced by a voltage.
          Figure 6-1
          (a) shows the parallel plate capacitor, which is the simplest physical form of a capacitive device.
          Figure 6-1
          also shows two alternative circuit symbols. Photos of actual devices are shown in
          Figure 6-2
          .
        







FIGURE 6-1



The capacitor: (a) Parallel plate device. (b) Circuit symbols.










FIGURE 6-2



Photos of real capacitors: (a) Electrolytics. (b) Oil-filled high-voltage. (c) Ultracapacitors. (d) Surface mount. (e) Trimmer capacitors. (f) Film capacitors. (g) Air-tunable. (h) Ceramic.




          Electrostatics shows that a uniform electric field ℓ(
          t
          ) exists between the metal plates in
          Figure 6-1
          (a) when a voltage exists across the capacitor.
          
1

          The electric field produces charge separation with equal and opposite charges appearing on the capacitor plates. When the separation
          d
          is small compared with the dimension of the plates, the electric field between the plates is
        



(6-1)





          where ε is the permittivity of the dielectric,
          
2

A
          is the area of the plates, and
          q
          (
          i
          ) is the magnitude of the electric charge on each plate. The relationship between the electric field and the voltage across the capacitor
          υ
C
          (
          t
          ) is given by
        



(6-2)





          Substituting
          Eq. (6-2)
          into
          Eq. (6-1)
          and solving for the charge
          q
          (
          t
          ) yields
        


(6-3)




          The proportionality constant inside the brackets in this equation is the
          capacitance
C
          of the capacitor. That is, by definition,
        



(6-4)





          The unit of capacitance is the
          farad
          (F), a term that honors the British physicist Michael Faraday. Values of capacitance range from 0.05 pF in semiconductor devices to tens of millifarads in most electronic/power applications. Recently, there have been developments in the design of capacitors called supercapacitors or ultracapaci-tors that can have capacitances up to 13.5 kF. Supercapacitors are used in applications requiring many rapid charge/discharge cycles rather than long-term compact energy storage, such as in modern electric automobiles.
          

Note:


          Capacitor manufacturers typically do not use nanofarads and prefer to rate their capacitors as fractions of microfarads or multiples of picofarads. Some standard values for commercially available capacitors are found in
          Appendix G
          .
        

          Using
          Eq. (6-4)
          , the defining relationship for the capacitor becomes
        



(6-5)






Figure 6-3
          (a) graphically displays the element constraint in
          Eq. (6-5)
          . The graph points out that the capacitor is a linear element since the defining relationship between voltage and charge is a straight line through the origin.
        


I-V
            Relationship
          

            To express the element constraint in terms of voltage and current, we differentiate
            Eq. (6-5)
            with respect to time
            t
            as follows
          




            Since
            C
            is constant and
            i
C
            (
            t
            ) is the time derivative of
            q
            (
            t
            ), we obtain a capacitor
            i-υ
            relationship in the form
          



(6-6)





            The relationship assumes that the reference marks for the current and voltage follow the passive sign convention shown in
            Figure 6-3
            (b).
          

            The time derivative in
            Eq. (6-6)
            means the current is zero when the voltage across the capacitor is constant, and vice versa. In other words, the capacitor acts like an open circuit (
            i
C
            = 0) when dc excitations are applied. The capacitor is a dynamic element because the current is zero unless the voltage is changing. However, a discontinuous change in voltage would require an infinite current, which is physically impossible. Therefore, the capacitor voltage must be a continuous function of time.
          

Equation (6-6)
            relates the capacitor current to the rate of change of the capacitor voltage. To express the voltage in terms of the current, we multiply both sides of
            Eq. (6-6)
            by dt, solve for the differential
            dυ
C
            , and integrate:
          




            Selecting the integration limits requires some discussion. We assume that at some time
            t
0
            the voltage across the capacitor
            υ
C
            (
            t
0
            ) is known and we want to determine the voltage at some later time
            t
            >
            t
0
            . Therefore, the integration limits are
          




            where
            x
            is a dummy integration variable. Integrating the left side of this equation and solving for
            υ
C
            (
            t
            ) yields
          



(6-7)





            In practice, the time
            t
0
            is established by a physical event such as closing a switch or the start of a particular clock pulse. Nothing is lost in the integration in
            Eq. (6-7)
            if we arbitrarily define
            t
0
            to be zero. Using
            t
0
            = 0 in
            Eq. (6-7)
            yields
          


(6-8)




            Equation (6-8) is the integral form of the capacitor
            i-υ
            constraint. Both the integral form and the derivative form in
            Eq. (6-6)
            assume that the reference marks for current and voltage follow the passive sign convention in
            Figure 6-3
            (b).
          







FIGURE 6-3



(a) Graphical representations of the linear relationships evident in a capacitor:
υ
C
                (
                t
                ) vs
                q
                (
                t
                ) or
                
dυ
C
                  (
                  t
                  )/dt
                
                vs
                
i
C
                  (
                  t
                  ).
                
(b) Circuit symbol showing capacitor voltage and current.







            Power and Energy
          
With the passive sign convention, the capacitor power is



(6-9)





            Using
            Eq. (6-6)
            to eliminate
            i
C
            (
            t
            ) from
            Eq. (6-9)
            yields the capacitor power in the form
          



(6-10)




This equation shows that the power can be either positive or negative because the capacitorvoltage and its time rate ofchange can have opposite signs. With the passive sign convention, a positive sign means the element absorbs power, whereas a negative sign means the element delivers power. The ability to deliver power implies that the capacitor can store energy.

            To determine the stored energy, we note that the expression for power in
            Eq. (6-10)
            is a perfect derivative. Since power is the time rate of change of energy, the quantity inside the brackets must be the energy stored in the capacitor.
          




            Mathematically, we can infer from
            Eq. (6-10)
            that the energy at time
            t
            is
          




            The constant in this equation is the value of stored energy at some instant
            t
            when
            υ
C
            (
            t
            ) = 0. At such an instant the electric field is zero; hence, the stored energy is also zero. As a result, the constant is zero and we write the capacitor energy as
          



(6-11)




The stored energy is never negative, since it is proportional to the square of the voltage. The capacitor absorbs power from the circuit when storing energy and returns previously stored energy when delivering power to the circuit.

            The relationship in
            Eq. (6-11)
            also implies that voltage is a continuous function of time, since an abrupt change in the voltage implies a discontinuous change in energy. Since power is the time derivative of energy, a discontinuous change in energy implies infinite power, which is physically impossible. The capacitor voltage is called a
            state variable
            because it determines the energy state of the element.
          
To summarize, the capacitor is a dynamic circuit element with the following properties:



The current through the capacitor is zero unless the voltage is changing. The capacitor acts like an open circuit to dc excitations.




The voltage across the capacitor is a

continuous function

of time. A discontinuous change in capacitor voltage would require infinite current and power, which is physically impossible.




The capacitor absorbs power from the circuit when storing energy and returns previously stored energy when delivering power. The net energy transfer is nonnegative, indicating that the capacitor is a passive element.




            The following examples illustrate these properties.
            













EXAMPLE 6-1



                    The voltage in
                    Figure 6-4
                    (a) appears across a 0.5-μF capacitor. Find the current through the capacitor.
                  




SOLUTION:



                The capacitor current is proportional to the time rate of change of the voltage. For 0 <
                t
                < 2 ms, the slope of the voltage waveform has a constant value
              



The capacitor current during this interval is




                For 2 <
                t
                < 3 ms, the rate of change of the voltage is -5000 V/s. Since the rate of change of voltage is negative, the current changes direction and takes on the value
                i
C
                (
                t
                ) = -2.5 mA. For
                t
                > 3 ms, the voltage is constant, so its slope is zero; hence the current is zero. The resulting current waveform is shown in
                Figure 6-4
                (b). Note that the voltage across the capacitor (the state variable) is continuous, but the capacitor current can be, and in this case is, discontinuous.
              







FIGURE 6-4







■

 









Exercise 6-1

A 0.01-μF capacitor has the following voltage impressed across it



  
                Find the current   
                i
C
                ( 
                t 
                ) through the capacitor for 
                t   
                > 0. 
              


Answer:



i
C 
                (    
                t 
                ) = -    
                e
    
                  −1000  
                  t

u   
                (   
                t   
                ) mA  
              
















EXAMPLE 6-2



                    The
                    i
C
                    (
                    t
                    ) in
                    Figure 6-5
                    (a) is given by
                  




                    Find the voltage across the capacitor if
                    υ
C
                    (0) = 0 V.
                  




SOLUTION:



                Using the capacitor
                i-υ
                relationship in integral form,
              




                The graph in
                Figure 6-5
                (b) shows that the voltage is continuous while the current is discontinuous.
              







FIGURE 6-5







■

 











Exercise 6-2




                  (a) The voltage across a 10-μF capacitor is 25[sin 2000
                  t
                  ]
                  u
                  (
                  t
                  ) V. Derive an expression for the current through the capacitor.
                

                  (b) At
                  t
                  = 0, the voltage across a 100-pF capacitor is -5 V. The current through the capacitor is 10[
                  u
                  (
                  t
                  ) -
                  u
                  (
                  t
                  - 10
                  -4
                  )] μA. What is the voltage across the capacitor for
                  t
                  > 0?
                

Answers:


                  (a)
                  i
C
                  (
                  t
                  ) = 0.5[cos2000
                  t
                  ]
                  u
                  (
                  t
                  ) A
                

                  (b)
                  υ
C
                  (
                  t
                  ) = -5 + 10
                  5
t
                  V for 0 <
                  t
                  < 0.1 ms and
                  υ
C
                  (
                  t
                  ) = 5 V for
                  t
                  > 0.1 ms
                












Exercise 6-3



                For
                t
                > 0, the voltage across a 200-pF capacitor is 5
                e

                  −4000
                  t

                V.
              


                  (a) What is the charge on the capacitor at
                  t
                  = 0 and
                  t
                  = +∞?
                

                  (b) Derive an expression for the current through the capacitor for
                  t
                  ≥ 0.
                

                  (c) For
                  t
                  > 0, is the device absorbing or delivering power?
                

Answers:

(a) 1 nC and 0 C

                  (b)
                  i
C
                  (
                  t
                  ) = −4
                  e

                    −4000
                    t

                  μA
                
(c) Delivering
















EXAMPLE 6-3


Figure 6-6
                    (a) shows the voltage across a 0.5-μF capacitor. Find the capacitor's energy and power.
                  









FIGURE 6-6









SOLUTION:



                The current through the capacitor was found in
                Example 6-1
                . The power waveform is the point-by-point product of the voltage and current waveforms. The energy is found either by integrating the power waveform or by calculating ½
                Cυ
C
                (
                t
                )
                2
                point by point. The current, power, and energy are shown in
                Figure 6-6
                (b), (c), and (d). Note that the capacitor energy increases when it is absorbing power
                p
C
                (
                t
                ) > 0 and decreases when delivering power
                p
C
                (
                t
                ) < 0. The stored energy is directly related to the fact that there are 5 V impressed across the capacitor.
                ■










Exercise 6-4


                Find the power and energy for the capacitors in
                Exercise 6-2
                .
              
Answers:



                    (a)
                    p
C
                    (
                    t
                    ) = 6.25[sin 4000
                    t
                    ]
                    u
                    (
                    t
                    ) W
                  

w
C
                    (
                    t
                    ) = 3.125 [sin
                    2
                    2000
                    t
                    ]
                    u
                    (
                    t
                    ) mJ
                  



                    (b)
                    p
C
                    (
                    t
                    ) = −005 + 10
                    3
                    t mW for 0 <
                    t
                    < 0.1 ms
                  

p
C
                    (
                    t
                    ) = 0 for
                    t
                    > 0.1 ms
                  

w
C
                    (
                    t
                    ) = 1.25-5 × 10
                    4
t
                    + 5 × 10
                    8
t
2
                    nJ for 0 <
                    t
                    < 0.1 ms
                  

w
C
                    (
                    t
                    ) = 1.25 nJ for
                    t
                    > 0.1 ms
                  

















EXAMPLE 6-4

The current through a capacitor is given by



Find the capacitor's energy and power.




SOLUTION:



                The current and voltage were found in
                Example 6-2
                and are shown in
                Figure 6-7
                (a) and (b). The power waveform is found as the product of current and voltage:
              




                The waveform of the power is shown in
                Figure 6-7
                (c). The energy is given by
              




                The time history of the energy is shown in
                Figure 6-7
                (d). In this example, both power and energy are always positive.
              







FIGURE 6-7







■

 









Exercise 6-5


                Find the power and energy for the capacitor in
                Exercise 6-3
                .
              
Answers:













                APPLICATION
                EXAMPLE 6-5


                Analog signals abound, but in today's technological world, analog signals must be converted into digital formats to ease electronic transmission and processing. At the end, these digital signals are often restored to analog form. The first step in the conversion process uses a sample-and-hold circuit. This circuit is usually found at the input to an
                analog-to-digital converter (ADC).
                The purpose of the circuit is to sample an analog time-varying input waveform at a specified instant and then hold that value constant until conversion to digital form is complete. This example discusses the role of a capacitor in such a circuit.
              

                The basic sample-and-hold circuit in
                Figure 6-8
                (a) includes an input buffer, a digitally controlled electronic switch [usually driven by a digital clock
                υ
G
                (
                t
                )], a holding capacitor
                C,
                and an output buffer. The input buffer is a voltage follower whose output replicates the analog input signal
                υ
S
                (
                t
                ) and prevents the sample-and-hold circuit from loading the input. Importantly, the input buffer supplies a charging current
                i
C
                (
                t
                ) to the capacitor. The output buffer is also a voltage follower whose output replicates the capacitor voltage and prevents the ADC circuit from loading the sample-and-hold circuit.
              

                To see how the circuit operates, we describe one cycle of the sample-and-hold process. At time
                t
1
                shown in
                Figure 6-8
                (b), the digital control
                υ
G
                (
                t
                ) goes high, which causes the switch to close. This act allows the input buffer to supply a charging current
                i
C
                (
                t
                ) to drive the capacitor voltage to the level of the analog input. At time
                t
2
                also shown in
                Figure 6-8
                (b), the digital control goes low, the switch opens, and thereafter the capacitor current
                i
C
                (
                t
                ) = 0. Zero current means that capacitor voltage is constant since d
                υ
C
                (
                t
                )/
                dt
                is zero. In sum, closing the switch causes the capacitor voltage to track the input (once the capacitor reaches that value), and opening the switch causes the capacitor voltage to hold a sample of the input until the process repeats.
              

Figure 6-8
                (b) shows several more cycles of the sample-and-hold process. Samples of the input waveform are acquired during the time intervals labeled
                t
C
                . During these intervals, the control signal is high, the switch is closed, and the capacitor charges or discharges in order to track the analog input voltage. Analog-to-digital conversion of the circuit output voltage takes place during the time intervals
                t
ADC
                . During these intervals, the control signal is low, the switch is open, and the capacitor holds the output voltage constant.
              

                Sample-and-hold circuits are available as monolithic integrated circuits (see
                Figure 6-8
                (c)), and typically 10-bit to 14-bit configurations are common. They include the two buffers, the electronic switch, and may or may not include the holding capacitor. If the capacitor is supplied externally, its selection involves a tradeoff. In an ideal sample-and-hold circuit, the capacitor voltage tracks the input when the switch is closed (sample mode) and holds the value indefinitely when the switch is open (hold mode). In real circuits, the input buffer has a maximum output current, which means that some time is needed to charge the capacitor in the sample mode. Minimizing this sample acquisition time argues for a small capacitor. On the other hand, in the hold mode, the output buffer draws a small current that gradually discharges the capacitor, causing the output voltage to slowly decrease. Minimizing this output drop calls for a large capacitor. Thus, selecting the capacitance of the holding capacitor involves a compromise between
                
                the sample acquisition time and the output voltage drop in the hold mode. A few other issues might be obvious. The capacitor must have sufficient time to charge up to the value of the signal; hence, the clock signal must be sufficiently long to permit this to happen. Similarly, the time allowed for the conversion to occur must also be sufficient. Note also that the analog signal shown is changing slowly. Clearly, if the analog signal was changing more rapidly, then the sampling and conversion must be done faster.
                
3

                Currently, these concerns are beyond the scope of this text, but for those interested, investigate
                Nyquist
                and
                Sampling Theory
                or see
                Example 13-12
                in this text.
              







FIGURE 6-8











6-2 The Inductor

          The inductor is a dynamic circuit element involving the time variation of the magnetic field produced by a current. Magnetostatics shows that a magnetic flux ϕ with units of webers (Wb) surrounds a wire carrying an electric current. When the wire is wound into a coil, the lines of flux concentrate along the axis of the coil, as shown in
          Figure 6-9
          (a). In a linear magnetic medium, the flux is proportional to both the current and the number of turns in the coil. Therefore, the total flux is
        



(6-12)





          where
          k
1
          is a constant of proportionality that is dependent on the coil material, its geometry, and its permeability, μ
          
4

          .
        

          The magnetic flux intercepts or links the turns of the coil. The flux linkage in a coil is represented by the symbol λ, with units of weber-turns (Wb-t), named after the German scientist Wilhelm Weber (1804-1891). The flux linkage is proportional to the number of turns in the coil and to the total magnetic flux, so λ(
          t
          ) is
        



(6-13)





          Substituting
          Eq. (6-12)
          into
          Eq. (6-13)
          gives
        


(6-14)




          The proportionality constant inside the brackets in this equation is the
          inductance
L
          of the coil. That is, by definition
        



(6-15)





          The unit of inductance is the henry (H) (plural: henrys), a name that honors American scientist Joseph Henry.
          Figure 6-9
          (b) shows the circuit symbol for an inductor. Photos of some examples of actual devices are shown in
          Figure 6-10
          . Some standard values for commercially available inductors are found in
          Appendix G
          .
        

          Using
          Eq. (6-15)
          , the defining relationship for the inductor becomes
        



(6-16)





Figure 6-11
          graphically displays the inductor's element constraint in
          Eq. (6-16)
          . The graph points out that the inductor is a linear element since the defining relationship is a straight line through the origin.
        







FIGURE 6-9



(a) Magnetic flux surrounding a current-carrying coil. (b) Circuit symbol showing inductor current and voltage.










FIGURE 6-10



Photos of real inductors: (a) Air core. (b) Toroidal. (c) Choke. (d) Surface mount. (e) High-current radial power. (f) Bobbin-wound choke. (g) Color-coded axial.










FIGURE 6-11



Graphical representations of the linear relationships evident in an inductor:
i
L
              (
              t
              ) vs
              λ
              (t) or
              
di
L
                (
                t
                )/dt vs
                υ
L
                (
                t
                ).
              






            I-V Relationship
          

Equation (6-16)
            is the inductor element constraint in terms of current and flux linkage. To obtain the element characteristic in terms of voltage and current, we differentiate
            Eq. (6-16)
            with respect to time:
          


(6-17)




            The inductance
            L
            is a constant. According to Faraday's law, the voltage across the inductor is equal to the time rate of change of flux linkage. Therefore, we obtain an inductor
            i-υ
            relationship in the form
          



(6-18)





            This is also a linear relationship as seen in
            Figure 6-11
            .
          

            The time derivative in
            Eq. (6-18)
            means that the voltage across the inductor is zero unless the current is time varying. Under dc excitation, the current is constant and
            υ
L
            = 0, so the inductor acts like a short circuit. The inductor is a dynamic element because only a changing current produces a nonzero voltage. However, a discontinuous change in current would produce an infinite voltage, which is physically impossible. Therefore, the current
            i
L
            (
            t
            ) must be a continuous function of time
            t
            .
          

Equation (6-18)
            relates the inductor voltage to the rate of change of the inductor current. To express the inductor current in terms of the voltage, we multiply both sides of
            Eq. (6-18)
            by
            dt
            , solve for the differential
            di
L
            , and integrate:
          


(6-19)




            To set the limits of integration, we assume that the inductor current
            i
L
            (
            t
0
            ) is known at some time
            t
0
            . Under this assumption, the integration limits are
          



(6-20)





            where
            x
            is a dummy integration variable. The left side of
            Eq. (6-20)
            integrates to produce
          



(6-21)





            The reference time
            t
0
            is established by some physical event, such as closing or opening a switch. Without losing any generality, we can assume
            t
0
            = 0 and solving for
            i
L
            (
            t
            ) write
            Eq. (6-21)
            in the form
          



(6-22)





Equation (6-22)
            is the integral form of the inductor
            i-υ
            characteristic. Both the integral form and the derivative form in
            Eq. (6-18)
            assume that the reference marks for the inductor voltage and current follow the passive sign convention shown in
            Figure 6-9
            (b).
          




            Power and Energy
          
With the passive sign convention, the inductor power is


(6-23)




            Using
            Eq. (6-18)
            to eliminate
            υ
L
            (
            t
            ) from this equation puts the inductor power in the form
          



(6-24)




This expression shows that power can be positive or negative because the inductor current and its time derivative can have opposite signs. Therefore, like a capacitor, an inductor can both absorb and deliver power. The ability to deliver power indicates that the inductor can store energy.

            To find the stored energy, we note that the power relation in
            Eq. (6-24)
            is a perfect derivative. Since power is the time rate of change of energy, the quantity inside the brackets must represent the energy stored in the magnetic field of the inductor. From
            Eq. (6-24)
            , we infer that the energy at time
            t
            is
          




            As is the case with capacitor energy, the constant in this expression is zero since it is the energy stored at an instant
            t
            at which
            i
L
            (
            t
            ) = 0. As a result, the energy stored in the inductor is
          


(6-25)



The energy stored in an inductor is never negative because it is proportional to the square of the current. The inductor stores energy when absorbing power and returns previously stored energy when delivering power, so that the net energy transfer is never negative.

            Equation (6-25) implies that inductor current is a continuous function of time because an abrupt change in current causes a discontinuity in the energy. Since power is the time derivative of energy, an energy discontinuity implies infinite power, which is physically impossible. Current is called the
            state variable
            of the inductor because it determines the energy state of the element.
          
In summary, the inductor is a dynamic circuit element with the following properties:



The voltage across the inductor is zero unless the current through the inductor is changing. The inductor acts like a short circuit for dc excitations.




The current through the inductor is a

continuous function

of time. A discontinuous change in inductor current would require infinite voltage and power, which is physically impossible.




The inductor absorbs power from the circuit when storing energy and delivers power to the circuit when returning previously stored energy. The net energy is nonnegative, indicating that the inductor is a passive element.














EXAMPLE 6-6


                    The current through a 2-mH inductor is
                    i
L
                    (
                    t
                    ) = 4 sin 1000
                    t
                    + 1 sin 3000
                    t
                    A as shown in
                    Figure 6-12
                    (a). Find the resulting inductor voltage.
                  









FIGURE 6-12









SOLUTION:



                The voltage is found from the derivative form of the
                i-υ
                relationship:
              




                The resulting voltage waveform is shown in
                Figure 6-12
                (b). Note that the current and voltage waveforms each contain two sinusoids with the same two frequencies. However, the relative amplitudes of the two sinusoids are different. In
                i
L
                (
                t
                ), the ratio of the amplitude of the component at co = 3 krad/s to the component at co = 1 krad/s is 1:4, whereas in
                υ
L
                (
                t
                ) this ratio is 3:4. The fact that the responses of energy storage elements depend on frequency allows us to create frequency-selective signal processors called
                filters.
                We will study filters in greater depth in
                Chapters 8
                ,
                12
                , and
                14
                .
                ■










Exercise 6-6


                For
                t
                > 0, the voltage across a 4-mH inductor is
                υ
L
                (
                t
                ) = 20
                e

                  −2000
                  t

                V. The initial current is
                i
L
                (0) = 0.
              


                  (a) What is the current through the inductor for
                  t
                  > 0?
                

                  (b) What is the power for
                  t
                  > 0?
                

                  (c) What is the energy for
                  t
                  > 0?
                

Answers:


                  (a)
                  i
L
                  (
                  t
                  ) = 2.5(1 −
                  e

                    −2000
                    t

                  ) −
                  e

                    −2000
                    t

                  ) A
                

                  (b)
                  p
L
                  (
                  t
                  ) = 50(
                  e

                    −2000
                    t

                  −
                  e

                    −4000
                    t

                  ) W
                

                  (c)
                  w
L
                  (
                  t
                  ) = 12.5(1-2
                  e

                    −2000
                    t

                  +
                  e

                    −4000
                    t

                  ) mJ
                
















EXAMPLE 6-7


Figure 6-13
                    shows the current through and voltage across an unknown energy storage element.
                  

(a) What is the element and what is its numerical value?

                      (b) If the energy stored in the element at
                      t
                      = 0 is zero, how much energy is stored in the element at
                      t
                      = 1s?
                    










FIGURE 6-13








SOLUTION:




                  (a) By inspection, the voltage across the device is proportional to the derivative of the current, so the element is a linear inductor. During the interval 0 <
                  t
                  < 1 s, the slope of the current waveform is 10 A/s. During the same interval, the voltage is a constant 100 mV. Therefore, the inductance is
                  




                  (b) The energy stored at
                  t
                  = 1 s is
                  


■












Exercise 6-7


                For
                t
                < 0, the current through a 100-mH inductor is zero. For
                t
                ≥ 0, the current is
                i
L
                (
                t
                ) = 20
                e

                  −2000
                  t

                − 20
                e

                  −4000
                  t

                mA.
              


                  (a) Derive an expression for the voltage across the inductor for
                  t
                  > 0.
                

                  (b) Find the time
                  t
                  > 0 at which the inductor voltage passes through zero.
                

                  (c) Derive an expression for the inductor power for
                  t
                  > 0.
                
(d) Find the time interval over which the inductor absorbs power and the interval over which it delivers power.

Answers:


                  (a)
                  υ
L
                  (
                  t
                  ) = −4
                  e

                    −2000
                    t

                  + 8
                  e

                    −4000
                    t

                  V
                

                  (b)
                  t
                  = 0.347 ms
                

                  (c)
                  p
L
                  (
                  t
                  ) = −80
                  e

                    −4000
                    t

                  + 240
                  e

                    −6000
                    t

                  − 160
                  e

                    −8000
                    t

                  mW
                

                  (d) Absorbing for 0 <
                  t
                  < 0.347 ms, delivering for
                  t
                  > 0.347 ms
                


















EXAMPLE 6-8



                    The current through a 2.5-mH inductor is a damped sine
                    i
                    (
                    t
                    ) = 10
                    e

                      −500
                      t

                    sin 2000
                    t
                    . Plot the waveforms of the element current, voltage, power, and energy.
                  




SOLUTION:



                Following are the MATLAB code and the resulting plots for the current, voltage, power, and energy. The code uses symbolic variables, differentiation, and multiplication to calculate the expressions for the four signals. An appropriate time vector is then substituted into the symbolic expressions to create numerical vectors that can be plotted. The subplot function allows multiple plots to be placed in a single figure window. In the plots shown in
                Figure 6-14
                , note that the current, voltage, and power alternate signs, whereas the energy signal is always positive.
              

                The MATLAB code uses a numerical time vector defined by the expression
                [tt = 0 : 0.00001 : 0.004;]
                . The sinusoid has a period of
                T
0
                = 2π/2000 = 0.00314, so plotting from
                t
                = 0 ms to
                t
                = 4 ms is sufficient to capture a full period of the sinusoid. The time step size of 10 μs is a convenient choice and generated 401 points to plot, which produced a smooth curve for each signal.
              







FIGURE 6-14







■

 



            matlab code
            % create symbolic variables
            syms t il vl pl wl real
            
            % create the inductor current signal
            iL = 10*exp(-500*t)*sin(2 000*t);
            
            % define the inductance
            l = 0.0025;
            
            % calculate the voltage, power, and energy
            vL = l*diff(iL, 't');
            pL = il*vL;
            wL = l*il^2/2;
            
            % create a time vector
            tt = 0:0. 00001:0.004;
            % substitute the time vector into the symbolic expressions
            iLtt = subs(iL, t, tt);
            
              vLtt = subs(vL, t, tt);
              
            
            pLtt = subs(pL, t, tt);
            wLtt = subs(wL, t, tt);
            
            % plot the results using the subplot function
            subplot(2,2,1)
            plot(tt,iLtt, 'b', 'LineWidth', 2);
            grid on
            ylabel('i_L(t), (A)')
            title('current')
            
            subplot(2,2,2)
            plot(tt, vLtt, 'b', 'linewidth', 2);
            grid on
            ylabel('v_L(t), (V)')
            title('Voltage')
            
            subplot(2,2,3)
            plot(tt, pLtt, 'b', 'linewidth', 2);
            grid on
            xlabel('Time, (s)');
            ylabel('p_L(t), (W)')
            title('Power')
            
            subplot(2,2,4)
            plot(tt,wLtt, 'b', 'Linewidth', 2);
            grid on
            xlabel('Time, (s)');
            ylabel('w_L(t), (J)')
            title('Energy')
          







Exercise 6-8


                Using the MATLAB code from
                Example 6-8
                , modify it to find the waveforms of the current, voltage, power, and energy of a 50-mH inductor with a current flowing through it given by
              





Answers:



                Two cycles of the plots are shown in
                Figure 6-15
                .
              









FIGURE 6-15














Exercise 6-9


                A 50-mH inductor has an initial current of
                i
L
                (0) = 0 A. The following voltage is applied across the inductor starting at
                t
                = 0:
              




                For
                t
                ≥ 0, use MATLAB to determine the inductor current, power, and energy. Plot those three signals and the inductor voltage for 0 ≤
                t
                ≤ 10 ms.
              


Answer:



                The plots are shown in
                Figure 6-16
                .
              









FIGURE 6-16








More about Duality

            The capacitor and inductor characteristics are quite similar. Interchanging
            C
            and
            L,
            and
            i
            and converts the capacitor equations into the inductor equations, and vice versa. This interchangeability illustrates the principle of duality. The dual concepts seen so far are as follows:
          




            The term in one column is the dual of the term in the other column. The
            principle of duality
            states that
          



If every electrical term in a correct statement about circuit behavior is replaced by its dual, then the result is another correct statement.





            This principle may help beginners gain confidence in their understanding of circuit analysis. When the concept in one column is understood, the dual concept in the other column becomes easier to remember and apply.
          



6-3 Dynamic OP AMP Circuits

          The dynamic characteristics of capacitors and inductors produce signal-processing functions that cannot be obtained using resistors. The OP AMP circuit in
          Figure 6-17
          (a) is similar to the inverting amplifier circuit except for the capacitor in the feedback path. To determine the signal-processing function of the circuit, we need to find its input-output relationship.
        
We begin by writing a KCL equation at node A.




          The resistor and capacitor device equations are written using their
          i-υ
          relationships and the fundamental property of node voltages:
        




          The ideal OP AMP device equations are
          i
N
          (
          t
          ) = 0 and
          υ
A
          (
          t
          ) = 0. Substituting all of the element constraints into the KCL connection constraint produces
        




          To solve for the output
          υ
O
          (
          t
          ), we multiply this equation by dt, solve for the differential
          dυ
O
          , and integrate as follows
        




          Assuming the output voltage is known at time
          t
0
          = 0, the integration limits are
        



which yields




          The initial condition
          υ
O
          (0) is actually the voltage on the capacitor at
          t
          = 0, since by KVL, we have
          υ
C
          (
          t
          ) =
          υ
O
          (
          t
          ) −
          υ
A
          (
          t
          ). But
          υ
A
          = 0 for the OP AMP, so in general
          υ
O
          (
          t
          ) =
          υ
C
          (
          t
          ). When the voltage on the capacitor is zero at
          t
          = 0, the circuit input-output relationship reduces to
        



(6-26)











FIGURE 6-17



The inverting OP AMP integrator.





          The output voltage is proportional to the integral of the input voltage when the initial capacitor voltage is zero. The circuit in
          Figure 6-17
          (a) is an
          inverting integrator
          since the proportionality constant is negative. The constant 1/
          RC
          has the units of reciprocal seconds (s
          −1
          ) so that both sides of
          Eq. (6-26)
          have the units of volts.
        

          Interchanging the resistor and capacitor in
          Figure 6-17
          (a) produces the OP AMP differentiator in
          Figure 6-17
          (b). To find the input-output relationship of this circuit, we start by writing the element and connection equations. The KCL connection constraint at node A is
        



The device equations for the input capacitor and feedback resistor are




          The device equations for the OP AMP are
          i
N
          (
          t
          ) = 0 and
          υ
A
          (
          t
          ) = 0. Substituting all of these element constraints into the KCL connection constraint produces
        




          Solving this equation for
          υ
O
          (
          t
          ) produces the circuit input-output relationship:
        



(6-27)





          The output voltage is proportional to the derivative of the input voltage. The circuit in
          Figure 6-17
          (b) is an
          inverting differentiator
          since the proportionality constant (-
          RC
          ) is negative. The units of the constant
          RC
          are seconds so that both sides of
          Eq. (6-27)
          have the units of volts.
        







FIGURE 6-17



The inverting OP AMP differentiator.




          If one were to replace the capacitors in the previous two circuits with inductors, the circuits would also perform as an inverting integrator or an inverting differentiator. However, their functions would be reversed. Why? See Problem 6-27. Generally, however,
          RL
          circuits are not as practical as
          RC
          circuits because of the physical size and resistive losses in real inductors.
        

Figure 6-18
          shows OP AMP circuits and block diagrams for the inverting integrator and differentiator, together with signal-processing functions studied in
          Chapter 4
          . The term
          operational amplifier
          results from the various mathematical operations implemented by these circuits. The following examples illustrate using the collection of circuits in
          Figure 6-18
          on the next page in the analysis and design of signal-processing functions.
        












EXAMPLE 6-9



                  The input to the circuit in
                  Figure 6-19
                  (a) is
                  υ
S
                  (
                  t
                  ) = 10
                  u
                  (
                  t
                  ) V. Derive an expression for the output voltage. The OP AMP saturates when
                  υ
O
                  (
                  t
                  ) = ±15 V.
                




SOLUTION:



              The circuit is the inverting integrator with an initial voltage of 0 V across the capacitor. Assuming the OP AMP is operating in the linear mode, the output voltage is
              








FIGURE 6-18




                    Summary of basic OP AMP signal-processing circuits, can also be found in
                    Appendix G
                    .
                  











FIGURE 6-19










              The output contains a ramp with a slope of -10 V/s. The negative slope is due to the fact that the OP AMP is an inverting integrator. The output will continue to decrease until the OP AMP saturates at - 15 V at
              t
              = 1.5 s. Beyond that time the output is a constant -15 V.
              Figure 6-19
              (b) shows both the input and the output of the integrator.
            

              This example illustrates that dynamic circuits with bounded inputs may have unbounded responses. The circuit input here is a 10-V step function that has a bounded amplitude. The circuit output is a ramp whose output would be unbounded except that the OP AMP saturates.
              ■












Exercise 6-10



              The input to the circuit in
              Figure 6-19
              is
              υ
S
              (
              t
              ) = 10
              e

                −5
                t

u
              (
              t
              ) V. The OP AMP saturates when
              υ
O
              (
              t
              ) = ±15 V.
            


                (a) For
                υ
C
                (0) = 0, derive an expression for the output voltage, assuming the OP AMP is in its linear range.
              
(b) Does the OP AMP saturate with the given input?
(c) Replace the resistor with one that is 100 kΩ and repeat (a) and (b)
(d) Use Multisim to plot the output.

Answers:


                (a)
                υ
A
                (
                t
                ) = 2(
                e

                  −5
                  t

                - 1)
                u
                (
                t
                ) V
              
(b) The output does not saturate.

                (c)
                υ
O
                (
                t
                ) = 20 (
                e

                  −5
                  t

                - 1)
                u
                (
                t
                ) V; the output saturates at approximately 279 ms.
              

                (d) See
                Figure 6-19
                (c).
                











FIGURE 6-19

















EXAMPLE 6-10


                  The input to the circuit in
                  Figure 6-20
                  (a) is the trapezoidal waveform shown in
                  Figure 6-20
                  (b). Find the output waveform. The OP AMP saturates when
                  υ
O
                  (
                  t
                  ) = ±15 V.
                









FIGURE 6-20








SOLUTION:


The circuit is the inverting differentiator with the following input-output relationship:





              The output voltage is constant over each of the following three time intervals:
            



                  For 0 <
                  t
                  < 1 ms, the input slope is 5000 V/s and the output is
                  υ
O
                  = - 5 V.
                



                  For 1 <
                  t
                  < 3 ms, the input slope is zero, so the output is zero as well.
                



                  For 3 <
                  t
                  < 5 ms, the input slope is -2500 Vs and the output is +2.5 V.
                



              The resulting output waveform is shown in
              Figure 6-20
              (c).
            

              The output voltage remains within ±15-V limits, so the OP AMP operates in the linear mode.
              ■










Exercise 6-11


              The input to the circuit in
              Figure 6-20
              (a) is
              υ
S
              (
              t
              ) =
              V
A
              cos 2000
              t
              V. The OP AMP saturates when
              υ
O
              (
              t
              ) = ±15 V.
            

(a) Derive an expression for the output, assuming that the OP AMP is in the linear mode.

                (b) What is the maximum value of
                V
A
                for linear operation?
              

Answers:


                (a)
                υ
O
                (
                t
                ) = 2
                V
A
                sin 2000
                t
                V
              

                (b) |
                V
A
                | ≤ 7.5 V
              


















                  DESIGN
                  EXAMPLE 6-11


                  Use the functional blocks in
                  Figure 6-18
                  to design an OP AMP circuit to implement the input-output relationship given below. Then, simulate your circuit using Multisim to verify your results when
                  υ
S
                  (
                  t
                  ) = cos 100
                  t
                  V.
                







SOLUTION:


There are many approaches to solving this problem. In our approach, we begin by dividing both sides of the input-output relationship by 100 yielding




              Then, we can draw the block diagram in
              Figure 6-21
              (a), which shows that we need a weighted differentiator and a summer. However, the differentiator and the summer are both inverting circuits. This means that the output sign of the summer and the differentiator will cancel, but the input that goes straight to the summer will be inverted. This then requires that we insert an inverter between the input and the summer as shown in
              Figure 6-21
              (b). The inverting building blocks are realizable using the OP AMP circuits in
              Figure 6-18
              , and the overall transfer characteristic is nonin-verting as required. One of many possible circuit realizations is shown in
              Figure 6-21
              (c) with the constraint that the differentiator's
              RC
              = 001. Selecting the OP AMPs and the values of
              R
              and
              C
              depends on many additional factors, such as accuracy, internal resistance of the input source, and output load. The Multisim simulation with
              υ
s
              (
              t
              ) = cos 100t V is shown in
              Figure 6-21
              (d). We have plotted the input, the output, and the inputs into the summer, that is,
              υ
2
              (
              t
              ) is the inverted input and
              υ
3
              (
              t
              ) is the weighted differentiated input.
              ■











FIGURE 6-21












Exercise 6-12


              Find the input-output relationship of the circuit in
              Figure 6-22
              .
            


Answer:














FIGURE 6-22


















                  DESIGN
                  EXAMPLE 6-12

Differential, integral, and integrodifferential equations can be solved using dynamic circuits. Suppose a second-order system can be described by the following differential equation:




                  Develop a block-diagram representation of the equation and then design a circuit to solve the equation. That is, design a circuit where the output is
                  υ
O
                  (
                  t
                  ).
                





SOLUTION:


The first step is to solve the equation for the highest-order derivative with a coefficient of 1. Hence,




              Next, we realize that the highest-order derivative is simply the sum of three inputs. If we integrate the second derivative we obtain the first derivative, and if we integrate the first derivative we obtain the desired output,
              υ
O
              (
              t
              ). We can use the outputs of the integrators, scale them, and feed them back into the summer along with the 50-V driving function. This can be seen in the block diagram of
              Figure 6-23
              (a).
            

              We can design the circuit by implementing the block diagram. For each integrator, we select the gain to be -1. Because all of our building blocks are inverting amplifiers, we need to include two inverters to make the signs come out correctly. The summer is used to achieve the appropriate gains.
              Figure 6-23
              (b) shows one possible circuit design.
            







FIGURE 6-23













FIGURE 6-23








Discussion:

Not too long ago, before digital computers became ubiquitous, these types ofproblems were solved using analog computers. Analog computers solved complex, coupled, differential equations using integrators, differentiators, summers, inverters, and noninverters. Our early space efforts, for example, relied heavily on analog computers. Today, ofcourse, fast, redundant, and relatively cheap digital computers are used and analog computers have been mostly relegated to the annals of history.
■













Evaluation Exercise 6-13



              The circuit shown in
              Figure 6-24
              (a) is supposedly designed to solve the following differential equation:
            




              What is the classical solution for
              υ
x
              (
              t
              ), assuming
              υ
x
              (0) = 0.1? Build the circuit in Multisim and use a 0.1-V step to excite the circuit. Can you
              
              determine the solution from the circuit's transient response? Does the circuit solve the equation?
            







FIGURE 6-24








Answers:


The classical solution to this first-order differential equation is




              The transient response is shown in
              Figure 6-24
              (b).
            







FIGURE 6-24







              The graph shows that the response is exponential. Using the cursor, we find that the time constant is 0.2 s,
              υ
x
              (0) = 0.1 V and
              υ
x
              (∞) approaches 0.02 V. Yes, the circuit solves the equation.
            











                APPLICATION
                EXAMPLE 6-13


Dynamic OP AMP circuits can function as integrators or differentiators. Given an equation or graph of an input waveform, we can predict output waveforms using the mathematical operations of integration or differentiation. Integrators and differentiators work flawlessly on ideal signal models. In practice, there are some limitations caused by relatively small imperfections in real-world signals.

              First, consider an inverting integrator with an input
              υ
S
              (
              t
              ) +
              V
0
              , where
              υ
S
              (
              t
              ) is the desired signal and
              V
0
              is a relatively small dc offset. For this input, an ideal inverting integrator has an output of
            




              The desired output is accompanied by a ramp waveform caused by a small dc offset. Even if
              V
0
              is very small, the ramp
              V
0
t
              will eventually overwhelm the desired signal and saturate the OP AMP.
            


              The dc offset problem is dealt with using the reset switch in
              Figure 6-25
              (a) to limit the time interval during which the circuit performs integration. When the reset signal is high, the switch is closed, any voltage on the capacitor is removed, and the integrator output voltage is forced to zero. When the reset signal goes low, the switch opens and the circuit operates as an integrator. At the end of a fixed time interval, the reset signal goes high again and the switch closes, forcing the output to zero. Practical integrator applications use
              time-limited integration
              in which the integrator output is periodically reset to zero before any offset driven ramp becomes important. Analog computers discussed earlier routinely used this concept.
            

              Next, consider an inverting differentiator with an input
              υ
S
              (
              t
              ) +
              V
A
              × sin(ω
              t
              ), where
              υ
S
              (
              t
              ) is the desired signal and
              υ
A
              sin(ω
              t
              ) represents relatively small high-frequency noise. For this input, an ideal inverting differentiator has an output of
            




              The desired output is accompanied by an amplified noise component. Even if the input noise amplitude
              V
A
              is very small, the term ω
              V
A
              can be large for high-frequency noise. The basic problem is that differentiation amplifies high-frequency noise to a degree that can overwhelm the desired signal.
            

              The high-frequency noise problem is dealt with by adding the series resistor shown in
              Figure 6-25
              (b). This addition limits the frequency range over which the circuit actually performs differentiation. At low frequencies, the capacitor is the dominant element, the series resistor plays no role, and the circuit performs differentiation. At high frequencies, the roles reverse: The added resistor dominates, the capacitor can be ignored, and the circuit functions as an inverter. As a result, the modified circuit only differentiates signals in a low-frequency band.
              
5

              Practical applications use
              band-limited differentiation
              to avoid high-frequency noise problems.
            









FIGURE 6-25













FIGURE 6-25








6-4 Equivalent Capacitance and Inductance

          In
          Chapter 2
          , we found that resistors connected in series or parallel can be replaced by equivalent resistances. The same principle applies to connections of capacitors and inductors—for example, to the parallel connection of capacitors in
          Figure 6-26
          (a). Applying KCL at node A yields
        










FIGURE 6-26



Capacitors connected in parallel. (a) Given circuit. (b) Equivalent circuit.





          Since the elements are connected in parallel, KVL requires
        




          Because the capacitors all have the same voltage, their
          i-υ
          relationships are all of the form
          i
k
          (
          t
          ) =
          C
k
dv
          (
          t
          )/
          dt
          . Substituting the
          i-υ
          relationships into the KCL equation yields
        



Factoring the derivative out of each term, we get




          This equation states that the responses u(0 and
          i
          (
          t
          ) in
          Figure 6-26
          (a) do not change when the
          N
          parallel capacitors are replaced by an equivalent capacitance:
        


(6-28)




          The equivalent capacitance simplification is shown in
          Figure 6-26
          (b). The initial voltage, if any, on the equivalent capacitance is
          υ
          (0), the common voltage across all of the original
          N
          capacitors at
          t
          = 0.
        

          Next, consider the series connection of
          N
          capacitors in
          Figure 6-27
          (a). Applying KVL around loop 1 in
          Figure 6-27
          (a) yields the equation
        










FIGURE 6-27



Capacitors connected in series. (a) Given circuit. (b) Equivalent circuit.



Since the elements are connected in series, KCL requires




          Since the same current exists in all capacitors, their
          i-υ
          relationships are all of the form
        




          Substituting these
          i-υ
          relationships into the loop 1 KVL equation yields
        





          We can factor the integral out of each term to obtain
        




          This equation indicates that the responses
          υ
          (
          t
          ) and
          i
          (
          t
          ) in
          Figure 6-27
          (a) do not change when the
          N
          series capacitors are replaced by an equivalent capacitance:
        


(6-29)




          The equivalent capacitance is shown in
          Figure 6-27
          (b). The initial voltage on the equivalent capacitance is the sum of the initial voltages on each of the original
          N
          capacitors.
        
The equivalent capacitance of a parallel connection is the sum of the individual capacitances. The reciprocal of the equivalent capacitance of a series connection is the sum of the reciprocals of the individual capacitances. Since the capacitor and inductor are dual elements, the corresponding results for inductors are found by interchanging the series and parallel equivalence rules for the capacitor. That is, in a series connection the equivalent inductance is the sum of the individual inductances:



(6-30)




For the parallel connection, the reciprocals add to produce the reciprocal of the equivalent inductance:



(6-31)





          Derivation of
          Eqs. (6-30)
          and
          (6-31)
          uses the approach given previously for the capacitor except that the roles of voltage and current are interchanged. Completion of the derivation is left as a problem for the reader.
        











EXAMPLE 6-14


                  Find the equivalent capacitance and inductance of the circuits in
                  Figure 6-28
                  .
                









FIGURE 6-28








SOLUTION:




                (a) For the circuit in
                Figure 6-28
                (a), the two 0.5-μF capacitors in parallel combine to yield an equivalent of 0.5 + 0.5 = 1-μF capacitance. This 1-μF equivalent capacitance is in series with a 1-μF capacitor, yielding an overall equivalent of
                C
EQ
                = 1/(1/1 + 1/1) = 0.5 μF.
              

                (b) For the circuit of
                Figure 6-28
                (b), the 10-mH and the 30-mH inductors are in series and add to produce an equivalent inductance of 40 mH. This 40-mH equivalent inductance is in parallel with the 80-mH inductor. The equivalent inductance of the parallel combination is
                L
EQ
                = 1/(1/40 + 1/80) = 26.67 mH.
              

                (c) The circuit of
                Figure 6-28
                (c) contains both inductors and capacitors. In later chapters, we will learn how to combine all of these into a single equivalent element. For now, we combine the inductors and the capacitors separately. The 5-pF capacitor in parallel with the 0.1-μF capacitor yields an equivalent capacitance of 0.100005 μF. For all practical purposes, the 5-pF capacitor can be ignored, leaving two 0.1-μF capacitors in series with equivalent capacitance
                
                of 0.05 μF. Combining this equivalent capacitance in parallel with the remaining 0.05-μF capacitor yields an overall equivalent capacitance of 0.1 μF. The parallel 700-μH and 300-μH inductors yield an equivalent inductance of 1/(1/700 + 1/300) = 210 μH. This equivalent inductance is effectively in series with the 1-mH inductor at the bottom, yielding 1000 + 210 = 1210 μH as the overall equivalent inductance.
              


Figure 6-29
              shows the simplified equivalent circuits for each of the circuits of
              Figure 6-28
              .
            







FIGURE 6-29













FIGURE 6-30







■

 









Exercise 6-14


(a) A 150-μH inductor is in parallel with two other identical inductors. That combination is in series with a 100-μH inductor. What is the equivalent inductance of the connection?
(b) A capacitor bank consists of five hundred 400-VDC, 10-mF capacitors in parallel. How much energy can the bank store when the capacitors are fully charged?

Answers:


                (a)
                L
eq
                =150 μH
              

                (b)
                w
                = 400 kJ
              











Exercise 6-15


              Find the equivalent capacitance and the initial stored voltage for the circuit in
              Figure 6-30
              .
            


Answer:



C
Eq
              = 0.0276 μF with
              υ
C
              (0) = 35 V.
            










Exercise 6-16


              The currentthrougha series connection of two 1-μF capacitors is a rectangular pulse with an amplitude of 2 mA and a duration of 10 ms. At
              t
              = 0 the voltage across the first capacitor is +10 V and across the second is zero.
            


                (a) What is the voltage across the series combination at
                t
                = 10 ms?
              
(b) What is the maximum instantaneous power delivered to the series combination?

                (c) What is the energy stored on the first capacitor at
                t
                = 0 and
                t
                = 10 ms?
              

Answers:

(a) 50 V

                (b) 100 mW at
                t
                = 10ms
              
(c) 50 μJ and 450 μJ












              Design
              Exercise 6-17


(a) You only have 0.1-μF capacitors, but need to design equivalent capacitors of 0.2 μF, 0.05 μF, and 0.15 μF. How would you build them?
(b) similarly, you only have 100-mH inductors, but need to design a 60-mH inductor. How would you design it?

Answers:

(a) Two 0.1-μF capacitors in parallel would produce 0.2 μF. Two 0.1-μF capacitors in series would produce 0.05 μF. Two 0.1-μF capacitors in series and then in parallel with a 0.1-μF capacitor would yield an equivalent capacitance of 0.15 μF.
(b) Two 100-mH inductors in parallel, in series with a 100-mH inductor, then the combination in parallel with a 100-mH inductor would result in a 60-mH inductor equivalent.






            DC Equivalent Circuits
          
Sometimes we need to find the dc response of circuits containing capacitors and inductors. In the first two sections of this chapter, we found that under dc conditions a capacitor acts like an open circuit and an inductor acts like a short circuit. In other words, under dc conditions, an equivalent circuit for a capacitor is an open circuit and an equivalent circuit of an inductor is a short circuit.

            To determine dc responses, we replace capacitors by open circuits and inductors by short circuits and analyze the resulting resistance circuit using any of the methods in
            Chapters 2
            through
            4
            . The circuit analysis involves only resistance circuits and yields capacitor voltages and inductor currents along with any other variables of interest. Computer programs like Multisim use this type of dc analysis to find the initial operating point of a circuit to be analyzed. The dc capacitor voltages and inductor currents become initial conditions for a transient response that begins at
            t
            0 when something in the circuit changes, such as the position of a switch.
          











EXAMPLE 6-15


                    Determine the voltage across the capacitors and current through the inductors in
                    Figure 6-31
                    (a).
                  









FIGURE 6-31








SOLUTION:



                The circuit is driven by a 5-V dc source.
                Figure 6-31
                (b) shows the equivalent circuit under dc conditions. The current in the resulting series circuit is 5/(50 + 50) = 50 mA. This dc current exists in both inductors, so
                i
L1
                =
                i
L2
                = 50 mA. By voltage division, the voltage across the 50-Ω, output resistor is
                υ
                = 5 × 50/(50 + 50) = 2.5V; therefore,
                υ
C1
                (0) = 2.5 V. The voltage across
                C
2
                is zero because of the short circuits produced by the two inductors.
                ■










Exercise 6-18


                Find the OP AMP output voltage in
                Figure 6-32
                .
              


Answer:














FIGURE 6-32









Summary


            The linear
            capacitor
            and
            inductor
            are dynamic circuit elements that can store energy. The instantaneous element power is positive when they are storing energy and negative when they are delivering previously stored energy. The net energy transfer is never negative because inductors and capacitors are passive elements.
          
The current through a capacitor is zero unless the voltage is changing. A capacitor acts like an open circuit to dc excitations.
The voltage across an inductor is zero unless the current is changing. An inductor acts like a short circuit to dc excitations.

            Capacitor voltage and inductor current are called
            state variables
            because they define the energy state of a circuit. Circuit state variables are continuous functions of time as long as the circuit driving forces are finite.
          

            OP AMP capacitor circuits perform signal
            integration
            or
            differentiation.
            These operations, together with the summer and gain functions, provide the building blocks for designing dynamic input-output characteristics.
          

            Capacitors or inductors in series or parallel can be replaced with an equivalent element found by adding the individual capacitances or inductances or their reciprocals. The dc response of a dynamic circuit can be found by replacing all capacitors with open circuits and all inductors with short circuits.
            






          Chapter 6 Problems
        






              Objective 6-1 Capacitor and Inductor Responses (
              Sects. 6-1
              and
              6-2
              )
            

(a) Given the current through a capacitor or an inductor, find the voltage across the element.
(b) Given the voltage across a capacitor or an inductor, find the current through the element.
(c) Find the power and energy associated with a capacitor or inductor.


              See
              Examples 6-1
              to
              6-4
              and
              6-6
              to
              6-8
              , and
              Exercises 6-1
              to
              6-9
              .
            





6-1
            For
            t
            ≥ 0, the voltage across a 1-μF capacitor is
            υ
C
            (
            t
            ) = 10
            u
            (
            t
            ) V. Derive expressions for
            i
C
            (
            t
            ) and
            p
C
            (
            t
            ). Is the capacitor absorbing power, delivering power, or both?
          

6-2
            The voltage across a 10000-pF capacitor is
            υ
C
            (
            t
            ) = 100 sin (2π10
            4
t
            ) V. Derive expressions for
            i
C
            (
            t
            ) and
            p
C
            (
            t
            ). Is the capacitor absorbing power, delivering power, or both?
          


6-3
            The current through a 0.2-μF capacitor is a rectangular pulse with an amplitude of 3 mA and a duration of 5 ms. Find the capacitor voltage at the end of the pulse when the capacitor voltage at the beginning of the pulse is -50 V.
          

6-4
            The voltage across a 0.001-μF capacitor is shown in Figure P6-1. Prepare sketches of
            i
C
            (
            t
            ),
            p
C
            (
            t
            ), and
            w
C
            (
            t
            ). Is the capacitor absorbing power, delivering power, or both?
            






FIGURE P6-4









6-5
            The voltage across a 0.01-μF capacitor is shown in
            Figure P6-5
            . Prepare sketches of
            i
C
            (
            t
            ),
            p
C
            (
            t
            ), and
            w
C
            (
            t
            ). Is the capacitor absorbing power, delivering power, or both?
            






FIGURE P6-5









6-6
            For
            t
            ≥ 0, a current source delivers
            i
S
            (
            t
            ) = 10 cos(4000π
            t
            ) mA to two 2.0-μF capacitors connected in series. Using Multisim, plot
            υ
C
            (
            t
            ) across each capacitor versus time when
            υ
C
            (0) = -5V across the series combination. In Multisim, use the ac current source - the frequency is in Hertz - and set the other parameters appropriately. Click on the capacitors and set their initial condition appropriately. Then simulate the output using the transient analysis, but be certain to check "User-defined" under initial conditions. What is the voltage across each capacitor at
            t
            = 0, 125 and 200 us? On your graph, separate the two plots by adding a 0.5-V offset.
          


6-7
            A 100-μF capacitor has no voltage across it at
            t
            = 0. A current flowing through the capacitor is given as
            i
C
            (
            t
            ) = 2
            u
            (
            t
            ) - 3
            u
            (
            t
            - 3) +
            u
            (
            t
            - 6) mA. Find the voltage across the capacitor at
            t
            = 4 s. Repeat for
            t
            = 6 s.
          

6-8
            For
            t
            ≥ 0, the current through a 3300-μH inductor is
            i
L
            (
            t
            ) = 2
            e

              −20,000
              t

            A. Find
            υ
L
            (
            t
            ),
            p
L
            (
            t
            ), and
            w
L
            (
            t
            ) for
            t
            ≥ 0. Is the inductor absorbing power, delivering power, or both?
          



6-9
            For
            t
            ≥ 0, the voltage across a 220-mH inductor is
            υ
L
            (
            t
            ) = 25
            e

              −200
              t

            V. Plot
            i
L
            (
            t
            ) versus time when
            i
L
            (0) = 100 mA.
            
(a) Solve using Multisim. In Multisim, use the exponential voltage source, and set its initial value to 25 V and the pulsed value to 0 V. Set the rise-time appropriately. Set the fall delay time well beyond the period over which you want to observe the response. Then, click on the inductor and set the inductor's initial condition to 100 mA. Plot the output using the transient analysis. Under "Analysis parameters," be sure to check the box under initial conditions to "User-defined" and set the " End time" to display at least five time constants.
(b) Solve and graph using MATLAB.




6-10
            Repeat Problem 6-9 when the voltage across a 20-mH inductor is
            υ
L
            (
            t
            ) = 100
            e

              −2500
              t

            V. Plot
            i
L
            (
            t
            ) versus time when
            i
L
            (0) = +1 A.
          



6-11
            A voltage
            υ
L
            (
            t
            ) = 5 cos(1000
            nt
            ) V appears across a 50-mH inductor, where
            n
            is a positive integer that controls the frequency of the input signal. The amplitude of the input signal is constant. Assume
            i
L
            (0) = 0 A. Use MATLAB and symbolic variables to compute an expression for
            i
L
            (
            t
            ). On the same axes, plot
            i
L
            (
            t
            ) versus time for
            n
            = 1, 2, 3, 4, and 5, over an appropriate time scale. On another set of axes, plot the amplitude of
            i
L
            (
            t
            ) versus the coefficient n.As
            n
            approaches infinity, what happens to the amplitude of the current? What type of circuit element does the inductor behave like as
            n
            approaches infinity?
          


6-12
            A 1-μF capacitor with 0 V initial value is connected i to an exponential source with the following properties:
            
            initial value: 0 V, final value: 1 V, rising time constant: 1 ms. Using Multisim, plot the power stored in the capacitor and provided by the exponential source versus time. At what time is the maximum power stored in the capacitor and how much is that power? Explain the behavior of the power in the capacitor relative to the driving source.
          


6-13
            The capacitor in
            Figure P6-13
            carries an initial voltage
            υ
C
            (0) = - 25 V. At
            t
            = 0, the switch is closed, and thereafter the voltage across the capacitor is
            υ
C
            (
            t
            ) = -100 + 75
            e

              −2000
              t

            V. Derive expressions for
            i
C
            (
            t
            ) and
            p
C
            (
            t
            ) for
            t
            > 0. Is the capacitor absorbing power, delivering power, or both?
            






FIGURE P6-13









6-14

            A1-μF capacitor and a 100-mH inductor are connected in parallel with a closed switch as shown in
            Figure P6-14
            . The inductor has -10 mA flowing through it at
            t
            = 0. The switch opens at
            t
            = 0.
            

(a)
                Find the initial voltage across the capacitor at
                t
                = 0.
              

(b)
                Write an equation for the voltage across the elements for
                t
                > 0. Do not solve it.
              

(c)
                Simulate the circuit using Multisim. Connect an inductor in parallel with a capacitor and assign the appropriate initial conditions and run a transient analysis. Plot the voltage across the elements for 4 ms.
              

(d)
                Characterize the response signal.
              

(e)
                Now add a 1-kΩ resistor in parallel to the inductor and capacitor. Run the simulation with the resistor. Recalling the signals studied in
                Chapter 5
                , what does the response of
                υ
C
                (
                t
                ) look like?
              

(f)

                Explain what happened in terms of the energy stored in the circuit.
              








FIGURE P6-14









6-15
            The inductor in
            Figure P6-15
            carries an initial current of
            i
L
            (0) = 20 mA. At
            t
            = 0, the switch opens, and thereafter the voltage across the inductor is
            υ
L
            (
            t
            ) = -6
            e

              −1000
              t

            mV. Derive expressions for
            i
L
            (
            t
            ) and
            p
L
            (
            t
            ) for
            t
            > 0. Is the inductor absorbing or delivering power?
            






FIGURE P6-15








6-16
            A 4700-pF capacitor is connected in series with a 100-kΩ resistor as shown in
            Figure P6-16
            . The voltage across the capacitor is
            υ
C
            (
            t
            ) = 10 cos(1000
            t
            ) V. What is the voltage across the resistor?
            






FIGURE P6-16









6-17
            For
            t
            > 0, the voltage across an energy storage element is
            υ
            (
            t
            ) = 5 × 10
            5
            (1 -
            e

              −100
              t

            ) V and the current through the element is
            i
            (
            t
            ) = 5
            e

              −100
              t

            mA. What are the element, the element value, and its initial condition?
          

6-18
            For
            t
            > 0, the voltage across a circuit element is
            υ
            (
            t
            ) = 5
            te

              −100
              t

            cos(1000
            t
            ) V and the current through the element is
            i
            (
            t
            ) = 2.5
            te

              −100
              t

            cos(1000
            t
            ) μA. What are the element, the element value, and its initial condition?
          



6-19
            The capacitor in
            Figure P6-19
            has a 5-V charge across it. The comparator is one-sided with
            v
HIGH
            = 5 V and
            v
LOW
            = 0 V. At
            t
            = 0, the switch closes. Using Multisim plot
            υ
C
            (
            t
            ) and
            υ
O
            (
            t
            ) on the same axes for
            t
            > 0.
            






FIGURE P6-19












                  Objective 6-2 Dynamic OP AMP Circuits (
                  Sect. 6-3
                  )
                

(a) Given an OP AMP integrator or differentiator, determine the output for specified inputs.

                    (b) Given a general
                    RC OP
                    AMP circuit, determine its input-output relationship and construct a block diagram.
                  

                    (c) Design an
                    RC OP
                    AMP circuit to implement a given input-output relationship or a block diagram.
                  

                    See
                    Examples 6-9
                    to
                    6-13
                    and
                    Exercises 6-10
                    to
                    6-13
                    .
                  







6-20
            The OP AMP integrator in
            Figure P6-20
            has
            R
            = 22 kΩ, C = 0.068 μF, and
            υ
O
            (0) = 10 V. The input is
            υ
S
            (
            t
            ) = 6
            e

              −250
              t

u
            (
            t
            ) V. The OP AMP has a
            V
CC
            = ±15 V.
            

                (a) Find
                υ
O
                (
                t
                ) for
                t
                > 0.
              
(b) Using Multisim, plot the input and the output versus time.








FIGURE P6-20










6-21
            Build the OP AMP circuit of
            Figure P6-20
            in Multisim. Let
            R
            = 33kΩ,
            C
            = 0.056 μF, and
            υ
O
            (0) = 15 V. The input is 10 (1 -
            e

              −500
              t

            )
            u
            (
            t
            ) V. The OP AMP has a
            V
CC
            = ±15 V. Plot the output
            υ
O
            (
            t
            ) for
            t
            > 0. Over what period of time is the OP AMP in the linear range? [
            Hints:
            Use the exponential source, set the initial condition of the capacitor to - 15 V, and arrange the limits of the OP AMP to ±15 V. When running the transient simulation, ensure that the analysis uses user-defined initial conditions.]
          

6-22
            An OP AMP integrator with
            R
            = 1 MΩ,
            C
            = 1 μF, and
            υ
O
            (0) = 0 V has the output waveform shown in
            Figure P6-22
            . Sketch
            υ
S
            (
            t
            ) for
            t
            > 0.
            






FIGURE P6-22









6-23
            An OP AMP circuit from
            Figure 6-18
            is in the box shown in
            Figure P6-23
            . The input and outputs are given. What is the function of the circuit in the box if:
            

                (a)
                υ
S
                (
                t
                ) = cos 500
                t
                mV and
                υ
O
                (
                t
                ) = 10 sin 500
                t
                V.
              

                (b)
                υ
S
                (
                t
                ) = cos 500
                t
                mV and
                υ
O
                (
                t
                )= -10 cos 500
                t
                V.
              

                (c)
                υ
S
                (
                t
                ) = cos 500
                t
                mV and
                υ
O
                (
                t
                ) = -20 sin 500
                t
                pV.
              

                (d)
                υ
S
                (
                t
                ) = cos 500
                t
                mV and
                υ
O
                (
                t
                ) = 100 cos 500
                t
                V.
              








FIGURE P6-23








6-24
            Design appropriate OP AMP circuits that will realize each of the functions in Problem 6-23. The OP AMPs available have a maximum
            K
            of 10,000 and a
            V
CC
            = ±15 V.
          


6-25
            The OP AMP integrator in
            Figure P6-20
            has
            R
            = 22 kΩ,
            C
            = 0.001 μF, and
            υ
O
            (0) = 0 V. The input is
            υ
S
            (
            t
            ) = 2 sin (ω
            t
            )
            u
            (
            t
            ) V. Derive an expression for
            υ
O
            (
            t
            ) and find the smallest allowable value of ω for linear operation of the OP AMP. Assume
            V
CC
            = ±15 V.
          

6-26
            The OP AMP differentiator in
            Figure P6-26
            with
            R
            = 33 kΩ and
            C
            = 0.62 μF has the input
            υ
S
            (
            t
            ) = 10(1 -
            e

              −50
              t

            )
            u
            (
            t
            ) V. Find
            υ
O
            (
            t
            ) for
            t
            > 0. If the OP AMP has a
            V
CC
            = ±15 V, will it saturate?
            






FIGURE P6-26









6-27

            Redesign the circuit of
            Figure P6-26
            using an
            RL
            circuit rather than the
            RC
            approach shown.
          


6-28
            Consider the circuit of
            Figure P6-28
            .
            R
1
            =
            R
2
            = l MΩ,
            C
1
            =
            C
2
            = 1 μF, and the capacitors have zero initial conditions, the output should, in theory, be the same as the input as long as the OP AMPs are not saturated.
            
(a) Demonstrate that this is true.
(b) Test this in Multisim by inputting a 1 radian/s sine wave into the cascaded OP AMP circuit and plot the input, the output of the first stage, and the output of the second stage. Comment on the results.








FIGURE P6-28









6-29

            The input to the OP AMP differentiator in
            Figure P6-26
            is
            υ
S
            (
            t
            ) = 5[sin (2π × 10
            6
t
            )]
            u
            (
            t
            ) mV. Select
            R
            and
            C
            so that the output sinusoid has extreme values of at least ±11V but does not saturate the OP AMP at ±12 V.
          

6-30
            Find the input-output relationship of the
            RC OP
            AMP circuit in
            Figure P6-30
            .
            






FIGURE P6-30










6-31
            Show that the
            RC OP
            AMP circuit in
            Figure P6-31
            is a noninverting integrator whose input-output relationship is
            









FIGURE P6-31








6-32

            Design an
            RC OP
            AMP circuit to implement the block diagram in
            Figure P6-32
            .
            






FIGURE P6-32









6-33

            Repeat Problem 6-32 but use an
            RL OP
            AMP circuit.
          


6-34

            For the block diagram shown in
            Figure P6-34
            :
            
(a) Find the differential equation it represents.

                (b) Design an
                RC OP
                AMP circuit to implement the block diagram using integrators.
              

                (c) Design an
                RC OP
                AMP circuit to implement the block diagram using differentiators.
              
(d) Build the integrator solution and validate it using Multi-sim. The capacitors should have zero initial conditions. What does the response look like?








FIGURE P6-34










6-35

            In this problem you will design an oscillator. The equation for your oscillator is
            




                (a) Draw a block diagram to solve your equation (
                υ
O
                (
                t
                ) should be your output) using differentiators.
              

                (b) Draw a block diagram to solve your equation (
                υ
O
                (
                t
                ) should be your output) using integrators.
              
(c) Design a circuit using OP AMP integrators to realize your block diagram.
(d) Using Multisim, simulate your circuit and show that your output is an oscillator. Give both capacitors in the circuit 2-V initial conditions. What is its oscillating frequency? What could you do to alter the oscillating frequency?



6-36

            For the differential equation:
            



(a) Draw a block diagram using only integrators, summers, and amplifiers.
(b) Design an OP AMP circuit to solve the block diagram found in (a).







                  Objective 6-3 Equivalent Inductance and Capacitance (
                  Sect. 6-4
                  )
                


                    (a) Derive equivalence properties of inductors and capacitors or use equivalence properties to simplify
                    LC
                    circuits.
                  

                    (b) Given an
                    RLC
                    circuit with dc input signals, find the dc current and voltage responses.
                  


                  See
                  Examples 6-14
                  and
                  6-15
                  and
                  Exercises 6-14
                  to.
                





6-37
            Find a single equivalent element for each circuit in
            Figure P6-37
            .
            






FIGURE P6-37








6-38
            Use the lookback method to find the equivalent capacitance of the circuit shown in
            Figure P6-38
            .
            







FIGURE P6-38









6-39

            You need to have an equivalent inductance of 235 mH for a particular application. However, you only have 100-mH inductors available. How might you connect these to get within ±5% of the desired value?
          

6-40
            Find the equivalent capacitor in the circuit of
            Figure P6-40
            .
            






FIGURE P6-40









6-41
            What is the equivalent capacitance and initial voltage of a series connection of a 33-μF capacitor with 100 V stored and a 47-μF capacitor with 50 V stored?
          

6-42
            What is the equivalent inductance and initial current for the inductors shown in
            Figure P6-42
            ?
            






FIGURE P6-42









6-43
            For the circuit in
            Figure P6-43
            , find an equivalent circuit consisting of one inductor and one capacitor. Select a value of an inductor and a capacitor from among the standard values in
            Appendix G
            to realize your result and connect them appropriately.
            






FIGURE P6-43








6-44
Figure P6-44
            is the equivalent circuit of a two-wire feed-through capacitor.
            
(a) What is the capacitance between terminal 1 and ground when terminal 2 is open?
(b) What is the capacitance between terminal 1 and ground when terminal 2 is grounded?








FIGURE P6-44









6-45

            A switching power supply requires an inductor that can store at least 1 mJ of energy. A list of available inductors is shown below. Select the inductor that best meets the requirement. Consider both meeting the specifications and cost. Explain your choice.
            



L
                    (μH)
                  

L
MAX
                    (A)
                  
Cost Each




10
9.2
$4.75


20
7.0
$5.00


50
5.5
$4.50


100
4.3
$4.75


150
3.8
$4.50


250
2.5
$4.75


500
2.1
$5.00





6-46
            The circuits in
            Figure P6-46
            are driven by dc sources. Find the current through the source and the voltages across the capacitors.
            







FIGURE P6-46









6-47
            The circuit in
            Figure P6-47
            is driven by a 100-V dc source. Find the energy stored in the capacitor and each inductor under dc conditions.
            






FIGURE P6-47








6-48


(a)
                The OP AMP circuits in
                Figure P6-48
                have capacitors in their feedback loops. Determine the circuit gains at dc and as the frequency approaches ∞ rad/s.
              

(b)
                Replace the capacitors with inductors and repeat (a).
              








FIGURE P6-48









6-49
            The OP AMP circuit shown in
            Figure P6-49
            is a band (reject filter that will be studied later. Determine the circuit gain at dc and as the frequency approaches ∞ rad/s.
            






FIGURE P6-49










Integrating Problems



6-50


              Piezoelectric Transducer
            

              Piezoelectric transducers (sensors) measure dynamic phenom-enasuchaspressureand force. Thesephenomenacause stresses that "squeeze" a quantity of electric charge from piezoelectric material in the transducer (the term piezo means "squeeze" in Greek). The amount of charge
              q
              (
              t
              ) is directly proportional to the measured variable
              x
              (
              t
              ), that is
              q
              (
              t
              ) = α
              x
              (
              t
              ). Signal amplification is needed because the amount of charge produced is on the order of pC.
              Figure P6-50
              shows an OP AMP charge amplifier that provides the necessary gain. First, show that the OP AMP output is
              υ
O
              (
              t
              ) = -
              Kq
              (
              t
              ). Then select a value of
              C
              so that the charge amplifier gain is
              K
              = 5 mV/pC.
            







FIGURE P6-50










6-51

              LC Circuit Response
            

              At
              t
              = 0, the switch in
              Figure P6-51
              is closed and thereafter the voltage across the capacitor is
            





              Use MATLAB to solve all of the following problems.
            


(a)
                Use the capacitor's
                i-υ
                characteristic to find the current
                i
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Use the inductor's
                i-υ
                characteristic and
                i
                (
                t
                ) to find
                υ
L
                (
                t
                ) for
                t
                ≥ 0.
              

(c)
                Use
                υ
C
                (
                t
                ),
                υ
L
                (
                t
                ), and KVL to find the voltage
                υ
                (
                t
                ) delivered to the rest of the circuit.
              

(d)
                The
                υ
                (
                t
                ) found in (c) should be proportional to the
                i
                (
                t
                ) found in (a). If so, what is the equivalent resistance looking into the rest of the circuit?
              

(e)
                On the same axes, plot
                υ
C
                (
                t
                ),
                υ
L
                (
                t
                ), and
                υ
                (
                t
                ). Use a different color for each waveform. Use the plots to verify KVL for the circuit.
              








FIGURE P6-51









6-52

              Supercapacitor
            

              Supercapacitors have very large capacitances (typically from 0.1 to 13.5 kF), very long charge-holding times, and small sizes, making them useful in nonbattery backup power applications. To measure its capacitance, a supercapacitor is charged to an initial voltage
              υ
O
              (0) = 8 V. At
              t
              = 0, the device undergoes a constant current discharge of
              i
D
              = 4 mA. After 1 hour, the voltage remaining on the capacitor is 3 V. Find the device's capacitance.
            




6-53

              Analog Computer Solution
            

              Design an OP AMP circuit that solves the following second-order differential equation for
              υ
O
              (
              t
              ). Solve for the response for
              υ
O
              (
              t
              ) using Multisim.
              

Caution:


              Avoid saturating the OP AMPs by distributing the gain across several OP AMPs.
            






6-54


RC
              OP AMP Circuit Design
            
An upgrade to one of your company's robotics products requires a proportional plus integral compensator that implements the input-output relationship




              The input voltage
              υ
S
              (
              t
              ) comes from an OP AMP, and the output voltage
              υ
O
              (
              t
              ) drives a 10-kΩ resistive load. Two competing designs are shown in
              Figure P6-54
              . As the project engineer, you are responsible for recommending one of these designs for production. Which design would you recommend and why? (Your mentor, a wise senior engineer, suggests that you first check that both designs implement the required signal-processing function.)
            







FIGURE P6-54










6-55

              Tunable Capacitor and Radio Station
            

              In Section 6-1,
              Figure 6-2
              (g) shows an air-tunable capacitor as one example of the capacitor types. This type of device can vary its capacitance similar to how a potentiometer can vary its resistance. Changing the capacitance in a circuit can change the frequency at which it operates. This device was common in early radio sets. Today, semiconductor devices perform a similar function. Suppose we are given the circuit in
              Figure P6-55
              with a capacitor connected in parallel with an inductor. There are no other devices in the circuit. The capacitor has an initial voltage
              υ
C
              (0) =
              V
0
              V, and the inductor's initial current is
              i
L
              (0) = 0 A.
            







FIGURE P6-55






The differential equation for the voltage across the capacitor in this circuit is given by





              We will learn more about solving this type of differential equation in the next chapter and beyond. The solution to this differential equation is
            




              Using MATLAB, plot on a semi-log scale (logarithmic on the horizontal and linear on the vertical) the radian frequency of
              υ
C
              (
              t
              ) versus the capacitance of the circuit. Then using
              L
              = 1 mH, design a
              tank circuit
              (what they call an
              LC
              circuit in the radio business), so to be able to receive a radio station at 850 kHz.
            



6-56

              Equivalent Capacitance Bridge
            

              Find the equivalent capacitance of the capacitance bridge shown in
              Figure P6-56
              . (
              Hint:
              Use Node Analysis.)
            







FIGURE P6-56









6-57

              Air-Coil Inductor Design
            
In a particular radio frequency (RF) application, you determine there is a need for a small inductor of 125 uH and rather than trying to order one and wait for it to arrive, you decide to wind it yourself. The applicable equation is




              where
              L
              is the inductance in μH,
              r
              is the radius of the coil in inches,
              l
              is the length of the coil in inches, and
              N
              is the number of turns. A maximum length of 1 inch and a maximum coil diameter of 0.25 inches are required in order to fit in the space available. You have both 45-gauge and 50-gauge wires that are 0.0028 and 0.001 inches in diameter, respectively, but the thinner wire is difficult to wind without breaking. Design your coil.
            



6-58


              Filter
            

              Circuits with memory storage are very useful in designing circuits that are frequency selective. Consider the circuit shown in
              Figure P6-58
              . Build that circuit in Multisim. For the source, use the ac power source. Set the amplitude at 1 V and the frequency at 1 Hz. For your analysis, select AC Sweep. You are going to change the frequency of the source from 0.001 Hz (FSTART) to 10 Hz (FSTOP). Select Decade for sweep type and Linear scale. Use 10 points per decade. For your outputs, select the input
              υ
S
              (
              t
              ) and the output
              υ
O
              (
              t
              ). Run the sweep. You will see two graphs. Delete the bottom graph (Phase), we will learn about that in
              Chapter 12
              . Study the Magnitude graph and answer the following questions.
            


(a)
                Why is the gain of the input constant but of the output not?
              

(b)
                The circuit clearly likes some frequencies more than others. In general, what frequencies are favored?
              

(c)
                For reasons that will be explained in
                Chapter 12
                , when the amplitude of the output reaches 0.707 of the maximum output, that frequency is called a critical frequency. What is that frequency in Hz and in rad/s?
              

(d)
                In
                Chapter 12
                , you will see that for this type of circuit
                R
1
                and
                R
2
                control the gain, while
                R
1
                and
                C
1
                control where the 0.707 point occurs. Design a circuit that has a gain of -5 and a critical frequency of 100 Hz. Display your results in Multisim.
              








FIGURE P6-58











Notes




1

              An electric field is a vector quantity. In
              Figure 6-1
              (a), the field is confined to the space between the two plates and is perpendicular to the plates.
            


2

              Permittivity e is a measure of the electric polarizability of a material. It is a measure of the material's ability to resist an electric field from an induced charge. It is also called the material's dielectric constant. It is measured in Farads per meter (F/m). A material with high permittivity, such as a dielectric, can store more energy than one with a low permittivity. capacitors are most often made by separating metal foil with a dielectric.
            


3

              For the 12-bit ADC shown, it operates at 1 MHz, has a sample/hold acquisition time of 200 ns, and can digitize signals up to 500 kHz.
            


4

              Permeability a is the measure of magnetization that a material obtains in response to an applied magnetic field.
            


5

              In
              Chapter 12
              , we find that this low-frequency band falls below ω
              C
              = 1/
              RC
              . Hence, signals above ω
              C
              will be attenuated.
            
















CHAPTER 7

FIRST- AND SECOND-ORDER CIRCUITS







When a mathematician engaged in investigating physical actions and results has arrived at his own conclusions, may they not be expressed in common language as fully, clearly and definitely as in mathematical formula? If so, would it not be a great boon to such as we to express them so—translating them out of their hieroglyphics that we also might work upon them by experiment.


            Michael Faraday, 1857,
            
            British Physicist
          






Some History Behind This Chapter

              Michael Faraday (1791-1867) was appointed a Fellow in the Royal Society at age 32 and was a lecturer at the Royal Institution in London for more than 50 years. During this time, he published over 150 papers on chemistry and electricity. The most important of these papers was the series
              Experimental Researches in Electricity,
              which included a description of his discovery of magnetic induction. A gifted experimentalist, Faraday apparently felt that mathematics obscured the physical truths he discovered through experimentation. As noted in
              Chapter 6
              , the unit of capacitance, the farad, is named in his honor.
            









Why This Chapter Is Important Today
OK, this is a tough chapter. It concentrates on the classical methods of finding the transient response of circuits containing resistors, capacitors, and inductors. Mathematically this requires us to solve first- and second-order differential equations. These solutions help us understand applications such as timing circuits and digital gate delays. It is important to understand first- and second-order transients because we will revisit these concepts frequently in subsequent chapters where we will learn to solve them more simply using transform theory.









Chapter Sections




                    7-1
                    RC
                    and
                    RL
                    Circuits
                  






7-2 First-Order Circuit Step Response






7-3 Initial and Final Conditions






7-4 First-Order Circuit Response to Exponential and Sinusoidal Inputs







                    7-5 The Series
                    RLC
                    Circuit
                  







                    7-6 The Parallel
                    RLC
                    Circuit
                  






7-7 Second-Order Circuit Step Response












Chapter Learning Objectives

7-1
              First-order Circuit Analysis (
              Sects. 7-1
              to
              7-4
              )
            

              Given a first-order
              RC
              or
              RL
              circuit:
            

(a) Find the circuit differential equation, the circuit time constant, and the initial conditions (if not given).
(b) Find the zero-input response.
(c) Find the complete response for step function, exponential, and sinusoidal inputs.


7-2
              First-order Circuit Design (
              Sects. 7-1
              to
              7-4
              )
            

              Given responses in a first-order
              RC
              or
              RL
              circuit:
            

(a) Find the circuit parameters or other responses.
(b) Design a circuit to produce the given responses.


7-3
              Second-order Circuit Analysis (
              Sects. 7-5
              to
              7-7
              )
            
Given a second-order circuit:

(a) Find the circuit differential equation.
(b) Find the circuit natural frequencies and the initial conditions (if not given).
(c) Find the zero-input response.
(d) Find the complete response for a step function input.


7-4
              Second-order Circuit Design (
              Sects. 7-5
              to
              7-7
              )
            

              Given responses in a second-order
              RLC
              circuit:
            

(a) Find the circuit parameters or other responses.
(b) Design a circuit to produce the given responses.







          7-1
          RC
          and
          RL
          Circuits
        

          The flow diagram in
          Figure 7-1
          shows the two major steps in the analysis of a dynamic circuit. In the first step, we use device and connection equations to formulate a differential equation describing the circuit. In the second step, we solve the differential equation to find the circuit response. In this chapter, we examine basic methods of formulating circuit differential equations and the time-honored, classical methods of solving for responses. Solving for the responses of simple dynamic circuits gives us insight into the physical behavior of the basic circuit modules of the more complex networks in subsequent chapters. This insight will help us correlate circuit behavior with the results obtained by other methods of dynamic circuit analysis. There are several other treatments for solving dynamic circuits —each with its own advantages and disadvantages. We will look at phasor circuit analysis in the next chapter and return to it in
          Chapters 15
          ,
          16
          , and
          17
          . A good deal of our study will involve the use of the Laplace transform methods beginning in
          Chapter 9
          through
          Chapter 12
          , and again in
          Chapters 14
          and
          15
          . In
          Chapter 18
          , we will take a brief look into circuit analysis using Fourier transforms.
        







FIGURE 7-1



Flow diagram for dynamic circuit analysis.





            Formulating
            RC
            and
            RL
            Circuit Equations
          

RC
            and
            RL
            circuits contain linear resistors and a single equivalent capacitor or inductor.
            Figure 7-2
            shows how we can divide
            RC
            and
            RL
            circuits into two parts: (1) the dynamic element and (2) the rest of the circuit, containing only linear resistors and sources. To formulate the equation governing either of these circuits, we replace the resistors and sources by their Thévenin or Norton equivalents shown in
            Figure 7-2
            .
          

            Dealing first with the series
            RC
            circuit in
            Figure 7-2
            (a), we note that the Thévenin equivalent source is governed by the KVL constraint
          


(7-1)










FIGURE 7-2



First-order circuits: (a) RC series circuit. (b) RL parallel circuit.





            The capacitor
            i-υ
            constraint is
          


(7-2)




            Substituting the
            i-υ
            constraint into the source constraint yields
          



(7-3)





            The unknown in
            Eq. (7-3)
            is the capacitor voltage υ(
            t
            ) that determines the amount of energy stored in the
            RC
            circuit and is referred to as the
            state variable.


            Mathematically,
            Eq. (7-3)
            is a first-order linear differential equation with constant coefficients. The equation is first order because the first derivative of the dependent variable is the highest-order derivative in the equation. The product
            R
T
C
            is a constant coefficient because it depends on fixed circuit parameters. The signal
            υ
T
            (
            t
            ) is the Thévenin equivalent of the independent sources driving the circuit. The voltage
            υ
T
            (
            t
            ) is the input, and the capacitor voltage
            υ
            (
            t
            ) is the circuit response.
          

            The Norton equivalent source in the
            RL
            parallel circuit in
            Figure 7-2
            (b) is governed by the KCL constraint
          


(7-4)



The element constraint for the inductor can be written as


(7-5)




            Combining the element and source constraints, we get the differential equation for the
            RL
            circuit:
          



(7-6)





            The response of the
            RL
            circuit is also governed by a first-order linear differential equation with constant coefficients. The dependent variable in
            Eq. (7-6)
            is the inductor current. The circuit parameters enter as the constant ratio
            L
            /
            R
N
            , and the driving forces are represented by a Norton equivalent current
            i
N
            (
            t
            ). The unknown in
            Eq. (7-6)
            is the inductor current
            i
            (
            t
            ). This current determines the amount of energy stored in the
            RL
            circuit and is referred to as the
            state variable.


            The state variables in first-order circuits are the capacitor voltage in the
            RC
            circuit and the inductor current in the
            RL
            circuit. As we will see, these state variables contain sufficient information about the past to determine future circuit responses.
          

            We observe that
            Eqs. (7-3)
            and
            (7-6)
            have the same form. In fact, interchanging the quantities
          




            converts one equation into the other. This interchange is another example of the principle of duality. Because of duality, we do not need to study the
            RC
            and
            RL
            circuits as independent problems. Everything we learn by solving the
            RC
            circuit, for example, can be applied to the
            RL
            circuit as well.
          

            We refer to the
            RC
            and
            RL
            circuits as
            first-order circuits
            because they are described by a first-order differential equation. The first-order differential equations
            
            in
            Eqs. (7-3)
            and
            (7-6)
            describe general
            RC
            and
            RL
            circuits shown in
            Figure 7-2
            . Any circuit containing a single uncombinable capacitor or inductor and linear resistors and sources is a first-order circuit.
          


Zero-Input Response of First-Order Circuits

            The response of a first-order circuit is found by solving the circuit differential equation. For the
            RC
            circuit, the response
            υ
            (
            t
            ) must satisfy the differential equation in
            Eq. (7-3)
            and the initial condition
            υ
            (0). By examining
            Eq. (7-3)
            , we see that the response depends on three factors:
          



1.
                The inputs driving the circuit
                υ
T
                (
                t
                )
              



2.
                The values of the circuit parameters
                R
T
                and
                C




3.
                The value of
                υ
                (
                t
                ) at
                t
                = 0 (i.e., the initial condition)
              



            The first two factors apply to any linear circuit, including resistance circuits. The third factor relates to the initial energy stored in the circuit. The initial energy can cause the circuit to have a nonzero response even when the input
            υ
T
            (
            t
            ) = 0 for
            t
            ≥ 0. The existence of a response with no input is something new in our study of linear circuits.
          

            To explore this discovery, we find the
            zero-input response.
            Setting all independent sources in
            Figure 7-2
            to zero makes
            υ
T
            (
            t
            ) = 0 in
            Eq. (7-3)
            :
          



(7-7)





            Mathematically,
            Eq. (7-7)
            is a
            homogeneous equation
            because the right side is zero. The classical approach to solving a linear homogeneous differential equation is to try a solution in the form of an exponential
          



(7-8)





            where
            K
            and
            s
            are constants to be determined.
          

            The form of the homogeneous equation suggests an exponential solution for the following reasons. Equation (7-7) requires that
            υ
            (
            t
            ) plus
            R
T
C
            times its derivative must add to zero for all time
            t
            ≥ 0. This can only occur if
            υ
            (
            t
            ) and its derivative have the same form. In
            Chapter 5
            , we saw that an exponential signal and its derivative are both of the form
            e

              -
              t
              /
              T
c

            . Furthermore, empirical observations of the physical behavior of such circuits suggest an exponential response. Therefore, the exponential is a logical starting place.
          

            If
            Eq. (7-8)
            is indeed a solution, then it must satisfy the differential equation in
            Eq. (7-7)
            . Substituting the trial solution into
            Eq. (7-7)
            yields
          



or




            The exponential function
            e

st

            cannot be zero for all
            t
            . The condition
            K
            = 0 is a trivial solution because it implies that
            υ
            (
            t
            ) is zero for all time
            t
            . The only nontrivial way to satisfy the equation involves the condition
          



(7-9)






Equation (7-9) 
            is the circuit 
            characteristic equation 
            because its root determines the attributes or character of  
            υ   
            (  
            t   
            ). The characteristic equation has a single root at   
            s
            = -1/ 
            R
T
C   
            , so the zero-input response of the 
            RC   
            circuit has the form  
          



    
            The constant   
            K 
            can be evaluated using the value of    
            υ 
            (    
            t
            ) at any time where    
            υ  
            (   
            t 
            ) is known. It is usually convenient to use   
            t   
            = 0. Using the notation   
            υ  
            (0) =
            V
0
            yields
          



The final form of the zero-input response is



(7-10)





            The zero-input response of the
            RC
            circuit is the familiar exponential waveform shown in
            Figure 7-3
            (a). At
            t
            = 0, the exponential response starts out at
            υ
            (0) =
            V
0
            and then decays to zero as
            t
            → ∞. The time constant
            T
C
            =
            R
T
C
            depends only on fixed circuit parameters. From our study of the exponential signals in
            Chapter 5
            , we know that the υ(
            t
            ) decays to about 36.8% of its initial amplitude in one time constant and to essentially zero after about five time constants. The zero-input response of the
            RC
            circuit is determined by two quantities: (1) the circuit time constant and (2) the value of the capacitor voltage at
            t
            =0.
          







FIGURE 7-3



First-order zero-input responses. (a) RC circuit. (b) RL circuit.




            Let us now look at the behavior of an
            RL
            circuit and compare it to the
            RC
            circuit just studied.
          

            The zero-input response of the
            RL
            circuit in
            Figure 7-2
            (b) is found by setting the Norton current
            i
N
            (
            t
            ) = 0 in
            Eq. (7-6)
            .
          



(7-11)





            The unknown in this homogeneous differential equation is the inductor current
            i
            (
            t
            ).
            Equation (7-11)
            has the same form as the homogeneous equation for the
            RC
            circuit, which suggests a trial solution of the form
          




            where
            K
            and
            s
            are constants to be determined. Substituting the trial solution into
            Eq. (7-11)
            yields the
            RL
            circuit characteristic equation
          


(7-12)





            The root of this equation is
            s
            = -
            R
N
            /
            L
            . Denoting the initial value of the inductor current by
            I
0
            , we evaluate the constant
            K








FIGURE 7-3










            The final form of the zero-input response of the
            RL
            circuit is
          



(7-13)





            For the
            RL
            circuit, the zero-input response of the state variable
            i
            (
            t
            ) is an exponential function with a time constant of
            T
C
            =
            G
N
L
            =
            L
            /
            R
N
            =
            L
            /
            R
T
            . This response connects the initial state
            i
            (0)=
            I
0
            with the final state
            i
            (∞) = 0 as shown in
            Figure 7-3
            (b).
          

            The zero-input responses in
            Eqs. (7-10)
            and
            (7-13)
            show the duality between first-order
            RC
            and
            RL
            circuits. These results point out that the zero-input response in a first-order circuit depends on two quantities: (1) the circuit time constant and (2) the value of the state variable at
            t
            = 0. Capacitor voltage and inductor current are called state variables because they determine the amount of energy stored in the circuit at any time
            t.
            The following examples show that the zero-input response of the state variable provides enough information to determine the zero-input response of every other voltage and current in the circuit.
          

            But first, let us find the time constants of
            RC
            or
            RL
            circuits.
          












EXAMPLE 7-1



                    Find the time constants for circuits C1 and C2 in
                    Figure 7-4
                    .
                  









FIGURE 7-4








SOLUTION:



                Circuit C1 has three resistors and a single inductor. The question one should ask is, "What is the equivalent or Norton resistance that the inductor sees?" The time constant then will be
                L
                /
                R
EQ
                . In this example, the inductor "sees" two resistors
                R
1
                and
                R
2
                in parallel and that combination in series with
                R
3
                . Therefore,
                R
EQ
                is
                
                .
              
Hence, the time constant is




                Note that the units of the time constant,
                T
C
                , are seconds, s. Circuit C2 has two capacitors that can be combined into one equivalent capacitor and two resistors in parallel that can also be combined. The time constant for an
                RC
                circuit is
                R
EQ
C
EQ
                . For this circuit, we have
                
                , and the equivalent resistance that
                C
EQ
                sees is
                
                . Therefore, the time constant is
              


■











Design Exercise 7-1


                Find the time constant
                T
C
                for circuit C3 in
                Figure 7-4
                . If
                L
1
                = 80 mH,
                L
2
                = 100 mH, and
                R
1
                = 100 Ω, select
                R
2
                so that the time constant is exactly 0.1 ms.
              


Answer:






















EXAMPLE 7-2


                    The switch in
                    Figure 7-5
                    (a) closes at
                    t
                    = 0, connecting a 1-μF capacitor with 10 V initially stored across it to two resistors in series. Find the responses
                    υ
C
                    (
                    t
                    ) and
                    i
                    (
                    t
                    ) for
                    t
                    ≥ 0. Write an equation for the power
                    p
R
                    (
                    t
                    ) absorbed by the equivalent resistance. Validate your answers using Multisim.
                  









FIGURE 7-5








SOLUTION:



                The solution involves the zero-input response of an
                RC
                circuit since the only energy in the circuit is the voltage stored on the capacitor at
                t
                = 0. To start this solution, we must first determine the circuit time constant after the switch closes. The equivalent resistance seen by the capacitor is
              




                For
                t
                ≥ 0, the time constant is
              




                The initial capacitor voltage is
                V
0
                = 10 V. Using
                Eq. (7-10)
                , the zero-input response of the capacitor voltage is
              




                This result allows us to readily find the current
                i
                (
                t
                ), since once the switch closes we have a series circuit. The current, then, is found by calculating the current through the capacitor using the capacitor's
                i-υ
                relationship
              




                The minus sign tells us that the current is opposite of the referenced direction and is actually flowing out of the capacitor. This makes sense since the energy is stored in the capacitor at
                t
                = 0 and once the switch is closed it flows into the resistors where it is absorbed.
              
The power absorbed by the equivalent resistance can be found as follows:




                Notice the analysis pattern. We first determine the zero-input response of the capacitor voltage. The state variable response together with resistance circuit analysis techniques was then used to find the current. The circuit time constant and the value of the state variable at
                t
                = 0 provide enough information to determine the zero-input response of every voltage or current in the circuit.
              

                Simulating the behavior of the circuit in Multisim will help drive home the fact that there are responses in the circuit with the only energy source being the voltage stored in the capacitor at
                t
                = 0.
              

Figure 7-5
                (b) is the circuit drawn in Multisim. We have placed 10 V on the capacitor as its initial condition. We then simulated the circuit using a transient analysis, being certain to tell the analysis to use the user-defined initial conditions.
                Figure 7-5
                (c) shows the plots of the capacitor voltage
                υ
C
                (
                t
                ) and the circuit current
                i
                (
                t
                ) for
                t
                ≥ 0. From the plot, we can see that the voltage across the capacitor starts at 10 V and then exponentially decays to zero. The current in the circuit is at its maximum magnitude at
                t
                = 0 and then decays to zero with the same time constant of 300 ms as the capacitor's voltage response.
              

                To simulate the power dissipated in the resistors, we needed to create our own output expression. We created P(R1) + P(R2). We also included the power delivered by the capacitor P(C1) and plotted both curves together in
                Figure 7-5
                (d). We can see from the plot that the power absorbed by the resistors exactly matches that delivered by the capacitor (note that the power is negative for the capacitor and positive for
                
                the resistors). Also note that the time constant for the power is 150 ms, which is halfof that for the current and voltage. All of the answers have been validated.
                ■










Exercise 7-2


                The switch in
                Figure 7-6
                closes at
                t
                = 0. For
                t
                ≥ 0, the current through the resistor is
                i
R
                (
                t
                ) =
                e

                  -100
                  t

                mA.
              


                  (a) What is the capacitor voltage at
                  t
                  =0?
                

                  (b) Write an equation for
                  υ
                  (
                  t
                  ) for
                  t
                  ≥ 0.
                

                  (c) Write an equation for the power absorbed by the resistor for
                  t
                  ≥ 0.
                

                  (d) How much energy does the resistor dissipate for
                  t
                  ≥ 0?
                

                  (e) How much energy is stored in the capacitor at
                  t
                  = 0?
                

Answers:

(a) 10 V

                  (b)
                  υ
                  (
                  t
                  ) = 10
                  e

                    -100
                    t

                  V
                

                  (c)
                  p
R
                  (
                  t
                  ) = 10
                  e

                    -200
                    t

                  mW
                
(d) 50 μJ
(e) 50 μJ










FIGURE 7-6




















EXAMPLE 7-3



                    Find the response of the state variable of the
                    RL
                    circuit in
                    Figure 7-7
                    (a) using L
                    1
                    = 10 mH,
                    L
2
                    = 30 mH,
                    R
1
                    = 2 kΩ,
                    R
2
                    = 6 kΩ, and
                    i
L
                    (0) = 100 mA. Validate your answer using Multisim.
                  









FIGURE 7-7








SOLUTION:


The inductors are connected in series and can be replaced by an equivalent inductor




                Likewise, the resistors are connected in parallel and the resistance seen by
                L
EQ
                is
              




Figure 7-7
                (b) shows the resulting equivalent circuit. The interface signals
                υ
                (
                t
                ) and
                i
                (
                t
                ) are the voltage across and current through
                L
EQ
                =
                L
1
                +
                L
2
                . The time constant of the equivalent
                RL
                circuit is
              




                The initial current through
                L
EQ
                is
                
                  i
                  L

                (0) = 0.1 A. Using
                Eq. (7-13)
                with
                I
0
                = 0.1 yields the zero-state response of the inductor current.
              




                Given the state variable response, we can find every other response in the original circuit. For example, by KCL and current division, the current through
                R
1
                is
              




                The current through
                R
1
                is found in Multisim. See
                Figures 7-7
                (c) and (d).
              







FIGURE 7-7







■

 










Exercise 7-3


                Find the current through
                R
2
                and the power dissipated in
                R
1
                in
                Example 7-3
                .
              
Answers:






Example 7-3
            illustrates an important point. The
            RL
            circuit in
            Figure 7-7
            is a first-order circuit even though it contains two inductors. The two inductors are connected in series and can be replaced by a single equivalent inductor. In general, capacitors or inductors in series and parallel can be replaced by a single equivalent element. Thus, any circuit containing the
            equivalent
            of a single inductor or a single capacitor is a firstorder circuit.
          











EXAMPLE 7-4


                    The switch in
                    Figure 7-8
                    is closed at
                    t
                    = 0, connecting a capacitor with an initial voltage of 30 V to the resistances shown. Find the responses
                    υ
C
                    (
                    t
                    ),
                    i
                    (
                    t
                    ),
                    i
1
                    (
                    t
                    ), and
                    i
2
                    (
                    t
                    ) for
                    t
                    ≥ 0.
                  









FIGURE 7-8








SOLUTION:



                This problem involves the zero-input response of an
                RC
                circuit since there is no independent source in the circuit. To find the required responses, we first determine the circuit time constant with the switch closed (
                t
                ≥ 0). The equivalent or Thévenin resistance seen by the capacitor is
              




                For
                t
                ≥ 0, the circuit time constant is
              




                The initial capacitor voltage is given by
                V
0
                = 30 V. Using
                Eq. (7-10)
                , the zero-input response of the capacitor voltage is
              




                The capacitor voltage provides the information needed to solve for all other zero-input responses. The current
                i
                (
                t
                ) through the capacitor is
              




                The minus sign means that the actual current, shown in
                Figure 7-8
                , is opposite the referenced direction. The capacitor is delivering power to the resistors in a manner similar to an exponentially decaying source. We can use current division to find the other currents.
              




■

 










Exercise 7-4


                The switch in the
                RL
                circuit of
                Figure 7-9
                (a) moves instantly from position A to position B at
                t
                = 0. If the current flowing through the inductor at
                t
                = 0 is 1 mA, how long after the switch moves to position B does it take for the voltage across the resistor to reach -5 V? Validate your answer using Multisim.
                








FIGURE 7-9








Answers:



υ
R
                (
                t
                ) = -5 V at
                t
                = 6.93 μs. See
                Figure 7-9
                (b) for the Multisim results.
              



            Sometimes it may be difficult to determine the Thévenin or Norton equivalent seen by the dynamic element in a first-order circuit. In such cases, we use other circuit analysis techniques to derive the differential equation in terms of a more convenient signal variable. For example, the OP AMP
            RC
            circuit in
            Figure 7-10
            is a first-order circuit because it contains a single capacitor.
          







FIGURE 7-10



First-order OP AMP RC circuit.



From previous experience we know that the key to analyzing an inverting OP AMP circuit is to write a KCL equation at the inverting input. The sum of currents entering the inverting input is




            The element equations for the OP AMP are
            i
N
            (
            t
            ) = 0 and
            υ
N
            (
            t
            ) =
            υ
P
            (
            t
            ). However, the noninverting input is grounded; hence
            υ
N
            (
            t
            ) =
            υ
P
            (
            t
            ) = 0. Substituting the OP AMP element constraints into the KCL constraint yields
          



which can be rearranged in standard form as



(7-14)





            The unknown in
            Eq. (7-14)
            is the OP AMP output voltage rather than the capacitor voltage. However, since the left terminal of the capacitor is connected to
            υ
N
            (
            t
            ) and effectively connected to ground, the capacitor voltage and output voltages are in this case equal. The form of the differential equation indicates that the circuit time constant is
            T
C
            =
            R
2
C
            .
          












EXAMPLE 7-5


                    Use Multisim to analyze the zero-input transient behavior of the first-order OP AMP
                    RC
                    circuit shown in
                    Figure 7-10
                    , when
                    C
                    = 1 μF,
                    R
1
                    =
                    R
2
                    = 200 kΩ, and
                    υ
C
                    (0) = -10 V. Find the responses
                    υ
O
                    (
                    t
                    ),
                    i
R1
                    (
                    t
                    ),
                    i
R2
                    (
                    t
                    ), and
                    i
C
                    (
                    t
                    ) for
                    t
                    ≥ 0. Display your results on one Grapher View plot.
                  





SOLUTION:



                The solution involves zero-input responses; hence, in drawing our circuit in Multisim, we set the input of
                Figure 7-10
                to zero (a short), set the capacitor's initial condition to 10 V, which yields the correct sign for
                υ
C
                (0) = -10 V, and draw the rest of the circuit as shown in
                Figure 7-11
                (a).
              







FIGURE 7-11







                The current through
                R
1
                is instantly found since one end of the resistor is connected to ground via the shorted source and the second is connected to
                υ
N
                (
                t
                ), which, by the element equation for the OP AMP, equals
                υ
P
                (
                t
                ), and in this case is connected to ground. This forces the voltage across
                R
                1 to be equal to zero and, therefore, the current through it is always zero. We will not plot this current since it will be a straight line at zero.
              

                In simulating the rest of the circuit we ask Multisim to perform a transient analysis being certain to set the initial conditions to "user-defined." Since the time constant for this circuit is
                R
2
                C, we calculate
                T
C
                = 200 k × 1 μ = 0.2 s. We would like to display at least five time constants, so we set the "Start time" to zero and the "End time" to 1.0 s. We will let Multisim set the remaining two parameters automatically. Next, we need to tell Multisim which output parameters we want it to calculate and display. We select the three desired outputs I(C1), I(R2), and V(output), the last being the OP AMP output
                υ
O
                (
                t
                ), and move them from the "Variables in circuit" column to the "Selected variables for analysis" column. We then click on "Simulate."
              

                The Grapher View opens and the output voltage plot is readily visible, but the current plots appear as a straight line at zero. We need to separate the plots to display them on the same graph. Click on "Graph" and open the "Properties." Open "Traces" and select trace 1 under "Trace ID"; this should be the voltage trace. Under the "Y-vertical axis" select "Left axis." Then under "Trace ID" select 2, one of the current traces, and then under the "Y-vertical axis" select "Right axis." Do the same for the second current trace. This will have the Grapher View plot the voltage trace against the left voltage axis and the two current traces against the right current
                
                axis. Next we will need to adjust the left, right, and bottom axes. On the left axis, label the axis "Voltage (V)" and choose a large font (e.g., 18 pts). Ensure that the "Axis" box is "enabled" (it should be by default) and the "Scale""Linear." Set the range from -10 to 0 (V), and then set the "Total ticks" to 10 and "Minor ticks" to 1. This will display 10 grid lines. On the bottom axis, label the axis "Time (s)" and again choose a large font. Set the range from 0 to 1 (s) (so as to display five time constants). Ensure that the "Axis" is "enabled" and the "Scale""Linear." Again set the "Total ticks" to 10 and "Minor ticks" to 1. Finally, on the right axis, label the axis "Current (A)" and select a large font. Under "Axis" you need to check the box titled "Enabled." This box was already checked on the previous axes by default. Set the Scale to "Linear" like the others. The range is set by noting that at
                t
                = 0, the -10 V across the capacitor is also across
                R
2
                . We can compute that the extreme current through
                R
2
                will be -10 ÷ 200k = -50 μA. Since the current through the capacitor will be the same as through
                R
2
                but opposite in sign, set the range from -50 μs(-5e-005) to 50 μs (5e-005). Finally, set the "Total ticks" to 20 and "Minor ticks" to 1, so as to display all of the gridline values. You can then adjust the weight of the grid lines, the axes, the font size of the axes, the title, as you see fit. Our result is shown in
                Figure 7-11
                (b). The output voltage goes from - 10 V to zero, while the capacitor current goes from +50 μA to zero and the resistor current varies from - 50 μA to zero. All the time constants are the same. The power associated with the capacitor is always negative, which indicates that it is delivering power to the rest of the circuit.
                ■











Exercise 7-5


                A 100-mH inductor and two resistors are all connected in parallel. One resistor is 100Ω and the second is 470Ω. At time
                t
                = 0, the inductor has 100 mA flowing through it. Use Multisim to calculate a transient plot of the current through the inductor and through each resistor for
                t
                ≥ 0.
              


Answers:



                The Grapher View in
                Figure 7-12
                shows the desired transient responses. Note that the sum of the currents through both resistors equals the current provided by the inductor, as expected.
              







FIGURE 7-12













          7-2 First-Order Circuit Step Response
        
Linear circuits often are characterized by their response to certain classic signals. The step, for example, helps characterize the circuit's transient behavior, while the sinusoid helps characterize the circuit's frequency response. This chapter deals with the classical approach to the transient behavior of circuits. First, in this section, we will look at the step response of first-order circuits. Next, we will look at the transient behavior from applying a sinusoid or an exponential to a first-order circuit. We will conclude our study of transient responses by studying the zero-input and step responses of second-order circuits.
The step response analysis we are about to undertake introduces the concepts of forced, natural, zero-state, and zero-input responses, which appear extensively in later chapters. Ironically, designing a circuit to meet transient response specifications requires making compromises with respect to the circuit's steady-state performance. Understanding why circuits behave as they do under both transient and steady-state excitations is essential to finding the optimum design and poses an interesting challenge for circuit designers. For example, starter motors in vehicles, air conditioners, or heavy machinery draw a large current when the motor first starts (transient time) compared to when it operates normally (steady-state time).

          Our development of the first-order step response treats the
          RC
          circuit in detail and then summarizes the corresponding results for its dual, the
          RL
          circuit. When the input to the
          RC
          circuit in
          Figure 7-13
          (a) is a step function, we can write the Thévenin source as
          υ
T
          (
          t
          ) =
          V
A
u
          (
          t
          ). The circuit differential equation in
          Eq. (7-3)
          becomes
        



(7-15)





          The step response is a function υ(
          t
          ) that satisfies this differential equation for
          t
          ≥ 0 and meets the initial condition
          υ
          (0). Since
          u
          (
          t
          ) = 1 for
          t
          ≥ 0, we can write
          Eq. (7-15)
          as
        



(7-16)











FIGURE 7-13



(a) RC circuit driven by a step input. (b) RC circuit driven by a step input.




          Mathematics provides a number of approaches to solving this equation, including separation of variables and integrating factors. However, because the circuit is linear, we chose a method that uses superposition to divide the solution for
          υ
          (
          t
          ) into two components:
        


(7-17)




          The first component,
          υ
N
          (
          t
          ), is the
          natural response
          and is the general solution of
          Eq. (7-16)
          when the input is set to zero. The natural response has its origin in the physical characteristic of the circuit and does not depend on the input or its form. The component
          υ
F
          (
          t
          ) is the
          forced response
          and is a particular solution of
          Eq. (7-16)
          when the input is the step function. We call this the forced response because it represents what the circuit is compelled to do by the input. Here the form of the input is important.
        

          Finding the natural response requires the general solution of
          Eq. (7-16)
          with the input set to zero as follows:
        




          But this is the homogeneous equation that produces the zero-input response in
          Eq. (7-8)
          . Therefore, we know that the natural response takes the form
        


(7-18)





          This is a general solution of the homogeneous equation because it contains an arbitrary constant
          K.
          At this point we cannot evaluate
          K
          from the initial condition, as we did for the zero-input response. The initial condition applies to the
          total
          response (natural plus forced), and we have yet to find the forced response.
        
Turning now to the forced response, we seek a particular solution of the equation



(7-19)





          The equation requires that a linear combination of
          υ
F
          (
          t
          ) and its derivative equal a constant
          V
A
          for
          t
          ≥ 0. Setting
          υ
F
          (
          t
          ) =
          V
A
          meets this condition since
          dυ
F
          /
          dt
          =
          dV
A
          /
          dt
          = 0. Substituting
          υ
F
          (
          t
          ) =
          V
A
          into
          Eq. (7-19)
          reduces it to the identity
          V
A
          =
          V
A
          .
        
Now combining the forced and natural responses, we obtain




          This equation is the general solution for the step response because it satisfies
          Eq. (7-16)
          and contains an arbitrary constant
          K.
          This constant can now be evaluated using the initial condition. Setting
          t
          = 0 we get
        




          The initial condition requires that
          K
          = (
          V
0
          -
          V
A
          ). Substituting this conclusion into the general solution yields the step response of the
          RC
          circuit.
        



(7-20)





          The
          RC
          circuit step response in
          Eq. (7-20)
          starts out at the initial condition
          V
0
          and is driven to a final condition
          V
A
          , which is determined by the amplitude of the step function input. That is, the initial and final values of the response are
        



The path between the two end points is an exponential waveform whose time constant is the circuit time constant. We know from our study of exponential signals that the step response will reach its final value after about five time constants. In other words, after about five time constants, the natural response decays to zero and we are left with a constant forced response caused by the step function input.

          The
          RL
          circuit in
          Figure 7-13
          (b) is the dual of the
          RC
          circuit in
          Figure 7-13
          (a), so the development of its step responses follows the same pattern discussed previously. Briefly sketching the main steps, the Norton equivalent input is a step function
          I
A
u
          (
          t
          ), and for
          t
          ≥ 0 the
          RL
          circuit differential equation
          Eq. (7-6)
          becomes
        



(7-21)





          The solution of this equation is found by superimposing the natural and forced components. The natural response is the solution of the homogeneous equation [right side of
          Eq. (7-21)
          set to zero] and takes the same form as the zero-input response found in the previous section.
        





          where
          K
          is a constant to be evaluated from the initial condition once the complete response is known. The forced response is a particular solution of the equation
        




          Setting
          i
F
          (
          t
          ) =
          I
A
          satisfies this equation since
          dI
A
          /
          dt
          = 0.
        

          Combining the forced and natural responses, we obtain the general solution of
          Eq. (7-21)
          in the form
        




          The constant
          K
          is now evaluated from the initial condition:
        




          The initial condition requires that
          K
          =
          I
0
          -
          I
A
          , so the step response of the
          RL
          circuit is
        



(7-22)





          The
          RL
          circuit step response has the same form as the
          RC
          circuit step response in
          Eq. (7-20)
          . At
          t
          = 0 the starting value of the response is
          i
          (0) =
          I
0
          , as required by the initial condition. The final value is the forced response
          i
          (∞) =
          i
F
          (
          t
          ) =
          I
A
          , since the natural response decays to zero as time increases.
        

          A step function input to the
          RC
          or
          RL
          circuit drives the state variable from an initial value determined by what happened prior to
          t
          = 0 to a final value determined by the amplitude of the step function applied at
          t
          = 0. The time needed to transition from the initial to the final value is about 5
          T
C
          , where
          T
C
          is the circuit time constant. We conclude that the step response of a first-order circuit depends on three quantities:
        



1.
              The amplitude of the step input (
              V
A
              or
            

I
A

)



2.
              The circuit time constant (
              R
T
              C or
            

L/R
N

)



3.
              The value of the state variable at
              t
              = 0 (
              V
0
              or
            

I
0

)



          A typical plot of a first-order response is shown in
          Figure 7-14
          . One should realize that the initial or final conditions can be positive or negative. The exponential plot, therefore, can go from positive to negative, positive to positive, negative to positive (as shown on the figure), or negative to negative.
        







FIGURE 7-14



Step response of a typical first-order circuit.















EXAMPLE 7-6



                  Find the response of the
                  RC
                  circuit in
                  Figure 7-15
                  (a).
                









FIGURE 7-15








SOLUTION:


The circuit is first order, since the two capacitors in series can be replaced by a single equivalent capacitor




              The initial voltage on
              C
EQ
              is the sum of the initial voltages on the original capacitors.
            





              To find the Thévenin equivalent seen by
              C
EQ
              , we first find the open-circuit voltage. Disconnecting the capacitors in
              Figure 7-15
              (a) and using voltage division at the interface yields
            




              Replacing the voltage source by a short circuit and looking to the left at the interface, we see
              R
1
              in parallel with
              R
2
              . The Thévenin resistance of this combination is
            



The circuit time constant is




              For the Thévenin equivalent circuit, the initial capacitor voltage is
              V
0
              = 15 V, the step input is 25
              u
              (
              t
              ), and the time constant is 1/1600 s. Using the
              RC
              circuit step response in
              Eq. (7-20)
              yields
            




              The initial (
              t
              = 0) value of
              υ
              (
              t
              ) is 25-10 = 15 V, as required. The equivalent capacitor voltage is driven to a final value of 25 V by the step input in the Thévenin equivalent circuit. For practical purposes,
              υ
              (
              t
              ) reaches 25 V after about 5
              T
C
              = 3.125 ms.
              ■











Exercise 7-6



                (a) Use the results from
                Example 7-6
                and find the current through
                R
1
                in
                Figure 7-15
                (a) for
                t
                ≥ 0.
              
(b) Validate your answer using Multisim.

Answers:


                (a)
                i
R1
                (
                t
                ) = 2.5 + 0.33
                e

                  -1600
                  t

                mA
                t
                ≥ 0
              

                (b) See
                Figure 7-15
                (b)
              








FIGURE 7-15






















EXAMPLE 7-7



                  Find the step response of the
                  RL
                  circuit in
                  Figure 7-16
                  (a). The initial condition is
                  i
                  (0)=
                  I
0
                  .
                  










FIGURE 7-16








SOLUTION:


We first find the Norton equivalent to the left of the interface. By current division, the short-circuit current at the interface is




              Looking to the left at the interface with the current source off (replaced by an open circuit), we see
              R
1
              and
              R
2
              in series producing a Norton resistance
            




              The time constant of the Norton equivalent circuit in
              Figure 7-16
              (b) is
            



The natural response of the Norton equivalent circuit is




              The short-circuit current
              i
SC
              (
              t
              ) is the step function input in the Norton circuit. Therefore, the forced response is
            



Superimposing the natural and forced responses yields




              The constant
              K
              can be evaluated from the initial condition:
            



which requires that



So the circuit step response is




              An example of this response is shown in
              Figure 7-16
              (c).
              ■












Exercise 7-7



              Use the results from
              Example 7-7
              and find the voltage across the current source in
              Figure 7-16
              (a) for
              t
              ≥ 0.
            


Answer:






















EXAMPLE 7-8



                  The state variable response of a first-order
                  RC
                  circuit for a step function input is
                




(a) What is the circuit time constant?
(b) What is the initial voltage across the capacitor?
(c) What is the amplitude of the forced response?

                    (d) At what time is
                    υ
C
                    (
                    t
                    ) = 0?
                  
(e) Use MATLAB to display the state variable response and use the cursor to validate the time found in part (d).





SOLUTION:




                (a) The natural response of a first-order circuit is of the form
                Ke

                  -
                  t
                  /
                  T
C

                . Therefore, the time constant of the given responses is
                T
C
                = 1/200 = 5 ms.
              

                (b) The initial (
                t
                = 0) voltage across the capacitor is
                




                (c) The natural response decays to zero, so the forced response is the final value
                υ
C
                (
                t
                ).
                




                (d) The capacitor voltage must pass through zero at some intermediate time, since the initial value is positive and the final value negative. This time is found by setting the step response equal to zero:
                



                  which yields the condition
                  e

                    200
                    t

                  = 2 or
                  t
                  = 1n 2/200 = 3.47 ms.
                


                (e) The following MATLAB code plots the step response. The plot and the cursor display are shown in
                Figure 7-17
                (a).
                






FIGURE 7-17









              
                
                clear all
              
              t = 0:2e-6:20e-3;
              vC = 2 0*exp(-2 00*t)-10;
              plot(t,vC,'b', 'LineWidth',3)
              hold on
              grid on
              xlabel('Time (s)')
              ylabel('Voltage (V)')
            

■

 










Exercise 7-8


Given the first-order circuit step response




(a) What is the amplitude of the step input?
(b) What is the circuit time constant?
(c) What is the initial value of the state variable?
(d) What is the circuit differential equation?

                (e) Plot
                υ
C
                (
                t
                ) using MATLAB as in
                Example 7-8
                .
              

Answers:

(a) 20 V
(b) 1 ms
(c) 0 V

                (d) 10
                -3
dυ
C
                (
                t
                )/
                dt
                +
                υ
C
                = 20
                u
                (
                t
                )
              

                (e) See
                Figure 7-17
                (b).
              








FIGURE 7-17

















Exercise 7-9


Find the solutions of the following first-order differential equations:


                (a)
                


                (b)
                


Answers:


                (a)
                


                (b)
                







            Zero-State Response
          

            Additional properties of dynamic circuit responses are revealed by rearranging the
            RC
            and
            RL
            circuit step responses in
            Eqs. (7-20)
            and
            (7-22)
            in the following way:
          




            We recognize the first term on the right in each equation as the zero-input response discussed in
            Sect. 7-1
            . By definition, the
            zero-input response
            occurs when the input is zero (
            V
A
            = 0 or
            I
A
            = 0). The second term on the right in each equation is called the
            zero-state response
            because this part occurs when the initial state of the circuit is zero (
            V
0
            = 0 or
            I
0
            = 0).
          

            The zero-state response is proportional to the amplitude of the input step function (
            V
A
            or
            I
A
            ). However, the total response (zero input plus zero state) is not directly proportional to the input amplitude. When the initial state is not zero, the circuit appears to violate the proportionality property of linear circuits. However, bear in mind that the proportionality property applies to linear circuits with only one input.
          

            The
            RC
            and
            RL
            circuits can store energy and have memory. In effect, they have two inputs: (1) the input that occurred before
            t
            = 0 and (2) the step function applied at
            t
            = 0. The first input produces the initial energy state of the circuit at
            t
            = 0, and the second causes the zero-state response for
            t
            ≥ 0. In general, for
            t
            ≥ 0, the total response of a dynamic circuit is the sum of two responses: (1) the zero-input response caused by the initial conditions produced by inputs applied before
            t
            = 0 and (2) the zero-state response caused by inputs applied after
            t
            = 0.
          











                    APPLICATION
                    EXAMPLE 7-9

The operation of a digital system is controlled by a clock waveform that provides a standard timing reference. At its source, a clock waveform can be described by a rectangular pulse of the form




                    In this example, the pulse amplitude is
                    V
A
                    = 5 V and the pulse duration is
                    T
                    = 10 ns. This clock pulse drives a digital device that can be modeled by the circuit in
                    Figure 7-18
                    (a). In this model,
                    υ
S
                    (
                    t
                    ) is the rectangular clock pulse defined above and
                    υ
                    (
                    t
                    ) is the clock waveform as received at the input to the digital device. The presence of a clock pulse at the device input will be detected only if
                    υ
                    (
                    t
                    ) exceeds a specified logic "1" threshold level.
                  

                    Find the zero-state response of the voltage
                    υ
                    (
                    t
                    ) when
                    RC
                    = 10 ns. Will the clock pulse be detected if the logic "1" threshold level is 3.7 V?
                  









FIGURE 7-18









SOLUTION:



                The rectangular pulse input
                υ
S
                (
                t
                ) is indicated by line labeled
                υ
S
                (
                t
                ) in
                Figure 7-18
                (b). The initial capacitor voltage is zero because we seek the zero-state response. The total response can be found as the sum of the zero-state responses caused by two inputs:
              



1.
                    A positive 5-V step function applied at
                    t
                    = 0
                  



2.
                    A negative 5-V step function applied at
                    t
                    = 10 ns
                  


The first input causes a zero-state response of



The second input causes a zero-state response of




                Notice that
                υ
2
                (
                t
                ) = -
                υ
1
                (
                t
                -
                T
                ), that is,
                υ
2
                (
                t
                ) is obtained by inverting and delaying
                υ
1
                (
                t
                ) by
                T
                = 10 ns. The total response is the superposition of these two responses.
              




Figure 7-18
                (b) shows how the two responses combine to produce the overall pulse response of the circuit. The response
                υ
1
                (
                t
                ) begins at zero and eventually reaches a final value of +5 V. At
                t
                =
                T
                = 10 ns the first response reaches
                υ
2
                (
                T
                ) = 5(1 -
                e
-1
                ) = 3.16 V. The second response
                υ
2
                (
                t
                ) begins at
                t
                =
                T
                = 10 ns, and thereafter is equal and opposite to
                υ
1
                (
                t
                ) except that it is delayed by
                T
                = 10 ns. The net result is that the total response reaches a maximum of
                υ
                (
                T
                ) = 3.16 V. In this example, the clock pulse will not be detected because the logic "1" threshold level is 3.7 V. Clock pulse detection would be made possible by increasing the pulse duration so that
                υ
                (
                T
                ) > 3.7 V. This requires that
              




                or 1.3 > 5
                e

                  -10
                  8
T

                , which yields
                T
                > 1.347 × 10
                -8
                . For the digital device in this example, the minimum detectable clock pulse duration is about 13.5 ns.
                ■











Exercise 7-10


                The element in
                Figure 7-19
                (a) is a 1-μF capacitor.
              


                  (a) The switch closes at
                  t
                  = 0. Find the zero-state response of the capacitor voltage
                  υ
C
                  (
                  t
                  ) for
                  t
                  ≥ 0.
                

                  (b) The switch closes at
                  t
                  = 0. Find the total response for
                  υ
C
                  (
                  t
                  ) for
                  t
                  ≥ 0 if the capacitor has an initial voltage of -0.5 V across it.
                
(c) Simulate part (b) in Multisim.

Answers:


                  (a)
                  


                  (b)
                  


                  (c) See
                  Figure 7-19
                  (b)
                








FIGURE 7-19













FIGURE 7-19
















Exercise 7-11


                The element in
                Figure 7-19
                (a) is a 1-mH inductor. The switch closes at
                t
                = 0. Find the zero-state response of the inductor current
                i
L
                (
                t
                ) for
                t
                ≥ 0.
              


Answer:



i
L
                (
                t
                ) = 0.5(1 -
                e
-5Mt
                ) mA
                t
                ≥ 0
              







          7-3 Initial and Final Conditions
        

          Reviewing the first-order step responses of the last section shows that for
          t
          ≥ 0 the state variable responses can be written in the form
        



(7-23)




In both circuits, the step response is of the general form



To determine the step response of a first-order circuit, we need three quantities: the initial value of the state variable, the final value of the state variable, and the time constant. Since we know how to get the time constant directly from the circuit, it would be useful to have a direct way to determine the initial and final values by inspecting the circuit itself.

          The final value can be calculated directly from the circuit by observing that for
          t
          > 5
          T
C
          the step responses approach a constant value or dc value. Under dc conditions, a capacitor acts like an open circuit and an inductor acts like a short circuit. As a result, the final value of the state variable is found by applying dc analysis methods to the circuit configuration for
          t
          > 0, with capacitors replaced by open circuits (OC) and inductors replaced by short circuits (SC).
        

          We can also use dc analysis to determine the initial value in many practical situations. A common situation is a circuit containing dc sources and a switch that is in one position for a period of time much greater than the circuit time constant, and then is moved to a new position at
          t
          = 0. For example, if the switch is closed for a long period of time, then the dc sources drive the state variable to a final value. If the switch is now opened at
          t
          = 0, then the dc sources drive the state variable to a new final condition appropriate to the new circuit configuration for
          t
          > 0.
          








FIGURE 7-20



Solving a switched dynamic circuit using the initial and final conditions.






Note:


          The initial condition at
          t
          = 0 is the dc value of the state variable for the circuit configuration that existed
          before
          the switch changed positions at
          t
          = 0. The switching action cannot cause an instantaneous change in the initial condition because capacitor voltage and inductor current are continuous functions of time. In other words, opening a switch at
          t
          = 0 marks the boundary between two eras. The final condition of the state variable for the
          t
          < 0 era is the initial condition for the
          t
          > 0 era that follows.
        

          The usual way to state a switched circuit problem is to say that a switch has been closed (open) for a long time and then is opened (closed) at
          t
          = 0. In this context, a long time means at least five time constants. Time constants rarely exceed a few hundred milliseconds in electrical circuits, so a long time passes rather quickly.
        
The state variable response in switched dynamic circuits is found using the following steps:



STEP 1

                Find the initial value by applying dc analysis to the circuit configuration for
                t
                < 0 with the capacitor (inductor) replaced with an open (short) circuit.
              




STEP 2

                Find the final value by applying dc analysis to the circuit configuration for
                t
                >0 with the capacitor (inductor) replaced with an open (short) circuit.
              




STEP 3

                Find the time constant
                T
C
                of the circuit in the configuration for
                t
                > 0.
              




STEP 4

                Write the step response directly using
                Eq. (7-23)
                without formulating and solving the circuit differential equation.
              




          For example, the switch in
          Figure 7-20
          (a) has been closed for a long time and is opened at
          t
          = 0. We want to find the capacitor voltage
          υ
          (
          t
          ) for
          t
          > 0.
        



STEP 1

                The initial condition is found by dc analysis of the circuit configuration in
                Figure 7-20
                (b), where the switch is closed. Using voltage division, the initial capacitor voltage is found to be
              







STEP 2

                The final condition is found by dc analysis of the circuit configuration in
                Figure 7-20
                (c), where the switch is open. When the switch is open the circuit has no dc excitation, so the final value of the capacitor voltage is zero.
              




STEP 3

                The circuit in
                Figure 7-20
                (c) also gives us the time constant. Looking back at the interface, we see an equivalent resistance of
                R
2
                , since
                R
1
                is connected in series with an open switch. For
                t
                ≥ 0, the time constant is
                R
2
C.
                Using
                Eq. (7-23)
                , the capacitor voltage for
                t
                ≥ 0 is
              







          The result is a zero-input response, since there is no excitation for
          t
          ≥ 0. But now we see how the initial condition for the zero-input response could be produced physically by opening a switch that has been closed for a long time.
        
To continue the analysis, we find the capacitor current using its element constraint:




          This is the capacitor current for
          t
          ≥ 0. For
          t
          < 0, the circuit in
          Figure 7-20
          (b) points out that the capacitor current is zero since the capacitor acts like an open circuit.
        

          The capacitor voltage and current responses are plotted in
          Figure 7-21
          . The capacitor voltage is continuous at
          t
          = 0, but the capacitor current has a jump discontinuity at
          t
          = 0. In other words, state variables are continuous, but nonstate variables can have discontinuities at
          t
          = 0. Since the state variable is continuous, we first find the circuit state variable and then solve for other circuit variables using the element and connection constraints.
          








FIGURE 7-21




                Two responses in the RC circuit of
                Figure 7-20
                .
              














EXAMPLE 7-10


                  The switch in
                  Figure 7-22
                  (a) has been open for a long time and is closed at
                  t
                  = 0. Find the inductor current for
                  t
                  ≥ 0.
                




SOLUTION:



              We first find the initial condition using the circuit in
              Figure 7-22
              (b). By series equivalence the initial current is
            




              The final condition and the time constant are determined from the circuit in
              Figure 7-22
              (c). Closing the switch shorts out
              R
2
              , and the final condition and time constant for
              t
              > 0 are
            




              Using
              Eq. (7-23)
              , the inductor current for
              t
              ≥ 0 is
            










FIGURE 7-22







■

 









Exercise 7-12


              The switch in
              Figure 7-22
              (a) has been closed for a long time. The switch opens at
              t
              = 0. Find the inductor current for
              t
              ≥ 0.
            


Answer:





















EXAMPLE 7-11



                  The switch in the circuit of
                  Figure 7-23
                  (a) has been open for a long time. It closes at
                  t
                  = 0. Find the current
                  i
R
                  (
                  t
                  ) for
                  t
                  ≥ 0.
                









FIGURE 7-23








SOLUTION:



              Although the example asks for the current through the 20-kΩ resistor, it is important that we solve for the voltage across the capacitor first, since it is the state variable. The voltage across the capacitor is continuous, whereas the current may not be. Once we
              
              have found the state variable, we can apply the usual connection and element constraints to find the desired variable.
            

              We start by finding the initial voltage across the capacitor at
              t
              = 0−, a whisker of time before the switch is thrown. At
              t
              = 0−, the capacitor is being excited by a dc source, hence it behaves like an open circuit. The voltage can be found using a voltage divider
            




              The final condition can be found similarly. At
              t
              = ∞, the closed switch shorts out the 10-kΩ resistor. Hence, our voltage divider becomes
            




              Next, we need to find the time constant. For an
              RC
              circuit, the time constant is given as
              R
T
C
              , where
              R
T
              is the Thévenin resistance that the capacitor sees
              after
              the switch has been thrown. Using the look-back method with the switch shorting out the 10-kΩ resistor and setting the source to zero by replacing it with a short circuit, we see that
              R
T
              is
            



And the time constant is




              Appling these calculations to
              Eq. (7-23)
              , we find the equation for the state variable
            



To find the current through the 20-kΩ resistor, we recognize that the resistor is in parallel with the capacitor, thereby sharing the same voltage. Applying Ohm's law yields the desired result


■











Exercise 7-13



              The switch in the circuit of
              Figure 7-23
              has been closed for a long time. It opens at
              t
              = 0. Find the voltage
              υ
C
              (
              t
              ) and the current
              i
R
              (
              t
              ) for
              t
              ≥ 0. Plot both on the same graph using Multisim.
            
Answers:




              See
              Figure 7-23
              (b)
              










FIGURE 7-23


















DESIGN EXAMPLE 7-12


                  Design a first-order
                  RC
                  circuit using standard parts (see
                  Appendix G
                  ) that will produce the following voltage across the capacitor:
                  υ
C
                  (
                  t
                  ) = 50-100
                  e

                    -2000
                    t

                  V.
                




SOLUTION:



              We know that the circuit will look like
              Figure 7-24
              (a). We need to select a suitable source
              υ
S
              (
              t
              ), a switch, a resistor
              R
              , and a capacitor
              C
              .
            







FIGURE 7-24






We also know that the general form of a state-variable response is




              Comparing the general form to our given desired response
              υ
C
              (
              t
              ) = 50-100
              e

                -2000
                t

              V, we calculate the time constant as 1/2000 = 500 μs. Hence, we want
              T
C
              =
              RC
              = 500 μs. Selecting
              C
              = 0.015 μF, a standard value, yields
              R
              = 33.3 kΩ There is an
              R
              = 33 kΩ, a standard value that should be close enough considering the tolerances of the components. We now must determine the initial and final voltages. Substituting
              t
              = 0 into our desired output equation, we find our initial voltage is -50 V. Similarly, substituting
              t
              = ∞, we find our final voltage is +50 V. This suggests two voltages, switching at
              t
              = 0 from -50 V to +50V. We can now design our circuit as shown in
              Figure 7-24
              (b).
              ■











              Design
              Exercise 7-14


              Design a first-order
              RL
              circuit that will produce the following current through the inductor:
              i
L
              (
              t
              ) = 5-5
              e

                -500
                t

              mA for
              t
              ≥ 0. Use standard values from
              Appendix G
              for the components.
              



Answer:



              A parallel circuit consisting of a current source is
              i
S
              (
              t
              ) = 5
              u
              (
              t
              ) mA, an inductor of 2 mH, and a resistor of 1 Ω is one possible solution.
            















EXAMPLE 7-13


                  For
                  t
                  ≥ 0 the state variable response of the
                  RL
                  circuit in
                  Figure 7-25
                  (a) is observed to be
                




(a) Identify the forced and natural components of the response.
(b) Find the circuit time constant.
(c) Find the Thévenin equivalent circuit seen by the inductor.

                    (d) Use Multisim to find the inductor current
                    i
L
                    (
                    t
                    ) and voltage
                    υ
L
                    (
                    t
                    ) for
                    t
                    ≥ 0.
                  










FIGURE 7-25








SOLUTION:




                (a) The natural component is the exponential term 100
                e

                  -5000
                  t

                mA. The forced component is what remains after the natural component dies out as
                t
                → ∞, namely,
                i
L
                (∞) = 50 mA. The forced response is a constant 50 mA, which means that the Thévenin equivalent is a dc source.
              

                (b) The time constant is the reciprocal of the coefficient of
                t
                in
                e

                  -5000
                  t

                , that is,
                T
C
                = 5000
                -1
                = 0.2 ms.
              

                (c) Expressed in terms of circuit parameters the time constant is
                T
C
                =
                L
                /
                R
T
                , which yields the Thévenin resistance as
                R
T
                =
                
                  L/T
                  C
                  = 1
                
                kΩ. For dc excitation, the inductor acts like a short circuit at
                t
                = ∞. Hence,
                i
L
                (∞) =
                υ
T
                /
                R
T
                and the Thévenin voltage is
                




                (d) We create the circuit in Multisim. From the given expression for
                i
L
                (
                t
                ) we find that
                i
L
                (0) is 150 mA. Then paying attention to the direction of the initial condition, we draw the circuit as shown in
                Figure 7-25
                (b). Finally, simulating the transient responses for
                i
L
                (
                t
                ) and
                υ
L
                (
                t
                ), we obtain the plots shown in
                Figure 7-25
                (c).
                ■














Design Exercise 7-15



              Design a first-order
              RC
              circuit so that the capacitor's voltage,
              υ
C
              (
              t
              ), will fit entirely inside the specified boundary conditions shown in
              Figure 7-26
              (a).
            







FIGURE 7-26








Answers:


One valid result is




              A circuit that reflects the equation is shown in
              Figure 7-26
              (b) and its plot in
              Figure 7-26
              (c).
            
















EVALUATION EXAMPLE 7-14


                  The switch in
                  Figure 7-27
                  moves from position A to position B at
                  t
                  = 0. The first-order
                  RC
                  circuit in the figure must be designed to produce an output of
                










FIGURE 7-27








                  Evaluate the two proposed circuit designs shown in the figure using the following criteria.
                

(a) A design must produce the required output.
(b) If both produce the desired output, then compare part counts and use of standard values to identify the best design.





SOLUTION:




                (a) The desired output is a first-order step response with
                υ
O
                (0) = 0,
                υ
O
                (∞) = 5 V, and
                T
C
                = 1 ms. For
                t
                < 0, the switch is in position B and there is zero input; hence
                υ
O
                (0) = 0 for both circuits. For
                t
                ≥ 0 the switch is in position A. The final condition
                υ
O
                (∞) is found using voltage division on the circuit with the capacitors replaced by open circuits. The circuit time constant is found using the Thévenin resistance seen by the capacitors. The final value and time constant of circuit A are
                



                  The equivalent capacitance in circuit B is
                  C
EQ
                  = 4 + 1 = 5 μF. The final value and time constant of circuit B are
                



Both circuits produce the desired output.


                (b) Circuit A uses three components: a standard 75-Ω. resistor, a standard 150-Ω resistor, and a nonstandard 20-μF capacitor (see
                Appendix G
                for standard values). Circuit B uses four components: a standard 300-Ω resistor, a nonstandard 600-Ω resistor, a standard 1-μF capacitor, and a nonstandard 4-μF capacitor. Circuit A is a better design than circuit B in terms of both the number of parts and the use of standard values.
                ■













Design Exercise 7-16



              There is a need to design an interface circuit in
              Figure 7-28
              (a) so that the output voltage
              υ
O
              (
              t
              ) across the 100-Ω load equals 10(1 −
              e

                −100
                t

              ) V for
              t
              ≥ 0. Use the fewest number of components possible.
            


Answer:



              See
              Figure 7-28
              (b) for one possible design.
            









FIGURE 7-28













Exercise 7-17



              In the circuit in
              Figure 7-29
              , the switch has been in position A for a long time and is moved to position B at
              t
              = 0. For
              t
              ≥ 0 find the output voltage
              υ
O
              (
              t
              ).
            


Answer:














FIGURE 7-29








7-4 First-Order Circuit Response to Exponential and Sinusoidal Inputs

          A myriad of different signals can excite linear circuits. As we develop our understanding of circuit behavior, note that several signals provide important insight into circuit behavior. Thus far, we have looked at the response of first-order circuits to
          
          step functions and developed analysis techniques that are quick and methodical. We will now look at the transient response of first-order circuits to two different, common, and useful signals: the exponential and the sinusoid. In later chapters, we will learn other techniques to analyze these and more complex circuits; however, knowing the classical time-domain approach shown in
          Figure 7-1
          will make understanding these subsequent techniques easier.
        

          Let us consider an
          RC
          circuit excited by a signal other than a step. If the input signal to the
          RC
          circuit in
          Figure 7-30
          starts at
          t
          = 0, then we can write the circuit differential equation in
          Eq. (7-3)
          as
        



(7-24)





          The
          u
          (
          t
          ) implies that the driving signal
          υ
T
          (
          t
          ) has a finite start time arbitrarily selected as
          t
          = 0. This implies that there is an initial condition,
          υ
          (0) =
          V
0
          , that will have to satisfy
          Eq. (7-24)
          .
        







FIGURE 7-30






As with the step response, we find the solution in two parts, namely, the natural response and the forced response. The natural response is of the form



The natural response of a first-order circuit always has this form because it is a general solution of the homogeneous equation with the input set to zero. The form of the natural response depends on the physical characteristics of the circuit and is independent of the input.

          The forced response
          υ
F
          (
          t
          ) depends on both the circuit and the nature of the forcing function (the input). The forced response is a particular solution of the equation
        




          This equation states that whatever function we pick as
          υ
F
          (
          t
          ) plus
          R
T
C
          times the first derivative of that same function must equal
          υ
T
          (
          t
          ). This requires that our choice of
          υ
F
          (
          t
          ) have the same form as that of the forcing function
          υ
T
          (
          t
          ).
          Table 7-1
          shows the form of the forced response that should be used based on the form of the forcing function.
        






Table

                  7-1
                







                  Form of the forcing function,
                  υ
T
                  (
                  t
                  )(
                  t
                  ≥ 0)
                

                  Form of the forced response,
                  υ
F
                  (
                  t
                  ) (
                  t
                  ≥ 0)
                





V
A


K
F




V
A
e

                    −α
                    t



K
F
e

                    −α
                    t





V
A
                  (cos ω
                  t
                  ),
                  V
A
                  (sin ω
                  t
                  ) or
                

a
                  cos ω
                  t
                  +
                  b
                  sin ω
                  t




V
A
                  (cos ω
                  t
                  ) +
                  V
B
                  (sin ω
                  t
                  )
                






Exponential Inputs











EXAMPLE 7-15


                    Find the response of the
                    RC
                    circuit in
                    Figure 7-30
                    to an exponential forcing function. The initial capacitor voltage is
                    υ
                    (0) =
                    V
0
                    .
                  





SOLUTION:


As before, the natural response is




                The forced response to an exponential input is found using
                Eq. (7-24)
                as
              




                where we select
                υ
F
                (
                t
                ) =
                K
F
e

                  -α
                  t

                from
                Table 7-1
                . Substituting for
                υ
F
                (
                t
                ),
              



Performing the differentiation gives



Canceling out the exponentials leaves




                Solving for
                K
F
                yields
              



Substituting back into our solution for the forced response and combining it with the natural response, we get




                This leaves only the constant
                K
                from the natural response to be determined. We find
                K
                by using the initial condition
                υ
                (0) =
                V
0
                .
              



Putting it all together, we find the total solution as




                The resulting waveform is the sum of two decaying exponentials. The exponential with the longest time constant will outlast the other and is called the
                dominant
                exponential.
                ■










Exercise 7-18


                The capacitor in the circuit of
                Figure 7-31
                is in the zero state. Find the voltage across and the current through the capacitor for
                t
                ≥ 0.
              
Answers:










FIGURE 7-31


















Exercise 7-19


                The circuit in
                Figure 7-30
                has
                R
T
                = 100 kΩ and
                C
                = 0.1 μF, and it is driven by
                υ
T
                = 10
                e

                  −50
                  t

                V. The capacitor has an initial voltage of -5V.
              

(a) Determine which is the dominant exponential.
(b) Use Multisim to find the transient response of the capacitor voltage. Plot the input voltage on the same graph.

                  (c) Determine the maximum voltage
                  V
MAX
                  across the capacitor and the time at which the maximum occurs.
                

Answers:

(a) The forcing function has the dominant exponential with a 20-ms time constant. The circuit's time constant is only 10 ms and it quickly decays away, leaving only that of the forcing function.

                  (b) See
                  Figure 7-32
                  for the Grapher View result of the response.
                

                  (c) Using the cursor function on the Grapher View shows that the maximum voltage
                  V
MAX
                  is 4.0 V and occurs at 18.3 ms.
                  






FIGURE 7-32












Sinusoidal Inputs

            In the following discussion, we solve for the capacitor voltage in the
            RC
            circuit of -
            Figure 7-30
            when the input source is a sinusoid. The solution follows the same process as for the exponential input just studied. It is important to realize that the input on the right side of
            Eq. (7-24)
            is a sinusoid that starts at
            t
            = 0 through some action such as closing a switch. This means that there will be an initial condition
            υ
            (0) =
            V
0
            .
          
As before, the natural response is



As with the exponential input, the forced response depends on both the circuit and the nature of the forcing function. The forced response is a particular solution of the following differential equation:





            This equation requires that
            υ
F
            (
            t
            ) plus
            R
T
C
            times its first derivative add to produce a cosine function for
            t
            ≥ 0. The only way this can happen is for
            υ
F
            (
            t
            ) and its derivative to be sinusoids of the same frequency. This requirement brings to mind the derivative property of the sinusoid. So we try a solution in the form of a general sinusoid. As noted in
            Chapter 5
            , a general sinusoid can be written in amplitude and phase angle form as
          


(7-25a)



or in terms of Fourier coefficients as



(7-25b)





            While either form will work, it is somewhat easier to work with the Fourier coefficient format. (See
            Table 7-1
            .)
          

            The approach we are using is called the method of undetermined coefficients, where the unknown coefficients are the Fourier coefficients
            a
            and
            b
            in
            Eq. (7-25b)
            . To find these unknowns, we insert the proposed forced response in
            Eq. (7-25b)
            into the differential equation to obtain
          



Performing the differentiation gives



We next gather all sine and cosine terms on one side of the equation.




            The left side of this equation is zero for all
            t
            ≥ 0 only when the coefficients of the cosine and sine terms are identically zero. This requirement yields two linear equations in the unknown coefficients
            a
            and
            b
            :
          



The solutions of these linear equations are




            These equations express the unknowns
            a
            and
            b
            in terms of known circuit parameters (
            R
T
C
            ) and known input signal parameters (ω and
            V
A
            ).
          
We combine the forced and natural responses as



(7-26)




The initial condition requires



which means




            We substitute this value of
            K
            into
            Eq. (7-26)
            to obtain the function
            υ
            (
            t
            ) that satisfies the differential equation and the initial conditions.
            




This expression seems somewhat less formidable when we convert the forced response to an amplitude and phase angle format



(7-27)




where




Equation (7-27)
            is the complete response of the
            RC
            circuit for an initial condition
            V
0
            and a sinusoidal input [
            V
A
            cos ω
            t
            ]
            u
            (
            t
            ). Several aspects of the response deserve comment:
          



1.
                After roughly five time constants, the natural response decays to zero but the sinusoidal forced response persists.
              



2.
                The forced response is a sinusoid with the same frequency (ω) as the input but with a different amplitude and phase angle.
              



3.
                The forced response is proportional to
                V

A

                . This means that the amplitude of the forced component has the proportionality property because the circuit is linear.
              



            In the terminology of electrical engineering, the forced component is called the
            sinusoidal steady-state response.
            The words
            steady state
            may be misleading since together they seem to imply a constant or "steady" value, whereas the forced response is a sustained oscillation. To electrical engineers,
            steady state
            means the conditions reached after the natural response has died out. The sinusoidal steady-state response is also called the
            ac steady-state response.
            Often, the words
            steady state
            are dropped, and it is called simply the
            ac response.
            Hereafter, ac response, sinusoidal steady-state response, and the forced response for a sinusoidal input will be used interchangeably.
          

            Finally, the forced response due to a step function input is called the
            zero-frequency
            or
            dc steady-state response.
            The zero-frequency terminology means that we think of a step function as a cosine
            V
A
            [cos ωt]
            u
            (
            t
            ) with ω = 0. The reader can easily show that inserting ω = 0 reduces
            Eq. (7-27)
            to the
            RC
            circuit step response in
            Eq. (7-20)
            .
          












EXAMPLE 7-16


                    The switch in
                    Figure 7-33
                    (a) has been open for a long time and is closed at
                    t
                    = 0. Find the voltage
                    υ
                    (
                    t
                    ) for
                    t
                    ≥ 0 when
                    υ
S
                    (
                    t
                    ) = [20 sin 1000
                    t
                    ]
                    u
                    (
                    t
                    ) V.
                  









FIGURE 7-33








SOLUTION:


We first derive the circuit differential equation. By voltage division, the Thévenin voltage seen by the capacitor is




                The Thévenin resistance (switch closed and source off) looking back into the interface is two 4-kΩ resistors in parallel, so
                R
T
                = 2 kΩ. The circuit time constant is
              





                Given the Thévenin equivalent seen by the capacitor and the circuit time constant, the circuit differential equation is
              




                Note that the right side of the circuit differential equation is the Thévenin voltage
                υ
T
                (
                t
                ), not the original source input
                υ
S
                (
                t
                ). The natural response is of the form
              



The forced response with undetermined Fourier coefficients is



Substituting the forced response into the differential equation produces



Collecting all sine and cosine terms on one side of this equation yields




                The left side of this equation is zero for all
                t
                ≥ 0 only when the coefficient of the sine and cosine terms vanish:
              




                The solutions of these two linear equations are
                a
                = - 4 and
                b
                = 2. We combine the forced and natural responses
              




                The constant
                K
                is found from the initial conditions
              




                The initial condition is
                V
0
                = 0 because with the switch open, the capacitor had no input for a long time prior to
                t
                = 0. The initial condition
                υ
                (0) = 0 requires
                K
                = 4, so we can now write the complete response in the form
              



or, in an amplitude, phase angle format as




Figure 7-33
                (b) shows an Excel worksheet that generates plots of the natural response, forced response, and total response. Column A is the time at 0.25-ms intervals. Columns B and C calculate the natural response (4
                e

                  -500
                  t

                ) and the forced response (-4 cos 1000
                t
                + 2 sin 1000
                t
                ) at each of the times given in column A. The total response in column D is the sum of the entries in columns B and C. The plots show that the total response merges into the sinusoidal forced response since the natural response decays to zero after about 5
                T
C
                = 10 ms. That is, after about 10 ms or so the circuit settles down to an ac steady-state condition.
                ■











Exercise 7-20


                Find the sinusoidal steady-state response of the output voltage
                υ
O
                (
                t
                ) in
                Figure 7-34
                when the input current is
                i
S
                (
                t
                ) = [
                I
A
                cos ω
                t
                ]
                u
                (
                t
                ) A.
              


Answer:






                where θ = tan
                -1
                (
                R
                /ω
                L
                ). The output voltage is a sinusoid with the same frequency as the input signal, but with a different amplitude and phase angle. In fact, in the sinusoidal steady state every voltage and current in a linear circuit is sinusoidal with the same frequency. We will make use of this fact in
                Chapter 8
                .
              









FIGURE 7-34













Exercise 7-21


Find the forced component solution of the differential equation



for the following frequencies:

(a) ω = 500 rad/s
(b) ω = 1000 rad/s
(c) ω = 2000 rad/s



                Answers:
              


                  (a)
                  υ
F
                  (
                  t
                  ) = 8 cos 500
                  t
                  + 4 sin 500
                  t
                  V
                  t
                  ≥ 0
                

                  (b)
                  υ
F
                  (
                  t
                  ) = 5 cos 1000
                  t
                  + 5 sin 1000
                  t
                  V
                  t
                  ≥ 0
                

                  (c)
                  υ
F
                  (
                  t
                  ) = 2 cos 2000
                  t
                  + 4 sin 2000
                  t
                  V
                  t
                  ≥ 0
                



Discussion:

Converting these answers to an amplitude and phase angle as



                  (a)
                  υ
F
                  (
                  t
                  ) = 8.94 cos(500
                  t
                  - 26.6°) V
                  t
                  ≥ 0
                

                  (b)
                  υ
F
                  (
                  t
                  ) = 7.07 cos(1000
                  t
                  - 45°) V
                  t
                  ≥ 0
                

                  (c)
                  υ
F
                  (
                  t
                  ) = 4.47 cos(2000
                  t
                  - 63.4°) V
                  t
                  ≥ 0
                


we see that increasing the frequency of the input sinusoid decreases the amplitude and phase angle of the sinusoidal steady-state output of the circuit. We will see in later chapters that this is an equation for a low-pass filter.














Evaluation Exercise 7-22



                The
                RC
                circuit in
                Figure 7-30
                is driven by an input
                υ
S
                (
                t
                ) = 10 sin(2π100
                t
                )
                u
                (
                t
                ) and has an
                R
T
                of 47 kΩ and a
                C
                of 0.1 μF. The capacitor has an initial voltage of -20 V.
              


                  (a) Use Multisim to plot the transient output voltage
                  υ
                  (
                  t
                  ) across the capacitor. In your plot, include the input voltage and estimate when the circuit reaches steady state.
                
(b) Repeat if the capacitor was 0.01 μF with the same initial condition.
(c) study your results. In general, what would you do to permit the circuit to reach steady state by one cycle of the output waveform?

                  (d) Suppose that the driving function was
                  υ
s
                  (
                  t
                  ) = 10 sin(2π1000
                  t
                  )
                  u
                  (
                  t
                  ). How would that change affect how quickly the circuit reaches steady state as defined in (c)?
                

Answers:


                  (a) See
                  Figure 7-35
                  . For
                  C
                  = 0.1 μF, the circuit reaches steady state after about five time constants or 235 ms.
                

                  (b) See
                  Figure 7-35
                  . For
                  C
                  = 0.01 μF, the circuit reaches steady state in about 235 ms.
                  






FIGURE 7-35









                  (c) Decrease the time constant so that 5
                  T
C
                  is approximately equal to one period of the sinusoid.
                
(d) Since the period will be smaller by a factor of 10, the time constant would need to be faster by a similar amount. We could replace the capacitor with one of 0.001 μF.







          7-5 The Series
          RLC
          Circuit
        

          Second-order circuits contain two energy storage elements that cannot be replaced by a single equivalent element. They are called
          second-order circuits
          because the circuit differential equation involves the second derivative of the dependent variable. Although there is an endless number of such circuits, in this chapter we will concentrate on two classical forms: (1) the series
          RLC
          circuit and (2) the parallel
          RLC
          circuit. These two circuits illustrate almost all of the basic concepts of second-order circuits and serve as vehicles for studying the solution of second-order differential equations. In subsequent chapters, we use Laplace transform techniques to analyze any second- or higher-order circuit.
        


            Formulating Series
            RLC
            Circuit Equations
          

            We begin with the circuit in
            Figure 7-36
            (a), where the inductor and capacitor are connected in series. The source-resistor circuit can be reduced to the Thévenin equivalent shownin
            Figure 7-36
            (b). The resultis a circuitinwhicha voltage source, resistor, inductor, and capacitor are connected in series (hence the name
            
              series
              RLC
              circuit
            
            ).
          







FIGURE 7-36



The series RLC circuit.




            The first task is to develop the equations that describe the series
            RLC
            circuit. The Thévenin equivalent to the left of the interface in
            Figure 7-36
            (b) produces the KVL constraint
          



(7-28)




Applying KVL around the loop on the right side of the interface yields



(7-29)





            Finally, the
            i-υ
            characteristics of the inductor and capacitor are
          



(7-30)







(7-31)





Equations (7-28)
            through
            (7-31)
            are four independent equations in four unknowns (
            i
            (
            t
            ),
            υ
            (
            t
            ),
            υ
L
            (
            t
            ),
            υ
C
            (
            t
            )). Collectively, this set of equations provides a complete description of the dynamics of the series
            RLC
            circuit. To find the circuit response using classical methods, we must derive a circuit equation containing only one of these unknowns.
          

            We use circuit state variables as solution variables because they are continuous functions of time. In the series
            RLC
            circuit in
            Figure 7-36
            (b), there are two state variables: (1) the capacitor voltage
            υ
C
            (
            t
            ) and (2) the inductor current
            i
            (
            t
            ). We first show how to describe the circuit using the capacitor voltage as the solution variable:
          

            To derive a single equation in
            υ
C
            (
            t
            ), we substitute
            Eqs. (7-29)
            and
            (7-31)
            into
            Eq. (7-28)
            .
          



(7-32)






            These substitutions eliminate the unknowns except
            υ
C
            and
            υ
L
            . To eliminate the inductor voltage, we substitute
            Eq. (7-31)
            into
            Eq. (7-30)
            to obtain
          




            Substituting this result into
            Eq. (7-32)
            produces
          



(7-33)





            In effect, this is a KVL equation around the loop in
            Figure 7-36
            (b), where the inductor and resistor voltages have been expressed in terms of the capacitor voltage.
          

Equation (7-33)
            is a second-order linear differential equation with constant coefficients. It is a second-order equation because the highest-order derivative is the second derivative of the dependent variable
            υ
C
            (
            t
            ). The coefficients are constant because the circuit parameters
            L, C,
            and
            R
T
            do not change. The Thévenin voltage
            υ
T
            (
            t
            ) is a known driving force.
          

            We need to find the two initial conditions:
            υ
C
            (0) and
            dυ
C
            (0)/
            dt
            . We know that the capacitor's
            i-υ
            relationship at
            t
            = 0 is
            i
            (0) =
            C
dv
C
            (0)/
            dt
            . Therefore, we can solve for the derivative
          



(7-34)





            are determined by the values of the capacitor voltage and inductor current at
            t
            = 0,
            V
0
            and
            I
0
            .
          

            In summary, the second-order differential equation in
            Eq. (7-33)
            characterizes the response of the series
            RLC
            circuit in terms of the capacitor voltage
            v
C
            (
            t
            ). Once the solution
            υ
C
            (
            t
            ) is found, we can solve for every other voltage or current, including the inductor current, using the element and connection constraints in
            Eqs. (7-28)
            to
            (7-31)
            .
          

            Alternatively, we can characterize the series
            RLC
            circuit using the inductor current. We first write the capacitor
            i-υ
            characteristics in integral form:
          


(7-35)




Equations (7-35)
            ,
            (7-30)
            , and
            (7-29)
            are inserted into the interface constraint of
            Eq. (7-28)
            to obtain a single equation in the inductor current
            i
            (
            t
            ):
          



(7-36)





            In effect, this is a KVL equation around the loop in
            Figure 7-36
            (b), where the capacitor and resistor voltages have been expressed in terms of the inductor current.
          

Equation (7-36)
            is a second-order linear integrodifferential equation with constant coefficients. It is second order because it involves the first derivative and the first integral of the dependent variable
            i
            (
            t
            ). The coefficients are constant because the circuit parameters
            L, C,
            and
            R
            t do not change. The Thévenin equivalent voltage
            υ
T
            (
            t
            ) is a known driving force, and the initial conditions are
            υ
C
            (0) =
            V
0
            and
            i
            (0) =
            I
0
            .
          


Equations (7-33)
            and
            (7-36)
            involve the same basic ingredients: (1) an unknown state variable, (2) three circuit parameters (
            R
T
            ,
            L
            , and
            C
            ), (3) a known input
            υ
T
            (
            t
            ), and (4) two initial conditions (
            V
0
            and
            I
0
            ). The only difference is that one expresses the sum of voltages around the loop in terms of the capacitor voltage, while the other uses the inductor current. Either equation characterizes the dynamics of the series
            RLC
            circuit because once a state variable is found, every other voltage or current can be found using the element and connection constraints.
          



            Zero-Input Response of The Series
            RLC
            Circuit
          

            The circuit dynamic response for
            t
            ≥ 0 can be divided into two components: (1) the zero-input response caused by the initial conditions and (2) the zero-state response caused by driving forces applied after
            t
            = 0. Because the circuit is linear, we can solve for these responses separately and use superposition to get the total response. We first deal with the zero-input response.
          

            With
            υ
T
            (
            t
            ) = 0 (zero-input),
            Eq. (7-33)
            becomes
          



(7-37)





            This result is a second-order homogeneous differential equation in the capacitor voltage. Alternatively, we set
            υ
T
            = 0 in
            Eq. (7-36)
            and differentiate once to obtain the following homogeneous differential equation in the inductor current:
          



(7-38)





            We observe that
            Eqs. (7-37)
            and
            (7-38)
            have exactly the same form except that the dependent variables are different. The zero-input response of the capacitor voltage and inductor current have the same general form. We do not need to study both to understand the dynamics of the series
            RLC
            circuit. In other words, in the series
            RLC
            circuit we can use either state variable to describe the zero-input response.
          

            In the following discussion, we will concentrate on the capacitor voltage response.
            Equation (7-37)
            requires the capacitor voltage, plus
            RC
            times its first derivative, plus
            LC
            times its second derivative to add to zero for all
            t
            ≥ 0. The only way this can happen is for
            υ
C
            (
            t
            ), its first derivative, and its second derivative to have the same waveform. No matter how many times we differentiate an exponential of the form
            e

st

            , we are left with a signal with the same waveform. This observation, plus our experience with first-order circuits, suggests that we try a solution of the form
          




            where the parameters
            K
            and
            s
            are to be evaluated. When the trial solution is inserted in
            Eq. (7-37)
            , we obtain the condition
          




            The function
            e

st

            cannot be zero for all
            t
            ≥ 0. The condition
            K
            = 0 is not allowed because it is a trivial solution declaring that
            υ
C
            (
            t
            ) is zero for all
            t
            . The only useful way to meet the condition is to require
          



(7-39)





Equation (7-39)
            is the
            characteristic equation
            of the series
            RLC
            circuit. The characteristic equation is a quadratic because the circuit contains two energy storage elements. Inserting
            Ke

st

            into the homogeneous equation of the inductor current in
            
Eq. (7-38)
            produces the same characteristic equation. Thus,
            Eq. (7-39)
            relates the zero-input response to circuit parameters for both state variables (hence the name
            characteristic equation).

In general, a quadratic characteristic equation has two roots:



(7-40)





            From the form of the expression under the radical in
            Eq. (7-40)
            , we see that there are three distinct possibilities:
          



                Case A: If (
                R
T
C
                )
                2
                - 4
                LC
                > 0, there are two real, unequal roots (
                s
1
                = −α
                1
                ≠
                s
2
                = −α
                2
                ).
              



                Case B: If (
                R
T
C
                )
                2
                - 4
                LC
                = 0, there are two real, equal roots (
                s
1
                =
                s
2
                = -α).
              



                Case C: If (
                R
T
C
                )
                2
                - 4
                LC
                < 0, there are two complex conjugate roots (
                s
1
                = -α −
                j
                β and
                s
2
                = -α +
                j
                β).
              



            The symbol
            j
            represents the imaginary number
            

1

            Before dealing with the form of the zero-input response for each case, we consider an example.
          












EXAMPLE 7-17



                    A series
                    RLC
                    circuit has a
                    C
                    = 0.25 μF and
                    L
                    = 1 H. Find the roots of the characteristic equation for
                    R
T
                    = 8.5 kΩ, 4 kΩ, and 1 kΩ.
                  




SOLUTION:



                For
                R
T
                = 8.5kΩ, the characteristic equation is
              



whose roots are




                These roots illustrate Case A. The quantity under the radical is positive, and there are two real, unequal roots at
                s
1
                = -500 and
                s
2
                = -8000.
              

                For
                R
T
                = 4 kΩ, the characteristic equation is
              



whose roots are




                This is an example of Case B. The quantity under the radical is zero, and there are two real, equal roots at
                s
1
                =
                s
2
                = -2000.
              

                For
                R
T
                = 1 kΩ, the characteristic equation is
              



whose roots are





                The quantity under the radical is negative, illustrating Case C.
              




                In Case C, the two roots are complex conjugates.
                ■












Design Exercise 7-23



                For a series
                RLC
                circuit:
              


                  (a) Find the roots of the characteristic equation when
                  R
T
                  = 2 kΩ,
                  L
                  = 100mH, and
                  C
                  = 0.4 μF.
                

                  (b) For
                  L
                  = 100 mH, select the values of
                  R
T
                  and
                  C
                  so the roots of the characteristic equation are
                  s
1
                  ,
                  s
2
                  = −1000 ±
                  j
                  2000.
                

                  (c) Select the values of
                  R
T
                  ,
                  L
                  , and
                  C
                  so
                  s
1
                  =
                  s
2
                  = −10
                  4
                  .
                

Answers:


                  (a)
                  s
1
                  = −1340,
                  s
2
                  = −18,660
                

                  (b)
                  R
T
                  = 200 Ω,
                  C
                  = 2μF
                

                  (c) There is no unique answer to part (c) since the requirement
                  



                    gives two equations,
                    R
T
C
                    = 10
                    -4
                    and
                    LC
                    = 10
                    -8
                    , in three unknowns. One solution is to select
                    C
                    = 1μF, which yields
                    L
                    = 10 mH and
                    R
T
                    = 200Ω.
                  





            We have not introduced complex numbers simply to make things more complex. Complex numbers arise quite naturally in practical physical situations involving nothing more than factoring a quadratic equation. The ability to deal with complex numbers is essential to our study. For those who need a review of such matters, there is a concise discussion in
            Appendix F
            .
          


Form of the Zero-Input Response
Since the characteristic equation has two roots, there are two solutions to the homogeneous differential equation:



That is,



and



The sum of these two solutions is also a solution since





            Therefore, the general solution for the zero-input response is of the form
          



(7-41)





            The constants
            K
1
            and
            K
2
            can be found using the initial conditions given in
            Eq. (7-34)
            . At
            t
            = 0, the condition on the capacitor voltage yields
          



(7-42)





            To use the initial condition on the inductor current, we differentiate
            Eq. (7-41)
            .
          




            Using
            Eq. (7-34)
            to relate the initial value of the derivative of the capacitor voltage to the initial inductor current
            i
            (0) yields
          



(7-43)





Equations (7-42)
            and
            (7-43)
            provide two equations in the two unknown constants
            K
1
            and
            K
2
            :
          



The solutions of these equations are




            Inserting these solutions back into
            Eq. (7-41)
            yields
          



(7-44)





Equation (7-44)
            is the general zero-input response of the series
            RLC
            circuit. The response depends on two initial conditions
            V
0
            and
            I
0
            , and the circuit parameters
            R
T
            ,
            L
            , and
            C
            since
            s
1
            and
            s
2
            are the roots of the characteristic equation
            LCs
2
            +
            R
T
Cs
            + 1 = 0. The response takes on different forms depending on whether the roots
            s
1
            and
            s
2
            fall under Case A, B, or C.
          

            For Case A, the two roots are real and distinct. Using the notation
            s
1
            = -α
            1
            and
            s
2
            = -α
            2
            , the form of the zero-input response for
            t
            ≥ 0 is
          


(7-45)




            For Case A, the response is the sum of two exponential functions similar to the double exponential signal treated in
            Example 7-14
            . The function has two time constants 1/α
            1
            and 1/α
            2
            . The time constants can be greatly different, or nearly equal, but they cannot be equal because we would have Case B.
          

            With Case B the roots are real and equal. Using the notation
            s
1
            =
            s
2
            = -α, the general form in
            Eq. (7-44)
            becomes
          




            We immediately see a problem here because the denominator vanishes. However, a closer examination reveals that the numerator vanishes as well, so the solution
            
            reduces to the indeterminate form 0/0. To investigate the indeterminacy, we let
            s
1
            = -α and
            s
2
            = -α +
            x
            , and we explore the situation as
            x
            approaches zero. Inserting
            s
1
            and
            s
2
            in this notation in
            Eq. (7-44)
            produces
          



which can be arranged in the form




            We see that the indeterminacy comes from the term (1 -
            e

xt

            )/
            x
            , which reduces to 0/0 as
            x
            approaches zero. Application of l'Hôpital's rule reveals
          




            This result removes the indeterminacy, and as
            x
            approaches zero the zero-input response reduces to
          


(7-46)




            For Case B, the response includes an exponential and the damped ramp studied in
            Example 7-11
            . The damped ramp is required, rather than two exponentials, because in Case B the two equal roots produce the same exponential function.
          
Case C produces complex conjugate roots of the form




            Inserting these roots into
            Eq. (7-44)
            yields
          



which can be arranged in the form



(7-47)




The expressions within the brackets have been arranged in a special way for the following reasons. Euler's relationships for an imaginary exponential are written as



and



When we add and subtract these equations, we obtain




            Comparing these expressions for sin θ and cos θ with the complex terms in
            Eq. (7-47)
            reveals that we can write
            υ
C
            (
            t
            ) in the form
          





            For Case C, the response contains the damped sinusoid studied in
            Example 5-12
            . The real part of the roots (α) provides the exponent coefficient in the exponential function, while the imaginary part (β) defines the frequency of the sinusoidal oscillation.
          

            In summary, the roots of the characteristic equation affect the form of the zero-input response in the following ways. In Case A, the two roots are real and unequal (
            s
1
            = -α
            1
            ≠
            s
2
            = -α
            2
            ) and the zero-input response is the sum of two exponentials of the form
          



(7-48a)





            In Case B, the two roots are real and equal (
            s
1
            =
            s
2
            = -α) and the zero-input response is the sum of an exponential and a damped ramp.
          



(7-48b)





            In Case C, the two roots are complex conjugates (
            s
1
            = -α −
            j
            β,
            s
2
            = -α +
            j
            β) and the zero-input response is the sum of a damped cosine and a damped sine.
          



(7-48c)





            In determining the zero-input response, we use the parameters
            s
            , α, and β. At various points in the development, these parameters appear in expressions such as
            e

st

            ,
            e

              -α
              t

            , and
            e

j
              β
              t

            . Since the exponent of
            e
            must be dimensionless, the parameters
            s
            , α, and β all have the dimensions of the reciprocal of time, or equivalently, frequency. Collectively, we say that
            s
            , α, and β define the
            natural frequencies
            of the circuit. When it is necessary to distinguish between these three parameters we say that
            s
            is the
            complex frequency,
            α is the
            neper frequency,
            and β is the
            radian frequency
            also called the
            damped natural frequency.
            The importance of this notation will become clear as we proceed through subsequent chapters of this book. To be consistent with expressions such as
            s
            = -α +
            j
            β, we specify numerical values of
            s
            , α, and β in units of radians per second (rad/s).
            
2



            The constants
            K
1
            and
            K
2
            in
            Eqs. (7-48a)
            ,
            (7-48b)
            , and
            (7-48c)
            are determined by the initial conditions on two state variables, as illustrated in the following example.
          












EXAMPLE 7-18



                    The circuit of
                    Figure 7-37
                    (a) has
                    C
                    = 0.25 μF and
                    L
                    = 1 H. The switch has been open for a long time and is closed at
                    t
                    = 0. Find the capacitor voltage for
                    t
                    ≥ 0 for (a)
                    R
                    = 8.5 kΩ, (b)
                    R
                    = 4 kΩ, and (c)
                    R
                    = 1 kΩ. The initial conditions are
                    I
0
                    = 0 and
                    V
0
                    = 15 V.
                  









FIGURE 7-37








SOLUTION:



                The roots of the characteristic equation for these three values of resistance are found in
                Example 7-17
                . We are now in a position to use those results to find the corresponding zero-input responses.
              


                  (a) In
                  Example 7-17
                  , the value
                  R
                  = 8.5 kΩ yields Case A with roots
                  s
1
                  = −500 and
                  s
2
                  = -8000. The corresponding zero-input solution takes the form in
                  Eq. (7-48a)
                  .
                  




                    The initial conditions yield two equations in the constants
                    K
1
                    and
                    K
2
                    :
                  




                    Solving these equations yields
                    K
1
                    = 16 and
                    K
2
                    = −1, so that the zero-input response is
                  





                  (b) In
                  Example 7-17
                  , the value
                  R
                  = 4 kΩ yields Case B with roots
                  s
1
                  =
                  s
2
                  = −2000. The zero-input response takes the form in
                  Eq. (7-48b)
                  :
                  



                    The initial conditions yield two equations in the constants
                    K
1
                    and
                    K
2
                    :
                  




                    Solving these equations yields
                    K
1
                    = 15 and
                    K
2
                    = 2000 × 15, so the zero-input response is
                  





                  (c) In
                  Example 7-17
                  , the value
                  R
                  = 1 kΩ yields Case C with roots
                  
                  . The zero-input response takes the form in
                  Eq. (7-48c)
                  :
                  



                    The initial conditions yield two equations in the constants
                    K
1
                    and
                    K
2
                    :
                  




                    which yield
                    K
1
                    = 15 and
                    
                    , so the zero-input response is
                  






Figure 7-37
                (b) shows plots of these responses. All three responses start out at 15 V (the initial condition) and all eventually decay to zero. The temporal decay of the responses is caused by energy loss in the circuit and is called
                damping.
                The Case A response does not change sign and is called the
                overdamped
                response. The Case C response undershoots and then oscillates about the final value. This response is said to be
                underdamped
                because there is not enough damping to prevent these oscillations. The Case B response is said to be
                critically damped
                since it is a special case at the boundary between overdamping and underdamping.
              







FIGURE 7-37







■

 













Design Exercise 7-24



                In this exercise we will examine
                Figure 7-37
                (b) by running an actual circuit. The circuit in
                Figure 7-37
                (a) has
                C
                = 0.02 μF and
                L
                = 100 mH. Use Multisim to estimate the value of
                R
                that will result in the critically damped case. Use the Parameter sweep analysis. Give
                R
                in your circuit an arbitrary 1-kΩ value. The device type is "Resistor." The parameter you will sweep is "resistance." Use a Linear sweep and set your parameters to Start at 1 kΩ and Stop at 10 kΩ. Use 10 points. Select "Transient Analysis" to sweep. Importantly, open the "Edit analysis" and select "User defined" for the initial conditions. This will activate the 15-V initial condition. Set the start time at 0 s and the stop time at 500 us. Use 1e-07 for TMAX. Plot the voltage across the capacitor. Click Run. Using your intuition select the curve that appears to be closest to the critical value of
                R.
                Now compute the critical value and compare your guess.
              


Answer:



                The 4000-Ω curve appears close, but it does slightly dip below 0 V, so the actual value must be greater. 5000-Ω curve appears too much. Hence, it is somewhere in between. The actual calculation yields
                R
                = 4472 kΩ. See
                Figure 7-37
                (c).
                Figure 7-37
                (d) shows the comparisons between
                R
                = 4 kΩ, 5 kΩ, and the critically damped value of 4472 Ω. It is difficult to tell when a curve changes from overdamped to underdamped.
              







FIGURE 7-37























EXAMPLE 7-19



                    In a series
                    RLC
                    circuit, the zero-input voltage across the 1-μF capacitor is
                  




(a) Find the circuit characteristic equation.

                      (b) Find
                      R
                      and
                      L
                      .
                    

                      (c) Find
                      i
L
                      (
                      t
                      ) for
                      t
                      ≥ 0.
                    
(d) Find the initial values of the state variables.





SOLUTION:




                  (a) The circuit is underdamped because the zero-input response is a damped sine with α = 1000 and β = 2000 rad/s. The characteristic equation is
                  




                  (b) The characteristic equation of a series
                  RLC
                  circuit [
                  Eq. (7-39)
                  ] can be written as
                  


Comparing this term by term to the result in (a) yields the constraints




                    Since
                    C
                    = 1 μF, we find that
                    L
                    = 0.2 H and
                    R
                    = 400 Ω.
                  


                  (c) In a series circuit, KCL requires
                  i
L
                  (
                  t
                  ) =
                  i
C
                  (
                  t
                  ). Hence, the inductor current is
                  




                  (d) By inspection, the initial values of the state variables are
                  υ
C
                  (0) = 0 and
                  i
L
                  (0) = 20 mA.
                  ■












Exercise 7-25



                In a series
                RLC
                circuit,
                R
                = 250 Ω,
                L
                = 10 mH,
                C
                = 1 μF,
                V
0
                = 0, and
                I
0
                = 30 mA. Find the capacitor voltage and inductor current for
                t
                ≥ 0.
              
Answers:














Exercise 7-26



                In a series
                RLC
                circuit, the zero-input responses are
              




(a) Find the circuit characteristic equation.
(b) Find the initial values of the state variables.

                  (c) Find
                  R, L,
                  and
                  C.




                Answers:
              


                  (a)
                  s
2
                  + 1000
                  s
                  + 25 × 10
                  4
                  = 0
                

                  (b)
                  V
0
                  =
                  I
0
                  = 3.2 mA
                

                  (c)
                  R
                  = 2.5 kΩ,
                  L
                  = 2.5 H,
                  C
                  = 1.6 μF
                







          7-6 The Parallel
          RLC
          Circuit
        

          The inductor and capacitor in
          Figure 7-38
          (a) are connected in parallel. The source-resistor circuit can be reduced to the Norton equivalent shown in
          Figure 7-38
          (b). The result is a
          
            parallel
            RLC
            circuit
          
          consisting of a current source, resistor, inductor, and capacitor. Our first task is to develop a differential equation for this circuit. We expect to find a second-order differential equation because there are two energy storage elements.
        







FIGURE 7-38



The parallel RLC circuit.



The Norton equivalent to the left of the interface introduces the constraint



(7-49)




Writing a KCL equation at the interface yields



(7-50)





          The
          i-υ
          characteristics of the inductor and capacitor are
        



(7-51)







(7-52)





Equations (7-49)
          through
          (7-52)
          provide four independent equations in four unknowns (
          i
          (
          t
          ),
          υ
          (
          t
          ),
          i
L
          (
          t
          ),
          i
C
          (
          t
          )). Collectively, these equations describe the dynamics of the parallel
          RLC
          circuit. To solve for the circuit response using classical methods, we must derive a circuit equation containing only one of these four variables.
        

          We prefer using state variables because they are continuous. To obtain a single equation in the inductor current, we substitute
          Eqs. (7-50)
          and
          (7-52)
          into
          Eq. (7-49)
          :
        



(7-53)





          The capacitor current can be eliminated from this result by substituting
          Eq. (7-52)
          into
          Eq. (7-51)
          to obtain
        


(7-54)




          Inserting this equation into
          Eq. (7-53)
          produces
        



(7-55)






          This result is a KCL equation in which the resistor and capacitor currents are expressed in terms of the inductor current.
        

Equation (7-55)
          is a second-order linear differential equation of the same form as the series
          RLC
          circuit equation in
          Eq. (7-33)
          . In fact, if we interchange the following quantities:
        



we change one equation into the other. The two circuits are duals, which means that the results developed for the series case apply to the parallel circuit with the preceding duality interchanges.

          However, it is still helpful to outline the major features of the analysis of the parallel
          RLC
          circuit. The initial conditions in the parallel circuit are the initial inductor current
          I
0
          and capacitor voltage
          V
0
          . The initial inductor current provides the condition
          i
L
          (0)=
          I
0
          for the differential equation in
          Eq. (7-55)
          . By using
          Eq. (7-52)
          , the initial capacitor voltage specifies the initial rate of change of the inductor current as
        




          These initial conditions are the dual of those obtained for the series
          RLC
          circuit in
          Eq. (7-34)
          .
        

          To solve for the zero-input response, we set
          i
N
          = 0 in
          Eq. (7-55)
          and obtain a homogeneous equation in the inductor current:
        




          A trial solution of the form
          i
L
          =
          Ke

st

          leads to the characteristic equation
        



(7-56)





          The characteristic equation is quadratic because there are two energy storage elements in the parallel
          RLC
          circuit. The characteristic equation has two roots:
        



and, as in the series case, there are three distinct cases:



              Case A: If
              
              , there are two unequal real roots
              s
1
              = −α
              1
              and
              s
2
              = −α
              2
              and the zero-input response is the overdamped form
            



(7-57)







              Case B: If
              
              , there are two real equal roots
              s
1
              =
              s
2
              = -α and the zero-input response is the critically damped form
            



(7-58)








              Case C: If
              
              , there are two complex conjugate roots
              s
1
              ,
              s
2
              = -α ±
              j
              β and the zero-input response is the underdamped form
            





(7-59)





          The analysis results for the series
          RLC
          circuit apply to the parallel
          RLC
          case with the appropriate duality replacements. In particular, the form of overdamped, critically damped, and underdamped response applies to both circuits. The forms of the responses in
          Eqs. (7-57)
          ,
          (7-58)
          , and
          (7-59)
          have been written with two arbitrary constants
          K
1
          and
          K
2
          . The following example shows how to evaluate these constants using the initial conditions for the two state variables.
        












EXAMPLE 7-20



                  In a parallel
                  RLC
                  circuit,
                  R
T
                  = 500 Ω,
                  C
                  = 1 μF,
                  L
                  = 0.2 H. The initial conditions are
                  I
0
                  = 50 mA and
                  V
0
                  = 0. Find the zero-input response of inductor current, resistor current, and capacitor voltage.
                




SOLUTION:



              From
              Eq. (7-56)
              the circuit characteristic equation is
            



The roots of the characteristic equation are




              Since the roots are complex conjugates, we have the underdamped case. The zero-input response of the inductor current takes the form of
              Eq. (7-59)
              .
            




              The constants
              K
1
              and
              K
2
              are evaluated from the initial conditions. At
              t
              = 0 the inductor current reduces to
            




              We conclude that
              K
1
              =
              I
0
              = 50 mA. To find
              K
2
              we use the initial capacitor voltage. In a parallel
              RLC
              circuit, the capacitor and inductor voltages are equal, so we can write
            




              In this example, the initial capacitor voltage is zero; so, the initial rate of change of inductor current is zero at
              t
              = 0. Differentiating the zero-input response produces
            




              Evaluating this expression at
              t
              = 0 yields
            





              The derivative initial condition gives condition
              K
2
              =
              K
1
              /2 = 25 mA. Given the values of
              K
1
              and
              K
2
              , the zero-input response of the inductor current is
            




              The zero-input response of the inductor current allows us to solve for every voltage and current in the parallel
              RLC
              circuit. For example, using the
              i-υ
              characteristic of the inductor, we obtain the inductor voltage:
            



Since the elements are connected in parallel, we obtain the capacitor voltage and resistor current as


■












Exercise 7-27



              A parallel
              RLC
              circuit has
              R
              = 1 kΩ,
              C
              = 1 μF, and
              L
              = 100 mH. The initial conditions are
              I
0
              = 100 mA and
              V
0
              = 0 V.
            


                (a) Use Multisim to plot the zero-input response of the inductor, resistor, and capacitor currents on one
                y
                -axis.
              
(b) From your current plots, show that Kirchhoff's current law (KCL) holds for every instant.

Answers:


                (a)
                Figure 7-39
                shows the plots requested.
              

                (b) At any point in time, the three currents always sum to zero, thereby validating Kirchhoff's current law. See the plot of the sum of all three currents in
                Figure 7-39
                .
              








FIGURE 7-39






















EXAMPLE 7-21


                  The switch in
                  Figure 7-40
                  has been open for a long time and is closed at
                  t
                  = 0.
                


                    (a) Find the initial conditions at
                    t
                    = 0.
                  

                    (b) Find the inductor current for
                    t
                    ≥ 0.
                  

                    (c) Find the capacitor voltage and current through the switch for
                    t
                    ≥ 0.
                  










FIGURE 7-40








SOLUTION:




                (a) For
                t
                < 0 the circuit is in the dc steady state, so the inductor acts like a short circuit and the capacitor like an open circuit. Since the inductor shorts out the capacitor, the initial conditions just prior to closing the switch at
                t
                = 0 are
                




                (b) For
                t
                ≥ 0 the circuit is a zero-input parallel
                RLC
                circuit with initial conditions found in (a). The circuit characteristic equation is
                


The roots of this equation are



The circuit is overdamped (Case A), since the roots are real and unequal. The general form of the inductor current zero-input response is




                  The constants
                  K
1
                  and
                  K
2
                  are found using the initial conditions. At
                  t
                  = 0, the zero-input response is
                



The initial capacitor voltage establishes an initial condition on the derivative of the inductor current since




                  The derivative of the inductor response at
                  t
                  = 0 is
                




                  The initial conditions on inductor current and capacitor voltage produce two equations in the unknown constants
                  K
1
                  and
                  K
2
                  :
                




                  Solving these equations yields
                  K
1
                  = 30.3 mA and
                  K
2
                  = -0.309 mA. The zero-input response of the inductor current is
                






                (c) Given the inductor current in (b), the capacitor voltage is
                



                  For
                  t
                  ≥ 0, the current
                  i
SW
                  (
                  t
                  ) is the current through the 50-Ω resistor plus the current through the 250-Ω resistor.
                


■













Exercise 7-28



              The zero-input responses of a parallel
              RLC
              circuit are observed to be
            




(a) What is the circuit characteristic equation?
(b) What are the initial values of the state variables?

                (c) What are the values of
                R, L,
                and
                C?

(d) Write an expression for the current through the resistor.

                (e) Use MATLAB to plot your
                i
R
                (
                t
                ).
              

Answers:


                (a)
                s
2
                + 4000
                s
                + 4 × 10
                6
                = 0
              

                (b)
                i
L
                (0) = 0,
                υ
C
                (0) = 10V
              

                (c)
                L
                = 1 H,
                C
                = 0.25 μF,
                R
                = 1 kΩ
              

                (d)
                i
R
                (
                t
                ) = 10
                e

                  -2000
                  t

                - 20,000
                te

                  -2000
                  t

                mA
                t
                ≥ 0
              

                (e) The MATLAB plot of
                i
R
                (
                t
                ) is shown in
                Figure 7-41
                .
              








FIGURE 7-41










7-7 Second-Order Circuit Step Response

          The step response provides important insights into the response of dynamic circuits in general. So it is natural that we investigate the step response of second-order circuits. In
          Chapter 11
          , we will develop general techniques for determining the step response
          
          of any linear circuit. However, in this introduction we use classical methods, as in
          Figure 7-1
          , of solving differential equations to find the step response of second-order circuits.
        
The general second-order linear differential equation with a step function input has the form



(7-60)





          where
          y
          (
          t
          ) is a voltage or current response,
          Au
          (
          t
          ) is the step function input, and
          a
2
          ,
          a
1
          , and
          a
0
          are constant coefficients. The step response is the general solution of this differential equation for
          t
          ≥ 0. The step response can be found by partitioning
          y
          (
          t
          ) into forced and natural components:
        


(7-61)




          The natural response
          y
N
          (
          t
          ) is the general solution of the homogeneous equation (input set to zero), while the forced response
          y
F
          (
          t
          ) is a particular solution of the equation (input set to the forcing fuction, a step function in this case.)
        




          Since
          A
          is a constant, it follows that
          dA
          /
          dt
          and
          d
2
A
          /
          dt
2
          are both zero, so it is readily apparent that
          y
F
          (
          t
          ) =
          A
          /
          a
0
          is a particular solution of this differential equation. So much for the forced response.
        

          Turning now to the natural response, we seek a general solution of the homogeneous equation. The natural response has the same form as the zero-state response studied in the previous section. In a second-order circuit, the zero-state and natural responses take one of the three possible forms: overdamped, critically damped, or underdamped. To describe the three possible forms, we introduce two new parameters: ω
          0
          (omega zero) and ζ (zeta). These parameters are defined in terms of the coefficients of the general second-order equation in
          Eq. (7-60)
          :
        


(7-62)




          The parameter ω
          0
          is called the
          undamped natural frequency
          and ζ is called the
          damping ratio.
          Using these two parameters, the general homogeneous equation is written in the form
        



(7-63)





          The left side of
          Eq. (7-63)
          is called the
          standard form
          of the second-order linear differential equation. When a second-order equation is arranged in this format, we can determine its damping ratio and undamped natural frequency by equating its coefficients with those in the standard form. For example, in standard form the homogeneous equation for the series
          RLC
          circuit in
          Eq. (7-37)
          is
        



Equating like terms yields





          for the series
          RLC
          circuit. In an analysis situation, the circuit element values determine the value of the parameters ω
          0
          and ζ. In a design situation, we select
          L
          and
          C
          to obtain a specified ω
          0
          and then select
          R
T
          to obtain a specified ζ or vice-versa.
        

          To determine the form of the natural response using ω
          0
          and ζ, we insert a trial solution
          y
N
          (
          t
          ) =
          Ke

st

          into the standard form in
          Eq. (7-63)
          . The trial function
          Ke

st

          is a solution provided that
        




          Since
          K
          = 0 is the trivial solution and
          e

st

          ≠ 0 for all
          t
          ≥ 0, the only useful way for the right side of this equation to be zero for all
          t
          is for the quadratic expression within the brackets to vanish. The quadratic expression is the characteristic equation for the general second-order differential equation:
        



The roots of the characteristic equation are




          We begin to see the advantage of using the parameters ω
          0
          and ζ. The constant ω
          0
          is a scale factor that designates the size of the roots. The expression under the radical defines the form of the roots and depends only on the damping ratio ζ. As a result, we can express the three possible forms of the natural response in terms of the damping ratio.
        


Case A: For ζ > 1 the discriminant is positive, and there are two unequal real roots


(7-64a)



and the natural response has the overdamped form



(7-64b)






Case B: For ζ = 1 the discriminant vanishes, and there are two real equal roots


(7-65a)



and the natural response has the critically damped form



(7-65b)







              Case C: For ζ < 1 the discriminant is negative, leading to two complex conjugate roots
              s
1
              ,
              s
2
              = -α±
              j
              β, where
            



(7-66a)




and the natural response has the underdamped form



(7-66b)







Equations (7-64a)
          ,
          (7-65a)
          , and
          (7-66a)
          provide relationships between the natural frequency parameters a, the neper frequency, and p, the damped natural frequency, and the new parameters ζ and ω
          0
          . The reasons for using two equivalent sets of parameters to describe the natural frequencies of a second-order circuit will become clear as we continue our study of dynamic circuits. Since the units of
          
          complex frequency
          s
          are radians per second, the standard form of the characteristic equation
          s
2
          + 2ζω
          0
s
          + ω
          2
0
          shows that ω
          0
          is specified in radians per second and ζ is dimensionless.
        
Combining the forced and natural responses yields the step response of the general second-order differential equation in the form


(7-67)




          The factor
          A
          /
          a
0
          is the forced response. The natural response
          y
N
          (
          t
          ) takes the forms in
          Eqs. (7-64b)
          ,
          (7-65b)
          , or
          (7-66b)
          , depending on the value of the damping ratio. The constants
          K
1
          and
          K
2
          in the natural response can be evaluated from the initial conditions.
        
In summary, the step response of a second-order circuit is determined by



1.
              The amplitude
              A
              of the step function input
              Au
              (
              t
              )
            



2.
              The damping ratio ζ and natural frequency ω
              0




3.
              The initial conditions
              y
              (0) and
              dy/dt
              (0)
            


In this regard, the damping ratio and natural frequency play the same role for second-order circuits that the time constant plays for first-order circuits. That is, these circuit parameters determine the basic form of the natural response, just as the time constant defines the form of the natural response in a first-order circuit. It is not surprising that a second-order circuit takes two parameters, since it contains two energy storage elements.












EXAMPLE 7-22


                  The series
                  RLC
                  circuit in
                  Figure 7-42
                  (a) is driven by a step function and is in the zero state at
                  t
                  = 0. Find the capacitor voltage for
                  t
                  ≥ 0, when
                  V
A
                  = 10 V,
                  R
                  = 1 kΩ,
                  C
                  = 0.5 μF, and
                  L
                  = 2H. Resolve the problem using MATLAB.
                









FIGURE 7-42








SOLUTION:



              This is a series
              RLC
              circuit, so the differential equation for the capacitor voltage is
            




              By inspection, the forced response is
              υ
CF
              (
              t
              ) = 10 V. In standard format, the homogeneous equation is
            




              Comparing this format to the standard form in
              Eq. (7-63)
              yields
            




              so ω
              0
              = 1000 and ζ = 0.25. Since ζ < 1, the natural response is underdamped (Case C). Using
              Eqs. (7-66a)
              and
              (7-66b)
              , we have
            





              The general solution of the circuit differential equation is the sum of the forced and natural responses:
            




              The constants
              K
1
              and
              K
2
              are determined by the initial conditions. The circuit is in the zero state at
              t
              = 0, so the initial conditions are
              υ
C
              (0) = 0 and
              i
L
              (0) = 0. Applying the initial condition constraints to the general solution yields two equations in the constants
              K
1
              and
              K
2
              :
            




              These equations yield
              K
1
              = −10 and
              K
2
              = -2.58. The capacitor voltage step response is
            




              MATLAB has a built-in function for solving ordinary differential equations called
              dsolve
              . We can use this function to quickly explore the solution to a second-order differential equation. Suppose we have a series
              RLC
              circuit in the zero state connected to a voltage source
              V
A
              (
              t
              ). The parameter values are
              R
              = 1 kΩ,
              L
              = 2 H, and
              C
              = 0.5 μF. The differential equation for the voltage across the capacitor is given by
              Eq. (7-33)
              . We can use the following MATLAB code to solve for the capacitor voltage and plot the results.
            

              
                % Define the symbolic variables
              
              
                syms
                x(t)
              
              
                % Define the parameter values
              
              R = 1000;
              L = 2;
              C = 0.5e-6;
              
                % Solve the differential equation for the series RLC circuit with zero
              
              
                % initial conditions
              
              
                % Create the differential equation
              
              eqn = L*C*diff(x,t,2) + R*C*diff(x,t) +x==10;
              
                % Create the initial conditions
              
              Dx = diff (x,t);
              cond = [x(0)==0, Dx(0)==0];
              
                % Solve the equation and generate a numerical result
              
              vC(t) = dsolve(eqn,cond)
              vCt_num = vpa(vC(t),5)
              
                % Create a time vector for plotting and
              
              
                % substitute in numerical values
              
              tt = 0:0.0001:0.03;
              vCt1 = subs(vC(t));
              vCtt = subs(vCt1,t,tt);
              
                % Plot the results
              
              figure
              
                plot(tt,vCtt,
                'b', 'LineWidth', 2)
              
              
                hold
                on
              
              
                grid
                on
              
              
                xlabel
                ('Time, (s)')
              
              
                ylabel
                ('vjC(t), (V)')
              
            


              The MATLAB plot of
              v
C
              (
              t
              ) versus time is shown in
              Figure 7-42
              (b). The response and its first derivative at
              t
              = 0 satisfy the initial conditions. The natural response decays to zero, so the forced response determines the final value of
              v
C
              (∞) = 10 V. Beginning at
              t
              = 0, the response climbs rapidly but overshoots and undershoots the mark before eventually settling down to the final value. The damped sinusoidal behavior results from the fact that ζ < 1, producing an
              under-damped
              natural response.
            







FIGURE 7-42







■

 
















EXAMPLE 7-23



                  The series
                  RLC
                  circuit of
                  Figure 7-42
                  (a) is excited by a 10-V step source and has the initial conditions
                  i
L
                  (0) = 0 A and
                  υ
C
                  (0) = −5 V. The parameters are
                  L
                  = 2H and
                  C
                  = 0.5 μF. Use Multisim to vary
                  R
                  from underdamped to overdamped to view the effects of the damping ratio ζ on the voltage across the capacitor.
                




SOLUTION:



              For a series
              RLC
              circuit, we found earlier that
              
              . Using these two equations, we can solve for
              R
T
              =
              R





              In order to see the effects of varying
              R,
              we calculate the value of
              R
              that yields the critical case (Case B) by letting ζ = 1 and solving the above equation. For this circuit, Case B occurs when
              R
              = 4 kΩ. Knowing this, we can simulate the circuit with values of
              R
              larger than 4 kΩ (overdamped) and smaller than 4 kΩ (underdamped.)
            

              Using Multisim we build the series circuit,
              Figure 7-43
              (a), being careful to add the two initial conditions to the inductor and capacitor. Assign a nominal value to the resistor—say 1kΩ. To analyze the circuit, under the Simulate menu, we select the Analyses option and then select "Parameter sweep." The parameter we wish to sweep is the resistor R1, so we select "Resistor" as the "Device type" and "R1" as the "Name." The resistor parameter we wish to sweep is its "resistance." The nominal value you assigned to it will appear as its "Present value," but it does not play any role in the analysis. Next, we need to tell Multisim what type of sweep we want it to perform. Since we want to be certain that we include the value of resistance that yields the critical case, we will use the "List" under "Sweep variation type." We will then include the values of
              R
              that we want Multisim to use in doing the transient analysis. We chose 200,1000,2000,4000,10,000,20,000, and 40,000 ft. In the "More Options" section, set "Analysis to sweep" to "Transient Analysis." Then select "Edit Analysis" to tell Mul-tisim how to carry out the transient analysis. We will select "User-defined" under "Initial conditions," set the "Start time (TSTART)" to zero, and set the "End time (TSTOP)" to 20 ms. To ensure a smooth plot, we will make the "Maximum time step (TMAX)" 1 μs. Finally, open the "Output" tab and select the voltage across the capacitor as the desired output to be displayed. The Grapher View plots are shown in
              Figure 7-43
              (b). We have labeled the various curves to show their resistance and the cases they represent. If you did not pre-calculate the value of
              R
              required for Case B and simply swept a range of values, it would be very difficult to determine which curve was actually the critically damped case by looking at the curves. You might recall
              Exercise 7-24
              and
              Figure 7-37
              (c).
              ■











FIGURE 7-43














Exercise 7-29



              In
              Example 7-23
              , we plotted the effect of ζ on the circuit response by varying the series resistor
              R
              . In this exercise, we would like to look at the effect on the circuit response by varying the series capacitor
              C
              . Let
              R
              = 1kΩ,
              L
              = 2H,
              V
A
              = 10 V,
              i
L
              (0) = 0 A, and
              υ
C
              (0) = −5 V. Set
              C
              at a nominal 0.5 μF. Use Multisim and do a suitable parameter sweep and explain the effect of varying
              C
              on the capacitor voltage, ζ, and ω
              0
              . Identify the curves as Cases A, B, and C.
            


Answers:



              Increasing
              C
              decreases the frequency of oscillation ω
              0
              (visible only in underdamped cases) and increases ζ. See
              Figure 7-44
              . Compare the oscillations in the
              
              underdamped cases in
              Figure 7-44
              with those of
              Figure 7-43
              . Varying
              R
              keeps the frequency the same, but varying
              C
              causes both the damping coefficient and the frequency of the oscillations to change. What do you think would happen if we were to vary
              L
              ?
            







FIGURE 7-44






















EXAMPLE 7-24



                  The circuit in
                  Figure 7-45
                  is in the zero state. Find the current through the resistor for
                  t
                  ≥ 0.
                









FIGURE 7-45








SOLUTION:



              This is a parallel
              RLC
              circuit. The approach we will take is to first find an expression for the current through the inductor. Then, we will use the inductor's
              i-υ
              relationship to find the voltage across the inductor. Since the inductor is in parallel with the capacitor and has the same voltage, we can use the capacitor's
              i-υ
              relationship to find the current through the capacitor. Finally, using KCL at the top node, we can find the current through the resistor.
            

              The characteristic equation for a parallel
              RLC
              circuit is
            




              Substituting the values for
              R, L,
              and
              C,
              we get
            




              The roots of this equation are
              s
1
              = −14,300,
              s
2
              = -7000. Thus, the natural response is overdamped (Case A).
            

              We can write our basic equation for
              i
L
              (
              t
              ) as
            




              We make use of the initial conditions to solve for the constants
              K
1
              and
              K
2
              .
            




              Solving these equations for
              K
1
              and
              K
2
              yields
              K
1
              = 24 mA and
              K
2
              = -49 mA. Therefore, the total response for the current through the inductor is
            




              The voltage across the inductor is found using its
              i-υ
              relationship
            




              And the current through the capacitor is found using its
              i−υ
              relationship
            



We can now apply KCL at the top node and find an expression for the current through the resistor:




              Checking the result shows that there is no current flowing through the resistor at
              t
              = 0, or at
              t
              = ∞. Considering the behavior of inductors under dc stimulation, we
              
              realize that at
              t
              = 0− and again at
              t
              = ∞ the inductor acts like a short circuit with zero volts across it. Since the inductor is in parallel with the resistor, the voltage across the resistor is zero and, by Ohm's law, the current through it is zero.
              ■











Exercise 7-30


              Use Multisim to plot the currents through the three elements in circuit of
              Figure 7-45
              . Show that sum of all three element currents equals the source current for all time.
            


Answer:



              See
              Figure 7-46
              .
            







FIGURE 7-46


















Exercise 7-31




                (a) Find the zero-state response of
                υ
O
                (
                t
                ) in
                Figure 7-47
                (a) for
                υ
S
                (
                t
                ) = 60
                u
                (
                t
                ) V.
              
(b) Find the maximum using Multisim.

Answers:


                (a)
                υ
O
                (
                t
                ) = 100(
                e

                  −2000
                  t

                -
                e

                  −8000
                  t

                ) V
              

                (b) See
                Figure 7-47
                (b).
              








FIGURE 7-47


















Design Exercise 7-32




                (a) Select a value for
                R
                that will cause the
                RLC
                circuit of
                Figure 7-47
                (a) to produce a critically damped response. All parameters except
                R
                remain the same.
              

                (b) Use Multisim to determine the maximum value of
                υ
O
                (
                t
                ) and the time at which it reaches that value.
              
(c) What is the value of the maximum power delivered by the source?

Answers:


                (a)
                R
                = 250 Ω for a critically damped response.
              
(b) From a Multisim simulation, the voltage maximum occurs at 250 μs and the peak value is 44.15 V.

                (c) The maximum current of 240 mA occurs at
                t
                = 0 and again as
                t
                → ∞. Hence, the maximum power delivered by the source is 14.4 W.
              


















DESIGN EXAMPLE 7-25


                  Design a series
                  RLC
                  circuit whose zero-state step response is
                




                  where
                  V
A
                  is the amplitude of the step function input.
                




SOLUTION:


To obtain the required response, the numerical characteristic equation must be




              Using circuit parameters, the symbolic characteristic equation of a series
              RLC
              circuit is
            




              Equating coefficients in these two equations leads to two design constraints, namely,
              R
              /
              L
              = 2400 and 1/
              LC
              = 8 × 10
              5
              . Let
              R
              = 3 kΩ; then
              L
              =
              R
              /2400 = 1.25 H and
              C
              = 1/(
              L
              × 8 × 10
              5
              ) = 1 × 10
              -6
              F. Many other choices are possible.
              ■











Exercise 7-33



              The step response of a series
              RLC
              circuit is observed to be
            




(a) What is the circuit characteristic equation?
(b) What are the initial values of the state variables?
(c) What is the amplitude of the step input?

                (d) What are the values of
                R, L,
                and
                C?

(e) What is the voltage across the resistor?

Answers:


                (a)
                s
2
                + 2000
                s
                + 2 × 10
                6
                = 0
              

                (b)
                υ
C
                (0) = 0,
                i
L
                (0) = 45 mA
              

                (c)
                V
A
                = 15 V
              

                (d)
                R
                = 333 Ω,
                L
                = 167 mH,
                C
                = 3 μF
              

                (e)
                υ
R
                (
                t
                ) = 15
                e

                  −1000
                  t

                cos 1000
                t
                + 15
                e

                  −1000
                  t

                sin 1000
                t
                V
              

















EXAMPLE 7-26



                  What range of source resistance will produce an underdamped natural response in a parallel
                  RLC
                  circuit with
                  L
                  = 200 mH and
                  C
                  = 0.032 μF?
                




SOLUTION:



              According to
              Eq. (7-56)
              , the characteristic equation of a parallel
              RLC
              circuit is
            





              Dividing the
              LC
              puts this equation in the form
            




              Comparing this with the standard form
              s
2
              + 2ζω
              0
s
              + ω
              0
2
              leads to
            




              and 2ζω
              0
              = 1/
              R
N
C
              . Underdamped response requires that ζ < 1; hence
            


■












Evaluation Exercise 7-34




                (a) What range of source resistance will produce an underdamped natural response in a series
                RLC
                circuit with
                L
                = 200 mH and
                C
                = 0.032 μF?
              

                (b) Compare your answer with the parallel circuit solution in
                Example 7-26
                .
              

Answers:


                (a) For an underdamped response,
                R
                should be less than 5 kΩ.
              

                (b) In a parallel circuit, as
                R
N
                increases, it has less influence on the circuit response—an open circuit would ideally let the circuit oscillate forever. For a series circuit, the dual is true: as
                R
T
                decreases, it has less influence on the energy oscillating between the inductor and the capacitor, and a short circuit would ideally let the circuit oscillate forever.
              

















DESIGN EXAMPLE 7-27


                  Design a parallel
                  RLC
                  circuit with ζ = 0.5 and ω
                  0
                  = 25 krad/s.
                




SOLUTION:



              The characteristic equation of a parallel
              RLC
              circuit can be written as
            




              Comparing this with the standard form
              s
2
              + 2ζω
              0
s
              + ω
              0
2
              leads to two design constraints:
            




              Let the resistance
              R
N
              = 10 kΩ; then
              C
              = 1/25 × 10
              7
              = 4 × 10
              -9
              = 4000 pF and
              L
              = 25 × 10
              7
              /6.25 × 10
              8
              = 0.4 H. Many other choices are possible since there are three circuit parameters and only two constraints.
              ■












Design Exercise 7-35



              Design a series
              RLC
              circuit with ζ = 1.5 and ω
              0
              = 50 krad/s. You must use a 0.1-μF capacitor.
            


Answer:



              With
              C
              defined, there is only one solution:
              R
              = 600 Ω and
              L
              = 4 mH.
            






          Summary
        

Circuits containing linear resistors and the equivalent of one capacitor or one inductor are described by firstorder differential equations in which the unknown is the circuit state variable.

            The
            zero-input response
            in a first-order circuit is an exponential whose time constant depends on circuit parameters. The amplitude of the exponential is equal to the initial value of the state variable.
          

            For linear circuits, the
            total response
            is the sum of the forced and natural responses. The
            natural response
            is the general solution of the homogeneous differential equation obtained by setting the input to zero. The
            forced response
            is a particular solution of the differential equation for the given input.
          

            For linear circuits, the total response is the sum of the zero-input and zero-state responses. The
            zero-input response
            is caused by the initial energy stored in capacitors or inductors. The
            zero-state response
            results from the input driving forces.
          

            The
            initial and final values
            of the step response of a first- or second-order circuit can be found by replacing capacitors by open circuits and inductors by short circuits and then using resistance circuit analysis methods.
          
The transient response to a first-order circuit when the input is other than a step requires that the forced response solution be of the same form as the input. Hence, an exponential input suggests an exponential forced response; a sinusoidal input suggests a sinusoidal forced response, and so forth.

            For a sinusoidal input, the forced response is called the
            sinusoidal steady-state response,
            or the
            ac response.
            The ac response is a sinusoid with the same frequency as the input but usually with a different amplitude and phase angle. The ac response can be found from the circuit differential equation using the method of undetermined coefficients.
          

            Circuits containing linear resistors and the equivalent of two energy storage elements are described by second-order differential equations in which the dependent variable is one of the state variables. The initial conditions are the values of the two state variables at
            t
            =0.
          

            The zero-input response of a second-order circuit takes different forms depending on the roots of the characteristic equation.
            Unequal real roots
            produce the
            overdamped response, equal real roots
            produce the
            critically damped response,
            and
            complex conjugate roots
            produce
            underdamped responses.


            The circuit
            damping ratio
            ζ and
            
              undamped natural frequency ω
              0

            determine the form of the zero-input and natural responses of any second-order circuit. The response is overdamped if ζ > 1, critically damped if ζ = 1, and underdamped if ζ < 1.
          

            Software tools like MATLAB and Multisim can help produce numerical and graphical solutions for circuit transient behavior. In applying these tools, one must have some knowledge of analytical methods and an estimate of the general form of the expected response in order to effectively use these tools and interpret their results.
            Appendix D
            discusses the use of these tools and contains additional examples and exercises.
          





          Chapter 7 Problems
        






              Objective 7-1 First-order Circuit Analysis (
              Sects. 7-1
              to
              7-4
              )
            

              Given a first-order
              RC
              or
              RL
              circuit:
            

(a) Find the circuit differential equation, the circuit time constant, and the initial conditions (if not given).
(b) Find the zero-input response.
(c) Find the complete response for step function, exponential, and sinusoidal inputs.


              See
              Examples 7-1
              to
              7-7
              ,
              7-9
              to
              7-11
              ,
              7-15
              , and
              7-16
              and
              Exercises 7-1
              to
              7-7
              ,
              7-9
              to
              7-13
              ,
              7-15
              , and
              7-17
              to
              7-21
              .
            





7-1
            Find the function
            i
            (
            t
            ) that satisfies the following differential equation and the initial condition:
            





7-2


(a)
                Find the function
                i
                (
                t
                ) that satisfies the following differential equation and initial condition:
                




(b)
                Use MATLAB's dsolve to validate your answer.
              




7-3
            Find the time constants of the circuits in
            Figure P7-3
            .
            






FIGURE P7-3








7-4
            Each of the two circuits in
            Figure P7-4
            has a switch that affects their time constants.
            

(a)
                For circuit C1, find the time constant when the switch is in position A and repeat for position B.
              

(b)
                For circuit C2, find the time constant when the switch is closed and repeat when it is open.
              

(c)
                Assuming that
                R
1
                =
                R
2
                =
                R
3
                =
                R
4
                = 1 kΩ,
                C
1
                =
                C
2
                = 1 μF, and
                L
                = 100 mH, find the various time constants from parts (a) and (b).
              








FIGURE P7-4










7-5
            The switch in
            Figure P7-5
            is closed at
            t
            = 0. The initial voltage on the capacitor is
            υ
C
            (0) = 100 V.
            

(a)
                Find
                v
C
                (
                t
                ) and
                i
O
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Use MATLAB to plot the waveforms for
                υ
C
                (
                t
                ) and
                i
O
                (
                t
                ).
              

(c)
                Simulate the problem using Multisim and compare the results to the plots in part (b).
              








FIGURE P7-5









7-6
            In
            Figure P7-6
            , the initial current through the inductor is
            i
L
            (0) = 6mA.
            

(a)
                Find
                i
L
                (
                t
                ) and
                υ
O
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Use MATLAB to plot the waveforms for
                i
L
                (
                t
                ) and
                υ
O
                (
                t
                ).
              

(c)
                Simulate the problem using Multisim and compare the results to the plots in part (b).
              








FIGURE P7-6










7-7
            The circuit in
            Figure P7-7
            has 25 V stored across the two capacitors at
            t
            = 0, with the same polarity as
            υ
O
            (
            t
            ). If
            C
1
            = 33,000 pF,
            C
2
            = 22,000 pF,
            R
1
            =
            R
2
            =
            R
3
            = 330 kΩ, find
            υ
O
            (
            t
            ) for
            t
            ≥ 0.
            






FIGURE P7-7








7-8
            The switch in
            Figure P7-8
            has been in position A for a long time and is moved to position B at
            t
            = 0. Find
            v
C
            (
            t
            ) for
            t
            ≥ 0.
            






FIGURE P7-8










7-9

            The switch in the circuit in
            Figure P7-9
            has been in position A for a long time. At
            t
            = 0, it switches to position B; find
            i
L1
            (
            t
            ) and
            i
L2
            (
            t
            ) for
            t
            ≥ 0. Verify your result using Multisim. Explain the results.
            






FIGURE P7-9








7-10
            The circuit in
            Figure P7-10
            is in the zero state. Find the voltage
            υ
O
            (
            t
            ) for
            t
            ≥ 0 when an input of
            i
S
            (
            t
            ) =
            I
A
u
            (
            t
            ) is applied. Identify the forced and natural components in the output.
            






FIGURE P7-10









7-11
            The circuit in
            Figure P7-11
            is in the zero state when the input
            υ
S
            (
            t
            ) =
            V
A
υ
            (
            t
            ) is applied. Find
            υ
O
            (
            t
            ) for
            t
            ≥ 0. Identify the forced and natural components in the output.
            






FIGURE P7-11









7-12
            The circuit in
            Figure P7-12
            is in the zero state when the input
            υ
S
            (
            t
            ) = 20
            u
            (
            t
            ) V is applied. If
            L
            = 150 mH and
            R
            = 1.0 kΩ, find
            υ
O
            (
            t
            ) for
            t
            ≥ 0. Identify the forced and natural components in the output. On a single set of axes, use MATLAB to plot the forced response, the natural response, and the complete response.
            






FIGURE P7-12









7-13
            The circuit in
            Figure P7-13
            contains two energy storage devices connected to a battery via a single-pole, double-throw switch (SPDT). The switch has been in position A for a long time. At
            t
            = 0, the switch moves to position B. After 5 ms, it moves back to position A. If
            R
1
            = 2 kΩ,
            C
            = 0.5 μF,
            V
S
            = 15V,
            R
2
            =
            R
3
            = 100 Ω, and
            L
            = 100 mH, plot
            υ
01
            (
            t
            ) and
            υ
02
            (
            t
            ) from
            t
            = 0 to
            t
            = 10 ms.
            






FIGURE P7-13









7-14
            For the circuit in
            Figure P7-13
            , the switch has been in position B a long time. At
            t
            = 0, the switch moves to position A. After 5 ms, it moves back to position B. If
            R
1
            = 1 kΩ,
            C
            = 1 μF,
            V
S
            = 10 V,
            R
2
            =
            R
3
            = 100 Ω, and
            L
            = 100 mH, using Multisim plot
            i
L
            (
            t
            ) from
            t
            = 5 ms to
            t
            = 10 ms.
          



7-15
            Find the function that satisfies the following differential equation and the initial condition for an input
            υ
S
            (
            t
            ) = 2 cos 50
            t
            V and plot the solution using MATLAB:
            




7-16
            The switch in
            Figure P7-16
            has been open long enough for
            i
L
            (0) to reach 0 A and is closed at
            t
            = 0.
            

(a)
                If
                υ
S
                (
                t
                ) = 50
                u
                (
                t
                ) V, find
                υ
L
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                If
                υ
S
                (
                t
                ) = 50 cos(500
                t
                ) V, find for
                t
                ≥ 0.
              

(c)
                If
                υ
S
                (
                t
                ) = 50
                e

                  -500
                  t

                V, find
                υ
L
                (
                t
                ) for
                t
                ≥ 0.
              








FIGURE P7-16











7-17
            Repeat Problem 7-16 using Multisim.
          


7-18
            Repeat Problem 7-16 using MATLAB to plot the waveforms.
          


7-19
            The capacitor in
            Figure P7-19
            has zero volts across it at
            t
            = 0. Suddenly the circuit is excited by a 10-V step. At what time will the single-sided comparator trip?
            






FIGURE P7-19









7-20
            The follower circuit in
            Figure P7-20
            is in the zero state and
            R
1
            = 50 kΩ,
            R
2
            = 2 kΩ, and
            C
            = 0.1 μF.
            

(a)
                Suppose
                υ
S
                (
                t
                ) = 2
                u
                (
                t
                ), find
                υ
2
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Suppose
                υ
S
                (
                t
                ) = 2
                e

                  -5000
                  t

u
                (
                t
                ), find
                υ
2
                (
                t
                ) for
                t
                ≥ 0.
              

(c)
                Repeat (b) using Multisim.
              








FIGURE P7-20










7-21
            The inverting OP AMP in
            Figure P7-21
            is driven by a step input
            υ
S
            (
            t
            ) = 2
            u
            (
            t
            ). Let
            R
1
            = 2 kΩ,
            R
2
            = 20 kΩ, and
            C
            = 0.1 μF.
            

(a)
                If
                υ
C
                (0) = 8 V, find
                v
2
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                What is the value of
                t
                when
                v
2
                (
                t
                ) = 0 V?
              

(c)
                Does the OP AMP saturate? If so, at what value of
                t
                ?
              

(d)
                Validate your answers using Multisim.
              








FIGURE P7-21








7-22
            The switch in
            Figure P7-22
            has been in position A for a long time and is moved to position B at
            t
            = 0. The switch suddenly returns to position A after 10 ms. Find
            υ
C
            (
            t
            ) for
            t
            ≥ 0 and sketch its waveform.
            






FIGURE P7-22









7-23
            Switches 1 and 2 in
            Figure P7-23
            have both been in position A for a long time. Switch 1 is moved to position B at
            t
            = 0 and Switch 2 is moved to position B at
            t
            = 20 ms. Find the voltage across the 0.22-μF capacitor for
            t
            ≥ 0 and sketch its waveform.
            






FIGURE P7-23









7-24
            Find the sinusoidal steady-state response of
            υ
C
            (
            t
            ) in
            Figure P7-24
            when
            R
            = 100 kΩ,
            C
            = 0.02 μF, and the input voltage is
            υ
S
            (
            t
            ) = 15 cos(50
            t
            )
            u
            (
            t
            ) V. Repeat for an input voltage of
            υ
S
            (
            t
            ) = 15 cos(500
            t
            )
            u
            (
            t
            ) V, and one more time for an input voltage of
            υ
S
            (
            t
            ) = 15 cos(5k
            t
            )
            u
            (
            t
            ) V. Describe how changing the frequency affects the output's amplitude and phase. You may choose to use MATLAB and plot the steady-state responses of each input on a single set of axes.
            






FIGURE P7-24










7-25

            The dependent-source circuit in
            Figure P7-25
            separates two
            RC
            circuits. Build the circuit in Multisim and run a transient analysis of both
            υ
IN
            and
            υ
OUT
            and plot them on the same graph. Both capacitors have zero initial voltage. Explain the difference in the plots.
            






FIGURE P7-25













                  Objective 7-2 First-Order Circuit Design (
                  Sects. 7-1
                  to
                  7-4
                  )
                

                  Given responses in a first-order
                  RC
                  or
                  RL
                  circuit:
                

(a) Find the circuit parameters or other responses.
(b) Design a circuit to produce the given responses.


                  See
                  Examples 7-8
                  ,
                  7-12
                  to
                  7-14
                  and
                  Exercises 7-8
                  ,
                  7-15
                  ,
                  7-16
                  , and
                  7-22
                  .
                




7-26
            For
            t
            ≥ 0, the zero-input response of the circuit in
            Figure P7-26
            is
            υ
C
            (
            t
            ) = 20
            e

              -10k
              t

            V.
            

(a)
                Find
                C
                and
                i
C
                (
                t
                ) when
                R
                = 10 kΩ.
              

(b)
                Find the energy stored in the capacitor at
                t
                = 2 ms.
              

(c)
                Suppose the only capacitor you had available has a value of 0.022 μF. Could you achieve the same output by selecting a different
                R
                ? How would the current change?
              








FIGURE P7-26









7-27

            Design a series
            RC
            circuit using a dc voltage source that delivers the following voltage across the capacitor for
            t
            > 0.
            





7-28



(a)
                Design a parallel
                RL
                circuit using a dc current source that delivers the following voltage across the resistor for
                t
                > 0.
                




(b)
                Repeat the problem in (a) but using a dc voltage source.
              

(c)
                Verify your results in (a) and (b) using Multisim.
              




7-29

            Design a series
            RC
            circuit using a dc voltage source that delivers a voltage across the capacitor for
            t
            > 0 that fits entirely within the nonshaded region of
            Figure P7-29
            .
            






FIGURE P7-29








7-30

            Design a series
            RC
            circuit using dc voltage sources that delivers a voltage across the capacitor for
            t
            > 0 that fits entirely within the nonshaded region of
            Figure P7-30
            .
            






FIGURE P7-30









7-31

            Design a first-order
            RC
            circuit that will produce the following current through the capacitor:
            i
C
            (
            t
            ) = 40
            e

              −2000
              t

            mA. The capacitor has an initial voltage of −10 V. You must use a 1−μF capacitor.
          


7-32-7-34

            Design an
            RC
            circuit that meets the following specifications:
            





Time




Initial Value
Final Value
Constant
Other





                    7-32
                    


υ
R
                    (0) = 12 V
                  

υ
C
                    (∞) = 0 V
                  
1.0 s
±10 tolerance



                    7-33
                    


υ
C
                    (0) = 10 V
                  

υ
C
                    (∞) = −20 V
                  
1.0 ms

C
                    ≤ 0.01 μF
                    




                    7-34
                    



υ
C
                    (0) = −12 V
                  

υ
C
                    (∞) = 24 V
                  
10 ms
Validate using Multisim





7-35

            A timing circuit is required that feeds into an OP AMP's noninverting terminal (i.e., draws no current). The circuit's output response
            υ
O
            (
            t
            ) must be
            



Figure P7-35
              shows two commercial products and the vendors claim each will meet the requirement. Which will you select and why?
            







FIGURE P7-35










7-36

            A product line needs an
            RC
            circuit that will meet the following response specifications ±5%:
            


IV
FV

T
C


R


C





−5 V
+5 V
150 μs
≥ 1 kΩ
≤ 0.1 μF



Design a circuit to meet the specifications and validate your results using Multisim.






                  Objective 7-3 Second-Order Circuit Analysis (
                  Sects. 7-5
                  ,
                  7-6
                  ,
                  7-7
                  )
                
Given a second-order circuit:

(a) Find the circuit differential equation.
(b) Find the circuit natural frequencies and the initial conditions (if not given).
(c) Find the zero-input response.
(d) Find the complete response for a step function input.


                  See
                  Examples 7-17
                  ,
                  7-18
                  ,
                  7-20
                  to
                  7-23
                  ,
                  7-24
                  , and
                  7-26
                  and
                  Exercises 7-25
                  ,
                  7-27
                  ,
                  7-29
                  to
                  7-31
                  and
                  7-33
                  .
                






7-37
            Find the
            υ
            (
            t
            ) that satisfies the following differential equation and initial conditions. Then use MATLAB to plot the resultant waveform.
            




7-38
            Find the
            υ
            (
            t
            ) that satisfies the following differential equation and initial conditions:
            





7-39
            Find the
            i
            (
            t
            ) that satisfies the following differential equation and initial conditions, when
            K
            = 3, 4, and finally 5. Identify the Case associated with each value of
            K
            . MATLAB would be useful.
            





7-40
            The switch in
            Figure P7-40
            has been open for a long time and is closed at
            t
            = 0. The circuit parameters are
            L
            = 2H,
            C
            = 0.5 μF,
            R
            = 250 Ω, and
            υ
F
            (0) = 5 V.
            

(a)
                Find
                υ
C
                (
                t
                ) and
                i
L
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Is the circuit overdamped, critically damped, or underdamped?
              

(c)
                Use Multisim to simulate your results.
              








FIGURE P7-40










7-41
            Use Multisim to study how the voltage across the circuit in
            Figure P7-41
            changes as the value of the resistor is varied. Let
            L
            = 1 H,
            C
            = 1 μF,
            R
            = 500 Ω, and
            υ
C
            (0) = -10 V. Under "Analyses" perform a "Parameter sweep." The parameter we wish to sweep is the resistor R. We select it under "Device type." The resistor parameter we wish to sweep is its "resistance." The nominal value you assigned to it will appear as its "present value" but it does not play any role in the analysis. Next, we need to tell it what type of sweep we want it to perform. We will use "Decade" under "Sweep variation type." We will then include the values of
            R
            that we want Multisim to use in doing the transient analysis, that is, vary the resistor from 10 Ω to 10 kΩ by 3 points per decade. This will generate a family of curves corresponding to different values of resistance. By clicking on the various curves, determine if the response becomes more or less damped as
            R
            varies from 10 Ω to 10 kΩ . By looking at the curves, can you tell about what value of resistance will produce a critically damped circuit? Verify your guess by actually calculating the value of
            R
            that yields ζ = 1.
            






FIGURE P7-41









7-42

            The switch in
            Figure P7-42
            has been open for a long time and is closed at
            t
            = 0. The circuit parameters are
            L
            = 400 mH,
            C
            = 0.1 μF,
            R
1
            = 22 kΩ,
            R
2
            = 330 Ω, and
            V
A
            = 15 V.
            

(a)
                Find
                υ
C
                (
                t
                ) and
                i
L
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                What is ζ for this circuit?
              

(c)
                Use Multisim to validate your results.
                Hint:
                In Grapher View plot
                υ
C
                (
                t
                ) using the left axis and
                i
L
                (
                t
                ) on the right axis.
              

(d)
                Change the appropriate
                R
                to create the critically damped case.
              








FIGURE P7-42











7-43
            The switch in
            Figure P7-43
            has been open for a long time and is closed at
            t
            = 0. The circuit parameters are
            L
            = 1.25 H,
            C
            = 0.05 μF,
            R
1
            = 33 kΩ,
            R
2
            = 33 kΩ, and
            V
A
            = 20 V.
            

(a)
                Find
                υ
C
                (
                t
                ) and
                i
L
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Is the circuit overdamped, critically damped, or underdamped?
              

(c)
                Use Multisim to validate your results.
                Hint:
                In Grapher View plot
                υ
C
                (
                t
                ) using the left axis and
                i
L
                (
                t
                ) on the right axis.
              








FIGURE P7-43









7-44

            The switch in Figure F7-43 has been open for a long time and is closed at
            t
            = 0. The circuit parameters are
            L
            = 0.02 H,
            C
            = 0.1 μF, and
            V
A
            = 20 V.
            

(a)
                Select values of
                R
1
                and
                R
2
                so that the circuit is critically damped.
              

(b)
                How would you change the resistors if you wanted the circuit to be underdamped? Repeat for overdamped.
              

(c)
                Run a Multisim simulation for the critically damped situation.
              





7-45

            You have a need for an interface circuit that will connect your source to a load with a very high input resistance as shown in
            Figure P7-45
            (a). Your interface must have a response that fits within the boundaries shown in
            Figure P7-45
            (b). A vendor offers a suitable circuit shown in
            Figure P7-15
            (a) and says that they are willing to change one component without additional cost. Would you purchase the circuit as is? If, not, would you purchase it with one change? What is the change? Use MATLAB or Multisim to verify your result.
            






FIGURE P7-45









7-46
            The switch in Figure has been in position A for a long time and is moved to position B at
            t
            = 0. The circuit parameters are
            R
1
            = 2 kΩ,
            R
2
            = 91 Ω,
            L
            = 250 mH,
            C
            = 33 μF, and
            V
A
            = 24 V.
            

(a)
                Find
                υ
C
                (
                t
                ) and
                i
L
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Is the circuit overdamped, critically damped, or underdamped?
              

(c)
                Use Multisim to validate your results.
                Hint:
                In Grapher View plot
                υ
C
                (
                t
                ) using the left axis and
                i
L
                (
                t
                ) on the right axis.
              








FIGURE P7-46










7-47

            The OP AMP circuit shown in Figure P7-17 purports to be an oscillator. Derive the differential equation for the output voltage. Then build the circuit in Multisim and validate your solution by calculation
            f
0
            if indeed it is an oscillator. What function does
            R
            play if any?
            






FIGURE P7-47









7-48
            The circuit in
            Figure P7-48
            is in the zero state when the step function input is applied.
            

(a)
                If
                V
A
                = 15 V,
                R
                = 1.5 kΩ,
                L
                = 250 mH, and
                C
                = 025 μF, derive an expression for the voltage
                υ
O
                (
                t
                ) for
                t
                ≥ 0.
              

(b)
                Validate your solution by plotting it using MATLAB and comparing it to a Multisim simulation of the same circuit.
              








FIGURE P7-48









7-49
            Derive expressions for the damping ratio and undamped natural frequency of the circuit in
            Figure P7-49
            in terms of the circuit parameters
            R
            ,
            L
            , and
            C
            . Which parameter(s) affect the damping ratio? Can you change the damping ratio without affecting the undamped natural frequency?
            






FIGURE P7-49









7-50
            The circuit of
            Figure P7-50
            is a two-stage circuit that will be studied extensively in
            Chapter 12
            as a band-pass filter. It is a second-order circuit whose zero-state step response can be solved by recognizing that since
            R
            and
            C
            are the same, the solution fits Case B for the natural response
            υ
2N
            (
            t
            ) (
            Eq. 7-65b
            .)
            

Caution:


υ
2
            (
            t
            ) is not
            υ
C
            (
            t
            ) in the second circuit.
            

(a)
                Find the output
                υ
2
                (
                t
                ) when the input
                υ
S
                (
                t
                ) = 6
                u
                (
                t
                ),
                R
                = 15 kΩ, and
                C
                = 0.1 μF.
              

(b)
                Use MATLAB to plot your result.
              

(c)
                Simulate the circuit using Multisim and compare your results.
              








FIGURE P7-50










7-51
            The circuit of
            Figure P7-51
            is a two-stage, first-order cascade circuit that will be studied extensively in
            Chapter 14
            . It is a second-order circuit whose zero-state step response can be solved by recognizing that since
            R
            and
            C
            are the same, the solution fits Case B for the natural response
            υ
2N
            (
            t
            ) (
            Eq. 7-65b.
            ) Note both the similarity and the difference between the circuit in
            Figure P7-50
            and
            Figure P7-51
            . As we will study later, the former is a band-pass filter, while the latter is a second-order low-pass filter.
            

(a)
                For the circuit in
                Figure P7-51
                find the output
                υ
2
                (
                t
                ) when the input
                υ
S
                (
                t
                ) = 5
                u
                (
                t
                ),
                R
                = 10 kΩ, and C = 0.1 μF.
              

(b)
                Use MATLAB to plot your result.
              

(c)
                Simulate together both the filter in
                Figure P7-50
                and that in
                Figure P7-51
                using Multisim. Note that both filters have similar component values and input step functions. What conclusions can you draw about the step responses of these circuits?
              








FIGURE P7-51












                  Objective 7-4 Second-Order Circuit Design (
                  Sects. 7-5
                  to
                  7-7
                  )
                

                  Given responses in a second-order
                  RLC
                  circuit,
                

(a) Find the circuit parameters or other responses.
(b) Design a circuit to produce the given responses.


                  See
                  Examples 7-19
                  ,
                  7-25
                  , and
                  7-27
                  and
                  Exercises 7-23
                  ,
                  7-24
                  ,
                  7-26
                  ,
                  7-28
                  ,
                  7-32
                  ,
                  7-34
                  , and
                  7-35
                  .
                





7-52

            The circuit in
            Figure P7-52
            is in the zero state when the step function input is applied. If the input source is
            V
A
            = 10 V and
            L
            = 0.1 H, select values of
            R
            and
            C
            so that the circuit's output
            υ
O
            (
            t
            ) for
            t
            ≥ 0 is critically damped. Use MATLAB or Multisim to show your result for
            υ
O
            (
            t
            ). (
            Hint:
            Find the inductor current first.)
            






FIGURE P7-52









7-53
            In a series
            RLC
            circuit, the step response across the 1-μF capacitor is
            




(a)
                Find
                R
                and
                L
                .
              

(b)
                Find
                i
L
                (
                t
                ) for
                t
                ≥ 0.
              



7-54
            In a parallel
            RLC
            circuit, the state variable responses are
            



              Find
              R, L, C
              , and ζ.
            




7-55

            There is a need for a parallel
            RLC
            circuit that exhibits the desired response shown in
            Figure P7-55
            . A vendor's spec sheet shows the circuit in
            Figure P7-55
            and states that they are willing to make a single change for no additional cost.
            
            You construct the circuit in Multisim and you obtain the prototype response shown. Can you recommend a single element change that can yield the desired response? Verify your response using Multisim.
            






FIGURE P7-55









7-56

            In a parallel
            RLC
            circuit, the inductor current through a 1.5-H inductor is observed to be
            



              Find
              υ
L
              (
              t
              ) at
              t
              = 0.1 s. Hint: Use MATLAB to plot
              v
L
              (
              t
              ).
            



7-57

            Design a parallel
            RLC
            circuit whose natural response has the form
            





7-58

            Amplitude-modulated (AM) radios use an oscillator operating at 455 kHz to demodulate the received signal. This frequency is called the intermediate frequency or IM. Your task is to design an
            LC
            oscillator that produces a sinusoid that has a 5-V peak output and runs at the IM frequency.
            

(a)
                Write the differential equation that determines the oscillator's output taken across the capacitor.
              

(b)
                Use MATLAB to solve the equation and plot the output. Verify that the amplitude and frequency are correct.
              

(c)
                Build the circuit in Multisim, and using a transient display, validate the output. Use a follower to isolate the
                LC
                circuit.
              





7-59
            Design a series
            RLC
            circuit whose output voltage resides entirely within the nonshaded region of
            Figure P7-59
            . Validate your design using MATLAB or Multisim.
            






FIGURE P7-59








7-60

            An intern designed the circuit shown in
            Figure P7-60
            . The intern claimed that by varying the 470-2 potentiometer the circuit could achieve all three damping cases. As a wise designer, you suggest an adjustment that would allow the circuit to indeed achieve all three cases. What would you suggest?
            






FIGURE P7-60









7-61
            A variable capacitor is used in the circuit of
            Figure P7-61
            to vary the damping ratio. What range of damping ratios is available in the circuit? At what value of
            C
            will ζ be 1?
            






FIGURE P7-61








7-62
            A particular parallel
            RLC
            circuit has the step response observed on an oscilloscope and shown in
            Figure P7-62
            . Four points on the waveform were measured and are shown. Determine the circuit's initial value, final value, the dominant exponential's time constant, and the likely case (A, B, or C) of the circuit response.
            







FIGURE P7-62










Integrating Problems




7-63

              Intermittent Timing Circuit for Windshield Wipers
            

              A car maker needs an
              RC
              timing circuit to trigger the windshield wiper relay. The circuit should be driver selectable to trigger at 1,2,5, and 10 s ± 5%. The source circuit is the car voltage of 12 V with a series resistance of 10 Ω. You must use standard parts (see
              Appendix G
              ). You have a single-sided OP AMP available with a
              V
CC
              of 0 V and +12 V that you can use to trigger the windshield wiper relay. The relay triggers with an input of +12 V ± 1V. You may assume that the circuit resets after the trigger. You should validate your design using Multisim.
            




7-64

RC
              Circuit Design
            

              Design the first-order
              RC
              circuit in
              Figure P7-64
              so an input
              υ
S
              (
              t
              ) = 15
              u
              (
              t
              ) V produces a zero-state response
              υ
O
              (
              t
              ) = 15-5
              e

                -1000
                t

              V. Validate your design using MATLAB or Multisim.
            







FIGURE P7-64









7-65

              Sample-Hold Circuit
            

Figure P7-65
              is a simplified diagram of a sample-hold circuit. When the switch is in position A, the circuit is in the sample mode and the capacitor voltage must charge to at least 99% of the source voltage
              V
A
              in less than 1 μs. When the switch is moved to position B, the circuit is in the hold mode and the capacitor must retain at least 99% of
              V
              A for at least 1 ms. Select a capacitor that meets these constraints.
            







FIGURE P7-65









7-66

              Supercapacitor
            

              Supercapacitors have very large capacitance (typically from 0.1 to 135 kF), small sizes, and very long charge-holding times, making them useful in nonbattery backup power applications. The charge-holding quality of a supercapacitor is measured using the circuit in
              Figure P7-66
              . The switch is closed for a long time (say, 24 h) and the capacitor charged to 5 V. The switch is then opened and the capacitor allowed to self-discharge through any leakage resistance for 24 h. Suppose that after 24 h the voltage across a 100-F supercapacitor is 475 V. What is the equivalent leakage resistance in parallel with the capacitor?
            







FIGURE P7-66









7-67

              Cost-Conscious
              RLC
              Circuit Design
            

              You are assigned a task to design a series, passive
              RLC
              circuit with a characteristic equation of
              s
2
              + 2000
              s
              + 5 × 10
              6
              = 0. To save money, your supervisor wants you to use a previously purchased 150-mH inductor with a 10-2 parasitic resistance. The
              RLC
              circuit will be used to interface to a Thévenin source with a 75-2 series output resistance. Your circuit must demonstrate the desired response with the source circuit connected.
            



7-68

              Combined First- and Second-Order Response
            

              The switch in
              Figure P7-68
              has been in position A for a long time and is moved to position B at
              t
              = 0 and then to position C when
              t
              = 10 ms. For 0 <
              t
              < 10 ms, the capacitor voltage is a charging exponential
              υ
C
              (
              t
              ) = 10(1-
              e

                -100
                t

              ) V. For
              t
              >10 ms, the capacitor voltage is a sinusoid
              υ
C
              (
              t
              ) = 6.321 cos[1000(
              t
              - 0.01)] V.
            



(a)
                  Suppose the resistance is reduced to 1 kΩ and the switching sequence repeated.
                
Will the amplitude of the sinusoid increase, decrease, or stay the same?


                  Will the frequency of the sinusoid increase, decrease, or stay the same?
                



(b)
                  Suppose the inductance is reduced to 100 mH and the switching sequence repeated.
                
Will the amplitude of the sinusoid increase, decrease, or stay the same?
Will the frequency of the sinusoid increase, decrease, or stay the same?







FIGURE P7-68












7-69


              Digital Error Caused by Undesired Ringing
            

              A digital clock has become corrupted by a ringing (undesired oscillations) as shown in
              Figure P7-69
              (a). The unwanted oscillations can cause false triggers and must be reduced to not trigger a false logic 1 or 0. The comparators should only trigger when the clock signal is above 3.7 V for a logic 1 and below 1.2 V for a logic zero. The clocks ringing can be modeled as an
              RLC
              series circuit as shown in
              Figure P7-69
              (b), with the voltage taken at node A. The parasitic capacitance is estimated at 0.01 μF and the Thévenin resistance at 220 Ω. From the graph, the inductance is estimated at 15 mH. Build the circuit as shown in
              Figure P7-69
              (b). Do a transient analysis and observe how the ringing causes false logic outputs. Now design an interface circuit that significantly reduces the ringing without significantly reducing the rise time (the time it takes the pulse to go from low to high or vice versa). The transition must occur in less than 80 us and the overshoot and undershoot (deviation from 0 or 5 V) must not cause unwanted triggering. A logic "1" must always be greater than 3.7 V and a logic "0" must always be less than 1.2 V. Use Multisim to validate your design. The comparator outputs should always be either a logic 1 or a logic 0.
            







FIGURE P7-69










7-70

              Triangular Wave Design
            

              There is a need to generate a 12-V ± 10%, 10 kHz triangular wave. You have a ±5-V, 10 kHz square wave. You recall from your first Circuits course that you can easily design an OP AMP integrator that should be able to produce a triangular wave from a square wave. But the slope of the square wave should not show any visually detectable curve—and it should start at
              t
              = 0. The OP AMPs available have a ± 15 V
              V
CC
              . Design the circuit and verify your design using Multisim. The desired input/output is shown in
              Figure P7-70
              .
            







FIGURE P7-70









7-71

              Optimum Fusing
            

              A sensitive instrument that can be modeled by the series
              RLC
              circuit shown in
              Figure P7-71
              is to be protected by a fuse. The voltage across the capacitor is
            




              The peak current was found to occur at about 13 ms after
              t
              = 0. Engineer A suggests a 10-mA fuse, Engineer B suggests a 5-mA fuse, while Engineer C suggests a 1-mA fuse. The criterion is to select a fuse that is closest to the peak value of current expected without blowing. Which engineer is correct? Provide evidence for your decision.
              








FIGURE P7-71









7-72

              Lightning Pulser Design
            

              The circuit in
              Figure P7-72
              is a simplified diagram of a pulser that delivers simulated lightning transients to the test article at the output interface. Closing the switch must produce a short-circuit current of the form
              i
SC
              (
              t
              ) =
              I
A
e

                -α
                t

              cos(β
              t
              ), with α = 100 krad/s, β = 200 krad/s, and
              I
A
              = 2.5 kA. Select the values of
              L, C,
              and
              V
0
              .
            







FIGURE P7-72









7-73

RLC
              Circuit Design
            

              Losses in real inductors can be modeled by a series resistor as shown in
              Figure P7-73
              . In this problem, we include the effect of this resistor on the design of the series
              RLC
              circuit shown in the figure. The design requirements include a source resistance of 50 Ω, an undamped natural frequency of 50 kHz, and a damping ratio less than 0.1.
            
The characteristics of the available inductors are listed below.




L
                    (mH)
                  

R
L
                    (Ω)
                  

L
                    (mH)
                  

R
L
                    (Ω)
                  




10.0
651
5.6
240


7.5
471
4.7
190


6.8
356
3.3
161



Which inductor would you use in your design and why?







FIGURE P7-73









7-74

              Competing Circuit Designs
            

Figure P7-74
              shows the step responses
              υ
C
              (
              t
              ) of two competing series
              RLC
              circuits from two different vendors. The circuits are designed to switch from 0 to 10 V and to meet a specification for a desired circuit with the following characteristic equation:
            



Not all of the details of the actual circuits have been provided because of proprietary reasons, but each vendor has given some information about their respective circuit. Both claim they meet the required specifications.



Vendor A
Vendor B





R
T
                    = 100 Ω
                  

R
                    /
                    L
                    = 10 rad/s
                  



                    1/
                    LC
                    = 100 (rad/s)
                    2


                    ω
                    0
                    = 10 rad/s
                  



C
                    = 2mF
                  





              Which vendor would you choose and why?
              








FIGURE P7-74











Notes




1

              Mathematicians use the letter
              i
              to represent
              
              . Electrical engineers use
              j
              , since the letter
              i
              represents electric current.
            


2

              The term
              neper frequency
              honors the sixteenth-century mathematician John Napier, who invented the base
              e
              or natural logarithms. The term
              complex frequency
              was apparently first used at about 1900 by the British engineer Oliver Heaviside.
            
















CHAPTER 8

SINUSOIDAL STEADY-STATE RESPONSE







The vector diagram of sine waves gives the best insight into the mutual relationships of alternating currents and emf's.


            Charles P. Steinmetz, 1893,
            
            American Engineer
          






Some History Behind This Chapter
The vector description of sinusoids was first discussed in detail by Charles Steinmetz (1865-1923) at the International Electric Congress of 1893. Although Oliver Heaviside may have used the vector concept earlier, Steinmetz is credited with popularizing the approach by demonstrating its many applications. By the turn of the century, the vector method was well established in engineering practice and education. In the 1950s Steinmetz's vectors came to be called phasors to avoid possible confusion with the space vectors used to describe electromagnetic fields.









Why This Chapter Is Important Today
In this chapter, we learn how to analyze ac circuits driven by a single-frequency sinusoid. We do this using a clever technique called phasor analysis that allows us to deal with ac circuits using the same tools we used on dc circuits. Phasor analysis is the key to understanding the electrical power systems that supply our homes and businesses. Using complex numbers is the price we pay for the simplicity of phasor analysis. Yet complex numbers are easy to master; after all, you were first introduced to them in high school. Fortunately, very complex (pun intended) problems can be solved using software tools.









Chapter Sections



8-1 Sinusoids and Phasors






8-2 Phasor Circuit Analysis






8-3 Basic Phasor Circuit Analysis and Design






8-4 Circuit Theorems with Phasors






8-5 General Circuit Analysis with Phasors






8-6 Energy and Power












Chapter Learning Objectives

8-1
              Sinusoids and Phasors (
              Sect. 8-1
              )
            
Given a sinusoid in polar or rectangular form:

(a) Convert it into a phasor or vice versa.
(b) Use the additive and derivative properties of phasors to combine or otherwise manipulate sinusoids or phasors and write or plot resultant phasors or sinusoids.


8-2
              Impedance (
              Sects. 8-2
              and
              8-3
              )
            
Given a linear circuit in the sinusoidal steady state:


                (a) Convert
                R, L,
                and
                C
                elements into impedances in the phasor domain.
              
(b) Use series and parallel equivalence to find the equivalent impedance at a specified pair of terminals.


8-3
              Basic Phasor Circuit Analysis and Design (
              Sects. 8-3
              and
              8-4
              )
            

(a) Given a linear circuit in the sinusoidal steady state, find phasor responses using equivalent circuits, circuit reduction, Thévenin or Norton equivalent circuits, and proportionality, or superposition.
(b) Given a desired phasor response and a sinusoidal input, design a circuit in the sinusoidal steady state that produces the desired response.


8-4
              General Circuit Analysis (
              Sect. 8-5
              )
            
Given a linear circuit in the sinusoidal steady state, find equivalent impedances and phasor responses using node-voltage or mesh-current analysis.

8-5
              Average Power and Maximum Power Transfer (
              Sect. 8-6
              )
            
Given a linear circuit in the sinusoidal steady state:

(a) Find the average power delivered at a specified interface.
(b) Find the maximum average power available at a specified interface.
(c) Find the load impedance required to draw the maximum available power.





8-1 Sinusoids and Phasors


          The phasor concept is the foundation for the analysis of linear circuits in the sinusoidal steady state. Simply put, a
          phasor
          is a complex number representing the amplitude and phase angle of a sinusoidal voltage or current. The connection between sinewaves and complex numbers is provided by Euler's relationship:
        



(8-1)





Equation (8-1)
          relates the sine and cosine functions to the complex exponential
          
            e
            j

θ
          . To develop the phasor concept, it is necessary to adopt the point of view that the cosine and sine functions can be written in the form
        



(8-2)




and



(8-3)





          where Re stands for the "real part of" and Im for the "imaginary part of." Development of the phasor concept can begin with either
          Eq. (8-2)
          or
          (8-3)
          . The choice between the two involves deciding whether to describe the sinewave using a sine or cosine function. In
          Chapter 5
          , we chose the cosine, so we will reference phasors to the cosine function.
        

          When
          Eq. (8-2)
          is applied to the general sinusoid defined in
          Chapter 5
          , we obtain
        



(8-4)





          In the last line of
          Eq. (8-4)
          , moving the amplitude
          V
A
          inside the real part operation does not change the final result because it is a real constant.
        

          By definition, the quantity
          V
A

            e
            j

ϕ
          in the last line of
          Eq. (8-4)
          is the
          phasor representation
          of the sinusoid
          υ
          (
          t
          ). The phasor V is written as
        



(8-5)





          Note that
          V
          is a complex number determined by the amplitude and phase angle of the sinusoid.
          Figure 8-1
          shows a graphical representation commonly called a phasor diagram.
        








FIGURE 8-1



Phasor diagram.





          As shown in
          Eq. (8-5)
          , a phasor is a complex number that can be written in either polar or rectangular form. An alternative way to write the polar form is to replace the exponential
          i

j
            ϕ
          
          by the shorthand notation ∠ϕ. In subsequent discussions, we will often express phasors as
          V
          =
          V
A
          ∠ϕ, which is equivalent to the polar form in
          Eq. (8-5)
          . When written this way, one states that the phasor has an amplitude of
          V
A
          at an angle of ϕ.
        
Two features of the phasor concept need emphasis:


1.
            Phasors are written in boldface type like
            V
            or
            I
1
            to distinguish them from signal waveforms such as
            υ
            (
            t
            ) and
            i
1
            (
            t
            ).
          

2.
            A phasor is determined by amplitude and phase angle and does not contain any information about the frequency of the sinusoid.
          


          The first feature points out that signals can be described in different ways. Although the phasor
          V
          and waveform
          υ
          (
          t
          ) are related concepts, they have different physical interpretations and our notation must clearly distinguish between them.
          
The absence of frequency information in the phasors results from the fact that in the sinusoidal steady state, all currents and voltages are sinusoids with the same frequency.




          Carrying frequency information in the phasor would be redundant, since it is the same for all phasors in any given steady-state circuit problem.
        

          In summary, given a sinusoidal signal
          υ
          (
          t
          ) =
          V
A
          cos(ω
          t
          + ϕ), the corresponding phasor representation is
          V
          =
          V
A

            e
            j

ϕ
          =
          V
A
          ∠ϕ. Conversely, given the phasor
          V
          =
          V
A

            e
            j

ϕ
,
          the corresponding sinusoid is found by multiplying the phasor by
          
            e
            j


            ω
            t

          and reversing the steps in
          Eq. (8-4)
          as follows:
        



(8-6)





          The frequency ω in the complex exponential
          
            Ve
            jωt

          in
          Eq. (8-6)
          must be expressed or implied in a problem statement, since by definition it is not contained in the phasor.
          Figure 8-2
          shows a geometric interpretation of the complex exponential
          
            Ve
            jωt

          as a vector in the complex plane of length
          V
A
          , which rotates counterclockwise with a constant angular velocity of ω, the radian frequency of the sinusoid. The real part operation projects the rotating vector onto the horizontal (real) axis and thereby generates
          υ
          (
          t
          ) = V
          A
          cos(ω
          t
          + ϕ). The complex exponential is sometimes called a
          rotating phasor,
          and the phasor
          V
          is viewed as a snapshot of the situation at
          t
          = 0.
        








FIGURE 8-2



Complex exponential
V

                  e
                  jωt
                  .
                







Note:


          This and subsequent chapters involve manipulating complex numbers. A review of complex numbers can be found in
          Appendix F
          . Specifically for the next set of exercises, we recall that:
          V
          =
          V
A
          ∠ϕ =
          a
          +
          jb
          , where
          a
          =
          V
A
          cos ϕ and
          b
          =
          V
A
          sin ϕ. In addition,
          
          .
        







Exercise 8-1


Convert the following sinusoids to phasors in polar and rectangular form:


                (a)
                υ
                (
                t
                ) = 20 cos(150
                t
                - 60°) V
              

                (b)
                υ
                (
                t
                ) = 10 cos(1000
                t
                + 180°) V
              

                (c)
                i
                (
                t
                ) = 5 cos (5000t - 143°) A
              

Answers:


                (a)
                V
                = 20∠ - 60° = 10 -
                j
                17.3 V
              

                (b)
                V
                = 10∠180° = -10 +
                j
                0V = - 10 V
              

                (c)
                I
                = 5∠ - 143° = - 4 -
                j
                3 A
                

Note:


                The quadrant
              











Exercise 8-2

Convert the following phasors to sinusoids:


                (a)
                I
                = 10 mA at ω = 10 rad/s
              

                (b)
                V
                = 66 -
                j
                10 V at ω = 10 krad/s
              

                (c)
                I
                = 5+
                j
                5 A at ω = 377 rad/s
              

                (d)
                V
                = 169∠- 45° V at
                f
                = 60Hz
              

Answers:


                (a)
                i
                (
                t
                ) = 10 cos 10
                t
                mA
              

                (b)
                υ
                (
                t
                ) = 66.7 cos (10
                4
t
                - 8.62°) V
              

                (c)
                i
                (
                t
                ) = 7.07 cos (377
                t
                + 45°) A 
              
 
                (d)  
                υ   
                (  
                t   
                ) = 169 cos (377   
                t
                - 45°) V. 
                

Note:

   
                The frequency must be in rad/s. That is, ω = 2π  
                f   
                = 377 rad/s.
              



Properties of Phasors
    
          Two important properties of phasors play key roles in circuit analysis. First, the
          additive property 
          states that the phasor representing a sum of sinusoids of the same frequency is obtained by adding the phasor representations of the component sinusoids. To establish this property, we write the expression
        



(8-7)






          where
          υ
1
          (
          t
          ),
          υ
2
          (t), ...,
          
            υ
            N

          (
          t
          ) are sinusoids of the same frequency whose phasor representations are
          V
1
          ,
          V
2
          ,... .,
          V

N

          . The real part operation is additive, so the sum of real parts equals the real part of the sum. Consequently,
          Eq. (8-7)
          can be written in the form
        



(8-8)





          Comparing the last line in
          Eq. (8-8)
          with the definition of a phasor, we conclude that the phasor
          V
          representing
          υ
          (
          t
          ) is
        



(8-9)





          The result in
          Eq. (8-9)
          applies only if the component sinusoids all have the same frequency so that
          
            e
            jωt

          can be factored out as shown in the last line in
          Eq. (8-8)
          .
        

          In
          Chapter 5
          , we found that the time derivative of a sinusoid is another sinusoid with the same frequency. Since they have the same frequency, the signal and its derivative can be represented by phasors. The
          derivative property
          of phasors allows us easily to relate the phasor representing a sinusoid to the phasor representing its derivative.
        
Equation (8-6) relates a sinusoid function and its phasor representation as




          Differentiating this equation with respect to time
          t
          yields
        


(8-10)




          From the definition of a phasor, we see that the quantity (
          j
          ω
          V
          ) on the right side of this equation is the phasor representation of the time derivative of the sinusoidal waveform. This phasor can be written in the form
        


(8-11)



which points out that differentiating a sinusoid changes its amplitude by a multiplicative factor ω and shifts the phase angle by 90°.

          In summary, the additive property states that adding phasors is equivalent to adding sinusoids of the same frequency. The derivative property states that multiplying a phasor by
          j
          ω is equivalent to differentiating the corresponding sinusoid. The following examples show applications of these two properties of phasors.
        













EXAMPLE 8-1



(a) Construct the phasors for the following signals:






                    (b) Use the additive property of phasors and the phasors found in (a) to find
                    υ
                    (
                    t
                    ) =
                    υ
1
                    (
                    t
                    ) +
                    υ
2
                    (
                    t
                    ).
                  






SOLUTION:




                (a) The phasor representations of
                υ
1
                (
                t
                ) and
                υ
2
                (
                t
                ) are
                




                (b) The two sinusoids have the same frequency, so the additive property of phasors can be used to obtain their sum:
                


The waveform corresponding to this phasor sum is




                  The phasor diagram in
                  Figure 8-3
                  shows that summing sinusoids can be viewed geometrically in terms of phasors.
                










FIGURE 8-3







MATLAB can be a valuable tool in working with phasors. The following code is useful for this example:

              % Create the phasor values
              V1 =10*exp(-j*45*pi/180)
              V2 = 5*exp(j*30*pi/180)
              % Form the sum
              V = V1 + V2
              % Compute the polar form
              MagV = abs(V);
              PhaseV = angle(V);
              PhaseVDeg = 180*PhaseV/pi;
              % Display the results
              disp(['V = ',num2str(MagV,'% 3.4g')...
                       'exp(',num2str(PhaseVDeg,'% 3.4g'),'j)'])
            
Recall that the MATLAB complex exponential function operates on values in radians, not degrees. The code produces the following results, which agree with the solution shown above:

              V1 =
                7.0711 - 7.0711i
              V2 =
                4.3301 + 2.5000i
              V=
                11.4012 - 4.5711i
              V = 12.28 exp(-21.85j)
            

■

 











Exercise 8-3



                (a) Construct the phasors for the following signals:
                





                (b) Use the additive property to find
                i
                (
                t
                ) =
                i
1
                (
                t
                ) +
                i
2
                (
                t
                ) and plot the three phasors on the same graph.
              
(c) Check the results using MATLAB.

Answers:


                (a) See
                Figure 8-4
                .
                I
1
                = 100 mA,
                I
2
                =25 -
                j
                43.30 mA
              

                (b) See I in
                Figure 8-4
                .
              

                (c)
                I
                = 125 -
                j
                43.3 = 132∠ - 191° mA, so
                i
                (
                t
                ) = 132 cos(2000
                t -
                191°) mA
              











FIGURE 8-4


















EXAMPLE 8-2



                    (a) Construct the phasors representing the following signals:
                    



(b) Use the additive property of phasors and the phasors found in (a) to find the sum of these waveforms.




SOLUTION:




                  (a) The phasor representations of the three sinusoidal currents are:
                  




                  (b) The currents have the same frequency, so the additive property of phasors applies. The phasor representing the sum of these currents is
                  













Figure 8-5








              It is not obvious by examining the waveforms that these three currents add to zero. However, the phasor diagram in
              Figure 8-5
              makes this fact clear, since the sum of any two phasors is equal and opposite to the third. Phasors of this type occur in balanced three-phase power systems. The balanced condition occurs when three equal-amplitude phasors are displaced in phase by exactly 120. You can study these in
              Chapter 16
              .
              ■










Exercise 8-4


              Show that the phasors
              I
A
              ,
              I
B
              , and
              I
C
              would still sum to zero if they were all rotated 90° counterclockwise.
            
Answers:


















EXAMPLE 8-3


                  Use the derivative property of phasors to find the time derivative of
                  υ
                  (
                  t
                  ) = 15 cos(200
                  t
                  - 30°) V.
                



SOLUTION:




                The phasor for the sinusoid is
                V
                = 15∠ - 30°. According to the derivative property, the phasor representing
                dυ/dt
                is found by multiplying
                V
                by
                j
                ω.
              




                The sinusoid corresponding to the phasor
                j
                ω
                V
                is
              




                Finding the derivative of a sinusoid is easily carried out in phasor form, since it only involves manipulating complex numbers.
                ■












Exercise 8-5

Find the phasor corresponding to the time derivative of the waveform:





Answers:





















EXAMPLE 8-4




                    (a) Convert the following phasors into sinusoidal waveforms:
                    




                    (b) Use phasor addition to find the sinusoidal waveform
                    υ
3
                    (
                    t
                    ) =
                    υ
1
                    (
                    t
                    ) +
                    υ
2
                    (
                    t
                    ).
                  

                    (c) Take the time derivative of
                    υ
3
                    (
                    t
                    ).
                  




SOLUTION:




                  (a) Since
                  V
1
                  =20 +
                  j
                  20 =
                  
                  , the waveforms corresponding to the phasors
                  V
1
                  and
                  V
2
                  are as follows:
                  




                  (b) Since V
                  2
                  =
                  
                  =10 -
                  j
                  10, the additive property of phasors yields
                  


Hence,




                    The graphical solution is shown in
                    Figure 8-6
                    .
                  


                  (c)
                  

                    So
                    υ
3
                    (
                    t
                    ) = 15.8 cos (500
                    t
                    + 108.4°) kV
                  











FIGURE 8-6








■

 










Exercise 8-6



              Find the phasor corresponding to the waveform
              υ
              (
              t
              ) =
              V
A
              cos(ω
              t
              ) +2
              V
A
              sin(ω
              t
              ).
            


Answer:









8-2 Phasor Circuit Analysis


          Phasor circuit analysis is a method of finding sinusoidal steady-state responses directly from the circuit without using differential equations. How do we perform phasor circuit analysis? At several points in our study, we have seen that circuit analysis is based on two kinds of constraints: (1) connection constraints (Kirchhoff's laws) and (2) device constraints (element equations). We will use these basic constraints to analyze phasor circuits, but first we must see how these constraints are expressed in phasor form.
        
Connection Constraints in Phasor Form
The sinusoidal steady-state condition is reached after the circuit's natural response decays to zero. In the steady state, all of the voltages and currents are sinusoids with the same frequency as the driving force. Under these conditions, the application of KVL around a loop could take the form



These sinusoids have the same frequency but have different amplitudes and phase angles. The additive property of phasors discussed in the preceding section shows that there is a one-to-one correspondence between waveform sums and phasor sums. Therefore, if the sum of the waveforms is zero, then the corresponding phasors must also sum to zero.



Clearly the same result applies to phasor currents and KCL. In other words, we can state Kirchhoff's laws in phasor form as follows:



KVL: The algebraic sum of phasor voltages around a loop is zero.






KCL: The algebraic sum of phasor currents at a node is zero.



Device Constraints in Phasor Form

          Turning now to the device constraints, we note that the
          i-υ
          characteristics of the three passive elements are:
        



(8-12)





          In the sinusoidal steady state, all of these currents and voltages are sinusoids. Given that the signals are sinusoid, how do these
          i-υ
          relationships constrain the corresponding phasors?
        
Resistor

          In the sinusoidal steady state, the voltage and current of the resistor can be written in terms of phasors as
          υ
R
          (
          t
          ) = Re{V
          R

            e
            j


            ω
            t

          } and
          i
R
          (
          t
          ) =Re{I
          R

            e
            j


            ω
            t

          }. Consequently, the resistor
          i-υ
          relationship in
          Eq. (8-12)
          can be expressed in terms of phasors as follows:
        




          Since
          R
          is a real constant, moving it inside the real part operation on the right side of this equation does not change things:
        





          This relationship holds only if the phasor voltage and current for a resistor are related as
        



(8-13)





          To explore this relationship, we assume that the current through a resistor is
          i
R
          (
          t
          ) =
          I
A
          cos(ω
          t +
          ϕ). Then the phasor current is
          I
R
          =
          I
A

            e
            j

ϕ
          , and according to
          Eq. (8-13)
          , the phasor voltage across the resistor is
        




          This result shows that the voltage has the same phase angle (ϕ) as the current. Phasors with the same phase angle are said to be
          in phase;
          otherwise, they are said to
          be out of phase.
Figure 8-7
          shows the phasor diagram of the resistor current and voltage. Two scale factors are needed to construct a phasor diagram showing both voltage and current, since the two phasors do not have the same dimensions.
        








FIGURE 8-7



Phasor i-υ characteristics of the resistor.




Inductor

          In the sinusoidal steady state, the voltage and current for the inductor can be written in terms of phasors as
          υ
L
          (t) = Re{V
          L

            e
            j


            ω
            t

          } and
          i
L
          (
          t
          ) =Re{
          I
L

            e
            j


            ω
            t

          }. Using the derivative property of phasors, the inductor
          i-υ
          relationship in
          Eq. (8-12)
          can be expressed as follows:
        




          Since
          L
          is a real constant, moving it inside the real part operation does not change things. Written this way, we see that the phasor voltage and current for an inductor are related as
        



(8-14)





          When the current is
          i
L
          (
          t
          ) =
          I
A
          cos(ω
          t
          + ϕ), the corresponding phasor is I
          L
          =
          I
A

            e
            j

ϕ
          and the
          i-υ
          constraint in
          Eq. (8-14)
          yields
        




          The resulting phasor diagram in
          Figure 8-8
          shows that the inductor voltage and current are 90° out of phase. The voltage phasor is advanced by 90° counterclockwise, which is in the direction of rotation of the complex exponential
          
            e
            j


            ω
            t

          . When the voltage phasor is advanced counterclockwise (that is, ahead of the rotating current phasor), we say that the voltage phasor
          leads
          the current phasor by 90° or, equivalently, the current
          lags
          the voltage by 90°.
        








FIGURE 8-8



Phasor i-υ characteristics ofthe inductor.




Capacitor

          Finally, the capacitor voltage and current in the sinusoidal steady state can be written in terms of phasors as
          υ
C
          (
          t
          ) =Re{
          V
C

            e
            j


            ω
            t

          } and
          i
C
          (
          t
          ) = Re{
          I
C

            e
            j


            ω
            t

          }. Using the derivative property of phasors, the
          i-υ
          relationship of the capacitor in
          Eq. (8-12)
          becomes
        




          Moving the real constant
          C
          inside the real part operation does not change the final result, so we conclude that the phasor voltage and current for a capacitor are related as
        








FIGURE 8-9



Phasor i-υ characteristics of the capacitor.






          Solving for
          V
C
          yields
        



(8-15)





          When
          i
C
          (
          t
          ) =
          I
A
          cos(ω
          t
          + ϕ), then according to
          Eq. (8-15)
          , the phasor voltage across the capacitor is
        




          The resulting phasor diagram in
          Figure 8-9
          shows that voltage and current are 90° out of phase. In this case, the voltage phasor is retarded by 90° clockwise, which is in a direction opposite to rotation of the complex exponential e
          
j
            ω
            t

          . When the voltage is retarded clockwise (that is, behind the rotating current phasor), we say that the voltage phasor
          lags
          the current phasor by 90° or, equivalently, the current
          leads
          the voltage by 90°.
        
The Impedance Concept

          The phasor
          I - V
          constraints in
          Eqs. (8-13)
          ,
          (8-14)
          , and
          (8-15)
          are all of the form
        



(8-16)





          where
          Z
          is called the impedance of the element. Equation (8-16) is analogous to Ohm's law in resistive circuits.
          Impedance
          is the proportionality constant relating phasor voltage and phasor current in linear two-terminal elements. The impedances of the three passive elements are given as follows:
        


(8-17)




          Since impedance relates phasor voltage to phasor current, it is a complex quantity whose units are ohms.
          
Although impedance can be a complex number, it is not a phasor.

          Phasors represent sinusoidal signals, while impedances characterize circuit elements in the sinusoidal steady state. Finally, it is important to remember that the generalized two-terminal device constraint in
          Eq. (8-16)
          assumes that the passive sign convention is used to assign the reference marks to the voltage and current.
        

          Even though impedance,
          Z
          , can be real, imaginary, or complex, its units are always ohms, Ω. The circuit symbol for a resistor
          
          can also be used to represent impedance. In this case, the value assigned to the symbol can look like:
          R
          ±
          jX, |Z|
          ∠ϕ, 100 -
          j
          50, 1500∠75°, or a myriad other complex impedance representations. For example, with ω = 1 rad/s, a 100-mH inductor can be shown using the impedance symbol as 0.1∠90°,0 +
          j
          0.1, or simply
          j
          0.1 Ω, a 1-kΩ resistor as 1000 +
          j
          0, 1000∠0°,or 1 kΩ, and a 1-μF capacitor as 0 -
          j
          10
          -6
          , 10
          -6
          ∠ -90°, or just -
          j
          10
          -6
          Ω.
        








FIGURE 8-10



Magnitude of the impedance of passive circuit elements versus frequency. Basic concept of resonance
                ω
                0
occurs when
                |Z
                L
                | = |Z
                C
                |.
              



Effects of Frequency on Impedance

          It is important to stop and reflect on what the concept of impedance means to us. The behavior of these three elements versus frequency is a fundamental concept of electrical engineering.
          Figure 8-10
          shows a plot of the magnitude of the impedance |
          Z|
          of each of the three circuit elements versus frequency ω.
        


          The magnitude of the impedance of the resistor |
          Z
R
          | is unaffected by frequency. It is simply R, the resistor's resistance. It plots as a horizontal line on the figure. The magnitude of the impedance of an inductor is a function of frequency, |
          Z
L
          | = ω
          L
          . At dc, when nothing is changing, an inductor behaves like a short circuit (i.e., zero ohms); we saw this in
          Chapter 6
          , where we discussed dc equivalent circuits and modeled an inductor when nothing was changing — that is, ω = 0 — as a short circuit. We made use of this substitution in
          Chapter 7
          when we analyzed first-order
          RL
          circuits excited by a step function. However, as the frequency exciting the inductor begins to increase, the impedance of the inductor increases linearly with the frequency. The magnitude, then, appears as an increasing straight line on the graph. As the frequency approaches infinity, the nature of the inductor morphs into an open circuit of infinite ohms.
        

          The impedance of a capacitor, however, exhibits behavior quite different from that of either a resistor or an inductor. The magnitude of the impedance of a capacitor is an inverse function of frequency, |Z
          C
          | = 1/ω
          C
          . At dc, when nothing is changing or ω = 0, the capacitor behaves like an open circuit (i.e., ∞ Ω); again, we saw this in
          Chapter 6
          , where we discussed dc equivalent circuits and used it in
          Chapter 7
          when analyzing
          RC
          circuits excited by a step function. However, as the frequency begins to increase, the impedance of the capacitor decreases inversely with the frequency. The magnitude, then, appears as a hyperbola on the graph. As the frequency approaches infinity, the nature of the capacitor completely changes into a short circuit of zero ohms. This opposing behavior of inductors and capacitors is what permits the realization of so many different circuits.
        

          From the graph in
          Figure 8-10
          , we can see that there is a frequency, ω
          0
          , where the magnitude of the impedance of the inductor equals that of the capacitor. This frequency is called the
          resonant frequency,
          and it is an important property of circuits in the sinusoidal steady state that we can use to our advantage. As we progress in our study of circuits, we will learn how to use these divergent properties to analyze, design, and evaluate ac circuits.
        













EXAMPLE 8-5



                  The circuit in
                  Figure 8-11
                  (a) is operating in the sinusoidal steady state with
                  i
                  (
                  t
                  ) = 4 cos(5000
                  t
                  ) A. Find the steady-state voltage
                  υ
                  (
                  t
                  ) by hand and by using Multisim.
                









FIGURE 8-11









SOLUTION:


We will solve the problem first by hand.

                Our first step is to convert our circuit from the time-domain shown in
                Figure 8-11
                (a) into phasors. We proceed as follows. The resistor and the capacitor have impedances
              





                Applying KCL at node A shows that
                i
                (
                t
                ) = 4 cos(5000
                t
                ) is the current through both the resistor and the capacitor. The corresponding phasor current is
                I
                = 4+
                j
                0. Using the element impedances, the phasor voltages across the resistor and the capacitor are
              




                We can redraw our circuit using phasors as shown in
                Figure 8-11
                (b).
              

                Applying KVL around the loop yields
                V
                =
                V
R
                +
                V
C
                ; hence,
              



and the steady-state voltage waveform is











FIGURE 8-11








                Next we will solve the problem using Multisim. Since we do not know what is to the left of the circuit, only that the current is given, we can build our circuit in Multisim using the ac current source. Note that Multisim requires that the frequency be stated in hertz; hence, 5000 rad/s equals 795.77 Hz. We will build the rest of the circuit as usual, as shown in
                Figure 8-11
                (c). Since we are only interested in the steady-state result, we can ignore any initial condition on the capacitor. To simulate the response, we open "Analyses" and select "Single frequency AC analysis." In the window that opens, we list the frequency in Hz, that is, 795.77. Check the "Frequency column" box so that the frequency is listed in the output, and, since we want to be able to write our answer in magnitude and phase, select that type of output for the "Complex number format." We are interested in the voltage
                υ
                (
                t
                ) across the input to the two-element load. We identify the input node on the circuit diagram, "1" in our circuit, and ask Multisim to provide that voltage output "V(1)." Then click on "Simulate." Grapher View returns the result shown in
                Figure 8-11
                (d). From the results, we can quickly write the desired expression for
                υ
                (
                t
                ).
              




■

 













Exercise 8-7


A series circuit is composed of a 1-kΩ resistor, a 1-µF capacitor, and a 100-mH inductor.

(a) At what frequency will the magnitude of the impedance of the inductor equal that of the resistor?
(b) At what frequency will the magnitude of the impedance of the capacitor equal that of the resistor?
(c) At what frequency will the magnitude of the impedance of the inductor equal the magnitude of the impedance of the capacitor? What is the frequency called?

                (d) In Multisim construct the series circuit and drive it with a 1-V peak sinusoidal voltage source. Using the AC Sweep analysis option, sweep the frequency from 1 Hz to 1 MHz. Under "Output," create expressions for
                Z
R
                ,
                Z
L
                , and
                Z
C
                by dividing the voltage across each element by the current through that element. Run the sweep. Grapher View will
                
                display the results in two graphs. Delete the phase graph by clicking on it and selecting "delete graph." On the magnitude graph, using the cursors find where the amplitudes |
                Z
R
                | = |Z
                L
                |, |
                Z
R
                | = |
                Z
C
                |, and |
                Z
L
                | = |Z
                C
                |. Recall that Multisim displays cyclic not radian frequency. You should use the magnify function to obtain an accurate measure of the frequency. Do your answers match those calculated by hand?
              

Answers:


                (a) |
                Z
L
                | = |
                Z
R
                | when ω = 10 krad/s.
              

                (b) |
                Z
C
                | = |
                Z
R
                | when ω = 1 krad/s.
              

                (c) |
                Z
L
                | = |
                Z
C
                | when ω = 3.162 krad/s. The resonant frequency.
              

                (d) Yes: |
                Z
R
                | = |
                Z
L
                | at 10,005 rad/s, |
                Z
R
                | = |
                Z
C
                | at 999.33, and |
                Z
L
                | = |
                Z
C
                | at 3161.6 rad/s. See
                Figure 8-12
                .
              









FIGURE 8-12

















Exercise 8-8

An element in a circuit operating in the sinusoidal steady state has a voltage across it and a current through it as follows:



Find the impedance of the element. Model the impedance as a series connection of two elements.


Answer:



Z
              = 625 +
              j
              10.8 Ω. A 6.25 Ω resistor in series with a 21.7 mH inductor.
            











Exercise 8-9



              A series connection consists of a 12-mH inductor and a 20-pF capacitor. The current flowing through the circuit is
              i
L
              (
              t
              ) = 20 cos(10
              6
t
              ) mA.
            

(a) Find the impedance of each element.
(b) Find the phasor voltage across each element.
(c) Using hand calculations, find the voltages across each element.
(d) Does the current in the inductor lead or lag the voltage across it?
(e) Does the current in the capacitor lead or lag the voltage across it?



              Answers:
            


                (a)
                Z
L
                =
                j
                12 kΩ, Z
                C
                = -
                j
                50 kΩ
              

                (b)
                V
L
                = 240∠90°V,
                V
C
                = 1000∠ - 90° V
              

                (c)
                υ
L
                (
                t
                ) = 240 cos(10
                6
t
                + 90°)V,
                υ
C
                (
                t
                ) = 1 cos(10
                6
t-
                90°)kV.
              
(d) The current lags the voltage in the inductor by 90°.
(e) The current leads the voltage in the capacitor by 90°.





8-3 Basic Phasor Circuit Analysis and Design

          Functions of time like
          υ
          (
          t
          ) =
          V
A
          cos(ω
          t
          + ϕ
          v
          ) and
          i
          (
          t
          ) =
          I
A
          cos(ω
          t
          + ϕ
          I
          ) are time-domain representations of sinusoidal signals. Producing the corresponding phasors can be thought of as a transformation that carries
          υ
          (
          t
          ) and
          i
          (
          t
          ) into a complex-number domain where signals are represented as phasors
          V
          and
          I
          . We call this complex-number domain as the
          phasor domain.
          When we analyze circuits in this phasor domain, we obtain sinusoidal steady-state responses in terms of phasors like V and
          I.
          Performing the inverse phasor transformation as
          υ
          (
          t
          ) = Re{
          V

            e
            j


            ω
            t

          } and
          i
          (
          t
          ) =Re{
          I

            e
            j


            ω
            t

          } carries the responses back into the time domain. To perform ac circuit analysis in this way, we obviously need to develop methods of analyzing circuits in the phasor domain.
        

          In the preceding section, we showed that KVL and KCL apply in the phasor domain and that the phasor element constraints all have the form
          V
          = Z
          I
          . These element and connection constraints have the same format as the underlying constraints for resistance circuit analysis as developed in
          Chapters 2
          -
          4
          . Therefore, familiar algebraic circuit analysis tools, such as series and parallel equivalence, voltage and current division, proportionality and superposition, and Thévenin and Norton equivalent circuits, are applicable in the phasor domain. In other words, we do not need new analysis techniques to handle circuits in the phasor domain. The only difference is that circuit responses are phasors (complex numbers) rather than dc signals (real numbers).
        








FIGURE 8-13



Flow diagram for phasor circuit analysis.





          We can think of phasor-domain circuit analysis in terms of the flow diagram in
          Figure 8-13
          . The analysis begins in the time domain with a linear circuit operating in the sinusoidal steady state and involves three major steps:
        



STEP 1

The circuit is transformed into the phasor domain by representing the input and response sinusoids as phasors and the passive circuit elements by their impedances.



STEP 2

Standard algebraic circuit analysis techniques are applied to solve the phasor-domain circuit for the desired unknown phasor responses.



STEP 3

The phasor responses are inverse transformed back into time-domain sinusoids to obtain the response waveforms.


The third step assumes that the required end product is a time-domain waveform. However, a phasor is just another representation of a sinusoid. With some experience, we learn to think of the response as a phasor without converting it back into a time-domain waveform.

Figure 8-13
          points out that there is another route to time-domain response using the classical differential equation method when dealing with sinusoidal inputs from
          Chapter 7
          . However, the phasor-domain method works directly with the circuit model and is far simpler. More important, phasor-domain analysis provides
          
          insights into ac circuit analysis that are essential to understanding much of the terminology and viewpoint of electrical engineering.
        








FIGURE 8-14



A series connection of impedances.




Series Equivalence and Voltage Division

          We begin the study of phasor-domain analysis with two basic analysis tools—series equivalence and voltage division. In
          Figure 8-14
          , the two-terminal elements are connected in series, so by KCL, the same phasor current
          I
          exists in impedances
          Z
1
          ,Z
          2
          , ...,
          
            Z
            N

          . Using KVL and the element constraints, the voltage across the series connection can be written as
        



(8-18)




The last line in this equation points out that the phasor responses V and I do not change when the series connected elements are replaced by an equivalent impedance:



(8-19)





          In general, the equivalent impedance
          Z
EQ
          is a complex quantity of the form
        




          where
          R
          is the real part and
          X
          is the imaginary part. The real part of
          Z
          is called
          resistance
          and the imaginary part (
          X
          , not
          jX
          ) is called
          reactance
          . Both resistance and reactance are expressed in ohms (Ω), and both can be functions of frequency (ω). For passive circuits, resistance is always positive, whereas reactance
          X
          can be either positive or negative. A positive
          X
          is called an
          inductive
          reactance because the reactance of an inductor is ω
          L
          , which is always positive. A negative
          X
          is called a
          capacitive
          reactance because the reactance of a capacitor is -1/ω
          C
          , which is always negative.
        

          Combining
          Eqs. (8-18)
          and
          (8-19)
          , we can write the phasor voltage across the
          k
          th element in the series connection as
        



(8-20)





Equation (8-20)
          is the phasor version of the voltage division principle. The phasor voltage across any element in a series connection is equal to the ratio of its impedance to the equivalent impedance of the connection times the total phasor voltage across the connection.
        








FIGURE 8-15




















EXAMPLE 8-6



                  The circuit in
                  Figure 8-15
                  (a) is operating in the sinusoidal steady state with
                  υ
S
                  (
                  t
                  ) = 35 cos 1000t V.
                

(a) Transform the circuit into the phasor domain.

                    (b) Solve for the phasor current
                    I
                    .
                  
(c) Solve for the phasor voltage across each element.
(d) Find the waveforms corresponding to the phasors found in (b) and (c).
(e) Repeat (b) and (c) using Multisim.





SOLUTION:




                  (a) The phasor representing the input source voltage is
                  V
S
                  = 35∠0° V. The impedances of the three passive elements are given as follows:
                  



                    Using these results, we obtain the phasor-domain circuit in
                    Figure 8-15
                    (b).
                  


                  (b) The equivalent impedance of the series connection is
                  


The current in the series circuit is





                  (c) The current
                  I
                  exists in all three series elements, so the voltage across each passive element is
                  


Note that the voltage across the resistor is in phase with the current, the voltage across the inductor leads the current by 90°, and the voltage across the capacitor lags the current by 90°.


                  (d) The sinusoidal steady-state waveforms corresponding to the phasors in (b) and (c) are given as follows:
                  










FIGURE 8-15









                  (e) The Multisim solution is shown in
                  Figure 8-15
                  (c).
                


■

 













Exercise 8-10



              The circuit in
              Figure 8-15
              (a) is operating in the sinusoidal steady state with
              υ
S
              (
              t
              )= 100 cos(2000
              t
              - 45°) V.
            

(a) Transform the circuit into the phasor domain.

                (b) Solve for the phasor current
                I
                .
              
(c) Solve for the phasor voltage across each element.
(d) Find the waveforms corresponding to the phasors found in (b) and (c).
(e) Draw a phasor diagram of all three voltages and the current.

Answers:


                (a) See
                Figure 8-15
                (d).
              
(b) I = 2∠ - 45° A

                (c)
                V
R
                = 100∠ - 45° V
                
                      
                  V
L
                  = 100∠ + 45° V
                

                      
                  V
C
                  = 100∠ - 135° V
                


                (d)
                i
                (
                t
                ) = 2 cos(2000
                t
                - 45°) A
                
                      
                  υ
R
                  (
                  t
                  ) = 100 cos(2000
                  t
                  - 45°) V
                

                      
                  υ
L
                  (
                  t
                  ) = 100 cos(2000
                  t
                  + 45°) V
                

                      
                  υ
C
                  (
                  t
                  ) = 100 cos(2000
                  t
                  - 135°) V
                


                (e) See
                Figure 8-15
                (e).
              









FIGURE 8-15























                  DESIGN EXAMPLE 8-7
                

                  Design the voltage divider in
                  Figure 8-16
                  (a) so that an input υ
                  S
                  = 15 cos 2000
                  t
                  V produces a steady-state output υ
                  O
                  (
                  t
                  ) = 2 sin 2000
                  t
                  V.
                








FIGURE 8-16








SOLUTION:


Using voltage division, we can relate the input and output phasors as follows:




                The phasor representation of the input voltage is
                V
S
                = 15∠0° = 15+
                j
                0. Using the identity cos(
                x
                - 90°) = sin
                x
                , we write the required output phasor as
                V
O
                = 2∠ - 90° = 0 -
                j
                2. The design problem is to select the impedances
                Z
1
                and
                Z
2
                so that
              




                Solving this design constraint for
                Z
1
                yields
              










FIGURE 8-16







                Evidently, we can choose
                Z
2
                and then solve for
                Z
1
                . In making this choice, we must keep some physical realizability conditions in mind. In general, an impedance has the form
                Z
                =
                R
                +
                jX
                . The reactance
                X
                can be either positive (an inductor) or negative (a capacitor), but the resistance
                R
                must be positive. With these constraints in mind, we select
                Z
2
                = -
                j
                1000 (a capacitor) and solve for
                Z
1
                = 7500 +
                j
                1000 (a resistor in series with an inductor).
                Figure 8-16
                (b) shows the resulting phasor circuit. To find the
                
                values of
                L
                and
                C
                , we note that the input is
                υ
S
                = 15 cos 2000
                t
                ; hence, the frequency is ω = 2000. The inductive reactance ω
                L
                = 1000 requires
                L
                = 05 H, whereas the capacitive reactance requires - (ω
                C
                )
                -1
                = - 1000 or
                C
                = 05 μF. Other possible designs are obtained by selecting different values of
                Z
2
                . To be physically realizable, the selected value of Z
                2
                must produce
                R
                ≥ 0 for
                Z
1
                and
                Z
2
                .
              












              Design Exercise 8-11
            

              Design the voltage divider in
              Figure 8-16
              (a) so that an input
              υ
S
              (
              t
              ) = 50 cos(2000
              t
              ) V produces an output
              υ
O
              (
              t
              ) = 25 cos(2000
              t
              - 30°) V.
            


Answer:



              We first find the relationship between
              Z
1
              and
              Z
2
              that will result in the desired output. Using the voltage-divider relationship as shown in the prior example, we find that
            




              We can now select a reasonable value for Z
              2
              , such as 1 kΩ. If we choose a larger value, we will need a larger inductor that tends to be heavier, physically larger, and more expensive. A smaller value and our resistors will be smaller and draw more current, hence use more power. Since no other constraint was stated, we will use the 1-kΩ resistor. This will yield a Z
              1
              of 732 +
              j
              1000 Ω, which consists of a 732-Ω resistor in series with a 0.5-H inductor. This solution is shown in
              Figure 8-16
              (c). Of course, there are many other possible solutions, for example, assume you wanted a smaller inductor and a larger resistor. In this case, we can select
              Z
2
              = 1000 -
              j
              1000 Ω, a resistor, and a capacitor in series. The result will be the circuit of
              Figure 8-16
              (d), where we have reduced the inductor by a factor of 0.27 and increased the resistance by about 2.4 times.
            








FIGURE 8-16


















              Design
              Exercise 8-12


              The circuit shown in
              Figure 8-17
              (a) is operating in the sinusoidal steady state at a frequency of 100 krad/s. It requires a load of Z
              L
              = 1500∠ - 57.5° Ω to operate properly. Design the load using standard parts (see
              Appendix G
              ) to within ±5% of the desired values.
            








FIGURE 8-17









Answer:



              The load requires an 806-Ω resistor and a 7910-pF capacitor. See
              Figure 8-17
              (b) for the closest standard values.
            










              APPLICATION
              EXAMPLE 8-8


              The purpose of the impedance bridge in
              Figure 8-18
              is to measure the unknown impedance
              Z
X
              by adjusting known impedances
              Z
1
              ,
              Z
2
              , and
              Z
3
              until the detector voltage
              V
DET
              is zero. The circuit consists of a sinusoidal source
              V
S
              driving two voltage
              
              dividers connected in parallel. Using the voltage division principle, we find that the detector voltage is
            




              This equation shows that the detector voltage will be zero when
              Z
2
Z
3
              =
              Z
1
Z
X
              . When the branch impedances are adjusted so that the detector voltage is zero, the unknown impedance can be written in terms of the known impedances as follows:
            











FIGURE 8-18



Impedance bridge.





              This equation is called the bridge balance condition. Since the equality involves complex quantities, at least two of the known impedances must be adjustable to balance both the resistance
              R
X
              and the reactance
              X
X
              of the unknown impedance. In practice, bridges are designed assuming that the sign of the unknown reactance is known. Bridges that measure only positive reactance are called inductance bridges, whereas those that measure only negative reactance are called capacitance bridges.
            

              The Maxwell inductance bridge in
              Figure 8-19
              is used to measure the resistance
              R
X
              and inductance
              L
X
              of an inductive device by alternately adjusting resistances
              R
1
              and
              R
2
              to balance the bridge circuit. The impedances of the legs of this bridge are given as follows:
            











FIGURE 8-19



Maxwell bridge.





              For the Maxwell bridge, the balance condition
              Z
X
              =
              Z
2
Z
3
              /
              Z
1
              yields
            



Equating the real and imaginary parts on each side of this equation yields the parameters of the unknown impedance in terms of the known impedances:




              Note that adjusting
              R
1
              affects only
              R
X
              . The Maxwell bridge measures inductance by balancing the positive reactance of an unknown inductive device with a calibrated fraction of negative reactance of the known capacitor
              C
1
              . If the reactance of the unknown device is actually capacitive (negative), then the Maxwell bridge cannot be balanced.
            










Exercise 8-13



              Consider the Maxwell bridge shown in
              Figure 8-18
              . Suppose we know that the unknown impedance is an unknown capacitor
              C
X
              in parallel with an unknown resistance
              R
X
              . Let
              Z
1
              be a resistance
              R
1
              in series with an inductance
              L
1
              . Let
              Z
2
              be a resistance
              R
2
              and
              Z
3
              be a resistance
              R
3
              .
            

(a) Find the relationships that will allow the bridge to be balanced.

                (b) Suppose that
                R
1
                = 10 Ω,
                R
2
                =
                R
3
                = 10 kΩ, and
                L
1
                = 133 mH. Find
                C
X
                and
                R
X
                .
              

Answers:


                (a)
                R
X
                =
                


                (b)
                R
X
                = 10 ΜΩ
                C
X
                = 1330 pF
              



Parallel Equivalence and Current Division

          In
          Figure 8-20
          , the two-terminal elements are connected in parallel, so the same phasor voltage
          V
          appears across the impedances
          Z
1
          ,
          Z
2
          , ...,
          
            Z
            N

          . Using the phasor element constraints, the current through each impedance is
          I

k

          =
          V
          /
          
            Z
            k
            .
          
          Next, using KCL, the total current entering the parallel connection is
        








FIGURE 8-20



Parallel connection of impedances.







(8-21)




The same phasor responses V and I exist when the parallel connected elements are replaced by an equivalent impedance.


(8-22)




          These results can also be written in terms of
          admittance
Y
          , which is defined as the reciprocal of impedance:
        




          The real part of
          Y
          is called
          conductance
G
          and the imaginary part is called
          susceptance
B
          , both of which are expressed in units of siemens (S).
        

          Using admittances to rewrite
          Eq. (8-21)
          yields
        



(8-23)




Hence, the equivalent admittance of the parallel connection is



(8-24a)




We can write this in terms of equivalent impedance as



(8-24b)






          Combining
          Eqs. (8-23)
          and
          (8-24a)
          , we find that the phasor current through the
          k
          th element in the parallel connection using admittances is
        



(8-25a)





          Similarly, using
          Eq. (8-24b)
          , we can express the individual phasor currents in terms of impedances as
        



(8-25b)





Equations (8-25a)
          and
          (8-25b)
          are the phasor versions of the current division principle. The phasor current through any element in a parallel connection is equal to the ratio of its admittance to the equivalent admittance of the connection times the total phasor current entering the connection.
          Equation (8-25a)
          shows this in terms of admittances, whereas
          Eq. (8-25b)
          shows the same relationship in terms of impedances.
        



Note:


          In dealing with phasors, one finds that the concept of admittance is used more frequently than the concept of conductance is used in dc circuits. The reason is that resistors in dc circuits are rarely described in terms of their conductances, whereas ac circuits are often described in terms of their admittances. Hence, although we will emphasize impedances in this text, you should be aware that many phasor applications use admittances as useful circuit descriptors.
        











EXAMPLE 8-9


                  The circuit in
                  Figure 8-21
                  (a) is operating in the sinusoidal steady state with
                  i
S
                  (
                  t
                  ) = 50 cos 2000
                  t
                  mA.
                

(a) Transform the circuit into the phasor domain.

                    (b) Solve for the phasor voltage
                    V
                    .
                  
(c) Solve for the phasor current through each element.
(d) Find the waveforms corresponding to the phasors found in (b) and (c).
(e) Sketch a phasor diagram of the resulting phasors.










FIGURE 8-21









SOLUTION:




                  (a) The phasor representing the input source current is
                  I
S
                  = 0.05∠0° A. The impedances of the three passive elements are:
                  



                    Using these results, we obtain the phasor-domain circuit in
                    Figure 8-21
                    (b).
                  



                  (b) The admittances of the two parallel branches are:
                  


The equivalent admittance of the parallel connection is



and the voltage across the parallel circuit is











FIGURE 8-21









                  (c) The current through each parallel branch is
                  




                  (d) The sinusoidal steady-state waveforms corresponding to the phasors in (b) and (c) are:
                  




                  (e) The phasor diagram is shown in
                  Figure 8-21
                  (c).
                  ■













Exercise 8-14


              The circuit in
              Figure 8-21
              (a) is operating in the sinusoidal steady state with
              i
S
              (
              t
              ) = 100 cos(1000
              t
              - 45°) mA.
            

(a) Transform the circuit into the phasor domain.

                (b) Solve for the phasor voltage
                V.

(c) Solve for the phasor current through each element.
(d) Find the waveforms corresponding to the phasors found in (b) and (c).
(e) Sketch a phasor diagram of the resulting phasors.









FIGURE 8-21







Answers:


                (a) See
                Figure 8-21
                (d).
              

                (b)
                V
                = 100∠ - 45° V
              

                (c)
                I
R
                = 141.4∠ - 90° mA
              

                    
                I
L
                = 141.4∠ - 90° mA
              

                    
                I
C
                = 100∠ + 45° mA
              

                (d)
                υ
                (
                t
                ) = 100 cos(1000
                t -
                45°) V
                
                      
                  i
R
                  (
                  t
                  ) = 141.4 cos(1000
                  t
                  - 90°) mA
                

                      
                  i
L
                  (
                  t
                  ) = 141.4 cos(1000
                  t -
                  90°) mA
                

                      
                  i
C
                  (
                  t
                  ) = 100 cos(1000
                  t
                  + 45°) mA
                


                (e) The phasor diagram is shown in
                Figure 8-21
                (e).
              
















EXAMPLE 8-10




                Find the steady-state currents
                i
                (
                t
                ),
                i
C
                (
                t
                ), and
                i
R
                (
                t
                ) in the circuit of
                Figure 8-22
                for
                υ
S
                = 100 cos 2000
                t
                V,
                L
                = 250 mH,
                C
                = 05 μF, and
                R
                = 3 kΩ.
              










FIGURE 8-22









SOLUTION A

- Classical Approach:

The phasor representation of the input voltage is 100∠0°. The impedances of the passive elements are




Figure 8-23
            (a) shows the phasor-domain circuit.
          
To solve for the required phasor responses, we reduce the circuit using a combination of series and parallel equivalence. Using parallel equivalence, we find that the capacitor and resistor can be replaced by an equivalent impedance











FIGURE 8-23








            The resulting circuit reduction is shown in
            Figure 8-23
            (b). The equivalent impedance
            Z
EQ1
            is connected in series with the impedance
            Z
L
            =
            j
            500. This series combination can be replaced by an equivalent impedance
          




            This step reduces the circuit to the equivalent input impedance shown in
            Figure 8-23
            (c). The phasor input current in
            Figure 8-23
            (c) is
          




            Given the phasor current I, we use current division in
            Figure 8-23
            (a) to find
            I
C
            .
          




            By KCL,
            I
            =
            I
C
            +
            
              I
              R

            , so the remaining unknown current is
          



The waveforms corresponding to the phasor currents are




■




SOLUTION B

- Computer-Aided Approach:


            Multisim allows for simple solutions to phasor problems. Start by drawing the circuit as shown in
            Figure 8-24
            (a). There are two ac sinusoidal voltage sources available in Multisim. For this problem, the simplest one to use is the one listed under
            
            "SIGNAL_ VOLTAGE_SOURCES" as "AC_VOLTAGE" since it allows you to list the source's peak value. The "AC_POWER" source listed under "POWER_SOURCES" requires one to list the source's rms value. This source will be more useful in power applications. In both cases, the frequency must be specified and in hertz, so for this problem 2000 radians equals 318.3 Hz. Under "Analyses" select "Single Frequency AC Analysis." A new window opens and you enter the frequency desired for the analysis, which is 318.3 Hz in this case. Since we would like to see the frequency in our result, we check the box labeled "Frequency column." Select the "Magnitude/Phase" option for the "Complex number format," as shown in
            Figure 8-24
            (b), since we will need it to write our results in the desired format. Next go to the tab labeled "Output" and select the three desired currents. Note that if you select the source current I(V1), you will get the negative of the desired current
            i
            (
            t
            ) because Multisim used the passive sign convention. Instead choose I(L1), the inductor current, which is the same as the desired current. Now click on "Simulate," and Grapher View opens to display the desired results as shown in
            Figure 8-24
            (c). We added the source current so that the difference between it and the desired (inductor) current
            i
            (
            t
            ) can be readily seen.
          
Note that at node 1: I(V1) + I(L1) = 0. Hence, substituting 0.2∠-126.9° = -0.2∠53.1° = 1∠180° × 0.2∠53.1° = 0.2∠233.1° = 0.2∠-126.9° A.
By clicking on the Grapher View results, one can select the precision in the results to display. We chose "1" to match the classical approach. The answers provided are the same.








FIGURE 8-24








■

 











            Evaluation
            Exercise 8-15



              (a) Using the values in
              Example 8-10
              , find the voltages
              υ
L
              (
              t
              ),
              υ
C
              (
              t
              ), and
              υ
R
              (
              t
              ) across the three elements in the circuit shown in
              Figure 8-22
              .
            
(b) Explain how there can be voltages with amplitudes equal to or greater than the input voltage. Is KVL violated?



            Answers:
          


              (a)
              υ
L
              (
              t
              ) = 100 cos (2000
              t
              + 143.1°)V,
              υ
C
              (
              t
              ) = 189.6 cos (2000
              t
              - 18.4°) V,
              υ
R
              (
              t
              ) = 189.6 cos (2000
              t
              - 18.4°) V
            

              (b) Kirchhoff's rules are not violated. KVL shows that the voltages sum to exactly the input at all instances of times. Energy storage elements are constantly storing and delivering energy to the circuit with voltages that can be indeed greater than the input at times, but as one element delivers its energy, the other is absorbing it. To prove this quickly, simply create in Multisim two ac sources with the characteristics of a KVL loop around the outside of the circuit,
              υ
L
              (
              t
              ) and
              υ
R
              (
              t
              ). Connect them to a common ground and do a transient analysis adding the two sources together along with the input source (note the input is negative). The sum will be zero for all time. See
              Figure 8-24
              (d) and (e).
            









FIGURE 8-24

















            APPLICATION
            EXAMPLE 8-11

In general, the equivalent impedance seen at any pair of terminals can be written in rectangular form as


(8-26)




            In a passive circuit, the equivalent resistance
            R
EQ
            must always be nonnegative, that is,
            R
EQ
            ≥ 0. However, the equivalent reactance
            X
EQ
            can be either positive
            
            (inductive) or negative (capacitive). When inductance and capacitance are both present, their reactances may exactly cancel at certain frequencies. When
            X
EQ
            = 0, the impedance is purely resistive and the circuit is said to be in
            resonance.
            The frequency at which this occurs is called a
            resonant frequency,
            denoted by ω
            0
            .
          








FIGURE 8-25








            For example, suppose we want to find the resonant frequency of the circuit in
            Figure 8-25
            . We first find the equivalent impedance of the parallel resistor and capacitor:
          



This expression can be put into rectangular form by multiplying and dividing by the conjugate of the denominator:




            The impedance
            Z
RC
            is connected in series with the inductor. Therefore, the overall equivalent impedance
            Z
EQ
            is
          




            Note that the equivalent resistance
            R
EQ
            is positive for all ω. However, the equivalent reactance
            X
EQ
            can be positive or negative. The resonant frequency is found by setting the reactance to zero
          



and solving for the resonant frequency:


(8-27)




            Note the reactance
            X
EQ
            is inductive (positive) when ω > ω
            0
            and capacitive (negative) when ω < ω
            0
            .
          










Exercise 8-16


            The circuit in
            Figure 8-25
            is operating in the sinusoidal steady state. If
            R
            =1 kΩ
            ,L=
            200 mH, and
            C
            = 1 μF:
          

(a) Find the value of ω that will cause the circuit to be in resonance.

              (b) What will the value of
              Z
EQ
              be under those conditions?
            

Answers:

(a) ω = 2 krad/s

              (b) Z
              EQ
              = 200 +
              j
              0 Ω
            











FIGURE 8-26



















EXAMPLE 8-12



                The circuit in
                Figure 8-26
                is operating in the sinusoidal steady state with ω = 5 krad/s.
              


                  (a) Find the value of capacitance
                  C
                  that causes the input impedance
                  Z
                  to be purely resistive.
                

                  (b) Find the real part of the input impedance for this value of
                  C.





SOLUTION:





                (a) At the specified frequency, the impedance is
                


which can be written as




                  A purely resistive input impedance means that the imaginary part of
                  Z
                  is zero, which requires that
                




                  This quadratic has a double root at
                  C
                  = 2 × 10
                  -6
                  F.
                


                (b) For this value of capacitance, the real part of
                Z
                is
                



■

 














Exercise 8-17


            The circuit in
            Figure 8-25
            is operating in the sinusoidal steady state at ω = 1 krad/s. If
            R
            = 1
            k
            Ω
            , L
            = 200 mH, and
            C
            = 1 µF:
          


              (a) Find the value of
              Z
EQ
              classically under those conditions.
            

              (b) Repeat the problem using Multisim. (
              Hint:
              Drive the circuit with a 1-V ac signal source at 1 krad/s. The equivalent impedance will be found when doing the simulation by creating your own expression at the output using "Add expression" and adding the following to the "Selected variables for analysis" column: V(1)/I(L1).)
            



Answers:



            For both (a) and (b) Z
            EQ
            = 500 -
            j
            300 Ω
          















EXAMPLE 8-13


                A circuit is operating in the sinusoidal steady state with ω = 377 rad/s. A load
                Z
L
                of 327∠63.4° Ω is required to be connected to the circuit. It is desired that the load be made purely resistive by the addition of an appropriate reactance. Select the appropriate reactance using standard parts from
                Appendix G
                .
              



SOLUTION:


Since the load is given in magnitude and phase form, we will convert it to real and imaginary form. We can then see what the offsetting reactance needs to be



Setting magnitude and phase portions equal





              From the phase relationship, we find that
              X
              = 2R. Substituting that result into the magnitude equation,
            




              which yields
              R
              = 1462 Ω and
              X
              = 2R = 292.5 Ω.
            

              Therefore,
              Z
L
              = 146.2 +
              j
              292.5 Ω. In order to negate the reactance, we need to add a capacitive reactance of -
              j
              292.5 Ω in series with the load. At 377 rad/s, we find we need a capacitor of 9.1 μF. The nearest value shown in
              Appendix G
              is 10 μF. However, 9-µF capacitors can be found on-line from several suppliers.
              ■












Exercise 8-18


            The circuit in
            Figure 8-27
            (a) is operating at ω = 10 krad/s.
          


              (a) Find the equivalent impedance
              Z
              .
            

              (b) What element should be connected in series with
              Z
              to make the total reactance zero?
            

              (c) Use Multisim's Single Frequency AC Analysis to find the equivalent impedance.
              Hint:
              Use an ac voltage source set at the correct frequency. Then Z = V
              S
              /I.
            

Answers:


              (a)
              Z
              = 256 +
              j
              195 = 322∠37.3° Ω
            

              (b) A capacitor with
              C
              = 0513 μF
            

              (c) See Grapher View output,
              Figure 8-27
              (b).
            











FIGURE 8-27

















Exercise 8-19


            In
            Figure 8-28
υ
S
            (
            t
            ) = 12.5 cos 1000
            t
            V and
            i
S
            (
            t
            ) 0.2 cos(1000
            t
            - 36.9°) A. What is the impedance seen by the voltage source and what element is in the box?
          


Answer:



Z
            = 50 +
            j
            37.5 Ω and the element is a 37.5-mH inductor.
          








FIGURE 8-28






















                APPLICATION
                EXAMPLE 8-14


                Consider the
                RC
                circuit in
                Figure 8-29
                (a). Find a relationship for the ratio of the output voltage phasor to the input voltage phasor. Plot the magnitude of this ratio as a function of frequency and comment on the result.
              



SOLUTION:


The output voltage can be found using a voltage divider as follows:











FIGURE 8-29








              Studying this result one sees that this is a complex ratio and that the units of ω and
              
              are s
              -1
              or radians per second. The ratio has units of volts over volts, so it is nondimensional. We first find the magnitude of the ratio as follows:
            





              We can plot this ratio as a function of frequency by letting ω take on values from 0 to ∞. The following table shows a few salient points of the plot:
            




              The graph is shown in
              Figure 8-29
              (b).
            

              What one can see from the graph is that input signals with low frequencies appear across the capacitor relatively unscathed. High-frequency signals, on the other hand, have their amplitudes significantly reduced. This makes sense because as the frequency of the circuit increases, the capacitor's impedance becomes smaller. To preserve KVL, then, the voltage across the resistor must increase as the voltage across the capacitor decreases. This behavior is significant and is a characteristic of circuits called
              
filters.

              This simple
              RC
              configuration is called a
              low-pass filter
              because it passes low frequencies while blocking high ones. Since the curve is continuous, one might reasonably ask: When does the "pass" portion of the filter stop and where does the "stop" or block portion begin? For reasons that will be explained in later chapters, the boundary between the stop and pass regions of the filter is set at the frequency where the amplitude has decreased to 0.707 of its original value. This frequency is called the
              cutoff frequency
              and is indicated as ω
              
C

              . For this filter, it is when ω = ω
              
C

              = 1/
              RC
              rad/s. Filters are a major building block of electronics and are found in every type of application, from computers and communications to power and instrumentation.
            








FIGURE 8-29








■

 












            Design
            Exercise 8-20


            For the circuit of
            Figure 8-29
            (a), design a low-pass filter using standard parts from
            Appendix G
            so that the cutoff frequency is 1000 rad/s.
          


Answer:



            There are many solutions. One of them is
            R
            = 1 kΩ and
            C
            = 1 µF.
          










Exercise 8-21


            For the circuit of
            Figure 8-29
            (a), replace the capacitor with an inductor. (a) Find the ratio |
            V
L
            /
            V
S
            |, and (b) comment on its behavior as the frequency changes from 0 to ∞.
          
Answers:


              (a)
              


              (b) The circuit blocks signals with low frequencies and passes signals with high frequencies.
              
                It is known as a high-pass filter and its cutoff frequency is ω
                C
                =
                R/L
                rad/s.
              






8-4 Circuit Theorems with Phasors


        In this section, we treat basic properties of phasor circuits that parallel the resistance circuit theorems developed in
        Chapter 3
        . Circuit linearity is the foundation for all of these properties. The proportionality and superposition properties are two fundamental consequences of linearity.
      
Proportionality

        The
        proportionality
        property states that phasor output responses are proportional to the input phasor. Mathematically, proportionality means that
      


(8-28)




        where
        X
        is the input phasor
        I
        or
        V
        ,
        Y

1

        is the output phasor
        I
        or
        V
        , and
        K
        is the proportionality constant. In phasor circuit analysis, the proportionality constant is generally a complex number.
      

        The unit output method discussed in
        Chapter 3
        is based on the proportionality property and is applicable to phasors. To apply the unit output method in the phasor domain, we assume that the output is a unit phasor
        Y
        = 1∠0°. By successive application of KCL, KVL, and the element impedances, we solve for the input phasor required to produce the unit output. Because the circuit is linear, the proportionality constant relating input and output is
      




        Once we have the constant
        K,
        we can find the output for any input or the input required to produce any specified output.
      
The next example illustrates the unit output method for phasor circuits.











EXAMPLE 8-15


                Use the unit output method to find the input impedance, current
                I
1
                , output voltage
                V
C
                , and current
                I
3
                of the circuit in
                Figure 8-30
                (a) for
                V
S
                = 10∠0° V. Draw a block diagram for
                K.










FIGURE 8-30









SOLUTION:



              The following steps implement the unit output method for the circuit in
              Figure 8-30
              (a).
            


1.
                Assume a unit output voltage
                V
C
                = 1 +
                j
                0 V.
              

2.
                By Ohm's law,
                I
3
                =
                V
C
                /50 = 0.02 +
                j
                0 A.
              

3.
                By KVL,
                V
B
                =
                V
C
                + (
                j
                100)
                I
3
                = 1+
                j
                2 V.
              

4.
                By Ohm's law,
                I
2
                =
                V
B
                /(-
                j
                50) = - 0.04 +
                j
                0.02 A.
              

5.
                By KCL,
                I
1
                =
                I
2
                +
                I
3
                = - 0.02 +
                j
                0.02 A.
              

6.
                By KVL,
                V
S
                = (50 +
                j
                100)
                I
1
                +
                V
B
                = - 2 +
                j
                1 V.
              


              Given
              V
S
              and
              I
1
              , the input impedance is
            




              The proportionality factor between the input
              V
S
              and output voltage
              V
C
              is
            




              A block diagram is shown in
              Figure 8-30
              (b).
            








FIGURE 8-30









              Given
              K
              and Z
              IN
              , we can now calculate the required responses for an input
              V
S
              = 10∠0°:
            


■










FIGURE 8-31
















Exercise 8-22


            Use the unit output method to find the output current
            I
O
            in the circuit of
            Figure 8-31
            .
          


Answer:



K
            =
            I
O
/I
S
            = 0204∠ - 24.3, and therefore,
            I
O
            =1022 ∠ - 9.28°mA.
          


Superposition

        The superposition principle applies to phasor responses only if all of the independent sources driving the circuit have the
        same frequency
        . That is, when the input sources have the same frequency, we can find the phasor response due to each source acting alone and obtain the total response by adding the individual phasors. If the sources have different frequencies, then superposition can still be used but its application is different. With different frequency sources, each source must be treated in a separate steady-state analysis because the element impedances other than resistors, change with frequency. The phasor response for each source must be changed into waveforms and then superposition applied in the time domain. In other words, the superposition principle always applies in the time domain. It also applies in the phasor domain when all independent sources have the same frequency. The following examples illustrate both cases.
      













EXAMPLE 8-16



                Use superposition to find the steady-state voltage
                
                  v
                  R

                (
                t
                ) in
                Figure 8-32
                for
                R
                = 20 Ω,
                L
1
                =2 mH,
                L
2
                = 6 mH,
                C
                = 20 μF,
                υ
S1
                = 100 cos 5000
                t
                V, and
                υ
S2
                = 120 cos (5000
                t
                + 30°) V. Validate your answer using Multisim.
              









FIGURE 8-32









SOLUTION:



              In this example, the two sources operate at the same frequency.
              Figure 8-33
              (a) shows the phasor-domain circuit with source 2 turned off and replaced by a short circuit. The three elements in parallel in
              Figure 8-33
              (a) produce an equivalent impedance of
            











FIGURE 8-33









              By voltage division, the phasor response
              V
R1
              is
            




Figure 8-33
              (b) shows the phasor-domain circuit with source 1 turned off and source 2 on. The three elements in parallel in
              Figure 8-33
              (b) produce an equivalent impedance of
            




              By voltage division, the response
              V
R2
              is
            




              Since the sources have the same frequency, the total response can be found by adding the individual phasor responses
              V
R1
              and
              V
R2
              :
            



The time-domain function corresponding to the phasor sum is




              The overall response can also be obtained by adding the time-domain functions corresponding to the individual phasor responses
              V
R1
              and
              V
R2
              :
            




              You are encouraged to show that the two expressions for
              υ
R
              (
              t
              ) are equivalent using the additive property of sinusoids.
            

              Multisim is a useful tool for solving phasor superposition problems. To demonstrate the superposition principle, we will analyze the output of each source independently. Then we will ask Multisim to add the two results to obtain the desired output. Finally, we will let Multisim solve the problem with the two sources together. In
              Figure 8-33
              (c), we have drawn three circuits. Circuit C1 has υ
              S
1
              only, C2 has
              υ
S2

              only, and C3 has both sources.
            








FIGURE 8-33









              We draw each circuit using the ac signal source, not the ac power source. Since Multisim uses hertz as its operating frequency, we convert 5000 rad/s into 79577 Hz. Opening the source window, we enter both the amplitude and phase in two places for each source. Note that the second source needs to have a +30° phase shift to its signal. A small issue occurs in running Multisim. An inductor at dc, you might recall, is a short circuit. Multisim starts the analysis by doing a netlist check, and it cannot run the simulation because of the apparent impossible situation of a short across a voltage source. It returns a statement that it has a
              singular matrix
              error. Hence, to avoid this issue, a very small resistor (0.1 μΩ) is placed in series with either inductor. The resistor is too small to have any effect on the results. We do a "Single Frequency AC Analysis" and instruct Multisim to output "Magnitude/Phase" of the desired outputs, V(R1),V(R2), V(R1) +V(R2), and V(R). The results are shown in the Grapher View and compared closely with the hand calculations.
              ■












Exercise 8-23


            The two sources in
            Figure 8-34
            have the same frequency. Use superposition to find the phasor current
            I
X
            .
          


Answer:



            I
            X
            = 0.206∠ - 158°A
          










FIGURE 8-34



















EXAMPLE 8-17


                Use superposition to find the steady-state current
                i
                (
                t
                ) in
                Figure 8-35
                for
                R
                = 10 kΩ,
                L
                = 200 mH, υ
                S1
                = 24 cos 20,000
                t
                V, and
                υ
S2
                = 8 cos(60,000
                t
                + 30°) V. Comment on using Multisim to solve this problem.
              



SOLUTION:










FIGURE 8-35








              In this example, the two sources operate at different frequencies. With source 2 off, the input phasor is
              V
S1
              =24∠0° V at a frequency of ω = 20 krad/s. At this frequency, the equivalent impedance of the inductor and resistor is
            



The phasor current due to source 1 is




              With source 1 off and source 2 on, the input phasor
              V
S2
              =8∠30° V at a frequency of ω = 60 krad/s. At this frequency, the equivalent impedance of the inductor and resistor is
            



The phasor current due to source 2 is





              The two input sources operate at different frequencies, so the phasors' responses
              I
1
              and
              I
2
              cannot be added to obtain the overall response. In this case, the overall response is obtained by adding the corresponding time-domain functions.
            




■

 



Multisim cannot solve this problem using just one circuit simulation as it could if the frequencies were the same. However, it can be solved in two steps. We created two circuits each with one of the sources and the other source was replaced by a short circuit. We simulated each circuit using the "Single Frequency AC Analysis" run at the frequency of the one source in the circuit. We asked for magnitude and phase output of the inductor current (we could have just as easily asked for the resistor current). Grapher View returned the following:



From the Grapher View for each simulation, we wrote the individual waveform using the output results and the frequency of the source. The final result is their sum or



which is the same as that found by hand calculation above.








FIGURE 8-36













Exercise 8-24


            Use superposition to find the output voltage
            υ
O
            (
            t
            ) in the circuit of
            Figure 8-36
            if
            i
S
            (
            t
            ) = 100 cos(10,000
            t
            ) mA and
            υ
S
            (
            t
            ) = 20 cos(20,000
            t
            - 45°) V.
          


Answer:



υ
O
            (
            t
            ) = 7.07 cos(10k
            t
            - 45°) + 8.94 cos(20k
            t
            - 108.4°) V
          










FIGURE 8-37




















EVALUATION EXAMPLE 8-18


                The voltage source in
                Figure 8-37
                produces a 60-Hz sinusoid with a peak amplitude of 200 V plus a 180-Hz third harmonic with a peak amplitude of 10 V, that is,
                υ
S
                (
                t
                ) = 200 cos (2π 60
                t
                ) + 10 cos (2π 180
                t
                ) V. The purpose of the
                LC
                T-circuit is to reduce the relative size of the third-harmonic component delivered to the 100-Ω load resistor. Use MATLAB to calculate the voltage amplitudes across the load caused by the 60-Hz and the 180-Hz signals. For each frequency, determine the magnitude of the ratio of the output voltage to the input voltage. Is the circuit performing its task?
              









FIGURE 8-38









SOLUTION:



              We will do a small amount of circuit analysis and then rely on MATLAB to perform the necessary calculations for each input frequency.
              Figure 8-38
              shows the circuit in the phasor domain.
            

              We can use circuit reduction and voltage division to solve for the load voltage in the phasor domain. Let
              Z
EQ1
              be the equivalent impedance of inductor
              L
2
              and resistor
              R
L
              in series, and let
              Z
EQ2
              be the equivalent impedance of the capacitor in parallel
              
              with impedance
              Z
EQ1
              . We will first solve for
              Z
EQ1
              and
              Z
EQ2
              and then use voltage division to find the voltage across the capacitor. We can then apply voltage division a second time to find the load voltage for each frequency. Using the for command in MATLAB reduces the amount of code we have to write for this problem. The MATLAB code is follows:
            


            % Define the fixed parameters
            Rs = 1;
            L1 = 1;
            L2 = 1;
            C = 14e-6;
            RL = 100;
            % Create a list of frequencies to evaluate wList = 2*pi* [60 180];
            % List the input amplitudes and create vectors for results
            AList = [200 10];
            VList = zeros(size(wList));
            KList = zeros(size(wList));
            % Use a for loop to evaluate the response to each frequency
            for n = 1:length(wList)
               w = wList(n);
               A = AList(n);
               Zeq1 = j*w*L2 + RL;
               ZC = 1/(j*w*C);
               Zeq2 = Zeq1*ZC/(Zeq1+ZC);
               VA = Zeq2*A/(Rs + j*w*L1 + Zeq2);
               VList(n) = RL*VA/Zeq1;
               KList(n) = VList(n)/A;
            end
            % Display the results
            VList
            KList
            % Display the magnitudes of the results
            VListMag = abs(VList)
            KListMag = abs(KList)
          
The preceding code generates the following results:

            VList =
               1.0e+02 *
               -1.9969 - 0.0880i -0.0001 + 0.0006i
            KList =
               -0.9985 - 0.0440i -0.0005 + 0.0055i
            VListMag =
            199.8841 0.0553
            KListMag =
               0.9994 0.0055
          

            The amplitude of the 60-Hz component is virtually unchanged as it moves through the circuit, and its amplitude at the load is 99.94%ofits original value. The amplitude of the 180-Hz component is drastically reduced at the output, with a load amplitude less than 1% of its original value. This circuit is correctly filtering the higher-frequency component because the impedances of the capacitor and the inductors change with frequency
            ■











Exercise 8-25



            Analyze the sinusoidal steady-state behavior of the circuit shown in
            Figure 8-37
            in more detail. To do so, find the magnitude of the ratio of the output voltage to the input voltage for the range of frequencies from 1 Hz to 1 kHz. For simplicity, assume that the input signal always has a magnitude of 1 V. Examine at least 500 data points in the frequency range and space them logarithmically with the MATLAB command logspace. Plot the results in terms of magnitude versus frequency (in hertz) on log-log axes. Use the plot to verify the results in
            Example 8-18
            .
          


Answer:



            See
            Figure 8-39
            . The plot is consistent with the results presented in
            Example 8-18
            . We will cover filters with this type of response in
            Chapter 14
            .
          








FIGURE 8-39









Thévenin and Norton Equivalent Circuits

        In the phasor domain, a two-terminal circuit containing linear elements and sources can be replaced by the Thévenin or Norton equivalent circuits shown in
        Figure 8-40
        . The general concept of Thévenin's and Norton's theorems and their restrictions are the same as in the resistive circuit studied in
        Chapter 3
        . The important difference here is that the signals
        V
T
        ,
        I
N
        ,
        V
        , and
        I
        are phasors, and
        Z
T
        and
        Z
L
        are complex numbers representing the source and load impedances.
      
Finding the Thévenin or Norton equivalent of a phasor circuit involves the same process as for resistance circuits, except that now we must manipulate complex numbers. The Thévenin and Norton circuits are equivalent to each other, so their circuit parameters are related as follows:



(8-29)






        Algebraically, the results in
        Eq. (8-29)
        are identical to the corresponding equations for resistance circuits. The important difference is that these equations involve phasors and impedances rather than waveforms and resistances. These equations point out that we can determine a Thévenin or Norton equivalent by finding any two of the following quantities: (1) the open-circuit voltage
        V
OC
        , (2) the short-circuit current
        I
SC
        , and (when there are no dependent sources) (3) the impedance
        Z
T
        looking back into the source circuit with all independent sources turned off.
      

        The relationships in
        Eq. (8-29)
        define source transformations that allow us to convert a voltage source in series with an impedance into a current source in parallel with the same impedance, or vice versa. Phasor-domain
        source transformations
        simplify circuits and are useful in formulating general node-voltage or mesh-current equations, discussed in the next section.
      
The next two examples illustrate applications of source transformation and Thévenin equivalent circuits. We will follow those examples with three additional examples exploring these concepts.








FIGURE 8-40



Thévenin and Norton equivalent circuits in the phasor analysis.















EXAMPLE 8-19


                The Thévenin circuit in
                Figure 8-41
                (a) is operating in the phasor domain. If
                V
T
                = 120∠30° V and Z
                T
                = 100 -
                j
                50 Ω, perform a source transformation resulting in the Norton circuit of
                Figure 8-41
                (b).
              



SOLUTION:



              The source transformation is related through Ohm's law. Hence,
              I
N
              =
              V
T
              /
              Z
T
              , and the Norton impedance equals the Thévenin impedance.
            




■

 











FIGURE 8-41













Exercise 8-26


            The Norton circuit in
            Figure 8-41
            (b) has a current source
            I
N
            = 300 -
            j
            400 mA and a Norton impedance
            Z
N
            of 100 +
            j
            100 Ω. Find the equivalent Thévenin circuit.
          


Answers:



            V
            T
            = 70.7∠ - 8.13° V, Z
            T
            = 141∠45° Ω.
          
















                DESIGN EXAMPLE 8-20
              

                The circuit of
                Figure 8-42
                is in the phasor domain.
              


                  (a) Find the Thévenin equivalent circuit that the load
                  Z
L
                  sees. Then design a load
                  Z
L
                  so that 10∠-90° V are delivered across it.
                

                  (b) Convert the Thévenin circuit found in (a) into a Norton equivalent then design a load
                  Z
L
                  so that 10∠-90° V are delivered across it.
                










FIGURE 8-42









SOLUTION:




                (a) We calculate the Thévenin equivalent circuit by removing the load and looking into the open terminals, effectively looking across the capacitor. V
                T
                is found using a voltage divider and
                Z
T
                using the look-back method.
                




                  We reconnect the load and expand it as Z
                  L
                  =
                  R
L
                  +
                  jX
L
                  . Once again we use a voltage divider and solve for
                  R
L
                  and
                  X
L
                  . We set up the equation as follows:
                



Cross multiplying



Expanding the left side and collecting like terms, we get



The real and the imaginary parts must both be zero. Hence, we get two equations in two unknowns that we can solve simultaneously.




                  which results in
                  R
L
                  = 235.3 Ω and
                  X
L
                  = - 58.8 Ω. Our load, then, is
                  Z
L
                  = 235.3 -
                  j
                  58.8 Ω.
                


                (b)
                I
N
                = 50∠- 90° mA,
                Z
N
                = 500 +
                j
                500 Ω. Since the load does not know if it is connected to a Thévenin or a Norton equivalent circuit, it performs the same. Hence, the same
                Z
L
                is required to produce the same output,
                Z
L
                = 235.3-58.8 Ω.
                ■













Exercise 8-27


            Find the voltage
            V
A
            in
            Figure 8-42
            if
            Z
L
            is a short circuit.
          


Answers:



            With
            Z
L
            shorted, the capacitor and inductor are in parallel. The equivalent impedance of the combination is
            
            or an open circuit. Hence,
            V
A
            = 50∠0° V.
          

















EXAMPLE 8-21



                Both sources in
                Figure 8-43
                (a) operate at a frequency of ω = 5000 rad/s. Find the steady voltage
                υ
R
                (
                t
                ) by using a Thévenin transformation and superposition. Then validate your results using Multisim.
              



SOLUTION:



Example 8-16
              solves this problem using superposition. In this example, we use a Thévenin approach as well as superposition.
            








FIGURE 8-43









              We will start by finding the Thévenin equivalent circuit seen by the 20-Ω load. In
              Figure 8-43
              (b), we remove the 20-Ω load and set the second source to zero. With the second source replaced by a short circuit, the voltage seen at
              V
R1
              is
            




              In
              Figure 8-43
              (c), we remove the 20-Ω load and set the first source to zero. With the first source replaced by a short circuit, the voltage seen at
              V
R2
              is
            




              What happens here is that the -
              j
              10-Ω capacitor and the +
              j
              10-Ω inductor cancel each other and result in an effective open circuit resulting in the 120∠30° V appearing across the open circuit.
            
The Thévenin voltage is then the sum of the two results:




              Next we use the look-back method to find Z
              T
              . With the two sources set to zero, we see all three elements in parallel.
            




              We can now draw the Thévenin circuit and connect the load to it as shown in
              Figure 8-43
              (d).
            
Using a voltage divider allows us to find the desired voltage.




              Therefore, the corresponding time-domain function is
              υ
R
              (
              t
              ) = 226.5 cos(5000
              t -
              47.9°) V, the same result as in
              Example 8-16
              .
            








FIGURE 8-43















FIGURE 8-43









              To use Multisim, we need to find the actual values of the inductors and the capacitor. Using the relationships for impedance, we find the values as
              L
1
              = 2 mH,
              L
2
              = 6 mH, and
              C
              = 20 µF. Since Multisim performs its simulations in hertz, we convert the 5000 rad/s excitations to 795.77 Hz. The Multisim circuit is shown in
              Figure 8-43
              (e) and the results of a single-frequency AC analysis are shown in
              Figure 8-43
              (f). The answers compare favorably.
              ■













Exercise 8-28


            Repeat
            Example 8-21
            using Multisim if both sources are operating at a frequency of ω = 20 krad/s. (
            Hint
            : Find
            L
1
            ,
            L
2
            , and
            C
            from the data in
            Example 8-21
            first.)
          


Answer:



υ
R
            (
            t
            ) = 9.196 cos(20k
            t
            - 163.8°) V
          
















EXAMPLE 8-22



                Use Thévenin's theorem to find the current
                I
X
                in the bridge circuit shown in
                Figure 8-44
                (a).
              









FIGURE 8-44









SOLUTION:



              Disconnecting the impedance
              j
              200 from the circuit in
              Figure 8-44
              (a) produces the circuit shown in
              Figure 8-44
              (b). The voltage between nodes A and B is the Thévenin voltage since removing the impedance
              j
              200 leaves an open circuit. The voltages at
              
              nodes A and B can each be found by voltage division. Since the open-circuit voltage is the difference between these node voltages, we have
            




              Turning off the voltage source in
              Figure 8-44
              (b) and replacing it by a short circuit produces the situation shown in
              Figure 8-44
              (c). The look-back impedance seen at the interface is a series connection of two pairs of elements connected in parallel. The equivalent impedance of the series/parallel combination is
            




              Given the Thévenin equivalent circuit, we treat the impedance
              j
              200 as a load connected at the interface and calculate the resulting load current
              I
X
              as
            




■

 











Exercise 8-29



              (a) Find the Thévenin equivalent circuit seen by the inductor in
              Figure 8-45
              .
            

              (b) Use the Thévenin equivalent to calculate the current
              I
X
              .
            

              (c) If
              L
              = 0.1 mH, find
              C.


Answers:


              (a)
              
                V
                T

              = 0.8925 +
              j
              13.839 V,
              Z
T
              = 230.8 -
              j
              153.8 Ω
            

              (b)
              I
X
              = 58.52∠99.44° mA
            

              (c)
              C
              = 2000 pF
            











Exercise 8-30


            Determine the Thévenin equivalent circuit seen by the capacitor in
            Figure 8-45
            for
            V
S
            = 10∠0° V.
          


Answers:



            V
            T
            = 0.958∠73.3° V,
            Z
T
            = 95.8∠73.3° Ω
          










FIGURE 8-45


















EXAMPLE 8-23

In the steady state, the open-circuit voltage at an interface is observed to be



When a 50-mH inductor is connected across the interface, the interface voltage is observed to be



Find the Thévenin equivalent circuit at the interface.



SOLUTION:




              The phasors for
              υ
OC
              (
              t
              ) and
              υ
              (
              t
              ) are
              V
OC
              = 12∠0° and
              V
              = 17∠45°. The phasor Thévenin voltage at the interface is V
              T
              =
              V
OC
              = 12∠0°. The impedance of the inductor is
              Z
L
              =
              j
              ω
              L
              =
              j
              2000 × 0.050 =
              j
              100 Ω. When the inductor load is connected across the interface, we use voltage division to express the interface voltage as
            



Inserting the known numerical values yields




              Solving for Z
              T
              , we have
            




              The Thévenin equivalent circuit at the interface is defined by
              V
T
              = 12∠0° and
              Z
T
              = 49.9 -
              j
              50.1 Ω =70.7 ∠ -45.1° V.
              ■












Exercise 8-31

In the steady state, the short-circuit current at an interface is observed to be



When a 150-Ω resistor is connected across the interface, the interface current is observed to be



Find the Norton equivalent phasor circuit at the interface.


Answers:



            I
            N
            = 0 -
            j
            0.75A, Z
            N
            = 0 +
            j
            200 Ω
          

















DESIGN EXAMPLE 8-24


                For the circuit shown in
                Figure 8-46
                (a), design an interface that converts an input voltage of
                V
S
                = 90∠0° V into an output of
                V
O
                = 63.6∠ - 45° V. The circuit is operating at 1000 rad/s. Validate your design using Multisim.
              









FIGURE 8-46










SOLUTION:


Let us see what the interface circuit is required to do. We can make a ratio of the output over the input and determine what effect the interface circuit must perform to meet the requirement.




              Since there is a negative phase shift, it appears that a simple voltage divider with a resistor
              Z
R
              =
              R
              and a capacitor
              Z
C
              = -
              jX
              could work with the output taken across the capacitor.
            



Setting magnitudes and angles equal, we can solve for the necessary relationships. Thus



and




              If we select
              R
              and
              X
              to have the same value, then the magnitude of the denominator would be
              

              and the angle would be -45°. This would produce the desired result. The interface is shown in
              Figure 8-46
              (b).
            

              Next, we need to select
              R
              and
              C.
              If we pick
              R
              =1 kΩ we can calculate the value of the capacitor. Since the radian frequency is 1000 rad/s,
              C
              is found to be 1 μF.
            

              We simulated the circuit in Multisim with the design values found for
              R
              and
              C.
              Grapher View returns the following analysis of our design:
            




              These results indicate that our design choices for
              R
              and
              C
              were valid.
              ■















Design Exercise 8-32



            Repeat the problem in
            Example 8-24
            , except you cannot use capacitors.
          


Answers:



            Use an
            RL
            series circuit with the output taken across the resistor. Select
            R
            = 1 kΩ and
            L
            = 1 H. Other solutions are possible. A Multisim simulation will verify the results.
          




8-5 General Circuit Analysis with Phasors

        The previous sections discuss basic analysis methods based on equivalence, reduction, and circuit theorems. These methods are valuable because we work directly with element impedances and thereby gain insight into steady-state circuit behavior. We
        
        also need general methods, such as node and mesh analysis, to deal with more complicated circuits than the simpler methods can handle. These general methods use node-voltage or mesh-current variables to reduce the number of equations that must be solved simultaneously.
      








FIGURE 8-47



An example node.




Node-voltage equations involve selecting a reference node as ground or datum and assigning a node-to-datum voltage to each of the remaining nonreference nodes. Because of KVL, the voltage between any two nodes equals the difference of the two node voltages. This fundamental property of node voltages plus the element impedances allow us to write KCL constraints at each of the nonreference nodes.

        For example, consider node A in
        Figure 8-47
        . The sum of currents leaving this node can be written as
      



Rewriting this equation with unknowns grouped on the left and known inputs on the right yields



Expressing this result in terms of admittances produces the following equation.




        This equation has a familiar pattern. The unknowns
        V
A
        ,
        V
B
        , and
        V
C
        are the node-voltage phasors. The coefficient [
        Y
1
        +
        Y
2
        +
        Y
3
        ] of
        V
A
        is the sum of the admittances of all of the elements connected to node A. The coefficient [
        Y
2
        ] of
        V
B
        is the admittance of the elements connected between nodes A and B, whereas [
        Y
3
        ] is the admittance of the elements connected between nodes A and C. Finally,
        I
S1
        and
        I
S2
        are the phasor current sources connected to node A, with
        I
S1
        directed into and
        I
S2
        directed away from the node. These observations suggest that we can write node-voltage equations for phasor circuits by inspection, just as we did with resistive circuits.
      

        Circuits that can be drawn on a flat surface with no crossovers are called
        planar
        circuits. The mesh-current variables are the loop currents assigned to each mesh in a planar circuit. Because of KCL, the current through any two-terminal element is equal to the difference of the two adjacent meshes. This fundamental property of mesh currents together with the element impedances allows us to write KVL constraints around each of the meshes.
      








FIGURE 8-48



An example mesh.





        For example, the sum of voltages around mesh A in
        Figure 8-48
        is
      



Arranging this equation in standard form yields




        This equation also displays a familiar pattern. The unknowns
        I
A
        ,
        I
B
        , and
        I
C
        are mesh-current phasors. The coefficient [
        Z
1
        +
        Z
2
        +
        Z
3
        ] of
        I
A
        is the sum of the impedances in mesh A. The coefficient [
        Z
2
        ] of
        I
B
        is the impedance in both mesh A and mesh B, whereas [
        Z
3
        ] is the impedance common to meshes A and C. Finally,
        V
S1
        and
        V
S2

        are the phasor voltage sources in mesh A. These observations allow us to write mesh-current equations for phasor circuits by inspection.
      

        The preceding discussion assumes that the circuit contains only current sources in the case of node analysis and voltage sources in mesh analysis. If there is a mixture of sources, we may be able to use the source transformations discussed in
        Sect. 8-4
        to convert from voltage to current sources, or vice versa. A source transformation is possible only when there is an impedance connected in series with a voltage source or an impedance in parallel with a current source. When a source transformation is not possible, we use the phasor version of the modified node- and mesh-analysis methods described in
        Chapter 3
        .
      

        Formulating a set of equilibrium equations in phasor form is a straightforward process involving concepts that we have used before in
        Chapters 3
        and
        4
        . Once formulated, we use Cramer's rule or Gaussian reduction to solve these equations for phasor responses, although this requires manipulating linear equations with complex coefficients. In principle, the solution process can be done by hand, but as a practical matter circuits with more than three nodes or meshes are best handled using computer tools. Modern hand-held scientific calculators and math analysis programs like MATLAB can deal with sets of linear equations with complex coefficients. Circuit analysis programs such as Multisim have ac analysis options that handle steady-state circuit analysis problems.
      
With modern computer tools such as Multisim and MATLAB, one may question why one should bother with hand solutions at all. Until fairly recently, the reason was that most software tools could not effectively handle symbolic operators. That is no longer an issue, with symbolic manipulators available in many software packages. MATLAB, for example, has a symbolic toolbox that permits the solution of analytical problems using symbolic variables. Nevertheless, for one to become a good engineer, it is essential to develop a sense of what looks right. This sense is not innate and must be developed with practice. The next few examples and exercises will help you to develop this sense both classically by hand and by using software tools.












EXAMPLE 8-25



                The circuit in
                Figure 8-49
                (a) is operating in the sinusoidal steady state. Convert the circuit into the phasor domain and find the phasor voltages at nodes A and B.
              



SOLUTION:



              We start by converting the time-domain circuit into the phasor domain resulting in
              Figure 8-49
              (b). The voltage source in
              Figure 8-49
              (b) is connected in series with an impedance consisting of a resistor and inductor connected in parallel. The equivalent impedance of this parallel combination is
            



Applying a source transformation produces an equivalent current source of




Figure 8-49
              (c) shows the circuit produced by the source transformation. Note that the transformation eliminates node B. The node-voltage equation at the remaining nonreference node in
              Figure 8-49
              (c) is
            








FIGURE 8-49











              Solving for
              V
A
              yields
            





              Referring to
              Figure 8-49
              (b), we see that KVL requires
              V
B
              =
              V
A
              + 10∠ - 90°. Therefore,
              V
B
              is found to be
            




■

 












Exercise 8-33



            Use Multisim to solve for the node voltages
            V
A
            and
            V
B
            in the circuit of
            Figure 8-49
            (a).
          


Answer:



            See
            Figure 8-50
            .
            V
A
            = 12.6∠18.4° and
            V
B
            = 13.4∠ - 26.6°
          








FIGURE 8-50






















EXAMPLE 8-26



                Use node analysis to find the current
                I
X
                in the bridge circuit of
                Figure 8-51
                .
              



SOLUTION:



              In this example, we use node analysis on a problem solved in
              Example 8-22
              using a Thévenin equivalent circuit. The voltage source cannot be replaced by source transformation because it is not connected in series with an impedance. By inspection, the node equations at nodes A and B are
            











FIGURE 8-51








              A node equation at node C is not required because the voltage source forces the condition
              V
C
              = 75∠0°. Substituting this constraint into the equations of nodes A and B and arranging the equations in standard form yield two equations in two unknowns:
            




              Solving these equations for
              V
A
              and
              V
B
              yields
            




              Using these values for
              V
A
              and
              V
A
              , the unknown current is found to be
            




              This value of
              I
X
              is the same as the answer obtained in
              Example 8-22
              .
              ■


















EXAMPLE 8-27


                The circuit in
                Figure 8-51
                is operating in the sinusoidal steady state at 10,000 rad/s. Use Multisim to find the Thévenin equivalent circuit seen by the capacitor. Then use the Thévenin circuit to find the current waveform through the capacitor.
              



SOLUTION:



              We draw the circuit twice in Multisim, as shown in
              Figure 8-52
              . In the first circuit, the capacitor is removed and the open-circuit voltage is simply V(4). In the second circuit, a very small resistor R7 of 0.1 μΩ was inserted in place of the capacitor to measure the short-circuit current I(R7). We asked Multisim to calculate the Thévenin impedance using the ratio of
              υ
oc
              /
              i
sc
              or V(4)/I(R7).
            








FIGURE 8-52









              We ran the Single Frequency AC Analysis using the Magnitude and Phase output option. The result in Grapher View is given in the table below.
            




              From these data, we can write that
              V
T
              = 72.5 ∠5.87° V and Z
              T
              = 47.1 ∠13.4° Ω. We then ran the analysis again using the Real/Imaginary output option to facilitate finding the components for
              Z
T
              . The results are obtained as follows:
            




              This readily showed that we have Z
              T
              equal to a 45.8-Ω resistor in series with a 1.09-mH inductor (at 10 krad/s). We added the Thévenin circuit to
              Figure 8-52
              with the capacitor as the load and ran the analysis again for the current through the capacitor. Grapher View returned the following:
            




              From this we can write the desired waveform as
              i
C
              (
              t
              ) = 612 cos(10,000
              t
              + 73.1°) mA.
              ■













Exercise 8-34


            The circuit in
            Figure 8-51
            is operating in the sinusoidal steady state at 10,000 rad/s. Use Multisim to find the Thévenin equivalent circuit seen by the 60-Ω resistor. Then use the Thévenin circuit to find the current waveform through the 60-Ω resistor.
          
Answers:





            The Thévenin equivalent circuit is
            V
T
            = 68.0∠ - 0.448° V and
            Z
T
            = 45.8 ∠13.8° Ω = 44.5 +
            j
            10.9 Ω.
          




            The desired waveform is
            i
R
            (
            t
            ) = 647 cos(10,000t - 6.4°) mA.
          
















EXAMPLE 8-28



                Use node-voltage analysis to determine the phasor input-output relationship of the OP AMP circuit in
                Figure 8-53
                .
              



SOLUTION:


In the sinusoidal steady state, the sum of currents leaving the inverting input node is











FIGURE 8-53








              This is the only required node equation, since the input source forces the condition
              V
A
              =
              V
S
              and no node equation is ever required at an OP AMP output. In the time domain, the
              i
              -
              υ
              relationships of an ideal OP AMP are υ
              P
              (
              t
              ) = υ
              N
              (
              t
              ) and
              i
P
              (
              t
              ) =
              i
N
              (
              t
              ) = 0. In the sinusoidal steady state, these equations are written in phasor form as
              V
P
              =
              V
N
              and
              I
P
              =
              I
N
              = 0. In the present case, this means
              V
N
              = 0 since the non-inverting input is grounded. When the ideal OP AMP constraints are inserted in the node equation, we can solve for the OP AMP input-output relationship as
            




              This result is the phasor-domain version of the inverting amplifier configuration. In the phasor domain, the "gain"
              K
              = -Z
              2
              /
              Z
1
              is determined by a ratio of impedances rather than resistances. Thus, the gain affects both the amplitude and the phase angle of the steady-state output.
              ■












Exercise 8-35


            In the circuit of
            Figure 8-53
            ,
            Z
1
            is a resistor and
            Z
2
            is the parallel combination of a 10-kΩ resistor and a 1-µF capacitor. Determine the output voltage
            υ
O
            (
            t
            ) if the input is
            υ
S
            (
            t
            ) = 1 cos 100
            t
            V. Repeat for
            v
S
            (
            t
            ) = 1 cos 1t V and for
            v
S
            (
            t
            ) = 1 cos 10
            4
t
            V. Is this a filter?
          


Answer:



υ
O
            (
            t
            ) =7.07 cos (100
            t
            + 135°), = 10 cos (
            t
            + 179.4°), = 0.1 cos (10
            4
t
            + 90.6°) V. The circuit is a low-pass filter.
          










FIGURE 8-54



















                EVALUATION EXAMPLE 8-29
              

                A vendor claims that the circuit shown in
                Figure 8-54
                is a
                high-pass filter
                with a cutoff frequency of ω
                C
                = 1/
                R
1
                C and a pass-band gain of -
                R
2
                /
                R
1
                . Verify his claim by finding the phasor voltage ratio
                V
O
                /
                V
S
                and determining at what radian frequency the gain falls to 0.707 of the pass-band (maximum) value.
              



SOLUTION:




              The circuit is an inverting amplifier whose input-output relationship was found in
              Example 8-28
              as
            



The phasor voltage ratio is




              At dc when ω = 0, the voltage
              V
O
              = 0 V, then as ω approaches infinity, the voltage
              V
O
              approaches (
              R
2
              /
              R
1
              )
              V
S
              . The maximum value occurs at infinite frequency with a gain of
              
              . This is a high-pass filter as stated, since low frequencies are blocked with a low gain and high frequencies are allowed to pass. We still need to determine the frequency where the gain falls to 0.707 × -
              
              . The magnitude of the phasor voltage ratio is
            




              The value of ω that makes the output equal 0.707 of the maximum occurs at 1/
              R
1
C
              as stated.
            




              The vendor accurately described his product.
              ■













            Design
            Exercise 8-36


            Use the circuit of
            Figure 8-54
            to design a high-pass filter with a pass-band gain of - 100 and a cutoff frequency ω
            C
            of 10,000 rad/s. Use standard parts (see
            Appendix G
            ).
          


Answer:



            Choose
            R
1
            = 1 kΩ, then
            C
            = 0.1 µF and
            R
2
            = 100 kΩ. Many other solutions are possible.
          










FIGURE 8-55




















EXAMPLE 8-30



                Find the input-output relationship
                V
O
                /
                V
S
                =
                K
                for the circuit of
                Figure 8-55
                . Then for
                R
1
                = 1 kΩ,
                C
1
                =0.1 μF,
                R
2
                = 10 kΩ, and
                C
2
                = 1 μF, use MATLAB to create a plot of the log of the magnitude of the input-output relationship
                K
                versus the log of the frequency from 1 rad/s to 1 Mrad/s. Discuss the characteristics of the result.
              



SOLUTION:




              The OP AMP follower effectively isolates the two
              RC
              circuits. One can use the voltage division rule for each
              RC
              circuit and then simply multiply the results together to obtain the desired input-output relationship.
            

              The output of the first
              RC
              circuit is
            




V
1
              is the input to the follower. Hence, the output,
              V
2
              , is equal to the input,
              V
1
              . The output of the second
              RC
              circuit, then, is another voltage divider:
            




              Substituting
              V
1
              from the first
              RC
              circuit and dividing by
              V
S
              , we obtain our result:
            




              The magnitude of
              K
              with the values of the
              R
              's and
              C
              's substituted is given as
            



The following MATLAB code will produce the desired plot:

              % Create the range over which we want to have MATLAB plot the response.
              % Use logspace to cover from 100 rad/s to 106 rad/s.
              w=logspace(0,6);
              % Define the gain of the function.
              K=w./(sqrt((w.*w)+10000)).*1e4./(sqrt((w.*w)+1e8));
              % Request a log-log plot of w vs K.
              loglog(w,K)
              grid on
              xlabel('Frequency in rad/s')
              ylabel('Gain (K)')
            

              MATLAB returns the plot shown in
              Figure 8-56
              .
            








FIGURE 8-56










Discussion:

The plot shows a prototypical characteristic of a

bandpass filter.

Signals containing frequencies less than about
              100
              rad/s or greater than about 10 krad/s are attenuated (decreased). Those signals that fall in the band of frequencies between these two frequencies can pass through with little or no attenuation—hence the name. The frequencies that form the boundaries between which signals pass are generally considered to be the frequency where the magnitude of the input-output relationship has dropped to 0.707 or

of the peak value.


■














            Design
            Exercise 8-37

Design a bandpass filter with a lower frequency cutoff of 100 Hz and an upper frequency cutoff of 20 kHz.


Answer:



            Select
            R
1
            =
            R
2
            = 1 kΩ,
            C
1
            = 7960 pF, and
            C
2
            = 1.59 in the circuit shown in
            Figure 8-55
            . Other correct solutions are possible.
          















EXAMPLE 8-31


                The circuit in
                Figure 8-57
                is an equivalent circuit of an ac induction motor. The current
                I
S
                is called the stator current,
                I
R
                the rotor current, and
                I
M
                the magnetizing current. Use the mesh-current method to solve for the branch currents
                I
S
                ,
                I
R
                , and
                I
M
                .
              



SOLUTION:



              Applying KVL to the sum of voltages around each mesh in
              Figure 8-57
              yields
            



Arranging these equations in standard form yields











FIGURE 8-57









              Solving these equations for
              I
A
              and
              I
B
              we get
            



The required stator, rotor, and magnetizing currents are related to these mesh currents as follows:


■



















EXAMPLE 8-32



                Use MATLAB and mesh-current analysis to find the branch currents
                I
1
                ,
                I
2
                , and
                I
3
                in
                Figure 8-58
                .
              



SOLUTION:



              We identify three mesh currents
              I
A
              ,
              I
B
              , and
              I
C
              as shown in the figure. We write by inspection three mesh-current equations as follows.
            




              Using MATLAB's complex number ability, we use the software to solve for the three mesh currents,
              I
A
              ,
              I
B
              , and
              I
C
              . Then we use these results to find the requested branch currents as follows:
            



The following MATLAB code will do all of this for us:








FIGURE 8-58








              %Create the symbolic variables and the two input voltages
              syms IA IB IC
              Vs1 = 120;
              Vs2 = 120*exp(-j*pi/6);
              %Create the mesh currents equations
              Eqn1 = (IA-IC)*5j + IA*10j + (IA-IB)*20j;
              Eqn2 = (IB-IA)*20j + IB*50 - Vs2;
              Eqn3 = (IC-IA)*5j - Vs1 + Vs2;
              %Solve the mesh current equations set equal to zero for
              %the symbolic variables
              Soln = solve(Eqn1,Eqn2,Eqn3,IA,IB,IC);
              IAnum = double(Soln.IA);
              IBnum = double(Soln.IB);
              ICnum = double(Soln.IC);
              %Solve for the branch currents
              I1 = ICnum-IAnum;
              I2 = IAnum;
              I3 = IBnum-IAnum;
              %Convert to magnitude and phase
              I1Mag = abs(I1)
              I1Phase = 180*angle(I1)/pi
              I2Mag = abs(I2)
              I2Phase = 180*angle(I2)/pi
              I3Mag = abs(I3)
              I3Phase = 180*angle(I3)/pi
            
MATLAB returns the following:

              I1Mag = 12.4233
              I1Phase = -15.0000
              I2Mag = 3.6077
              I2Phase = -16.0616
              I3Mag = 1.3027
              I3Phase = 166.4700
            


              Hence, our results are
              I
1
              = 12.4∠ -15.0° A,
              I
2
              = 3.61∠ - 16.1° A and
              I
3
              = 1.30 ∠166.5° A.
            

■

 












            Evaluation
            Exercise 8-38


            Repeat
            Example 8-32
            but use node-voltage analysis to solve for the currents of
            Figure 8-58
            . Which method do you think is easier and why?
          
Answers:



This four-node circuit has only one unknown node-voltage equation that needs to be solved. Hence, it is reasonable to say that node-voltage analysis in this case, is easier.















EXAMPLE 8-33


                Use the mesh-current method to solve for output voltage
                V
2
                and input impedance
                Z
IN
                of the circuit in
                Figure 8-59
                .
              



SOLUTION:


The circuit contains a voltage-controlled voltage source. We initially treat the dependent source as an independent source and use KVL to write the sum of voltages around each mesh:



Arranging these equations in standard form, we get











FIGURE 8-59









              Using Ohm's law, the control voltage
              V
X
              is
            




              Eliminating
              V
X
              from the mesh equations yields
            



Solving for the two mesh currents, we get



Using these values of the mesh currents, the output voltage and input impedance are calculated as follows:




■














Exercise 8-39


            Use the mesh-current or node-voltage method to find the output voltage
            
              V
              2

            and the input impedance
            Z
IN
            in
            Figure 8-60
            (a). Then solve the problem using Multisim.
          
Answers:



In order to solve the problem using Multisim, one needs a frequency in hertz. Since none was given, select any frequency, say 1000 rad/s = 159.15 Hz. Convert all the impedances into henrys and farads and run a Single Frequency AC Analysis. The results are given in the following table:








FIGURE 8-60



























EXAMPLE 8-34



                In the circuit in
                Figure 8-61
                , the input voltage is
                υ
S
                (
                t
                ) = 10 cos 10
                5
t
                V. Use node-voltage analysis and MATLAB to find the input impedance at the input interface and the proportionality constant relating the input voltage phasor to the phasor voltage across the 50-Ω load resistor, that is,
                K =
V
O
                /
                V
S
                .
              



SOLUTION:




              We will solve this example problem using two distinct approaches in MATLAB. Both approaches start by formulating the following node-voltage equations for
              V
A
              ,
              V
B
              , and
              V
O
              :
            











FIGURE 8-61








              In the first approach, we will convert these equations to matrix form and then use MATLAB to solve for
              V
A
              ,
              V
B
              , and
              V
O
              . We can then use the three voltages to solve for the input impedance and the input-output relationship for the circuit. Converting the node-voltage equations into matrix form, we get:
            




              Since MATLAB can handle complex numbers, we can now use the software to solve for
              V
A
              ,
              V
B
              , and
              V
O
              . The following MATLAB code will calculate the node voltages, the input impedance, and the gain of the circuit:
            

              % Solve the problem using a matrix approach
              % Create the matrices
              Vs = 10;
              A= [1/50 + 1/(-50j) +1/(100j) -1/(-50j) -1/(100j);
                 -1/(-50j) 1/(-50j) +1/(100j) +1/(-50j) -1/(-50j);
                 -1/(100j) -1/(-50j) 1/(100j) +1/(-50j) + 1/50];
              B = [Vs/50; 0; 0];
              % Solve for the node voltages and assign labels
              V = A\B;
              VA = V(1)
              VB = V(2)
              VO = V(3)
              % Compute the input impedance and circuit gain
              Iin = (Vs-VA)/50;
              Zin = VA/Iin
              K = VO/Vs
            
The results from the code are:

              VA = 9.5000 + 1.5000i
              VB = 6.0000 + 2.0000i
              VO = -0.5000 + 1.5000i
              Zin = 5.0000e+001 +3.0000e+002i
              K = -0.0500 + 0.1500i
            


              So the input impedance is
              Z
IN
              = 50 +
              j
              300 Ω, and the gain is
              K
              = - 0.05 +
              j
              0.15.
            
We can exploit another MATLAB function to solve the same problem in a slightly different way. We will use the original node-voltage equations derived above, but this time we will allow MATLAB to perform all of the calculations by working with these equations in symbolic form. The net result is that we do not have to convert the equations into matrix form to find a solution. The required code is shown below:

              % Create the symbolic variables and the input signal clear all
              syms Va Vb Vo
              Vs = 10;
              % Create the node-voltage equations
              NVa = (Va-Vs)/50 + (Va-Vb)/(-50j) + (Va-Vo)/(100j);
              NVb = (Vb-Va)/(-50j) + Vb/(100j) + (Vb-Vo)/(-50j);
              NVo = (Vo-Va)/(100j) + (Vo-Vb)/(-50j) + Vo/50;
              % Solve the node voltage equations set equal to zero for the
              % symbolic variables
              V = solve(NVa,NVb,NVo);
              % Compute the input impedance and the proportionality constant
              Vout = V.Vo;
              Vin = V.Va;
              Iin = (Vs-Vin)/50;
              Zin = Vin/Iin
              K = Vout/Vs
            
The MATLAB results are:

              Zin = 50 + 300i
              K = -1/20 + 3i/20
            

              which agree with our previous results using the matrix approach. Both approaches are acceptable, and either the nature of the exercise or personal preference will dictate which approach is more efficient for a particular problem.
              ■












FIGURE 8-62














Exercise 8-40


            Use MATLAB and either mesh-current or node-voltage analysis to find the current
            I
X
            in
            Figure 8-62
            .
          


Answers:



            I
            X
            = 1.44∠171°A
          












Exercise 8-41



            The circuit in
            Figure 8-63
            is operating in the sinusoidal steady state at 10 krad/s. Use Multisim to find the output waveforms corresponding to
            V
O
            and
            I
O
            .
          


Answers:


Multisim's Grapher View returns the following:














FIGURE 8-63











8-6 Energy and Power


        In the sinusoidal steady state, ac power is transferred from sources to various loads. To study the transfer process, we must calculate the power delivered in the sinusoidal steady state to any specified load. It turns out that there is an upper bound on the available load power; hence, we need to understand how to adjust the load to extract the maximum power from the source. In this section, the load is assumed to be made up of passive resistance, inductance, and capacitance. To reach our objectives, we must first study the power and energy delivered to these passive elements in the sinusoidal steady state.
      

        In the sinusoidal steady state, the current through a resistor can be expressed as
        i
R
        (
        t
        ) =
        I
A
        cos(ω
        t
        ). The instantaneous power delivered to the resistor is
      



(8-30)





        where the identity cos
        2
        (
        x
        ) = ½[1 + cos(2
        x
        )] is used to obtain the last line in
        Eq. (8-30)
        . The energy delivered for
        t ≥
        0 is found to be
      




Figure 8-64
        shows the time variation of
        p
R
        (
        t
        ) and
        w
R
        (
        t
        ). Note that the power is a periodic function with twice the frequency of the current, both
        p
R
        (
        t
        ) and
        w
R
        (
        t
        ) are always positive, and
        w
R
        (
        t
        ) increases without bound. These observations remind us that a resistor is a passive element that dissipates energy.
      








FIGURE 8-64



Resistor power and energy in the sinusoidal steady state.





        In the sinusoidal steady state, an inductor operates with a current
        i
L
        (
        t
        ) =
        I
A
        cos(ω
        t
        ). The corresponding energy stored in the element is
      




        where the identity cos
        2
        (
        x
        ) = ½[1 + cos(2
        x
        )] is again used to produce the last line. The instantaneous power delivered to the inductor is
      



(8-31)





Figure 8-65
        shows the time variation of
        p
L
        (
        t
        ) and
        w
L
        (
        t
        ). Observe that both
        p
L
        (
        t
        ) and
        w
L
        (
        t
        ) are periodic functions at twice the frequency of the ac current, that
        p
L
        (
        t
        ) is alternately positive and negative, and that
        w
L
        (
        t
        ) is never negative. Since
        w
L
        (
        t
        ) ≥ 0, the inductor does not deliver net energy to the rest of the circuit. Unlike the resistor's energy in
        Figure 8-64
        , the energy in the inductor is bounded by ½
        
        ≥
        w
L
        (
        t
        ), which means that the inductor does not dissipate energy. Finally, since
        p
L
        (
        t
        ) alternates signs, we see that the inductor stores energy during a positive half cycle and then returns the energy undiminished during the next negative half cycle. Thus, in the sinusoidal steady state, there is a lossless interchange of energy between an inductor and the rest of the circuit.
      








FIGURE 8-65



Inductor power and energy in the sinusoidal steady state.






        In the sinusoidal steady state, the voltage across a capacitor is
        υ
C
        (
        t
        ) =
        V
A
        cos(ω
        t
        ). The energy stored in the element is
      



The instantaneous power delivered to the capacitor is



(8-32)





Figure 8-66
        shows the time variation of
        p
C
        (
        t
        ) and
        w
C
        (
        t
        ). Observe that these relationships are the duals of those found for the inductor. Thus, in the sinusoidal steady state the element power is sinusoidal, and there is a lossless interchange of energy between the capacitor and the rest of the circuit.
      








FIGURE 8-66



Capacitor power and energy in the sinusoidal steady state.




Average power
We are now in a position to calculate the average power delivered to various loads. The instantaneous power delivered to any of the three passive elements is a periodic function that can be described by an average value. The average power in the sinusoidal steady state is defined as




        The power variation of the inductor in
        Eq. (8-31)
        and capacitor in
        Eq. (8-32)
        have the same sinusoidal form. The average value of any sinusoid is zero since the areas under alternate cycles cancel. Hence, the average power delivered to an inductor or capacitor is zero:
      




        The resistor power in
        Eq. (8-30)
        has both a sinusoidal ac component and a constant dc component ½
        
.
        The average value of the ac component is zero, but the dc component yields
      




        To calculate the average power delivered to an arbitrary load
        Z
L
        =
        R
L
        +
        jX
L
        , we use phasor circuit analysis to find the phasor current
        I
L
        through
        Z
L
        . The average power delivered to the load is dissipated in
        
          R
          L
          ,
        
        since the reactance
        X
L
        represents the net inductance or capacitance of the load. Hence, the average power to the load is
      


(8-33)






Caution:


        When a circuit contains two or more sources, superposition applies only to the total load current and not to the total load power. You cannot reliably find the total power to the load by summing the power delivered by each source acting alone.
      
The following example illustrates a power transfer calculation.













EXAMPLE 8-35



                Find the average power delivered to the load to the right of the interface in
                Figure 8-67
                .
              



SOLUTION:


The equivalent impedance to the right of the interface is











FIGURE 8-67







The current delivered to the load is



Hence, the average power delivered across the interface is






Note:


              All of this power goes into the 100-Ω resistor since the inductor and capacitor do not absorb average power.
              ■













Exercise 8-42


            The circuit in
            Figure 8-68
            is operating in the sinusoidal steady state at 60 Hz. Find the average power delivered to the 25-Ω load. Then use Multisim to validate your answer. (
            Hint
            : Place a small 0.1-μΩ resistor in series with either inductor to avoid a singular event that prevents Multisim from running.)
          
Answers:


              (a)
              P
              = 234 W
            

              (b) Grapher View returns the same result:
              












FIGURE 8-68









Maximum power

        To address the maximum power transfer problem, we model the source-load interfaceas shown in
        Figure 8-69
        . The source circuit is represented by a Thévenin equivalent circuit with source voltage
        V
T
        and source impedance
        Z
T
        =
        R
T
        +
        jX
T
        . The load circuit is represented by an equivalent impedance
        Z
L
        =
        R
L
        +
        jX
L
        . In the maximum power transfer problem, the source parameters
        V
T
        ,
        R
T
        , and
        X
T
        are given, and the objective is to adjust the load impedance
        R
L
        and
        X
L
        so that average power to the load is a maximum.
      
The average power to the load is expressed in terms of the phasor current and load resistance:











FIGURE 8-69



A source-load interface in the sinusoidal steady state.






        Then, using series equivalence, we express the magnitude of the interface current as
      



Combining the last two equations yields the average power delivered across the interface as



(8-34)





        The quantities |
        V
T
        |,
        R
T
        , and
        X
T
        in
        Eq. (8-34)
        are fixed. Our problem is to select
        R
L
        and
        X
L
        to maximize
        P.


        Clearly, for every value of
        R
L
        the denominator in
        Eq. (8-34)
        is minimized and
        P
        maximized when
        X
L
        = -
        X
T
        . This choice of
        X
L
        is possible because a reactance can be positive or negative. When the source Thévenin equivalent has an inductive reactance (
        X
T
        > 0, we modify the load to have a capacitive reactance of the same magnitude, and vice versa when the Thévenin equivalent has a capacitance reactance. This step reduces the net reactance of the series connection in
        Figure 8-69
        to zero, creating a condition in which the net impedance seen by the Thévenin voltage source is purely resistive.
      

        When the source and load reactances cancel out, the expression for average power in
        Eq. (8-34)
        reduces to
      


(8-35)




        This equation has the same form encountered in
        Chapter 3
        in dealing with maximum power transfer in resistive circuits. From the derivation in
        Sect. 3-5
        , we know
        P
        is maximized when
        R
L
        =
        R
T
        . In summary, to obtain maximum power transfer in the sinusoidal steady state, we select the load resistance and reactance so that
      


(8-36)



These conditions can be compactly expressed in the following way:


(8-37)




        The condition for maximum power transfer is called a
        conjugate match,
        since the load impedance is the conjugate of the source impedance. When the conjugate-match conditions are inserted into
        Eq. (8-34)
        , we find that the maximum average power available from the source circuit is
      



(8-38)





        where |
        V
T
        | is the peak amplitude of the Thévenin equivalent voltage.
      

        It is important to remember that conjugate matching applies when the source is fixed and the load is adjustable. These conditions arise frequently in power-limited communication systems. However, as we will see in
        Chapter 16
        , conjugate matching does not apply to electrical power systems because the power transfer constraints are different.
      












EXAMPLE 8-36





                  (a) Calculate the average power delivered to the load in the circuit shown in
                  Figure 8-70
                  (a) for
                  υ
S
                  (
                  t
                  ) = 5 cos 10
                  6
t
                  V,
                  R
                  = 200 Ω,
                  R
L
                  = 200 Ω, and
                  C
                  = 0.01 µF.
                
(b) Calculate the maximum average power available at the interface and specify the load required to draw the maximum power.











FIGURE 8-70









SOLUTION:




              (a) To find the power delivered to the 200-Ω load resistor, we use a Thévenin equivalent circuit. By voltage division, the open-circuit voltage at the interface is
              


By inspection, the short-circuit current at the interface is




                Given
                V
T
                and
                I
N
                , we calculate the Thévenin source impedance:
              




                Using the Thévenin equivalent shown in
                Figure 8-70
                (b), we find that the current through the 200-Ω resistor is
              



and the average power delivered to the load resistor is





              (b) Using
              Eq. (8-38)
              , the maximum average power available at the interface is
              


The 200-Ω load resistor in (a) draws about half of the maximum available power. To extract maximum power, the load impedance must be



This impedance can be obtained using a 40-Ω resistor in series with a reactance of +80 Ω. The required reactance is inductive (positive) and can be produced by an inductance of




■















Exercise 8-43



            Calculate the maximum average power available at the interface in
            Figure 8-71
            .
          


Answer:



P
MAX
            = 62.5 mW
          








FIGURE 8-71











Summary



          A
          phasor
          is a complex number representing a sinusoidal waveform. The magnitude and angle of the phasor correspond to the amplitude and phase angle of the sinusoid. The phasor does not provide frequency information.
        

          The
          additive property
          states that adding phasors is equivalent to adding sinusoids of the same frequency. The
          derivative property
          states that multiplying a phasor by
          j
          ω is equivalent to differentiating the corresponding sinusoid.
        

          In the
          sinusoidal steady state,
          phasor currents and voltages obey Kirchhoff's laws and the element
          i-υ
          relationships are written in terms of impedances.
          Impedance
          can be defined as the ratio of phasor voltage over phasor current and has the units of ohms Ω.
          Admittance
          can be defined as the ratio of phasor current over phasor voltage and has the units of seimens S. The device and connection constraints for phasor circuit analysis have the same form as resistance circuits.
        
Phasor circuit analysis techniques include series equivalence, parallel equivalence, circuit reduction, Thévenin's and Norton's theorems, unit output method, superposition, node-voltage analysis, and mesh-current analysis.

          In the sinusoidal steady state, the equivalent impedance at a pair of terminals is
          Z
          (
          j
          ω) =
          R
          (ω) +
          jX
          (ω), where
          R
          (ω) is called
          resistance
          and
          X
          (ω) is called
          reactance.
          A frequency at which an equivalent impedance is purely real is called a
          resonant frequency
          ω
          0
          . Admittance is the reciprocal of impedance.
        

          In the sinusoidal steady state, the instantaneous power to a passive element is a periodic function at twice the frequency of the driving force. The average power delivered to an inductor or capacitor is zero. The average power delivered to a resistor is
          
          . The maximum average power is delivered by a fixed source to an adjustable load when the source and load impedances are conjugates.
        
Multisim and MATLAB are powerful tools that can greatly simplify the analysis of phasor circuits.





        Chapter 8 Problems
      






            Objective 8-1 Sinusoids and Phasors (
            Sect. 8-1
            )
          
Given a sinusoid in polar or rectangular form:

(a) Convert it into a phasor or vice versa.
(b) Use the additive and derivative properties of phasors to combine or otherwise manipulate sinusoids or phasors and write or plot resultant phasors or sinusoids.


            See
            Examples 8-1
            to
            8-4
            and
            Exercises 8-1
            to
            8-6
            .
          





8-1
          Transform the following sinusoids into phasor form and draw a phasor diagram. Use the additive property of phasors to find υ
          1
          (
          t
          ) +
          υ
2
          (
          t
          ).
          

(a)
υ
1
              (
              t
              ) = 240 cos(ω
              t
              + 43) V
            

(b)
υ
2
              (
              t
              ) = 120 cos(ω
              t
              - 225°) V
            





8-2
          Transform the following sinusoids into phasor form and draw a phasor diagram. Use the additive property of phasors to find
          i
1
          (
          t
          ) +
          i
2
          (
          t
          ).
          

(a)
i
1
              (
              t
              ) = -10 sin(ω
              t
              ) mA
            

(b)
i
2
              (
              t
              ) = 6 cos(ω
              t
              ) mA
            






8-3
          Transform the following sinusoids into phasor form and draw a phasor diagram. Use the additive property of phasors to find
          υ
1
          (
          t
          ) +
          υ
2
          (
          t
          ) +
          υ
3
          (
          t
          ).
          

(a)
υ
1
              (
              t
              ) = 480 cos(ω
              t -
              45°) V
            

(b)
υ
2
              (
              t
              ) = 480 cos(ω
              t
              + 73°) V
            

(c)
υ
3
              (
              t
              ) = 480 cos(ω
              t
              + 195°) V
            





8-4
Figure P8-4
          shows two phasor diagrams.
          

(a)
              Add the voltage phasors into a new phasor
              V
3
              . Draw the sum of this new phasor on a phasor diagram.
            

(b)
              Add the current phasors into a new phasor
              I
3
              . Write the sum of the new current phasor in the time domain if the frequency is 50 Hz.
            









FIGURE P8-4












8-5
          Convert the following phasors into sinusoidal waveforms.
          


(a) V
1
                = 220
                
                  e
                  -j

45°
                V, ω = 314.2 rad/s
              



(b) V
2
                = 440
                
                  e
                  -j

225°
                kV, ω = 377 rad/s
              



(c) I
1
                =4
                
                  e
                  -j

15°
                A, ω = 314.2 rad/s
              



(d) I
2
                = 440
                
                  e
                  -j

180°
                µA, ω = 377 rad/s
              






8-6
          Use the phasors below and the additive property to find the sinusoidal waveforms
          υ
3
          (
          t
          ) =
          υ
1
          (
          t
          ) -
          υ
2
          (
          t
          ) and
          i
3
          (
          t
          ) = 2
          i
1
          (
          t
          ) +3
          i
2
          (
          t
          ).
          

V
1
              = 15∠15° V, ω = 2π × 440 rad/s
            

V
2
              = 15∠195° V, ω = 2π × 440 rad/s
            


                I
                1

              = 200∠ - 45° mA, ω = 10
              4
              rad/s
            


                I
                2

              = - 100∠135° mA, ω = 10
              4
              rad/s
            






8-7
          Convert the following phasors into sinusoidal waveforms.
          

(a) V
1
              = 5 +
              j
              5 V, ω = 10 krad/s
            

(b) V
2
              = 2
              j
              (5+
              j
              5) V, ω = 200 rad/s
            

(c) I
1
              = 20 -
              j
              20 -
              
              mA, ω = 314.2 rad/s
            

(d) I
1
              =
              






8-8

          Thinking about the derivative property of phasors as multiplication of the phasor by
          j
          ω, the integral property of phasors should be the inverse operation. Verify that the integration property of phasors is division of the phasor by
          j
          ω.
          

(a)
              Classically integrate the following waveform.
              




(b)
              Then repeat the process using phasors. Which appears to be easier?
            






8-9
          Given the sinusoids
          i
1
          (
          t
          ) = 250 cos (ω
          t
          - 60°) mA and
          i
2
          (
          t
          ) = 750 sin (ω
          t
          ) mA use the additive property of phasors to find
          i
3
          (
          t
          ) such that
          i
1
          (
          t
          ) -
          i
2
          (
          t
          ) +
          i
3
          (
          t
          ) = 0.
        



8-10
          Given a sinusoid
          υ
1
          (
          t
          ) whose phasor is
          
            V
            1

          = 4 -
          j
          3 V and its frequency is 10 rad/s, use phasor methods to find a voltage
          υ
2
          (
          t
          ) that equals 20
          dv
1
          (
          t
          )/
          dt
          - 5
          υ
1
          (
          t
          ).
        




8-11

          The three voltage phasors pictured in
          Figure P8-11
          all have the same magnitude of 10 V and each is shifted from an axis by -45°. Yet these three phasors are all related. One phasor is the basic phasor, the second is the derivative of the first, and the third is the integral of the first. Identify the sinusoids of each.
          







FIGURE P8-11















            Objective 8-2 Impedance (
            Sect. 8-2
            )
          


            Given a linear circuit in the sinusoidal steady state:
          


              (a) Convert R,
              L,
              and
              C
              elements into impedances in the phasor domain.
            
(b) Use series and parallel equivalence to find the equivalent impedance at a specified pair of terminals.

              (c) See
              Example 8-5
              and
              Exercises 8-7
              to
              8-9
              .
            





8-12
          A design engineer needs to know what value of
          R
          ,
          L
          , or
          C
          to use in circuits to achieve a certain impedance.
          

(a)
              At what radian frequency will a 0.015-µF capacitor's impedance equal -
              j
              20 Ω?
            

(b)
              At what radian frequency will a 33-mH inductor's impedance equal
              j
              20 Ω?
            

(c)
              At what radian frequency will a 100-Ω resistor's impedance equal 20 Ω?
            







8-13

          For the circuit of
          Figure P8-13


(a)
              Find the equivalent impedance
              Z
              when ω = 2000 rad/s. Express the result in both polar and rectangular forms.
            

(b)
              Select standard values from
              Appendix G
              to realize the results ± 10% from part (a).
            









FIGURE P8-13












8-14
          Find the equivalent impedance
          Z
          in
          Figure P8-14
          .
          

(a)
              If ω = 5 krad/s, what two elements (
              R, L,
              and/or
              C
              ) could be used to replace the phasor circuit?
            

(b)
              Simulate the circuit in Multisim. Drive the circuit with a 1-V sinusoid at 5000 rad/s but in hertz. Have Multisim find
              Z
IN
              by asking for
              V
IN
              /
              I
IN
              . How does the result compare with that calculated in part (a)?
            

(c)
              Sketch a phasor diagram of
              V
IN
              and
              I
IN
              .
            









FIGURE P8-14












8-15
          A certain
          RLC
          series load has a load impedance of
          Z
          = 1000 -
          j
          998 Ω when excited by a 1-krad/s source and a
          
Z
            = 1000 -
            j
            80 Ω when driven by a 10-krad/s source. Find the values of
            R, L,
            and
            C.





8-16

          The passive network in
          Figure P8-16
          can be connected in several different ways to attain various impedances. It is purported that the circuit is in resonance in two of the three possible connections (
          Z
AC
          ,
          Z
AB
          ,
          Z
BD
          ) when excited by 159.155 Hz. Prove or disprove this claim.
          







FIGURE P8-16












8-17
          The circuit in
          Figure P8-17
          is operating in the sinusoidal steady state with ω = 10 krad/s.
          

(a)
              What is the equivalent impedance of the circuit?
            

(b)
              If one wanted to cancel the effect of the reactance, that is, place the circuit in resonance, what element would one place in series with the circuit?
            

(c)
              With the element introduced in part (b), if the resistor were to be changed to 300 Ω, would the circuit still be in resonance?
            









FIGURE P8-17












8-18
          The circuit in
          Figure P8-18
          is operating in the sinusoidal steady state with ω = 100 krad/s.
          

(a)
              Find the equivalent impedance
              Z.


(b)
              What circuit element can be added in series with the equivalent impedance to place the circuit in resonance?
            

(c)
              Using the equivalent circuit found in part (a), add the new element found in part (b). Then using Multisim do an ac sweep of
              Z
IN
              . Using the cursor, detect the minimum and compare that value with the value calculated. How do they compare?
            









FIGURE P8-18












8-19
          The circuit of
          Figure P8-19
          is operating at 50 Hz. Find the equivalent impedance
          Z
          .
          







FIGURE P8-19











8-20
          The equivalent impedance in
          Figure P8-20
          is known to be
          Z
          = 30 +
          j
          90 Ω. Find the impedance of the inductor.
          







FIGURE P8-20












8-21

          A capacitor
          C
          is connected in parallel with a resistor
          R
          . Select values of
          R
          and
          C
          so that the equivalent impedance of the parallel combination is 600 -
          j
          800 Ω at ω = 1 Mrad/s.
        



8-22

          The circuit in
          Figure P8-22
          is excited by a 10-krad/s sinusoidal source. As the circuit's designer, select a capacitor
          C
          such that the impedance
          Z
          looking into the circuit is all real.
          







FIGURE P8-22











8-23
          Two impedances
          Z
1
          = 100 -
          j
          50 Ω and
          Z
2
          = 500 +
          j
          100 Ω are connected in parallel. Find the equivalent impedance of the pair.
        







            Objective 8-3 Basic Phasor Circuit Analysis and Design (
            Sects. 8-3
            and
            8-4
            )
          

(a) Given a linear circuit in the sinusoidal steady state, find phasor responses using equivalent circuits, circuit reduction, Thévenin or Norton equivalent circuits, proportionality, or superposition.
(b) Given a desired phasor response and a sinusoidal input, design a circuit in the sinusoidal steady state that produces the desired response.


            See
            Examples 8-6
            to
            8-10
            ,
            8-12
            to
            8-24
            and
            Exercises 8-10
            to
            8-32
            .
          





8-24
          A voltage source
          V
S
          = 100∠90° V is connected in series to a resistor of 10 Ω and an inductor of
          j
          10 Ω. Find the phasor current
          I
S
          through the circuit. Draw a phasor diagram of the voltage source and the current. Does the current lead or lag the source voltage?
        




8-25 (a)
          Convert the circuit in
          Figure P8-25
          into the phasor domain.
        

(b)
          Find the phasor current flowing through the circuit and the phasor voltages across the capacitor and the resistor.
        

(c)
          Plot all three phasors from (b) on a phasor diagram. Describe if the current leads or lags the capacitor voltage.
          







FIGURE P8-25











8-26
          The circuit in
          Figure P8-26
          is operating in the sinusoidal steady state. Find the phasor current and the two element voltages. Is the phasor voltage across the capacitor leading or lagging the current?
          







FIGURE P8-26













8-27
          A complex load is driven by a current source
          i
          (
          t
          ) = 10 cos (2 k
          t
          ) mA. The voltage measured across the load is
          υ
          (
          t
          ) = 100 cos(2 k
          t
          - 85°) V. Find the impedance of the load and determine what two elements R,
          L,
          and/or
          C
          are equivalent to it.
        



8-28
          A current source delivering
          i
          (
          t
          ) = 120 cos (500
          t
          ) mA is connected across a parallel combination of a 10-kΩ resistor and a 0.2-µF capacitor. Find the steady-state current
          i
R
          (
          t
          ) through the resistor and the steady-state current
          i
C
          (
          t
          ) through the capacitor. Draw a phasor diagram showing
          I, I
C
          , and
          I
R
          .
        




8-29
          The circuit in
          Figure P8-29
          is operating in the sinusoidal steady state with
          i
S
          (
          t
          ) =
          I
A
          cos (ω
          t
          ). Derive general expressions for the steady-state responses
          V
R
          and
          I
C
          .
          







FIGURE P8-29











8-30
          A practical voltage source can be modeled using an ideal voltage source
          υ
S
          (
          t
          ) = 120 cos(2000
          t
          ) V in series with a50-Ω resistor. Convert the source into the phasor domain and then do a source transformation into a current source in parallel with an impedance. connect the newly found current source with two new elements in parallel—a 200-Ω resistor and a 100 mH-inductor. Find the time-domain current through the inductor using a current divider.
        




8-31
          A circuit consisting of a resistor, capacitor, and inductor is driven by a sinusoidal voltage source
          V
S
          with a 1 krad/s frequency. A phasor diagram of the source and the individual current through each element is shown in
          Figure P8-31
          . Find the impedance of each component and their values and draw a circuit that the phasor diagram could represent.
          







FIGURE P8-31












8-32
          Select
          Z
X
          in
          Figure P8-32
          so that
          V
R
          = 100∠0° V. Validate your solution using Multisim. (
          Hint:
          Let ω = 100 rad/s.)
          







FIGURE P8-32












8-33
          The circuit in
          Figure P8-33
          is operating in the sinusoidal steady state. Find the steady-state responses
          υ
X
          (
          t
          ) and
          i
X
          (
          t
          ).
          







FIGURE P8-33











8-34
          Use the unit-output method to find
          V
X
          and
          I
X
          in the circuit of
          Figure P8-34
          .
          







FIGURE P8-34












8-35
          The circuit in
          Figure P8-35
          is driven by a 100-krad/s source and is operating in the sinusoidal steady-state. Use Multisim to find the steady-state phasor response
          V
x
          .
          







FIGURE P8-35












8-36
          The circuit in
          Figure P8-36
          is operating in the sinusoidal steady state.
          

(a)
              Use superposition to find the response
              υ
X
              (
              t
              ).
            

(b)
              Use Multisim to validate your response in part (a).
            



Note:


              The sources do not have the same frequency.
            









FIGURE P8-36













8-37
          An
          RC
          series circuit is excited by a sinusoidal source
          υ
          (
          t
          ) =
          V
A
          cos(ω
          t
          + ϕ) V. Determine the effects on the magnitudes of the current, voltages, and impedances caused by changes in the source parameters. Complete the following table. A few cells have been filled in as a guide.
          







8-38
          The circuit in
          Figure P8-38
          is operating in the sinusoidal steady state.
          

(a)
              Use superposition to find the response
              υ
X
              (
              t
              ).
            

(b)
              Validate your answer using Multisim.
            









FIGURE P8-38












8-39
          The circuit in
          Figure P8-39
          is operating in the sinusoidal steady state. Use superposition to find the response
          υ
X
          (
          t
          ).
          


Note:


            The sources do not have the same frequency.
          








FIGURE P8-39











8-40
          The bridge circuit in
          Figure P8-40
          is operating in the sinusoidal steady state.
          

(a)
              Find the Thévenin equivalent circuit seen by
              Z
X
              .
            

(b)
              Is the bridge balanced, that is,
              V
X
              = 0?
            

(c)
              Suppose
              Z
X
              was a 20-Ω resistor. How much power would be dissipated in it?
            









FIGURE P8-40












8-41

          The OP AMP circuit of
          Figure P8-41
          has
          V
S
          = 2 ∠-15° V,
          Z
S
          = 50∠ + 30° Ω,
          Z
F
          = 100 ∠-45° Ω, and a
          V
CC
          of ± 15 V.
          

(a)
              Find the output voltage
              V
O
              across and the current
              I
O
              through
              Z
L
              when it is 1000 ∠0° Ω.
            

(b)
              Find the output voltage
              V
O
              across and the current
              I
O
              through
              Z
L
              when it is 500 ∠
              -
              90° Ω.
            

(c)

              Explain what would happen to the output if the input voltage is
              V
S
              = 9 ∠0° V.
            









FIGURE P8-41












8-42

          Design an equivalent
          Z
S
          = 50∠ + 30 Ω,
          Z
F
          = 100 ∠-45° Ω, and
          Z
L
          = 500 ∠-90° Ω, if the circuit of
          Figure P8-41
          is operating in the steady state at a frequency of 1000 rad/s. Simulate the circuit in Multisim if the input is
          V
S
          = 2 ∠-15° V. Find
          υ
L
          (
          t
          )and
          i
L
          (
          t
          ).
        




8-43
          The circuit in
          Figure P8-43
          is operating in the sinusoidal steady state. Use the unit-output method to find the phasor responses
          V
X
          and
          I
X
          .
          







FIGURE P8-43













8-44
          For the circuit in
          Figure P8-44
          , do the following:
          

(a)
              Find the phasor Thévenin equivalent of the source circuit to the left of the interface by hand. Then use Multisim to validate your Thévenin circuit.
            

(b)
              Use the equivalent circuit to find the phasor voltage
              V
              and current
              I
              delivered to the load by hand calculations. Then use Multisim to validate your voltage and current results.
            









FIGURE P8-44












8-45

(a)
          The circuit in
          Figure P8-45
          is operating in the sinusoidal steady state. When
          Z
L
          = 0, the phasor current at the interface is
          I
          = 4.8 -
          j
          3.6 mA. When
          Z
L
          = -
          j
          20 kΩ, the phasor interface current is
          I
          =10
          +j
          0 mA. Find the Thévenin equivalent of the source circuit.
        

(b)
          Design a load so that
          V
L
          = 274 ∠-71.6° V.
          







FIGURE P8-45













            8-46
            
            (a)
          
          Design a linear source circuit that will deliver an output phasor
          V
O
          = 30∠45° V when an input voltage
          υ
S
          (
          t
          ) = 120 cos(377
          t
          ) V is applied in
          Figure P8-46
          .
        

(b)
          Apply your design to a load consisting of a 21.21-Ω resistor in series with a 56.26-mH inductor and determine the load current,
          i
L
          (
          t
          ). Isolate your source circuit from your load with an OP AMP follower.
        

(c)
          Simulate your completed design and load using Multisim.
          







FIGURE P8-46














            8-47
            

          A load of
          Z
L
          = 1000 +
          j
          1000 Ω is to be driven by a phasor source
          V
S
          = 150 ∠0° V. The voltage across the load needs to be
          V
L
          = 100 ∠0° V. Design an interface that will meet these conditions. Validate your answer using Multisim. Assume the source is operating at 1000 rad/s.
        





            8-48
            

          Design an interface circuit so that an input voltage
          υ
S
          (
          t
          ) = 100 cos (2 × 10
          4
t
          ) V delivers a steady-state output current of
          i
O
          (
          t
          ) = 10 cos(2 × 10
          4
t
          -60°) mA to a 1-kΩ resistive load. Validate your answer using Multisim.
        





8-49
          Refer to the
          RLC
          series circuit shown in
          Figure P8-49
          .
          

(a)
              What is the maximum output voltage
              υ
O
              (
              t
              ) and at what frequency does it occur? Use Multisim and do an ac sweep from 10 Hz to 1 MHz, and then narrow your sweep until you find the frequency at which the peak occurs and the output voltage at that frequency.
            

(b)
              Bandwidth is defined as BW =
              f
H
              -
              f
L
              , where
              f
H
              is the higher frequency at which the magnitude of the output is exactly 0.707 of the maximum value, and
              f
L
              is the lower frequency at which the magnitude of the output is exactly 0.707 of the maximum value. What is the bandwidth of this circuit?
            

(c)
              What is the minimum output voltage
              υ
X
              (
              t
              ) and at what frequency does it occur? Use Multisim and do an ac sweep from 10 Hz to 1 MHz, and then narrow your sweep until you find the frequency at which the minimum occurs and the output voltage at that frequency.
            









FIGURE P8-49















            Objective 8-4 General Circuit Analysis (
            Sect. 8-5
            )
          
Given a linear circuit operating in the sinusoidal steady state, find equivalent impedances and phasor responses using node-voltage or mesh-current analysis.

            See
            Examples 8-25
            to
            8-34
            and
            Exercises 8-33
            to
            8-41
            .
          





8-50
          The circuit in
          Figure P8-50
          is operating in the sinusoidal steady state with ω = 1 krad/s. Use node-voltage analysis to find the steady-state response
          υ
X
          (
          t
          ). Use Multisim to validate your answer.
          







FIGURE P8-50














            8-51
            

          For the phasor circuit in
          Figure P8-51
          :
          

(a)
              Use node-voltage analysis to find the steady-state phasor response
              V
O
              .
            

(b)
              Use mesh-current analysis to find the steady-state phasor response
              V
O
              .
            

(c)
              Which method was easier to solve and why?
            









FIGURE P8-51












8-52
          Use MATLAB and mesh-current analysis to find the branch currents
          I
1
          ,
          I
2
          , and
          I
3
          in
          Figure P8-52
          .
          







FIGURE P8-52













8-53
          Use mesh-current analysis to find the phasor branch currents
          I
1
          ,
          I
2
          , and
          I
3
          in the circuit shown in
          Figure P8-53
          . Validate your answer using Multisim.
          







FIGURE P8-53












8-54
          Use mesh-current analysis to find the phasor branch currents
          I
1
          ,
          I
2
          , and
          I
3
          in the circuit shown in
          Figure P8-54
          .
          







FIGURE P8-54













8-55
          Use MATLAB and mesh-current analysis to find the phasor currents
          I
A
          and
          I
B
          in
          Figure P8-55
          .
          







FIGURE P8-55













            8-56
            

          The OP AMP circuit in
          Figure P8-56
          is operating in the sinusoidal steady state.
          

(a)
              Show that
              


(b)
              Find the value of the magnitude of
              V
O
              /
              V
S
              at ω = 0 and as ω → ∞. At the two frequency extremes, what typical OP AMP circuit does each resemble?
            

(c)
              Design the OP AMP circuit so that the gain as ω → ∞ equals 5. Then select appropriate values of
              R
1
              ,
              R
2
              , and
              C
              so that the gain at 10 krad/s is 3.5355.
            

(d)
              Validate your design using Multisim by doing an ac sweep from 10 Hz to 100 kHz and then use Grapher View's cursor to find the gain at a frequency of 10 krad/s.
            









FIGURE P8-56












8-57
          The circuit in
          Figure P8-57
          is operating in the sinusoidal steady state.
          

(a)
              If
              υ
S
              (
              t
              ) = 1 cos(2128
              t
              ) V, find the output
              υ
O
              (
              t
              ).
            

(b)
              At what frequency is the magnitude of the output voltage equal to half of the magnitude of the input voltage in the circuit of
              Figure P8-57
              ? Use Multisim and do an ac sweep from 1 Hz to 100 kHz, and then use Grapher View's cursor to find the desired frequency.
            









FIGURE P8-57













8-58

          For the circuit in
          Figure P8-58
          , find the three phasor branch currents as follows:
          

(a)
              Write a set of mesh-current equations. You can reduce the number of mesh equations by doing a source transformation with the current source and inductor.
            

(b)
              Write the equations in standard form and arrange them in an appropriate matrix.
            

(c)
              Use MATLAB's matrix approach (see
              Example 8-34
              ) to solve the equations. Find the branch currents from the mesh currents.
            

(d)
              Write a set of node-voltage equations. You can reduce the number of node equations by doing a source transformation with the 50-V source and the 1-kΩ resistor.
            

(e)
              Write the equations in standard form and arrange them in an appropriate matrix.
            

(f)
              Use MATLAB's matrix approach (see
              Example 8-34
              ) to solve the equations. Find the branch currents from the node voltages and the suitable impedances.
            

(g)
              Compare the two analysis techniques. Was one more efficient than the other? Explain.
            









FIGURE P8-58












8-59
          The circuit in
          Figure P8-59
          is operating in the sinusoidal steady state. The output is measured as
          V
O
          = 300 +
          j
          200. Find the input
          V
S
          that will produce the output
          V
O
          .
          







FIGURE P8-59












8-60
          The circuit in
          Figure P8-60
          is operating with ω = 20 krad/s.
          

(a)
              Find the phasor outputs
              V
O
              and
              I
O
              in
              Figure P8-60
              when μ = 50 and the phasor input is
              I
S
              = 1+
              j
              1 mA.
            

(b)
              Use Multisim to verify your results above.
            









FIGURE P8-60













8-61
          For the circuit of
          Figure P8-61
          find the Thévenin equivalent circuit seen at the output.
          







FIGURE P8-61












8-62

          The two competing OP AMP circuits in
          Figure P8-62
          are operating in the sinusoidal steady state with ω = 100 krad/s. The two manufacturers both claim that their circuit meets the following specifications:
          





Voltage gain at 100 krad/s must be 1.414.
Voltage gain as ω → ∞ must approach 0.
Voltage gain at dc must be 2.0.
Cost: Circuit (a) $1.25 each, or $0.50 in quantity, circuit
(b) $1.05 each, $0.60 in quantity.





(a)
              Find the magnitude of the ratio of the output phasor
              V
2
              to the input phasor
              V
1
              at each specification frequency for each circuit.
            

(b)
              Use MATLAB to plot the log of |
              V
2
              /
              V
1
              | versus the log of the frequency ω. Comment on the function of the circuit from the plot.
            

(c)
              Use Multisim and do an ac sweep from 100 rad/s to 100 Mrad/s (recall Multisim uses Hz) and comment on the function of the circuit from the plot by Grapher View.
            

(d)
              Which circuit would you buy, if either? Explain.
            









FIGURE P8-62













8-63
          The bridge circuit in
          Figure P8-63
          is operating in the sinusoidal steady state. Find
          I
AB
          .
          







FIGURE P8-63











8-64
          Find the phasor gain
          K
          =
          V
O
          /
          V
S
          and input impedance Z
          IN
          of the circuit in
          Figure P8-64
          .
          







FIGURE P8-64












8-65
          In the circuit shown in
          Figure P8-65
          , there is an unknown element
          Z
X
          . The task is to determine the phasor gain and the output impedance
          Z
OUT
          of the circuit. Before those can be determined, the unknown element needs to be found. If the input impedance was measured to be
          Z
IN
          = 200 -
          j
          100 Ω:
          

(a)
              Find the unknown impedance
              Z
X
              of the circuit.
            

(b)
              Find the output impedance
              Z
OUT
              of the circuit.
            

(c)
              Find the phasor gain
              K
              =
              V
O
              /
              V
S
              .
            









FIGURE P8-65















            Objective 8-5 Average Power and Maximum Power Transfer (
            Sect. 8-6
            )
          
Given a linear circuit in the sinusoidal steady state:

(a) Find the average power delivered at a specified interface.
(b) Find the maximum average power available at a specified interface.
(c) Find the load impedance required to draw the maximum available power.


            See
            Examples 8-35
            and
            8-36
            and
            Exercises 8-42
            and
            8-43
            .
          




8-66
          A load consisting of a 3.3-kΩ resistor in series with a 3.3-µF capacitor is connected across a voltage source
          υ
S
          (
          t
          ) = 339.4 cos (314.2
          t
          ) V. Find the phasor voltage, current, and average power delivered to the load.
        





8-67
          The circuit in
          Figure P8-67
          is operating in the sinusoidal steady state at a frequency of 10 krad/s.
          

(a)
              Use Multisim to find the average power
              P
              delivered to the 100-Ω resistor.
            

(b)
              Find the Thévenin equivalent circuit that the resistor sees.
            

(c)
              By varying the value of the resistor, estimate the maximum average power that can be obtained at the resistor.
            









FIGURE P8-67












            8-68
            

          You have a task of designing a load that ensures maximum power is delivered to it. The load needs to be connected to a source circuit that is not readily observable, but that you can make measurements at its output terminals. You measure the open-circuit voltage and read 120∠0° V. You then connect a known load of 100 +
          j
          100 Ω and you measure 47.1∠11.3° V across it.
          

(a)
              Design your load for maximum power transfer.
            

(b)
              Find the maximum average power delivered to your load.
            







            8-69
            

          The load in
          Figure P8-69
          needs to be designed for maximum power transfer.
          

(a)
              Find the maximum available average power at the interface shown in the figure.
            

(b)
              Specify the load required to extract the maximum average power.
            









FIGURE P8-69













        Integrating Problems
      


8-70

          AC Voltage Measurement
          
            An ac voltmeter measurement indicates the amplitude of a sinusoid and not its phase angle. The magnitude and phase can be inferred by making several measurements and using KVL. For example,
            Figure P8-70
            shows a relay coil of unknown resistance and inductance. The following ac voltmeter readings are taken with the circuit operating in the sinusoidal steady state at
            f
            = 60Hz: |
            V
S
            | = 24 V,
            |V
1
            | = 10 V, and |
            V
2
            | = 18 V. Find
            R
            and
            L.









FIGURE P8-70












8-71


          Home Power Distribution
          
            The circuit of
            Figure P8-71
            emulates a typical 60-Hz residential power system. There are three wires entering the house, two are called "hot" and the remaining one is called the return or "neutral." Each hot line is protected by a circuit breaker—but not the return. In the "house," appliances such as lights, toasters, and electronics are connected between one of the hot wires and the neutral. Large appliances such as ovens and dryers are connected between the two hot wires. Appliances are designed to operate with either 120 V or 240 V within a few volts either way.
          


(a)
              Show that if
              R

1

              and
              R

2

              are equal,
              I
N
              = 0 and
              V
1
              =
              V
2
              .
            

(b)
              Consider a typical power draw where an
              R
1
              is, for example, a 130-Ω light bulb,
              R
2
              a 40-Ω toaster, and
              R
3
              10-Ω clothes dryer. Find the phasors
              V
1
              and
              V
2
              and find
              I
N
              .
            

(c)
              Based on your results in (a) and (b), is the neutral line even necessary? Open the neutral line, that is, force
              I
N
              = 0, and again find the voltages
              V
1
              and
              V
2.
              What is your answer? Would your home be better protected by adding a breaker to the return line?
            

(d)
              Simulate the circuit in Multisim and validate your results. The source frequency is 60 Hz.
            









FIGURE P8-71











8-72

          OP AMP Bandpass Filter
          
            Use the analysis methods discussed in
            Example 8-30
            to find the input-output relationship
            V
O
            /
            V
S
            for the active bandpass filter of
            Figure P8-72
            . Treat each stage separately and then multiply the input-output relationships from each stage to obtain the overall input-output relationship. Select
            R
            and
            C
            values so that the low cutoff frequency is 2 krad/s, the upper cutoff frequency is 200 krad/s, and the magnitude of the passband gain is 20 dB.
          








FIGURE P8-72











8-73


          Power Transmission Efficiency
          
            A power transmission circuit with a source voltage of
            V
S
            = 880 +
            j
            0 V can be modeled as shown in
            Figure P8-73
            .
          


(a)
              Find the average power produced by the source, lost in the wires, and delivered to the load.
            

(b)
              What is the transmission efficiency defined as η =
              P
L
              /
              P
S
              ?
            

(c)
              Design a solution to improve the efficiency. Note the frequency is 60 Hz.
            









FIGURE P8-73












8-74

          50-Hz Filter
          
            A 1-kΩ resistor models an important and sensitive laboratory instrument. The instrument measures a desired signal that varies from 1 Hz to 500 Hz. However, interference from power lines in the laboratory causes the instrument to saturate. A vendor has designed a device that he claims will essentially eliminate a 50-Hz signal from the instrument with only the smallest attenuation to other frequencies. The interface circuit is shown in
            Figure P8-74
            . Connect the vendor's circuit to the model for the instrument and analyze its performance to determine if it will do the job.
          








FIGURE P8-74











8-75

          AC Circuit Design
          
            Select values of
            L
            and
            C
            in
            Figure P8-75
            so that the input impedance seen by the voltage source is 50 +
            j
            0 Ω when the frequency is ω = 10
            6
            rad/s. For these values of
            L
            and
            C,
            find the output Thévenin impedance seen by the 300-Ω load resistor.
          








FIGURE P8-75











8-76

          AC Circuit Analysis
          
            Ten years after graduating with a BSEE, you decide to go to graduate school for a master's degree. In desperate need of income, you agree to sign on as a grader in the basic circuit analysis course. One of the problems asks the students to find
            υ
            (
            t
            ) in
            Figure P8-76
            when the circuit operates in the sinusoidal steady state. One of the students offers the following solution:
          



Is the answer correct? If not, what grade would you give the student? If correct, what comments would you give the student about the method of solution?








FIGURE P8-76












8-77


          Three-Phase Power
          
Figure P8-77
            shows a three-phase power system that is used in a manufacturing plant. The three sources are shown in the phasor diagram, with
            V
P
            given as 339.5 V. The system is driving three balanced inductive loads of Z
            Y
            = 25+
            j
            1.88 Ω each. The system frequency is 60 Hz.
          


(a)
              Build the circuit in Multisim and calculate the four currents
              I
A
              ,
              I
B
              ,
              I
C
              , and
              I
N
              . Ground the circuit at node N. To measure
              I
N
              , insert a tiny resistor of 1 μΩ at point X. Plot the resulting currents (except
              I
N
              ) on the phasor diagram.
            

(b)
              Find the line-to-line voltages, that is
              V
AB
              ,
              V
BC
              , and
              V
CA
              , and plot those on a phasor diagram. How are they related to the three source voltages?
            

(c)
              To save money, the plant manager posits that since there is almost no current flowing in
              I
N
              that it need not be wired. Comment on the manager's idea.
            









FIGURE P8-77












Note




1

Y
            is a general phasor, a
            V
            or an
            I,
            it is not an admittance
            Y
            with the units of Siemens (S).
          















CHAPTER 9

LAPLACE TRANSFORMS







My method starts with a complex integral; I fear this sounds rather formidable; but it is really quite simple ... I am afraid that no physical people will ever try to make out my method: but I am hoping that it may give them confidence to try your methods.


            Thomas John Bromwich, 1915,
            
            British Mathematician
          






Some History Behind This Chapter
Laplace transforms have their roots in the pioneering work of the eccentric British engineer Oliver Heaviside (1850-1925). His operational calculus was essentially a collection of intuitive rules that allowed him to formulate and solve important technical problems of his day. His intuitive approach drew bitter criticism from the scientists of his day. Eventually individuals like John Bromwich recognized the importance of Heaviside's methods as noted in his missive to him in the quote above, and began to develop the necessary mathematical foundations. A complete development was eventually discovered in the 1780 writings of the French mathematician Pierre Simon Laplace and the transforms now bear his name.









Why This Chapter Is Important Today
The difficulties of finding transient responses using classical differential equations are avoided when we apply the techniques of Laplace transforms. These techniques not only simplify the solution of circuit differential equations but also give us a deeper insight into circuit behavior. Transient response, frequency response, and even phasor techniques come together once Laplace transforms and techniques are understood. Laplace transforms make the analysis and design of circuits easy and maybe even fun.









Chapter Sections



9-1 Signal Waveforms and Transforms






9-2 Basic Properties and Pairs






9-3 Pole-Zero Diagrams






9-4 Inverse Laplace Transforms






9-5 Circuit Response Using Laplace Transforms






9-6 Initial and Final Value Properties












Chapter Learning Objectives

9-1
              Laplace Transform (
              Sects. 9-1
              -
              9-3
              )
            
Find the Laplace transform of a given signal waveform using transform properties and pairs, using the integral definition of the Laplace transformation, or using software applications. Locate the poles and zeros of the transform and construct a pole-zero diagram.

9-2
              Inverse Transforms (
              Sect. 9-4
              )
            

(a) Find the inverse transform of a given Laplace transform using partial fraction expansion, basic transform properties and pairs, or using software tools.
(b) Given a pole-zero diagram, find the respective transform.


9-3
              Circuit Response Using Laplace Transforms (
              Sect. 9-5
              )
            
Given a first- or second-order circuit:

(a) Determine the circuit differential equation and the initial conditions (if not given).

                (b) Transform the differential equation into the
                s
                domain and solve for the response transform.
              
(c) Use the inverse transformation to find the response waveform.


9-4
              Initial and Final Value Properties (
              Sect. 9-6
              )
            
Given the Laplace transform of a signal, find the initial and final values of the signal waveform.






          9-1 Signal Waveforms and Transforms
        
A mathematical transformation employs rules to change the form of data without altering its meaning. An example of a transformation is the conversion of numerical data from decimal to binary form. In engineering circuit analysis, transformations are used to obtain alternative representations of circuits and signals. These alternate forms provide a different perspective that can be quite useful or even essential. Examples of the transformations used in circuit analysis are the Fourier transformation, the Z-transformation, and the Laplace transformation. These methods all involve specific transformation rules, make certain analysis techniques more manageable, and provide a useful viewpoint for circuit and system design.

          This chapter deals with the Laplace transformation. The process of applying the Laplace transformation for circuit analysis follows the path shown by the solid arrow in
          Figure 9-1
          and involves three major steps.
        

STEP 1
The process begins with a linear circuit from which we derive a differential equation describing the circuit response.


STEP 2
We transform this equation into the frequency domain using the Laplace transformation, where it becomes an algebraic equation. Algebraic techniques are then used to solve the transformed equation for the circuit response transform.


STEP 3
Taking the inverse Laplace transformation then changes the frequencydomain response into the response waveform in the time domain ending the process.


          The dashed arrow in
          Figure 9-1
          shows that there is another route to the timedomain response using the classical techniques discussed in
          Chapter 7
          . The classical approach appears to be more direct, but the advantage of the Laplace transformation is that solving a differential equation becomes an algebraic process and reveals properties of the circuit not easily seen in the classical approach.
        

          We will apply this approach in
          Section 9-5
          , but first we need to develop the Laplace transform.
        







FIGURE 9-1



Flow diagram of dynamic circuit analysis with Laplace transforms.





          Symbolically, we represent the Laplace transformation as
        


(9-1)




          This expression states that
          F
          (
          s
          ) is the Laplace transform of the waveform
          f
          (
          t
          ). The transformation operation involves two domains: (1) the time domain, in which the signal is characterized by its
          waveform
f
          (
          t
          ), and (2) the complex frequency domain, in which the signal is represented by its
          transform
F
          (
          s
          ).
        

          The symbol
          s
          stands for the complex frequency variable, a notation we first introduced in
          Chapter 7
          in connection with the zero-state response of linear circuits. The variable
          s
          has the dimensions of reciprocal time, or frequency, and is expressed in units of radians per second. In this chapter, the complex frequency variable is written as
          s
          = σ +
          jω,
          where σ = Re{
          s
          } is the real part and ω = Im{
          s
          } is the imaginary part. This variable is the independent variable in the
          s
          domain, just as
          t
          is the independent variable in the time domain. Although we cannot physically measure complex frequency in the same sense that we measure time, it is an extremely useful concept that pervades the analysis and design of linear systems.
        

          A signal can be expressed as a waveform or a transform. Collectively,
          f
          (
          t
          ) and
          F
          (
          s
          ) are called a
          transform pair
          , where the pair involves two representations of the signal. To distinguish between the two forms, a lowercase letter denotes a waveform and an uppercase a transform. For electrical waveforms such as current
          i
          (
          t
          ) or voltage υ(
          t
          ), the corresponding transforms are denoted
          I
          (
          s
          ) and
          V
          (
          s
          ). In this chapter, we will use
          f
          (
          t
          ) and
          F
          (
          s
          ) to stand for signal waveforms and transforms in general, that is, υ(
          t
          ),
          i
          (
          t
          ) or
          V
          (
          s
          ),
          I
          (
          s
          ).
        

          The
          Laplace transformation
          is defined by the integral
        



(9-2)





          Since the definition involves an improper integral (the upper limit is infinite), we must discuss the conditions under which the integral exists (converges). The integral exists if the waveform
          f
          (
          t
          ) is piecewise continuous and of exponential order.
          Piecewise continuous
          means that
          f
          (
          t
          ) has a finite number of steplike discontinuities in any finite interval.
          Exponential order
          means that constants
          K
          and
          b
          exist such that |
          f
          (
          t
          )| <
          Ke

bt

          for all
          t
          > 0. As a practical matter, the signals encountered in engineering applications meet these conditions.
        

          From the integral definition of the Laplace transformation, we see that when a voltage waveform υ(
          t
          ) has units of volts (V), the corresponding voltage transform
          V
          (
          s
          ) has units of volt-seconds (V-s). Similarly, when a current waveform
          i
          (
          t
          ) has units of amperes (A), the corresponding current transform
          I
          (
          s
          ) has units of ampereseconds (A-s). Thus, waveforms and transforms do not have the same units. Even so, we often refer to both
          V
          (
          s
          ) and
          v
          (
          t
          ) as voltages and both
          I
          (
          s
          ) and
          i
          (
          t
          ) as currents despite the fact that they have different units. The reason is simply that it is awkward to keep adding the words
          waveform
          and
          transform
          to statements when the distinction is clear from the context.
        

          Equation (9-2) uses a lower limit denoted
          t
          = 0- to indicate a time just a whisker before
          t
          = 0. We use
          t
          = 0- because in circuit analysis
          t
          = 0 is defined by a discrete event, such as closing a switch. Such an event may cause a discontinuity in
          f
          (
          t
          ) at
          t
          = 0. To capture this discontinuity, we set the lower limit at
          t
          = 0-, just prior to the event. Fortunately, in many situations, there is no discontinuity so we will not distinguish between
          t
          = 0- and
          t
          = 0 unless it is crucial.
        

          Equally fortunate is the fact that the number of different waveforms encountered in linear circuits is relatively small. The list includes the three basic waveforms from
          
Chapter 5
          (the singularity functions, exponential, and sinusoid), as well as composite waveforms such as the exponential rise, damped ramp, and damped sinusoid. Since the number of waveforms of interest is relatively small, we do not often use the integral definition in
          Eq. (9-2)
          to find Laplace transforms. Once a transform pair has been found, it can be cataloged in a table for future reference and use.
          Table 9-1
          in this chapter is sufficient for our purposes.
        












EXAMPLE 9-1



                  Show that the Laplace transform of the unit step function
                  f
                  (
                  t
                  ) =
                  u
                  (
                  t
                  ) is
                  F
                  (
                  s
                  ) = 1/s.
                




SOLUTION:



              Applying
              Eq. (9-2)
              yields
            




              Since
              u
              (
              t
              ) = 1 throughout the range of integration this integral becomes
            




              The last expression on the right side vanishes at the upper limit since
              e

                -
                st

              goes to zero as
              t
              approaches infinity provided that σ > 0. At the lower limit, the expression reduces to 1/s. The integral used to calculate
              F
              (
              s
              ) is valid only in the region for which σ > 0. However, once evaluated, the result
              F
              (
              s
              ) = 1/
              s
              can be extended to neighboring regions provided that we avoid the point at
              s
              = 0 where the function becomes indeterminant. We can add this transform pair to our
              Table 9-1
              .
              ■











Exercise 9-1



              Find the Laplace transform of
              v
              (
              t
              ) = -7
              u
              (
              t
              ) V and
              i
              (
              t
              ) = 100
              u
              (
              t
              ) mA.
            


Answer:



V
              (
              s
              ) = -7/
              s
              V-s and
              I
              (
              s
              ) = 100/s mA-s.
            
















EXAMPLE 9-2



                  Show that the Laplace transform
                  f
                  (
                  t
                  ) = [
                  e

                    -α
                    t

                  ]
                  u
                  (
                  t
                  ) is
                  F
                  (
                  s
                  ) = 1/(
                  s
                  + α).
                




SOLUTION:



              Applying
              Eq. (9-2)
              yields
            




              The last term on the right side vanishes at the upper limit since
              e

                -(
                s
                +α)
                t

              vanishes as
              t
              approaches infinity provided that σ > - α. At the lower limit, the last term reduces to 1/ (
              s
              + α). Again, the integral is valid only for a limited region, but the result
              F
              (
              s
              ) =
              1
              /(
              s
              + α) can be extended outside this region if we avoid the point at
              s
              = - α.
            

              We can add another transform pair to our
              Table 9-1
              , and so forth for the others we derive subsequently.
              ■










Exercise 9-2


              Find the Laplace transform of
              v
              (
              t
              ) = 8
              e

                -5
                t

u 
              ( 
              t 
              ) V and  
              i   
              (  
              t   
              ) = 0.05   
              e
 
                -1000 
                t

u 
              (   
              t  
              ) A.   
            


Answer:



V 
              (    
              s
              ) = 8/(    
              s  
              +5) V-s,   
              I 
              (   
              s   
              ) = 50/(   
              s  
              + 1000) mA-s
            
















EXAMPLE 9-3


                  Show that the Laplace transform of the impulse function
                  f
                  (
                  t
                  ) = δ(
                  t
                  ) is
                  F
                  (
                  s
                  ) = 1.
                




SOLUTION:



              Applying
              Eq. (9-2)
              yields
            




              The difference between
              t
              = 0- and
              t
              = 0 is important since the impulse is zero everywhere except at
              t
              = 0. To capture the impulse in the integration, we take a lower limit at
              t
              = 0- and an upper limit at
              t
              = 0+. Since
              e

                -
                st

              = 1 when
              t
              = 0 and
              
              on this integration interval, we find that
              F
              (
              s
              ) = 1.
              ■










Exercise 9-3


              Find the Laplace transform of
              i
              (
              t
              ) = 0.5 δ(
              t
              ) A and
              υ
              (
              t
              ) = −10 δ(
              t
              ) V.
            


Answer:



I
              (
              s
              ) = 0.5 A-s,
              V
              (
              s
              ) = -10 V-s.
            



Inverse Transformation

            So far, we have used the direct transformation to convert waveforms into transforms. But
            Figure 9-1
            points out the need to perform the inverse transformation to convert transforms into waveforms. Symbolically, we represent the inverse process as
          


(9-3)




            This equation states that
            f
            (
            t
            ) is the inverse Laplace transform of
            F
            (
            s
            ) .The
            inverse Laplace transformation
            is defined by the complex inversion integral
          



(9-4)





            The Laplace transformation is an integral transformation since both the direct process in
            Eq. (9-2)
            and the inverse process in
            Eq. (9-4)
            involve integrations.
          

            Happily, formal evaluation of the complex inversion integral is not necessary because of the uniqueness property of the Laplace transformation. A symbolical statement of the
            uniqueness property
            is
          




            The mathematical justification for this statement is beyond the scope of our treatment.
            
1

            However, the notation (=) means "equal almost everywhere." The only points where equality may not hold is at the discontinuities of
            f
            (
            t
            ).
          

            If we just look at the definition of the direct transformation in
            Eq. (9-2)
            , we could conclude that
            F
            (
            s
            ) is not affected by the values of
            f
            (
            t
            ) for
            t
            < 0. However, when we use
            Eq. (9-2)
            we are not just looking for the Laplace transform of
            f
            (
            t
            ), but a Laplace transform pair such that
            ℒ
            {
            f
            (
            t
            )} =
            F
            (
            s
            ) and
            ℒ
-1
            {
            F
            (
            s
            )} =
            f
            (
            t
            ). The inverse Laplace transformation in
            Eq. (9-4)
            always produces a causal waveform, one that is zero for
            t
            < 0. Hence a transform pair [
            f
            (
            t
            ) ↔
            F
            (
            s
            )] is unique if and only if
            f
            (
            t
            ) is causal. For instance, in
            Example 9-1
            , we show that
            ℒ
            {
            u
            {
            t
            )} = 1/
            s
            ; hence, by the uniqueness property, we know that
            ℒ
-1
            {1/
            s
            }(=)
            u
            (
            t
            ).
          


            For this reason, Laplace transform-related waveforms are written as
            f
            (
            t
            )]
            
u
              (
              t
              )
            
            to make their causality visible. For example, in the next section, we find the Laplace transform of the sinusoid waveform cos ßt. In the context of Laplace transforms, this signal is not an eternal sinusoid but a causal waveform
            f
            (
            t
            ) = [cosβt]
            u
            (
            t
            ). It is important to remember that causality and Laplace transforms go hand in hand when interpreting the results of circuit analysis.
            
2




9-2 Basic Properties and Pairs

            The previous section gave the definition of the Laplace transformation and showed that the transforms of some basic signals can be found using the integral definition. In this section, we develop the basic properties ofthe Laplace transformation and show how these properties can be used to obtain additional transform pairs. We will build a second table for easy reference of all the following basic properties to complement those of the basic signal pairs and place them in
            Table 9-2
            .
          

            The
            linearity
            property of the Laplace transformation states that
          


(9-5)




            where
            A
            and
            B
            are constants. This property is easily established using the integral definition in
            Eq. (9-2)
            :
          




            The integral definition of the inverse transformation in
            Eq. (9-4)
            is also a linear operation, so it follows that
          


(9-6)




            An important consequence of linearity is that for any constant
            K



(9-7)



The linearity property is an extremely important feature that we will use many times in this and subsequent chapters. The next two examples show how this property can be used to obtain the transforms of the exponential rise waveform and of a sinusoidal waveform.











EXAMPLE 9-4


                    Show that the Laplace transform of
                    f
                    (
                    t
                    ) =
                    A
                    (1-
                    e

                      -α
                      t

                    )
                    u
                    (
                    t
                    ) is
                  







SOLUTION:


This waveform is the difference between a step function and an exponential. We can use the linearity property of Laplace transforms to write




                The transforms of the step and exponential functions were found in
                Examples 9-1
                and
                9-2
                . Using linearity, we find that the transform of the exponential rise is
              


■











Exercise 9-4


                Transform the response
                v
                (
                t
                ) = [10
                e

                  -1000
                  t

                - 5]
                u
                (
                t
                ) V of a particular
                RC
                circuit into the Laplace domain.
              


Answer:





















EXAMPLE 9-5



                    Show that the Laplace transform of the sinusoid
                    f
                    (
                    t
                    ) =
                    A
                    [sin(β
                    t
                    )]
                    u
                    (
                    t
                    ) is
                    F
                    (
                    s
                    ) =
                    A
                    β/(
                    s
2
                    + β
                    2
                    ).
                  




SOLUTION:


Using Euler's relationship, we can express the sinusoid as a sum of exponentials.



Subtracting the second equation from the first yields




                The transform pair
                ℒ
                {
                e

                  -α
                  t

                } = 1/(
                s
                + α) in
                Example 9-2
                is valid even if the exponent α is complex. Using this fact and the linearity property, we obtain the transform of the sinusoid as
              


■










Exercise 9-5


                Transform the sinusoid
                i
                (
                t
                ) = 100[sin(200
                t
                )]
                u
                (
                t
                ) mA into the Laplace domain.
              


Answer:















Exercise 9-6


                Use the linearity property to find the Laplace transform of
                f
                (
                t
                ) =
                A
                [cos(β
                t
                )].
              


Answer:



                Start by using cos
                
                then follow
                Example 9-5
                .
              







Integration Property

            In the time domain, the
            i-υ
            relationships for capacitors and inductors involve integration and differentiation. Since we will be working in the
            s
            domain, it is important to establish the
            s
            -domain equivalents of these mathematical operations. Applying the integral definition of the Laplace transformation to a time-domain integration yields
          



(9-8)






            The right side of this expression can be integrated by parts using
          



These definitions result in




            Using these factors reduces the right side of
            Eq. (9-8)
            to
          



(9-9)





            The first term on the right in
            Eq. (9-9)
            vanishes at the lower limit because the integral over a zero-length interval is zero provided that
            f
            (
            t
            ) is finite at
            t
            = 0. It vanishes at the upper limit because
            e

              -
              st

            approaches zero as
            t
            goes to infinity for σ > 0. By the definition of the Laplace transformation, the second term on the right is
            F
            (
            s
            )/
            s
            . We conclude that
          


(9-10)




            The
            integration property
            states that time-domain integration of a waveform
            f
            (
            t
            ) can be accomplished in the
            s
            domain by the algebraic process of dividing its transform
            F
            (
            s
            ) by
            s
            . The next example applies the integration property to obtain the transform of the ramp function.
          











EXAMPLE 9-6


                    Show that the Laplace transform of the ramp function
                    r
                    (
                    t
                    ) =
                    tu
                    (
                    t
                    ) is 1/
                    s
2
                    .
                  




SOLUTION:



                From our study of signals, we know that the ramp waveform can be obtained from
                u
                (
                t
                ) by integration.
              




                In
                Example 9-1
                we found
                ℒ
                {
                u
                (
                t
                )} = 1/
                s
                . Using these facts and the integration property of Laplace transforms, we obtain
              


■










Exercise 9-7


                Let
                v
1
                (
                t
                ) =
                V
A
e

                  -α
                  t

u
                (
                t
                ) V. Show that the Laplace transform of
                
                is equal to
                V
1
                (
                s
                )/
                s
                .
              


Answer:















Exercise 9-8



                  (a) If
                  i
                  (
                  t
                  ) = 6
                  e

                    -1000
                    t

u
                  (
                  t
                  ) mA, find the Laplace transform of
                  
                  .
                


                  (b) If
                  v
1
                  (
                  t
                  ) = 20 δ(
                  t
                  ) V, find the Laplace transform of
                  




Answers:









Differentiation Property

            The time-domain differentiation operation transforms into the
            s
            domain as follows:
          



(9-11)




The right side of this equation can be integrated by parts using



These definitions result in




            Inserting these factors reduces the right side of
            Eq. (9-11)
            to
          



(9-12)





            For σ > 0, the first term on the right side of
            Eq. (9-12)
            is zero at the upper limit because
            e

              -
              st

            approaches zero as
            t
            goes to infinity. At the lower limit it reduces to -
            f
            (0-). By the definition of the Laplace transform, the second term on the right side is
            sF
            (
            s
            ). We conclude that
          



(9-13)





            The
            differentiation property
            states that time-domain differentiation of a waveform
            f
            (
            t
            ) is accomplished in the
            s
            domain by the algebraic process of multiplying the transform
            F
            (
            s
            ) by
            s
            and subtracting the constant
            f
            (0-). Note that the constant
            f
            (0-) is the value of
            f
            (
            t
            ) at
            t
            = 0- just prior to
            t
            = 0.
          

            The
            s
            -domain equivalent of a second derivative is obtained by repeated application of
            Eq. (9-13)
            . We first define a waveform
            g
            (
            t
            ) as
          



Applying the differentiation rule to these two equations yields



Substituting the first of these equations into the second results in



where



Repeated application of this procedure produces the nth derivative:


(9-14)




            where
            f

              (
              n
              -1)
            
            (0-) is the (
            n
            - 1)th derivative of
            f
            (
            t
            ) evaluated at
            t
            = 0-.
          

            A hallmark feature of the Laplace transformation is the fact that time integration and differentiation change into algebraic operations in the
            s
            domain. This observation gives us our first hint as to why it is often easier to work with circuits and signals
            
            in the
            s
            domain. The next example shows how the differentiation rule can be used to obtain additional transform pairs.
          











EXAMPLE 9-7


                    Show that the Laplace transform of
                    f
                    (
                    t
                    ) = [cosβ
                    t
                    ]
                    u
                    (
                    t
                    ) is
                    F
                    (
                    s
                    ) =
                    s
                    /(
                    s
2
                    + β
                    2
                    ).
                  




SOLUTION:



                We can express cos β
                t
                in terms of the derivative of sin β
                t
                as
              




                In
                Example 9-5
                we found ℒ{sin β
                t
                } = β/(
                s
2
                + β
                2
                ). Using these facts and the differentiation rule, we can find the Laplace transform of cos β
                t
                as follows:
              


■










Exercise 9-9


                Let
                v
1
                (
                t
                ) =
                V
A
r
                (
                t
                ) V. Show that the Laplace transform of
                v
2
                (
                t
                ) =
                dV
A
r
                (
                t
                )/
                dt
                V is equal to
                sV
1
                (
                s
                ) -
                v
1
                (0-).
              


Answer:















Exercise 9-10



                  (a) If
                  i
                  (
                  t
                  ) = 30
                  e

                    -1200
                    t

u
                  (
                  t
                  ) mA, find the Laplace transform of
                  
                  .
                

                  (b) Find the Laplace transform for the derivative of
                  v
                  (
                  t
                  ) = δ(
                  t
                  ) V.
                



Answers:



                (a)
                V
                (
                s
                ) =
                sI
                (
                s
                ) -
                i
                (0-) =
                
                (b)
                s
                V. This function is called a
                doublet.





Translation Properties

            The
            
s
              -doniain translation property
            
            of the Laplace transformation is
          




            This theorem states that multiplying
            f
            (
            t
            ) by
            e

              -α
              t

            is equivalent to replacing
            s
            by
            s
            + α (that is, translating the origin in the
            s
            plane by an amount α). In engineering applications, the parameter α is always a real number, but it can be either positive or negative so the origin in the
            s
            domain can be translated to the left or right. Proof of the theorem follows almost immediately from the definition of the Laplace transformation.
          





            The
            s
            -domain translation property can be used to derive transforms of damped waveforms from undamped prototypes. For instance, the Laplace transform of the ramp, cosine, and sine functions are
          




            To obtain the damped ramp, damped cosine, and damped sine functions, we multiply each undamped waveform by
            e

              -α
              t

            . Using the
            s
            -domain translation property, we replace
            s
            by
            s
            + α to obtain transforms of the corresponding damped waveforms.
          




            This application of the s-domain translation property to the ramp, cosine, and sine completes the derivation of a basic set of transform pairs listed in
            Table 9-1
            .
          






Table
                      9-1
                    
BASIC LAPLACE TRANSFORM PAIRS








Signal



                      Waveform
                      f
                      (
                      t
                      )
                    



                      Transform
                      F
                      (
                      s
                      )
                    





Impulse

                    δ(
                    t
                    )
                  
1


Step function

u
                    (
                    t
                    )
                  





Ramp

tu
                    (
                    t
                    )
                  





Exponential








Damped ramp








Sine








Cosine








Damped sine








Damped cosine











            The
            time-domain translation property
            of the Laplace transformation is
          




            The theorem states that multiplying
            F
            (
            s
            ) by
            e

              -
              as

            is equivalent to shifting
            f
            (
            t
            ) to the right in the time domain by an amount
            a
            > 0. In other words, it is equivalent to delaying
            f
            (
            t
            ) in time by an amount
            a
            > 0. Proof of this property follows from the definition of the Laplace transformation.
          





            In this equation, we have used the fact that
            u
            (
            t
            −
            a
            ) is zero for
            t
            <
            a
            and is unity for
            t ≥ a.
            We now change the integration variable from
            t
            to τ =
            t − a.
            With this change of variable, the last integral in this equation takes the form
          



which confirms the statement of the time-domain translation property. A simple application of this property is finding the Laplace transform of the delayed step function.




            In this section, we derived the basic transformation properties listed in
            Table 9-2
            .
          






Table
                      9-2
                    
BASIC LAPLACE TRANSFORMATION PROPERTIES








Properties


Time Domain


Frequency Domain





Independent variable

t


s



Signal representation

f
                    (
                    t
                    )
                  

F
                    (
                    s
                    )
                  


Uniqueness








Linearity








Integration








Differentiation









s
                    -Domain translation
                  









t
                    -Domain translation
                  











            The Laplace transformation has other properties that are useful in signalprocessing applications. We treat two of these properties in the last section of this chapter. However, the basic properties in
            Table 9-2
            are used frequently in circuit analysis and are sufficient for nearly all of the applications in this book.
          

            Similarly,
            Table 9-1
            lists a basic set of Laplace transform pairs that is sufficient for most of the applications in this book. All of these pairs were derived in the preceding two sections.
            Tables 9-1
            and
            9-2
            are repeated in
            Appendix G
            .
          

            All of the waveforms in
            Table 9-1
            are
            causal,
            that is, they have a defined start or beginning. There is a
            u
            (
            t
            ) associated with every waveform. As a result, the Laplace transform pairs are unique and we can use the table in either direction. That is, given an
            f
            (
            t
            ) in the waveform column, we find its Laplace transform in the right column, or given an
            F
            (
            s
            ) in the right column, we find its inverse transform in the waveform column.
          

            The last example in this section shows how to use the properties and pairs in
            Tables 9-1
            and
            9-2
            to obtain the transform of a waveform not listed in the tables.
          












EXAMPLE 9-8


Find the Laplace transform of the waveform







SOLUTION:



                Using the linearity property, we write the transform of
                f
                (
                t
                ) in the form
              





                The transforms of each term in this sum are listed in
                Table 9-1
                :
              



Normally, a Laplace transform is written as a quotient of polynomials rather than as a sum of terms. Rationalizing the preceding sum yields




■

 









Exercise 9-11

Find the Laplace transforms of the following waveforms:


                  (a)
                  f
                  (
                  t
                  ) = [
                  e

                    −2
                    t

                  ]
                  u
                  (
                  t
                  ) + 4
                  tu
                  (
                  t
                  ) −
                  u
                  (
                  t
                  )
                

                  (b)
                  f
                  (
                  t
                  ) = [2 + 2 sin2
                  t
                  − 2 cos2
                  t
                  ]
                  u
                  (
                  t
                  )
                



Answers:















Exercise 9-12

Find the Laplace transforms of the following waveforms:





Answers:















Exercise 9-13


                Find the Laplace transforms of the following waveforms: (
                Hint:
                Use the trig identity: cos (A−B) = cos(A) cos(B) + sin(A) sin(B).)
              


                  (a)
                  f
                  (
                  t
                  =
                  A
                  [cos (β
                  t
                  − ϕ)]
                  u
                  (
                  t
                  )
                

                  (b)
                  f
                  (
                  t
                  =
                  A
                  [
                  e

                    −α
                    t

                  cos (β
                  t
                  − ϕ)]
                  u
                  (
                  t
                  )
                



Answers:

















Exercise 9-14


                Find the Laplace transforms of the following waveforms for
                T
                <0:
              


                  (a)
                  f
                  (
                  t
                  ) =
                  Au
                  (
                  t
                  )−2
                  Au
                  (
                  t
                  −
                  T
                  ) +
                  Au
                  (
                  t
                  − 2
                  T
                  )
                

                  (b)
                  f
                  (
                  t
                  ) =
                  Ae

                    −α(
                    t
                    −
                    T

                  )
                  u
                  (
                  t
                  −
                  T
                  )
                



Answers:












            Software Applications
            



            There are software applications that can be used to find the Laplace transform of a given waveform. In particular, MATLAB has the functions
            laplace
            and
            ilaplace
            , which operate on symbolic expressions to take the Laplace transform and inverse Laplace transform, respectively.
            Example 9-8
            could have been solved using the laplace function as follows:
          






            where MATLAB uses
            heaviside(t)
            for the unit step function
            u
            (
            t
            ). MATLAB would respond with
          





Using MATLAB's simplify function rationalizes the expression yielding






            These are the same results as obtained in the example. Later in
            Example 9-16
            we will look at using the ilaplace function. For additional examples on how to use these software tools, please visit
            Appendix D
            .
          



9-3 Pole - Zero Diagrams

          The transforms for signals in
          Table 9-1
          are ratios of polynomials in the complex frequency variable
          s.
          Likewise, the transform found in
          Example 9-8
          takes the form of a ratio of two polynomials in
          s.
          These results illustrate that the signal transforms of greatest interest to us usually have the form
        


(9-15)




          If numerator and denominator polynomials are expressed in factored form, then
          F
          (
          s
          ) is written as
        



(9-16)





          where the constant
          K
          =
          b

m

          /
          a

n

          is called the
          scale factor
          .
        

          The roots of the numerator and denominator polynomials, together with the scale factor
          K
          , uniquely define a transform
          F
          (
          s
          ). The denominator roots are called
          poles
          because for
          s
          =
          p

i

          = 1,2,...,
          n
          ) the denominator vanishes and
          F
          (
          s
          ) becomes infinite. The roots of the numerator polynomial are called
          zeros
          because the transform
          F
          (
          s
          ) vanishes for
          s
          =
          z

i

          (
          i
          = 1,2,...,
          m
          ). Collectively, the poles and zeros are called
          critical frequencies
          because they are values of
          s
          at which
          F
          (
          s
          ) does dramatic things, like vanish or become indeterminant.
        

          In the
          s
          domain, we can specify a signal transform by listing the location of its critical frequencies together with the scale factor
          K.
          That is, in the frequency domain,
          
          we describe signals in terms of poles and zeros. The description takes the form of a
          pole-zero diagram
          , which shows the location of poles and zeros in the complex
          s
          plane. The pole locations in such plots are indicated by an
          ×
          and the zeros by an
          O
          . The independent variable in the frequency domain is the complex frequency variable
          s,
          so the poles or zeros can be complex as well. In the
          s
          plane, we use a horizontal axis to plot the value of the real part of
          s
          and a vertical /-axis to plot the imaginary part. The /-axis is an important boundary in the frequency domain because it divides the
          s
          plane into two distinct half planes. The real part of
          s
          is negative in the left half plane and positive in the right half plane. As we will soon see, the sign of the real part of a pole has a profound effect on the form of the corresponding waveform.
        

          For example,
          Table 9-1
          shows that the transform of the exponential waveform
          f
          (
          t
          ) =
          e

            -α
            t

u
          (
          t
          ) is
          F
          (
          s
          ) = 1/(
          s
          + α). The exponential signal has a single pole at
          s
          = −α and no finite zeros. The pole-zero diagram in
          Figure 9-2
          (a) is the
          s
          -domain portrayal of the exponential signal. In this diagram the
          ×
          identifies the pole located at
          s
          = −α +
          j
          0, a point on the negative real axis in the left half plane.
        







FIGURE 9-2



(a-c) Pole-zero diagrams in the s plane.




          The damped sinusoid
          f
          (
          t
          ) = [
          e

            −α
            t

          cos β
          t
          ]
          u
          (
          t
          ) is an example of a signal with complex poles. From
          Table 9-1
          the corresponding transform is
        




          The transform
          F
          (
          s
          ) has a finite zero on the real axis at
          s
          = −α. The roots of the denominator polynomial are
          s
          = −α±
          j
          β. The resulting pole-zero diagram is shown in
          Figure 9-2
          (b). The poles of the damped cosine do not lie on either axis in the
          s
          plane because neither the real nor imaginary parts are zero.
        

          Finally, the transform of a unit ramp
          f
          (
          t
          ) =
          tu
          (
          t
          ) is
          F
          (
          s
          ) = 1/
          s
2
          . This transform has no finite zeros and two poles at the origin (
          s
          = 0 +
          j
          0) in the
          s
          plane as shown in
          Figure 9-2
          (c). The poles in all of the diagrams of
          Figure 9-2
          lie in the left half plane or on the
          j
          -axis boundary.
        

          The diagrams in
          Figure 9-2
          show the poles and zeros in the finite part of the
          s
          plane. Signal transforms may have poles or zeros at infinity as well. For example, the step function has a zero at infinity since
          F
          (
          s
          ) = 1/
          s
          approaches zero as
          s
          → ∞. In general, a transform
          F
          (
          s
          ) given by
          Eq. (9-16)
          has a zero of order
          n − m
          at infinity if
          n
          >
          m
          and a pole of order
          m − n
          at infinity if
          n
          <
          m
          . Thus, the number of zeros equals the number of poles if we include those at infinity.
        

          The pole-zero diagram is the
          s
          -domain portrayal of the signal, just as a plot of the waveform versus time depicts the signal in the
          t
          domain. Later, we will see how linear circuits can also be portrayed using pole-zero diagrams. The utility of a pole-zero diagram as a description of circuits and signals will become clearer as we develop additional
          s
          -domain analysis and design concepts.
        












EXAMPLE 9-9

Find the poles and zeros of the waveform







SOLUTION:



              Using the linearity property and the basic pairs in
              Table 9-2
              , we write the transform in the form
            




              Rationalizing this expression yields
              F
              (
              s
              ).
            




              This transform has three zeros and three poles. There are two zeros at
              s
              = 0 and one at
              s
              = ∞. There is a pole on the negative real axis at
              s
              = -2 +
              j
              0, and there are two poles on the imaginary axis at
              s
              = ±
              j
              2. The resulting pole-zero diagram is shown in
              Figure 9-3
              . Reviewing the analysis, we can trace the poles to the components of
              f
              (
              t
              ). The pole on the real axis at
              s
              = -2 came from the exponential
              e

                -2
                t

              , while the complex conjugate poles on the
              j
              -axis came from the sinusoid cos2
              t
              -sin2
              t
              . The zeros, however, are not traceable to specific components. Their locations depend on all three components.
            







FIGURE 9-3







■

 










Exercise 9-15

Find the poles and zeros of the transform of the following waveform and plot the results on a pole-zero diagram.





Answers:



              Zeros:
              s
              = 1, two at
              s
              = ∞; poles: two at
              s
              = 0,
              s
              = -1.
            

              See
              Figure 9-4
              for the pole-zero diagram.
            









FIGURE 9-4


















EXAMPLE 9-10



                  Find the poles and zeros of the transform of the waveform
                  f
                  (
                  t
                  ) = [4-3 cos 500
                  t
                  ]
                  u
                  (
                  t
                  ) and plot the results.
                




SOLUTION:



              Using the linearity property and the basic pairs from
              Table 9-2
              , we write the transform in the form
            




              Rationalizing this expression results in
              F
              (
              s
              ).
            




              The transform has two complex conjugate zeros at
              s
              = ±
              j
              1000, and another at
              s
              = ∞. It has a pole at
              s
              = 0, and a complex conjugate pair at
              s
              = ±
              j
              500. The pole at zero is caused by the step function and the two poles on the imaginary axis are caused by the cosine term. The results are plotted in
              Figure 9-5
              .
            







FIGURE 9-5







■

 










Exercise 9-16


Find the poles and zeros of the transform of the following waveform and plot the results on a pole-zero diagram.





Answers:



              Zeros:
              s
              = -20,
              s
              = ∞; poles:
              s
              = -10±
              j
              200. See
              Figure 9-6
              for the pole-zero diagram.
            









FIGURE 9-6








9-4 Inverse Laplace Transforms

          The inverse transformation converts a transform
          F
          (
          s
          ) into the corresponding waveform
          f
          (
          t
          ). Applying the inverse transformation in
          Eq. (9-4)
          requires knowledge of a branch of mathematics called complex analysis. Fortunately, we do not need
          Eq. (9-4)
          because the uniqueness of the Laplace transform pairs in
          Table 9-1
          allows us to go from a transform to a waveform. This may not seem like much help since it does not take a very complicated circuit or signal before we exceed the listing in
          Table 9-1
          , or even the more extensive tables that are available. However, there is a general method of expanding
          F
          (
          s
          ) into a sum of terms that are listed in
          Table 9-1
          .
        

          For linear circuits, the transforms of interest are ratios of polynomials in
          s
          .In mathematics such functions are called
          rational functions
          . To perform the inverse transformation, we must find the waveform corresponding to rational functions of the form
        



(9-17)





          where
          K
          is the scale factor,
          z

i

          (
          i
          = 1,2,...
          m
          ) are the zeros, and
          p

i

          (
          i
          = 1,2,...
          n
          ) are the poles of
          F
          (
          s
          ).
        

          If there are more finite poles than finite zeros (
          n
          >
          m
          ), then
          F
          (
          s
          ) is called a
          proper rational function
          . If the denominator in
          Eq. (9-17)
          has no repeated roots [
          p

i

          ≠
          p

j

          for
          i
          ≠
          j
          ), then
          F
          (
          s
          ) is said to have
          simple poles
          . In this section we first treat the problem of finding the inverse transform of proper rational functions with simple poles. Once we have mastered this case, we will address problems with improper rational functions and multiple poles.
        
If a proper rational function has only simple poles, then it can be decomposed into a partial fraction expansion of the form



(9-18)





          In this case,
          F
          (
          s
          ) can be expressed as a linear combination of terms with one term for each of its
          n
          simple poles. The
          k
          's associated with each term are called
          residues
          .
        

          Each term in the partial fraction decomposition has the form of the transform of an exponential signal. That is, we recognize that
          ℒ
-1
          {(
          k/s
          + α)} = [
          ke

            -α
            t

          ]
          u
          (
          t
          ). We can now write the corresponding waveform using the linearity property:
        


(9-19)




          In the time domain, the
          s
          -domain poles appear in the exponents of exponential waveforms and the residues at the poles become the amplitudes.
        

          Given the poles of
          F
          (
          s
          ), finding the inverse transform
          f
          (
          t
          ) reduces to finding the residues. To illustrate the procedure, consider a case in which
          F
          (
          s
          ) has three simple poles and one finite zero.
        





          We find the residue
          k
1
          by first multiplying this equation through by the factor (
          s
          -
          p
1
          )
        




          If we now set
          s
          =
          p
1
          , the last two terms on the right vanish, leaving
        




          Using the same approach for
          k
2
          yields
        




          The technique generalizes so that the residue at any simple pole
          p

i

          is
        


(9-20)




          The process of determining the residue at any simple pole is sometimes called the
          cover-up algorithm
          because we temporarily remove (cover up) the factor (
          s
          =
          p
i
          ) in
          F
          (
          s
          ) and then evaluate the remainder at
          s
          =
          p

i

          .
        












EXAMPLE 9-11


Find the waveform corresponding to the transform







SOLUTION:



F
              (
              s
              ) is a proper rational function and has simple poles at
              s
              = 0,
              s
              = -1,
              s
              = -2. Its partial fraction expansion is
            



The cover-up algorithm yields the residues as



We can then write




              The inverse transform
              f
              (
              t
              ) is
            


■












Exercise 9-17


Find the waveforms corresponding to the following transforms:







Answers:




                (a)
                f
1
                (
                t
                ) = [2
                e

                  −
                  t

                − 2
                e

                  −3
                  t

                ]
                u
                (
                t
                )
              

                (b)
                f
2
                (
                t
                ) = [−
                e

t
                  −5
                
                + 3
                e

                  −3(
                  t
                  −5
                
                )]
                u
                (
                t
                −5)
              

                (c)
                f
3
                (
                t
                ) = [2
                e

                  −
                  t

                + 2
                e

                  −3
                  t

                ]
                u
                (
                t
                )
              




Note:


              Note that
            




              so that the delay factor
              e

                -5
                s

              is not involved in the partial fraction expansion but simply flags the amount by which the resulting waveform [
              e
-1
              + 3
              e

                -3
                t

              ]
              u
              (
              t
              ) is delayed to produce
              f
2
              (
              t
              ).
            









Exercise 9-18

Find the waveforms corresponding to the following transforms:







Answers:










Complex Poles

            Special treatment is necessary when
            F
            (
            s
            ) has a complex pole. In physical situations, the function
            F
            (
            s
            ) is a ratio of polynomials with real coefficients. If
            F
            (
            s
            ) has a complex pole
            p
            = -α +
            j
            β, then it must also have a pole
            p*
            = -α -
            j
            β; otherwise, the coefficients of the denominator polynomial would not be real. In other words, for physical signals, the complex poles of
            F
            (
            s
            ) must occur in conjugate pairs. As a consequence, the partial fraction decomposition of
            F
            (
            s
            ) will contain two terms of the form
          



(9-21)





            The residues
            k
            and
            k*
            at the conjugate poles are themselves conjugates because
            F
            (
            s
            ) is a rational function with real coefficients. These residues can be calculated using the cover-up algorithm and, in general, they turn out to be complex numbers. If the complex residues are written in polar form as
          




            then the waveform corresponding to the two terms in
            Eq. (9-21)
            is
          





            This equation can be rearranged in the form
          


(9-22)



The expression inside the brackets is of the form



Consequently, we combine terms inside the braces as a cosine function with a phase angle:



(9-23)





            In summary, if
            F
            (
            s
            ) has a complex pole, then in physical applications, there must be an accompanying conjugate complex pole. The inverse transformation combines the two poles to produce a damped cosine waveform. We only need to compute the residue at one of these poles because the residues at conjugate poles must be conjugates. Normally, we calculate the residue for the pole at
            s
            = - α +
            j
            β because its angle equals the phase angle of the damped cosine. Note that the imaginary part of this pole is positive, which means that the pole lies in the upper half of the
            s
            plane.
          

            The inverse transform of a proper rational function with simple poles can be found by the partial fraction expansion method. The residues
            k
            at the simple poles can be found using the cover-up algorithm. The resulting waveform is a sum of terms of the form [
            ke

              -α
              t

            ]
            u
            (
            t
            ) for real poles and [2|
            k
            |
            e

              -α
              t

            cos(β
            t
            + θ)]
            u
            (
            t
            ) for a pair of complex conjugate poles. The partial fraction expansion of the transform contains all of the data needed to construct the corresponding waveform.
          











EXAMPLE 9-12

Find the inverse transform of







SOLUTION:



F
                (
                s
                ) has a simple pole at
                s
                = -1 and a pair of conjugate complex poles located at the roots of the quadratic factor
              




                The partial fraction expansion of
                F
                (
                s
                ) is
              



The residues at the poles are found from the cover-up algorithm.



We now have all of the data needed to construct the inverse transform.





                In this example we used
                k
2
                to obtain the amplitude and phase angle of the damped cosine term. The residue
                k
*
2
                is not needed, but to illustrate a point we note that its value is
              




                If
                
                is used instead, we get the same amplitude for the damped sine but the wrong phase angle.
                

Caution:


                Remember that
                Eq. (9-23)
                uses the residue at the complex pole with a positive imaginary part. In this example, this is the pole at
                s
                = -1 +
                j
                2, not the pole at
                s
                = -1 -
                j
                2.
                ■










Exercise 9-19

Find the inverse transforms of the following rational functions:







Answers:

















Exercise 9-20

Find the inverse transforms of the following rational functions:







Answers:











Sums of Residues

            The sums of the residues of a proper rational function are subject to certain conditions that are useful for checking the calculations in a partial fraction expansion. To derive these conditions, we multiply
            Eqs. (9-17)
            and
            (9-18)
            by
            s
            and take the limit as
            s
            → ∞. These operations yield
          



In the limit, this equation reduces to




            Since
            F
            (
            s
            ) is a proper rational function with
            n
            >
            m
            , the limit process in this equation yields the following conditions:
          


(9-24)




            For a proper rational function with simple poles, the sum of residues is either zero or else equal to the transform scale factor
            K.












EXAMPLE 9-13



                    Use the sum of residues to find the unknown residue in the following expansion:
                  







SOLUTION:



                We have
                n
                = 2 and
                m
                + 1 = 2, so the sum of residues is the scale factor
                K
                = 660. Solving for
                k,
                we get
              


■










Exercise 9-21

Use the sum of residues to find the unknown residue in the following expansions:







Answers:




                  (a)
                  k
                  = 15
                

                  (b)
                  k
                  = -4
                





Some Special Cases

            Most of the transforms encountered in physical applications are proper rational functions with simple poles. The inverse transforms of such functions can e handled y the partial fraction expansion method developed in the previous section. This section covers the problem of finding the inverse transform when
            F
            (
            s
            ) is an improper rational function or has multiple poles. These matters are treated as special cases because they occur only for certain discrete values of circuit or signal parameters. However, some of these special cases are important, so we need to learn how to handle improper rational functions and multiple poles.
          

F
            (
            s
            ) is an
            improper rational function
            when the order of the numerator polynomial equals or exceeds the order of the denominator (
            m
            ≥
            n
            ). For example, the transform
          



(9-25)





            is improper because
            m
            = 3 and
            n
            = 2. Using long division this improper rational function can be changed into the sum of a quotient plus a remainder which is a proper rational function. We proceed as follows:
          





            which yields
          



The remainder is a proper rational function, which can be expanded by partial fractions to produce




            All of the terms in this expansion are listed in
            Table 9-2
            except the first term. The inverse transform of the first term is found using the transform of an impulse and the differentiation property. The Laplace transform of the derivative of an impulse is
          




            since
            ℒ
            {δ(
            t
            )} = 1 and δ(0-) = 0. By the uniqueness property of the Laplace transformation, we have
            ℒ
-1
            {
            s
            } =
            d
            δ(
            t
            )/
            dt.
            The first derivative of an impulse is called a
            doublet
            .
            
3

            The inverse transform of the improper rational function in
            Eq. (9-25)
            is
          




            The method illustrated by this example generalizes in the following way. When
            m
            = n, long division produces a quotient
            K
            plus a proper rational function remainder. The constant
            K
            corresponds to an impulse
            K
            δ(
            t
            ), and the remainder can be expanded by partial fractions to find the corresponding waveform. If
            m
            >
            n
            , then long division yields a quotient with terms like
            s
            ,
            s
2
            ,...s
            
m
              -
              n

            before a proper remainder function is obtained. These higher powers of
            s
            correspond to derivatives of the impulse. These pathological waveforms are theoretically interesting, but they do not actually occur in real circuits.
          

            Improper rational functions can arise during mathematical manipulation of signal transforms. When
            F
            (
            s
            ) is improper, it is essential to reduce it by long division prior to expansion; otherwise the resulting partial fraction expansion will be incomplete.
          











EXAMPLE 9-14

Find the inverse transform of the following function







SOLUTION:


This is an improper function since the orders of the numerator and the denominator are equal. We begin by performing a long division in order to change the function into a quotient and a remainder





                which yields
              



We can expand the right-hand equation using partial fractions resulting in



The inverse transform is


■










Exercise 9-22

Find the inverse transforms of the following functions:







Answers:

















Exercise 9-23

Find the inverse transforms of the following functions:







Answers:











Multiple Poles
Under certain special conditions, transforms can have multiple poles. For example, the transform



(9-26)





            has a simple pole at
            s
            =
            p
1
            and a pole oforder2 at
            s
            =
            p
2
            . Finding the inverse transform ofthis function requires specialtreatmentofthe multiple pole. We first factoroutone of the two multiple poles.
          



(9-27)






            The quantity inside the brackets is a proper rational function with only simple poles and can be expanded by partial fractions using the method of the previous section.
          



We now multiply through by the pole factored out in the first step to obtain



The first term on the right is a proper rational function with only simple poles, so it too can be expanded by partial fractions as




            After two partial fraction expansions, we have an expression in which every term is available in
            Table 9-2
            . The first two terms are simple poles that lead to exponential waveforms. The third term is of the form
            k
            /(
            s
            + α)
            2
            , which is the transform of a damped ramp waveform [
            kte

              -α
              t

            ]
            u
            (
            t
            ). Therefore, the inverse transform of
            F
            (
            s
            ) in
            Eq. (9-26)
            is
          


(9-28)






Caution:


            If
            F
            (
            s
            ) in
            Eq. (9-26)
            had another finite zero, then the term in the brackets in
            Eq. (9-27)
            would be an improper rational function. When this occurs, long division must be used to reduce the improper rational function before proceeding to the partial-fraction expansion in the next step.
          

            As with simple poles, the
            s
            -domain location of multiple poles determines the exponents of the exponential waveforms. The residues at the poles are the amplitudes of the waveforms. The only difference here is that the double pole leads to two terms rather than a single waveform. The first term is an exponential of the form
            e

pt

            , and the second term is a damped ramp of the form
            te

pt

            .
          











EXAMPLE 9-15

Find the inverse transform of







SOLUTION:



                The given transform has a simple pole at
                s
                = 0 and a double pole at
                s
                = -2. Factoring out one of the multiple poles and expanding the remainder by partial fractions yields
              



Multiplying through by the removed factor and expanding again by partial fractions produces



The last expansion on the right yields the inverse transform as




■

 










Exercise 9-24

Find the inverse transform of





Answer:








            In principle, the procedure illustrated in this example can be applied to higherorder poles, although the process rapidly becomes quite tedious. For example, an
            n
            th-order pole would require
            n
            partial-fraction expansions, which is not an idea with irresistible appeal. Mathematics offers other methods of determining multiple pole residues that reduce the computational burden somewhat. However, these advanced mathematical tools are probably not worth learning because computer tools such as MATLAB readily handle multiple pole situations. Although we do encounter functions with high-order multiple poles in later chapters, we rarely need to find their inverse transforms.
          
Thus, for practical reasons, our interest in multiple pole transforms is limited to two possibilities. First, a double pole on the negative real axis leads to the damped ramp:


(9-29)



Second, a pair of double, complex poles leads to the damped cosine ramp:


(9-30)




            These two cases illustrate a general principle: When a simple pole leads to a waveform
            f
            (
            t
            ), then a double pole at the same location leads to a waveform
            tf
            (
            t
            ). Multiplying a waveform by
            t
            tends to cause the waveform to increase without bound unless exponential damping is present.
          






Exercise 9-25

Find the inverse transforms of the following functions:







Answers:




                  (a)
                  f
                  (
                  t
                  ) = [-
                  e

                    -
                    t

                  +
                  e

                    -2
                    t

                  + 2
                  te

                    -2
                    t

                  ]
                  u
                  (
                  t
                  )
                

                  (b)
                  f
                  (
                  t
                  ) = [4
                  t
                  - 1 +
                  e

                    -4
                    t

                  ]
                  u
                  (
                  t
                  )
                

                  (c)
                  f
                  (
                  t
                  ) = [25
                  e

                    -2
                    t

                  + 775
                  e

                    -10
                    t

                  - 9000
                  te

                    -10
                    t

                  ]
                  u
                  (
                  t
                  )
                



The inverse Laplace transform allows us to recover a time-domain waveform after operating on a system in the Laplace domain. Computing the inverse transformation manually is useful for understanding the relationship between the two domains, but at some point, it becomes more efficient to perform the transformation calculations with software. The following example demonstrates the use of MATLAB to find the inverse transform of a transform with multiple poles.














EXAMPLE 9-16



                    Use MATLAB to find the inverse transform
                    f
                    (
                    t
                    ) of the following function:
                  







SOLUTION:


The following MATLAB code using the ilaplace function will find the desired waveform:





MATLAB returns the following answer:





The pretty function helps MATLAB express the answer in a more recognizable form.





Or, written in a more common way




Appendix D
                contains additional examples using MATLAB to compute the Laplace transform of a waveform or to take the inverse of a transform to find the waveform.
                ■





Finding Transforms from Pole - Zero Diagrams
Pole-zero diagrams give great insight into a circuit's performance. In designing circuits, a designer often considers the location of poles and zeros. In some design requirements, the location of poles and zeros are specified. In this subsection, we discuss how one can obtain a transform from a pole-zero diagram. In subsequent chapters, we will learn how to design circuits from a desired transform.

            Consider the pole-zero diagram in
            Figure 9-7
            . There are three poles and three zeros. There is a pair of imaginary poles at ±
            j
            500 and a single pole at -100. There are two real zeros, one at zero and one at -200. A third zero is at infinity. Starting with the poles, we can write
          



Then including the zeros










FIGURE 9-7








Note that the one parameter we cannot get from the pole-zero diagram is K, the scale-factor.
            This needs to be specified as a separate requirement. We can then apply the rules we have learned to expand the transform. In the next chapter, we will learn what circuit elements and/or signals give rise to certain poles and zeros. For now let us be satisfied with extracting a transform from a pole-zero diagram.
          












EXAMPLE 9-17



                    Find the transform
                    F
                    (
                    s
                    ) from the pole-zero diagram of
                    Figure 9-8
                    .
                    K
                    is 10
                    6
                    .
                  




SOLUTION:



                This diagram has four poles and four zeros, two of which are at infinity. Starting with the poles we see that two are complex conjugates at
                s
1
                ,
                s
2
                = -100 ±
                j
                100, and there are two at
                s
                = 0.
              










FIGURE 9-8







                Including the zeros and the specified
                K
                value, we get
              


■











Exercise 9-26



                Find the transform
                F
                (
                s
                ) from the pole-zero diagram of
                Figure 9-9
                .
                K
                is 3 × 10
                4
                .
              


Answer:














FIGURE 9-9








9-5 Circuit Response Using Laplace Transforms

            The payoff for learning about the Laplace transformation comes when we use it to find the response of dynamic circuits. The pattern for circuit analysis is shown by the solid line in
            Figure 9-1
            . To analyze a problem using Laplace transforms, we follow the steps first discussed with
            Figure 9-1
            . They are more simply stated as follows:
          

STEP 1
Develop the circuit differential equation in the time domain.


STEP 2

              Transform this equation into the
              s
              domain and algebraically solve for the response transform.
            


STEP 3
Apply the inverse transformation to this transform to produce the response waveform.


            The first-order
            RC
            circuit in
            Figure 9-10
            will be used to illustrate these steps.
          

STEP 1


            The KVL equation around the loop and the element
            i
            -
            υ
            relationship or element equations are
          










FIGURE 9-10


First-order RC circuit.






            Substituting the
            i-v
            relationships into the KVL equation and rearranging terms produces a first-order differential equation,
          



(9-31)





            with initial condition
            v
C
            (0-) =
            V
0
            V.
          

STEP 2


            The analysis objective is to use Laplace transforms to find the waveform
            v
C
            (
            t
            ) that satisfies this differential equation and the initial condition. We first apply the Laplace transformation to both sides of
            Eq. (9-31)
            :
          



Using the linearity property leads to



Using the differentiation property and the transform of a unit step function produces



(9-32)





            This result is an algebraic equation in
            V
C
            (
            s
            ), which is the transform of the response we seek. We rearrange
            Eq. (9-32)
            to the form
          




            and algebraically solve for
            V
C
            (
            s
            ).
          



(9-33)





            The function
            V
C
            (
            s
            ) is the transform of the waveform
            v
C
            (
            t
            ) that satisfies the differential equation and the initial condition. The initial condition appears explicitly in this equation as a result of applying the differentiation rule to obtain
            Eq. (9-32)
            .
          

STEP 3


            To obtain the waveform
            v
C
            (
            t
            ), we find the inverse transform of the right side of
            Eq. (9-33)
            . The first term on the right is a proper rational function with two simple poles on the real axis in the
            s
            plane. The pole at the origin was introduced by the step function input. The pole at
            s
            = −1/
            RC
            came from the circuit. The partial fraction expansion of the first term in
            Eq. (9-33)
            is
          




            The residues
            k
1
            and
            k
2
            are found using the cover-up algorithm.
          




            Using these residues, we expand
            Eq. (9-33)
            by partial fractions as
          



(9-34)






            Each term in this expansion is recognizable: The first is a step function and the next two are exponentials. Taking the inverse transform of
            Eq. (9-34)
            gives
          



(9-35)





            The waveform
            v
C
            (
            t
            ) satisfies the differential equation in
            Eq. (9-31)
            and the initial condition
            v
C
            (0-) =
            V
0
            . The term
            V
A
u
            (
            t
            ) is the forced response due to the step function input, and the term [(
            V
0
            -
            V
A
            )
            e

              -
              t/RC

            ]
            u
            (
            t
            ) is the natural response. The complete response depends on three parameters: the input amplitude
            V
A
            , the circuit time constant
            RC,
            and the initial condition
            V
0
            .
          

            These results are identical to those found using the classical methods in
            Chapter 7
            . The outcome is the same, but the method is quite different. The Laplace transformation yields the complete response (forced and natural) by an algebraic process that inherently accounts for the initial conditions. The solid arrow in
            Figure 9-1
            shows the overall procedure. Begin with
            Eq. (9-31)
            and relate each step leading to
            Eq. (9-35)
            to steps in
            Figure 9-1
            .
          












EXAMPLE 9-18



                    The switch in
                    Figure 9-11
                    has been in position A for a long time. At
                    t
                    = 0 it is moved to position B. Find
                    i
L
                    (
                    t
                    ) for
                    t
                    ≥0.
                  









FIGURE 9-11








SOLUTION:



STEP 1
The circuit differentialequation is found bycombining the KVLequation and element equations with the switch in position B.





Substituting the element equations into the KVL equation yields






                  Prior to
                  t
                  = 0, the circuit was in a dc steady-state condition with the switch in position A. Under dc conditions the inductor acts like a short circuit, and the inductor current just prior to moving the switch is
                  i
L
                  (0-) =
                  I
0
                  =
                  V

A

                  /
                  R
                  .
                


STEP 2

                  Using the linearity and differentiation properties, we transform the circuit differential equation into the
                  s
                  domain as
                






                  Solving algebraically for
                  I
L
                  (
                  s
                  ) yields
                





STEP 3

                  The inverse transform of
                  I
L
                  (
                  s
                  ) is an exponential waveform:
                






                  where
                  I
0
                  =
                  V
A
                  /
                  R.
                  Substituting
                  i
L
                  (
                  t
                  ) back into the differential equation yields
                





The waveform found using Laplace transforms does indeed satisfy the circuit differential equation and the initial condition.
■












Exercise 9-27



                The inductor in
                Figure 9-11
                is replaced by a capacitor
                C.
                The switch has been in position A for a long time. At
                t
                = 0 it is moved to position B. Find
                V
C
                (
                s
                ) and
                υ
C
                (
                t
                ) for
                t
                ≥0.
              


Answers:




















EXAMPLE 9-19


                    The switch in
                    Figure 9-12
                    has been open for a long time. At
                    t
                    = 0 the switch is closed. Find
                    i
                    (
                    t
                    ) for
                    t
                    ≥0.
                  




SOLUTION:



                The governing equation for the second-order circuit in
                Figure 9-12
                is found by combining the element equations and a KVL equation around the loop with the switch closed:
              










FIGURE 9-12






Substituting the element equations into the KVL equation yields




                Using the linearity property, the differentiation property, and the integration property, we transform this second-order integrodifferential equation into the
                s
                domain as
              




                Solving for
                I
                (
                s
                ) results in
              




                Prior to
                t
                = 0, the circuit was in a dc steady-state condition with the switch open. In dc steady state, the inductor acts like a short circuit and the capacitor like an open circuit, so the initial conditions are
                i
L
                (0-) = 0 A and
                υ
C
                (0-) =
                V
A
                = 10 V. Inserting the initial conditions and the numerical values of the circuit parameters into the equation for
                I
                (
                s
                ) gives
              





                The denominator quadratic can be factored as (
                s
                + 200)
                2
                + 400
                2
                and
                I
                (
                s
                ) written in the following form:
              




                Comparing the quantity inside the brackets with the entries in the
                F
                (
                s
                ) column of
                Table 9-2
                , we find that
                I
                (
                s
                ) is a damped sine with α = 200 and β = 400. By linearity, the quantity outside the brackets is the amplitude of the damped sine. The inverse transform is
              



Substituting this result back into the circuit integrodifferential equation yields the following term-by-term tabulation:




                The sum of the far right-hand sides of these equations is zero. This result shows that the waveform
                i
                (
                t
                ) found using Laplace transforms does indeed satisfy the circuit integrodifferential equation and the initial conditions.
                ■










FIGURE 9-13












Exercise 9-28


                The switch in
                Figure 9-13
                has been open a long time. At
                t
                = 0 the switch is closed.
              


                  (a) Find the differential equation for
                  i
L
                  (
                  t
                  ) and initial condition
                  i
L
                  (0).
                

                  (b) Transform the equation into the
                  s
                  domain.
                

                  (c) Solve the equation for
                  I
L
                  (
                  s
                  ).
                

                  (d) Take the inverse transform of
                  I
L
                  (s) to find
                  i
L
                  (
                  t
                  ).
                



Answers:

















Exercise 9-29

Find the transforms that satisfy the following equations and the given initial conditions.







Answers:

















Exercise 9-30

Find the transforms that satisfy the following equations and the given initial conditions.


                (a)
                


                (b)
                




Answers:




                (a)
                


                (b)
                






Circuit Response with Time-Varying Inputs
It is encouraging to find that the Laplace transformation yields results that agree with those obtained by classical methods. The transform method reduces solving circuit differential equations to an algebraic process that includes the initial conditions. However, before being overcome with euphoria, we must remember that the Laplace transform method begins with the circuit differential equation and the initial conditions. It does not provide these quantities to us. The transform method simplifies the solution process, but it does not substitute for understanding how to formulate circuit equations.







FIGURE 9-14







          Having been suitably cautioned, let us investigate some other benefits of the Laplace transform. The Laplace transform method is especially useful when the circuit is driven by time-varying inputs. To illustrate, we look at
          Figure 9-14
          (a). This is the same
          RC
          circuit we saw in
          Figure 9-10
          except that now we will replace the step function by a general input signal denoted by
          v
S
          (
          i
          ). The right side of the circuit differential equation in
          Eq. (9-31)
          changes to accommodate the new input by taking the form
        



(9-36)





          with an initial condition
          v
C
          (0) =
          V
0
          V.
        

          The only change here is that the driving force on the right side of the differential equation is a general time-varying waveform
          v
S
          (
          t
          ). The objective is to find the capacitor voltage
          v
C
          (
          t
          ) that satisfies the differential equation and the initial conditions. The classical methods of solving for the forced response depend on the form of
          v
S
          (
          t
          ). However, with the Laplace transform method, we can proceed without actually specifying the form of the input signal.
        

          We first transform
          Eq. (9-36)
          into the
          s
          domain:
        




          The only assumption here is that the input waveform is Laplace transformable, a condition met by all causal signals of engineering interest. We now algebraically solve for the response
          V
C
          (
          s
          ):
        



(9-37)





          The function
          V
C
          (
          s
          ) is the transform of the response of the
          RC
          circuit in
          Figure 9-10
          due to a general input signal
          v
S
          (
          t
          ). We have gotten this far without specifying the form of the input signal. In a sense, we have found the general solution in the
          s
          domain of the differential equation in
          Eq. (9-36)
          for any causal input signal.
        


          All of the necessary ingredients are present in
          Eq. (9-37)
          :
        



              The transform
              V
S
              (
              s
              ) represents the applied input signal.
            



              The pole at
              s
              = -1/
              RC
              defines the circuit time constant.
            



              The initial value
              υ
C
              (0-) =
              V
0
              summarizes all events prior to
              t
              = 0.
            



          However, we must have a particular input in mind to solve for the waveform
          v
C
          (
          t
          ). If the input is the same step as in
          Figure 9-10
          ,
          v
S
          (
          t
          ) =
          V
A
u
          (
          t
          ), then in
          Eq. (9-37)
          we substitute
          V
A
          /
          s
          for
          V
S
          (
          s
          ) and solve the for
          V
C
          (
          s
          ) using the cover-up algorithm. The result is
        




          which is the same as we obtained in
          Eq. (9-34)
          .
        
The following examples illustrate the procedure for different input driving forces.











EXAMPLE 9-20


                  Find
                  v
C
                  (
                  t
                  ) in the
                  RC
                  circuit in
                  Figure 9-14
                  (b) when the input is the waveform
                  v
S
                  (
                  t
                  ) = [
                  V
A
e

                    -α
                    t

                  ]
                  u
                  (
                  t
                  ) V.
                









FIGURE 9-4








SOLUTION:



              The transform of the input is
              V
S
              (
              s
              ) =
              V

A

              /(
              s
              + α). For the exponential input the response transform in
              Eq. (9-37)
              becomes
            



(9-38)





              If α ≠ 1/
              RC
              , then the first term on the right is a proper rational function with two simple poles. The pole at
              s
              = -α came from the input and the pole at
              s
              = -1/
              RC
              from the circuit. A partial fraction expansion of the first term has the form
            



The residues in this expansion are




              The expansion of the response transform
              V
C
              (
              s
              ) is
            




              The inverse transform of
              V
C
              (
              s
              ) is
            




              The first term is the forced response, and the last two terms are the natural response. The forced response is an exponential because the input introduced a
              
              pole at
              s
              = - α. The natural response is also an exponential, but its time constant depends on the circuit's pole at
              s
              = -1/
              RC
              . In this case the forced and natural responses are both exponential signals with poles on the real axis. However, the forced response comes from the pole introduced by the input, while the natural response depends on the circuit'spole.
            

              If α = 1/
              RC
              , then the response just given is no longer valid (
              k
1
              and
              k
2
              become infinite). To find the response for this condition, we return to
              Eq. (9-38)
              and replace α by 1/
              RC
              :
            




              We now have a double pole at
              s
              = -1/
              RC
              = -α. The double pole term is the transform of a damped ramp, so the inverse transform is
            




              When α = 1/
              RC
              , the
              s
              -domain poles of the input and the circuit coincide and the zerostate (
              V
0
              = 0) response has the form α
              te

                -α
                t

              . We cannot separate this response into forced and natural components since the input and circuit poles coincide. However, if we recall from
              Chapter 7
              , we can divide our solution into zero-input and zero-state responses. The first term is the zero-state response (no stored energy), and the second term is the zero-input response (no input source). We will look at the difference between forced and natural versus zero-input and zero-state responses more in
              Chapter 10
              .
              ■










Exercise 9-31


              The
              RC
              circuit in
              Figure 9-14
              (b) has
              R
              = 10 kΩ,
              C
              = 0.2 μF, and
              V
0
              = −5 V. The input is
              v
S
              (
              t
              ) = 10
              e

                −1000
                t

u
              (
              t
              ) V. Find
              v
C
              (
              t
              ) for
              t
              ≥ 0.
            


Answer:



v
C
              (
              t
              ) = [5
              e

                −500
                t

              − 10
              e

                −1000
                t

              ]
              u
              (
              t
              ) V.
            
















EXAMPLE 9-21



                  Find
                  v
C
                  (
                  t
                  ) when the input to the
                  RC
                  circuit in
                  Figure 9-15
                  is
                  v
S
                  (
                  t
                  ) = [
                  V
A
                  cos β
                  t
                  ]
                  u
                  (
                  t
                  ) V.
                




SOLUTION:



              The transform of the input is
              V
S
              (
              s
              ) =
              V
A
s
              /(
              s
2
              + β
              2
              ). For a cosine input the response transform in
              Eq. (9-37)
              becomes
            










FIGURE 9-15







              The sinusoidal input introduces a pair of poles located at
              s
              = ±
              j
              β. The first term on the right is a proper rational function with three simple poles. The partial fraction expansion of the first term is
            




              To find the response, we need to find the residues
              k
1
              and
              k
2
              :
            





              where
            




              The residue
              k
2
              at the circuit pole is
            



We now perform the inverse transform to obtain the response waveform:




              The first term is the forced response, and the remaining two are the natural response. The forced response is sinusoidal because the input introduces poles at
              s
              = ±
              j
              β. The natural response is an exponential with a time constant determined by the location of the circuit's pole at
              s
              = −1/
              RC
              .
              ■











Exercise 9-32



              The
              RL
              circuit of
              Figure 9-16
              is in the zero state when the input
              i

S

              (
              t
              ) = [2 cos 1000
              t
              ]
              u
              (
              t
              ) A is applied. Find
              i
L
              (
              t
              ) for
              t
              ≥ 0.
            


Answer:



i
L
              (
              t
              ) = [0.894 cos(1000
              t
              − 63.4°) − 0.4
              e

                −500
                t

              ]
              u
              (
              t
              ) A
            









FiGURE 9-16









9-6 Initial and Final Value Properties

        The
        initial value
        and
        final value properties
        can be stated as follows:
      


(9-39)




        These properties display the relationship between the origin and infinity in the time and frequency domains. The value of
        f
        (
        t
        ) at
        t
        = 0+ in the time domain (initial value) is the same as the value of
        sF
        (
        s
        ) at infinity in the
        s
        plane. Conversely, the value of
        f
        (
        t
        ) as
        t
        → ∞ (final value) is the same as the value of
        sF
        (
        s
        ) at the origin in the
        s
        plane.
      
Proof of both the initial value and final value properties starts with the differentiation property:



(9-40)





        To establish the initial value property, we rewrite the integral on the right side ofthis equation and take the limit of both sides as
        s
        → ∞.
      



(9-41)






        The first integral on the right side reduces to
        f
        (0+) −
        f
        (0−) since
        e

          −
          st

        is unity on the interval from
        t
        = 0− to
        t
        = 0+. The second integral vanishes because
        e

          −
          st

        goes to zero as
        s
        → ∞. In addition, on the leftside of
        Eq. (9-41)
        , the
        f
        (0−) is independent of
        s
        and can be taken outside the limiting process. Inserting all of these considerations reduces
        Eq. (9-41)
        to
      


(9-42)



which completes the proof of the initial value property.

        Proof of the final value theorem begins by taking the limit of both sides of
        Eq. (9-40)
        as
        s
        → 0:
      



(9-43)





        The integral on the right side of this equation reduces to
        f
        (∞) −
        f
        (0−) because
        e

          −
          st

        becomes unity as
        s
        → ∞. Again, the
        f
        (0−) on the left side is independent of
        s
        and can be taken outside of the limiting process. Inserting all of these considerations reduces
        Eq. (9-43)
        to
      


(9-44)



which completes the proof of the final value property.
A damped cosine waveform provides an illustration of the application of these properties. The transform of the damped cosine is



Applying the initial and final value limits, we obtain




        Note the agreement between the t-domain and
        s
        -domain limits in both cases.
      

        There are restrictions on the initial and final value properties. The initial value property is valid when
        F
        (
        s
        ) is a proper rational function or, equivalently, when
        f
        (
        t
        ) does not have an impulse at
        t
        = 0. The final value property is valid when the poles of
        sF
        (
        s
        ) are in the left half plane or, equivalently, when
        f
        (
        t
        ) is a waveform that approaches a final value at
        t
        → ∞. Note that the final value restriction allows
        F
        (
        s
        ) to have a simple pole at the origin since the limitation is on the poles of
        sF
        (
        s
        ).
      



Caution:


        The initial and final value properties will appear to work when the aforementioned restrictions are not met. In other words, these properties do not tell you they are giving nonsense answers when you violate their limitations. You must always check the restrictions on
        F
        (
        s
        ) before applying either of these properties.
      


        For example, applying the final value property to a cosine waveform yields
      




        The final value property appears to say that cosβ
        t
        approaches zero as
        t
        → ∞. This conclusion is incorrect since the waveform oscillates between −1 and +1. The problem is that the final value property does not apply to a cosine waveform because
        sF
        (
        s
        ) has poles on the
        j
        -axis at
        s
        = ±
        j
        β.
      












EXAMPLE 9-22


Use the initial and final value properties to find the initial and final values of the waveform whose transform is







SOLUTION:



            The given
            F
            (
            s
            ) is a proper rational function, so the initial value property can be applied as
          




            The poles of
            sF
            (
            s
            ) are located in the left half plane at
            s
            = −1 and
            s
            = −2; hence, the final value property can be applied as
          




            In
            Example 9-11
            , the waveform corresponding to this transform was found to be
          



from which we find




            which confirms the results found directly from
            F
            (
            s
            ).
            ■










Exercise 9-33

Find the initial and final values of the waveforms corresponding to the following transforms:







Answers:



(a) Initial value = 0, final value = 3.

              (b)
              F
2
              (
              s
              ) is not a proper rational function, hence, we cannot determine the initial value, final value = 0.
            







        Summary
      


          The
          Laplace transformation
          converts waveforms in the time domain into transforms in the
          s
          domain. The
          inverse transformation
          converts transforms into causal waveforms. A transform pair is unique if and only if
          f
          (
          t
          ) is causal.
        
The Laplace transforms of basic signals like the step function, exponential, and sinusoid are easily derived from the integral definition. Other transform pairs can be derived using basic signal transforms and the uniqueness, linearity, time integration, time differentiation, and translation properties of the Laplace transformation.

Proper rational functions
          with simple poles can be expanded by
          partial fractions
          to obtain inverse Laplace transforms. Simple real poles lead to exponential waveforms and simple complex poles to damped sinusoids. Partial-fraction expansions of improper rational functions and functions with multiple poles require special treatment. MATLAB software can be used to find Laplace transforms from
          f
          (
          t
          ) and waveforms from
          F
          (
          s
          ) (see
          Appendix D
          ).
        

          Using Laplace transforms to find the response of a linear circuit involves three steps:
          1
          transforming the circuit differential equation into the
          s
          domain,
          2
          algebraically solving for the response transform, and
          3
          performing the inverse transformation to obtain the response waveform.
        

          The
          initial and final value properties
          determine the initial and final values of a waveform
          f
          (
          t
          ) from the value of
          sF
          (
          s
          ) as
          s
          → ∞ and
          s
          → ∞, respectively. The initial value property applies if
          F
          (
          s
          ) is a proper rational function. The final value property applies if all of the poles of
          sF
          (
          s
          ) are in the left half plane.
          






        Chapter 9 Problems
      






            Objective 9-1 Laplace Transform (
            Sects. 9-1
            ,
            9-2
            ,
            9-3
            )
          
Find the Laplace transform of a given signal waveform using transform properties and pairs, using the integral definition of the Laplace transformation, or software applications. Locate the poles and zeros of the transform and construct a pole-zero diagram.

            See
            Examples 9-1
            to
            9-10
            and Exercises
            9-1
            to
            9-16
            .
          





9-1
          Find the Laplace transform of the following signals and locate the poles and zeros of
          F
          (
          s
          ).
          

(a)
f
              (
              t
              ) = -8
              u
              (
              t
              ).
            

(b)
f
              (
              t
              ) = 0.5
              t
u
              (
              t
              ).
            

(c)
f
              (
              t
              ) = 10
              e

                −20000
                t

u
              (
              t
              ).
            



9-2
          Find the Laplace transform of the following signals and locate the poles and zeros of
          F
          (
          s
          ).
          

(a)
f
              (
              t
              ) = −10 dδ(
              t
              )/
              dt


(b)
f
              (
              t
              ) = 120 cos(377
              t
              )
              u
              (
              t
              ).
            

(c)
f
              (
              t
              ) = 10[1 −
              e

                −500
                t

              ]
              u
              (
              t
              ).
            




9−3
          Find the Laplace transform of
          f
          (
          t
          )= −5
          u
          (
          t
          ) + 5
          e

            −5
            t

u
          (
          t
          ) − 5
          tu
          (
          t
          ). Locate the poles and zeros of
          F
          (
          s
          ).
        

9-4


(a)
              Find the Laplace transform of
              f
              (
              t
              ) = 50[
              e

                −100
                t

              − 2
              e

                −200
                t

              ]
              u
              (
              t
              ).
            

(b)
              Locate the poles and zeros of
              F
              (
              s
              ).
            

(c)
              What is the time constant associated with each pole?
            

(d)
              Identify the dominant exponential and comment on its location on the pole-zero diagram versus the other exponential.
            




9-5
          Find the Laplace transform of
          f
          (
          t
          ) =
          A
          [(
          B
          + α
          t
          )
          e

            -α
            t

          ]
          u
          (
          t
          ). Locate the poles and zeros of
          F
          (
          s
          ).
        

9-6
          Find the Laplace transform of
          f
          (
          t
          ) = [1 − cos(500
          t
          )]
          u
          (
          t
          ). Locate the poles and zeros of
          F
          (
          s
          ).
        


9-7
          Find the Laplace transform of
          f
          (
          t
          ) = 20[5 cos(100
          t
          ) − 5 sin (100
          t
          )]
          u
          (
          t
          ). Locate the poles and zeros of
          F
          (
          s
          ).
        

9-8
          Find the Laplace transform of
          f
          (
          t
          ) = δ′(
          t
          ) + δ(
          t
          ) −
          e

            −
            t

u
          (
          t
          ). Locate the poles and zeros of
          F
          (
          s
          ).
        


9-9
          Find the Laplace transform of
          f
          (
          t
          ) = 3δ(
          t
          ) - 3[1 +
          e

            −3
            t

          ]
          u
          (
          t
          ). Locate the poles and zeros of
          F
          (
          s
          ).
        


9-10
          Find the Laplace transforms of the following waveforms and plot their pole-zero diagrams. Then use MATLAB to validate your results.
          

(a)
f
1
              (
              t
              ) = [10
              e

                −30
                t

              − 20
              e

                −50
                t

              ]
              u
              (
              t
              )
            

(b)
f
2
              (
              t
              ) = 10 [cos (1000
              t
              ) + cos (2000
              t
              )]
              u
              (
              t
              )
            





9-11
          Find the Laplace transforms of the following waveforms. Locate the poles and zeros of
          F
          (
          s
          ). Use MATLAB to verify your results.
          

(a)
f
1
              (
              t
              ) = 2δ(
              t
              ) + (144
              t
e

                −12
                t

              )
              u
              (
              t
              )
            

(b)
f
2
              (
              t
              ) = [100 + 50
              e

                −10
                t

              (cos100
              t
              + sin100
              t
              )]
              u
              (
              t
              )
            




9-12
          Find the Laplace transforms of the following waveforms. Use MATLAB to verify your results.
          

(a)
f
1
              (
              t
              ) = 2δ(
              t
              −5)
            

(b)
f
2
              (
              t
              ) = 5
              e

                −100(
                t
                −1)
              
u
              (
              t
              −1)
            

(c)
f
3
              (
              t
              ) = 0.2
              e

                −50(
                t
                −10
                −3
                )
              
u
              (
              t
              −10
              −3
              )
            





9-13
          Use MATLAB to find the Laplace transform of the following waveform
          




9-14
          Consider the following waveform.
          




(a)
              Using Laplace, take the time derivative of the waveform.
            

(b)
              Integrate the result found in part (a) and see if you recover the original function. Explain any discrepancy. (
              Hint:
              MATLAB would be useful.)
            




9-15
          Consider the waveform in
          Figure P9-15
          .
          






FIGURE P9-15








(a)
              Write an expression for the waveform
              f
              (
              t
              ) using step and ramp functions.
            

(b)
              Use the time-domain translation property to find the Laplace transform of the waveform
              f
              (
              t
              ) found in part (a).
            

(c)
              Verify the Laplace transform found in (b) by applying the definition of the Laplace transformation in
              Eq. (9-2)
              to the waveform
              f
              (
              t
              ) found in (a).
            



9-16
          Consider the waveform in
          Figure P9-16
          .
          






FIGURE P9-16









(a)
              Write an expression for the waveform
              f
              (
              t
              ) in
              Figure P9-16
              using a delayed exponential.
            

(b)
              Use the time-domain translation property to find the Laplace transform of the waveform
              f
              (
              t
              ) found in part (a).
            

(c)
              Verify the Laplace transform found in (b) by applying the definition of the Laplace transformation in
              Eq. (9-2)
              to the waveform
              f
              (
              t
              ) found in (a).
            




9-17
          A particular waveform has the pole-zero diagram shown in
          Figure P9-17
          . The waveform is known to have a final voltage of 10 V. First find the transform of the waveform, and then find an expression for the waveform
          v
          (
          t
          ).
        








FIGURE P9-17












            OBJECTIVE 9-2 INVERSE TRANSFORMS (
            Sect. 9-4
            )
          

(a) Find the inverse transform of a given Laplace transform using partial fraction expansion, basic transform properties and pairs, or using software tools.
(b) Given a pole-zero diagram, find the respective transform.


            See
            Examples 9-11
            to
            9-17
            and
            Exercises 9-17
            to
            9-26
            .
          




9-18
          Find the inverse Laplace transforms of the following functions and plot their pole-zero diagrams:
          

(a)



(b)



(c)







9-19
          Find the inverse Laplace transforms of the following functions. Validate your answers using MATLAB.
          

(a)



(b)



(c)






9-20
          Find the inverse Laplace transforms of the following functions. Validate your answers using MATLAB.
          

(a)



(b)






9-21
          Use the sum of residues to find the unknown residues in the following expansions:
          

(a)



(b)






9-22
          Use the sum of residues to find the unknown residue in the following expansion. Then find the inverse transform of the completed expansion. Finally, validate your answer using MATLAB.
          






9-23
          Find the inverse Laplace transforms of the following functions and then validate your answers using MATLAB:
          

(a)



(b)






9-24
          Find the inverse transforms of the following functions and then validate your answers using MATLAB:
          

(a)



(b)






9-25
          Find the inverse transforms of the following functions:
          

(a)



(b)





9-26
          Find the inverse transforms of the following functions:
          

(a)



(b)







9-27
          Find the inverse Laplace transforms of the following functions using MATLAB:
          

(a)



(b)






9-28
          Find the inverse transforms of the following functions:
          

(a)



(b)






9-29
          Find the inverse transforms of the following functions:
          

(a)



(b)





9-30
          Find the inverse transforms of the following functions:
          

(a)



(b)



(c)







9-31
          Use MATLAB to find the inverse transform and plot the poles and zeros of the following function:
          



            (
            Hint:
            Refer to
            Appendix D
            for examples on how to use MATLAB's function pzplot to find poles and zeros of transfer functions.)
          


9-32
          Find the transform
          F
          (
          s
          ) from the pole-zero diagram of
          Figure P9-32
          .
          K
          is 5.
          






FIGURE P9-32










9-33
          Find the transform
          F
          (
          s
          ) from the pole-zero diagram of
          Figure P9-33
          .
          K
          is 5 × 10
          6
          . Use MATLAB to find the corresponding waveform
          f
          (
          t
          ).
          






FIGURE P9-33








9-34
          In this problem, we look at the role of a pole or zero at the origin. The three pole-zero diagrams in
          Figure P9-34
          vary only in the fact that there is a pole, zero, or nothing at the origin. Find the resulting transform and then the waveform for each case. How does this critical point affect the resulting waveform? Assume
          K
          = 500.
          






FIGURE P9-34














            Objective 9-3 Circuit Response Using Laplace Transforms (
            Sect. 9-5
            )
          
Given a first- or second-order circuit:

(a) Determine the circuit differential equation and the initial conditions (if not given).

              (b) Transform the differential equation into the
              s
              domain and solve for the response transform.
            
(c) Use the inverse transformation to find the response waveform.


            See
            Examples 9-18
            to
            9-21
            and
            Exercises 9-27
            to
            9-32
            .
          






9-35
          Use the Laplace transformation to find the
          v
          (
          t
          ) that satisfies the following first-order differential equations:
          

(a)



(b)





9-36
          Use the Laplace transformation to find the
          i
          (
          t
          ) that satisfies the following first-order differential equation:
          






9-37
          The switch in
          Figure P9-37
          has been closed for a long time and is opened at
          t
          = 0. The circuit parameters are
          R
          = 22 kΩ,
          L
          = 220 mH, and
          V
A
          = 10 V.
          






FIGURE P9-37








(a)
              Find the differential equation for the inductor current
              i
L
              (
              t
              ) and initial condition
              i
L
              (0).
            

(b)
              Transform the equation into the
              s
              domain.
            

(c)
              Solve the equation for
              I
L
              (
              s
              ).
            

(d)
              Take the inverse transform of
              I
L
              (
              s
              ) to find
              i
L
              (
              t
              ).
            

(e)
              Validate your result using Multisim.
            




9-38
          The switch in
          Figure P9-38
          has been in position A for a long time and at
          t
          = 0 it is moved to position B. The circuit parameters are
          R
          = 100 Ω,
          L
          = 200 mH, and
          i

S

          (
          t
          ) = 2cos (2π60
          t
          )
          u
          (
          t
          ) mA.
          

(a)
              Find the differential equation for the inductor current
              i
L
              (
              t
              ).
            

(b)
              Transform the equation into the
              s
              -domain and solve the equation for
              I
L
              (
              s
              ).
            

(c)
              Solve for
              i
L
              (
              t
              ) and
              v
O
              (
              t
              ).
            

(d)
              Validate your result using Multisim.
            








FIGURE P9-38









9-39
          A series
          RC
          circuit in the zero state with
          R
          = 2 kΩ and
          C
          = 1 μF is excited by
          v
S
          (
          t
          ) = 2(1 -
          e

            -1000
            t

          )
          u
          (
          t
          ) V.
          

(a)
              Find the differential equation for the capacitor voltage.
            

(b)
              Solve for the capacitor voltage
              v
C
              (
              t
              ) using Laplace transformation techniques.
            



9-40
          Use the Laplace transformation to find the
          υ
          (
          t
          ) that satisfies the following second-order differential equation:
          






9-41
          The switch in
          Figure P9-41
          has been open for a long time and is closed at
          t
          = 0. The circuit parameters are
          R
          = 50 Ω,
          L
          = 50 mH,
          C
          = 5 μF, and
          V
A
          = 1000 V.
          






FIGURE P9-41








(a)
              Find the circuit differential equation in
              i

L

              (
              t
              ) and the initial conditions
              i
L
              (0) and
              v
C
              (0).
            

(b)
              Use Laplace transforms to solve for
              i
L
              (
              t
              ) for
              t
              ≥0.
            

(c)
              Build the circuit for
              t
              > 0 in Multisim. Plot
              i
L
              (
              t
              ),
              i
R
              (
              t
              ),
              i
C
              (
              t
              ), and
              v
C
              (
              t
              ). Use the left axis for the voltage and the right axis for the three currents. Comment on the plots.
            




9-42
          The switch in
          Figure P9-41
          has been open for a long time and is closed at
          t
          = 0. The circuit parameters are
          R
          = 500 Ω,
          L
          = 2.5 H,
          C
          = 25 μF, and
          V
A
          = 500 V.
          

(a)
              Find the circuit differential equation in
              v
C
              (
              t
              ) and the initial conditions
              i
L
              (0) and
              v
C
              (0).
            

(b)
              Use Laplace transforms to solve for
              v
C
              (
              t
              ) for
              t
              ≥0.
            

(c)
              Simulate the circuit in Multisim to plot your resulting waveform.
            





9-43
          The switch in
          Figure P9-43
          has been closed for a long time and is opened at
          t
          =0.
          






FIGURE P9-43








(a)
              Find the circuit differential equation in
              v
C
              (
              t
              ) and the initial conditions
              i
L
              (0) and
              v
C
              (0).
            

(b)
              The circuit parameters are
              L
              = 10 H,
              C
              = 0.25 μF,
              R
1
              = 3 kΩ,
              R
2
              = 10 kΩ, and
              v
S
              = 12
              u
              (
              t
              ) V. Use Laplace transforms and MATLAB to solve for
              v
C
              (
              t
              ) for
              t
              ≥0.
            





9-44
          The switch in
          Figure P9-43
          has been open for a long time and is closed at
          t
          = 0.
          

(a)
              Find the circuit differential equation in
              i
L
              (
              t
              ) and the initial conditions
              i
L
              (0) and
              v
C
              (0).
            

(b)
              The circuit parameters are
              L
              = 10 H,
              C
              = 1.25 μF,
              R
1
              =10 kΩ,
              R
2
              = 3.3 Ω, and
              v
S
              = 10
              u
              (
              t
              ) V. Use Laplace transforms and MATLAB to solve for
              i
L
              (
              t
              ) for
              t
              ≥0.
            

(c)
              Simulate the circuit in Multisim to plot your resulting waveform.
            





9-45
          The
          RLC
          circuit in
          Figure P9-45
          is in the zero state when at
          t
          = 0 an exponential source,
          v
S
          (
          t
          ) =
          V
A
e

            -α
            t

          V, is suddenly connected to it.
          






FIGURE P9-45








(a)
              Find the circuit integrodifferential equation that describes the behavior of the current in the circuit.
            

(b)
              If
              R
              = 68 Ω,
              L
              = 100 mH,
              C
              = 15 μF,
              V
A
              = 15 V, and α = 100 s
              -1
              , use Laplace transforms and MATLAB to solve for
              i
              (
              t
              ) for
              t
              ≥0.
            




9-46
          Repeat Problem 9-45 when an exponential source,
          v
S
          (
          t
          ) = 15(1 -
          e

            -100
            t

          ) V, is suddenly connected to the circuit.
        


9-47
          For the inverting OP AMP circuit shown in
          Figure P9-47
          , write a differential equation for
          v
O
          (
          t
          ) in terms of the elements and
          v
S
          (
          t
          ). Assume
          v
C
          (0) = 0. Then let
          v
S
          (
          t
          ) =
          e

            -10
            t

u
          (
          t
          ) V,
          R
1
          = 1 kΩ,
          R
2
          = 10 kΩ, and
          C
          = 1 μF and using Laplace techniques, find the output
          v
O
          (
          t
          ).
          






FIGURE P9-47












                Objective 9-4 Initial and Final Value Properties (
                Sect. 9-6
                )
              

                Given the Laplace transform of a signal, find the initial and final values of the signal waveform. See
                Example 9-22
                and
                Exercise 9-33
                .
              




9-48
          Use the initial and final value properties to find the initial and final values of the waveforms corresponding to the transforms below. If either property is not applicable, explain why.
          





9-49
          Use the initial and final value properties to find the initial and final values of the waveforms corresponding to the transforms below. If either property is not applicable, explain why.
          

(a)



(b)





9-50
          Use the initial and final value properties to find the initial and final values of the waveforms corresponding to the transforms below. If either property is not applicable, explain why.
          

(a)



(b)






9-51

          The initial and final value properties are used to find the initial and final values of a waveform corresponding to a given transform. consider the following signals and determine what their transform's initial and final values would say. How do they compare with simply finding the limit at
          t
          = 0 and
          t
          → ∞?
          

(a)
f
1
              (
              t
              ) = 10
              e

                -50
                t

              cos(200
              t
              )
              u
              (
              t
              )
            

(b)
f
2
              (
              t
              ) = [50
              e

                -200
                t

              - 200
              e

                -500
                t

              ]
              u
              (
              t
              )
            

(c)
f
3
              (
              t
              ) = [5
              e

                -
                j
                10
                t

              + 5
              e

                +
                j
                10
                t

              ]
              u
              (
              t
              )
            



9-52
          Use the initial and final value properties to find the initial and final values of the waveform corresponding to the following transform. If either property is not applicable, explain why.
          






Integrating Problems


9-53
          The Dominant Pole Approximation
          

            When a transform
            F
            (
            s
            ) has widely separated poles, then those closest to the
            j
            -axis tend to dominate the response because they have less damping. An approximation to the waveform can be obtained by ignoring the contributions of all except the dominant poles. We can ignore the other poles simply by discarding their terms in the partial fraction expansion of
            F
            (
            s
            ). The
            
            purpose of this example is to examine a dominant pole approximation of the transform
          





(a)
              Construct a partial-fraction expansion of
              F
              (
              s
              ) and find
              f
              (
              t
              ).
            

(b)
              Construct a pole-zero diagram of
              F
              (
              s
              ) and identify the dominant poles.
            

(c)
              Construct a dominant pole approximation
              g
              (
              t
              ) by discarding the other poles in the partial fraction expansion in part (a).
            

(d)
              Plot
              f
              (
              t
              ) and
              g
              (
              t
              ) and comment on the accuracy of the approximation.
            



9-54
          First-Order Circuit Step Response
          

            In
            Chapter 7
            , we found that the step response of a first-order circuit can be written as
          




            where
            f
            (0) is the initial value,
            f
            (∞) is the final value and
            T
C
            is the time constant. Show that the corresponding transform has the form
          




            and relate the time-domain parameters
            f
            (0),
            f
            (∞), and
            T
C
            to the
            s
            -domain parameters
            K
            , γ, and α.
          




9-55

          Inverse Transform for Complex Poles
          
            In
            Section 9-4
            , we learned that complex poles occur in conjugate pairs and that for simple poles the partial fraction expansion of
            F
            (
            s
            ) will contain two terms of the form
          



Show that when the complex conjugate residues are written in rectangular form as




            the corresponding term in the waveform
            f
            (
            t
            ) is
          







9-56
          Butterworth Poles
          

            Steven Butterworth, a British engineer, 1885-1958, discovered a method of designing electric filters. He was quoted saying "An ideal electrical filter should not only completely reject the unwanted frequencies but should also have uniform sensitivity for the wanted frequencies." His algorithms are widely used in filter design, as we will see in
            Chapter 14
            . He based his design on locating the poles of his filters in a unique pattern around a circle of radius ω
            C
            . The number of poles on the circle constitutes the order of the filter. The more poles, the better the filter is. Odd-order filters include one real pole at - ω
            C
            and pairs of complex-conjugate poles placed on a circle of radius ω
            C
            at equal angular spacing. Even-order filters locate complexconjugate poles placed on a circle of radius ω
            C
            at equal angular spacing.
            Figure P9-56
            shows the location of the poles in a thirdand in a fourth-order Butterworth filter. Assuming an ω
            C
            of 1 rad/s, what is the denominator of the Laplace transform,
            F
            (
            s
            ), associated with each of the two Butterworth filters shown in the figure?
          







FIGURE P9-56










9-57

          Determining Pole Locations on the Real Axis
          
            In this problem, we wish to understand the behavior of a single-pole on the real axis. Consider the simple
            RC
            circuit shown in
            Figure P9-57
            . The only energy in the circuit is an initial voltage
            V
A
            stored on the capacitor. At
            t
            = 0, the switch closes.
          


(a)
              Write a differential equation for the capacitor voltage
              v
C
              (
              t
              ).
            

(b)
              Transform the equation into the frequency domain, and solve for
              V
C
              (
              s
              ).
            


(c)
              Solve for
              v
C
              (
              t
              ).
            

(d)
              Keeping
              C
              constant, vary
              R
              from ∞ Ω to 0 Ω and describe both the location of the pole as
              R
              is varied and what the time domain response
              v
C
              (
              t
              ) would look like. Be especially careful to explain what happens at the extreme end points for
              R.


(e)
              Suppose it was possible to make the resistor negative (possible with active circuits), what would happen to the pole and the time response?
            








FIGURE P9-57











Notes




1

            See Wilber R. LePage,
            Complex Variables and Laplace Transform for Engineering,
            Dover Publishing Co., New York, 1980, p. 318.
          


2

            Non-causal signals can be handled using other transformations. For example, the Fourier transforms introduced in
            Chapter 18
            .
          


3

            Consider an impulse as a triangle of zero width but infinite height. Its derivative, a doublet, would be an infinitely high spike going to + infinity immediately followed by an infinitely high spike going to - infinity. On a time-domain diagram, it would be drawn as a vertical two-headed arrow ⇅
            (a)
            with a weighing factor "(a)" like that of an impulse. On a pole-zero diagram, it would simply be a zero (
            0
            ) at the origin.
          















CHAPTER 10


s
              -DOMAIN CIRCUIT ANALYSIS
            




The resistance operator Z is a function of the electrical constants of the circuit components and of d/dt, the operator of time-differentiation, which will in the following be denoted by p simply.

1



            Oliver Heaviside, 1887,
            
            British Engineer
          









Some History Behind This Chapter

              The use of operational methods to study electric circuits was pioneered by Oliver Heaviside (1850-1925). The quotation given here was taken from his book
              Electrical Papers,
              originally published in 1887. His resistance operator
              Z,
              which he later called impedance, is a central theme for much of electrical engineering. Heaviside does not often receive the recognition he deserves, in part because his intuitive approach was not accepted by most Victorian scientists of his day. Mathematical justification for his methods was eventually supplied by John Bromwich and others. However, no important errors were found in Heaviside's results.
            









Why This Chapter Is Important Today

              In this chapter we use Laplace transforms to make analyzing dynamic circuits no more difficult than dc circuits. You will see that all the circuit analysis tools learned in
              Chapters 1
              through
              4
              can be extended to the study of the transient response of linear circuits. In addition, pole-zero diagrams will give you a new way to visualize and predict circuit behavior.
            









Chapter Sections



10-1 Transformed Circuits







                    10-2 Basic Circuit Analysis in the
                    s
                    Domain
                  







                    10-3 Circuit Theorems in the
                    s
                    Domain
                  







                    10-4 Node-Voltage Analysis in the
                    s
                    Domain
                  







                    10-5 Mesh-Current Analysis in the
                    s
                    Domain
                  







                    10-6 Summary of
                    s
                    -Domain Circuit Analysis
                  












Chapter Learning Objectives

10-1
              Equivalent Impedance (
              Sects. 10-1
              and
              10-2
              )
            
Given a linear circuit, use series and parallel equivalence to find the equivalent impedance at specified terminal pairs. Select element values to obtain specified pole locations.

10-2
              Basic Circuit Analysis Techniques (
              Sects. 10-2
              and
              10-3
              )
            
Given a linear circuit:


                (a) Determine the initial conditions (if not given) and transform the circuit into the
                s
                domain.
              
(b) Solve for zero-state and zero-input responses using circuit reduction, the unit output method, Thévenin or Norton equivalent circuits, or superposition.
(c) Identify the forced and natural poles in the responses or select circuit parameters to place the natural poles at specified locations.


10-3
              General Circuit Analysis (
              Sects. 10-4
              to
              10-6
              ) Given a linear circuit:
            


                (a) Determine the initial conditions (if not given) and transform the circuit into the
                s
                domain.
              
(b) Solve for zero-state and zero-input response transforms and waveforms using node-voltage or meshcurrent methods.
(c) Identify the forced and natural poles in the responses, or select circuit parameters to place the natural poles at specified locations.





10-1 Transformed Circuits

            So far, we have used the Laplace transformation to change waveforms into transforms and convert circuit differential equations into algebraic equations. These operations provide a useful introduction to the
            s
            domain. However, the real power of the Laplace transformation emerges when we transform the circuit itself and study its behavior directly in the
            s
            domain.
          

            The solid arrow in
            Figure 10-1
            indicates the analysis path we will be following in this chapter.
          


STEP 1
The process begins with a linear circuit in the time domain. We transform the circuit directly into the s domain. We will show how to do that shortly.


STEP 2
Once the circuit is transformed in the s domain, we can write the circuit equations directly in that domain using algebra. We can then solve these algebraic equations for the response transform.


STEP 3

                The inverse Laplace transformation then produces the response waveform, just like in
                Chapter 9
                .
              



            However, the
            s
            -domain approach is not just another way to derive response waveforms. This approach allows us to work directly with the circuit model using the analysis tools studied for dc circuits such as voltage division and equivalence plus some new ones using
            s
            -domain concepts. By working directly with the circuit model, we gain insights into the interaction between circuits and signals that cannot be obtained using the classical approach indicated by the dotted path in the left side of
            Figure 10-1
            . In addition, we avoid deriving the circuit-defining differential or integrodifferential equations required in
            Chapter 9
            .
          







FIGURE 10-1




                  Flow diagram for
                  s
                  -domain circuit analysis.
                





            How are we to transform a circuit? We have seen several times that circuit analysis is based on device and connection constraints. The connection constraints are derived from Kirchhoff 's laws and the device constraints from the
            i-υ
            relationships used to model the physical devices in the circuit. To transform circuits, we must see how these two types of constraints are altered by the Laplace transformation.
          


              Connection Constraints in the
              s
              Domain
            
A typical KCL connection constraint could be written as




              This connection constraint requires that the sum of the current waveforms at a node be zero for all times
              t.
              Using the linearity property, the Laplace transformation ofthis equation is
            




              In the
              s
              domain, the KCL connection constraint requires that the sum of the current transforms be zero for all values of
              s
              . This idea generalizes to any number ofcurrents ata node and any number ofnodes. In addition, this idea obviously applies to Kirchhoff's voltage law as well. The form of the connection constraints do not change because they are linear equations and the Laplace transformation is a linear operation. In summary, KCL and KVL apply to waveforms in the
              t
              domain and to transforms in the
              s
              domain.
            



              Element Constraints in the
              s
              Domain
            

              Turning now to the element constraints, we first deal with the independent signal sources shown in
              Figure 10-2
              . The
              i-υ
              relationships for these elements are
            







FIGURE 10-2



s-Domain models of independent sources.






(10-1)





              Independent sources are two-terminal elements. In the
              t
              domain, they constrain the waveform of one signal variable and adjust the unconstrained variable to meet the demands of the external circuit. We think of an independent source as a generator of a specified voltage or current waveform. The Laplace transformation of the expressions in
              Eq. (10-1)
              yields
            


(10-2)




              In the
              s
              domain, independent sources function the same way as in the
              t
              domain, except that we think of them as generating
              voltage
              or
              current transforms
              rather than waveforms.
            

              Next we consider the active elements in
              Figure 10-3
              . In the time domain, the element constraints for linear dependent sources are linear algebraic equations.
            








FIGURE 10-3



s-Domain models of dependent sources and OP AMPs.




              Because of the linearity property of the Laplace transformation, the forms of these constraints are unchanged when they are transformed into the
              s
              domain:
            


(10-3)



Similarly, the element constraints ofthe ideal OP AMP are linear algebraic equations that are unchanged in form by the Laplace transformation:



(10-4)






              Thus, for linear active devices, the only difference is that in the
              s
              domain the ideal element constraints apply to transforms rather than waveforms.
            

              Finally, we consider the two-terminal passive circuit elements shown in
              Figure 10-4
              . In the time domain their
              i-υ
              relationships are
            







FIGURE 10-4



s-Domain models of passive elements using voltage sources for initial conditions.





(10-5)




              These element constraints are transformed into the
              s
              domain by taking the Laplace transform of both sides of each equation using the linearity, differentiation, and integration properties.
            



(10-6)





              As expected, the element relationships are algebraic equations in the
              s
              domain. For the linear resistor, the
              s
              -domain version of Ohm's law says that the voltage transform
              V
R
              (
              s
              ) is proportional to the current transform
              I
R
              (
              s
              ). The element constraints for the inductor and capacitor also involve a proportionality between voltage and current but include a term for the initial conditions as well.
            

              The element constraints in
              Eq. (10-6)
              lead to the
              s
              -domain circuit models shown on the right side of
              Figure 10-4
              . The
              t
              -domain parameters
              L
              and
              C
              are replaced by proportionality factors
              Ls
              and 1/
              Cs
              in the
              s
              domain. The initial conditions associated with the inductor and capacitor are modeled as voltage sources in series with these elements. The polarities of these sources are determined by the sign of the corresponding initial condition terms in
              Eq. (10-6)
              . These initial condition voltage sources must be included when using these models to calculate the voltage transforms
              V
L
              (
              s
              ) or
              V
C
              (
              s
              ).
            


Impedance and Admittance

              The concept of
              impedance
              is a basic feature of
              s
              -domain circuit analysis. For zero initial conditions, the element constraints in
              Eq. (10-6)
              reduce to
            


(10-7)




              In each case, the element constraints are all of the form
              V
              (
              s
              ) =
              Z
              (
              s
              )
              I
              (
              s
              ), which means that in the
              s
              domain the voltage across the element is proportional to the current through it. The proportionality factor is called the element
              impedance
Z
              (
              s
              ). Stated formally,
            



Impedance
is the proportionality factor relating the transform of the voltage across a two-terminal element to the transform of the current through the element with all initial conditions set to zero.





              The impedances of the three passive elements are
            


(10-8)






Caution:


              It is important to remember that part of the definition of
              s
              -domain impedance is that the initial conditions are zero.
            

              The
              s
              -domain impedance is a generalization of the
              t
              -domain concept of resistance. The impedance of a resistor is its resistance
              R
              . The impedance of the inductor and capacitor depend on the inductance
              L
              and capacitance
              C
              and the complex frequency variable
              s
              . Since a voltage transform has units of V-s and current transform has units of A-s, it follows that impedance has units of ohms since (V-s)/(A-s) = V/A = Ω.
            

              Algebraically solving
              Eq. (10-6)
              for the element currents in terms of the voltages produces alternative
              s
              -domain models.
            



(10-9)





              In this form, the
              i-υ
              relations lead to the
              s
              -domain models shown in
              Figure 10-5
              . The reference directions for the initial condition current sources are determined by the sign of the corresponding terms in
              Eq. (10-9)
              . The initial condition sources are in parallel with the element impedance. Note that the relationships shown in
              Eq. (10-9)
              are just source transformations of those shown in
              Eq. (10-6)
              .
            







FIGURE 10-5



s-Domain models of passive elements using current sources for initial conditions.




Admittance
Y
              (
              s
              ) is the
              s
              -domain generalization of the
              t
              -domain concept of conductance and can be defined as the reciprocal of impedance.
            


(10-10)



Using this definition, the admittances of the three passive elements are


(10-11)




              Since
              Y
              (
              s
              ) is the reciprocal of impedance, its units are siemens since Ω
              -1
              = A/V = S.
            

              In summary, to transform a circuit into the
              s
              domain, we replace each element by an
              s
              -domain model. For independent sources, dependent sources, OP AMPs, and resistors, the only change is that these elements now constrain transforms rather than waveforms. For inductors and capacitors, we can use either the model with a series initial condition voltage source (
              Figure 10-4
              ) or the model with a parallel initial condition current source (
              Figure 10-5
              ).
            



Note:


              It would be easy to confuse an admittance for an inductor
              Y
L
              ( 
              s 
              ) = 1/ 
              Ls  
              with an impedance for an inductor   
              Z
L   
              (   
              s
              ) = 
              Ls 
              . Likewise for a capacitor. Hence, in 
              
              this text, unless specifically stated otherwise, we will always express elements as impedances (
              Z   
              ( 
              s   
              )).  
            

              To analyze the transformed circuit, we can use the tools developed for resistance circuits in
              Chapters 2    
              through  
              4    
              . These tools are applicable because KVL and KCL apply to transforms, and the
              s   
              -domain element constraints are linear equations similar to those for resistance circuits. These features make
              s 
              -domain analysis of dynamic circuits an algebraic process that is akin to resistance circuit analysis to phasor circuit analysis studied in
              Chapter 8    
              . 
            

              In    
              Example 10-1  
              , we will apply the three steps from   
              Figure 10-1 
              to a simple problem.   
            












EXAMPLE 10-1



                      The switch in
                      Figure 10-6
                      (a) has been in position 1 for a long time and is moved to position 2 at
                      t
                      = 0. For
                      t
                      > 0, transform the circuit into the
                      s
                      domain and use Laplace transforms to solve for the voltage
                      υ
C
                      (
                      t)
                      .
                    









FIGURE 10-6








SOLUTION:


This is a simple step-response problem solved before using various methods.


STEP 1

                      We will start by first transforming the circuit itself. For
                      t
                      > 0, the transformed circuit takes the form in
                      Figure 10-6
                      (b), where we have used a parallel current source
                      Cv
C
                      (0) to account for the initial condition.
                    


STEP 2

                      Next, we apply circuit domain theorems and algebraic techniques to solve for
                      V
C
                      (
                      s
                      ).
                    


Applying KCL to the current transforms at node A produces




                  For
                  t
                  < 0, the switch in
                  Figure 10-6
                  (a) is in position 1 and the circuit is in a dc steady-state condition. As a result, we have
                  υ
C
                  (0) =
                  V
A
                  . In the
                  s
                  -domain circuit ir
                  Figure 10-6
                  (b), the two branch current transforms can be written in terms of the capacitor voltage and element impedances as
                




                  Substituting these observations into the KCL equation and solving for
                  V
C
                  (
                  s
                  ) yields
                






STEP 3
Finally, we do an inverse Laplace transform to determine the response waveform.


Performing the inverse Laplace transformation leads to




                  The form of the response should be no great surprise. We could easily predict this response using the classical differential equation methods studied in
                  Chapter 7
                  . What is important in this example is that we obtained the response using only basic circuit concepts applied in the
                  s
                  domain.
                

                  One may wonder why we chose to use the parallel capacitor transform model from
                  Figure 10-5
                  (c) rather than the series transform model from
                  Figure 10-4
                  (c). In truth for this problem, it really does not matter. Let us solve the same problem using the series model.
                

                  Since we want to find the voltage across the capacitor, we must realize that the voltage includes the capacitor's initial condition as shown in
                  Figure 10-6
                  (c). In this case, that voltage is the same as the voltage across the resistor. We can readily find the voltage across the resistor using a voltage divider with the initial condition source providing the voltage. Thus,
                







FIGURE 10-6










                  which transforms back to the time domain the same as above. As with most engineering analyses, the choice of which model or technique to use is left up to the engineer. The better or best choice will come with practice.
                  ■










Exercise 10-1


                  Transform the circuit of
                  Figure 10-7
                  (a) into the
                  s
                  domain and solve for the voltage
                  υ
C
                  (
                  t
                  ) if
                  υ
S
                  (
                  t
                  ) =
                  V
A
e

                    -α
                    t

u
                  (
                  t
                  ) V and
                  υ
C
                  (0) =
                  V
0
                  .
                


Answers:




                    (a) The transformed circuit is shown in
                    Figure 10-7
                    (b).
                  

                    (b)
                    









FIGURE 10-7























EXAMPLE 10-2




                        (a)Transform the circuit in
                        Figure 10-8
                        (a) into the
                        s
                        domain.
                      

                        (b) Solve for the current transform
                        I
                        (
                        s
                        ).
                      

                        (c) Perform the inverse transformation to find the waveform
                        i
                        (
                        t
                        ).
                      










FIGURE 10-8








SOLUTION:





                      (a)
                      STEP 1
Figure 10-8
                      (b) shows the transformed circuit using a series voltage source
                      Li
L
                      (0) to represent the inductor's initial condition. The impedances of the two passive elements are
                      R
                      and
                      Ls.
                      The independent source voltage
                      V
A
u
                      (
                      t
                      ) transforms as
                      V
A
                      /
                      s
                      .
                    



                      (b)
                      STEP 2
                      By KVL, the sum of voltage transforms around the loop is
                    




                      Using the impedance models, the
                      s
                      -domain element constraints are
                    



Substituting the element constraints into the KVL constraint and collecting terms yields




                      Solving for
                      I
                      (
                      s
                      ) produces
                    




                      The current
                      I
                      (
                      s
                      ) is the transform of the circuit response for a step function input.
                      I
                      (
                      s
                      ) is a rational function with simple poles at
                      s
                      = 0 and
                      s
                      = −
                      R/L
                      .
                    



                      (c) To perform the inverse transformation, we expand
                      I
                      (
                      s
                      ) by partial fractions:
                    




STEP 3
                      Taking the inverse transform of each term in this expansion gives
                    












FIGURE 10-8








                  The forced response is caused by the step function input. The exponential terms in the natural response depend on the circuit time constant
                  L/R
                  . The step function and exponential components in
                  i
                  (
                  t
                  ) are directly related to the terms in the partial-fraction expansion of
                  I
                  (
                  s
                  ). The pole at the origin came from the step function input and leads to the forced response. The pole at
                  s
                  = −
                  RL
                  came from the circuit and leads to the natural response, see
                  Figure 10-8
                  (c). Thus, in the
                  s
                  domain, the forced response is that part of the total response that has the same poles as the input excitation. The natural response is that part of the total response whose poles came from the circuit. We say that the circuit contributes the natural poles because their locations depend on circuit parameters, not on the input. In other words, poles in the response do not occur by accident. They are present because the physical response depends on two things—(1) the input and (2) the circuit.
                  ■










Exercise 10-2


                  The source of the
                  t
                  -domain circuit of
                  Figure 10-8
                  (a) is suddenly turned off. Use Laplace techniques to solve for the voltage across the resistor
                  υ
R
                  (
                  t
                  ).
                


Answers:





















EXAMPLE 10-3



                      Find the output
                      
                        v
                        O
                        (t)
                      
                      for the dependent-source circuit shown in
                      Figure 10-9
                      (a). The capacitor has an initial voltage of
                      V
B
                      V.
                    









FIGURE 10-9








SOLUTION:



STEP 1
                  We start by transforming the circuit into the
                  s
                  domain as shown in
                  Figure 10-9
                  (b). The output transform voltage is
                  V
O
                  (
                  s
                  ) = -μ
                  V
X
                  (
                  s
                  ).
                

STEP 2
                  We can solve for
                  V
x
                  (
                  s
                  ) by writing a loop equation around the input loop and solving for
                  I
                  (
                  s
                  ). Starting at the source voltage, we get
                




                  Substituting
                  V
B
                  for
                  υ
C
                  (0) and solving for
                  I
                  (
                  s
                  )
                




                  Recognizing that
                  V
X
                  (
                  s
                  ) =
                  I
                  (
                  s
                  )/
                  Cs
                  +
                  V
B
                  /
                  s
                  , we get
                





                  We can now find
                  V
O
                  (
                  s
                  )
                



The first term can be expanded by partial fractions




STEP 3
                  Taking the inverse transform of each term gives
                




                  The forced response is caused by the input step function. The exponential terms in the natural response are caused by the circuit's
                  RC
                  time constant. The dependent source, in this example, simply multiplies the input and stored voltage responses by −μ.
                  ■










Exercise 10-3


                  Replace the capacitor in the circuit of
                  Figure 10-9
                  (a) with an inductor,
                  L
                  , with an initial current of
                  I
B
                  A. Find
                  υ
O
                  (
                  t
                  ) and identify the forced and natural responses.
                


Answers:





There is no forced component-at steady state because the inductor shorts out the input to the dependent source.






            10-2 Basic Circuit Analysis in the
            s
            Domain
          

            In this section, we develop the
            s
            -domain versions of series and parallel equivalence and voltage and current division. These analysis techniques are the basic tools in
            s
            -domain circuit analysis, just as they are for resistance circuit analysis. These methods apply to circuits with elements connected in series or parallel. other circuit theorems such as superposition and Thévenin equivalence are covered in
            Sect. 10-3
            . General analysis methods using node-voltage or mesh-current equations are covered in
            Sects. 10-4
            and
            10-5
            .
          

Series Equivalence and Voltage Division

              The concept of a series connection applies in the
              s
              domain because Kirchhoff's laws do not change under the Laplace transformation. In
              Figure 10-10
              , the two-terminal elements are connected in series; hence by KCL the same current
              I
              (
              s
              ) exists in impedances
              Z
1
              (
              s
              ),
              Z
2
              (
              s
              ), ...,
              Z

N

              (
              s
              ). Using KVL and the element constraints, the voltage across the series connection can be written as
            


(10-12)










FIGURE 10-10



Series equivalence in the
                  s
                  domain.





              The last line in this equation points out that the responses
              V
              (
              s
              ) and
              I
              (
              s
              ) do not change when the series-connected elements are replaced by an
              equivalent impedance
              :
            


(10-13)




              In general, the equivalent impedance
              Z
EQ
              (
              s
              ) is a quotient of polynomials in the complex frequency variable of the form
            


(10-14)




              The roots of the numerator polynomial are the zeros of
              Z
EQ
              (
              s
              ), while the roots of the denominator are the poles.
            

              Combining
              Eqs. (10-12)
              and
              (10-13)
              , we can write the element voltages in the form
            


(10-15)




              These equations are the
              s
              -domain
              voltage division principle:





Every element voltage in a series connection is equal to its impedance divided by the equivalent impedance of the connection times the voltage across the series circuit.





              This statement parallels the corresponding rule for resistance circuits given in
              Chapter 2
              .
            


Parallel Equivalence and Current Division

              The parallel circuit in
              Figure 10-11
              is the dual of the series circuit discussed previously. In this circuit the two-terminal elements are connected in parallel; hence by KVL the same voltage
              V
              (
              s
              ) appears across admittances
              Y
1
              (
              s
              ),
              Y
2
              (
              s
              ),...,
              Y

N

              (
              s
              ). Using
              
              KCL and the element constraints, the current into the parallel connection can be written as
            







FIGURE 10-11



Parallel equivalence in the s domain.





(10-16)




              The last line in this equation points out that the responses
              V
              (
              s
              ) and
              I
              (
              s
              ) do not change when the parallel connected elements are replaced by an
              equivalent admittance
              :
            


(10-17)




              In general, the equivalent admittance
              Y
EQ
              (
              s
              ) is a quotient of polynomials in the complex frequency variable
              s.
              Since impedance and admittance are reciprocals, it turns out that if
              Y
EQ
              (
              s
              ) =
              p
              (
              s
              )/
              q
              (
              s
              ), then the equivalent impedance at the same pair of terminals has the form
              Z
EQ
              (
              s
              ) = 1/
              Y
EQ
              (
              s
              ) =
              q
              (
              s
              )/
              p
              (
              s
              ). That is, at a given pair of terminals, the poles of
              Z
EQ
              (
              s
              ) are zeros of
              Y
EQ
              (
              s
              ), and vice versa.
            

              Combining
              Eqs. (10-16)
              and
              (10-17)
              , we can write the element currents in the form
            


(10-18)




              These equations are the
              s
              -domain
              current division principle:





Every element current in a parallel connection is equal to its admittance divided by the equivalent admittance of the connection times the current into the parallel circuit.




This statement is the dual of the results for a series circuit and parallels the current division rule for resistance circuits.

              We begin to see that
              s
              -domain circuit analysis involves basic concepts that parallel the analysis of resistance circuits in the
              t
              domain. Repeated application of series/ parallel equivalence and voltage/current division leads to an analysis approach called circuit reduction, discussed in
              Chapter 2
              . The major difference here is that we use impedance and admittances rather than resistance and conductance, and the analysis yields voltage and current transforms rather than waveforms. Also, we will begin to see that the response transform is adequate for understanding the circuit's behavior and that there is often little need to use the inverse Laplace transform to find the response waveform.
            












EXAMPLE 10-4



                      The inductor current and capacitor voltage in
                      Figure 10-12
                      (a) are zero at
                      t
                      = 0.
                    


                        (a) Transform the circuit into the
                        s
                        domain and find the equivalent impedance between terminals A and B.
                      

                        (b) Use voltage division to solve for the output voltage transform
                        V
2
                        (
                        s
                        ).
                      










FIGURE 10-12








SOLUTION:





                      (a)
                      Figure 10-12
                      (b) shows the circuit in
                      Figure 10-12
                      (a) transformed into the
                      s
                      domain. As a first step, we use parallel equivalence to find the equivalent impedance of the parallel resistor and capacitor.
                    





Figure 10-12
                      (c) shows that the equivalent impedance
                      Z
EQ1
                      (
                      s
                      ) is connected in series with the inductor. This series combination can be replaced by an equivalent impedance
                    




                      as shown in
                      Figure 10-12
                      (d). The rational function
                      Z
EQ
                      (
                      s
                      ) is the impedance seen between terminals A and B in
                      Figure 10-12
                      (b).
                    



                      (b) Using voltage division in
                      Figure 10-12
                      (c), we find
                      V
2
                      (
                      s
                      ) as
                    




                      Note that
                      Z
EQ
                      (
                      s
                      ) and
                      V
2
                      (
                      s
                      ) are rational functions of the complex frequency variable
                      s
                      .
                      ■












Exercise 10-4


                  The circuit of
                  Figure 10-13
                  is in the zero state.
                







FIGURE 10-13








                    (a) Find the equivalent impedance
                    Z
IN
                    (
                    s
                    ) that the source sees.
                  

                    (b) Find the output voltage
                    V
2
                    (
                    s
                    ).
                  



Answers:





                      (a)
                      




                      (b)
                      


















EXAMPLE 10-5


                      Consider the
                      s
                      -domain circuit in
                      Figure 10-14
                      (a).
                    







FIGURE 10-14








                        (a) Find the input impedance
                        Z
IN
                        (
                        s
                        ).
                      

                        (b) Find the ratio of the output
                        V
2
                        (
                        s
                        ) to the input
                        V
1
                        (
                        s
                        ).
                      

                        (c) What are the poles and zeros of the input impedance and of
                        V
2
                        (
                        s
                        )/
                        V
1
                        (
                        s
                        ).
                      





SOLUTION:





                      (a) Let us start with finding
                      Z
IN
                      (
                      s
                      ). In this example there are two parallel branches: 0.5
                      s
                      + 2k and 1k + 10
                      6
                      /
                      s
                      . We can combine them as follows
                    





                      Which can be factored as follows
                    





(b) The output is across a resistor that is in series with an inductor and the pair is in parallel with the source voltage. This allows us to use a simple voltage divider






                      (c) The poles of the input impedance are at
                      s
                      = −354 and
                      s
                      = −5646 and zeros are at
                      s
                      = −1000 and
                      s
                      = −4000. The single pole of
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ) is at
                      s
                      = −4000, while its only zero is at infinity (see
                      Figure 10-14
                      (b)).
                    







FIGURE 10-14







■













Exercise 10-5


                  For the
                  Figure 10-14
                  , find the following:
                


                    (a) The impedance
                    Z
2
                    (
                    s
                    ) seen looking into the
                    V
2
                    (
                    s
                    ) terminals with the input source set to zero (short-circuited).
                  

                    (b) The poles and zeros of
                    Z
2
                    (
                    s
                    )?
                  

                    (c) The impedance
                    Z
2
                    (
                    s
                    ) seen looking into the
                    V
2
                    (
                    s
                    ) terminals with the input source removed (open-circuited).
                  

                    (d) The poles and zeros of
                    Z
2
                    (
                    s
                    ) in this second case?
                  



Answers:




                    (a)
                    


                    (b) Pole at
                    s
                    = −4000, zero at
                    s
                    = 0. See
                    Figure 10-14
                    (c).
                  

                    (c)
                    


                    (d) Poles are at
                    s
                    = -354 and
                    s
                    = -5646, zeros at
                    s
1
                    ,
                    s
2
                    = -1000 ±
                    j
                    1000. See
                    Figure 10-14
                    (c).
                  








FIGURE 10-14





















                      DESIGN EXAMPLE 10-6
                    

                      In a circuit
                      analysis
                      problem we are required to find the poles and zeros of a circuit. In circuit
                      design
                      we are required to adjust circuit parameters to place the poles and zeros at specified
                      s
                      -plane locations. This example is a simple pole-placement design problem.
                    


                        (a) Transform the circuit in
                        Figure 10-15
                        (a) into the
                        s
                        domain and find the equivalent impedance between terminals A and B.
                      

                        (b) Select the values of
                        R
                        and
                        C
                        such that
                        Z
EQ
                        (
                        s
                        ) has a zero at
                        s
                        = − 5000 rad/s.
                      





SOLUTION:





                      (a)
                      Figure 10-15
                      (b) shows the circuit transformed to the
                      s
                      domain. The equivalent impedance
                      Z
EQ1
                      (
                      s
                      ) is
                    





                      Hence, the equivalent impedance between terminals A and B is
                    






                      (b) For
                      Z
EQ
                      (
                      s
                      ) to have a zero at
                      s
                      = −5000 requires 2/
                      RC
                      = 5000 or
                      RC
                      = 4 × 10
                      −4
                      . Selecting a standard value for the resistor
                      R
                      = 10 kΩ in turn requires
                      C
                      = 0.04 μF.
                      ■













                  Design
                  Exercise 10-6


                  For
                  Figure 10-15
                  , select values of
                  R
                  and
                  C
                  so the
                  Z
EQ
                  (
                  s
                  ) has a pole at
                  s
                  = −10,000 Use standard values from
                  Appendix G
                  . Under this design where is the zero located?
                







FIGURE 10-15








Answers:



                  Select
                  R
                  = 10 kΩ,
                  C
                  = 0.01 μF
                

                  Zero at
                  s
                  = −20,000
                












                  Design
                  Exercise 10-7


                  The circuit of
                  Figure 10-16
                  (a) is in the zero state.
                







FIGURE 10-16








                    (a) Find the output current transform
                    I
2
                    (
                    s
                    ).
                  

                    (b) If
                    R
                    = 1 kΩ, select values of
                    L
                    and
                    C
                    such that
                    I
2
                    (
                    s
                    ) has two identical poles at −5000 rad/s.
                  

                    (c) If
                    I
1
                    (
                    s
                    ) = 1/
                    s
                    A-s, use MATLAB to find
                    i
2
                    (
                    t
                    ). Plot
                    i
2
                    (
                    t
                    ) vs time.
                  



Answers:




                    (a)
                    


                    (b)
                    L
                    = 100 mH,
                    C
                    = 0.4 μF
                  

                    (c)
                    i
2
                    (
                    t
                    ) = (
                    e

                      (−5000
                      t
                      )
                    
                    − 5000
                    t
e

                      (−5000
                      t
                      )
                    
                    )
                    u
                    (
                    t
                    ) A; see
                    Figure 10-16
                    (b).
                  








FIGURE 10-16

















Exercise 10-8


                  The inductor current and capacitor voltage in
                  Figure 10-17
                  are zero at
                  t
                  =0.
                







FIGURE 10-17







(a) Find the equivalent impedance between terminals A and B.

                    (b) Solve for the output voltage transform
                    V
2
                    (
                    s
                    ) in terms of the input voltage
                    V
1
                    (
                    s
                    ).
                  



Answers:




                    (a)
                    


                    (b)
                    








            10-3 Circuit Theorems in the
            s
            Domain
          

            In this section, we study the
            s
            -domain versions ofproportionality, superposition, and Thévenin/Norton equivalent circuits. These theorems define fundamental properties that provide conceptual tools for the analysis and design oflinear circuits. With some modifications, all of the theorems studied in
            Chapter 3
            apply to linear dynamic circuits in the
            s
            domain.
          

Proportionality

              For linear resistance circuits, the
              proportionality theorem
              states that any output
              y
              is proportional to the input
              x
              :
            


(10-19)




              The same concept applies to linear dynamic circuits in the
              s
              domain except that the proportionality factor
              K
              is a rational function of
              s
              rather than a constant. For instance, in
              Example 10-4
              , we found the output voltage
              V
2
              (
              s
              ) to be
            


(10-20)




              where
              V
1
              (
              s
              ) is the transform of the input voltage. The quantity inside the brackets is a rational function that serves as the proportionality factor between the input and output transforms.
            

              In the
              s
              -domain, rational functions that relate inputs and outputs are called
              network functions
              . We begin the formal study of network functions in
              Chapter 11
              . In this chapter, we will simply illustrate network functions by an example.
            











EXAMPLE 10-7


                      There is no initial energy stored in the circuit in
                      Figure 10-18
                      (a). Find the network functions relating
                      I
R
                      (
                      s
                      ) to
                      V
1
                      (
                      s
                      ) and
                      I
C
                      (
                      s
                      ) to
                      V
1
                      (
                      s
                      ). Draw block diagrams of each.
                    









FIGURE 10-18








SOLUTION:


The equivalent impedance seen by the voltage source is





                  Hence we can relate the
                  I
L
                  (
                  s
                  ) and
                  V
1
                  (
                  s
                  ) as
                




                  Using
                  s
                  -domain current division, we can relate
                  I
R
                  (
                  s
                  ) and
                  I
C
                  (
                  s
                  ) to
                  I
L
                  (
                  s
                  ) as
                




                  Finally, using these relationships plus the relationship between
                  I
L
                  (
                  s
                  ) and
                  V
1
                  (
                  s
                  ) derived previously, we obtain the required network functions.
                




                  Block diagrams are shown in
                  Figure 10-18
                  (b).
                







FIGURE 10-18







■











Exercise 10-9


                  In
                  Figure 10-19
                  find the network function relating the output
                  V
2
                  (
                  s
                  ) to the input
                  V
1
                  (
                  s
                  ).
                







FIGURE 10-19








Answers:









Superposition

              For linear resistance circuits, the
              superposition theorem
              states that any output
              y
              of a linear circuit can be written as
            


(10-21)




              where
              x
1
              ,
              x
2
              ,
              x
3
              ,... are circuit inputs and
              K
1
              ,
              K
2
              ,
              K
3
              ,... are weighting factors that depend on the circuit. The same concept applies to linear dynamic circuits in the
              s
              domain except that the weighting factors are rational functions of
              s
              rather than constants.
            

              Superposition is usually thought of as a way to find the circuit response by adding the individual responses caused by each input acting alone. However, the principle applies to groups of sources as well. In particular, in the
              s
              domain, there are two types of independent sources: (1) voltage and current sources representing the external driving forces for
              t
              ≥ 0 and (2) initial condition voltage and current sources representing the energy stored at
              t
              = 0. As a result, the superposition principle states that the
              s
              -domain response can be found as the sum of two components: (1) the
              zero-input response
              caused by the initial condition sources with the external inputs turned off and (2) the
              zero-state response
              caused by the external inputs with the initial condition sources turned off. Turning a source off means replacing voltage sources by short circuits [
              V
S
              (
              s
              ) = 0] and current sources by open circuits [
              I
S
              (
              s
              ) = 0].
            

              The zero-input response is the response of a circuit to its initial conditions when the input excitations are set to zero. The zero-state response is the response of a circuit to its input excitations when all of the initial conditions are set to zero. The term
              
zero input
              is self-explanatory. The term
              zero state
              is used because there is no energy stored in the circuit at
              t
              = 0.
            
The result is that voltage and current transforms in a linear circuit can be found as the sum of two components of the form


(10-22)




              where the subscript
              zs
              stands for zero state and
              zi
              for zero input. An important corollary is that the time-domain response can also be partitioned into zero-state and zero-input components because the inverse Laplace transformation is a linear operation.
            

              We analyze the circuit treated in
              Example 10-2
              to illustrate the superposition of zero-state and zero-input responses. The transformed circuit in
              Figure 10-20
              has two independent voltage sources: (1) an input voltage source and (2) a voltage source representing the initial inductor current. The resistor and inductor are in series, so these two elements can be replaced by an impedance
              Z
EQ
              (
              s
              ) =
              Ls
              +
              R
              .
            







FIGURE 10-20



Using superposition to find the zero-state and zero-input responses.




              First, we turn off the initial condition source and replace its voltage source by a short circuit. Using the resulting zero-state circuit shown in
              Figure 10-20
              , we obtain the zero-state response:
            



(10-23)





              The pole at
              s
              = 0 comes from the input source and the pole at
              s
              = −
              R/L
              comes from the circuit. Next, we turn off the input source and use the zero-input circuit shown in
              Figure 10-20
              to obtain the zero-input response:
            



(10-24)





              The pole at
              s
              = −
              R/L
              comes from the circuit. The zero-input response does not have a pole at
              s
              = 0 because the step function input is turned off.
            

              Superposition states that the total response is the sum of the zero-state component in
              Eq. (10-23)
              and the zero-input component in
              Eq. (10-24)
              .
            


(10-25)




              The transform
              I
              (
              s
              ) in this equation is the same as found in
              Example 10-2
              . To derive the time-domain response, we expand
              I
              (
              s
              ) by partial fractions:
            


(10-26)





              Performing the inverse transformation on each term yields
            



(10-27)





              Using superposition to partition the waveform into zero-state and zero-input components produces the same result as
              Example 10-2
              , in which we solved for the forced and natural responses. When we solve the circuit using superposition, the zero-state component contains the forced response. The zero-state and zeroinput components both contain an exponential term due to the natural pole at
              s
              = −
              R/L
              because both the external driving force and the initial condition source excite the circuit's natural response. We show how the forced and natural responses compare with the zero-state and zero-input responses in
              Eq. (10-27)
              .
            

              The superposition theorem helps us understand the response of circuits with multiple inputs, including initial conditions. It is a conceptual tool that helps us organize our thinking about
              s
              -domain circuits in general. It is not necessarily the most efficient analysis tool for finding the response of a specific multiple-input circuit.
            











EXAMPLE 10-8


                      The switch in
                      Figure 10-21
                      (a) has been open for a long time and is closed at
                      t
                      =0
                    


                        (a) Transform the circuit into the
                        s
                        domain.
                      

                        (b) Find the zero-state and zero-input components of
                        V
                        (
                        s
                        ).
                      

                        (c) Find
                        υ
                        (
                        t
                        ) for
                        I
A
                        = 1 mA,
                        L
                        = 2 H,
                        R
                        = 1.5 kΩ, and
                        C
                        = 1/6 μF.
                      





SOLUTION:





                      (a) To transform the circuit into the
                      s
                      domain, we must find the initial inductor current and capacitor voltage. For
                      t
                      < 0, the circuit is in a dc steady-state condition with the switch open. The inductor acts like a short circuit, and the capacitor acts like an open circuit. By inspection, the initial conditions at
                      t
                      = 0− are
                      i
L
                      (0) = 0 and
                      υ
C
                      (0) =
                      I
A
R
                      .
                      Figure 10-21
                      (b) shows the
                      s
                      -domain circuit for these initial conditions. The current source version for the capacitor's initial condition is used here because the circuit elements are connected in parallel. The switch and constant current source combine to produce a step function
                      I
A
u
                      (
                      t
                      ) whose transform is
                      I
A
                      /
                      s
                      .
                    







FIGURE 10-21








(b) The resistor, capacitor, and inductor can be replaced by an equivalent impedance




                      The zero-state response is found with the capacitor initial condition source replaced by an open circuit and the step function input source on as shown in
                      Figure 10-21
                      (c):
                    




                      The pole in the input at
                      s
                      = 0 is canceled by the zero at the origin in
                      Z
EQ
                      (
                      s
                      ). As a result, the zero-state response does not have a forced pole at
                      s
                      = 0. The zero-input
                      
                      response is found by replacing the input source by an open circuit and turning the capacitor initial condition source on as shown in
                      Figure 10-21
                      (d):
                    







FIGURE 10-21











(c) Inserting the given numerical values of the circuit parameters and expanding the zero-state and zero-input response transforms by partial fractions yields



The inverse transforms of these expansions are




                      Note that the circuit responses contain only transient terms that decay to zero. There is no forced response because in the dc steady state the inductor acts like a short circuit, forcing
                      υ
                      (
                      t
                      ) to zero for
                      t
                      → ∞. From an
                      s
                      -domain viewpoint, there is no forced response because the forced pole at
                      s
                      = 0 is canceled by a zero in the network function.
                      ■













                  Design
                  Exercise 10-10


                  The switch in the circuit of
                  Figure 10-21
                  (a) has been closed for a long time. At
                  t
                  = 0 the switch is suddenly opened.
                


                    (a) Find the transform
                    I
R
                    (
                    s
                    ) for the current through the resistor.
                  

                    (b) Select values of
                    R
                    ,
                    L
                    , and
                    C
                    so that the current reaches at least 63% of its final value in 100 ms or less.
                  



Answers:




                    (a)
                    


                    (b) After one time constant the current reaches 63% of its final value; hence
                    RC
                    < 100 ms.
                    R
                    = 56 kΩ and
                    C
                    = 1 μF are one pair of values that work; there are many others. The value of
                    L
                    does not matter since it is not connected in the circuit after
                    t
                    = 0.
                  
















EXAMPLE 10-9


                      Use superposition to find the zero-state component of
                      I
                      (
                      s
                      ) in the
                      s
                      -domain circuit shown in
                      Figure 10-22
                      (a).
                    







FIGURE 10-22










SOLUTION:



                  Turning the voltage source off produces the circuit in
                  Figure 10-22
                  (b). In this circuit, the resistor and capacitor are connected in parallel, so current division yields
                  I
1
(s)
                  in the form
                





                  Turning the voltage source on and the current source off produces the circuit in
                  Figure 10-22
                  (c). In this case, the resistor and capacitor are connected in series, and series equivalence gives the current
                  I
2
                  (
                  s
                  ) as
                



Using superposition, the total zero-state response is




                  There is a minus in this equation because
                  I
1
                  (
                  s
                  ) and
                  I
2
                  (
                  s
                  ) were assigned opposite reference directions in
                  Figure 10-22
                  (b) and (c). The total zero-state response has four poles. The natural pole at
                  s
                  = −1
                  /RC
                  came from the circuit. The forced pole at
                  s
                  = −α came from the current source, and the two forced poles at
                  s
                  = ±
                  j
                  β came from the voltage source.
                

                  In this example, the time-domain response would have a transient component
                  Ke

                    −
                    t/RC

                  due to the natural pole, a forced component
                  Ke

                    −α
                    t

                  due to the current source, and a forced component of the form
                  K
A
                  cosβ
                  t
                  +
                  K
B
                  sinβ
                  t
                  due to the voltage source. We can infer these general conclusions regarding the time-domain response by simply examining the poles of the
                  s
                  -domain response.
                  ■










Exercise 10-11


                  The initial conditions for the circuit in
                  Figure 10-23
                  are
                  υ
C
                  (0−) = 0 and
                  i
L
                  (0−) =
                  I
0
                  . Transform the circuit into the
                  s
                  domain and find the zero-state and zero-input components of
                  V
                  (
                  s
                  ).
                







FIGURE 10-23








Answers:














Exercise 10-12


                  The initial conditions for the circuit in
                  Figure 10-24
                  are
                  υ
C
                  (0−) = 0 and
                  i
L
                  (0−) =
                  I
0
                  . Transform the circuit into the
                  s
                  domain and find the zero-state and zero-input components of
                  I
                  (
                  s
                  ).
                







FIGURE 10-24








Answers:



















EXAMPLE 10-10


                      A transformed dependent-source circuit is shown in
                      Figure 10-25
                      (a). The capacitor has an initial voltage of
                      V
B
                      V. Use superposition to find the zero-state and zero-input responses. Combine the results to find the total response transform
                      V
O
                      (
                      s
                      ). Then use the total response components to find the poles of the circuit. Identify the poles as forced or natural.
                    









FIGURE 10-25









SOLUTION:



                  The output transform voltage is
                  V
O
                  (
                  s
                  ) = − μ
                  V
X
                  (
                  s
                  ). With two independent voltage sources, we find
                  V
X
                  (
                  s
                  ) by using superposition and using voltage dividers. Starting with the source voltage, we find the zero-state contribution to
                  V
X
                  (
                  s
                  ) as shown in
                  Figure 10-25
                  (b)
                




                  For the zero-input contribution to
                  V
X
                  (
                  s
                  ) shown in
                  Figure 10-25
                  (c), let
                  υ
C
                  (0) =
                  V
B
                  , to yield
                



Adding these results together, we get



Therefore, the output transform is



We can expand the first term by partial fractions so that our total response transform is




                  The result has two poles, a forced pole determined by the input source at
                  s
                  = − α, and a second natural pole determined by the circuit at
                  s
                  = −1/
                  RC
                  .
                  ■










Exercise 10-13


                  For the circuit of
                  Figure 10-25
                  (a), let the input voltage
                  V
S
                  (
                  s
                  ) =
                  V
A
                  /
                  s
                  , and use superposition to find the zero-state and the zero-input components of the output. Identify the forced and natural poles. Then show that
                  υ
O
                  (
                  t
                  ) is the same as that found in
                  Example 10-3
                  .
                


Answers:







                  forced pole at
                  s
                  = 0, natural pole at
                  s
                  = −1/
                  RC
                  .
                







Thévenin and Norton Equivalent Circuits

              In the
              s
              domain, a two-terminal circuit containing linear elements and sources can be replaced by the Thévenin or Norton equivalent circuits in
              Figure 10-26
              . The general concept and restrictions are the same in the
              s
              domain as for resistive circuits. The important differences here are that the source terms
              V
T
              (
              s
              ) and
              I
N
              (
              s
              ) are transforms while
              Z
T
              and
              Z
N
              are
              s
              -domain impedances.
            







FIGURE 10-26



Thévenin and Norton equivalent circuits in the s domain.




              To find the Thévenin or Norton equivalent circuit, we use the same process as for resistance circuits, except that now we must manipulate rational functions of
              s.
              Since the Thévenin and Norton circuits are equivalent to each other, their circuit parameters are related to the
              s
              -domain open-circuit voltage
              V
OC
              (
              s
              ) and short-circuit current
              I
SC
              (
              s
              ) as
            



(10-28)





              Algebraically the results in
              Eq. (10-28)
              are identical to the corresponding equations for resistance circuits, except that these equations involve transforms and impedances rather than waveforms and resistances. collectively these equations showthat finding a Thévenin or Norton equivalent involves finding any two of the following three quantities: (1) the open-circuit voltage
              V
OC
              (
              s
              ), (2) the short-circuit current
              I
SC
              (
              s
              ) and (in the absence of dependent sources) (3) the lookback impedance with all independent sources turned off.
            

              The relationships in
              Eq. (10-28)
              also define
              source transformations
              that allow us to convert a voltage source in series with an impedance into a current source in parallel with the same impedance, or vice versa. Performing
              s
              -domain source transformations may lead to circuit simplifications and can be useful when formulating node-voltage or mesh-current equations, as discussed in the following section.
            

              Thévenin and Norton equivalent circuits should be regarded as important conceptual tools offering insight into how circuits operate in the
              s
              domain. They are not, in general, important tools for reducing the computational effort involved in
              s
              -domain circuit analysis.
            











EXAMPLE 10-11


                      The circuit in
                      Figure 10-27
                      (a) is in the zero state. convert the Norton subcircuit to the left of points A and B into its Thévenin equivalent. Then apply voltage division to find the
                      s
                      -domain relationship between the input
                      I
1
                      (
                      s
                      ) and the output
                      V
2
                      (
                      s
                      ).
                    







FIGURE 10-27











SOLUTION:



                  In this example, we use a source transformation on the subcircuit to the left of points A and B in
                  Figure 10-27
                  (a). This Norton subcircuit consists of an independent current source
                  I
N
                  =
                  I
1
                  (
                  s
                  ) in parallel with an impedance
                  Z
N
                  =
                  R
                  . The equivalent Thévenin circuit consists of a voltage source
                  V
T
                  =
                  I
N
Z
N
                  =
                  RI
1
                  (
                  s
                  ) in series with an impedance
                  Z
T
                  =
                  Z
N
                  =
                  R
                  .
                  Figure 10-27
                  (b) shows the circuit after the source transformation. Applying voltage division in the modified circuit yields the required input-output relationship.
                




■











Exercise 10-14


                  The circuit of
                  Figure 10-28
                  (a) is in the zero state.
                







FIGURE 10-28







(a) Find the Thévenin equivalent circuit that the load sees.
(b) Find the Norton equivalent of the same circuit.



Answers:




                    (a)
                    


                    (b)
                    












Exercise 10-15


                  The circuit in
                  Figure 10-28
                  (a) has a 1-MΩ resistive load connected across the output. If
                  C
1
                  =
                  C
2
                  = 1 μF and
                  R
                  = 10 kΩ, find and plot the location of the poles and zeros of
                  V
O
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                


Answers:



                  Poles at
                  s
                  = −101.01 and
                  s
                  = −0.99; zero at
                  s
                  = 0 and one at infinity. See
                  Figure 10-28
                  (b).
                







FIGURE 10-28





















EXAMPLE 10-12


                      The circuit in
                      Figure 10-29
                      (a) is in the zero state. Use a Thévenin equivalent to find the
                      s
                      -domain network function
                      k
                      =
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ).
                    









FIGURE 10-29









SOLUTION:



                  In this example, we treat the capacitor as a load and find the Thévenin equivalent circuit to the left of points A and B as shown in
                  Figure 10-29
                  (b). To obtain the required Thévenin circuit, we find the open-circuit voltage and lookback impedance.
                  Figure 10-29
                  (c) shows the open-circuit situation. There is no voltage across the inductor, so the open-circuit voltage
                  V
T
                  (
                  s
                  ) is the same as the voltage across the second resistor. Using voltage division we have
                




                  To find the lookback impedance, we turn the input voltage source off [replace
                  V
1
                  (
                  s
                  ) by a short circuit] to obtain the situation in
                  Figure 10-29
                  (d). By inspection,
                




                  Given the
                  V
T
                  (
                  s
                  ) and
                  Z
T
                  , we return to
                  Figure 10-29
                  (b) and use voltage division to obtain the desired network function,
                  K
                  .
                




■











Exercise 10-16


                  Find the Norton and the Thévenin equivalents of the
                  s
                  -domain circuits in
                  Figure 10-30
                  .
                







FIGURE 10-30








Answers:




                    (a)
                    



                    (b)
                    








            10-4 Node-Voltage Analysis in the
            s
            Domain
          

            The previous sections deal with basic analysis methods using equivalence, reduction, and circuit theorems. These methods are valuable because we work directly with the element impedances and thereby gain insight into
            s
            -domain circuit behavior. We also need general methods to deal with more complicated circuits that these basic methods cannot easily handle.
          

Formulating Node-Voltage Equations
Formulatingnode-voltage equations involvesselectingareference node and assigning a node-to-datum voltage to each of the remaining nonreference nodes. Because of KVL, the voltage across any two-terminal element is equal to the difference of the two node voltages. Thisfundamentalpropertyofnode voltages, togetherwithelement impedances, allows us to write KCL constraints at each of the nonreference nodes.

              For example, consider the
              s
              -domain circuit in
              Figure 10-31
              . The sum of currents leaving node
              A
              can be written as
            







FIGURE 10-31



An example node.






Rewriting this equation with unknown node voltages grouped on the left and inputs on the right yields



Expressing this result in terms of admittances produces the following equation:




              This equation has a familiar pattern. The unknowns are the node-voltage transforms
              V
A
(s)
              ,
              V
B
(s)
              , and
              V
C
              (
              s
              ). The coefficient [
              Y
1
(s)
              +
              Y
2
(s)
              +
              Y
3
              (
              s
              )] of
              V
A
              (
              s
              ) is the sum of the admittances of the elements connected to node A. The coefficient [
              Y
2
              (
              s
              )] of
              V
B
              (
              s
              ) is the admittance of the elements connected between nodes A and B, while [
              Y
3
              (
              s
              )] is the admittance of the elements connected between nodes A and c. Finally,
              I
S1
              (
              s
              ) -
              I
S2
              (
              s
              ) is the sum of the source currents directed into node A. These observations suggest that we can write node-voltage equations for
              s
              -domain circuits by inspection, just as we did with resistive circuits.
            
The formulation method just outlined assumes that there are no voltage sources in the circuit. When transforming the circuit, we can always select the current source models to represent the initial conditions. However, the circuit may contain dependent or independent voltage sources. If so, they can be treated using the following methods:



Method 1:

                If there is an impedance in series with the voltage source, use a source transformation to convert it into an equivalent current source.
              



Method 2:

                Select the reference node so that one terminal of one or more of the voltage sources is connected to ground. The source voltage then determines the node voltage at the other source terminal, thereby eliminating an unknown.
              


Method 3:

                Create a supernode surrounding any voltage source that cannot be handled by method 1 or 2.
              

Some circuits may require more than one of these methods.

              Formulating a set of equilibrium equations in the
              s
              domain is a straightforward process involving concepts developed in
              Chapters 3
              and
              4
              for resistance circuits. The following example illustrates the formulation process.
            












EXAMPLE 10-13



                      Formulate
                      s
                      -domain node-voltage equations for the circuit in
                      Figure 10-32
                      (a).
                    









FIGURE 10-32








SOLUTION:



Figure 10-32
                  (b) shows the circuit in the
                  s
                  domain. In transforming the circuit, we use current sources to represent the inductor and capacitor initial conditions. This choice facilitates writing node equations since the resulting
                  s
                  -domain circuit contains only current sources and fewer nodes. The sum of currents leaving nodes A and B can be written as
                



Rearranging these equations in the standard format with the unknowns on the left and the inputs on the right yields




                  Note that (1/
                  R
                  + 1/
                  Ls
                  ) is the sum of the admittances connected to node A, (1/
                  Ls
                  +
                  Cs
                  ) is the sum of the admittances connected to node B, and 1/
                  Ls
                  is the admittance connected between nodes A and B. The circuit is driven by an independent current source
                  I
S
                  (
                  s
                  ) and two initial condition sources
                  Cυ
C
                  (0) and
                  i
L
                  (0)/
                  s
                  . The terms
                  
                  on the right side of these equations are the sum of source currents directed into each node. With practice, we learn to write these equations by inspection.
                  ■






              Solving
              s
              -Domain Circuit Equations
            

Example 10-13
              shows that node-voltage equations are linear algebraic equations in the unknown node voltages. In theory, solving these equations can be accomplished using classical techniques such as Cramer's rule or Gaussian reduction. In practice, we quickly lose interest save for a 2 × 2 or, perhaps for the stout of heart, a 3 × 3 linear set of equations, since coefficients in the equations are polynomials, making the algebra rather tedious. With today's software, it is becoming increasingly practical to use programs such as MATLAB to solve these linear equations using their symbolic analysis toolboxes. In
              Example 10-14
              , we will solve using the classical Cramer's rule a simple 2 × 2 set of equations formulated in
              Example 10-13
              . Subsequently, we will solve a 3 × 3 set of equations using MATLAB in
              Appendix D
              to contrast the difference and to highlight some important features of the classical solution that may be somewhat obscured in the software approach.
            












EXAMPLE 10-14



                      For the transformed circuit of
                      Figure 10-32
                      (b), do the following:
                    


                        (a) Solve the node-voltage equations from
                        Example 10-13
                        and identify the zerostate and zero-input responses.
                      

                        (b) Solve for the zero-state components of the waveforms
                        υ
A
                        (
                        t
                        ) and
                        υ
B
                        (
                        t
                        ) when
                        R
                        = 1 kΩ,
                        C
                        = 0.2 μF,
                        L
                        = 500 mH, and
                        i
S
                        (
                        t
                        ) = 10
                        u
                        (
                        t
                        ) mA.
                      





SOLUTION:





                      (a) In
                      Example 10-13
                      , we formulated the following node-voltage equations for the transformed circuit of
                      Figure 10-32
                      :
                    



Using Cramer's rule, it is convenient to find the determinant of these equations:




                      We call Δ(
                      s
                      ) the
                      circuit determinant
                      because it depends only on the elements
                      R
                      ,
                      L
                      , and
                      C
                      . The determinant Δ(
                      s
                      ) characterizes the circuit and does not depend on either the input or the initial conditions. Note also that since the circuit contained no dependent sources, the determinant is symmetrical about the major diagonal. Continuing our solution, the node-voltage
                      V
A
                      (
                      s
                      ) is found using Cramer's rule:
                    





                      Similarly solving for
                      V
B
                      (
                      s
                      ),
                    




                      This solution readily provides both the zero-input and zero-state components of the response transforms
                      V
A
                      (
                      s
                      ) and
                      V
B
                      (
                      s
                      ).
                    


Discussion:

Cramer's rule results in a solution of the node voltages as a ratio of determinants ofthe form





The response transform
V
X
                      (
                      s
                      )
                      is a rational function of s whose poles are either zeros of the circuit determinant
                      Δ(
                      s
                      )
                      or poles of the determinant
                      Δ
                      X
                      (
                      s
                      ).
                      This means that
V
X
                      (
                      s
                      )
                      has poles when
                      Δ(
                      s
                      ) = 0 or when Δ
                      X
                      (
                      s
                      ) → ∞.
                      The partial-fraction expansion of
V
x
                      (
                      s
                      )
                      will contain terms for each of these poles. We call the zeros of
                      Δ(
                      s
                      )
                      the

natural poles

because they depend only on the circuit and give rise to the natural response terms in the expansion. We call the poles of
                      Δ
                      X
                      (
                      s
                      )
                      the

forced poles


                        because they depend on the form of the input signal and give rise to the forced response terms in the expansion. We will revisit these ideas in our discussion ofcircuit stability in
                        Sect. 10-6

                      .
                    



                      (b) Since the problem is to find the zero-state components of
                      υ
A
                      (
                      t
                      ) and
                      υ
B
                      (
                      t
                      ) ,we start by substituting the component and source values into our equations for
                      V
A
                      (
                      s
                      ) and
                      V
B
                      (
                      s
                      ) found in part (a). We use only the zero-state portions of the transforms since all initial conditions are set to zero—that is,
                      i
L
                      (0) = 0 A and
                      υ
C
                      (0) = 0 V—which is by definition the circuit's zero state.
                    





                      Both response transforms have three poles: a forced pole at
                      s
                      = 0 and two natural poles at
                      s
                      = −1000 ±
                      j
                      3000. The forced pole comes from the step function input, and the two natural poles are zeros of the circuit determinant. Expanding these rational functions as
                    



and taking the inverse transforms yields the required zero-state response waveforms:




                      The step function in both responses is the forced response caused by the forced pole at
                      s
                      = 0. The damped sinusoids are natural responses determined by the natural poles.
                    

Figure 10-32
                      (c) shows part of an Excel spreadsheet that produces plots of
                      υ
Azs
                      (
                      t
                      ) and
                      υ
Bzs
                      (
                      t
                      ). Spreadsheets are useful for generating graphs, especially
                      
                      when we wish to compare waveforms. The two plots show that the two response waveforms are different even though they have the same poles. In other words, the basic form of a response is determined by the forced and natural poles, but the relative amplitudes (and phases) are influenced by the zeros as well.
                    









FIGURE 10-32







■











Exercise 10-17


                  For the circuit of
                  Figure 10-32
                  (a), find the zero-state current transforms through each passive element.
                


Answers:















Exercise 10-18


                  Using the nodes identified, write a set of node-voltage equations for the circuit of
                  Figure 10-33
                  .
                







FIGURE 10-33








Answers:









Locating Complex Poles on the s-plane

              In
              s
              -domain circuit analysis and design, the location of complex poles is often specified in terms of the undamped natural frequency (ω
              0
              ) and damping ratio (ζ) parameters introduced in our study of second-order circuits in
              Chapter 7
              . Using these parameters, the standard form of a second-order factor is
              
              , which locates the poles at
            




              The quantity under the radical depends only on the damping ratio ζ. When ζ > 1 the quantity is positive and the two poles are real and distinct, and the second-order factor becomes the product of two first-order terms. If ζ = 1 the quantity under the radical vanishes and there is a double pole as
              s
              = −ω
              0
              . If ζ < 1 the quantity under the radical is negative and the two roots are complex conjugates.
            

              The location of complex poles is also defined in terms of the two natural frequency parameters α and β. Using these parameters, the poles are at
              s
1,2
              = −α±/
              j
              β, and the standard form of a second-order factor is (
              s
              + α)
              2
              + β
              2
              .
            

              In
              s
              -domain circuit design, we often need to convert from one set of parameters to the other. First, equating their standard forms
            




              and then equating the coefficients of like powers of
              s
              yields
            



(10-29)




and conversely



(10-30)






              Using Eqs. (
              10-29
              and
              10-30
              ),
              Figure 10-34
              shows how these parameters define the locations of complex poles in the
              s
              plane. The natural frequency parameters α and β define the rectangular coordinates of the poles. In a sense, the parameters ω
              0
              and ζ define the corresponding polar coordinates. The parameter ω
              0
              is the radial distance from the origin to the poles. The angle θ is determined by the damping ratio ζ alone, since θ = cos
              -1
              ζ.
            







FIGURE 10-34



s-plane geometry relating
                  α
                  and
                  β
                  to
                  ζ
                  and
                  ω
                  0




              Let us look briefly at how the locations of two complex poles and the resulting circuit response change relative to the damping ratio ζ. At θ = 45°, as shown in
              Figure 10-34
              , ζ = 0.707 and the circuit with these poles is underdamped (Case C) resulting in a damped sinusoidal response. If we lessen the angle, that is, move the poles closer toward the real axis, ζ increases, α increases, and β, the damped natural frequency, decreases, which means the oscillations in the response are longer. At θ = 0°, ζ = 1 and the two poles merge on the real axis causing β to equal zero. This results in two identical poles located at α (Case B) yielding a damped ramp response. If we go back and increase θ from 45°, −α moves toward the origin and the attenuation of the damped sinusoid takes longer to decay, while β increases in frequency. If we could make θ = 90°, α would equal zero, which represents a step function with no attenuation, and β would reach its maximum frequency of ω
              0
              and oscillate forever. Of course, passive circuits always have some inherent resistance, so θ could never reach 90°. We will see in later chapters that we can use active circuits to overcome this limitation.
            






Exercise 10-19


                  A signal has two poles located at
                  s
1,2
                  = −250 ±
                  j
                  433. Plot the poles on a pole-zero diagram and geometrically find α, β, ζ, and ω
                  0
                  .
                


Answers:



                  See
                  Figure 10-35
                  .
                







FIGURE 10-35






















DESIGN EXAMPLE 10-15


                      The
                      s
                      -domain circuit in
                      Figure 10-36
                      is to be designed to produce a pair of complex poles defined by ζ = 0.5 and ω
                      0
                      = 1000 rad/s. To simplify production the design will use equal element values
                      R
1
                      =
                      R
2
                      =
                      R
                      and
                      C
1
                      =
                      C
2
                      =
                      C.
                      Select the values of
                      R, C,
                      and the gain μ so that the circuit has the desired natural poles.
                    









FIGURE 10-36








SOLUTION:



                  To locate the natural poles, we find the circuit determinant using node-voltage equations. The circuit has four nodes but only two ofthese involve independent variables. For the indicated reference node, the voltages at nodes A and D are
                  V
A
                  (
                  s
                  ) =
                  V
S
                  (
                  s
                  ) and
                  V
D
                  (
                  s
                  ) = μ
                  V
C
                  (
                  s
                  ) = μ
                  V
C
                  (
                  s
                  ). That is, the two grounded voltage sources specify the voltages at nodes A and D. Consequently, we only need equations at nodes B and C. The sums of currents leaving these nodes are
                



Arranging these equations with unknown node voltages on the left and the source terms on the right yields





                  The natural poles are zeros of the circuit determinant:
                




                  For equal resistances
                  R
1
                  =
                  R
2
                  =
                  R
                  and equal capacitances
                  C
1
                  =
                  C
2
                  =
                  C,
                  the circuit determinant reduces to
                




                  Comparing this second-order factor to the standard form
                  
                  yields the following design constraints:
                




                  These constraints lead to the conditions
                  RC
                  = 10
                  −3
                  and μ = 2. Selecting
                  R
                  = 10 kΩ makes
                  C
                  = 0.1 μF. For the specified conditions the natural poles are located at
                  s
                  = − α±
                  j
                  β, where
                




■












                  Design
                  Exercise 10-20


                  Consider the circuit in
                  Figure 10-36
                  . Select values for the various components to produce a pair of complex poles defined by ζ = 0.5 and ω
                  0
                  = 1 krad/s. To produce your design you must assume unity gain (μ = 1) for the dependent source and that
                  R
1
                  =
                  R
2
                  =
                  R
                  .
                


Answers:


With the given assumptions,




                  If we select
                  R
                  = 10 kΩ, then
                  C
1
                  = 0.2 μF and
                  C
2
                  = 0.05 μF. Other correct answers are possible.
                
















DESIGN EXAMPLE 10-16



                        (a) For the
                        s
                        -domain circuit in
                        Figure 10-37
                        , solve for the zero-state output
                        V
O
                        (
                        s
                        ) in terms of a general input
                        V
S
                        (
                        s
                        ).
                      

                        (b) Solve for the zero-state output
                        υ
O
                        (
                        t
                        ) when the input is a unit step function
                        υ
S
                        (
                        t
                        ) =
                        u
                        (
                        t
                        ) V.
                      

                        (c) Select values of
                        R
1
                        ,
                        R
2
                        , and
                        C
                        to produce a maximum gain of −100 and a pole at
                        s
                        = −100 krad/s.
                      










FIGURE 10-37








SOLUTION:





                      (a) We use the node-voltage method to find the OP AMP output. A node equation is not required at node A since the selected reference node makes
                      V
A
                      (
                      s
                      ) =
                      V
S
                      (
                      s
                      ). Likewise, one is not needed at node D since it is the OP AMP output. Finally, we can avoid writing a node equation at node B by observing that the element impedances
                      R
1
                      and 1/
                      Cs
                      are connected in series. We can treat this series
                      
                      combination as a single element with an equivalent impedance
                      R
1
                      + 1/
                      Cs
                      . Using all of these observations, the sum of the currents leaving Node C is
                    




                      In the
                      s
                      domain the ideal OP AMP model in
                      Eq. (10-4)
                      requires
                      I
N
                      (
                      s
                      ) = 0 and
                      V
P
                      (
                      s
                      ) =
                      V
N
                      (
                      s
                      ). But
                      V
P
                      (
                      s
                      ) = 0 since the noninverting input is grounded; hence,
                      V
N
                      (
                      s
                      ) =
                      V
C
                      (
                      s
                      ) = 0. Inserting these conditions in the node C equation and solving for the output voltage yields
                    




                      This equation relates the zero-state output to a general input
                      V
S
                      (
                      s
                      ). The output transform is proportional to the input transform since the circuit is linear. The proportionality factor within the brackets is called a
                      network function.
                      In this case, the network function has a natural pole at
                      s
                      = −1/
                      R
1
C
                      and a zero at
                      s
                      = 0.
                    



                      (b) A step function input
                      V
S
                      (
                      s
                      ) = 1/
                      s
                      produces a forced pole at
                      s
                      = 0. However, the zero in the network function cancels the forced pole so that
                    




                      For a step function input the zero-state output has no forced pole, only a natural pole at
                      s
                      = −1/
                      R
1
C.
                      The general principle is that the forced response can be zero even when the input is not zero. In the
                      s
                      domain, this occurs when the network function relating output to input has zeros at the same location as forced poles.
                    



                      (c) The product 1/
                      R
1
C
                      controls the location of the pole and −
                      R
2
                      /
                      R
1
                      controls the gain. Selecting the pole first, we have 1/
                      R
1
C
                      = 100 krad/s. Choosing
                      R
1
                      = 1 kΩ results in
                      C
                      = .01 μF. For the gain, we need −
                      R
2
                      /
                      R
1
                      = −100 With
                      R
1
                      = 1 kΩ, we get
                      R
2
                      = 100 kΩ.
                      ■














Design Exercise 10-21




                    (a) For the
                    s
                    -domain circuit in
                    Figure 10-38
                    , solve for the zero-state output
                    V
O
                    (
                    s
                    ) in terms of a general input
                    V
S
                    (
                    s
                    ).
                    






FIGURE 10-38








                    (b) Solve for the zero-state output when the input is a step function
                    υ
S
                    (
                    t
                    ) =
                    V
A
u
                    (
                    t
                    ) V.
                  

                    (c) Select values of
                    R
1
                    ,
                    R
2
                    , and
                    C
                    to produce a maximum gain of -100 and a pole at
                    s
                    = -10 krad/s.
                  



Answers:




                    (a)
                    


                    (b)
                    


                    (c) Let
                    R
2
                    = 100 kΩ,
                    C
                    = 0.001 μF, and
                    R
1
                    = 1 kΩ. other answers are possible.
                  











Exercise 10-22


                  Formulate node-voltage equations for the bridge-T circuit in
                  Figure 10-39
                  and find the circuit determinant. Assume that the initial conditions are zero.
                







FIGURE 10-39









Answers:


The node equations are



The circuit determinant is









            10-5 Mesh-Current Analysis in the
            s
            Domain
          
We can use the mesh-current method only when the circuit can be drawn on a flat surface without crossovers. Such planar circuits have special loops called meshes that are defined as closed paths that do not enclose any elements. The mesh-current variables are the loop currents assigned to each mesh in a planar circuit. Because of KCL the current through any two-terminal element can be expressed as the difference of two adjacent mesh currents. This fundamental property of mesh currents, together with the elementimpedances, allows us to write KVLconstraintsaround eachofthe meshes.

            For example, in
            Figure 10-40
            , the sum of voltages around mesh A can be written as
          



Rewriting this equation with unknown mesh currents grouped on the left and inputs on the right yields




            This equation displays the following pattern. The unknowns are the mesh-current transforms
            I
A
            (
            s
            ),
            I
B
            (
            s
            ), and
            I
C
            (
            s
            ). The coefficient [
            Z
1
            (
            s
            ) +
            Z
2
            (
            s
            ) +
            Z
3
            (
            s
            )] of
            I
A
            (
            s
            ) is the sum of the impedances of the elements in mesh A. The coefficients [
            Z
2
            (
            s
            )] of
            I
B
            (
            s
            ) and [
            Z
3
            (
            s
            )] of
            I
C
            (
            s
            ) are the impedances common to mesh A and the other meshes. Finally,
            V
S1
            (
            s
            ) −
            V
S2
            (
            s
            ) is the sum of the source voltages around mesh A. These observations suggest that we can write mesh-current equations for
            s
            -domain circuits by inspection, just as we did with resistive circuits.
          







FIGURE 10-40



An example mesh.



The formulation approach just outlined assumes that there are no current sources in the circuit. When writing mesh-current equations, we select the voltage source model to represent the initial conditions. If the circuit contains dependent or independent current sources, they can be treated using the following methods:



Method 1:

              If there is an admittance in parallel with the current source, use a source transformation to convert it into an equivalent voltage source.
            


Method 2:

              Draw the circuit diagram so that only one mesh current circulates through the current source. This mesh current is then determined by the source current.
            


Method 3:

              Create a supermesh for any current source that cannot be handled by method 1 or 2.
            

Some circuits may require more than one of these methods.

            The following examples illustrate the mesh-current method of
            s
            -domain circuit analysis.
          













EXAMPLE 10-17




                      (a) Formulate mesh-current equations for the circuit in
                      Figure 10-41
                      (a).
                    

                      (b) Solve for the zero-input component of
                      I
A
                      (
                      s
                      ) and
                      I
B
                      (
                      s
                      ).
                    

                      (c) Find the zero-input responses
                      i
A
                      (
                      t
                      ) and
                      i
B
                      (
                      t
                      ) for
                      R
1
                      = 100Ω,
                      R
2
                      = 200Ω,
                      L
1
                      = 50 mH, and
                      L
2
                      = 100 mH.
                    










FIGURE 10-41








SOLUTION:





                    (a)
                    Figure 10-41
                    (b) shows the circuit transformed into the
                    s
                    domain. In transforming the circuit, we used the voltage source model for the initial conditions. The net result is that the transformed circuit contains only voltage sources. The sum of voltages around meshes A and B can be written as
                  



Rearranging these equations in standard form yields




                    These
                    s
                    -domain circuit equations are two linear algebraic equations in the two unknown mesh currents
                    I
A
                    (
                    s
                    ) and
                    I
B
                    (
                    s
                    ).
                  


(b) To solve for the mesh equations, we first find the circuit determinant:




                    To find the zero-input component of
                    I
A
                    (
                    s
                    ), we let
                    V
S
                    (
                    s
                    ) = 0 and use Cramer'srule:
                  





                    Similarly, the zero-input component in
                    I
B
                    (
                    s
                    ) is
                  





(c) To find the time-domain response, we insert the numerical parameters into the preceding expressions to obtain




                    The circuit has natural poles at
                    s
                    = −1000 and − 4000 rad/s. Expanding by partial fractions yields
                  



The inverse transforms of these expansions are the required zero-input response waveforms:




                    Notice that if the initial conditions are
                    i
L1
                    (0) = −
                    i
L2
                    (0), then both
                    I
A
                    (
                    s
                    ) and
                    I
B
                    (
                    s
                    ) have a zero at
                    s
                    = −1000. This zero effectively cancels the natural pole at
                    s
                    = −1000. As a result, this pole has zero residue in both partial fraction expansions, and the corresponding terms disappear from the time-domain responses. Likewise, if the initial conditions are
                    i
L1
                    (0) =
                    i
L2
                    (0), then both
                    I
A
                    (
                    s
                    ) and
                    I
B
                    (
                    s
                    ) have a zero at
                    s
                    = −4000, and the natural pole at
                    s
                    = −4000 disappears in the
                    s
                    -domain responses. The general principle is that all of the circuit's natural poles may not be present in a given response. When this happens the response transform has a zero at the same location as a natural pole, and we say that the natural pole is not observable in the specified response.
                    ■












Exercise 10-23


                Solve for the zero-state components of
                I
A
                (
                s
                ) and
                I
B
                (
                s
                ) in
                Figure 10-41
                (b).
              


Answers:























EXAMPLE 10-18




                      (a) Formulate mesh-current equations for the circuit in
                      Figure 10-42
                      (a).
                    

                      (b) Solve for the zero-input component of
                      i
A
                      (
                      t
                      ) for
                      i
L
                      (0) = 0,
                      υ
C
                      (0) = 10V,
                      L
                      = 250 mH,
                      C
                      = 1 μF, and
                      R
                      = 1 kΩ.
                    

                      (c) Use Multisim to simulate the circuit in
                      Figure 10-42
                      (b) and then validate your results by running a MATLAB calculation of the result. Compare the two plots.
                    










FIGURE 10-42








SOLUTION:





                    (a)
                    Figure 10-42
                    (a) is the
                    s
                    -domain circuit used in
                    Example 10-13
                    to develop node equations. In this circuit, each current source is connected in parallel with an impedance. Source transformations convert these current sources into the equivalent voltage sources shown in
                    Figure 10-42
                    (b). The circuit in
                    Figure 10-42
                    (b) is a series
                    RLC
                    circuit of the type treated in
                    Chapter 7
                    . By inspection, the KVL equation for the single mesh in this circuit is
                  




                    The circuit determinant is the factor
                    R
                    +
                    Ls
                    + 1/
                    Cs
                    = (
                    LCs
2
                    +
                    RCs
                    + 1)/
                    Cs
                    . The zeros of the circuit determinant are roots of the quadratic equation
                    LCs
2
                    +
                    RCs
                    + 1 = 0, which we recognize as the characteristic equation of a series
                    RLC
                    circuit. In our study of
                    RLC
                    circuits, we called these roots natural frequencies. Thus, the natural poles of the circuit are its natural frequencies.
                  


(b) Solving the mesh equation for the zero-input component yields



Inserting the given numerical values produces




                    The zero-state response has two natural poles, both located at
                    s
                    = −2000. The inverse transform of
                    I
Azi
                    (
                    s
                    ) is a damped ramp waveform:
                  




                    The damped ramp response indicates a critically damped second-order circuit. The minus sign means the direction of the actual current is opposite to the reference mark assigned to
                    I
A
                    (
                    s
                    ) in
                    Figure 10-42
                    . This sign makes sense physically
                    
                    since the capacitor initial condition source in
                    Figure 10-42
                    (b) tends to drive current in a direction opposite to the assigned reference mark.
                  







FIGURE 10-42









                    (c) A transient simulation was conducted using Multisim. A series
                    RLC
                    circuit was built with the initial condition of the capacitor set at + 10 V and that of the inductor to 0 A. There was no input since the requirement was for the zero-input response. A transient analysis of the circuit current was plotted versus time for 5 ms. The resulting plot is shown in
                    Figure 10-42
                    (c).
                  
Then MATLAB was asked to plot the result of part (b). The following MATLAB code was used

                    t = 0:2e-6:5e-3;
 iR=-40*t.*exp(-2000*t);
 plot(t,iR,''b','LineWidth',4)
 grid on
 xlabek('Time (s)')
 ylabel('Current (A)')
                  

                    The MATLAB plot is also shown in
                    Figure 10-42
                    (c). Comparing the results shows no measureable differences between the two computer plots.
                    ■













Exercise 10-24


                For the circuit in
                Figure 10-42
                (b), let
                I
S
                (
                s
                ) = 0.01/(
                s
                + 500) A-s,
                L
                = 250 mH,
                C
                = 1μF, and
                R
                = 1 kΩ. Use partial fraction expansion or MATLAB to solve for the zero-state component of
                i
A
                (
                t
                ).
              


Answers:



                iAZSt =
(2*exp(-2000*t))/225-(2*exp(-500*t))/225+(160*t*exp(-2000*t))/3
              



















EXAMPLE 10-19



                    Formulate mesh current equations for the circuit in
                    Figure 10-43
                    and solve for
                    I
B
                    (
                    s
                    ) in symbolic from. Locate the natural poles of the circuit for
                    R
                    = 1 kΩ,
                    C
                    = 4μF, and
                    L
                    = 1 H.
                  









FIGURE 10-43









SOLUTION:


By inspection the two mesh-current equations are



The circuit determinant is



and the required mesh current is




                The natural poles are roots of the denominator of
                I
B
                (
                s
                ), namely
              




                For
                R
                = 1 kΩ,
                C
                = 4 μF, and
                L
                = 1 H, this expression factors as
              




                so the natural poles are located at
                s
                = −1000 rad/s and
                s
                = −500 ±
                j
                500 rad/s.
                ■










Exercise 10-25



                  (a) Formulate mesh-current equations for the circuit in
                  Figure 10-44
                  . Assume that the initial conditions are zero.
                  






FIGURE 10-44







(b) Find the circuit determinant.

                  (c) Solve for the zero-state component of
                  I
B
                  (
                  s
                  ).
                



Answers:




                  (a)
                  


                  (b)
                  


                  (c)
                  











Exercise 10-26


                Formulate mesh-current equations for the circuit in
                Figure 10-44
                when a resistor
                R
3
                is connected between nodes A and B. Assume that the initial conditions are zero.
              



Answers:










            10-6 Summary of
            s
            - Domain Circuit Analysis
          

            At this point, we review our progress and put
            s
            -domain circuit analysis into perspective. We have shown that linear circuits can be transformed from the time domain into the
            s
            domain. In the
            s
            domain, KCL and KVL apply to transforms and the passive element
            i-υ
            characteristics become impedances with series or parallel initial condition sources. In relatively simple circuits, we can use basic analysis methods, such as reduction, superposition, Thévenin and Norton equivalent circuits, and voltage/ current division. For more complicated circuits we use systematic procedures, such as the node-voltage or mesh-current methods, to solve for the circuit response.
          

            In theory, we can perform
            s
            -domain analysis on circuits of any complexity. In practice, the algebraic burden of hand computations gets out of hand for circuits with more than three nodes or meshes. Of what practical use is an analysis method that becomes impractical at such a modest level of circuit complexity? Why not just appeal to computer-aided analysis tools in the first place?
          

            Unquestionably, large-scale circuits are best handled by computer-aided analysis. Computer-aided analysis is probably the right approach even for small-scale circuits when numerical values for all circuit parameters are known and the desired end product is a plot or numerical listing of the response waveform. Simply put,
            s
            -domain circuit analysis is not a particularly efficient algorithm for generating numerical response data.
          

            The purpose of
            s
            -domain circuit analysis is to gain insight into circuit behavior, not to grind out particular response waveforms. In this regard,
            s
            -domain circuit analysis complements programs such as MATLAB and Multisim. It offers a way of characterizing circuits in very general terms. It provides guidelines that allow us to use computer-aided analysis tools intelligently. Some of the useful general principles derived in this chapter are summarized below.
          

            The response transform
            Y
            (
            s
            )
            
2

            is a rational function whose partial-fraction expansion leads directly to a response waveform of the form
          




            where
            k

j

            is the residue of the pole in
            Y
            (
            s
            ) located at
            s
            = −
            
              p
              j

            . The location of the poles tells us a great deal about the form of the response. The pair of conjugate complex poles in
            Example 10-14
            produced a damped sine waveform, the two distinct real poles in
            Example 10-17
            produced exponential waveforms, and the double pole in
            Example 10-18
            led to a damped ramp waveform. The general principle illustrated is as follows:
          




The poles of Y(s) are either real or complex conjugates. Simple real poles lead to exponentials, double real poles lead to a damped ramp, and complex conjugate poles lead to damped sinusoids.





            As the discussion in
            Example 10-14
            noted, the poles in
            Y
            (
            s
            ) are introduced either by the circuit itself (natural poles) or by the input driving force (forced poles).
          





The natural poles are zeros of the circuit determinant and lead to the natural response. Theforcedpoles are poles of the input X(s) and lead to theforced response.





            Stability is a key concept in circuit analysis and design. For our present purposes, we say that a linear circuit is stable if its natural response decays to zero as
            t
            → ∞.
            Figure 10-45
            shows the waveforms of the natural modes corresponding to different pole locations in the
            s
            plane. Poles in the left half plane give rise to waveforms that decay to zero as time increases, while those in the right half plane increase without bound. As a result, we can say that
          




A circuit is stable if all of its natural poles are located in the left half of the s plane.











FIGURE 10-45



Form of the natural response corresponding to different pole locations.




            Stability requires
            all
            of the natural poles to be in the left half plane (LHP). The circuit is
            unstable
            if even one natural pole falls in the right half plane (RHP).
          

            In
            Figure 10-45
            , the
            j
            ω-axis is the boundary between the LHP (stable circuits) and RHP (unstable circuits). Poles exactly on this boundary require further discussion. As
            Figure 10-45
            shows,
            simple
j
            -axis poles at
            s
            = 0 and
            s
            = ±
            j
            β lead to natural modes like
            u
            (
            t
            ) and cos(βt) that neither decay to zero nor increase without bound. The figure also shows that
            double
            poles on the
            j
            -axis lead to natural modes like
            tu
            (
            t
            ) and
            t
            cos(β
            t
            ) that increase without bound. Circuits with
            simple
            poles on the
            j
            -axis are sometimes said to be
            marginally stable
            ,
            
3

            while those with
            multiple
            poles on the
            j
            -axis are clearly
            unstable.


            Circuit stability is determined by natural poles, not forced poles. For example, suppose an input
            x
            (
            t
            ) =
            e

              10
              t

            produces an output transform
          





            This transform has a left half plane (LHP) pole and a right half plane (RHP) pole. The corresponding waveform
          




            has an unbounded term due to the RHP pole. Even with an unbounded response the circuit is still said to be stable because the natural pole at
            s
            = −2 is in the LHP and leads to a natural response that decays to zero. The unbounded part of the response waveform comes from the forced RHP pole caused by the unbounded input.
          

            Since the natural response plays a key role, we would like to predict the number of natural poles by simply examining the circuit.
            Figure 10-46
            summarizes examples from this chapter and leads to the following observations. Circuits with only one energy storage element (inductor or capacitor) have only one pole, circuits with two independent elements have two poles, and
            Example 10-19
            has three poles to go with its three energy storage elements. The conclusion appears to be that the number of natural poles is equal to the number of energy storage elements. While this rule
            
            is a useful guideline, there are exceptions (capacitors in parallel, for example). The best we can say is that
          







FIGURE 10-46




                  Summary of
                  Chapter 10
                  examples.
                







The number of natural poles does not exceed the number of energy storage elements.





            Another implication in
            Figure 10-46
            comes from two additional observations. First, all of the natural poles are in the LHP; hence, all of the circuits are stable. Second, all of the circuits contain only passive resistors, capacitors, and/or inductors; that is, there are no active elements. These observations imply that
          




Circuits consisting of passive resistors, capacitors, and inductors are inherently stable.




This conclusion makes sense physically since the passive elements can only store or dissipate energy. They cannot produce the energy needed to sustain an unbounded response.

            What about circuits with active elements like dependent sources or OP AMPs? Such circuits can be unstable, as we can see by reviewing
            Example 10-15
            . In thatexample, we analyzed the active
            RC
            circuit in
            Figure 10-36
            and found the circuit determinant to be
          



and the two natural poles are defined by



where μ is the gain of the dependent source, the active element in the circuit. For μ = 0 (active element turned off), the damping ratio is ζ = 15 > 1 and the circuit is overdamped. For μ = 1, the damping ratio is ζ = 1 and the circuit is critically damped. For 3 > μ > 1, the damping ratio is 1 > ζ > 0 and the circuit is underdamped. For μ = 3, the damping ratio is ζ = 0 and the circuit is undamped and therefore oscillates. Finally, for μ > 3, the damping ratio is ζ < 0 and the circuit is said to have negative damping, which is an unstable condition.

Figure 10-47
            shows the loci of the natural poles as the gain increases. For μ > 3, the poles move into the RHP and the circuit becomes unstable. This makes sense physically. When the gain is high enough, the active element can produce the energy needed to sustain an unbounded output. Since instability is almost always undesirable, we usually state the conclusion the other way around. That is, this active
            RC
            circuit is stable provided the gain μ < 3. It is common for active circuits to be stable when circuit parameters are in one range and unstable when they are outside this range. For double-pole circuits the stable range can be found by relating the damping ratio to circuit parameters. For single-pole circuits, the stable range ensures that the pole lies on the negative real axis.
          







FIGURE 10-47




                  Pole loci on a circle of radius ω
                  0
                  .
                









Exercise 10-27

The circuit determinants of three circuits to be studied in subsequent chapters are given below. Determine the nature of the poles of each circuit and what conditions, if any, could cause the circuit to become unstable.


                  (a)
                  R
2
C
2
s
2
                  + 2
                  RCs
                  + 1
                

                  (b)
                  R
2
C
2
s
2
                  +
                  RCs
                  + 1
                

                  (c)
                  R
2
C
2
s
2
                  + (3 − μ)
                  RCs
                  + 1
                



Answers:


(a) Poles are real, negative, and equal; circuit is always stable.
(b) Poles are complex with negative real parts; circuit is always stable.
(c) Poles can vary depending on μ. If μ < 1, the poles are real, distinct, and both negative, so the circuit is always stable. If μ = 1, the poles are real, negative, and equal, so the circuit is always stable. If 1 < μ < 3, the poles are complex with negative real parts, so the circuit is always stable. If μ = 3, the poles are pure imaginary and the circuit is marginally stable. If μ > 3, the poles have positive real parts and the circuit is unstable.





Summary


              Kirchhoff's laws apply to voltage and current waveforms in the time domain and to the corresponding transforms in the
              s
              domain.
            

              The
              s
              -domain models for the passive elements include initial condition sources and the element impedance or admittance.
              Impedance
              is the proportionality factor in the expression
              V
              (
              s
              ) =
              Z
              (
              s
              )
              I
              (
              s
              ) relating the voltage and current transforms.
              Admittance
Y
              (
              s
              ) is the reciprocal of impedance.
            

              The impedances of the three passive elements are
              Z
R
              (
              s
              ) =
              R,Z
L
              (
              s
              ) =
              Ls
              , and
              Z
C
              (
              s
              ) = 1/
              Cs
              .
            

              The
              s
              -domain circuit analysis techniques closely parallel the analysis methods developed for resistance circuits. Basic analysis techniques, such as circuit reduction, Thévenin's and Norton's theorems, the unit output method, or superposition, can be used in simple circuits. More complicated networks require a general approach, such as the node-voltage or mesh-current methods.
            

Response transforms are rational functions
              whose poles are zeros of the circuit determinant or poles of the transform of the input driving forces. Poles introduced by the circuit determinant are called
              natural poles
              and lead to the natural response. Poles introduced by the input are called
              forced poles
              and lead to the forced response.
            

              In linear circuits, response transforms and waveforms can be separated into zero-state and zero-input components. The
              zero-state
              component is found by setting the initial capacitor voltages and inductor currents to zero. The
              zero-input
              component is found by setting all input driving forces to zero.
            

              The main purpose of
              s
              -domain circuit analysis is to gain insight into circuit performance without necessarily finding the time-domain response. The natural poles reveal the form, stability, and observability of the circuit's response. The number of natural poles is never greater than the number of energy storage elements in the circuit.
            

              A circuit is
              stable
              if all of its natural poles are in the left half of the
              s
              plane. Passive circuits are inherently stable so their natural poles are all in the left half plane. Poles in the right hand plane are inherently
              unstable
              . Active circuits can be stable when circuit parameters are in one range and unstable for parameters outside this range. A pole at the origin, or pole pairs on the imaginary axis, are considered
              marginally stable
              .
            





            Chapter 10 Problems
          






                Objective 10-1 Equivalent Impedance (
                Sects. 10-1
                and
                10-2
                )
              

                Given a linear circuit, use series and parallel equivalences to find the equivalent impedance at specified terminal pairs. Select element values to obtain specified pole locations. See
                Examples 10-4
                to
                10-6
                and
                Exercises 10-l
                to
                10-8
                .
              





10-1

              For a series
              RC
              circuit, find
              Z
EQ
              (
              s
              ) and then select
              R
              and
              C
              so that there is a pole at
              s
              = 0 and a zero at
              s
              = −10 krad/s.
            

10-2

              For the circuit of
              Figure P10-2
              :
              

(a)
                  Find and express
                  Z
EQ
                  (
                  s
                  ) as a rational function and locate its poles and zeros.
                

(b)
                  Select values of
                  R
                  and
                  C
                  to locate a pole at
                  s
                  = −56 krad/s. Where is the resulting zero?
                  






FIGURE P10-2











10-3

              For the circuit of
              Figure P10-3
              :
              

(a)
                  Find and express
                  Z
EQ
                  (
                  s
                  ) as a rational function and locate its poles and zeros.
                

(b)
                  Select values of
                  R
                  and
                  C
                  to locate a zero at
                  s
                  = −330 krad/s.
                  






FIGURE P10-3










10-4

              For the circuit in
              Figure P10-4
              :
              

(a)
                  Find and express
                  Z
EQ
                  (
                  s
                  ) as a rational function and locate its poles and zeros.
                

(b)
                  Select values of
                  R
                  and
                  C
                  to locate a zero at
                  s
                  = −3.0 krad/s.
                  






FIGURE P10-4











10-5

              Design a series
              RLC
              circuit so that the equivalent impedance
              Z
EQ
              (
              s
              ) has the pole-zero diagram shown in
              Figure P10-5
              . The inductor must be 1 H.
              






FIGURE P10-5








10-6

              Consider the circuits in
              Figure P10-6
              and answer the following questions.
              

(a)
                  What is the maximum number of poles possible for each of the circuits?
                

(b)
                  Can any of the circuits shown have an unstable pole? If so, which one?
                  






FIGURE P10-6











10-7

              For the circuit of
              Figure P10-7
              :
              

(a)
                  Find and express
                  Z
EQ
                  (
                  s
                  ) as a rational function and locate its poles and zeros.
                


(b)
                  Select values of
                  R
                  and
                  L
                  to locate a pole at −1.5 krad/s. Where are the resulting zeros?
                  






FIGURE P10-7










10-8

              The shaded part of the circuit in
              Figure P10-8
              is called a tank circuit. It is used in AM radios to tune to the intermediate frequency (IF) allowing the transmitted signal to be received. The IF is set at 455 kHz. The inductor is known to be 10 μH. The series resistor is 100 kΩ. Select
              C
              so that the tank circuit has poles at the IF. Determine the location of the zeros of
              Z
EQ
              .
              






FIGURE P10-8









              10-9 For the circuit of
              Figure P10-9
              :
              

(a)
                  If
                  R
                  = 560 Ω,
                  L
                  = 2 H, and
                  C
                  = 0.5 μF locate the poles and zeros of
                  Z
EQ
                  (
                  s
                  )?
                

(b)
                  If we were to increase the resistance to 10 kΩ, how would the poles and zeros change?
                  






FIGURE P10-9










10-10


(a)
                  Find
                  Z
EQ1
                  (
                  s
                  ) and
                  Z
EQ2
                  (
                  s
                  ) for the bridge-T circuit in
                  Figure P10-10
                  . Express each impedance as a rationalfunction and locate its poles and zeros.
                

(b)
                  Suppose the resistor labeled
                  R
                  becomes shorted. How would the two impedances change?
                

(c)
                  Suppose the resistor labeled 2
                  R
                  becomes shorted. How would the two impedances change?
                  






FIGURE P10-10











10-11

              For the two-port circuit of
              Figure P10-11
              :
              

(a)
                  Find
                  Z
EQ1
                  (
                  s
                  ) and
                  Z
EQ2
                  (
                  s
                  ), and express each impedance as a rational function and locate its poles and zeros.
                

(b)
                  Select values of
                  R
                  and
                  L
                  to place a pole at -1 kHz.
                  






FIGURE P10-11










10-12

              Find the equivalent impedance between terminals 1 and 2 in
              Figure P10-12
              . Select values of
              R
              and
              L
              so that
              Z
EQ
              (
              s
              ) has a pole at
              s
              = −33 krad/s. Locate the zeros of
              Z
EQ
              (
              s
              ) for your choice of
              R
              and
              L
              .
              






FIGURE P10-12









10-13

              A manufacturer offers the circuit shown in
              Figure P10-13
              . The specification sheet states that all of the pole-zero diagrams shown are obtainable by selecting the appropriate terminals and opening or closing the provided switch. Is the claim correct?
              






FIGURE P10-13















                Objective 10-2 Basic Circuit Analysis Techniques (
                Sects. 10-2
                and
                10-3
                )
              
Given a linear circuit,


                  (a) Determine the initial conditions (if not given) and transform the circuit into the
                  s
                  domain.
                
(b) Solve for zero-state and zero-input responses using circuit reduction, the unit output method, Thévenin or Norton equivalent circuits, or superposition.
(c) Identify the forced and natural poles in the responses or select circuit parameters to place the natural poles at specified locations.


                See
                Examples 10-1
                to
                10-5
                and
                10-7
                to
                10-12
                and
                Exercises 10-1
                to
                10-4
                and
                10-7
                to
                10-16
                .
              




10-14
              For the circuit of
              Figure P10-14
              :
              

(a)
                  Use voltage division to find
                  V
O
                  (
                  s
                  ).
                

(b)
                  Use the lookback method to find
                  Z
T
                  (
                  s
                  ).
                  






FIGURE P10-14











10-15

              Consider the circuit shown in
              Figure P10-15
              .
              

(a)
                  Find
                  V
T
                  (
                  s
                  ) and
                  Z
T
                  (
                  s
                  ).
                

(b)
                  Plot the poles and zeros of
                  Z
T
                  (
                  s
                  ).
                

(c)
                  Let
                  V
1
                  (
                  s
                  ) =
                  V
A
                  /
                  s
                  and plot the poles and zeros of
                  V
T
                  (
                  s
                  ).
                

(d)
                  Select values of
                  R
                  and
                  L
                  so that
                  V
T
                  (
                  s
                  ) has a pole at -50 krad/s. What are the poles and zeros of
                  Z
T
                  (
                  s
                  ) with your choice of
                  R
                  and
                  L
                  ?
                  






FIGURE P10-15










10-16

              Find the Norton equivalent for the circuit in
              Figure P10-16
              . Convert the Norton equivalent circuit to its Thévenin equivalent. Then select values for
              R
              and
              L
              so that the Thévenin voltage has a pole at −24 krad/s.
              






FIGURE P10-16









10-17
              The circuit in
              Figure P10-16
              has
              R
              = 10 kΩ and
              L
              = 5H. A load is connected across the output equal to
              Z
L
              (
              s
              ) =
              s
              + 500 Ω. Identify the natural poles and zeros of the load voltage.
            

10-18
              If the input to the
              RLC
              circuit of
              Figure P10-18
              is
              υ
S
              (
              t
              ) =
              u
              (
              t
              ):
              

(a)
                  Find the output voltage transform across each element.
                

(b)
                  Compare the three outputs with regard to their respective poles and zeros.
                

(c)
                  Use the initial- and final-value theorems to determine the value of the voltage across each element at
                  t
                  = 0 and
                  t
                  = ∞. What conclusions can one draw regarding the results?
                  






FIGURE P10-18












10-19
              If the input to the
              RLC
              circuit of
              Figure P10-18
              is
              υ
S
(i)
              =
              u
              (
              t
              ):
              

(a)
                  Find the output voltage transform
                  V
LC
                  (
                  s
                  ) across
                  L
                  and
                  C
                  taken together.
                

(b)
                  Use the initial- and final-value theorems to determine the value of the voltage across the combined elements at
                  t
                  = 0 and
                  t
                  = ∞. What conclusions can one draw regarding the results?
                



10-20
              The switch in
              Figure P10-20
              has been in position A for a long time and is moved to position B at
              t
              = 0. Transform the circuit into the s domain and solve for
              I
L
              (
              s
              ),
              i
L
              (
              t
              ),
              V
O
              (
              s
              ), and
              υ
O
              (
              t
              ) in symbolic form.
              






FIGURE P10-20









10-21

              Find the network function
              K
              =
              V
2
              (
              s
              )/
              V
1
              (
              s
              ) for the circuit shown in
              Figure P10-21
              . Then identify the poles and zeros of the network function. choose values of
              R
              and
              C
              so that the dominant pole is at -200 rad/s. Using your values, where is the other pole located?
              






FIGURE P10-21








10-22
              The switch in
              Figure P10-22
              has been in position A for a long time and is moved to position B at
              t
              = 0. Transform the circuit into the s domain and solve for
              I
C
              (
              s
              ),
              i
C
              (
              t
              ),
              V
O
              (
              s
              ), and
              υ
O
              (
              t
              ) in symbolic form.
              






FIGURE P10-22









10-23
              The switch in
              Figure P10-22
              has been in position B for a long time and is moved to position A at
              t
              = 0. Transform the circuit into the s domain and solve for
              V
C
              (
              s
              ),
              υ
C
              (
              t
              ),
              V
O
              (
              s
              ), and
              υ
O
              (
              t
              ) in symbolic form.
            


10-24
              Transform the circuit in
              Figure P10-24
              into the s domain and find:
              I
L
              (
              s
              ) and
              I
L
              (
              t
              ), when
              υ
1
              (
              t
              ) =
              V
A
e

                -1000
                t

              ,
              R
              = 200 Ω,
              L
              = 200 mH, and
              i
L
              (0) = 0 A. Validate your answers using Multisim.
              






FIGURE P10-24









10-25
              For the dependent source circuit shown in
              Figure P10-25
              , use superposition to find
              V
O
              (
              s
              ).
              






FIGURE P10-25









10-26
              The switch in
              Figure P10-26
              has been in position A for a long time and is moved to position B at
              t
              = 0.
              

(a)
                  Transform the circuit into the
                  s
                  domain and solve for
                  I
L
                  (
                  s
                  ) in symbolic form.
                

(b)
                  Repeat part (a) using MATLAB.
                

(c)
                  Find
                  i
L
                  (
                  t
                  ) for
                  R
1
                  =
                  R
2
                  = 1 kΩ,
                  R
3
                  = 2 kΩ,
                  L
                  = 250 mH,
                  C
                  = 0.3μF, and
                  V
A
                  = 5 V.
                  






FIGURE P10-26












10-27
              The Thévenin voltage of the circuit in
              Figure P10-27
              has the pole-zero diagram shown.
              

(a)
                  If
                  R
                  = 100 kΩ, what are the values of
                  C
1
                  and
                  C
2
                  ?
                

(b)
                  Is the system stable? Explain.
                

(c)
                  If the source's amplitude is
                  V
A
                  find
                  V
S
                  (
                  s
                  ).
                  






FIGURE P10-27











10-28

              The circuit in
              Figure P10-28
              is in the zero state. The network function
              K
              =
              V
O
              (
              s
              )/
              I
1
              (
              s
              ) for the circuit is
              


(a)
                  Select
                  R
                  and
                  C
                  so that there is a pole at −1000 rad/s. Under this condition, where are the poles and zeros located?
                

(b)
                  Select
                  i
1
                  (
                  t
                  ) so that there is a forced pole that can cancel one of the zeros.
                  






FIGURE P10-28











10-29
              The initial conditions for the circuit in
              Figure P10-29
              are
              υ
C
              (0) = 0 and
              i
L
              (0) =
              I
0
              . Transform the circuit into the
              s
              domain and use superposition and voltage division to find the zero-state and zero-input components of
              V
C
              (
              s
              ).
              






FIGURE P10-29








10-30
              The initial conditions for the circuit in
              Figure P10-29
              are
              υ
C
              (0) = 0 and
              i
L
              (0) =
              I
0
              . Transform the circuit into the
              s
              domain and use superposition and voltage division to find the zero-state and zero-input components of
              V
R
              (
              s
              ).
            


10-31


              The OP AMP circuit shown in
              Figure P10-31
              is purported to be a low-pass filter with a cutoff frequency at the single pole of the circuit and the dc gain given by the ratio of the two resistors.
              

(a)
                  Find the input-output relationship
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Select values of
                  R
1
                  ,
                  R
2
                  , and
                  L
                  so that the cutoff (the pole) is −1 krad/s and the gain is −10.
                

(c)
                  What is the gain of the circuit at
                  s
                  = 0 and ∞? Does the filter function as described?
                  






FIGURE P10-31










10-32
              There is no energy stored in the capacitor in
              Figure P10-32
              at
              t
              = 0. Transform the circuit into the
              s
              domain and use current division to find
              υ
O
              (
              t
              ) when the input is
              i
S
              (
              t
              ) = 10
              e

                −500
                t

u
              (
              t
              ) mA. Identify the forced and natural poles in
              V
O
              (
              s
              ).
              






FIGURE P10-32









10-33
              Repeat Problem 10-32 when
              i
S
              (
              t
              ) = 10 sin 1000
              t
u
              (
              t
              ) mA.
            

10-34
              For the circuit of
              Figure P10-34
              :
              

(a)
                  Find the Thévenin equivalent circuit that the
                  
                    R
                    X

                  load resistor sees when
                  υ
C
                  (0) =
                  V
0
                  V.
                

(b)
                  If the output transform is
                  
                  , find
                  R
X
                  .
                

(c)
                  Then find the voltage delivered to the load
                  υ
O
                  (
                  t
                  ) if
                  υ
C
                  (0) = 20 V,
                  i
S
                  (
                  t
                  ) = 100
                  u
                  (
                  t
                  ) mA,
                  R
                  = 1
                  k
                  Ω, and
                  C
                  = 2 μF
                

(d)
                  Identify the forced, natural, zero-state, and zero-input components of
                  υ
O
                  (
                  t
                  ).
                

(e)
                  Simulate the circuit in Multisim.
                  






FIGURE P10-34












10-35


(a)
                  The circuit in
                  Figure P10-35
                  is in the zero state. Find the Thévenin equivalent to the left of the interface.
                  






FIGURE P10-35








(b)
                  A 0.22-μF capacitor is connected across the interface in
                  Figure P10-35
                  . Find the voltage across it.
                



10-36

              Select a value of
              C
              in
              Figure P10-36
              so that
              V
O
              (
              s
              )/
              V
S
              (
              s
              ) has a natural pole at
              s
              = −10 Mrad/s.
              






FIGURE P10-36









10-37

              Find the required impedance
              Z
X
              (
              s
              ) that needs to be inserted in series as shown in
              Figure P10-37
              to make the output voltage equal to
              






FIGURE P10-37








10-38
              The equivalent impedance between a pair of terminals is
              




(a)
                  A voltage
                  υ
                  (
                  t
                  ) = 20
                  e

                    −1000
                    t

u
                  (
                  t
                  ) is applied across the terminals. Find the resulting current response
                  i
                  (
                  t
                  ).
                

(b)
                  Plot the pole-zero diagrams of the input source, the equivalent impedance, and the resulting current. What effect did the input have on the pole-zero diagram of the resulting current?
                




10-39

              There is no initial energy stored in the circuit in
              Figure P10-39
              . Use circuit reduction to find the output network function
              V
2
              (
              s
              )/
              V
1
              (
              s
              ). Then select values of
              R
              and
              C
              so that the poles of the network function are approximately −2618 and −382 rad/s.
              






FIGURE P10-39








10-40

              Refer to the dependent-source circuit in
              Figure P10-40
              .
              

(a)
                  Find
                  V
O
                  (
                  s
                  ) in terms of the input and the elements for the zero state.
                

(b)
                  Locate the natural poles and zeros of the circuit.
                

(c)
                  If
                  R
F
                  = 10kΩ,
                  R
                  = 100Ω, and
                  C
                  = 1 μF, what is the smallest value of μ that will keep the circuit stable?
                








FIGURE P10-40














                Objective 10-3 General Circuit Analysis (
                Sects. 10-4
                to
                10-6
                )
              
Given a linear circuit:


                  (a) Determine the initial conditions (if not given) and transform the circuit into the
                  s
                  domain.
                
(b) Solve for zero-state and zero-input response transforms and waveforms using node-voltage or mesh-current methods.
(c) Identify the forced and natural poles in the responses or select circuit parameters to place the natural poles at specified locations.


                See
                Examples 10-13
                to
                10-19
                and
                Exercises 10-17
                to
                10-27
                .
              






10-41
              There is no initial energy stored in the circuit in
              Figure P10-41
              .
              

(a)
                  Transform the circuit into the
                  s
                  domain and formulate mesh-current equations.
                

(b)
                  Show that the solution of these equations for
                  I
2
                  (
                  s
                  ) in symbolic form is
                  




(c)
                  Identify the poles and zeros of
                  I
2
                  (
                  s
                  ).
                


(d)
                  Find
                  i
2
                  (
                  t
                  ) for
                  υ
1
                  (
                  t
                  ) = 20
                  u
                  (
                  t
                  ) V,
                  R
1
                  = 2kΩ,
                  R
2
                  = 100Ω,
                  L
                  = 1 H, and
                  C
                  = 0.5 μF.
                

(e)
                  Validate your answers using Multisim.
                








FIGURE P10-41








10-42
              There is no initial energy stored in the circuit in
              Figure P10-41
              .
              

(a)
                  Transform the circuit into the
                  s
                  domain and formulate node-voltage equations.
                

(b)
                  Show that the solution of these equations for
                  V
2
                  (
                  s
                  ) in symbolic form is
                  




(c)
                  Identify the natural and forced poles of
                  V
2
                  (
                  s
                  ).
                

(d)
                  Find
                  υ
2
                  (
                  t
                  ) for
                  υ
1
                  (
                  t
                  ) = 2
                  u
                  (
                  t
                  ) V,
                  R
1
                  =
                  R
2
                  = 1 kΩ,
                  L
                  = 0.1 H, and
                  C
                  = 1 μF.
                




10-43


              There is no initial energy stored in the circuit in
              Figure P10-43
              .
              

(a)
                  Transform the circuit into the
                  s
                  domain and formulate node-voltage equations.
                

(b)
                  Solve these equations for
                  V
2
                  (
                  s
                  ) in symbolic form.
                

(c)
                  Insert an OP AMP buffer at point A and solve for
                  V
2
                  (
                  s
                  ) in symbolic form. How did inserting the buffer change the denominator and, therefore, the location of the poles?
                

(d)
                  Using both separate circuits (with and without the OP AMP), select values of
                  R
1
                  ,
                  R
2
                  ,
                  C
1
                  , and
                  C
2
                  to locate a pole at −10 krad/s and a second pole at −100 krad/s. Evaluate the two approaches and give pros and cons for each design.
                








FIGURE P10-43









10-44

                There is no initial energy stored in the circuit in
                Figure P10-43
                . The Thévenin equivalent circuit to the left of point A when a unit step is applied is
              




                Select values for
                R
2
                and
                C
2
                such that the output transform is
              






10-45
              There is no initial energy stored in the bridged-T circuit in
              Figure P10-45
              .
              

(a)
                  Transform the circuit into the
                  s
                  domain and formulate node-voltage equations.
                

(b)
                  Use the node-voltage equations to find the Thévenin equivalent voltage
                  V
T
                  (
                  s
                  ) seen looking into the open terminals. You may use the look-back method to find
                  Z
T
                  (
                  s
                  ).
                

(c)
                  Use the
                  V
T
                  (
                  s
                  ) and
                  Z
T
                  (
                  s
                  ) to find the Norton current
                  I
N
                  (
                  s
                  ).
                








FIGURE P10-45









10-46
              For the dependent source circuit in
              Figure P10-46
              write a set of node-voltage equations. But first do a source conversion for the capacitors (they have the same value but different initial conditions) to eliminate two nodes. Then solve the equations using MATLAB for
              V
O
              (
              s
              ).
              






FIGURE P10-46










10-47
              There is no initial energy stored in the circuit in
              Figure P10-47
              .
              

(a)
                  Find the zero-state mesh currents
                  i
A
                  (
                  t
                  ) and
                  i
B
                  (
                  t
                  ) when
                  υ
1
                  (
                  t
                  ) = 25
                  u
                  (
                  t
                  ) V.
                

(b)
                  Find
                  i
X
                  (
                  t
                  ).
                

(c)
                  Validate your answers using MATLAB and plot
                  i
A
                  (
                  t
                  ),
                  i
B
                  (
                  t
                  ), and
                  i
X
                  (
                  t
                  ) on one graph.
                








FIGURE P10-47










10-48
              There is no external input in the circuit in
              Figure P10-48
              .
              

(a)
                  Find the zero-input node voltages
                  υ
A
                  (
                  t
                  ) and
                  υ
B
                  (
                  t
                  ), and the voltage across the capacitor
                  υ
C
                  (
                  t
                  ) when
                  υ
C
                  (0) = 0 V and
                  i
L
                  (0) = 10 mA.
                

(b)
                  Use MATLAB to plot your results in (a).
                

(c)
                  Use Multisim to validate your results in (a).
                

(d)
                  compare the MATLAB and Multisim plots. Are they the same?
                








FIGURE P10-48










10-49

              Use mesh-current equations to find the three mesh currents in
              Figure P10-49
              . Find
              V
X
              (
              s
              ) and
              I
X
              (
              s
              ). Repeat the problem using node-voltage analysis. Which analysis method was simpler to use to find the two unknowns? Why?
              






FIGURE P10-49








10-50

              The circuit in
              Figure P10-50
              is in the zero state. Use mesh-current equations to find the circuit determinant. Select values of
              R, L,
              and
              C
              so that the circuit has
              

(a)
                  ω
                  0
                  = 40 krad/s and ζ = 0.5.
                

(b)
                  ω
                  0
                  = 40 krad/s and ζ = 2.0. (
                  Hint:
                  See
                  Example 10-15
                  .)
                








FIGURE P10-50









10-51

              The OP AMP circuit in
              Figure P10-51
              is in the zero state. Use node-voltage equations to find the circuit determinant. Select values of
              R, C
1
              , and
              C
2
              so that the circuit has ω
              0
              = 100 krad/s and ζ = 0.5. (
              Hint
              : See
              Example 10-15
              .)
              






FIGURE P10-51








10-52

              Assume that the circuits in
              Figures P10-50
              and
              P10-51
              both have the same response characteristics. What are the advantages and disadvantages of each?
            



10-53
              The switch in
              Figure P10-53
              has been in position A for a long time and is moved to position B at
              t
              = 0.
              

(a)
                  Write an appropriate set of node-voltage or mesh current equations in the
                  s
                  domain.
                

(b)
                  Use MATLAB to solve for
                  V
C
                  (
                  s
                  ) and
                  υ
C
                  (
                  t
                  ) for
                  V
S
                  (
                  t
                  ) = 15
                  e

                    −10,000
                    t

                  V.
                

(c)
                  Repeat (a) and (b) for
                  V
S
                  (
                  t
                  ) = 15
                  e

                    −2000
                    t

                  V.
                

(d)
                  Use MATLAB to plot both results on the same graph. What case is each?
                








FIGURE P10-53








10-54
              There is no energy stored in the circuit in
              Figure P10-54
              at
              t
              = 0. Transform the circuit into the
              s
              domain. Then use the unit output method to find the ratio
              V
O
              (
              s
              )/
              V
S
              (
              s
              ). Subsequently, use the input
              υ
S
              (
              t
              ) = 100
              u
              (
              t
              ) and find the output
              υ
O
              (
              t
              ).
              






FIGURE P10-54










10-55
              The switch in
              Figure P10-55
              has been open for a long time and is closed at
              t
              = 0. Transform the circuit into the s domain and solve for
              V
O
              (
              s
              ) and
              v
O
              (
              t
              ).
              






FIGURE P10-55








10-56
              Show that the circuit in
              Figure P10-56
              has natural poles at
              s
              = −4/
              RC
              and
              s
              = −2/
              RC
              ±
              j
              2/
              RC
              when
              L
              =
              R
2
C
              /4.
              






FIGURE P10-56









10-57
              Find the range of the gain μ for which the circuit's output
              V
O
              (
              s
              ) in
              Figure P10-57
              is stable (i.e., all poles are in the lefthand side of the
              s
              plane.)
              






FIGURE P10-57








10-58

              Consider what a pole-zero diagram can tell about the behavior of signals represented by their poles.
              

(a)
                  For example, consider a single pole, say
                  V
                  (
                  s
                  ) =
                  V
A
                  /(
                  s
                  + α). Let α vary from a large negative number towards zero and then from zero to a large positive number. Explain how the signal
                  υ
                  (
                  t
                  ) =
                  V
A
e

                    −α
                    t

                  varies as the pole moves along the σ axis.
                

(b)
                  Now consider a pair of imaginary poles along the
                  j
                  ω axis, say
                  V
                  (
                  s
                  ) =
                  V
A
                  /(
                  s
2
                  + β
                  2
                  ). Let β vary from zero to a large number. Explain how the signal
                  υ
                  (
                  t
                  ) = [
                  V
A
                  sin(β
                  t
                  )]/β varies as the poles move away from the origin.
                

(c)
                  Finally, consider a pair of complex poles, say
                  V
                  (
                  s
                  ) =
                  V
A
                  β/[(
                  s
2
                  + α
                  2
                  ) + β
                  2
                  ]. Explain how the signal
                  υ
                  (
                  t
                  ) =
                  V
A
e

                    -ω
                    t

                  sin(β
                  t
                  ) varies as α moves from a large negative number towards zero and then from zero to a large positive number. Lastly, explain how the signal varies as β increases.
                





10-59
              The circuit in Figure
              P10-59
              is shown in the
              t
              domain with initial values for the energy storage devices.
              

(a)
                  Transform the circuit into the
                  s
                  domain and write a set of node-voltage equations.
                

(b)
                  Transform the circuit into the
                  s
                  domain and write a set of mesh-current equations.
                

(c)
                  With the circuit in the zero state, use symbolic operations in MATLAB to solve for the node voltages.
                








FIGURE P10-59










Integrating Problems



10-60

                Thévenin's Theorem from Time-Domain Data A black box containing a linear circuit has an on-off switch and a pair of external terminals. When the switch is turned on, the open-circuit voltage between the external terminals is observed to be
              



The short-circuit current was observed to be





(a)
                  Locate the poles and zeros of the Thévenin impedance.
                

(b)
                  A 75-Ω load resistance is connected across the terminals and the switch turned on again. What is the voltage delivered to the load?
                



10-61

              Design a Load Impedance
              
                In order to match the Thévenin impedance of a source, the load impedance in
                Figure P10-61
                must be
                



(a)
                  What impedance
                  Z
2
                  (
                  s
                  ) is required if
                  R
                  = 10 Ω?
                


(b)
                  How would you realize
                  Z
2
                  (
                  s
                  ) using only resistors, inductors, and/or capacitors? (
                  Hint:
                  Write
                  Z
L
                  (
                  s
                  ) as a sum of admittances, then solve for
                  Y
2
                  (
                  s
                  ).)
                








FIGURE P10-61








10-62


RC
              circuit Analysis and Design
              
                The
                RC
                circuits in
                Figure P10-62
                represent the situation at the input to an oscilloscope. The parallel combination of
                R
1
                and
                C
1
                represents the probe used to connect the oscilloscope to a test point. The parallel combination of
                R
2
                and
                C
2
                represents the input impedance of the oscilloscope.
              



(a)
                  Assuming zero initial conditions, transform the circuit into the
                  s
                  domain and find the relationship between the test-point voltage
                  V
S
                  (
                  s
                  ) and the voltage
                  V
O
                  (
                  s
                  ) at the oscilloscope's input.
                


(b)
                  For
                  R
2
                  = 10 MΩ and
                  C
2
                  = 5 pF, determine the values of
                  R
1
                  and
                  C
1
                  that make the input voltage a scaled duplicate of the test-point voltage. That is,
                  υ
O
                  (
                  t
                  ) =
                  υ
S
                  (
                  t
                  ) ×
                  K
                  where
                  K
                  < 1.
                








FIGURE P10-62








10-63


s
              -domain OP AMP circuit Analysis and Design
              
                The OP AMP circuit in
                Figure P10-63
                is in the zero state.
              


(a)
                  Transform the circuit into the
                  s
                  domain and use the OP AMP circuit analysis techniques developed in Section 4-4 to find the network function
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Determine the possible purpose of this circuit by testing it at
                  s
                  = 0 and
                  s
                  = ∞.
                

(c)
                  Write the denominator of the network function so that it looks like
                  
                  . Select values for the parameters so that ω
                  0
                  = 10 krad/s and ζ = 1.
                








FIGURE P10-63









10-64

              Pulse conversion circuit
              
                The purpose of the test setup in
                Figure P10-64
                is to deliver damped sine pulses to the test load. The excitation comes from a 1-Hz square wave generator. The pulse conversion circuit must deliver damped sine waveforms with ζ < 0.5 and ω
                0
                > 10 krad/s to 50-Ω and 600-Ω loads. The recommended values for the pulse conversion circuit are
                L
                = 10 mH and
                C
                = 01 μF. Verify that the test setup meets the specifications. (
                Hint:
                compute the voltage across the load for an input signal equal to a unit step function,
                u
                (
                t
                ), and then again for a negative unit step function, −
                u
                (
                t
                ).) Note that the output of a square wave generator is the sum of a series of step functions.
              







FIGURE P10-64








10-65

              By-Pass capacitor Design
              
                In transistor amplifier design, a by-pass capacitor is connected across the emitter resistor
                R
E
                to effectively short out the emitter resistor at signal frequencies. This design improves the gain of the transistor for the desired ac signals. The circuit in
                Figure P10-65
                (a) is a common-emitter amplifier. The shaded portion is a low-frequency model of the transistor in use. In this problem, the task is to design a proper by-pass capacitor so that there is a pole at
                s
                = −500 rad/s. Reduce the circuit to its Thévenin equivalent as shown in
                Figure P10-65
                (b) and then select the proper capacitor.
                R
S
                = 10 kΩ,
                R
π
                = 2 kΩ,
                R
E
                = 3.3 kΩ,
                R
L
                = 1 kΩ, and β = 70.
              







FIGURE P10-65









10-66

              Pole Eliminator circuit
              
                The Acme Pole Eliminator company states in their online catalog that the circuit shown in
                Figure P10-66
                can eliminate any realizable pole. Their catalog states "Suppose you have a need to eliminate the pole associated with an input, for example,
                V
S
                (
                s
                ) =
                K
                /(
                s
                + α). Selecting 1/
                R
1
C
                = α will eliminate the pole, while the ratio
                R
2
                /
                R
1
                can be used to provide any desired negative gain or attenuation to the output." Prove or disprove their claim.
              







FIGURE P10-66









10-67

              Band-pass Filter Design
              
                The OP AMP circuit in
                Figure P10-67
                is an audio band-pass filter-amplifier.
              


(a)
                  Your task is to design such a filter so that the lowfrequency cutoff is 80 Hz and the high-frequency cutoff is 25,000 Hz. The gain of the combined OP AMPs should be 1000.
                  (Hint:
                  See
                  Example 10-16
                  and
                  Exercise 10-21
                  .)
                

(b)
                  Show that your design is correct using Multisim. (Hint: Drive your circuit with a 1 mV ac signal and do an ac sweep it from 1 Hz to 100 kHz.)
                








FIGURE P10-67













Notes





1

              In early studies of Laplace, the Laplace operator used was
              p.
              In later electrical engineering texts, the
              p
              was replaced by the Laplace operator
              s
              . See, for example, R. V. Churchill,
              Modern Operational Mathematics in Engineering,
              McGraw-Hill Book Co., 1944 and Van Valkenburg,
              Network Analysis,
              Prentice-Hall Inc., 1955.
            


2

              In this context,
              Y
              (
              s
              ) is not an admittance but the Laplace transform of the circuit output
              y(t).



3

              They could just as logically be called marginally unstable. The stability status of simple
              j
              -axis poles depends on the application. For example, electronic circuits with simple poles firmly rooted on the
              j
              -axis are called stable oscillators. On the other hand,
              j
              -axis poles in audio amplifiers cause "ringing," a dirty word among audiophiles.
            
















CHAPTER 11

NETWORK FUNCTIONS




The driving-point impedance of a network is the ratio of an impressed electromotive force at a point in a branch of the network to the resulting current at the same point.


            Ronald M. Foster, 1924,
            
            American Engineer
          









Some History Behind This Chapter

              The network function concept emerged in the 1920s during the development of systematic methods of designing electric filters for long-distance telephone systems. The filter design effort eventually evolved into a theory known as
              network synthesis.
              The purpose of network synthesis is to obtain circuits that produce a desired network function. Ronald Foster along with Sidney Darlington, Hendrik Bode, Wilhelm Cauer, and Otto Brune are generally considered the founders of modern network synthesis. Ensuring that generations of students understood network theory, Mac E. Van Valkenburg, eminent educator and Dean, University of Illinois, may be best remembered for his seminal engineering textbook
              Network Analysis
              (1955) that had a major impact on engineering education.
            









Why This Chapter Is Important Today
This special chapter introduces one of the most important concepts of electrical engineering—the network function. In this chapter, you will learn what network functions are and why they are important descriptors of electric circuits. Most importantly, you will learn how to design circuits that can realize a desired network function. But we don't stop there. Since design can lead to many different answers, we introduce you to the criteria used to evaluate alternative solutions.









Chapter Sections



11-1 Definition of a Network Function






11-2 Network Functions of One- and Two-Port Circuits






11-3 Network Functions and Impulse Response






11-4 Network Functions and Step Response






11-5 Network Functions and Sinusoidal Steady-State Response






11-6 Impulse Response and Convolution






11-7 Network Function Design and Evaluation












Chapter Learning Objectives

11-1
              Network Functions (
              Sects. 11-1
              and
              11-2
              )
            
Given a linear circuit:

(a) Find specified network functions and locate their poles and zeros.
(b) Select the element values to produce specified poles and zeros.


11-2
              Network Functions, Impulse Response, and Step Response (
              Sects. 11-3
              and
              11-4
              )
            

(a) Given a first- or second-order linear circuit, find its impulse or step response.
(b) Given the impulse or step response of a linear circuit, find the network function.
(c) Given the impulse or step response of a linear circuit, find the response due to other inputs.


11-3
              Network Functions and the Sinusoidal Steady-State Response (
              Sect. 11-5
              )
            

(a) Given a first- or second-order linear circuit with a specified input sinusoid, find the sinusoidal steady-state response.
(b) Given the network function, impulse response, or step response, find the sinusoidal steady-state response for a specified input sinusoid.


11-4
              Network Functions and Convolution (
              Sect. 11-6
              )
            

(a) Given the impulse response of a linear circuit, use the convolution integral to find the response to a specified input.
(b) Use the convolution integral to derive properties of linear circuits.


11-5
              Network Function Design and Evaluation (
              Sect. 11-7
              )
            

(a) Design alternative circuits that realize a given network function and meet other stated constraints.
(b) Use software to visualize and simulate alternative designs.
(c) Evaluate alternative designs using stated criteria and select the best design.






            11-1 Definition of a Network Function
          

            The proportionality property of linear circuits states that the output is proportional to the input. In
            Chapter 10
            , we noted that in the
            s
            domain the proportionality factor is a rational function of
            s
            called a
            network function.
            More formally, a network function is defined as the ratio of a zero-state response transform (output) to the excitation (input) transform.
          


(11-1)



Note carefully that this definition specifies zero initial conditions and implies only one input.

            To study the role of network functions in determining circuit responses, we write the
            s
            -domain input-output relationship as
          



(11-2)





            where
            T
            (
            s
            ) is a network function,
            X
            (
            s
            ) the input signal transform, and
            Y
            (
            s
            ) a zero-state response or output.
            
1

Figure 11-1
            shows a block diagram representation of the
            s
            -domain input-output relationship in
            Eq. (11-2)
            .
          








FIGURE 11-1




Block diagram for an s-domain input-output relationship.




            In an analysis problem, the circuit and input [
            X
            (
            s
            ) or
            x
            (
            t
            )] are specified. We determine
            T
            (
            s
            ) from the circuit, use
            Eq. (11-2)
            to find the response transform
            Y
            (
            s
            ), and use the inverse transformation to obtain the response waveform
            y
            (
            t
            ). In a design problem the circuit is unknown. The input and output are specified, or their ratio
            T
            (
            s
            ) =
            Y
            (
            s
            )/
            X
            (
            s
            ) is given. The objective is to devise a circuit that realizes the specified input-output relationship. A linear circuit analysis problem has a unique solution, but a design problem may have one, many, or even no solutions. If more than one working solution exists, then one must ask, which design should I choose? Selecting the optimum design is one of the hallmarks of a modern engineer. Later in the chapter we will discuss how one might go about making a smart decision.
          

Equation (11-2)
            points out that the poles of the response
            Y
            (
            s
            ) come from either the network function
            T
            (
            s
            ) or the input signal
            X
            (
            s
            ). When there are no repeated poles, the partial-fraction expansion of the right side of
            Eq. (11-2)
            takes the form
          



(11-3)





            where
            s
            =
            
              p
              j

            (
            j
            = 1,2,
            N
            ) are the poles of
            T
            (
            s
            ) and
            s
            =
            
              p
              ℓ

            (
            ℓ
            = 1,2,...,
            M
            ) are the poles of
            X
            (
            s
            ). The inverse transform of this expansion is
          


(11-4)




            The poles of
            T
            (
            s
            ) lead to the natural response. In a stable circuit, the natural poles are all in the left half of the
            s
            plane, and all of the exponential terms in the natural response eventually decay to zero. The poles of
            X
            (
            s
            ) lead to the forced response.
            
            In a stable circuit, those elements in the forced response that do not decay to zero, but are marginally stable, are called the
            steady-state response.


            It is important to remember that the complex frequencies in the natural response are determined by the circuit and do not depend on input. Conversely, the complex frequencies in the forced response are determined by the input and do not depend on the circuit. However, the amplitude of its part of the response depends on the residues in the partial-fraction expansion in
            Eq. (11-3)
            . These residues are influenced by all of the poles and zeros, whether forced or natural. Thus, the amplitudes of the forced and natural responses depend on an interaction between the poles and zeros of
            T
            (
            s
            ) and
            X
            (
            s
            ).
          
The following example illustrates this discussion.











EXAMPLE 11-1


                    A simple series
                    RC
                    circuit shown in
                    Figure 11-2
                    (a) is driven by a charging exponential source. If
                    R
                    = 10 kΩ and
                    C
                    = 0.01 µF, the network function is
                  








FIGURE 11-2











                    Find the zero-state response
                    υ
2
                    (
                    t
                    ) when the input is
                    υ
1
                    (
                    t
                    ) =10(1 -
                    
                      e
                      -


                      5000
                      t

                    )
                    u
                    (
                    t
                    ) V. Identify the natural and forced components of your answer. Plot them on a pole-zero diagram.
                  




SOLUTION:


The transform of the input signal is




                Using the
                s
                -domain input-output relationship in
                Eq. (11-2)
                , the transform of the response is
              



Expanding by partial fractions,




                The two forced poles came from the input charging exponential, while the natural pole came from the
                RC
                circuit via the network function. Using the cover-up method to evaluate the residues yields
              



Collectively the residues depend on all of the poles and zeros. The inverse transform yields the zero-state response as





                The natural pole is
                s
                = -10,000 and is located in the left-half of the
                s
                plane causing the natural response to decay to zero. The forced poles are at zero and at
                s
                = -5000. The pole at
                s
                = -5000 will decay to zero leaving a steady-state response of 10
                u
                (
                t
                ). See pole-zero diagram in
                Figure 11-2
                (b).
                ■










Exercise 11-1

The network function for a circuit is




                (a) Find the zero-state response
                υ
2
                (
                t
                ) when the input is
                υ
1
                (
                t
                ) = cos 50
                t
                V.
              
(b) Identify the steady-state response, if any.
Answers:


                  (a)
                  υ
2
                  (
                  t
                  ) = 8
                  e

                    -100
                    t

                  + 4.47 cos(50
                  t
                  + 63.4°)
                  u
                  (
                  t
                  ) V
                

                  (b)
                  υ
2SS
                  (
                  t
                  ) = 447 cos(50
                  t
                  + 63.4°)
                  u
                  (
                  t
                  ) V
                




Test Signals

              While the transfer function is a useful concept, it is clear that we cannot find the circuit response until we are given an input signal. Here, we encounter a central paradox of circuit analysis. In practice, the input signal is a carrier of information.
              Information signals,
              such as data, voice, and video, are unpredictable by their nature—otherwise, why send a signal when the information is already known? We could spend a lifetime studying a circuit for various inputs and still not treat all possible signals that might be encountered in practice. What we must do is calculate the responses due to certain standard test signals. Although these test signals may never occur as real input signals, their responses tell us enough to understand the signal-processing capabilities of a circuit.
            

              The two premier
              test signals
              used are the
              pulse
              and the
              sinusoid.
              The study of the pulse response divides into two extreme cases, short and long. When the pulse is very short compared to the circuit response time, the sudden injection of energy causes a circuit response long after the input returns to zero. The short pulse is modeled by an impulse, and the resulting
              impulse response
              is treated in
              Sect. 11-3
              . At the other extreme, the long pulse has a duration that greatly exceeds the circuit response time. In this case, the circuit has ample time to be driven from the zero state to a new steady-state condition. The step function is used to model the long pulse input, and the resulting
              step response
              is studied in
              Sect. 11-4
              .
            

              The impulse response is of great importance because it contains all of the information needed to calculate the response due to any other input. The step response, on the other hand, is important because it describes how a circuit response transitions from one state to another. The signal transition requirements for circuits and systems are often stated in terms of the step response using partial waveform descriptors such as rise time, fall time, propagation delay, and overshoot. We will cover these in some detail in Application
              Example 11-12
              .
            

              The unique properties of the sinusoid make it a useful input for characterizing the signal-processing capabilities of linear circuits and systems. When a stable linear circuit is driven by a sinusoidal input, the steady-state output is a sinusoid with the same frequency, but usually with a different phase angle and amplitude. The frequency-dependent relationship between the sinusoidal input and the steady-state output is called
              frequency response,
              a signal-processing description that is often used to specify the performance of circuits and systems. The relationships between network functions, the sinusoidal steady-state response, and phasor analysis from
              Chapter 8
              are studied in
              Sect. 11-5
              .
            




11-2 Network Functions of One- and Two-Port circuits

            The two major types of network functions are driving-point impedance and transfer functions. A
            driving-point impedance
            relates the voltage and current at a pair of terminals called a
            port.
            The driving-point impedance
            Z
            (
            s
            ) of the one-port circuit in
            Figure 11-3
            is defined as
          








FIGURE 11-3




A one-port circuit.





(11-5)




            When the one port is driven by a current source, the response is 
            Y 
            ( 
            s  
            ) =   
            Z  
            (   
            s   
            )
            I 
            ( 
            s 
            ) and the natural frequencies in the response are the poles of impedance
            Z   
            ( 
            s   
            ). On the other hand, when the one port is driven by a voltage source, the response is
            I  
            (   
            s
            ) = [    
            Z  
            (    
            s   
            )] 
            -1
V 
            (    
            s
            ) and the natural frequencies in the response are the poles of 1/
            Z    
            (  
            s   
            ); that is, the zeros of 
            Z   
            (   
            s   
            ). In other words, the driving-point impedance is a network function whether upside down or right side up.
          

            The term
            driving point
            means that the circuit is driven or powered by a source at one port and the response is observed at the same port. The element impedances
            Z
R
            ,
            Z
L
            , and
            Z
C
            defined in
            Sect. 10-1
            are elementary examples of driving-point impedances. The equivalent impedances found by combining elements in series and parallel are also driving-point impedances. Driving-point functions are the
            s
            -domain generalization of the concept of the input resistance. The terms
            driving-point impedance, input impedance,
            and
            equivalent impedance
            are synonymous.
          

            The driving-point impedance seen at a pair of terminals determines the
            loading
            effects that result when those terminals are connected to another circuit. When two circuits are connected together, these loading effects can profoundly alter the responses observed when the same two circuits operated in isolation. In an analysis situation, it is important to be able to predict the response changes that occur when one circuit loads another. In design situations, it is important to know when the circuits can be designed separately and then interconnected without encountering loading effects that alter their designed performance. The conditions under which loading can or cannot be ignored were first introduced in
            Chapter 4
            when we discussed cascading OP AMP circuits, but will be studied in this and subsequent chapters in greater detail.
          

            Transfer functions are usually of greater interest in signal-processing applications than driving-point impedances because they describe how a signal is modified by passing through a circuit. A
            transfer function
            relates an input and response (or output) at different ports in the circuit.
            Figure 11-4
            shows the possible input-output configurations for a two-port circuit. Since the input and output signals can be either a current or a voltage, we can define four kinds of transfer functions:
          



(11-6)





            The functions
            T
V
            (
            s
            ) and
            T
1
            (
            s
            ) are dimensionless since the input and output signals have the same units. The function
            T
z
            (
            s
            ) has units of ohms and
            T
Y
            (
            s
            ) has units of siemens.
          








FIGURE 11-4




Two-port circuits and transfer functions.





            The functions in
            Eq. (11-6)
            are sometimes called forward transfer functions because they relate inputs applied at port 1 to outputs occurring at port 2. There are, of course, reverse transfer functions that relate inputs at port 2 to outputs at port 1. It is important to realize that a transfer function is valid only for a specified input port and output port. For example, the voltage transfer function
            T
V
            (
            s
            ) =
            V
2
            (
            s
            )/
            V
1
            (
            s
            ) relates the input voltage applied at port 1 in
            Figure 11-4
            to the voltage response observed at the output port. The reverse voltage transfer function for signal transmission from output to input is
            not
            1/
            T
V
            (
            s
            ). Unlike driving-point impedance, transfer functions are not network functions when they are turned upside down. Different types of transfer functions are major topics in
            Chapter 17
            , Two-Port Networks.
          

Determining Network Functions
The rest of this section illustrates analysis techniques for deriving network functions. The application of network functions in circuit analysis and design begins in the next section and continues throughout the rest of this book. But first, we illustrate ways to find the network functions of a given circuit.

              The divider circuits in
              Figure 11-5
              occur so frequently that it is worth taking time to develop their transfer functions in general terms. Using
              s
              -domain voltage division in
              Figure 11-5
              (a), we can write
            








FIGURE 11-5




Basic divider circuits.
                  (
                  a
                  )
                  Voltage divider.
                  (
                  b
                  )
                  Current divider.






Therefore, the voltage transfer function of a voltage divider circuit is



(11-7)





              Similarly, using
              s
              -domain current division in
              Figure 11-5
              (b) yields the transfer function of a current divider circuit as
            



(11-8)





              By series equivalence, the driving-point impedance at the input of the voltage divider is
              Z
EQ
              (
              s
              ) =
              Z
1
              (
              s
              ) +
              Z
2
              (
              s
              ). By parallel equivalence, the driving-point impedance at the input of the current divider is
              Z
EQ
              (
              s
              ) = 1/(
              Y
1
              (
              s
              ) +
              Y
2
              (
              s
              )).
            

              Two other useful circuits are the inverting and noninverting OP AMP configurations shown in
              Figure 11-6
              . To determine the voltage transfer function of the inverting circuit in
              Figure 11-6
              (a), we write the sum of currents leaving node B:
            




              But the ideal OP AMP constraints require that
              I
N
              (
              s
              ) = 0 and
              V
B
              (
              s
              ) = 0 since the non-inverting input is grounded. By definition, the output voltage
              V
2
              (
              s
              ) equals node voltage
              V
C
              (
              s
              ) and the voltage source forces
              V
A
              (
              s
              ) to equal the input voltage
              V
1
              (
              s
              ). Inserting all of these considerations into the node equations and solving for the voltage transfer function yields
            



(11-9)





              From the study of OP AMP circuits in
              Chapter 4
              , you should recognize
              Eq. (11-9)
              as the
              s
              -domain generalization of the inverting OP AMP circuit gain equation,
              K
              = -
              R
2
              /
              R
1
.



              The driving-point impedance at the input to the inverting circuit is
            




              But
              V
A
              (
              s
              ) =
              V
1
              (
              s
              ) and
              V
B
              (
              s
              ) = 0; hence the input impedance is
              Z
IN
              (
              s
              ) =
              Z
1
              (
              s
              ), and should be a loading consideration. This simply means that the input to an inverting amplifier (or any inverting terminal of an OP AMP configuration) will be equal to the input impedance of the inverting terminal,
              Z
1
              (
              s
              ), in
              Figure 11-6
              (a). Compare this result to that of the noninverting configuration studied in the discussion that follows.
            








FIGURE 11-6




Basic OP AMP circuits.
                  (
                  a
                  )
                  Inverting amplifier.
                  (
                  b
                  )
                  Noninverting amplifier.




              For the noninverting circuit in
              Figure 11-6
              (b), the sum of currents leaving node B is
            




              In the noninverting configuration, the ideal OP AMP constraints require that
              I
N
              (
              s
              ) = 0 and
              V
B
              (
              s
              ) =
              V
1
              (
              s
              ). By definition, the output voltage
              V
2
              (
              s
              ) equals node voltage
              V
C
              (
              s
              ). Combining all of these considerations and solving for the voltage transfer function yields
            



(11-10)





Equation (11-10)
              is the
              s
              -domain version of the noninverting amplifier gain equation,
              K
              = (
              R
1
              +
              R
2
              )/
              R
1
              . The transfer function of the noninverting configuration is the reciprocal of the transfer function of the voltage divider in the feedback path. The ideal OP AMP draws no current at its input terminals, so theoretically the input impedance of the noninverting circuit is infinite making it useful to solve loading issues.
            
The transfer functions of divider circuits and the basic OP AMP configurations are useful analysis and design tools in many practical situations. However, a general method is needed to handle circuits of greater complexity. One general approach is to formulate either node-voltage or mesh-current equations with all initial conditions set to zero. These equations are then solved for network functions using Cramer's rule for hand calculations or symbolic math analysis programs such as MATLAB. The algebra involved can be a bit tedious at times, even with MATLAB. But the tedium is reduced somewhat because we only need the zero-state response for a single input source.
The following examples illustrate methods of calculating network functions.












EXAMPLE 11-2




                        (a) Find the transfer functions of the circuits in
                        Figure 11-7
                        .
                        







FIGURE 11-7








(b) Find the driving-point impedances seen by the input sources in these circuits.

                        (c) Using
                        R
                        = 1 kΩ,
                        C
                        =1 µF, and
                        L
                        = 1H, show that all three circuits have the same transfer function. Then show that their driving-point impedances are different.
                      






SOLUTION:





                      (a) These are all divider circuits, so the required transfer functions can be obtained using
                      Eq. (11-7)
                      or
                      (11-8)
                      .
                    



                          For circuit C1:
                          Z
1
                          (
                          s
                          ) =
                          R,Z
2
                          (
                          s
                          ) = 1/
                          Cs
                          , and
                          T
V
                          (
                          s
                          ) = 1/
                          RCs
                          + 1)
                        



                          For circuit C2:
                          Z
1
                          (
                          s
                          ) =
                          Ls
                          ,
                          Z
2
                          (
                          s
                          ) =
                          R
                          , and
                          T
V
                          (
                          s
                          ) =
                          




                          For circuit C3:
                          Z
1
                          (
                          s
                          ) =
                          
                          ,
                          Z
2
                          (
                          s
                          ) =
                          R
                          , and
                          T
1
                          (
                          s
                          ) = 1/(
                          RCs
                          + 1)
                        



                      These transfer functions are all of the form 1/ (τ
                      s
                      + 1, where τ is the circuit time constant.
                    


(b) The driving-point impedances are found by series or parallel equivalence.



                          For circuit C1:
                          Z
                          (
                          s
                          ) =
                          Z
1
                          +
                          Z
2
                          = (
                          RCs
                          + 1)/
                          Cs




                          For circuit C2:
                          Z
                          (
                          s
                          ) =
                          Z
1
                          +
                          Z
2
                          =
                          Ls
                          +
                          R




                          For circuit C3:
                          Z
                          (
                          s
                          ) = 1/(
                          Y
1
                          +
                          Y
2
                          ) = 1/(
                          Cs
                          + G) =
                          R
                          /(
                          RCs
                          + 1)
                        




(c) With the element values provided, we find that


















                      All three realizations have the same transfer function—a single pole at
                      s
                      = -1000 rad/s. However, the input impedance seen by the source is quite different in each case:
                    








                      Circuit C1 has a pole at zero and a zero at -1000 rad/s. Circuit C2 has a single zero at -1000 rad/s, while circuit C3 has a single pole at -1000 rad/s. In general, the larger the impedance seen by the source, the smaller effect the impedance will have on the source. This usually is a good thing.
                      ■





The general principle illustrated here is that several different circuits can have the same transfer function. Put differently, a desired transfer function can be realized by several different circuits. This fact is important in design because circuits that produce the same transfer function offer alternatives that may differ in other features. In this example, they all have different input impedances.








                  Design
                  Exercise 11-2



                    (a) Show that the two OP AMP circuits in
                    Figure 11-8
                    have a transfer function
                    T
V
                    (
                    s
                    ) =
                    V
2
                    (
                    s
                    )/
                    V
1
                    (
                    s
                    ) of the same form.
                    







FIGURE 11-8









                    (b) Select standard values from
                    Appendix G
                    so that the transfer functions found in (a) each have a pole at
                    s
                    = -10,000.
                  
(c) Using the values found in (b), find the driving-point impedance of each circuit.

Answers:





                    (b) For the
                    RL
                    circuit, let
                    R
                    = 10kΩ and
                    L
                    = 1 H. For the
                    RC
                    circuit, let
                    R
                    = 10kΩ and
                    C
                    = 0.01 µF. Other correct answers are possible.
                  

                    (c)
                    Z
RL
                    (
                    s
                    ) =
                    s
                    + 10,000 Ω;
                    Z
RC
                    (
                    s
                    ) = 10,000 Ω.
                  
















EVALUATION EXAMPLE 11-3



                        (a) Find the input impedance seen by the voltage source in
                        Figure 11-9
                        (a).
                        







FIGURE 11-9









                        (b) Find the voltage transfer function
                        T
v
                        (
                        s
                        ) =
                        V
2
                        (
                        s
                        )/
                        V
1
                        (
                        s
                        ) of the circuit.
                      

                        (c) Locate the poles and zeros of
                        T
V
                        (
                        s
                        ) for
                        R
1
                        =10kΩ, R
                        2
                        =20kΩ,
                        C
1
                        =0.1 µF, and
                        C
2
                        = 0.05 µF.
                      
(d) What is the value of the transfer function at s = 0 and at s = ∞? Is this a high- or low-pass filter?
(e) Simulate using Multisim's ac Sweep. Plot only the magnitude of the transfer function. Explain the results.





SOLUTION:





                      (a) The circuit is a voltage divider. We first calculate the equivalent impedances of the two legs of the divider. The two elements in parallel combine to produce the series leg impedance
                      Z
1
                      (
                      s
                      ) as
                    




                      The two elements in series combine to produce shunt leg impedance
                      Z
2
                      (
                      s
                      ) :
                    



Using series equivalence, the driving-point impedance seen at the input is





(b) Using voltage division, the voltage transfer function is




                      (c) Inserting the specified numerical values into
                      T
V
                      (
                      s
                      ) yields
                    





                      which indicates a double zero at
                      s
                      = -1000 rad/s, and simple poles at
                      s
                      = - 500 rad/s and
                      s
                      = - 2000 rad/s.
                    



                      (d) At
                      s
                      = 0,
                      T
V
                      (
                      s
                      ) = 1 and
                      s
                      = ∞
                      T
V
                      (
                      s
                      ) = 1. It is neither a high-pass nor low-pass filter. See part (e) below.
                    



                      (e) It might seem that this circuit serves little function since it is almost a constant throughout all frequencies. However, upon closer look, as shown in
                      Figure 11-9
                      (b), there is from 0 dB, a valley starting at around 10 Hz and returning back to 0 dB around 3000 Hz. The valley is shallow reaching a maximum of only -1.9 dB. What purpose could this have? This general type of circuit belongs to a class called Band Reject filters that will be studied extensively in
                      Chapters 12
                      and
                      14
                      . Returning to this particular circuit, its frequency range is in the audio range and the circuit is used to attenuate lower frequencies in audiophile systems to match or "equalize" inputs. Such filters are useful in hearing aids where wearers hear too much bass when their higher frequencies are diminished by aging.
                    










FIGURE 11-9



■














                  Design
                  Exercise 11-3



                    (a) Find the input impedance seen by the voltage source in
                    Figure 11-10
                    .
                    







FIGURE 11-10









                    (b) Find the voltage transfer function
                    T
V
                    (
                    s
                    ) =
                    V
2
                    (
                    s
                    )/
                    V
1
                    (
                    s
                    ) of the circuit.
                  

                    (c) Select appropriate values of
                    R
1
                    and
                    R
2
                    so that the transfer function has a double zero at
                    s
                    = -1000 rad/s if
                    L
1
                    =
                    L
2
                    = 1 H.
                  
(d) With the values you selected, where are the poles located?

                    (e) Run a Multisim simulation of your circuit and compare it to
                    Figure 11-9
                    (b). What conclusions can you draw from your comparison?
                  

Answers:


                    (a)
                    


                    (b)
                    


                    (c) With
                    L
1
                    =
                    L
2
                    = 1 H, select
                    R
1
                    =
                    R
2
                    = 1 kΩ.
                    


                    (d)
                    
                    ; Poles at - 2618, and - 382 rad/s.
                  

                    (e) The curves appear similar and both are band-reject filters. The deepest part of the valley occurs at 1 krad/s or 159 Hz for both circuits because of the location of the double zero. The poles on the
                    RL
                    circuit are further apart than those of the
                    RC
                    circuit. It appears that the poles being further apart allows the depth of the valley to become deeper at -3.5 dB for the
                    RL
                    circuit versus -1.9 dB in the
                    RC
                    case.
                  

















DESIGN EXAMPLE 11-4


                      Find the driving-point impedance seen by the voltage source in
                      Figure 11-11
                      . Find the voltage transfer function
                      T
V
                      (
                      s
                      ) =
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ) of the circuit. The poles of
                      T
V
                      (
                      s
                      ) are located at
                      p
1
=
                      -1000 rad/s and
                      p
2
                      = - 5000 rad/s. If
                      R
1
                      =
                      R
2
                      = 20 kΩ, what values of
                      C
1
                      and
                      C
2
                      are required?
                    








FIGURE 11-11











SOLUTION:



                  The circuit is an inverting OP AMP configuration of the form in
                  Figure 11-6
                  (a). The input impedance of this circuit is
                




                  The impedance
                  Z
2
                  in the feedback path is
                



and the voltage transfer function is




                  The poles of
                  T
V
                  (
                  s
                  ) are located at
                  p
1
                  = - 1/
                  R
1
C
1
                  = -1000 and
                  p
2
                  = - 1/
                  R
2
C
2
                  = -5000. If
                  R
1
                  =
                  R
2
                  = 20 kΩ, then
                  C
1
                  =1/1000
                  R
1
                  = 0.05 µF and
                  C
2
                  = 1/5000
                  R
2
                  = 0.01 µF.
                  ■










Exercise 11-4


                  Suppose that capacitor
                  C
1
                  in the circuit of
                  Figure 11-11
                  suddenly became shorted. What effect would it have on the circuit's voltage transfer function?
                


Answer:


The transfer function would become




                  effectively eliminating the pole at s = -1/
                  R
1
C
1
                  .
                










Exercise 11-5



                    (a) Suppose that capacitor
                    C
2
                    in the circuit of
                    Figure 11-11
                    suddenly became open-circuited. What effect would it have on the circuit's voltage transfer function?
                  
(b) What would happen if the capacitor C2 would become shorted?

Answers:


(a) The transfer function would become




                      effectively eliminating the pole at
                      s
                      = - 1/
                      R
2
C
2
                      .
                    


(b) The output would be shorted out and equals 0 V.


















EXAMPLE 11-5



                      For the circuit in
                      Figure 11-12
                      find the input impedance
                      Z
                      (
                      s
                      ) =
                      V
1
                      (
                      s
                      )/
                      I
1
                      (
                      s
                      ), the transfer impedance
                      T
Z
                      (
                      s
                      ) =
                      V
2
                      (
                      s
                      )/
                      I
1
                      (
                      s
                      ), and the voltage transfer function
                      T
V
                      (
                      s
                      ) =
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ).
                    








FIGURE 11-12











SOLUTION:


The circuit is not a simple voltage divider, so we use mesh-current equations to illustrate the general approach to finding network functions. By inspection, the mesh-current equations for this ladder circuit are




                  In terms of the mesh current, the input impedance is
                  Z
                  (
                  s
                  ) =
                  V
1
                  (
                  s
                  )/
                  I
A
                  (
                  s
                  ). Using Cramer's rule to solve for
                  I
A
                  (
                  s
                  ) yields
                



The input impedance of the circuit is




                  In terms of mesh current, the transfer impedance is
                  T
Z
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  I
A
                  (
                  s
                  ). The mesh-current equations do not yield the output voltage directly. But since
                  V
2
                  (
                  s
                  ) =
                  I
B
                  (
                  s
                  )Z
                  C
                  (
                  s
                  ) =
                  I
B
                  (
                  s
                  )
                  
                  , we can solve the second mesh equation for
                  I
B
                  (
                  s
                  ) in terms of
                  I
A
                  (
                  s
                  ) as
                



and obtain the specified transfer impedance as




                  To obtain the specified voltage transfer function, we could use Cramer's rule to solve for
                  I
B
                  (
                  s
                  ) in terms of
                  V
1
                  (
                  s
                  ) and then use the fact that
                  V
2
                  (
                  s
                  ) =
                  I
B
                  (
                  s
                  )
                  Z
C
                  (
                  s
                  ). But a moment's reflection reveals that
                



Hence, the specified voltage transfer function is




■












Exercise 11-6


                  For the circuit shown in
                  Figure 11-12
                  , insert a follower at point A and find the transfer function
                  T
V
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ). Compare your result with that found in
                  Example 11-5
                  for the same transfer function.
                


Answer:


The transfer function would become




                  The difference appears to be slight—simply changing the middle term of the denominator from 3 to 2. However, this change affects the location of the poles and could affect the nature of the circuit's behavior. Inserting the follower eliminates the loading effect of the second
                  RC
                  circuit on the first. This illustrates one of the great advantages of OP AMPs.
                















EXAMPLE 11-6


                      Find the voltage transfer function
                      T
V
                      (
                      s
                      ) =
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ) of the circuit in
                      Figure 11-13
                      .
                    




SOLUTION:



                  The voltage-controlled voltage source makes this an active
                  RC
                  circuit. We use node-voltage equations in this problem because the required output is a voltage. The circuit contains two voltage sources connected at a common node. Selecting this common node as the reference eliminates two unknowns since
                  V
A
                  (
                  s
                  ) =
                  V
1
                  (
                  s
                  ) and
                  V
D
                  (
                  s
                  ) = µ
                  V
C
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  ). The sums of currents leaving nodes B and C are
                








FIGURE 11-13











                  Multiplying both equations by
                  R
1
R
2
                  and rearranging terms produces
                




                  Using the node C equation to eliminate
                  V
B
                  (
                  s
                  ) from the node B equation leaves
                




                  Since the output
                  V
2
                  (
                  s
                  ) = µ
                  V
C
                  (
                  s
                  ), the required transfer function is
                




                  This circuit is a member of the Sallen-Key family, often used in filter design with
                  R
1
                  =
                  R
2
                  =
                  R
                  and
                  C
1
                  =
                  C
2
                  =
                  C,
                  in which case the transfer function reduces to
                




                  We will encounter this result again in later chapters.
                  ■












                  Design
                  Exercise 11-7


                  Consider the dependent-source circuit shown in
                  Figure 11-13
                  with
                  R
1
                  =
                  R
2
                  =
                  R
                  and
                  C
1
                  =
                  C
2
                  =
                  C
                  and the resulting transfer function under those conditions shown in the example immediately above.
                


                    (a) Select values for µ,
                    R,
                    and
                    C
                    so that the transfer function has purely imaginary poles at
                    s
                    = ±
                    j
                    1000.
                  
(b) What function can the circuit perform under these constraints?

Answers:


                    (a) Let µ = 3,
                    R
                    = 1 kΩ, and
                    C
                    = 1 µF. Other values of
                    R
                    and
                    C
                    are possible, but not other values of µ.
                  
(b) The circuit can function as an oscillator producing an output sinusoid at 1000 rad/s.











Exercise 11-8



                    (a) Find the voltage transfer function
                    T
V
                    (
                    s
                    ) =
                    V
2
                    (
                    s
                    )/
                    V
1
                    (
                    s
                    ) of the circuit in
                    Figure 11-14
                    .
                    







FIGURE 11-14








(b) What are the conditions on µ that will ensure the circuit is stable?

Answers:


                    (a)
                    


                    (b) For a circuit to be stable all poles must be in the left-hand portion of the
                    s
                    -plane, hence µ must be less than 1.
                  





The Cascade Connection and the Chain Rule

              Signal-processing circuits often involve a
              cascade connection
              in which the output voltage of one circuit serves as the input to the next stage. In some cases, the overall voltage transfer function of the cascade can be related to the transfer functions ofthe individual stages by a
              chain rule




(11-11)





              where
              T
V1
              ,
              T
V2
              , ...,
              T
Vk
              are the voltage transfer functions of the individual stages when operated separately. It is important to understand when the chain rule applies since it greatly simplifies the analysis and design of cascade circuits.
            

              To illustrate the chain rule concept, consider the two-stage
              RC
              circuit in
              Figure 11-15
              . When disconnected and operated in isolation, the transfer function of each stage can be found using voltage division as
            








FIGURE 11-15




Two-port circuits connected in cascade.







              When connected in cascade, the output of the first stage serves as the input to the second stage.
              If the chain rule applies,
              we would obtain the overall transfer function as
            



(11-12)






              However, in
              Example 11-5
              , the overall transfer function of this circuit was found to be
            


(11-13)




              which disagrees with the chain rule result in
              Eq. (11-12)
              .
            

              The reason for the discrepancy is that when they are connected in cascade, the second circuit
              
loads

              the first circuit. That is, the voltage-divider rule requires that the interface current
              I
2
              (
              s
              ) in
              Figure 11-15
              be zero. The no-load condition
              I
2
              (
              s
              ) = 0 applies when the stages operate separately, but when connected in cascade, the interface current is not zero. The chain rule does not apply here because loading caused by the second stage changes the transfer function of the first stage.
            

              However,
              Figure 11-16
              shows how the loading problem goes away when an OP AMP voltage follower is inserted between the
              RC
              circuit stages. The follower does not draw any current from the first
              RC
              circuit [
              I
2
              (
              s
              ) =0 and applies
              V
2
              (
              s
              ) directly across the input of the second
              RC
              circuit. With this modification, the chain rule in
              Eq. (11-11)
              applies because the voltage follower isolates the two circuits, thereby solving the loading problem.
            








FIGURE 11-16




Cascade connection with voltage follower isolation.




              In the
              s
              domain,
              
loading

              causes the transfer function of a circuit to change when it drives the input of another circuit. In a cascade connection, loading does not occur at an interface if (1) the output (Thévenin) impedance of the driving stage is zero or (2) the input impedance of the driven stage is infinite. The voltage follower in
              Figure 11-16
              is an example of a stage that meets both criteria (1) and (2). In general, an inverting OP AMP stage meets criterion (1) but not criterion (2), while a voltage-divider stage meets neither criteria.
            
When analyzing or designing a cascade connection, it is important to recognize situations in which the chain rule applies. The next example illustrates this point.












                      EVALUATION EXAMPLE 11-7
                    

Figure 11-17
                      shows two cascade connections involving the same two stages but with their positions reversed. Do either of these connections involve loading? Find the transfer function of both connections. In which connection can the chain rule be used. Comment on the results.
                    




SOLUTION:



                  Both circuits involve a cascade connection of a voltage-divider stage and an inverting amplifier stage. The version in
                  Figure 11-17
                  (a) does not involve loading because the output impedance of the first stage is zero. Hence, connecting the second-stage voltage divider does not load the first stage and the chain rule applies. The transfer function of the inverting amplifier stage is
                  









FIGURE 11-17










The second stage is a voltage divider whose transfer function is



and the chain rule yields the overall transfer function as




                  The cascade connection in
                  Figure 11-17
                  (b) interchanges the positions of the two stages. The loading occurs in this case because the first stage is a voltage divider with a nonzero output (Thévenin) impedance of
                




and
                  the inverting amplifier in the second stage has a finite input impedance of
                



This results in a voltage transfer function of




                  which is not equal to
                  T
V1
                  (
                  s
                  ) ×
                  T
V2
                  (
                  s
                  ) since it includes an extra term in the denominator, namely,
                  R
3
C
1s
.
                  This extra term alters the location of the poles. The chain rule does not apply to this connection since the second stage loads the first stage.
                

                  The effects of loading might be more visible if numbers are used. Let us look at the transfer functions if
                  R
1
                  =
                  R
2
                  =
                  R
3
                  = 10 kΩ,
                  C
1
                  =10 µf and
                  C
2
                  = 1 µF. Using these element values, the transfer function for the circuit in
                  Figure 11-17
                  (a) is
                




                  For the circuit in
                  Figure 11-17
                  (b), the transfer function is
                




                  The locations of the poles are quite different for the two circuits. Avoiding unintentional loading is a sign of experienced circuit designers.
                  ■












                  Evaluation
                  Exercise 11-9


Figure 11-18
                  shows two cascade connections involving the same two stages but with their positions reversed. Does either of these connections involve loading? Find their voltage transfer functions and, if loading is present, determine the condition necessary to minimize the effect.
                








FIGURE 11-18









Answers:


Both circuits exhibit loading effects.




                  The voltage divider
                  
loads

                  the load; therefore, to minimize loading effects, select
                  R
                  ≪
                  R
L
                  .
                




                  The source resistance
                  
loads

                  the voltage divider; hence to minimize loading effects, select
                  R
                  ≫
                  R
S
                  .
                





11-3 Network Functions and Impulse Response

            The
            impulse response
            is the zero-state response of a circuit when the driving force is a unit impulse applied at
            t
            = 0. When the input signal is
            x
            (
            t
            ) = δ(
            t
            ), then
            X
            (
            s
            ) =$$ δ(
            t
            )} = 1 and the input-output relationship in
            Eq. (11-2)
            reduces to
          

Y
            (
            s
            ) =
            T
            (
            s
            ) x1 =
            T
            (
            s
            )
          

            The impulse response transform equals the network function, and we could treat
            T
            (
            s
            ) as if it is a signal transform. However, to avoid possible confusion between a network function (description of a circuit) and a transform (description of a signal), we denote
            
            the impulse response transform as
            H
            (
            s
            ) and use
            h
            (
            t
            ) to denote the corresponding waveform.
            
2

Figure 11-19
            shows this concept in a block diagram form. That is,
          








FIGURE 11-19




Block diagram of impulse response:
                (
                a
                )
                In the t domain.
                (
                b
                )
                In the
                s
                domain.






(11-14)





            When there are no repeated poles, the partial-fraction expansion of
            H
            (
            s
            ) is
          




            where
            p
1
            ,
            p
2
            , ...,
            p
N
            are the natural poles in the denominator of the transfer function
            T
            (
            s
            ). All of the poles of
            H
            (
            s
            ) are natural poles since the impulse excitation does not introduce any forced poles. The inverse transform gives the impulse response waveform as
          




            When the circuit is stable, all of the natural poles are in the left half plane and the impulse response waveform
            h
            (
            t
            ) decays to zero as
            t →
            ∞. A linear circuit whose impulse response ultimately returns to zero is said to be
            asymptotically stable.
            Asymptotic stability means that the impulse response has a finite time duration. That is, for every ε >0, there exists a finite time duration
            T
D
            such that |
            h
            (
            t
            )| < ε for all
            t
            >
            T
D
            .
          

            It is important to note that the impulse response
            h
            (
            t
            ) contains all the information needed to determine the circuit response to any other input. That is, since
            $$
            {
            h
            (
            t
            )} =
            H
            (
            s
            ) =
            T
            (
            s
            ), we can calculate the output
            y
            (
            t
            ) for any Laplace transformable input
            x
            (
            t
            ) as
          




            This expression, known as the
            convolution theorem,
            states that the impulse response can be used to relate the input and output of a linear circuit. Thus, the impulse response
            h
            (
            t
            ) or
            H
            (
            s
            ) can be considered as a mathematical model of a linear circuit. Obviously, it is important to be able to find the impulse response and to know how to use the impulse response to find the output for other inputs. The following examples illustrate both of these issues.
          











EXAMPLE 11-8


                    Find the response
                    υ
2
                    (
                    t
                    ) in
                    Figure 11-20
                    when the input is υ
                    1
                    (
                    t
                    ) = δ(
                    t
                    ). Use the element values R
                    1
                    =10 kΩ,
                    R
2
                    = 12.5kΩ, C
                    1
                    =1 µF, and C
                    2
                    =2 µF.
                  








FIGURE 11-20











SOLUTION:



                In
                Example 11-3
                , the transfer function of this circuit was found to be
              





                For the given element values, the impulse response transform is
              




                This
                H
                (
                s
                ) is not a proper rational function, so we use one step of a long division plus a partial-fraction expansion to obtain
              



and the impulse response is




                In this case, the impulse response contains an impulse because the network function is not a proper rational function. One can surmise that might happen since at
                t
                =0,
                C
1
                acts instantaneously as a short circuit connecting the impulse directly to the output.
                ■










Exercise 11-10

A certain circuit has the following voltage transfer function:




                Find the circuit's impulse response
                h
                (
                t
                ).
              


Answer:




















EXAMPLE 11-9


                    The impulse response of a linear circuit is
                    h
                    (
                    t
                    ) = 200e
                    -100

t
                      u
                    
                    (
                    t
                    ). Find the output when the input is a unit ramp
                    r
                    (
                    t
                    ) =
                    tu
                    (
                    t
                    ).
                  




SOLUTION:


The circuit impulse response transform is




                The Laplace transform of the unit ramp input is 1/
                s
2
                ; hence, using the convolution theorem, the response due to a ramp input is
              




                This example illustrates that the impulse response
                h
                (
                t
                ) contains all the information needed to calculate the response due to another input.
                ■











Exercise 11-11


                The impulse response of a circuit is
                h
                (
                t
                ) = 100e
                -20

t
                  u
                
                (
                t
                ). Find the output when the input is a step function
                x
                (
                t
                ) =
                u
                (
                t
                ).
              


Answer:















Exercise 11-12


                Find the impulse response of the circuit in
                Figure 11-21
                .
              








FIGURE 11-21









Answer:



h
                (
                t
                ) = 0.18(
                t
                ) +[90e
                
                  -100
                  t

                ]
                u
                (
                t
                )
              




11-4 Network Functions and Step Response

            The
            step response
            is the zero-state response of the circuit output when the driving force is a unit step function applied at
            t
            = 0. When the input is
            x
            (
            t
            ) =
            u
            (
            t
            ), then
            X
            (
            s
            ) =
            
            {
            u
            (
            t
            )}
            =
            1/
            s
            and the
            s
            -domain input-output relationship in
            Eq. (11-2)
            yields
            Y
            (
            s
            ) =
            T
            (
            s
            )/
            s
            . The step response transform and waveform will be denoted by
            G
            (
            s
            ) and
            g
            (
            t
            ), respectively. That is,
          



(11-15)





            The poles of
            G
            (
            s
            ) are the natural poles contributed by the network function
            T
            (
            s
            ) and a forced pole at
            s
            = 0 introduced by the step function input. The partial fraction expansion of
            G
            (
            s
            ) takes the form
          




            where
            p
1
            ,
            p
2
            ,
            p
N
            are the natural poles in
            T
            (
            s
            ). The inverse transformation gives the step response waveform as
          




            When the circuit is asymptotically stable, the natural response decays to zero, leaving a forced component called the
            dc steady-state response.
            The amplitude of the steady-state response is the residue in the partial-fraction expansion of the forced pole at
            s
            = 0. By the cover-up method, this residue is
          




            For a unit step input, the amplitude of the dc steady-state response equals the value of the transfer function at
            s
            = 0. By linearity, the general principle is that an input
            Au
            (
            t
            ) produces a dc steady-state output whose amplitude is
            AT
            (0).
          

            We next show the relationship between the impulse and step responses. First, combining
            Eqs. (11-14)
            and
            (11-15)
            gives
          





            The step response transform is the impulse response transform divided by
            s.
            The integration property of the Laplace transform tells us that division by
            s
            in the
            s
            domain corresponds to integration in the time domain. Therefore, in the time domain, we can relate the impulse and step response waveforms by integration:
          


(11-16)



Using the fundamental theorem of calculus, the impulse response waveform is expressed in terms of the step response waveform


(11-17)




            where the symbol (=) means equal almost everywhere, a condition that excludes those points at which
            g
            (
            t
            ) has a discontinuity. In the time domain, the step response waveform is the integral of the impulse response waveform. Conversely, the impulse response waveform is (almost everywhere) the derivative of the step response waveform.
          

            The key idea is that there are relationships between the network function
            T
            (
            s
            ) and the responses
            H
            (
            s
            ),
            h
            (
            t
            ),
            G
            (
            s
            ), and
            g
            (
            t
            ). If any one of these quantities is known, we can obtain any of the other four using relatively simple mathematical operations. A summary of these relationship is shown in
            Figure 11-22
            .
          








FIGURE 11-22




Relationships between step and impulse responses, and the transfer function in the t and s domains.









Exercise 11-13


                Given
                g
                (
                t
                ) =5(1 -
                e
-1000t
                )
                u
                (
                t
                ), find
                G
                (
                s
                ),
                H
                (
                s
                ),
                T
                (
                s
                ), and
                h
                (
                t
                ).
              
Answers:


















EXAMPLE 11-10


                    The element values for the circuit in
                    Figure 11-23
                    are
                    R
1
                    =10kΩ
                    ,R
2
                    = 100kΩ,
                    C
1
                    =
                    C
2
                    = 0.1 µF, and
                    υ
1
                    (
                    t
                    ) =
                    u
                    (
                    t
                    ) V. Find the response υ
                    2
                    (
                    t
                    ).
                  




SOLUTION:



                For a unit step input
                V
1
                (
                s
                ) = 1/s. In
                Example 11-4
                , the transfer function of this circuit is shown to be
              








FIGURE 11-23










Substituting the numerical element values into this expression yields the step response transform as





                The inverse transform yields
              




                In this case, the forced pole at
                s
                = 0 is canceled by a zero of
                T
V
                (
                s
                ) and the final value of the step response is zero. Using the final value theorem, we have
              




                the final steady-state value of the step response is equal to the value of the transfer function evaluated at
                s
                = 0. In the present case
                T
V
                (0) = 0, so the dc steady-state output of the circuit is zero. Recall from
                Chapter 6
                that in the dc steady state, capacitors can be replaced by open circuits. Replacing
                C
1
                in
                Figure 11-23
                by an open circuit disconnects the input source from the OP AMP, so no dc signals can be transferred through the circuit. A series capacitor that prevents the passage of dc signals is commonly called a
                blocking capacitor.
■











                Design
                Exercise 11-14

Design a circuit that will produce the following step response output:





Answer:


The transfer function of the desired circuit is




                A simple series
                RC
                circuit with the output taken across the capacitor will produce the desired response as long as the pole at -1/
                RC
                equals -1000 rad/s.
              

















EXAMPLE 11-11



                    For the circuit shown in
                    Figure 11-24
                    (a), find its transfer function, T(
                    s
                    ). Then find its step response,
                    g
                    (
                    t
                    )
                    .
                    Verify and visualize your answer using MATLAB's step function.
                  








FIGURE 11-24











SOLUTION:


We see that the circuit consists of a noninverting OP AMP followed by a voltage divider. The gain of the noninverter is




                The transfer function
                T
                (
                s
                ) is found by
                K
                times the voltage divider as follows
              





                The step response is given as
                G
                (
                s
                )
                H
                (
                s
                )/
                s,
                hence
              



Expanding by partial fractions



So that




                MATLAB has a function called
                step
                , which simplifies the calculation and plots the waveform once the transfer function
                H
                (
                s
                ) is known.
              

                s = tf('s')
                H = 1000/(s + 200);
                step(H)
                grid on
              

                MATLAB returns the graph shown in
                Figure 11-24
                (b).
              








FIGURE 11-24








■












Exercise 11-15

A particular circuit has the following voltage transfer function:




                Find the circuit's step response
                g
                (
                t
                ), impulse response
                h
                (
                t
                ), step response transform
                G
                (
                s
                ), and impulse response transform
                H
                (
                s
                ). Plot
                g
                (
                t
                ) using MATLAB.
              
Answers:











FIGURE 11-24


















                  APPLICATION
                  EXAMPLE 11-12



                Three time-domain parameters often used to describe the step response are rise time, delay time, and overshoot.
                
                  Rise time(
                  T
R
                  )
                
                is the time interval required for the step response to rise from 10% to 90% of its steady-state value
                g
                (∞).
                
                  Delay time(
                  T
D
                  )
                
                is the time interval required for the step response to reach 50% of its steady-state value.
                Overshoot
                is the difference between the peak value of the step response and its steady-state value. Overshoot is usually expressed as a percentage of the steady-state value, namely
              




Figure 11-25
                illustrates these descriptors for a typical step response.
              








FIGURE 11-25




Step response showing rise time
                    (
                    T
R
                    )
                    , delay time
                    (
                    T
D
                    ),
                    and overshoot.



Step response descriptors are used to specify the performance of both analog and digital systems. Rise time governs how rapidly the system responds to an abrupt change in the input. Delay time controls the time between the application of an abrupt change and the appearance of a significant change in the output. Overshoot indicates the amount of damping present in the system. Lightly damped oscillations produce large overshoots and may cause erroneous state changes in digital systems.

                Rise time, delay time, and overshoot can be determined experimentally or calculated using modern computer tools. How to use MATLAB to find these parameteres can be found in
                Appendix D
                .
              









Exercise 11-16


                The impulse response of a circuit is
                h
                (
                t
                ) = 8000(600
                t -
                1)
                e

                  -800
                  t

u
                (
                t
                ). Find and plot the step response. Find approximate values for the rise time, delay time, and overshoot.
              
Answers:

g
                (
                t
                ) = - 2.5[1 + (2400
                t
                -1)
                e

                  -800
                  t

                ]
                u
                (
                t
                )
              


T

R
                = 329 µs
              

T
D
                = 180 µs
              
Overshoot = 79%




11-5 Network Functions and Sinusoidal Steady-State Response

            When a stable, linear circuit is driven by a sinusoidal input, the output contains a steady-state component that is a sinusoid of the same frequency as the input. This section deals with using the circuit transfer function to find the amplitude and phase
            
            angle of the sinusoidal steady-state response. To begin, we write a general sinusoidal input in the form
          



(11-18)




which can be expanded as




            The waveforms cos
            t
            and sin
            t
            are basic signals whose transforms are given in
            Table 9-2
            as
            
            {cos ω
            t
            } =
            s
            /(
            s
2
            + ω
            2
            ) and
            
            {sin ω
            t
            } = ω/(
            s
2
            + ω
            2
            ). Therefore, the input transform is
          



(11-19)





Equation (11-19)
            is the Laplace transform of the general sinusoidal waveform in
            Eq. (11-18)
            .
          

            Using
            Eq. (11-2)
            and factoring the denominator, we obtain the response transform for a general sinusoidal input:
          



(11-20)





            The response transform contains forced poles at
            s
            = ±
            j
            ω because the input is a sinusoid. Expanding
            Eq. (11-20)
            by partial fractions,
          




            where
            p
1
            ,
            p
2
            ,
            p
N
            are the natural poles contributed by the transfer function
            T
            (
            s
            ). To obtain the response waveform, we perform the inverse transformation:
          




            When the circuit is stable, the natural response decays to zero, leaving a sinusoidal steady-state response due to the forced poles as
            s
            = ±
            j
            ω. The steady-state response is
          



where the subscript SS identifies a steady-state condition.

            To determine the amplitude and phase of the steady-state response, we must find the residue
            k.
            Using the cover-up method from
            Chapter 9
            , we find
            k
            to be
          





            The complex quantity
            T
            (
            j
            ω) can be written in magnitude and angle form as |
            T
            (
            j
            ω)|e
            
j
              θ
            
            . Using these results, the residue becomes
          



The inverse transform yields the steady-state response in the form



(11-21)





            In the development leading to
            Eq. (11-21)
            , we treat frequency as a general variable where the symbol ω represents all possible input frequencies. In some cases, the input frequency has a specific value, which we denote as a
            A
            . In this case, the input is written as
          




            To obtain the steady-state output, we evaluate the transfer function at the specific frequency (ω
            A
            ) of the input sinusoid, namely
          



and the steady-state output is expressed as



This result emphasizes three things about the steady-state response:


(11-22)




            The block diagram in
            Figure 11-26
            helps to clarify this result. The input
            x
            (
            t
            ) contributes the amplitude X
            A
            , the frequency ω
            A
            , and the phase ϕ to the steady-state output
            yss
            (
            t
            ). The linear circuit contributes a multiplier to the input amplitude and a phase shift. The multiplier is the magnitude of the transfer function |
            T
            (
            s
            )| evaluated at
            s - j
            ω
            A
            and shown as |
            T
            (
            j
            ω
            A
            )|. The phase shift is added to the input phase and is the phase of the transfer function 	∠
            T
            (
            s
            ) evaluated at
            s = j
            ω
            A
            and shown as ∠
            T
            (
            j
            ω
            A
            ).
          








FIGURE 11-26




Block diagram of sinusoidal steady-state response showing how the transfer function of the linear circuit T
                (
                s
                )
                affects the input sinusoidal signal to produce the output sinusoid.





            The next two examples illustrate sinusoidal steady-state response calculations. In the first example, frequency is treated as a general variable and we examine the steady-state response as frequency varies over a wide range. In the second example, we evaluate the steady-state response at two specific frequencies.
          












EXAMPLE 11-13


                    Find the steady-state output in
                    Figure 11-27
                    (a) for a general input
                    υ
1
                    (
                    t
                    ) =
                    V
A
                    cos(ω
                    t
                    + ϕ). Then for
                    L
                    = 1mH,
                    R
                    = 100Ω, and
                    υ
1
                    (
                    t
                    ) = 10 cos (100 k
                    t
                    + 135°) V, find
                    υ
2SS
                    (
                    t
                    ). Finally, use Multisim to verify your result.
                  








FIGURE 11-27











SOLUTION:



                In
                Example 11-2
                , the circuit transfer function is shown to be
              




                The magnitude and angle of
                T
                (
                j
                ω) are
              




                Using
                Eq. (11-21)
                , the sinusoidal steady-state output is
              




                Note that both the amplitude and phase angle of the steady-state response depend on the frequency of the input sinusoid. In particular, at ω = 0 the amplitude of the steady-state output reduces to
                V
A
                , which is the same as the amplitude of the input sinusoid. This makes sense because at dc the inductor in
                Figure 11-27
                (a) acts like a short circuit that directly connects the output port to the input port. t very high frequency, the amplitude of the steady-state output approaches zero. This also makes sense because at very high frequency the inductor acts like an open circuit that disconnects the output port from the input port. In between these two extremes, the output amplitude decreases as the frequency increases.
              
Substituting the values given into the general result found above yields




                To solve this problem using Multisim, we draw the circuit using the ac signal source, being careful to enter the frequency in hertz. We then perform a "Single Frequency AC Analysis." We ask Multisim to show the frequency and to display the results using magnitude and phase. Multisim returns the results shown in
                Figure 11-27
                (b). These results compare favorably with those calculated by hand.
                









FIGURE 11-27








■











Exercise 11-17


                Find the steady-state output in
                Figure 11-27
                (c) for a general input
                υ
1
(
t
                ) =
                V
A
                cos
                (
                ω
                t
                + ϕ
                )
                V.
              








FIGURE 11-27









Answer:






                The 180° is due to the inverting OP AMP. At dc, the capacitor is an open circuit and the OP AMP is operating as a simple inverter with gain of -
                R
2
                /
                R
1
                .As ω → ∞, the output approaches zero. This is an active, one-pole low-pass filter.
              
















EVALUATION EXAMPLE 11-14

A sensitive piece of electronic equipment is interfered with by a powerline caused 60 Hz hum. A manufacturer claims his simple circuit can effectively eliminate that noise. The manufacturer's specification sheet does not show what components make up the design, but rather, lists the transfer function as



and claims it will reduce the interfering signal by at least 300 times, that is attenuate it by more than 50 dB without any noticeable attenuation of signals as near as 58 and 62 Hz (less than 0.5 dB).
Test the manufacturer's assertion by calculating the sinusoidal steady-state output for five frequencies: 10, 58, 60, 62, and 100 Hz.




SOLUTION:



                We will proceed as follows. We will use a one volt sinusoid as the input signal,
                υ
1
                (
                t
                ) = 1 cos 2π
                ft
                V as our reference. We will evaluate the magnitude and phase of the transfer function
                T
V
                (
                j
                2π
                f
                ) at the five different frequencies. Then we will find the output υ
                2SS
                (
                t
                ) for each frequency and compute the effect of the circuit on the various frequencies.
              


For 10 Hz,










                The manufacturer's claim was correct. This type of filter is called a
                notch filter
                because it eliminates a very narrow range of frequencies, in this case the undesired 60 Hz hum.
                ■











                Evaluation
                Exercise 11-18


                The manufacturer of the device in
                Example 11-14
                wants a fairly high cost for the device. As a clever design engineer, you believe you can design and build a competing device for considerably less cost. You design your circuit using a simple
                RLC
                circuit and take the output across the
                LC
                elements.
                



                  (a) Find the transfer function for your device. You have a 1-H inductor available, hence select values of
                  R
                  and
                  C
                  to come as close as possible to the desired transfer function.
                
(b) Test your circuit design using Multisim.
(c) Compare your results with those of the manufacturer and comment on the results.

Answers:



                    (a)
                    




                    (b) See
                    Figure 11-28
                    .
                  








FIGURE 11-28










                    (c) The cost of three passive elements should significantly reduce the cost and operation of the device. However, only the inductor is a standard value. A standard capacitor of 6.8 µF would need to be placed in parallel with a 0.22-µF trimmer capacitor and adjusted to achieve the desired value. A 10-Ω2 trim pot would need to be similarly adjusted to attain the desired resistance. Achieving more than three significant figures with off-the-shelf devices is quite difficult. These would add some to the cost. Finally, and more important, comparing the performance of the two devices. The depth of the manufacturer's device is - 52.4 dB at exactly 60 Hz compared to - 42.1 dB for the
                    RLC
                    device at 59.9 Hz. A difference of 10 dB is significant in terms of the amount of attenuation provided. In addition, the
                    RLC
                    design's maximum attenuation occurs at 59.9 Hz, which misses the desired value of 60 Hz, so the attenuation at 60 Hz will be even less. The attenuation at the shoulders of the manufacturer's device is a bit less - 350 mdB versus -372/-360 mdB, but that is insignificant as are the differences in attenuation at 10 and 100 Hz. The question then, is it worth the cost savings to achieve more than 10 dB less attenuation?
                  

















EXAMPLE 11-15

The impulse response of a linear circuit is:





                      (a) Find the sinusoidal steady-state response when
                      x
                      (
                      t
                      ) = 5 cos 1000
                      t
                      .
                    

                      (b) Repeat (a) when
                      x
                      (
                      t
                      ) = 5 cos 3000
                      t
                      .
                    





SOLUTION:



                The transfer function corresponding to
                h(t)
                is
              






                    (a) At ω
                    A
                    = 1000 rad/s, the value of
                    T
                    (
                    j
                    ω
                    A
                    ) is
                  




                    and the steady-state response for
                    x
                    (
                    t
                    ) = 5 cos 1000
                    t
                    is
                  






                    (b) At ω
                    A
                    = 3000 rad/s, the value of
                    T
                    (
                    j
                    ω
                    A
                    ) is
                  




                    and the steady-state response for
                    x
                    (
                    t
                    ) = 5 cos 3000
                    t
                    is
                  




                    Again note that the amplitude and phase angle of the steady-state response depend on the input frequency.
                    ■













Exercise 11-19


                The transfer function of a linear circuit is
                T
                (
                s
                ) = 5(
                s
                + 100)/(
                s
                + 500). Find the steady-state output for
              


                  (a)
                  x
                  (
                  t
                  ) = 3 cos 100
                  t


                  (b)
                  x
                  (
                  t
                  ) = 2 sin 500
                  t



Answers:


                  (a) y
                  SS
                  (
                  t
                  ) =4.16 cos (100
                  t
                  + 33.7°)
                

                  (b) y
                  SS
                  (
                  t
                  ) =7.21 cos (500
                  t -
                  56.3°)
                











Exercise 11-20


                The impulse response of a linear circuit is
                h
                (
                t
                ) = δ(
                t
                ) -100 [
                
                  e
                  -


                  100
                  t

                ]
                u
                (
                t
                ). Find the steady-state output for
              


                  (a)
                  x
                  (
                  t
                  ) =25 cos 100
                  t


                  (b)
                  x
                  (
                  t
                  ) =50 sin 100
                  t


Answers:


                  (a) y
                  SS
                  (
                  t
                  ) =17.7 cos (100
                  t
                  + 45°)
                

                  (b) y
                  SS
                  (
                  t
                  ) =35.4cos(100
                  t -
                  45°)
                




Network Functions and Phasor Circuit Analysis
In this text, we present two methods of finding the sinusoidal steady-state response of a linear circuit. Both methods depend on the fact that in the steady state every voltage and current in a linear circuit is a sinusoid of the same frequency as the input sinusoid. As a result, every method of sinusoidal steady-state analysis boils down to finding the amplitude and phase angle of sinusoidal waveforms, all of which have the same frequency.

              The steady-state analysis method developed in this chapter involves first finding the network function
              T
              (
              s
              ) that relates an input and a particular output. We next form the complex quantity T(
              j
              ω) by replacing
              s
              by
              j
              ω, where ω is the frequency of the input sinusoid. The magnitude |
              T
              (
              j
              ω)| and angle ∠
              T
              (
              j
              ω) then give us the amplitude and phase angle of the steady-state output via
              Eq. (11-21)
              . Since
              T
              (
              j
              ω) is a function of ω, it can describe the steady-state response for a single frequency or whole range of frequencies.
            

              The steady-state analysis method developed in
              Chapter 8
              involves representing the amplitude and phase angles of a sinusoid by a complex number called a phasor. Although not strictly limited to a single frequency, phasor analysis works best when analyzing circuits driven by a single frequency. The network function method emphasizes the impedance
              Z
              (
              s
              ) of the individual two-terminal elements in the circuit. The element's phasor impedance
              Z
              (
              j
              ω) is found by replacing
              s
              by
              j
              ω, where ω is the frequency of the input sinusoid. When numerical values of the element impedances are given, the specific value of frequency is not required. When the element impedances are not given, the frequency must be given so we can compute the phasor impedances of the three passive elements. Whether using phasors or network analysis, the three passive elements are represented the same as:
            




              The advantage of the phasor method is that it uses familiar analysis tools like voltage or current division, series or parallel equivalence, source transformation, and mesh or node analysis to solve for the complex numbers (phasors) representing the voltages and currents in the circuit. The magnitude and angle of a phasor are
              
              the amplitude and phase angle of the corresponding sinusoidal steady-state response. Responses found using the phasor method are
              identical
              to those found using the network function method developed in this chapter.
            
Under what circumstances is one method better than the other?

              Phasor circuit analysis works best when the circuit is driven at a single frequency and we need to find several voltages and currents, or the average power, such as in the electric power systems studied in
              Chapter 16
              . The network function method works best when there is a single output and the circuit is driven at many different frequencies, such as in the frequency-response and filter applications studied in
              Chapters 12
              and
              14
              . The network function method is the only method available when we know the impulse or step response and need to infer the frequency response of a circuit from its time-domain response. Thus, the preferred method depends on how the circuit is driven (single or multiple frequencies), how much we know about the circuit (complete circuit diagram or only the impulse response), and what we need to find out (multiple responses or a single response). Understanding both methods and how they are applied is important to engineers working with electrical circuits.
            



11-6 Impulse Response and Convolution

            In signal processing, the term
            convolution
            refers to a process by which the impulse response of a linear system is used to determine the zero-state response due to other inputs. When the impulse response and input are given in the
            s
            domain as
            H
            (
            s
            ) and
            X
            (
            s
            ), the zero-state response is obtained from the inverse Laplace transform of their product.
          



(11-23)





            The purpose of this section is to introduce the notion that the convolution process can also be viewed and carried out entirely in the time domain. Specifically, given a causal impulse response
            h
            (
            t
            ) and a causal input
            x
            (
            t
            ), the zero-state response is obtained from the
            
              convolution integral
              
3






(11-24)





            where τ is a dummy variable of integration. The shorthand notation
            y
            (
            t
            ) =
            h
            (
            t
            )
            *x
            (
            t
            ) is used to represent the
            t
            -domain process, where the asterisk indicates a convolution integral, not a multiplication. That is, the expression
            h
            (
            t
            )
            *x
            (
            t
            ) reads "
            h
            (
            t
            ) convolved with
            x
            (
            t
            )," not "
            h
            (
            t
            ) times
            x
            (
            t
            )."
          

Figure 11-29
            indicates the parallelism between the input-output relationships in the
            s
            domain and
            t
            domain. In the
            s
            domain, the impulse response
            H
            (
            s
            ) multiplies the input transform to produce the output transform. In the
            t
            domain, the impulse response
            h
            (
            t
            ) is convolved with the input waveform to produce the output waveform.
          








FIGURE 11-29




Input-output relationships in the t domain and the s domain.




            The following example illustrates that the same result is achieved whether convolution is carried out in the
            s
            domain or the
            t
            domain.
          













EXAMPLE 11-16



                    A linear circuit has an impulse response
                    h
                    (
                    t
                    ) = 2e
                    
                      -
                      t

u
                    (
                    t
                    ) and an input
                    x
                    (
                    t
                    ) =
                    e

                      -2
                      t

u
                    (
                    t
                    ). Find the zero-state response using
                  


                      (a) The
                      s
                      -domain process in
                      Eq. (11-23)
                      .
                    

                      (b) The
                      t
                      -domain convolution integral in
                      Eq. (11-24)
                      .
                    





SOLUTION:





                    (a) Converting
                    h
                    (
                    t
                    ) and
                    x
                    (
                    t
                    ) into the
                    s
                    domain yields
                  




                    Applying
                    Eq. (11-23)
                    produces
                    y
                    (
                    t
                    ) as
                  






                    (b) Meanwhile, back in the
                    t
                    domain the convolution integral in
                    Eq. (11-24)
                    yields
                  




                    The two methods produce the same result. The difference is that the convolution integral evaluation is carried out entirely in the time domain.
                    ■


















EXAMPLE 11-17


                    A linear circuit has an impulse response
                    h
                    (
                    t
                    ) =
                    e

                      -100
                      t

u
                    (
                    t
                    ) and an input
                    x
                    (
                    t
                    ) =
                    tu
                    (
                    t
                    ).
                  


                      (a) Find the zero-state response using the
                      t
                      -domain convolution integral.
                    

                      (b) Validate your answer using both the
                      s
                      -domain process and MATLAB.
                    
(c) Which method was the easier to use?





SOLUTION:




(a) Using the convolution integral for this problem yields







                    (b) Using the
                    s
                    -domain process, we first convert
                    h
                    (
                    t
                    ) and
                    x
                    (
                    t
                    ) into the
                    s
                    domain as follows:
                  




                    The following MATLAB program can be used to validate the
                    s
                    -domain process
                  

                    clear all
                    syms t s
                    h = exp(-100*t);
                    x = t;
                    H =laplace (h);
                    X = laplace (x);
                    Y = H*X;
                    y = ilaplace(Y)
                  
This produces the following result that is the same as that found by hand

                    y = t/100 + exp(-100*t)/10000-1/10000
                  



                    (c) While in
                    Example 11-16
                    , it appeared that the s-domain process was easier; it is not always the case, as this example shows.
                    ■












Exercise 11-21


                A linear circuit has an impulse response
                h
                (
                t
                ) =
                e

                  -10
                  t

u
                (
                t
                ) and an input
                x
                (
                t
                )
                = 5u
                (
                t
                ). Find the zero-state response using the
                t
                -domain convolution integral.
              


Answer:









              Equivalence of
              s
              -Domain and
              t
              -Domain Convolution
            

              The approach used here starts out in the
              s
              domain with
              Y
              (
              s
              ) =
              H
              (
              s
              )
              X
              (
              s
              ) and proceeds to show that
              y
              (
              t
              ) =
              h
              (
              t
              )
              * x
              (
              t
              ). By beginning in the
              s
              domain we are assuming that the waveforms are causal. The
              s
              -domain input-output relationship can be written as
            




              where the bracketed term is the integral definition of
              
              {
              x
              (
              t
              )}. The impulse response can be moved inside the integration since
              H
              (
              s
              ) does not depend on the dummy variable τ.
            



(11-25)






              Using the time translation property from
              Chapter 9
              and the integral definition of the Laplace transformation, the bracketed term can be written as
            




              When the last line in this result replaces the bracketed term in
              Eq. (11-25)
              , we obtain
            



Interchanging the order of integration produces




              The inner integration is now carried out with respect to the dummy variable τ. The upper limit on this integration need only extend to τ =
              t
              (rather than infinity) since
              u
              (
              t -
              τ) = 0 for τ >
              t
              . By definition, the outer integration (now with respect to
              t
              ) yields the Laplace transform of the quantity inside the bracket. In other words, this equation is equivalent to the statement
            



So finally we have




              which establishes the equivalence of
              Eqs. (11-23)
              and
              (11-24)
              . It is important to remember that this equivalence applies only to causal waveforms.
            











EXAMPLE 11-18


                      Use time-domain and
                      s
                      -domain convolution to find the zero-state response when
                    







SOLUTION:



                  Using the convolution integral in
                  Eq. (11-24)
                  produces
                




                  Using
                  s
                  -domain convolution, we have
                  H
                  (
                  s
                  ) =
                  X
                  (
                  s
                  ) = 2/(
                  s
                  + 1; hence,
                




                  which yields
                  
■







              Graphical Approach to Convolution
            
In addition to the strictly mathematical approach to evaluating the convolution integral, there is a geometric or graphical interpretation of convolution. The geometric approach offers another perspective, which may provide us with additional insight into the process or help us proceed in situations that are more complicated.

              Consider the following. A linear circuit has an impulse response
              h
              (
              t
              )=2e
              
                -
                t

u
              (
              t
              ). Use a graphical approach to find the zero-state response when an input
              x
              (
              t
              ) =
              tu
              (
              t
              ) is applied to the circuit.
            

              A direct application of
              Eq. (11-24)
              for comparison produces the following:
            



Graphically, we approach the convolution as follows:

Figure 11-30
              shows a geometric interpretation of the convolution. In
              Figure 11-30
              (a) and (b), the input and impulse response waveforms are plotted against the dummy variable τ. Forming h(-τ)
              reflects
              the impulse response across the τ = 0 axis, as shown in
              Figure 11-30
              (c). Forming
              h
              (
              t -
              τ)
              shifts
              the reflected impulse response to the right by
              t
              seconds, as shown in
              Figure 11-30
              (d).
              Multiplying
              the reflected/shifted impulse response by the input produces the product
              h
              (
              t -
              τ) ×
              x
              (τ), shown in
              Figure 11-30
              (e). The
              integrating
              from τ = 0 to τ =
              t
              yields the area under this product, which is the value of the zero-state output at time
              t.
              At a later instant of time, the reflected impulse response
              h
              (
              t -
              τ) shifts farther to the right, creating a new product
              h
              (
              t -
              τ) ×
              x
              (τ) with a new area and a new value of
              y
              (
              t
              ).
            

              Thus, the geometric interpretation of
              t
              -domain convolution involves four operations: reflecting, shifting, multiplying, and integrating. We visualize convolution as a process that reflects the impulse response across the origin and then progressively shifts it to the right as
              t
              increases. At any time
              t,
              the output is the area under the product of the reflected/shifted impulse response and the input. Under this interpretation we can think of the impulse response as a weighting function. That is, when integrating the product
              h
              (
              t -
              τ)
              × x
              (τ), the impulse response tells us how much weight to assign to previous values of the input.
            








FIGURE 11-30




Graphical interpretation of convolution.
















EXAMPLE 11-19



                      A certain circuit has an impulse response
                      h
                      (
                      t
                      )
                      =
                      [2
                      e

                        -
                        t

                      ]
                      u
                      (
                      t
                      ). Graphically use the convolution integral to find the zero-state response for
                      x
                      (
                      t
                      ) -5[
                      u
                      (
                      t
                      )-
                      u
                      (
                      t -
                      2)].
                    




SOLUTION:



                  Evaluation of the convolution integral can be divided into the three situations shown in
                  Figure 11-31
                  . The situation for
                  t
                  < 0 is shown in
                  Figure 11-31
                  (a). For this case the reflected impulse response
                  h
                  (
                  t -
                  τ) and the input
                  x
                  (τ) do not overlap so the area under their product is zero. Hence
                  y
                  (
                  t
                  )
                  =
                  0 for
                  t
                  < 0. This simply says that the zero-state response is causal when the impulse response and input are causal.
                

                  For 0 <
                  t
                  < 2, the reflected impulse response and input overlap as shown in
                  Figure 11-31
                  (b). In this situation, the area under the product
                  h
                  (
                  t -
                  τ) ×
                  x
                  (τ) is found by integrating τ = 0 to τ =
                  t
                  .
                











FIGURE 11-31








                  For
                  t
                  > 2, the reflected impulse response and input overlap as shown in
                  Figure 11-31
                  (c). In this case, the product
                  h
                  (
                  t -
                  τ)
                  × x
                  (τ) is confined to the interval 0< τ < 2 since the input
                  x
                  (τ) is zero everywhere outside of this interval. In this situation, the area under the product is found by integrating from τ = 0 and τ =2.
                




                  Evaluation of the convolution integral was guided by the geometric interpretation in
                  Figure 11-31
                  and leads to a zero-state response defined on three intervals.
                




■











Exercise 11-22


                  Repeat
                  Example 11-19
                  by mathematically, not geometrically, computing the convolution integral. Verify that the result is equivalent to the answer found for
                  Example 11-19
                  . You may use MATLAB.
                


Answer:



y
                  (
                  t
                  ) =10[1-
                  
                    e
                    -t

                  ]
                  u
                  (
                  t
                  ) - 10[1 - e
                  -(t - 2)
                  ]
                  u
                  (
                  t
                  - 2. The result is equivalent to the answer in
                  Example 11-19
                  .
                





Applications of the Convolution Integral

              Given that
              s
              -domain and
              t
              -domain convolutions are equivalent, why study both methods? The best answer the authors can give at this point will have an "eat your spinach" ring to it. Suffice it to say that in subsequent courses you will encounter signals for which Laplace transforms do not exist; hence, only the
              t
              -domain method convolution is possible. Examples of such application are the noncausal waveforms used in communication systems and the discrete-time signals used in digital signal processing. We cannot treat such applications here, but rather only introduce the student to the concept of viewing convolution as a
              t
              -domain process and its equivalence in the
              s
              domain.
            



11-7 Network Function Design and Evaluation

            Finding and using a network function of a given circuit is an
            s
            -domain
            analysis
            problem. An
            s
            -domain
            synthesis
            problem involves finding a circuit that realizes a given network function. For linear circuits, an analysis problem always has a unique solution. In contrast, a synthesis problem may have many solutions because different circuits can have the same network function. A transfer function design problem involves synthesizing several circuits that realize a given function and evaluating the alternative designs, using criteria such as input or output impedance, cost, and power consumption.
          

            The design process discussed here begins with a given transfer function
            T
v
            (
            s
            ). We partition this transfer function into a product of simpler functions.
          




            We then realize or design each of these simpler functions using basic circuit modules such as voltage dividers, inverting amplifiers, and noninverting amplifiers. The overall transfer function is then achieved by connecting the individual stages in cascade, as indicated in
            Figure 11-32
            .
          








FIGURE 11-32




Cascade connection transfer functions.



Of course, this approach assumes that the chain rule applies. In other words, we must avoid loading when designing the stages in the cascade realization. This is accomplished by coordinating the input and output impedances of adjacent stages or using OP AMP voltage followers to isolate the individual stages.
Before turning to examples, we discuss the design of simple one-pole modules that serve as the building block stages in a cascade design.

Prototypes

              In the next several sections, we will develop basic building blocks that will enable us to design simple circuits and then cascade them together to achieve more complex functions. These building blocks are first achieved using impractical element values and are thus called
              prototypes.
              Merriam Webster defines a prototype
              as an original model on which something is patterned.
              Once we become comfortable designing the basic building-block functions, we will learn how to scale the prototypes so we can build them using practical component values.
            



First-order Voltage-divider Circuit Design

              We begin our study of transfer function design by developing a voltage-divider realization of a first-order transfer function of the form
              K
              /(
              s
              + α). The impedances
              Z
1
              (
              s
              ) and
              Z
2
              (
              s
              ) are related to the given transfer function using the voltage-divider relationship.
            



(11-26)





              To obtain a circuit realization, we must assign part of the given
              T
V
              (
              s
              ) to
              Z
2
              (
              s
              ) and the remainder to
              Z
1
              (
              s
              ). There are many possible realizations of
              Z
1
              (
              s
              ) and
              Z
2
              (
              s
              ) because there is no unique way to make this assignment. For example, simply equating the numerators and denominators in
              Eq. (11-26)
              yields
            


(11-27)




              Inspecting this result, we see that
              Z
2
              (
              s
              ) is realizable as a resistance (
              R
2
              =
              K
              Ω) and
              Z
1
              (
              s
              ) as an inductance (
              L
1
              = 1 H) in series with a resistance [
              R
1
              = (α -
              K
              ) Ω]. The resulting circuit diagram is shown in
              Figure 11-33
              (a). For
              K= α
              the resistance
              R
1
              can be replaced by a short circuit because its resistance is zero. A gain restriction
              K ≤
              α is necessary because a negative
              R
1
              is not physically realizable as a single component.
            








FIGURE 11-33





                    (
                    a and b
                    )
                    Circuit realizations of T
                    (
                    s
                    )
                    =
K
                    /(
                    s
+ α
                    )
                    for K ≤
α.





              An alternative synthesis approach involves factoring
              s
              out of the denominator of the given transfer function. In this case,
              Eq. (11-26)
              is rewritten in the form
            


(11-28)



Equating numerators and denominators yields the branch impedances


(11-29)




              In this case, we see that
              Z
2
              (
              s
              ) is realizable as a capacitance (
              C
2
              = 1/
              K
              F) and
              Z
1
              (
              s
              ) as a resistance (
              R
1
              =1 Ω) in series with a capacitance [
              C
1
              = 1/ (α -
              K
              ) F]. The resulting circuit diagram is shown in
              Figure 11-33
              (b). For
              K= α
              , the capacitance
              C
1
              can be replaced by a short circuit because its capacitance is infinite. A gain restriction K ≤ α is required to keep
              C
1
              from being negative.
            

              As a second design example, consider a voltage-divider realization of the transfer function
              Ks
              /(
              s
              + α). We can find two voltage-divider realizations by writing the specified transfer function in the following two ways:
            



(11-30a)







(11-30b)





Equation (11-30a)
              uses the transfer function as given, while
              Eq. (11-30b)
              factors
              s
              out of the numerator and denominator. Equating the numerators and denominators in
              Eq. (11-30a)
              and (11-30b) yields two possible impedance assignments:
            



(11-31a)







(11-31b)





              The assignment in
              Eq. (11-31a)
              yields
              Z
2
              (
              s
              ) as an inductance
              L
2
              =
              K
              H and
              Z
1
              (
              s
              ) as an inductance [
              L
1
              = (1 -
              K
              ) H in series with a resistance (
              R
1
              = αΩ). The assignment in
              Eq. (11-31b)
              yields
              Z
2
              (
              s
              ) as a resistance (
              R
2
              =
              K
              Ω) and
              Z
1
              (
              s
              ) as a resistance
              
              [
              R
1
              = (1 -
              K
              )Ω] in series with a capacitance (
              C
1
=
              1/
              α
              F). The two realizations are shown in
              Figure 11-34
              . Both realizations require
              K
              < 1 for the branch impedances to be realizable and both simplify when
              K
              =1.
            








FIGURE 11-34




Circuit realizations of T
                  (
                  s
                  ) =
                  Ks
                  / (
                  s
                  + α
                  )
for K ≤
                  1.
                









                  Design
                  Exercise 11-23


                  Design an
                  RC
                  prototype circuit to realize the following transfer function
                





Answer:



                  Use the circuit of
                  Figure 11-33
                  (b) with
                  R
                  = 1Ω,
                  C
1
                  = 1250 µF, and
                  C
2
                  = 5000 µF.
                











                  Design
                  Exercise 11-24


                  Design a prototype
                  RL
                  circuit to realize the following transfer function:
                





Answer:



                  Use the circuit of
                  Figure 11-33
                  (a) with
                  R
2
                  = 200 Ω,
                  L
                  = 1 H, and R
                  1
                  = 800 Ω.
                










                  Design
                  Exercise 11-25


                  Design an
                  RC
                  prototype circuit to realize the following transfer function
                





Answer:



                  Use the circuit of
                  Figure 11-34
                  (b) with
                  R
2
                  = 0.1 Ω,
                  R
1
                  = 0.9 Ω and
                  C
                  = 100 µF.
                




Voltage-divider and OP AMP Cascade Circuit Design

              The examples in
              Figures 11-33
              and
              11-34
              illustrate an important feature of voltage-divider realizations. In general, we can write a transfer function as a quotient of polynomials
              T
              (
              s
              ) =
              r
              (
              s
              )/
              q
              (
              s
              ). A voltage-divider realization requires the impedances Z
              2
              (
              s
              ) =
              r
              (
              s
              ) and
              Z
1
              (
              s
              ) =
              q
              [
              s
              )
              - r
              (
              s
              ) to be physically realizable. A voltage-divider circuit usually places limitations on the gain
              K.
              This gain limitation can be overcome by using an OP AMP circuit in cascade with the divider circuit.
            

              For example, a voltage-divider realization of the transfer function in
              Eq. (11-26)
              requires
              K ≤
              α. When
              K
              > α, then
              T
              (
              s
              ) is not realizable as a simple voltage divider, since
              Z
2
              (
              s
              ) =
              s
              + α -
              K
              requires a negative resistance. However, the given transfer function can be written as a two-stage product:
            




              When
              K > α
              , the first stage has a positive gain greater than unity. This stage can be realized using a noninverting OP AMP circuit with a gain of (
              R
1
+ R
2
              )/
              R
1
              . The firststage design constraint is
            





              Choosing
              R
1
              =1 Ω requires that
              R
2
              = (K/α) -1. An
              RC
              voltage-divider realization of the second stage is obtained by factoring an
              s
              out of the stage transfer function. This leads to the second-stage design constraint
            




              Equating numerators and denominators yields
              Z
2
              (
              s
              ) - α/
              s
              and
              Z
1
              (
              s
              )
              =
              1.
              Figure 11-35
              shows a cascade connection of a noninverting first stage and the
              RC
              divider second stage. The chain rule applies to this circuit, since the first stage has an OP AMP output. The cascade circuit in
              Figure 11-35
              realizes the first-order transfer function
              K
              /(
              s
              + α) for
              K
              > α, a gain requirement that cannot be met by the divider circuit alone.
            








FIGURE 11-35




Circuit realization of T
V
                  (
                  s
                  ) =
                  K
                  /(
                  s
                  + α
                  for K
                  > α.
                










Design Exercise 11-26



                  Design an active
                  RC
                  prototype circuit to realize the following transfer function
                





Answer:



                  Use the circuit shown in
                  Figure 11-35
                  . The OP AMP stage has a gain of 2 by making both resistors equal. Choose the components in the second stage voltage divider so that
                  R
                  = 1 Ω and
                  C
                  = 1000 µF.
                











                  Design
                  Exercise 11-27


                  Design a prototype active
                  RL
                  circuit to realize the following transfer function
                





Answer:



                  Use the circuit shown in
                  Figure 11-35
                  . The OP AMP stage has a gain of 2 by making both resistors equal. In the second stage, replace the resistor with an inductor and replace the capacitor with a resistor. Let the components in the second stage voltage divider be
                  R
                  = 1 kΩ and
                  L
                  = 1 H.
                
















DESIGN EXAMPLE 11-20

Design a circuit to realize the following transfer function using only resistors, capacitors, and OP AMPs:







SOLUTION:


The given transfer function can be written as a three-stage product.





                  where the stage gains
                  K
1
, K
2
                  , and
                  K
3
                  have yet to be selected. Factoring
                  s
                  out of the denominator of the first-stage transfer function leads to an
                  RC
                  divider realization:
                



Equating numerators and denominators yields




                  The first stage
                  Z
1
                  (
                  s
                  ) is simpler when we select
                  K
1
                  = 1000. Factoring
                  s
                  out of the denominator of the third-stage transfer function leads to an
                  RC
                  divider realization:
                



Equating numerators and denominators yields




                  The third stage
                  Z
1
                  (
                  s
                  ) is simpler when we select
                  K
3
                  = 1. The stage gains must meet the constraint
                  K
1
× K
2
× K
3
                  = 3000 since the overall gain of the given transfer function is 3000. We have selected
                  K
1
                  = 1000 and
                  K
3
                  = 1, which requires
                  K
2
                  = 3. The second stage must have a positive gain greater than 1 and can be realized using a noninverting amplifier with
                  K
2
                  = (
                  R
1
+ R
2
                  )/
                  R
1
                  = 3. Selecting
                  R
1
                  =1Ω requires that
                  R
2
                  =2Ω.
                

Figure 11-36
                  shows the three stages connected in cascade. The chain rule applies to this cascade connection because the OP AMP in the second stage isolates the
                  RC
                  voltage-divider circuits in the first and third stages. The order of the first and third stages can be swapped in this design without consequence.
                  
Caution
                    :
                  
                  The OP AMP stage must separate the two voltage divider circuits, otherwise loading will change the transfer function. The circuit in
                  Figure 11-36
                  realizes the given transfer function but is not a realistic design because the values of resistance and capacitance are impractical. We will shortly discuss how to scale a prototype to obtain practical element values.
                








FIGURE 11-36








■












                  Design
                  Exercise 11-28

Design a circuit to realize the following transfer function using only resistors, capacitors, and no more than one OP AMP.





Answer:



Figure 11-37
                  shows one possible prototypical solution.
                








FIGURE 11-37











Inverting OP AMP circuit design
The inverting OP AMP circuit places fewer restrictions on the form of the desired transfer function than does the basic voltage divider. To illustrate this, we will develop two inverting OP AMP designs for a general first-order transfer function of the form





              The general transfer function of the inverting OP AMP circuit is -
              Z
2
              (
              s
              )/
              Z
1
              (
              s
              ), which leads to the general design constraint
            



(11-32)





              The first design is obtained by equating the numerators and denominators in
              Eq. (11-32)
              to obtain the OP AMP circuit impedances as
              Z
2
              (
              s
              ) =
              K
s
              +
              K
γ
              and
              Z
1
              (
              s
              ) =
              s
              + α. Both of these impedances are of the form
              Ls
              +
              R
              and can be realized by an inductance in series with a resistance, leading to the design realization in
              Figure 11-38
              (a).
            








FIGURE 11-38




Inverting OP AMP circuit realizations of T
                  (
                  s
                  )
                  =
                  -
                  K
                  (
                  s
                  + γ)/(
                  s
                  + α).
                



              A second inverting OP AMP realization is obtained by equating
              Z
2
              (
              s
              ) in
              Eq. (11-32)
              to the reciprocal of the denominator and equating
              Z
1
              (
              s
              ) to the reciprocal of the numerator. This assignment yields the impedances
              Z
1
              (
              s
              )
              =
              1/(
              K
s
              +
              K
γ
              ) and
              Z
2
              (
              s
              )
              =
              1/(
              s
              +
              α
              ). Both of these impedances are of the form 1/(
              C
s
              +
              G
              ), where
              Cs
              is the admittance of a capacitor and
              G
              the admittance of a resistor. Both impedances can be realized by a capacitance in parallel with a resistance. These impedance identifications produce the
              RC
              circuit in
              Figure 11-38
              (b).
            

              Because it has fewer restrictions, it is often easier to realize transfer functions using the inverting OP AMP circuit. To use inverting circuits, the given transfer function must require an inversion or be realized using an even number of inverting stages. In some cases, the sign in front of the transfer function is immaterial and the required transfer function is specified as ±
              T
V
              (
              s
              ).
              

Caution
                  :
                

              The input impedance of an inverting OP AMP circuit may load the source circuit.
            







                  Design
                  Exercise 11-29


                  Design an active
                  RC
                  prototype circuit to realize the following transfer function
                





Answer:



                  See
                  Figure 11-39
                  .
                








FIGURE 11-39






















                      DESIGN EXAMPLE 11-21
                    

                      Design a circuit to realize the transfer function given in
                      Example 11-20
                      using inverting OP AMP circuits.
                    




SOLUTION:


The given transfer function can be expressed as the product of two inverting transfer functions:





                  where the stage gains
                  K
1
                  and
                  K
2
                  have yet to be selected. The first stage can be realized in an inverting OP AMP circuit since
                




                  Equating the
                  Z
2
                  (
                  s
                  ) to the reciprocal of the denominator and
                  Z
1
                  (
                  s
                  ) to the reciprocal of the numerator yields
                




                  The impedance
                  Z
2
                  (
                  s
                  ) is realizable as a capacitance (
                  C
2
                  = 11000 F) in parallel with a resistance (
                  R
2
                  = 1Ω) and
                  Z
1
                  (
                  s
                  ) as a resistance (
                  R
1
                  = 1000/
                  K
1
                  Ω). We select
                  K
1
                  = 1000 so that the two resistances in the first stage are equal. Since the overall gain requires
                  K
1
× K
2
                  = 3000, this means that
                  K
2
                  = 3. The second-stage transfer function can also be produced using an inverting OP AMP circuit:
                




                  Equating numerators and denominators yields
                  Z
2
                  (
                  s
                  ) =
                  R
2
                  = 3 and
                  Z
1
                  (
                  s
                  ) =
                  R
1
                  + 1/
                  C
1
s
                  = 1 + 4000/
                  s
                  .
                

Figure 11-40
                  shows the cascade connection of the
                  RC
                  OP AMP circuits that realize each stage. The overall transfer function is noninverting because the cascade uses an even number of inverting stages. The chain rule applies here since the first stage has an OP AMP output. The circuit in
                  Figure 11-40
                  is a prototype design because the values of resistance and capacitance are impractical.
                








FIGURE 11-40








■












                  Design
                  Exercise 11-30

Design a circuit to realize the following transfer function using only resistors, capacitors, and no more than one OP AMP.





Answer:



Figure 11-41
                  shows one possible prototypical solution.
                








FIGURE 11-41











Magnitude Scaling

              The circuits designed thus far in this section have been prototypical designs.
              Proto
              hails from an early Greek word meaning "first," hence a prototype is the first realization of a design. The methods studied thus far usually yield element values that are outside of practical ranges. The allowable ranges depend on the fabrication technology used to construct the circuits and their eventual application. Monolithic
              integrated circuit (IC)
              technology has evolved rapidly. Today a billion or more devices can be manufactured on a die using 65-nm technology. Individual transistors are increasingly small and are approaching atomic size. But on-chip capacitors take up a lot of costly wafer space. Today on-wafer capacitors, generally of the parallelplate variety, are rated in fF/µm
              2
              - say from 0.2 fF to maybe 7 fF. Inductors are usually designed as spirals on ICs and take up even more real estate. Also, they are of low inductance value of about 1 nH to 300 nH and have relatively high ohmic losses. Therefore, they are almost never used on ICs, but one place where they are used is in RF circuits, such as in cell phones. OP AMP circuits of the type studied in this
              
              text should have a feedback resistance
              R
F
              ≥ 1 kΩ to keep the output current demand within the capabilities of general-purpose OP AMP devices and
              R
F
              ≤ 10 MΩ so that the feedback current is not so small as to be interfered by electromagnetic noise. Other technologies and applications place different constraints on element values. For example, home appliances, industrial applications, and the power industry, where physical size and weight are of less importance, use devices with much larger values than the electronics industry.
            

              There are no hard and fast rules here, but, roughly speaking, an electronic circuit is probably realizable by some means if its passive element values fall in the ranges shown in the tables on the
              Appendix G
              , with the caveat that OP AMP circuits generally use
              R
S
              ≥ 1 kΩ to reduce the effects of loading on the input source (assuming that it is not connected to the output of another OP AMP) and so not to source so much current as to damage the OP AMP.
            
These are as follows:


                Capacitors
                
4

                : 1 pF to 10,000
              

                Inductors
                
5

                : 10 nH to 100 mH
              

                Resistors
                
6

                :10 Q to 10 MΩ.
              


              The important idea here is that circuit designs such as
              Figure 11-40
              are impractical because 1-Ω resistors are too small for OP AMP circuits and 1-mF capacitors are too large physically and expensive. Large inductors, greater than 100 mH, often called
              chokes,
              are weighty and have a large series parasitic resistance that should be considered. As a final note in building circuits in the laboratory, one should take into account the ultimate application of the circuit.
            

              It is often possible to scale the magnitude of circuit impedances so that the element values fall into practical ranges. The key is to scale the element values in a way that does not change the transfer function of the circuit. Multiplying the numerator and denominator of the transfer function of a voltage-divider circuit by a scale factor
              k
m
              yields
            


(11-33)




              Clearly, this modification does not change the transfer function but scales each impedance by a factor of
              k

m

              and changes the element values in the following way:
            


(11-34)



Equation (11-34) was derived using the transfer function of a voltage-divider circuit. It is easy to show that we would reach the same conclusion if we had used the transfer functions of inverting or noninverting OP AMP circuits.

              In general, a circuit is magnitude scaled by multiplying all resistances, multiplying all inductances, and dividing all capacitances by a scale factor
              k
m
              . The scale factor must be positive but can be greater than or less than 1.
              
Different scale factors can be used for each stage of a cascade design, but only one scale factor can be used for each stage.

              These scaling operations do not change the voltage transfer function realized by the circuit.
            

              Our design strategy is first to create a prototype circuit whose element values may be unrealistically large or small. Applying magnitude scaling to the prototype
              
              produces a design with practical element values. Sometimes, there may be no scale factor that brings the prototype element values into a practical range. When this happens, we must seek alternative realizations because the scaling process is telling us that the prototype is not a viable candidate.
            



Caution:


              Simulation software such as Multisim provides no warning that impractical element values are specified, especially if ideal OP AMP models are used in the simulation. The results appear fine, but actually building the design in a laboratory (even if those values are available) could present a challenge.
            











EXAMPLE 11-22


                      Magnitude scale the circuit in
                      Figure 11-40
                      so all resistances are at least 10 kΩ and all capacitances are less than 1 μF.
                    








FIGURE 11-42











SOLUTION:



                  The resistance constraint requires
                  k
m
R ≥
                  10
                  4
                  Ω. The smallest resistance in the prototype circuit is 1 Ω; therefore, the resistance constraint requires
                  k
m
≥
                  10
                  4
                  . The capacitance constraint requires
                  C
                  /
                  k
m
≤
                  10
                  -6
                  F. The largest capacitance in the prototype is 10
                  -3
                  F; therefore, the capacitance constraint requires
                  k
m
≥
                  10
                  3
                  . The resistance condition on
                  k
m
                  dominates the two constraints. Selecting
                  k
m
                  = 10
                  4
                  produces the scaled design in
                  Figure 11-42
                  . This circuit realizes the same transfer function as the prototype in
                  Figure 11-40
                  but uses practical element values.
                  ■










Exercise 11-31


                  Select a magnitude scale factor for each stage in
                  Figure 11-36
                  so that both capacitances are 0.01 µF and all resistances are greater than 10 kΩ.
                


Answer:



k
m
                  = 10
                  5
                  for the first stage;
                  k
m
                  = 10
                  4
                  for the second stage;
                  k
m
                  = 0.25 × 10
                  5
                  for the third stage.
                










Exercise 11-32


                  Select a magnitude scale factor for the OP AMP circuit in
                  Figure 11-39
                  .
                


Answer:



k
m
                  = 10
                  8
                  , any larger and the feedback resistor becomes too large, any smaller and the input capacitor becomes too large.
                




Second-order Circuit Design

              An
              RLC
              voltage divider can also be used to realize second-order transfer functions. For example, the transfer function
            




              can be realized by factoring
              s
              out of the denominator and equating the result to the voltage-divider input-output relationship:
            



Equating numerators and denominators yields












FIGURE 11-43




Second-order circuit realizations.




              The impedance
              Z
2
              (
              s
              ) is realizable as a capacitance
              
              . The resulting voltage-divider circuit is shown in
              Figure 11-43
              (a). The impedances in this circuit are physically realizable when
              
              . Be aware that the resistance controls the damping ratio ζ because it is the element that dissipates energy in the circuit. Note that inductors, especially larger values, have a parasitic resistance that needs to be taken into account when selecting the resistor if a particular damping ratio is desired. Finally, note that if
              
              , then the capacitor
              C
1
              can be replaced by a short circuit resulting in a more efficient design.
            

              When
              K
              >
              
              , we can partition the transfer function into a two-stage cascade of the form
            




              The first stage requires a positive gain greater than unity and can be realized using a noninverting OP AMP circuit. The second stage can be realized as a voltage divider with
              
              and
              Z
1
              (
              s
              ) =
              s
              + 2ζω
              0
              . The resulting cascade circuit is shown in
              Figure 11-43
              (b).
            












                      DESIGN EXAMPLE 11-23
                    

                      Find a second-order realization of the transfer function given in
                      Example 11-20
                      .
                    




SOLUTION:


The given transfer function can be written as




                  Factoring
                  s
                  out of the denominator and equating the result to the transfer function of a voltage divider gives
                



Equating the numerators and denominators yields




                  Both of these impedances are realizable, so a single-stage voltage-divider design is possible. The prototype impedance
                  Z
1
                  (
                  s
                  ) requires a 1-H inductor, which is a bit large. A more practical value is obtained using a scale factor of
                  k
m
                  -0.1. The resulting scaled voltage divider circuit is shown in
                  Figure 11-44
                  .
                








FIGURE 2-44








■













                  Design
                  Exercise 11-33

Design a second-order circuit to realize the following transfer function:





Answer:



Figure 11-45
                  shows one possible solution.
                








FIGURE 11-45

















                  Design
                  Exercise 11-34

Design a second-order circuit to realize the following transfer function using practical, standard values:





Answer:



Figure 11-46
                  shows one possible solution.
                








FIGURE 11-46











Design Evaluation Summary
Examples 11-20, 11-21, and 11-23 show three different ways to realize the transfer function



This illustrates that a design requirement can have many solutions. Selecting the best design from among the alternatives involves additional criteria such as element count, power requirements, and output loading effects.

              The element counts for each design are given in
              Table 11-1
              . On a pure element-count basis and external power requirement, the
              RLC
              divider in
              Figure 11-44
              is the best design. However, inductors have some serious drawbacks. They are heavy and lossy in low-frequency applications and are not usually fabricated in integrated circuit form. Fortunately, inductors are not essential to transfer function design, as shown by the two
              RC
              OP AMP designs.
            

Power requirements
              : The two
              RC
              OP AMP designs require external dc power supplies. The voltage divider cascade in
              Figure 11-36
              requires less power since it uses only one OP AMP, compared with the two-OP-AMP inverting cascade. Thus, power requirements would favor the one-OP-AMP circuit over the two-OP-AMP circuit.
            






Table
                        11-1
                      











Number of






Example


Figure


Description



R




L




C



OP AMP



11-20
11-36

RC
                      voltage-divider cascade
                    
4
0
2
1


11-21
11-40

RC
                      inverting cascade
                    
4
0
2
2


11-23
11-44

RLC
                      voltage divider
                    
2
1
1
0






Output loading:
              The output impedance of the design is important if the circuit must drive a finite load of, say, 1 kΩ. The resulting loading effects could defeat the basic purpose of the circuit by changing its transfer function. Output loading considerations favor the inverting cascade in
              Figure 11-40
              because it has an OP AMP output that has zero output impedance.
            
A design problem involves more than simply finding a prototype that realizes a given transfer function. In general, the first step in a design problem involves determining an acceptable transfer function, one that meets performance requirements such as the characteristics of the step or frequency response. In other words, we must first design the transfer function and then design several circuits that realize the transfer function. To deal with transfer function design we must understand how performance characteristics are related to transfer functions. The next two chapters provide some background on this issue.













                      DESIGN AND EVALUATION EXAMPLE 11-24
                    

                      Given the step response
                      g
                      (
                      t
                      ) = ± [1 + 4
                      
                        e
                        -


                        500
                        t

                      ]
                      u
                      (
                      t
                      ),
                    


                        (a) Find the transfer function
                        T
                        (
                        s
                        ).
                      

                        (b) Design two
                        RC
                        OP AMP circuits that realize the
                        T
                        (
                        s
                        ) found in part (a).
                      
(c) Evaluate the two designs on the basis of element count, input impedance, and output impedance.





SOLUTION:




(a) The transform of the step response is



and the required transfer function is






                      (b) The first design uses an inverting OP AMP configuration. Using the minus sign on the transfer function
                      T
                      (
                      s
                      ) and factoring an
                      s
                      out of the numerator and denominator yield
                    




                      Equating numerators and denominators yields
                      Z
2
                      (
                      s
                      ) =5 + 500/
                      s
                      and
                      Z
1
                      (
                      s
                      ) = 1 + 500/
                      s
                      . The impedance
                      Z
2
                      (
                      s
                      ) is realizable as a resistance (
                      R
2
                      =5 Ω) in series with a capacitance (
                      C
2
                      = 1/500 F) and
                      Z
1
                      (
                      s
                      ) as a resistance (
                      R
1
                      = 1 Ω) in series with a capacitance (
                      C
1
                      = 1/500 F). Using a magnitude scale factor
                      k
m
                      = 10
                      5
                      produces circuit C1 in
                      Figure 11-47
                      .
                    








FIGURE 11-47








                      The second design uses a noninverting OP AMP configuration. Using the plus sign on the transfer function
                      T
                      (
                      s
                      ) and factoring an
                      s
                      out of the numerator and denominator yield
                    



Equating numerators and denominators yields





                      The impedance
                      Z
1
                      (
                      s
                      ) is realizable as a resistance (
                      R
1
                      =1 Ω) in series with a capacitance (
                      C
1
                      = 1/500 F) and
                      Z
2
                      (
                      s
                      ) as a resistance (
                      R
2
                      =4 Ω). Using a scale factor of
                      k
m
                      = 10
                      4
                      produces circuit C2 in
                      Figure 11-47
                      .
                    



                      (c) Circuit C1 uses one more capacitor than circuit C2. The OP AMP output on both circuits means that they each have almost zero output impedance. The input impedance to circuit C2 is very large, because its input is the noninverting input of the OP AMP. The input impedance of circuit C1 is
                      Z
1
                      (
                      s
                      ) =
                      k
m
                      (1 +500/
                      s
                      ); hence, the scale factor must be selected to avoid loading the source circuit. The final design for circuit C1 in
                      Figure 11-47
                      uses
                      k
m
                      = 10
                      5
                      , which means that |
                      Z
1
                      (
                      s
                      )| >100kΩ, which should be high enough to avoid loading the source circuit.
                      ■













                  Evaluation
                  Exercise 11-35


                  The following transfer function was realized in different ways in
                  Figures 11-37
                  ,
                  11-41
                  , and
                  11-45
                  :
                




                  Compare the various designs in a table similar to
                  Table 11-1
                  . Which would you recommend if
                

(a) There was no power available?
(b) There was a desire not to invert the output and to avoid using inductors?
(c) There was a concern about loading at the output?



Answers:




                    (a) The
                    RLC
                    circuit in
                    Figure 11-45
                    requires no power.
                  

                    (b) The
                    RC
                    voltage-divider cascade in
                    Figure 11-37
                    does not invert the output and does not require an inductor.
                  
(c) None of the circuits prevents the possibility of loading at the output. One could add an OP AMP follower at the output of any of the three solutions to address loading concerns.












                  Design
                  Exercise 11-36

There is a need to realize the following transfer function using practical standard values:




                  In researching distributers' catalogs, the manufacturer of the circuit shown in
                  Figure 11-48
                  , claimed it could produce the desired transfer function. Element values were not provided, but your supervisor is certain it could be reverse engineered in-house. Using standard parts, design the desired transfer function using the circuit in
                  Figure 11-48
                  .
                








FIGURE 11-48









Answer:



                  One possible solution is
                  R
1
                  =10kΩ,
                  R
2
                  = 100 kΩ,
                  C
                  = 0.01 µF, and
                  L
                  =10 mH.
                

















                      DESIGN EXAMPLE 11-25
                    

                      Verify that circuit C2 in
                      Figure 11-47
                      meets its design requirements, using MATLAB and Multisim. Compare the results.
                    




SOLUTION:



                  One of the important uses of computer-aided analysis is to verify that a proposed design meets the performance specifications. The circuit C2 in
                  Figure 11-47
                  is designed to produce a specified step response
                




                  This response jumps from zero to 5 V at
                  t
                  = 0 and then decays exponentially to 1 V at large t. The time constant of the exponential is 1/500 = 2 ms, which means that the final value is effectively reached after about five time constants, or 10 ms.
                
One can use MATLAB to better visualize the specifications of a circuit design. To have MATLAB produce the step response, we use the transfer function operator, tf, as shown in the m-file below. In this example, after we entered the circuit's transfer function, we applied the MATLAB function step to plot the desired step response of the circuit in question.

                  s = tf('s');
                  H = 5*(s + 100)/(s + 500);
                  step(H)
                

Figure 11-49
                  shows the step response of the circuit as plotted by MATLAB. We have selected two points for reference, namely
                  t
                  = 2 ms and
                  t
                  = 4 ms.
                








FIGURE 11-49








                  We then simulated the circuit using Multisim. We drew the circuit and used the step-voltage source with a very fast rise-time of 1 ps for the input.
                  Figure 11-50
                  shows both the circuit as drawn and the result of our
                  
                  transient analysis on Grapher View. We used the cursors to identify the same two data points we found in the MATLAB simulation for the comparison.
                








FIGURE 11-50








                  The theoretical values can also be calculated directly from
                  g
                  (
                  t
                  ) at the same two points:
                



We summarize our results in the following table:










                  The data show that theory and simulation agree to three significant figures.
                  ■










                  APPLICATION
                  EXAMPLE 11-26


                  The operation of a digital system is coordinated and controlled by a periodic waveform called a clock. The
                  clock waveform
                  provides a standard timing reference to maintain synchronization between signal processing results that are generated asynchronously. Because of differences in digital circuit delays, there must be agreed-upon instants of time at which circuit outputs can be treated as valid inputs to other circuits.
                

Figure 11-51
                  shows a section of the clock distribution network in an integrated circuit. In this network, the clock waveform is generated at one point and distributed to other on-chip locations by interconnections that can be modeled as lumped resistors and capacitors. Clock distribution problems arise when the
                  RC
                  circuit delays at different locations are not the same. This delay dispersion is called
                  clock skew,
                  defined as the time difference between a clock edge at one location and the corresponding edge at another location.
                








FIGURE 11-51




Clock distribution network.




                  To qualitatively calculate a clock skew, we will find the step responses in the
                  RC
                  circuit in
                  Figure 11-52
                  . The input
                  V
s
                  (
                  s
                  ) is a unit step function that simulates the leading edge of a clock pulse. The resulting step responses
                  V
A
                  (
                  s
                  ) and
                  V
B
                  (
                  s
                  ) represent the clock waveforms at points A and B in a clock distribution network. To find the step responses, we use the following
                  s
                  -domain node-voltage equations.
                








FIGURE 11-52




Two-stage RC circuit model.






The circuit determinant is





                  which indicates that the circuit has simple poles at
                  s
                  = - 0.382/
                  RC
                  and
                  s
                  = - 2.618/
                  RC
                  . Using the circuit determinant and a unit step input, we can easily solve the node equations for
                  V
A
                  (
                  s
                  ) and
                  V
B
                  (
                  s
                  ):
                



From these we obtain the time-domain step responses as




                  These two responses are plotted in
                  Figure 11-53
                  . For a unit step input, both responses have a final value of unity. Using the definition of step response
                  delay time
                  given in
                  Example 11-12
                  (time required to reach 50% of the final value), we see that
                








FIGURE 11-53




Step responses showing clock skew.






The delay time skew is




                  The clock distribution problem is not that the
                  RC
                  elements representing the interconnects produce time delay, but that delays are not all the same. Ideally, digital devices at different locations should operate on their respective digital inputs at exactly the same instant of time. Erroneous results may occur when the clock pulse defining that instant does not arrive at all locations at the same time. Minimizing clock skew is one of the major constraints on the design of the clock distribution network in large-scale integrated circuits.
                





Summary


              A
              network function
              is defined as the ratio of the zero-state response transform to the input transform. Network functions are either driving-point functions or transfer functions. Network functions are rational functions of
              s
              with real coefficients whose complex poles and zeros occur in conjugate pairs.
            

              Network functions for simple circuits like voltage and current dividers and inverting and noninverting OP AMPs are easy to derive and often useful. Node-voltage or mesh-current methods are used to find the network functions for more complicated circuits. The transfer function of a
              cascade connection
              obeys the
              chain rule
              when each stage does not load the preceding stage in the cascade.
            

              The
              impulse response
              is the zero-state response of a circuit for a unit impulse input. The transform of the impulse response is equal to the network function. The impulse response contains only natural poles and decays to zero in stable circuits. The impulse response of a linear, time-invariant circuit obeys the proportionality and time-shifting properties. The short pulse approximation is a useful way to simulate the impulse response in practical situations.
            

              The
              step response
              is the zero-state response of a circuit when the input is a unit step function. The transform of the step response is equal to the network function times 1/
              s.
              The step response contains natural poles and a forced pole at
              s
              = 0 that leads to a dc steady-state
              
              response in stable circuits. The amplitude of the dc steady-state response can be found by evaluating the network function at
              s
              = 0. The step response waveform can also be found by integrating the impulse response waveform.
            

              The
              sinusoidal steady-state response
              is the forced response of a stable circuit for a sinusoidal input. With a sinusoidal input, the response transform contains natural poles and forced poles at
              s
              =
              ± j
              ω that lead to a sinusoidal steady-state response in stable circuits. The amplitude and phase angle of the sinusoidal steady-state response can be found by evaluating the network function at
              s
              =
              j
              ω.
            

              The sinusoidal steady-state response can be found using phasor circuit analysis or directly from the transfer function.
              Phasor circuit analysis
              works best when the circuit is driven at only one frequency and several responses are needed. The
              network function method
              works best when the circuit is driven at several frequencies and only one response is needed.
            

              The
              convolution integral
              is a
              t
              -domain method relating the impulse response
              h
              (
              t
              ) and input waveform
              x
              (
              t
              ) to the zero-state response
              y
              (
              t
              ). Symbolically the convolution integral is represented by
              y
              (
              t
              ) =
              h
              (
              t
              )
              * x
              (
              t
              ). Timedomain convolution and
              s
              -domain multiplication are equivalent; that is,
              y
              (
              t
              ) =
              h
              (
              t
              )
              * x
              (
              t
              ) =
              
-1
H
              (
              s
              )
              X
              (
              s
              )}. The geometric interpretation of
              t
              -domain convolution involves four operations: reflecting, shifting, multiplying, and integrating.
            

              First- and second-order transfer functions can be designed using voltage dividers and inverting or non-inverting OP AMP circuits. Higher-order transfer functions can be realized using a cascade connection of first- and second-order circuits.
              Prototype
              designs usually require magnitude scaling to obtain practical element values.
            




Chapter 11 Problems






                Objective 11 — 1 Network Functions (
                Sects. 11-1
                and
                11—2
                )
              
Given a linear circuit:


(a)
                  Find specified network functions and locate their poles and zeros.
                

(b)
                  Select the element values to produce specified poles and zeros.
                


                See
                Examples 11-1
                to
                11-7
                and
                Exercises 11-1
                to
                11-9
                .
              





11-1



(a)
                  Find the driving point impedance seen by the voltage source in
                  Figure P11-1
                  and the voltage transfer function
                  T

V

                  (
                  s
                  ) =
                  V

2

                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Select values of
                  R
                  and
                  C
                  so that the transfer function has a zero at -1 krad/s and a pole at -500 rad/s.
                  







FIGURE P11-1













11-2



(a)
                  Find the driving point impedance seen by the voltage source in
                  Figure P11-2
                  and the voltage transfer function
                  T
V
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Select values of
                  R
                  and
                  L
                  so that the transfer function has a zero at s = -150 rad/s and a pole at s = -100 rad/s.
                  







FIGURE P11-2















11-3



(a)
                  Find the driving point impedance seen by the voltage source in
                  Figure P11-3
                  and the voltage transfer function
                  T

V

                  (
                  s
                  ) =
                  V

2

                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Select values of
                  R, L,
                  and
                  C
                  so that the transfer function has a pair of real poles at
                  s
                  = -10000 rad/s. Where are the zeros under these conditions?
                

(c)
                  Use Multisim to plot the frequency response of your circuit. Plot your graph in dB from 1 Hz to 1 MHz. What type of filter is your device?
                  







FIGURE P11-3














11-4
                The transfer impedance function
                T
Z
                (
                s
                ) for the parallel circuit in
                Figure P11-4
                is
              




                Show that the poles of the driving point impedance
                Z
                (
                s
                ) are the poles of the transfer impedance function.
              








FIGURE P11-4












11-5



(a)
                  Find the driving point impedance seen by the voltage source in
                  Figure P11-5
                  and the voltage transfer function
                  T
V
(
s
                  ) =
                  V

2

                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Select values for
                  R
1
                  ,
                  R
2
                  , and
                  C
                  so that there is a pole in the transfer function at s = - 2000 rad/s, the input impedance is 2200 Ω, and there is a gain of 20.
                  







FIGURE P11-5













11-6



(a)
                  Find the driving point impedance seen by the voltage source in
                  Figure P11-6
                  and the voltage transfer function
                  T
V
(
s
                  ) =
                  V

2

                  (
                  s
                  )/
                  V

1

                  (
                  s
                  ).
                

(b)
                  Select values for
                  R
1
                  ,
                  R
2
,
C
1
,
                  and
                  C
2
                  so that there is a pole in the transfer function at s = -10,000 rad/s, a zero at
                  s
                  = - 5000 rad/s, and the input impedance at dc is 2 kΩ.
                  








FIGURE P11-6














11-7



(a)
                  Find the voltage transfer function
                  T
V
                  (
                  s
                  )
                  = V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ) in
                  Figure P11-7
                  .
                

(b)
                  With
                  L
                  = 1 H, select values of
                  C
                  and
                  R
                  so that poles are located at -2000 ±
                  j
                  2000 rad/s. Is the circuit stable?
                  







FIGURE P11-7













11-8


(a)
                  Find the driving point impedance seen by the voltage source in
                  Figure P11-8
                  and the voltage transfer function
                  T
V
                  (
                  s
                  )
                  = V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  Insert a follower at A and repeat. What effect on the location of the poles did the follower have?
                  







FIGURE P11-8














11-9



                  (a) Find the driving point impedance seen by
                  V
1
                  (
                  s
                  ) in
                  Figure P11-9
                  .
                

(b)
                  Find the voltage transfer function
                  T
V
                  (
                  s
                  )
                  = V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(c)
                  Select values of
                  R
1
                  ,
                  R
2
                  , µ, and
                  C
                  so that
                  T
V
                  (
                  s
                  ) has a pole at
                  s
                  = -500 krad/s.
                

(d)
                  What is the range of the gain factor µ so that the system is stable?
                  







FIGURE P11-9













11-10



                  For the circuit in
                  Figure P11-10
                  :
                

(a)
                  Do a source transformation for
                  I
1
                  (
                  s
                  ) and
                  R.


(b)
                  Use the new Thévenin source to find the transfer function
                  T
Z
                  (
                  s
                  )
                  = V
2
                  (
                  s
                  )/
                  I
1
                  (
                  s
                  ).
                

(c)
                  Select values of
                  R
                  and
                  L
                  so that there is a pole at -3000 rad/s. Where is the zero?
                  







FIGURE P11-10














11-11
              Find the voltage transfer function
              T
V
              (
              s
              )
              = V
2
              (
              s
              )/
              V
1
              (
              s
              ) of the cascade connection in
              Figure P11-11
              . Locate the poles and zeros of the transfer function.
              







FIGURE P11-11











11-12
              The circuit of
              Figure P11-12
              consists of two stages - a voltage divider stage and an OP AMP stage.
              

(a)
                  Compute the transfer function
                  T
V1
                  (
                  s
                  )
                  = V
X
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  )
                  .


(b)
                  Compute the transfer function
                  T
V2
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  V
X
                  (
                  s
                  )
                  .


(c)
                  Compute the transfer function
                  T
V3
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ). Is loading present? Explain.
                

(d)
                  Swap the two stages and find
                  T
V4
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ). Is loading present? Explain.
                  







FIGURE P11-12


















                Objective 11—2 Network Functions, Impulse Response, and Step Responses (
                Sects. 11—3
                and
                11—4
                )
              

(a) Given a first- or second-order linear circuit, find its impulse or step response.
(b) Given the impulse or step response of a linear circuit, find the network functions.
(c) Given the impulse or step response of a linear circuit, find the response due to other inputs.


                See
                Examples 11-8
                to
                11-12
                and
                Exercises 11-13
                to
                11-16
                .
              





11-13
              For the circuit in
              Figure P11-13
              :
              

(a)
                  Find the impulse response
                  h
2
                  (
                  t
                  ).
                

(b)
                  Find the step response
                  g
2
                  (
                  t
                  ).
                  







FIGURE P11-13













11-14


                  Find υ
                  2
                  (
                  t
                  ) in
                  Figure P11-14
                  when υ
                  1
                  (
                  t
                  ) = δ(
                  t
                  ). Repeat for υ
                  1
                  (
                  t
                  ) =
                  u
                  (
                  t
                  ).
                  







FIGURE P11-14














11-15


(a)
                  Find
                  h
                  (
                  t
                  ) and
                  g
                  (
                  t
                  ) for the circuit in
                  Figure P11-15
                  .
                

(b)
                  Swap the inductor and capacitor in the shaded portion of the circuit and repeat (a).
                  







FIGURE P11-15














11-16



(a)
                  Find
                  H
                  (
                  s
                  ) for the circuit in
                  Figure P11-16
                  in terms of
                  R
F
                  .
                

(b)
                  Select a value of
                  R
F
                  so that there is pole in
                  H
                  (
                  s
                  )at
                  s
                  = -5000 rad/s.
                

(c)
                  With the
                  R
F
                  you found, find
                  h
                  (
                  t
                  ) by hand.
                

(d)
                  Use the step function in MATLAB to plot the step response
                  h
                  (
                  t
                  ). (
                  Hint
                  : See
                  Example 11-11
                  .)
                  







FIGURE P11-16














11-17
              If
              R
F
              in
              Figure P11-16
              is 25 kΩ, find
              G
              (
              s
              ) and
              g
              (
              t
              ). What are the initial value and final value of the step response?
            

11-18
              Find υ
              2
              (
              t
              ) in
              Figure P11-18
              when υ
              1
              (
              t
              ) = δ(
              t
              ). Repeat for υ
              1
              (
              t
              ) =
              u
              (
              t
              ).
              







FIGURE P11-18












11-19
              The impulse response of a linear circuit is
              h
              (
              t
              ) = δ(
              t
              ) -500e
              
                -100
                t

u
              (
              t
              ). Find the circuit's step response
              g
              (
              t
              ), impulse response transform
              H
              (
              s
              )
              ,
              step response transform
              G
              (
              s
              )
              ,
              and the circuit's transfer function
              T
              (
              s
              )
              .



11-20

              The step response transform of a linear circuit is
              G
              (
              s
              ) = 200/
              s
              (
              s
              + 100).
              

(a)
                  Find the circuit's transfer function,
                  T
                  (
                  s
                  ).
                

(b)
                  Design a circuit to produce that transfer function. (
                  Hint
                  : See Design
                  Exercise 11-26
                  .)
                

(c)
                  Find the circuit's impulse response
                  h
                  (
                  t
                  ) and step response
                  g
                  (
                  t
                  ).
                

(d)
                  Use MATLAB's step function to plot your circuit's step response.
                




11-21

              The pole-zero diagram of a circuit's step response is shown in
              Figure P11-21
              . The
              K
              of the circuit is 500.
              

(a)
                  Find
                  G
                  (
                  s
                  ),
                  g
                  (
                  t
                  ),
                  H
                  (
                  s
                  ),
                  T
                  (
                  s
                  ), and
                  h
                  (
                  t
                  )
                  .


(b)
                  Design an
                  RC
                  circuit that can realize the step response.
                  








FIGURE P11-21













11-22
              Find
              h
              (
              t
              ) =
              
              when
              g
              (
              t
              ) = (3 -
              e

                -10
                t

              )
              u
              (
              t
              ). Verify your answer by first transforming
              g
              (
              t
              ) into
              G
              (
              s
              ) and finding
              H
              (
              s
              ) =
              sG
              (
              s
              ) and then taking the inverse transform of
              H
              (
              s
              ). Did you get the same answer?
            


11-23
              The impulse response of a linear circuit is
              h
              (
              t
              ) = 45,000 [
              e

                -5000
                t

              ]
              u
              (
              t
              )
              .
              Find the output waveform when the input is
              x
              (
              t
              )=9
              tu
              (
              t
              ) V.
            


11-24
              The step response of a linear circuit is
              g
              (
              t
              )
              = 0.5
              [1 -
              e

                -250
                t

              ]
              u
              (
              t
              ). Find the output waveform when the input is
              υ
1
              (
              t
              ) =[20e
              
-
                200
                t

              ]
              u
              (
              t
              )
              .
              Use MATLAB to find the Laplace transforms of
              g
              (
              t
              ) and υ
              1
              (
              t
              )
              .
              Then find
              V
2
              (
              s
              ). Finally, use the inverse Laplace function to find the waveform υ
              2
              (
              t
              ) and plot the results.
            



11-25



(a)
                  Design a circuit that has the following step response:
                  




(b)
                  Validate your design using Multisim
                

(c)
                  Plot its pole-zero diagram What is its scaling factor
                  K
                  ?
                



11-26
              The step response of a linear circuit is
              g
              (
              t
              ) = 100 [e
              
                -100
                t

              cos 2000
              t
              ]
              u
              (
              t
              )
              .
              Find the circuit's impulse response
              h
              (
              t
              ), impulse response transform
              H
              (
              s
              ), step response transform
              G
              (
              s
              ), and the circuit's transfer function
              T
              (
              s
              )
              .




11-27
              The transfer function of a linear circuit is
              T
              (
              s
              )
              =
              (
              s
              + 2000)/(
              s
              + 1000). Find the output waveform when the input is
              x
              (
              t
              ) =5
              e

                -1000
                t

u
              (
              t
              )
              .
              Use MATLAB to find the Laplace transform of
              x
              (
              t
              )
              .
              Then find
              Y
              (
              s
              )
              .
              Finally, use the inverse Laplace function to find the waveform
              y
              (
              t
              ) and plot the results.
            







                Objective 11-3 Network Functions and the Sinusoidal Steady-State Response (
                Sect. 11 - 5
                )
              

(a) Given a first- or second-order linear circuit with a specified input sinusoid, find the sinusoidal steady-state response.
(b) Given the network function, impulse response, or step response, find the sinusoidal steady-state response for a specified input sinusoid.


                See
                Examples 11-13
                to
                11-15
                and
                Exercises 11-17
                to
                11-20
                .
              




11-28
              The circuit in
              Figure P11-28
              is in the steady state with υ
              1
              (
              t
              ) = 10 cos 1414.21
              t
              V. Find υ
              2SS
              (
              t
              ). Repeat for υ
              1
              (
              t
              ) = 10 cos 10 k
              t
              V. And without doing any calculations, repeat for υ
              1
              (
              t
              ) =10V.
              







FIGURE P11-28












11-29
              The circuit in
              Figure P11-29
              is in the steady state with υ
              1
              (
              t
              ) = 1.0 cos 2020
              t
              V. Find υ
              2SS
              (
              t
              ). Repeat for υ
              1
              (
              t
              ) = 1.0 cos 20.2 k
              t
              V, and for υ
              1
              (
              t
              ) = 1.0 cos 202 k
              t
              V. Where is the pole located?
              







FIGURE P11-29











11-30
              The output in
              Figure P11-30
              is υ
              2SS
              (
              t
              ) = 25.5 cos (10,000
              t
              + 11.8°) V. Find the input υ
              1
              (
              t
              ) that produced that output.
              







FIGURE P11-30












11-31
              The circuit in
              Figure P11-31
              is in the steady state with
              i
1
              (
              t
              ) = 100 cos (25 k
              t
              ) mA,
              R
1
              =4 kΩ,
              R
2
=
              6 kΩ, and
              L
              = 500 mH.
              

(a)
                  Find
                  i
2SS
                  (
                  t
                  ).
                

(b)
                  Find the location of the pole by running an ac sweep on Multisim. Run your sweep from 100 Hz to 1 MHz. The pole is located where the amplitude of the output is -3 dB of the maximum magnitude.
                  








FIGURE P11-31














11-32
              The circuit in
              Figure P11-32
              is in the steady state.
              

(a)
                  If
                  i
1
                  (
                  t
                  )
                  =
                  10 cos 500
                  t
                  mA, find υ
                  2SS
                  (
                  t
                  )
                

(b)
                  If
                  i
1
                  (
                  t
                  ) = 10 cos 5000
                  t
                  mA, find υ
                  2SS
                  (
                  t
                  ).
                

(c)
                  If
                  i
1
                  (
                  t
                  ) = 10cos 50,000
                  t
                  mA, find υ
                  2SS
                  (
                  t
                  ).
                

(d)
                  Verify your results using Multisim's single frequency ac analysis.
                  







FIGURE P11-32














11-33



                  The impulse response transform of a circuit is
                  




(a)
                      Find υ
                      1SS
                      (
                      t
                      ) if
                      i
1
                      (
                      t
                      ) = 10 cos 5000
                      t
                      mA.
                    

(b)
                      Design a circuit to achieve
                      H
Z
                      (
                      s
                      ). The circuit in
                      Figure P11-32
                      must be part of your design.
                    



11-34
                  The transfer function of a linear circuit is
                  T
                  (
                  s
                  ) = (
                  s
                  + 100)/(s + 200. Find the sinusoidal steady-state output for an input
                  x
                  (
                  t
                  ) = 15 cos 200
                  t
                  .
                


11-35
                  The step response of a linear circuit is
                  g
                  (
                  t
                  ) = [5
                  e

                    -1000
                    t

                  ]
                  u
                  (
                  t
                  ). Find the sinusoidal steady-state output for an input
                  x
                  (
                  t
                  ) = 10 cos 1000
                  t
                  .
                

11-36

                  A student looks back at some notes she took in class. She sees
                  Figure P11-36
                  and an equation υ
                  2
                  (
                  t
                  ) = (1 -
                  e

                    -
                    

                  )
                  u
                  (
                  t
                  ) after it. How are the figure and the equation related, if at all?
                  







FIGURE P11-36













11-37
                  The impulse response of a linear circuit is
                  h
                  (
                  t
                  )
                  =
                  800 [
                  
                    e
                    -


                    100
                    t

-
                  e
                  
-
                    400
                    t

                  ]
                  u
                  (
                  t
                  )
                  .
                  Use MATLAB to find the sinusoidal steady-state output for an input
                  x
                  (
                  t
                  ) = 8 cos 200
                  t
                  . Use MATLAB to plot
                  y
                  (
                  t
                  ).
                

11-38
                  The step response of a linear circuit is
                  g
                  (
                  t
                  ) = [2
                  
                    e
                    -


                    50
                    t

                  sin 200
                  t
                  ]
                  u
                  (
                  t
                  ). Find the sinusoidal steady-state response for an input
                  x
                  (
                  t
                  ) = 50 cos 200
                  t.



11-39
                  The step response of a linear circuit is
                  g
                  (
                  t
                  ) = [1-10
                  te

                    -10
                    t

                  ]
                  u
                  (
                  t
                  )
                  .
                  The sinusoidal steady-state response is noted to be
                  y
SS
                  (
                  t
                  ) = 18.03 cos (20
                  t
                  + 19.4°). What was the input that caused that output?
                






Objective 11-4 Network Functions and Convolution (Sect.)

(a) Given the impulse response of a linear circuit, use the convolution integral to find the response to a specified input.
(b) Use the convolution integral to derive properties of linear circuits.


                    See
                    Examples 11-16
                    to
                    11-19
                    and
                    Exercises 11-21
                    and
                    11-22
                    .
                  




11-40
                  The impulse response of a linear circuit is
                  h
                  (
                  t
                  ) =
                  u
                  (
                  t
                  ). Use the convolution integral to find the response due to an input
                  x
                  (
                  t
                  ) = δ(
                  t
                  ).
                


11-41
                  The impulse response of a linear circuit is
                  h
                  (
                  t
                  ) = [3
                  u
                  (
                  t
                  ) -
                  u
                  (
                  t -
                  1) - 2
                  u
                  (
                  t -
                  2)]. Use the convolution integral to find the response due to an input
                  x
                  (
                  t
                  ) = δ(
                  t
                  ).
                

11-42
                  The impulse response of a linear circuit is
                  h
                  (
                  t
                  ) =
                  u
                  (
                  t
                  )
                  - u
                  (
                  t -
                  2). Use the convolution integral to find the response due to an input
                  x
                  (
                  t
                  ) =
                  u
                  (
                  t
                  ) -
                  u
                  (
                  t -
                  1).
                


11-43
                  The impulse response of a linear circuit is
                  h
                  (
                  t
                  ) =
                  t
                  [
                  u
                  (
                  t
                  )
                  - u
                  (
                  t -
                  1)]. Use the convolution integral to find the response due to an input
                  x
                  (
                  t
                  ) =
                  u
                  (
                  t -
                  2).
                

11-44



(a)
                      The impulse response of a linear circuit is
                      h
                      (
                      t
                      ) =
                      
                        e
                        -


                        2
                        t

u
                      (
                      t
                      )
                      .
                      Use the convolution integral to find the response due to an input
                      x
                      (
                      t
                      ) = δ(
                      t
                      ). Repeat for
                      x
                      (
                      t
                      ) =
                      u
                      (
                      t
                      ).
                    

(b)
                      Convert the impulse response into a transfer function and the input into the
                      s
                      domain. Solve each of the problems in the
                      s
                      domain and convert your answers back into the
                      t
                      domain. Compare your results with those found in part (a).
                    

(c)
                      Which method of solution was easier?
                    




11-45


(a)
                      The impulse response of a linear circuit is
                      h
                      (
                      t
                      ) =
                      e

                        -2
                        t

u
                      (
                      t
                      ). Use the convolution integral to find the response due to an input
                      x
                      (
                      t
                      ) =
                      tu
                      (
                      t
                      ).
                    

(b)
                      Convert the impulse response into a transfer function and the input into the
                      s
                      domain. Solve the problem in the
                      s
                      domain and convert your answer back into the
                      t
                      domain. Compare your result with that found in part (a).
                    



11-46
                  Show that
                  f
                  (
                  t
                  )
                  *
                  δ(
                  t
                  ) =
                  f
                  (
                  t
                  ). That is, show that convolving any waveform
                  f
                  (
                  t
                  ) with an impulse leaves the waveform unchanged.
                


11-47
                  Use the convolution integral to show that if the input to a linear circuit is
                  x
                  (
                  t
                  ) =
                  u
                  (
                  t
                  ), then
                  



                  That is, show that the step response is the integral of the impulse response.
                

11-48
                  If the input to a linear circuit is
                  x
                  (
                  t
                  ) =
                  tu
                  (
                  t
                  ), then the output
                  y
                  (
                  t
                  ) is called the ramp response. Use the convolution integral to show that
                  


                  That is, show that the derivative of the ramp response is the step response.
                



11-49
                  The impulse response of a linear circuit is
                  h
                  (
                  t
                  )
                  = tu
                  (
                  t
                  )
                  .
                  Use MATLAB to compute the convolution integral and find the response due to an input
                  x
                  (
                  t
                  ) =
                  t
                  [
                  u
                  (
                  t
                  )
                  - u
                  (
                  t -
                  2)]
                  .


11-50
                  The step response of a linear circuit is
                  g
                  (
                  t
                  ) = 2(1 -
                  e

                    -50
                    t

                  )
                  u
                  (
                  t
                  ) and
                  x
                  (
                  t
                  )= '
                  tu
                  (
                  t
                  ) Use
                  s
                  -domain convolution to find the zero-state response
                  y
                  (
                  t
                  )
                


11-51
                  The impulse responses of two linear circuits are
                  h
1
                  (
                  t
                  ) = 5
                  e

                    -5
                    t

u
                  (
                  t
                  ) and
                  h
2
                  (
                  t
                  ) = 15
                  e

                    -3
                    t

u
                  (
                  t
                  ) What is the impulse response of a cascade connection of these two circuits?
                

11-52
                  The impulse response of a linear circuit is shown in
                  Figure P11-52
                  . Graphically find the convolution of the impulse response shown and a unit step function,
                  x
                  (
                  t
                  ) =
                  u
                  (
                  t
                  )
                  .








FIGURE P11-52














11-53
              Solve Problem 11-40 graphically.
            







                Objective 11-5 Network Function Design (
                Sect. 11 - 7
                )
              

(a) Design alternative circuits that realize a given network function and meet other stated constraints.
(b) Use software to visualize and simulate alternative designs.
(c) Evaluate alternative designs using stated criteria and select the best design.


                See
                Examples 11-20
                to
                11-26
                and
                Exercises 11-23
                to
                11-36
                .
              




11-54

              Design an
              RC
              circuit using practical values to realize the following transfer function:
              





11-55

              Design an
              RL
              circuit using practical values to realize the following transfer function:
              




11-56

              Design a circuit to realize the transfer function below ±2% using only resistors and capacitors, but no OP AMPs, since no external power is available. You must use those 100 pF capacitors that are surplus. Be sure to minimize loading.
              





11-57

              Design a circuit to realize the transfer function below using only resistors, inductors, and no more than one OP AMP.
              


Scale the circuit so that all inductors are exactly 10 mH.


11-58

              Design a circuit to realize the transfer function below using only resistors, capacitors, and OP AMPs. All
              R
              s must be 1 kΩ
              .
              or larger and the maximum OP AMP gain is ±10
              4
              .
              


Scale the circuit so that all capacitors are exactly 0.1 µF.



11-59

              The circuit shown in
              Figure P11-59
              was designed to produce the following transfer function
              


However, during testing the circuit produced a different transfer function. The pole was correct, but the gain was wrong. A senior engineer recognized the problem and said a simple change using the same parts would solve the problem. What is that change?








FIGURE P11-59











11-60


              Your employer needs a circuit that meets specific criteria. It must meet the following transfer characteristics:
              




                All capacitors must be exactly 0.1 µF and resistors greater than 1 kΩ. You contact a manufacturer who claims that the circuit shown in
                Figure P11-60
                can meet your specifications. You just need to specify the element values and they can make it for you. Determine if you can select the values to meet your specifications.
              








FIGURE P11-60












11-61

              Design a circuit to realize the transfer function below using only resistors, capacitors, and OP AMPs. Scale the circuit so that all resistors are greater than 10 kΩ and all capacitors are less the 1 µF.
              




11-62

              Design a circuit to realize the following transfer function
              
              in two ways:
              

(a)
                  As a passive circuit using only resistors, capacitors, and inductors with
                  L ≤
                  50 mH.
                

(b)
                  Using only one OP AMP and identical resistors and capacitors. Must use
                  C
                  = 0.033 µF.
                




11-63

              A circuit is needed to realize the transfer function listed below.
              




(a)
                  Design the circuit using two OP AMPs.
                

(b)
                  Design the circuit using only one OP AMP.
                

(c)
                  Design the circuit using no OP AMPs.
                

In all cases, scale the circuit so that all parts use practical values.


11-64

              It is claimed that both circuits in
              Figure P11-64
              realize the transfer function
              




(a)
                  Verify that both circuits realize the specified
                  T
v
                  (
                  s
                  ).
                

(b)
                  Which circuit would you choose if the output must drive a 1 kΩ load?
                

(c)
                  Which circuit would you choose if the input comes from a 50 Ω source?
                

(d)
                  It is further claimed that connecting the two circuits in cascade produces an overall transfer function of [
                  T
v
                  (
                  s
                  )]
                  2
                  no matter which circuit is the first stage and which is the second stage. Do you agree or disagree? Explain.
                  







FIGURE P11-64














11-65

              It is claimed that both circuits in
              Figure P11-65
              realize the transfer function
              




(a)
                  verify that both circuits realize the specified
                  T
V
                  (
                  s
                  ).
                

(b)
                  Which circuit would you choose if the output must drive a 1-kΩ load?
                

(c)
                  Which circuit would you choose if the input comes from a 50-Ω source?
                

(d)
                  It is further claimed that connecting the two circuits in cascade produces an overall transfer function of [
                  T
V
                  (
                  s
                  )]
                  2
                  no matter which circuit is the first stage and which is the second stage. Do you agree or disagree? Explain.
                  







FIGURE P11-65














11-66



(a)
                  Design a passive circuit that produces the following step response with all inductors having
                  L
                  =1 H.
                  




(b)
                  validate your design using Multisim.
                  






11-67

              A circuit is needed that will take an input of υ
              1
              (
              t
              ) = [1 -
              
                e
                -


                10,000
                t

              ]
              u
              (
              t
              ) V and produce a constant -2 V output. Design such a circuit using practical parts values. Validate your design using Multisim.
            

11-68

              There is a need for a circuit with the following transfer function that must connect to a 50-Ω input and a 1-kΩ load.
              


In a parts catalog, your supervisor points out that the circuit below might do the task. The manufacturer states that only ground and nodes A, B, C, and D are accessible. Can the circuit work? If so, how would you connect it to the source and load?








FIGURE P11-68











Integrating Problems


11-69


              First-Order Circuit Impulse and Step Responses
              
                Each row in the table shown in
                Figure P11-69
                refers to a first-order circuit with an impulse response
                h
                (
                t
                ) and a step response
                g
                (
                t
                ). Fill in the missing entries in the table.
              








FIGURE P11-69












11-70

              OP AMP Modules and Loading
              
Figure P11-70
                shows an interconnection of three basic OP AMP modules.
              


(a)
                  Does this interconnection involve loading?
                

(b)
                  Find the overall transfer function of the interconnection and locate its poles and zeros.
                

(c)
                  Build this circuit in Multisim. Do an ac sweep from 10 Hz to 100 kHz. Locate the maximum or the minimum. Use dB for the magnitude axis.
                

(d)
                  Can you think of a use for this circuit?
                









FIGURE P11-70











11-71

              OP AMP Modules and Stability
              
Figure P11-71
                shows an interconnection of three basic circuit modules. Does this interconnection involve loading? Find the overall transfer function of the interconnection and locate its poles and zeros. Is the circuit stable?
              








FIGURE P11-71












11-72

              Designing to Specifications
              A particular circuit needs to be designed that has the following transfer function requirements:

                Poles at
                s
                = -100 and
                s
                = -10,000; zeros at
                s
                = 0 and
                s
                = -1000; and a gain of 50 as
                s
                → ∞.
              

                Find the circuit's transfer function and use MATLAB to plot its step response. Then design a circuit that will meet that requirement. Finally, use Multisim to validate that your circuit has the same step response as found using MATLAB.
                



11-73

              Comparison of Sinusoidal Steady-State Analysis versus Phasor Analysis
              
                A circuit designer often is faced with deciding which analysis technique to use when attempting to solve a circuit problem. In this problem we will look at the circuit in
                Figure P11-73
                and choose which technique is the better one to use for different analysis scenarios. Explain why you selected the technique you did.
              








FIGURE P11-73









(a)
                  You need to calculate the circuit's transfer function
                  T
V
                  (
                  s
                  ) =
                  V
2
                  (
                  s
                  )/
                  V
1
                  (
                  s
                  ).
                

(b)
                  The input is given as υ
                  1
                  (
                  t
                  ) = 5 cos 1000
                  t
                  V and you need to find υ
                  2SS
                  (
                  t
                  ).
                

(c)
                  The input is given as υ
                  1
                  (
                  t
                  ) = 5 cos 1000
                  t
                  V and you need to find
                  i
XSS
                  (
                  t
                  ).
                

(d)
                  The input is given as υ
                  1
                  (
                  t
                  ) =
                  V
A
                  cos cot V and you need to find υ
                  2SS
                  (
                  t
                  ).
                

(e)
                  The input is given as υ
                  1
                  (
                  t
                  ) = 170 cos 377
                  t
                  V and you need to find all of the voltages and currents in the circuit.
                

(f)
                  You need to find the poles and zeros of the circuit.
                

(g)
                  You need to find if the current leads or lags the voltage across the two resistors when the input is 5 cos 1000
                  t
                  V.
                

(h)
                  You need to determine what type of filtering the circuit performs.
                

(i)
                  You need to select a load for maximum power when the input is υ
                  1
                  (
                  t
                  ) = 170 cos 377
                  t
                  V.
                



11-74



              Simulated Impulse Response
              
                There was a small black box that could not be opened to determine what was inside, but there were four terminals visible and accessible. A pair were marked
                input,
                the other pair were marked
                output.
                Our task was to determine what the circuit's transfer function might be. An impulse was simulated by creating a one teravolt (TV) high triangular pulse by 2 ps width. This was applied to the input of the box. The output was observed as a decaying exponential as shown in
                Figure P11-74
                .
              


(a)
                  Using the available data, find the impulse response of the unknown circuit.
                

(b)
                  Design a likely circuit that has the same impulse response as what is in the box.
                

(c)
                  Comment on the reasonableness of the approach to determine what is in the box. That is, how critical is the design of the impulse to achieve a correct result?
                  







FIGURE P11-74













11-75

              Pole-Zeros from Step Response and Time-domain Parameters
              
Figure P11-75
                shows the step response
                g
                (
                t
                ) of a circuit.
              


(a)
                  From the graph, locate the step response poles on a pole-zero diagram.
                

(b)
                  From the graph, determine the circuit's rise time
                  T
R
                  , delay time
                  T
D
                  , and overshoot.
                

(c)
                  Comment on the size of the overshoot relative to the poles' location.
                  







FIGURE P11-75
















Notes





1

              In this context,
              Y
              (
              s
              ) is not an admittance but the transform of the output waveform
              y
              (
              t
              ).
            


2

              Not all books make this distinction. Books on signals and circuits often use
              H
              (
              s
              ) to represent both a transfer function and the impulse response transform.
            


3

              Recall from
              Chapter 5
              that a waveform is causal if
              f
              (
              t
              ) = 0 for all
              t
              < 0. If the impulse response
              h
              (
              t
              ) is not causal, the upper limit in the convolution integral becomes +∞. If the input
              x
              (
              t
              ) is not causal, the lower limit becomes -∞.
            


4

              There have been several innovations in the design of high-energy storage capacitors motivated by the electric vehicle industry and the push for large energy storage to support renewable energy. Electronic double-layer capacitors (EDLC) and single-layer carbon (Graphene) capacitors, often referred to as
              supercapacitors
              or
              ultracapacitors,
              can boast to have capacitances of up to 13.5 kF.
            


5

              Inductors up to 150 H are possible but are large and expensive.
            


6

              Resistors are manufactured outside this range but are used only in specialty applications.
            
















CHAPTER 12

FREQUENCY RESPONSE





This velocity is so nearly that of light that it seems we have strong reason to conclude that light itself... is an electromagnetic disturbance in the form of waves propagated through the electromagnetic field according to electromagnetic laws.


          James Clerk Maxwell, 1864
          
          Scottish Physicist
        






Some History Behind This Chapter

            James C. Maxwell's stellar achievement was that an electric field, a magnetic field, and light could all be explained using a single theory based on his electromagnetic theory of light propagation that he presented in 1864 in the publication of
            A Dynamical Theory of the Electromagnetic Field
            . Thus, he gave rise to the understanding of the electromagnetic spectrum. In 1888, Heinrich Hertz used Maxwell's theory to create instruments capable of sending and receiving radio pulses. Then, Hendrik Bode, working at Bell Telephone Labs in the 1930s, developed an approach to frequency response based on logarithmic plots and straight-line approximations, today called Bode plots. These are industry-standard ways to describe the frequency response of circuits and systems.
          









Why This Chapter Is Important Today
Frequency response is a major theme in the analysis and design of circuits that perform functions like amplifiers, filters, or oscillators. Phasor analysis involved a single-frequency steady-state response. Network functions allowed us to describe steady-state responses over many frequencies. In this chapter, we will use Bode diagrams to quickly visualize how the poles and zeros of a network function affect the frequency response of a circuit.









Chapter Sections



12-1 The Electromagnetic Spectrum and Frequency-Response Descriptors






12-2 Bode Diagram Descriptors






12-3 First-Order Low-Pass and High-Pass Responses






12-4 Bandpass and Bandstop Responses







                  12-5 The Frequency Response of
                  RLC
                  Circuits
                






12-6 Bode Diagrams






12-7 Frequency Response and Step Response












Chapter Learning Objectives

12-1
            Electromagnetic Spectrum and First-Order Circuit Frequency Response (
            Sects. 12-1
            to
            12-3
            )
          
Given the relationship between frequency, wavelength, and energy, and the basic uses of the electromagnetic spectrum:

            Find
            f
            , λ, or
            E
            given two of the variables.
          
Given a first-order circuit or transfer function:

(a) Understand and use frequency-response descriptors.
(b) Find and classify the frequency response.
(c) Plot the gain and phase responses using computer tools.
(d) Design circuits to produce a specified frequency response.


12-2
            Bandpass and Bandstop Responses (
            Sect. 12-4
            ) Given a cascade or parallel connection of first-order circuits:
          

(a) Find and classify the frequency response.
(b) Plot the gain and phase responses using computer tools.
(c) Design circuits to produce a specified frequency response.


12-3
            The Frequency Response of
            RLC
            Circuits (
            Sect. 12-5
            )
          

            Given an
            RLC
            circuit connected as a bandpass or a bandstop filter:
          


              (a) Find the frequency-response descriptors
              Q
              and
              B
              .
            
(b) Design circuits to produce a specified frequency response.

              (c) Compare the bandpass and bandstop responses obtained from
              RLC
              filters with similar ones using first-order filters.
            


12-4
            Bode Plots (
            Sects. 12-6
            and
            12-7
            )
          
Given a linear circuit or transfer function:

(a) Plot the gain and phase responses using computer tools.
(b) Develop a transfer function from a straight-line Bode gain plot.
(c) Design a circuit that produces a given straight-line gain plot.


12-5
            Frequency Response and Step Response (Sect. 12-8)
          
Given a circuit or a transfer function:

(a) Find the gain response corresponding to a given step response or vice versa.
(b) Use the relationship between frequency and step responses to choose the best solution for a design specification.






          12-1 The Electromagnetic Spectrum and Frequency-Response Descriptors
        

Electromagnetic Spectrum

            In order to understand the concept of frequency response, a brief introduction to the
            electromagnetic spectrum
            is in order. Maxwell gave rise to the understanding that all electrical and magnetic waves travel in a vacuum at the speed of light (
            c
            = 3 × 10
            8
            m/s). The relationship between the frequency of the waves
            f
            in hertz and their wavelength λ in meters is given as
          


(12-1a)




            Also, electromagnetic waves carry energy
            E
            expressed in eV (electron volts.) The higher the frequency the higher the energy. This relationship is given as
          


(12-1b)




            where
            h
            is Planck's constant (4.136 × 10
            -15
            eV-s). Frequencies start at dc,
            f
            = 0, and go to infinity. The nature of the particular frequency lends to its usefulness. Low frequencies are used for power applications (50, 60, and 400 Hz). Frequencies between 20 and 20,000 Hz are used for sound and audio applications (human speech and hearing are in this range). Starting at 500 kHz to roughly 1 GHz, most radio and television broadcasting occurs. A microwave oven operates at 2.45 GHz, which is the frequency that excites a water molecule - thereby cooking the food. Then in the gigahertz range from 3 GHz to up to 100 GHz, we have radar and cellular communications. Above this range, it becomes convenient to use wavelength rather than frequency. Infrared radiation begins at around 1 µm to about 700 nm. Then from 700 nm to 400 nm, we have visible light. Beyond that we have ultraviolet radiation followed by X-rays, gamma rays, and cosmic rays - all of increasing energy. Our Sun's radiation is primarily from 2500 nm to 250 nm, providing energy in the infrared (heat) and visible wavelengths. Today's semiconductor industry designs chips using nanometer (10
            -9
            m) technology approaching the size of an atom, which on average is 10
            -10
            m. The electromagnetic spectrum is shown in
            Figure 12-1
            .
          

            One may wonder why radio frequencies like the AM band (550 kHz to 1640 kHz) are used for audio broadcasting and television from 54 to 902 MHz for video. If one wanted to broadcast audio frequencies from 20 to 20 kHz, one would need
            
            unrealistically long antennas (at least one-half wavelength (7.5 km)). But if one could couple this audio signal to a high frequency carrier, a process called modulation, say at 1000 kHz, the broadcasting antenna needs to be only about 50 m. The audio station would take up only about 20 kHz of the spectrum - its allocated bandwidth or frequency real estate. So, in the AM band, one can allocate some 55 radio stations. Video signals require more frequency space or bandwidth, about 6 MHz per station, and therefore, they need to be modulated with carriers that are at higher frequencies. Cell phones initially operated at 0.85 GHz, but as the first generation (1G) became 2G, to today's 4G, smartphones needed to carry more information faster. The current 2.86 GHz frequency allocated to 4G was becoming limited. With the need to have autonomous cars and drones and the Internet of Things (IoT) or linked machines, envisioned for the very near future, cell-phone providers are looking to operate at even higher frequencies. C-band, a range of frequencies from 4 to 8 GHz is currently used for satellite television and geosynchronous links. A small unused portion between 3.7 and 4.2 GHz has recently been allocated for 5G cellular transmission. 5G is initially projected to use a bandwidth of 500 MHz, but would like to eventually increase to 1.2 GHz.
          








FIGURE 12-1




The Electromagnetic Specrum showing the relationship between frequency, wavelength, and energy.




            Our study thus far has been from dc to relatively low frequencies, up to about 1 GHz. That is for a reason. The
            R, L
            , and
            C
            components we work with are called
            lumped components.
            A lumped component is an element that is smaller than the wavelength of the applied signal. This means simply that the device follows its own
            i-
            υ characteristics. The connecting wires have no effect on their behavior. As frequencies increase, the wires start to play a role and parasitic properties of components (see
            Appendix G
            ) come into play. When lumped components no longer work, then one uses
            distributed elements.
            These behaviors are well beyond the scope of this text and can be studied in courses on electromagnetics and communications.
          







Exercise 12-1


How many different audio stations could be transmitted on a single TV channel? How many in the small portion of the C-band initially planned for 5G?
Answers:
300 stations. 25,000 stations.




Frequency - Response Descriptors

            In
            Chapter 11
            , we learned that the sinusoidal steady-state output can be found by evaluating the transfer function
            T
            (
            s
            ) at
            s
            =
            j
            ω, where ω is the frequency of the sinusoidal input. The function
            T
            (
            j
            ω) determines the amplitude and phase angle of the output through the
            gain
            function |
            T
            (
            j
            ω
            )|
            and
            phase
            function θ(ω) = <
            T
            (
            j
            ω). Recall
            Figure 11-26
            , which demonstrates the following
          





            The value of gain and phase functions are frequency dependent and together reveal how a circuit responds to input sinusoids of different frequencies. This frequency-dependent relationship between sinusoidal inputs and the resulting steady-state outputs is called the
            frequency response
            of the circuit.
          

            Frequency-response concepts and techniques find wide applications in communication, control, and instrumentation systems. A key component in these applications is the electronic
            filter,
            a signal processor that modifies or reshapes the frequency content of signals.
          

            The gain and phase functions can be expressed mathematically or presented graphically, as shown in
            Figure 12-2
            . Most of the descriptive
            
            terminology of frequency response is based on the shape of the gain function. For example, the gain plot in
            Figure 12-2
            is relatively constant at lower frequencies and decreases rapidly at higher frequencies. The range of frequencies with nearly constant gain is called a
            passband.
            The range of frequencies with significantly reduced gain is called a
            stopband.
            The frequency associated with the transition from a passband to an adjacent stopband is called the
            cutoff frequency,
            denoted as ω
            C
            or
            f
C
            .
          








FIGURE 12-2




Typical frequency-response plots.




            In linear circuits, there is a gradual transition from a passband to a stopband, so the location of the cutoff frequency is a matter of definition. The most widely used definition assigns cutoff to the frequency at which the passband gain decreases by a factor of
            
            from its maximum value. Under this definition ω
            C
            is found from the condition
          



(12-2)





            where
            T
max
            is the maximum gain in the passband.
          

            Additional terminology is based on the four basic types of gain responses in
            Figure 12-3
            . The figure also shows the sinusoidal input and outputs for each type.
          








FIGURE 12-3




Four basic gain responses.





            The input to all four is a composite signal consisting of three equal-amplitude sinusoids at distinct frequencies ω
            1
            , ω
            2
            , and ω
            3
            . The output signals all contain the same three frequencies but have amplitudes modified by the form of the gain response.
          


              The
              low-pass
              gain response has a single passband extending from zero frequency (dc) to ω
              C
              This type of gain passes the input at ω
              1
              unchanged and attenuates the inputs at ω
              2
              and ω
              3
              since they fall in the stop-band above ω
              C
              .
            

              The
              high-pass
              response has a single passband extending from ω
              C
              to infinite frequency. This type of gain passes the inputs at ω
              2
              and ω
              3
              unchanged and attenuates the input at ω
              1
              since it falls in the stopband below ω
              C
              .
            

              The
              bandpass
              response has a single passband with two adjacent stopbands— one below ω
              C1
              and another above ω
              C2
              . This gain response passes the input at c 2 unchanged and attenuates the inputs at ω
              1
              and ω
              3
              .
            

              The
              bandstop
              response also called
              band-reject
              response, has a single stopband with two adjacent passbands— one below ω
              C1
              and another above ω
              C2
              . This gain attenuates the input at ω
              2
              and passes the inputs at ω
              1
              and ω
              3
              unchanged.
            


            The element impedances
            Z
            (
            s
            ) play a key role in circuit frequency response. Replacing
            s
            by
            j
            ω and evaluating at Z(
            j
            ω) at ω = 0 (dc) and ω = ∞ leads to the important conclusion shown in
            Table 12-1
            . The first row in
            Table 12-1
            shows that the impedance of a resistor does not change with frequency. The next row shows that a capacitor has an infinite impedance (an open circuit) at dc and zero impedance (a short circuit) at infinite frequency. In the last row, we see that an inductor acts like a short circuit at dc and an open circuit at infinite frequency. These conclusions are worth remembering because they often help us see how a circuit produces particular gain responses.
          






Table 12-1




PASSIVE ELEMENT IMPEDANCES AT ZERO AND INFINITE FREQUENCY







Impedance at




Element


ω
= 0


ω = ∞






                    Resistor Z
                    
r
                      =
                      r



R


R




                    Capacitor Z
                    c
                    = 1/
                    j
                    ω
                    C

∞ Open circuit
0 Short circuit



                    Inductor
                    Z
l
                    =
                    j
                    ω
                    L

0 Short circuit
∞ Open circuit







12-2 Bode Diagram Descriptors

          The gain |T(
          j
          ω)| is often expressed in
          decibels
          (dB), defined as
        



(12-3)





          Some understanding of the decibel scale is necessary to construct and interpret gain-response plots. A gain of |T(
          j
          ω)| = 10
          
n

          expressed in dB is |
          T
          (
          j
          ω)|
          dB
          = 20 log
          10
          (10
          
n

          ) = 20
          n
          dB. The gain of
          
          expressed in dB is 20 log
          10
          (
          T
max
          )-20 log
          10
          (
          
          ) = |
          T
max
          |
          dB
          -3 dB. In other words, the cutoff frequency occurs when the passband gain is reduced by 3 dB. For this reason, the cutoff frequency is sometimes referred to as the 3-dB down frequency.
        

Table 12-2
          lists other values of |
          T
          (
          j
          ω)| and the corresponding values of | 
          T 
          ( 
          j  
          ω)   
          |
dB
.   
          Note in particular that a gain of 1 is 0 dB and a gain of 2 is + 6 dB while a gain of 0.5 is -6. This means that the gain 2|
          T
          ( 
          j 
          ω)| expressed in dB is | 
          T   
          ( 
          j   
          ω)|  
          dB   
          +6 dB while |T(
          j    
          ω)|/2 is |  
          T    
          (   
          j 
          ω)|    
          dB 
          - 6dB.    
        
    
          The frequency range of interest is often so wide that a linear frequency scale tends to mask important features for the response. For this reason, frequency-response plots almost always use a logarithmic scale for the frequency variable. The use of log-frequency scales is a standard practice, and the resulting response plots are called
          Bode diagrams.





Bode diagrams are plots of the gain  
                |
                T
                (
                j
                ω)|
                dB
and phase
                θ(ω)
                versus log-frequency.





          The use of log-frequency scales involves some special terminology. An
          octave
          is any frequency range whose end points have a 2:1 ratio, and a
          decade
          is any range with
          
          a 10:1 ratio. For example, the frequency range from 10 Hz to 20 Hz is one octave, as is the range from 20 to 40 MHz. The standard UHF (ultrahigh frequency) band spans a one-decade range from 0.3 GHz to 3 GHz. The audio range from 20 Hz to 20 kHz spans three decades.
        






Table 12-2




VALUES OF GAIN AND GAIN IN DB








                    |
                    T

                  (
                  j
                  ω)|
                


                    |
                    T

                  (
                  j
                  ω)
                  |

dB







                  10
                  3

60



                  10
                  2

40


10
20


2
6





3


1
0





-3


0.5
-6



                  10
                  -1

-20



                  10
                  -2

-40



                  10
                  -3

-60




In summary, Bode diagrams, or Bode plots, as they are sometimes called, are used to describe the frequency response of circuits and systems. Although it is convenient to use software to create Bode plots —such as MATLAB, to analyze transfer functions, or Multisim to simulate a circuit's behavior—it is useful to understand how poles, zeros, and different circuit elements give rise to the various features in a Bode diagram. In the sections that follow, we will spend some time relating the circuit's behavior to the resulting Bode diagram. We will also see how acircuit's damping coefficient ζ can significantly affect its frequency response. Understanding these behaviors will help us in learning to analyze, design, and evaluate filters.







                APPLICATION
                EXAMPLE 12-1



              The use of the decibel as a measure of performance pervades the literature and folklore of electrical engineering. The decibel originally came from the definition of power ratios in
              
                bels.
                
1






The decibel (dB) is more commonly used in practice. The number of decibels is 10 times the number of bels:




              When the input and output powers are delivered to equal input and output resistances
              R
              , then the power ratio can be expressed in terms of voltages across the resistances.
            



or in terms of currents through the resistances:




              The definition of gain in dB in
              Eq. (12-3)
              is consistent with these results, since in the sinusoidal steady state the transfer function equals the ratio of output amplitude to input amplitude. The preceding discussion is not a derivation of
              Eq. (12-3)
              but simply a summary of its historical origin. In practice,
              Eq. (12-3)
              is applied when the input and output are not measured across resistances of equal value.
            
When the chain rule applies to a cascade connection, the overall transfer function is a product





              where
              T
1
              ,
              T
2
              , ...,
              T

N

              are the transfer functions of the individual stages in the cascade. Expressed in dB, the overall gain is
            



Because of the logarithmic definition, the overall gain (in dB) is the sum of the gains (in dB) of the individual stages in a cascade connection. The effect of altering a stage or adding an additional stage can be calculated by simply adding or subtracting the change in dB. Since summation is simpler than multiplication, the enduring popularity of the dB comes from its logarithmic definition, not its somewhat tenuous relationship to power ratios.










Exercise 12-2

A sinusoidal signal with a peak voltage of 3.7 V is input into a frequency-dependent circuit. What is its peak voltage at its - 3 dB frequency? What is its peak voltage at its -10 dB frequency?
Answers:
2.62V, 1.17V










Exercise 12-3


(a) A transfer function has a passband gain of 25. At a particular frequency in its stopband, the gain of the transfer function is only 0.0006. By how many decibels does the gain of the passband exceed that of that frequency in the stopband?
(b) A particular filter is said to be 83 dB down at a desired stop frequency. How many times reduced is a signal at that frequency compared to a signal in the filter's passband?

Answers:

(a) 92.4 dB,
(b) By 14,125 times.





12-3 First-Order Low-Pass and High-Pass Responses

First-Order Low-Pass Response
We begin the study of frequency response with the first-order low-pass transfer function:



(12-4)





            The constants
            K
            and a are real. The constant
            K
            can be positive or negative, but a must be positive so that the natural pole at
            s
            = - α is in the left half of the
            s
            plane to ensure that the circuit is stable. Remember, the concepts of sinusoidal steady state and frequency response do not apply to unstable circuits that have poles in the right half of the
            s
            plane or on the
            j
            -axis.
          

            To describe the frequency response of the low-pass transfer function, we replace
            s
            by
            j
            ω in
            Eq. (12-4)
            as we saw in
            Chapter 11
section 11-5
            , thus
          


(12-5)





            and express the gain and phase functions as
          



(12-6)





            The value of the gain function is a positive number. Since
            K
            is real, the angle of
            
            is either 0° when
            K
            >0 or ±180° when
            K
            < 0. An example of a negative
            K
            occurs in an inverting OP AMP configuration where
            T
            (
            s
            ) = −
            Z
2
            (
            s
            )/
            Z
1
            (
            s
            ).
          

Figure 12-4
            shows Bode plots of the gain and phase of the first-order low-pass function using a log scale for the normalized frequency ω/α. The gain plot displays a low-pass characteristic with a passband at low frequency and a stopband at high frequency. The maximum passband gain occurs at ω = 0, where
            T
max
            = |
            K|
            /α. The gain gradually decreases as frequency increases until at ω = α we have
          


(12-7)




            Referring to
            Eq. (12-2)
            , we conclude that ω
            C
            = α is the cutoff frequency marking the boundary between a low-frequency passband and a high-frequency stopband. This boundary occurs when ω/α = 1 as shown in
            Figure 12-4
            .
          

            The low- and high-frequency gain asymptotes shown in
            Figure 12-4
            are especially important. The low-frequency asymptote is the horizontal line and the high-frequency
          








FIGURE 12-4




First-order low-pass Bode plots.





            asymptote is the sloped line. At low frequencies (ω ≪ α), the gain approaches |T(
            j
            ω)| → |
            K
            |/α. At high frequencies (ω ≫ α), the gain approaches|
            T
            (
            j
            ω)|→
            \|K|
            /ω. The intersection of the two asymptotes occurs when |
            K|
            /
            α
            = |
            K|
            /ω. The intersection forms a "corner" at ω = α, so the cutoff frequency is also called the
            corner frequency.


            The high-frequency gain asymptote decreases by a factor of 10 (-20 dB) whenever the frequency increases by a factor of 10 (one decade). As a result, the high-frequency asymptote has a slope of - 1or - 20 dB per decade and the low-frequency asymptote has a slope of 0 or 0 dB/decade. These two asymptotes provide a straight-line approximation to the gain response that differs from the true response by a maximum of 3 dB or a factor of
            
            at the corner frequency.
          

            The semilog plot of the phase shift of the first-order low-pass transfer function is shown in
            Figure 12-4
            . At ω = α the phase angle in
            Eq. (12-6)
            is
          




            At low frequency (ω ≪ α), the phase angle approaches
            
            and at high frequencies (ω ≫ α) the phase approaches
            
            - 90°. Almost all of the - 90° phase change occurs in the two-decade range from ω/α = 0.1 to ω/α = 10. The straight-line segments in
            Figure 12-4
            provide an approximation of the phase response. The phase approximation below ω/α = 0.1 is θ =
            
            and above ω/α = 10 is θ =
            
            - 90°. Between these values, the phase approximation is a straight line that begins at θ =
            
            , passes through θ =
            
            - 45° at the cutoff frequency, and reaches θ =
            
            - 90° at ω/α = 10. The slope of this line segment is - 45°/decade since the total phase change is - 90° over a two-decade range.
          

            Straight-line approximations for a first-order low-pass transfer function need two parameters, the value of
            T
            (0) and α. The parameter α defines the cutoff frequency and the value of
            T
            (0) defines the passband gain |
            T
            (0)| and the low-frequency phase
            
            . The required quantities
            T
            (0) and α can be determined directly from the transfer function
            T
            (
            s
            ) and can often be estimated by inspecting the circuit itself.
          
The logarithmic scales in Bode plots provide a useful way of visualizing a circuit's frequency response. Often, such graphical plots are adequate for developing analysis and design approaches. For example, the frequency response of the first-order low-pass function can be characterized by calculating the gain and phase over a two-decade band from one decade below to one decade above the cutoff frequency.













EXAMPLE 12-2




                    Consider the circuit in
                    Figure 12-5
                    (a). Find the transfer function
                    T
                    (
                    s
                    ) =
                    V
2
                    (
                    s
                    )/
                    V
1
                    (
                    s
                    ), α, and ω
                    C
                    , and construct the straight-line approximations to the gain and phase responses.
                  




SOLUTION:


Applying voltage division, the voltage transfer function for the circuit is




                Comparing this with
                Eq. (12-4)
                , we see that the circuit has a low-pass gain response with α =
                R
                /
                L
                and
                T
                (0)=1. Therefore, |
                T
                (0)|
                dB
                =0dB, ω
                C
                =
                R
                /
                L
                , and
                
                . Given these quantities, we construct the straight-line approximations shown in
                Figure 12-5
                (b). Note that the frequency scale in
                Figure 12-5
                (b) is normalized by multiplying co by
                L
                /
                R
                = 1/α.
              








FIGURE 12-5









Circuit interpretation:
                The low-pass response in
                Figure 12-5
                (b) can be explained in terms of circuit behavior. At zero frequency, the inductor acts like a short circuit that directly connects the input port to the output port to produce a passband gain of 1 (or 0 dB). At infinite frequency the inductor acts like an open circuit, effectively disconnecting the input and output ports and leading to a gain of zero. Between these two extremes the impedance of the inductor gradually increases, causing the circuit gain to decrease. In particular, at the cutoff frequency we have ω
                L = R
                , the impedance of the inductor is
                j
                ω
                L
                =
                jR,
                and the transfer function reduces to
              




                In other words, at the cutoff frequency, the gain is - 3 dB and the phase shift is - 45°. Obviously, the changing impedance of the inductor gives the circuit its low-pass gain features.
                ■















                Design
                
                  Exercise 12-4
                  



                For the circuit of
                Figure 12-5
                (a), select values of
                R
                and
                L
                so that the cutoff frequency occurs at 10 kHz. Then build your design in Multisim and perform an AC sweep. Verify that your design meets the necessary requirements.
              
Answers:

R
                = 100 kΩ,
                L
                = 1.591 H. Many other designs are possible. But the results of this design are shown in
                Figure 12-5
                (c).
              











                Evaluation
                Exercise 12-5


                A student designed a low-pass filter with a required cutoff frequency of 1000 Hz using the circuit of
                Figure 12-5
                (a). When he measured the output at the - 3 dB frequency, he was surprised that the output had decreased by 16.1 dB. He checked his values of
                R
                and
                L
                and their ratio
                R
                /
                L
                = 1000, just as he designed it. What did he do wrong?
              








FIGURE 12-5















FIGURE 12-5







Answers:


                Since the cutoff frequency is expressed in radians per second, he should have used
                R
                /
                L
                = 2π × 1000 = 6283 rad/s in his design. Instead, he used only an equivalent frequency of 159.2 Hz.
              
















                    DESIGN EXAMPLE 12-3
                  

                    Design an
                    RC
                    low-pass filter with a cutoff frequency of 1 krad/s and a passband gain of 1.
                  




SOLUTION:



                The transfer function for a low-pass filter was shown in
                Eq. (12-4)
                to be
              




                where
                K
                is a constant to be determined and α is the cutoff frequency. We can design this circuit using a simple
                RC
                voltage divider with the output taken across the capacitor.
              




                We can see that α
                =
                1/
                RC
                = 1000 rad/s, and for the passband gain to be 1,
                K
                must equal α. We need to select
                R
                and
                C
                so the reciprocal of their product equals 1000 rad/s. Using standard values we select
                R
                = 1 kΩ and
                C
                = 1 µF. Many other solutions are possible.
                ■

















                    Design
                    Exercise 12-6




                Design an
                RC
                low-pass filter with a cutoff of 100 rad/s and a passband gain of + 4.
              
Answers:

                See
                Figure 12-6
                . A different approach is shown in
                Design and Evaluation Example 12-4
                .
              










FIGURE 12-6























DESIGN AND EVALUATION EXAMPLE 12-4



                      (a) Show that the transfer function
                      T
                      (
                      s
                      ) =
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ) in
                      Figure 12-7
                      has a low-pass gain characteristic.
                    
(b) Select element values so the passband gain is -4 and the cutoff frequency is 100 rad/s.
(c) Use Multisim to simulate the frequency response of the results in part (b).

                      (d) Compare the two approaches in
                      Exercise 12-6
                      and this Example.
                    





SOLUTION:




                  (a) The circuit is an inverting amplifier configuration with
                  










FIGURE 12-7









                    The circuit transfer function is found as
                  




                    Rearranging the standard low-pass form in
                    Eq. (12-4)
                    as
                  



shows that the circuit transfer function has a low-pass form with




                    This is an inverting circuit, so the - 90° phase swing of the low-pass form runs from
                    
                    , passing through
                    
                    along the way.
                  

Circuit interpretation:
                    The low-pass response is easily deduced from known circuit performance. At dc the capacitor acts like an open circuit and the circuit in
                    Figure 12-7
                    reduces to a resistance inverting amplifier with
                    K
                    =
                    T
                    (0) = -
                    R
2
                    /
                    R
1
                    . At infinite frequency the capacitor acts like a short circuit that connects the OP AMP output directly to the inverting input. This connection results in zero output since the node voltage at the inverting input is necessarily zero. In between these two extremes, the gain gradually decreases as the decreasing capacitor impedance gradually pulls the OP AMP output down to zero at infinite frequency.
                  


                  (b) The design constraints require that ω
                  C
                  = 1/
                  R
2
C
2
                  = 100 and |
                  T
                  (0)|=
                  R
2
                  /
                  R
1
                  =4. Selecting
                  R
1
                  =10 kΩ implies that
                  R
2
                  =40 kΩ
                  .
                  and
                  C
2
                  =0.25 µF.
                

                  (c) To verify our results using Multisim, we build our circuit as shown in
                  Figure 12-8
                  and drive it with the ac signal source set at 1 V peak. (Do not use the ac power source since it uses rms values.) With the input set at 1 V, the output is the transfer function, that is,
                  T
V
                  =
                  V
2
                  /
                  V
1
                  =
                  V
2
                  /1 =
                  V
2
                  . We select "AC sweep" under "Analyses and simulation." We sweep from 1 Hz to 1 kHz using the "Decade" sweep. We ask Multisim to calculate the output with 1000 points per decade to improve the accuracy and smooth the curve. Since we anticipate the output will cover several decades, we ask for a "Logarithmic" vertical scale. We label the output node "Output", and ask Grapher View to plot the output voltage (Gain in our case). Once the results open, we delete the phase portion since it was not requested and select the left axis to be displayed in dBs. The design task was for a gain of 4 at
                  T
                  (0), hence, Gain = 20 log
                  10
T
                  (0) = 20 log
                  10
                  (4) = 12.04 dB. The gain at 1 Hz is almost the same as it would be at its maximum at dc, so we measure the gain there and it is 12.02 dB. The gain at 100 rad s should be -3 dB from the gain at dc or 9.04 dB, our cursor says it is 9.03 dB. Both measurements are shown in
                  Figure 12-8
                  . The circuit performed as desired.
                

                  (d) The two circuits have the same gain response. However, the Example circuit introduces a 180° phase shift due to the use of an inverting OP AMP. Also, the Example circuit runs the risk of loading at the input if the circuit that is connected to it has a resistance greater than 1 kΩ. In that case, the gain would change but not the pole location. The one advantage of the Example circuit is that it uses one component less.
                  ■















Exercise 12-7


                The circuit of
                Figure 12-8
                has the following sinusoids applied to its input. Using only the plot in
                Figure 12-8
                , find the approximate amplitude of the sinusoid exiting the circuit.
              








FIGURE 12-8









                  (a) υ
                  1
                  (
                  t
                  ) = 100 cos 2π
                  t
                  mV
                

                  (b) υ
                  1
                  (
                  t
                  ) = 100 cos 200π
                  t
                  mV
                

                  (c) υ
                  1
                  (
                  t
                  ) = 100 cos 2000π
                  t
                  mV
                

Answers:


                Reading the decibels from the graph, we get for each signal the following:
              

(a) About +12 dB, hence 100 × 4 = 400 mV
(b) About -4 dB, hence 100 × 0.63 = 63.0 mV
(c) About -24 dB, hence 100 × 0063 = 6.3 mV




Note:


                A more accurate reading could be obtained by using the cursor. If even more accuracy is desired, simulating the circuit using 10,000 or more points per decade and using the cursor would provide added accuracy. However, often simply reading the graph can be sufficient.
              











                Design
                Exercise 12-8

Design a low-pass active filter that has a gain of -10 and a cutoff frequency of 10 krad/s.
Answers:

                Use the circuit of
                Figure 12-7
                with
                R
1
                = 10 kΩ,
                R
2
                = 100 kΩ, and
                C
                = 1000 pF. Other designs are possible.
              





            Gain-Bandwidth Product (
            GB
            )
            
2



            In terms of frequency response, the ideal OP AMP model introduced in
            Chapter 4
            assumes that the device has an infinite gain and an infinite bandwidth. The OP AMP used in Multisim to model the ideal OP AMP, the
            OPAMP_3T_VIRTUAL,
            approximates the ideal OP AMP. The model can be further idealized by clicking on the device and modifying its parameters. For example, one can adjust the open-loop gain to be 10
            15
            , the input resistance to be 1
            T
            Ω
            ,
            the output resistance to be 1
            p
            Ω
            ,
            and, most importantly, the unity gain-bandwidth to be 1 THz. However, using the ideal model, while simplifying the design and analysis of OP AMP circuits, can mask the behavior of circuits built using real OP AMPs. A more realistic model of the device is shown in
            Figure 12-9
            (a).
          








FIGURE 12-9









            The controlled source gain in
            Figure 12-9
            (a) is a low-pass transfer function with a dc gain of
            A
            and a cutoff frequency ω
            C
            . The straight-line asymptotes of controlled source gain are shown in
            Figure 12-9
            (b). The
            gain-bandwidth product
            (
            GB
            = Aω
            C
            ) is the basic performance parameter of this model.
          
With no feedback, the OP AMP transfer function is the same as the controlled-source transfer function. The gain-bandwidth product of the open-loop transfer function is


(12-8a)





            The closed-loop transfer function of the circuit in
            Figure 12-9
            (a) is found by writing the following device and connection equations that include a pole that is an inherent property of the particular OP AMP:
          



Substituting the connection equations into the OP AMP device equation yields





            Solving for the closed-loop transfer function produces
          




            The straight-line asymptotes of the closed-loop transfer function are shown in
            Figure 12-9
            (c).
          

            The closed-loop circuit has a low-pass transfer function with a dc gain of
            A
            (
            A
            + 1) and a cutoff frequency of (
            A
            + 1)ω
            C
            . The gain-bandwidth product of the closed-loop circuit is
          



(12-8b)





            which is the same as the open-loop case. In other words, the gain-bandwidth product in
            Eq. (12-8b)
            is invariant and is not changed by feedback. It can be shown that this result is a general one that applies to all linear OP AMP circuits, regardless of the circuit configuration.
          

            The gain-bandwidth product is a fundamental parameter that limits the frequency response of OP AMP circuits. For example, an OP AMP with a gain-bandwidth product of
            GB
            = 10
            6
            Hz is connected as a noninverting amplifier with a closed-loop gain of 20. The frequency response of the resulting closed-loop circuit has a low-pass characteristic with a passband gain of 20 and a cutoff frequency of
          



The next example demonstrates the effects of the gain bandwidth product on a realistic design.














                    APPLICATION DESIGN EXAMPLE 12-5
                  
Design a low-pass filter with a gain of -1000 and a cutoff frequency of 20 kHz. Compare the frequency response of the same design between an ideal OP AMP and a UA741 general-purpose OP AMP using Multisim. If there is a problem with the UA741 design, suggest how to fix it.




SOLUTION:


We need to design a circuit to realize the following transfer function




                A low-pass filter using an ideal OP AMP inverting amplifier, as shown in
                Figure 12-10
                (a), is an efficient design that will realize the transfer function. An AC sweep using Multisim shows in Grapher View of
                Figure 12-10
                (d) that the circuit performs as desired. However, when one goes into the laboratory, one cannot find any ideal OP AMPs. Instead, one can usually find a UA741 general-purpose OP AMP. Building the same circuit using a real OP AMP as shown in
                Figure 12-10
                (b) gives a very different result. The cutoff frequency occurs around 940 Hz, not at the desired 20 kHz. The reason is that the UA741 OP AMP has a
                GB
                of about 1 MHz. With a desired gain of 1000, the gain begins to fall off at around 200 Hz and is only about 50 at 20 kHz, as one can see in the Grapher View (
                Figure 12-10
                (d)).
              








FIGURE 12-10









                Requiring a cutoff frequency of 20 kHz, the most gain using a single UA741 that can be obtained is
                
                . This would require cascading some 20 UA741 OP AMPs to reach a gain of 1000, which is very impractical. A reasonable approach is to use an OP AMP with a larger
                GB
                product. The AD848JN OP AMP, for example, has a
                GB
                of about 175 MHz. Using that OP AMP in the same circuit, as shown in
                Figure 12-10
                (c), shows that its performance approaches the ideal OP AMP's for this application. One might ask why bother with the UA741 if there are better products available. Generally, the answer is cost. The AD848JN and other large
                GB
                OP AMPs can cost $2, $8, or more even in quantity, whereas the UA 741 costs as little as $008 in small quantities. Furthermore, the limitations of the UA 741 make it a cheap and useful teaching tool for understanding OP AMP circuit design.
                Table 12-3
                summarizes the results of this analysis.
              






Table 12-3









OP AMP



GB



Gain @ 20 kHz



f


C

(kHz)





Ideal
1 THz
707
20.0


UA741
1 MHz
47.3
0.941


AD848JN
175 MHz
682
18.6





                Note, however, that in this text we will continue to rely on the ideal OP AMP and let courses in electronics discuss other options.
                ■














Exercise 12-9



                There are hundreds of different operational amplifiers that are designed to meet many varying needs. Gain-bandwidth is only one parameter. For example, an LF347D is a general-purpose OP AMP with a 3 MHz
                GB
                , a LH4161 is a high-speed OP AMP with a
                GB
                of 50 MHz, while an NJM2043D is a low-noise OP AMP pre-amplifier with a
                GB
                of only 12 Hz. Notwithstanding their other assets, what is the maximum frequency that each OP AMP can amplify, if a gain of 100 is desired?
              
Answers:

                LF347D,
                f
C
                = 30 kHz; LH4161,
                f
C
                = 500 kHz; NJM2043D,
                f
C
                = 012 Hz.
              




First-Order High-Pass Response
We next treat the first-order high-pass transfer function



(12-9a)





            The high-pass function differs from the low-pass case by the introduction of a zero at
            s
            = 0. Replacing
            s
            by
            j
            ω in
            T
            (
            s
            ) and solving for the gain and phase functions yields
          


(12-9b)




Figure 12-11
            shows Bode plots for the first-order high-pass function plotted using a log scale for the normalized frequency ω/α. The gain diagram displays a high-pass
            
            characteristic with a passband at high frequency and a stopband at low frequency. The maximum passband gain occurs at high frequency (ω ≫ α) where the gain |
            T
            (
            j
            ω)|→
            T
max
            = |
            K
            |. In the passband, the gain gradually decreases as frequency decreases until at ω = α we have
          








FIGURE 12-11




First-order high-pass Bode plots.





(12-10)




            Again invoking
            Eq. (12-2)
            , we find that ω
            C
            = α is the cutoff frequency marking the boundary between a high-frequency passband and a low-frequency stopband. This boundary is shown as ω/α = 1 in
            Figure 12-11
            .
          

            The low- and high-frequency gain asymptotes approximate the gain response in
            Figure 12-11
            . The high-frequency asymptote (ω ≫ α) is the horizontal line whose ordinate is |
            K|
            (slope = 0 or 0 dB/decade). The low-frequency asymptote (ω ≪ α) is a line of the form |
            K
            | ω/α (slope = +1 or +20 dB/decade). The intersection of these two asymptotes occurs when |
            K
            | = |
            K
            |ω/α, which defines a corner frequency at ω = α.
          

            The semilog plot of the phase shift of the first-order high-pass function is shown in
            Figure 12-11
            . The phase shift approaches
            
            at high frequency, passes through
            
            at the cutoff frequency, and approaches
            
            + 90° at low frequency. Most of the 90° phase change occurs over the two-decade range centered on the cutoff frequency. The phase shift can be approximated by the straight-line segments shown in
            Figure 12-11
            . As in the low-pass case,
            
            is 0° when
            K
            is positive and ±180° when
            K
            is negative.
          

            Similar to the low-pass function, the first-order high-pass Bode plots can be approximated using two parameters, the value of
            T
            (∞) and α. The parameter a defines the cutoff frequency, and the quantity
            T
            (∞) gives the passband gain |
            T
            (∞)| and the high-frequency phase angle
            
            . The quantities T(∞) and α can be determined directly from the transfer function or estimated directly from the circuit in some cases. The straight line shows that the first-order high-pass response can be characterized by calculating the gain and phase over a two-decade band from one decade below to one decade above the cutoff frequency.
          













EXAMPLE 12-6




                    Show that the transfer function
                    T
                    (
                    s
                    ) =
                    V
2
                    (
                    s
                    )/
                    V
1
                    (
                    s
                    ) in
                    Figure 12-12
                    has a high-pass gain characteristic. Construct the straight-line approximations to the gain and phase responses of the circuit.
                  




SOLUTION:


Applying voltage division, the voltage transfer function for the circuit is




                Rearranging
                Eq. (12-9a)
                as
              




                shows that the circuit has a high-pass gain characteristic with α = 1/
                RC
                and
                T
                (∞) = 1. Therefore, |
                T
                (∞)|
                dB
                =0 dB, ω
                C
                = 1/ RC, and
                
                . Given these quantities, we construct the straight-line gain and phase approximations in
                Figure 12-13
                . The frequency scale in
                Figure 12-13
                is normalized by multiplying ω by
                RC
                =1/α.
              








FIGURE 12-12









Circuit interpretation:
                The high-pass response in
                Figure 12-13
                can be understood in terms of known circuit behavior. At zero frequency, the capacitor acts like an open circuit that effectively disconnects the input signal source, leading to zero gain. At infinite frequency, the capacitor acts like a short circuit that directly connects the input to the output, leading to a passband gain of 1 (or 0 dB). Between these two extremes, the impedance of the capacitor gradually decreases, causing the gain to increase. In particular, at the cutoff frequency we have 1/ω
                C
                =
                R
                , the impedance of the capacitor is 1/
                j
                ω
                C
                = -
                jR,
                and the transfer function is
              











FIGURE 12-13








                In other words, at the cutoff frequency, the gain is -3 dB and the phase shift is +45°. Obviously, the decreasing impedance of the capacitor gives the circuit its high-pass gain characteristics.
                ■














Exercise 12-10


                The circuit shown in
                Figure 12-12
                has
                R
                = 2.2 kΩ and
                C
                = 033 µF. Calculate the gain of the circuit at ω = 1 krad/s in dB and its phase in degrees.
              
Answers:

                |T(
                j
                1000)|
                dB
                = -4.62 dB, 54.0°
              











                Design
                Exercise 12-11


                Design an
                RL
                high-pass filter with a cutoff of 10 krad/s and a passband gain of 1.
              
Answers:

                Use an
                RL
                voltage divider with the output taken across the inductor. Select
                R
                = 1 kΩ and
                L
                = 100 mH. Many other designs are possible.
              

















                    DESIGN EXAMPLE 12-7
                  


                      (a) Show that the transfer function
                      T
                      (
                      s
                      ) =
                      V
2
                      (
                      s
                      )/
                      V
1
                      (
                      s
                      ) of the circuit in
                      Figure 12-14
                      (a) has a high-pass gain characteristic.
                    
(b) Select the element values to produce a passband gain of -4 and a cutoff frequency of 40 krad/s.
(c) Use Multisim to simulate the design.





SOLUTION:




                  (a) The branch impedances of the inverting OP AMP configuration in
                  Figure 12-14
                  (a) are
                  


and the voltage transfer function is




                    This results in a high-pass transfer function of the form
                    Ks
                    /(
                    s
                    + α) with
                    K
                    = -
                    R
2
                    /
                    R
1
                    and a = ω
                    C
                    = 1/
                    R
1
C.









FIGURE 12-14















FIGURE 12-14









Circuit interpretation:
                    The high-pass response of this circuit is easily understood in terms of element impedances. At dc, the capacitor in
                    Figure 12-14
                    (a) acts like an open circuit that effectively disconnects the input source, resulting in zero gain. At infinite frequency, the capacitor acts like a short circuit that reduces the circuit to an inverting amplifier with
                    K
                    =
                    T
                    (∞) = -
                    R
2
                    /
                    R
1
                    . As the frequency varies from zero to infinity, the gain gradually increases as the capacitor impedance decreases.
                  


                  (b) The design requirements specify that 1/
                  R
1
C
                  = 4 × 10
                  4
                  and
                  R
2
                  /
                  R
1
                  =4. Selecting
                  R
1
                  =10 kΩ
                  .
                  requires
                  R
2
                  = 40 kΩ
                  .
                  and
                  C
                  = 2500 pF.
                

                  (c) The Grapher View of the simulation is shown in
                  Figure 12-14
                  (b). The simulation was conducted using an ideal OP AMP and then repeated using a practical OP AMP with a
                  GB
                  = 10 MHz. Both simulations show the same desired cutoff frequency
                  f
C
                  = 6.362 kHz or ω
                  C
                  = 39.97 krad/s, but the practical OP AMP simulation shows another pole at around 2.5 MHz, that is,
                  



                    This pole is caused by the limitations of the internal OP AMP design as discussed earlier. While one can postulate designing a high-pass filter, in reality, they will all be band-pass filters.
                    ■

















                Design
                Exercise 12-12

Design a high-pass filter that has the following transfer function:



Answers:

                Use the circuit of
                Figure 12-14
                with
                R
1
                = 1 kΩ,
                R
2
                = 200 kΩ, and
                C
                = 0.2 µF. Other solutions are possible.
              


















EVALUATION EXAMPLE 12-8

Your company issued a request for proposals listing the following design requirements and evaluation criteria.


Design requirements
                      call for a high-pass filter with a passband gain of unity and a cutoff frequency of 150 Hz±10%. The filter input is driven by a sensor with a 50-Ω
                      ,
                      source resistance.
                    

Evaluation criteria
                      are filter performance, parts count, power consumption, and cost. The three vendors have responded with the designs shown in
                      Figure 12-15
                      (a). As a junior engineer, you have been asked to evaluate the designs and identify the best design. Which vendor would you recommend and why?
                    









FIGURE 12-15











SOLUTION:


The design requirements describe a high-pass transfer function of the form



MATLAB will help in visualizing the gain requirement. The following MATLAB code is used.

                T=tf([10],[1 942.5]);
  w=logspace(2,4,10000);bode(T,w);grid
              

                We call MATLAB's transfer function routine,
                tf
                . The parenthesis in the call contains the transfer function. Inside each bracket are the coefficients of each
                s
                term in the numerators followed by the coefficients of each
                s
                term in the denominator. It is important to tell MATLAB when a term is missing. Hence, in the numerator, there is no
                s
0
                term so we enter a zero. We use
                logspace
                to plot the graph. In
                logspace
                , the first number is the exponent of the power of 10 that we want to start our plot, hence the 2 tells MATLAB to start at 10
                2
                = 100. The second number is where we want to end our sweep, 4 means 10
                4
                = 10,000. The final entry tells MATLAB how many calculations to make per decade. Finally, the
                bode
                command tells MATLAB to perform a Bode diagram of the transfer function. MATLAB returns a complete Bode gain and phase response; however, for this problem, we are interested only in the gain response. MATLAB allows for plotting just the gain in which case we would use
                bodemag (T,w)
                . This is shown in
                Figure 12-15
                (b).
              
Now that we know what to expect, we can analyze the performance of each of the three proposed filters. We could use MATLAB again; but for this problem, we will analyze each filter classically.








FIGURE 12-15









Vendor #1:
                Using voltage division to find
                T
                (
                s
                ) yields
              




                This is a high-pass response with |
                T
                (∞)| = 1 and
                f
C
                = 1000/(2π) = 1592 Hz.
              

Vendor #2:
                The circuit is an inverting amplifier whose transfer function is
              




                This is a high-pass response with |
                T
                (∞)| = 1 and
                f
C
                = 918.3/(2π) = 1462Hz.
              

Vendor #3:
                Using voltage division to find
                T
                (
                s
                ) yields
              




                This is a high-pass response with |
                T
                (∞)| = 1 and
                f
C
                = 1000/(2π) = 1592 Hz.
              


Discussion:


                  The analysis summary in
                  Table 12-4
                  shows that all three filters meet the basic passband gain
                
                (±1)
                and cutoff frequency
                (150 Hz± 10%
                requirements. The vendor #2 design can be eliminated because it has the largest part count, requires a dc power supply for its OP AMP, and has the highest cost. The vendor #3 filter has a serious loading problem that offsets its lower cost. This filter has a
                100-Ω
                input resistor that loads the specified
                50-Ω
                . input source. The actual cutoff frequency of the source
                /
                filter combination is
                (
                R
source
                +
                R
fiter
                )/
                L
                = (50 +100/0.1) = 1500 rad/s or 238.7 Hz,
                not the
                1592 Hz
                found by analyzing the filter in isolation. The input

impedance of the vendor #1 design is greater than
                10 kΩ,
                so it does not load the 50-
                Ω
                source. All factors considered, the best design is the filter proposed by vendor #1.







Table 12-4


                      analysis summary
                    







Passband Gain


Cutoff Freq. (Hz)


Parts Count


Power Consumption


Cost


Source Loading





Vendor #1
1
159.2
2
Low
$2.50
No


Vendor #2
-1
146.2
4
Medium
$3.50
No


Vendor #3
1
159.2
2
Low
$2.25
Yes





■


















                Evaluation
                Exercise 12-13


                Suppose that the evaluation task of
                Example 12-8
                included the requirement that the filter feed a 500-Ω recorder. Would the choice be different?
              
Answers:
Yes. The 500-Ω recorder would load both of the passive filters. Only the OP AMP solution from vendor #2 would work.










FIGURE 12-16















Exercise 12-14


                For each circuit in
                Figure 12-16
                , identify whether the gain response has low-pass or high-pass characteristics and find the passband gain and cutoff frequency.
              
Answers:


                  (a) High pass, |
                  T
                  (∞)| = 1/3, ω
                  C
                  = 66.7 rad/s
                

                  (b) Low pass, |
                  T
                  (0)| =2/3, ω
                  C
                  = 300 rad/s
                

                  (c) Low pass, |
                  T
                  (0)| = 1, ω
                  C
                  = 333 krad/s
                

                  (d) High pass, |
                  T
                  (∞)| = 1/3, ω
                  C
                  = 333 krad/s
                












                Design
                Exercise 12-15


                Consider the two circuits shown in
                Figure 12-17
                . Determine if each has a low-pass or high-pass characteristic. Then design each to have a cutoff frequency of 10 krad/s and a gain of 200. The input resistance must be ≥ 1kΩ.
              
Answers:


                  (a) This is a low-pass filter as shown in
                  Figure 12-7
                  . Select
                  R
1
                  =2 kΩ,
                  R
2
                  = 400 kΩ, and
                  C
                  = 250 pF.
                

                  (b) This is also a low-pass filter with ω
                  C
                  =
                  R
1
                  /
                  L
                  and gain = -
                  R
2
                  /
                  R
1
.
                  Select
                  R
1
                  = 2 kΩ,
                  R
2
                  = 400 kΩ, and
                  L
                  = 200 mH. In both cases, other designs are possible.
                











FIGURE 12-17














Exercise 12-16




                State whether the following transfer functions have low-pass or high-pass gain characteristics and find the passband gain and cutoff frequency.
              


                  (a)
                  


                  (b)
                  


                  (c)
                  


Answers:


                  (a) High pass, passband gain = 1000, ω
                  C
                  = 10 krad/s
                

                  (b) Low pass, passband gain = 0.1, ω
                  C
                  = 40 rad/s
                

                  (c) Low pass, passband gain = 1, ω
                  C
                  = 0.4 rad/s
                






12-4 Bandpass and Bandstop Responses

          Bandpass and bandstop responses are very useful features of electrical circuits. They find wide use in audio and communication applications. We already have briefly seen how a simple
          RLC
          circuit can be used to achieve these responses and will study
          RLC
          circuits in the next section in more depth. In this section, we will attain bandpass and bandstop responses using first-order high-pass and low-pass circuits as building blocks. In
          Chapter 14
          , we will develop more complex approaches to designing frequency-selective circuits.
        

Bandpass Response

Figure 12-18
            shows a cascade connection of first-order high-pass and low-pass circuits. When the second stage does not load the first, the overall transfer function can be found by the chain rule as
          



(12-11)






            Replacing
            s
            by
            j
            ω in
            Eq. (12-11)
            and solving for the gain response yields
          



(12-12)












FIGURE 12-18




Cascade connection of high-pass and low-pass circuits.
                (
                a
                )
                Physical construct.
                (
                b
                )
                How the individual filter characteristics combine to produce the bandpass response.



Note that the overall gain is zero at ω = 0 and again at infinite frequency. This pattern suggests a bandpass response. Also, if there is no loading, it does not matter if either the high-pass or the low-pass circuit comes first.


            The overall gain in
            Eq. (12-12)
            is bandpass when the high-pass cutoff frequency is much lower than the low-pass cutoff frequency (α
            1
            ≪ α
            2
            ). To see why, we develop the gain asymptotes for
            Eq. (12-12)
            in three frequency ranges.
          


Low frequency
              (ω ≪ α
              1
              ≪ α
              2
              ): This range falls in the stopband of the highpass gain and the passband of the low-pass gain. As a result, the overall gain approaches
              




High frequency
              (α
              1
              ≪ α
              2
              ≪ ω) : This range falls in the passband of the high-pass gain and the stopband of the low-pass gain. In this range, the overall gain approaches
              




Mid-frequency
              (α
              1
              ≪ ω ≪ α
              2
              ): This range falls in the passband of both firstorder gains, so the overall gain approaches
              





Figure 12-19
            shows a plot of the low-, mid-, and high-frequency gain asymptotes. The low-frequency and mid-frequency asymptotes intersect when |
            K
1
K
2
            |ω/α
            1
            α
            2
            = |
            K
1
K
2
            |/α
            2
            . This occurs at ω = α
            1
            , which is the cutoff frequency of the high-pass stage. The high-frequency and mid-frequency asymptotes intersect when |
            K
1
K
2
            |/ω = |
            K
1
K
2
            |/α
            2
            . This occurs at ω = α
            2
            which is the cutoff frequency of the low-pass stage. The straight-line gain plot based on these asymptotes indicates a passband between cutoff frequencies ω
            C1
            = α
            1
            and ω
            C2
            = α
            2
            . The mid-frequency gain applies in this pass-band. Finally, there are two stopbands; one below ω
            C1
            and the other above ω
            C2
            .
          








FIGURE 12-19




Bandpass gain characteristic.
















DESIGN EXAMPLE 12-9

Design a bandpass circuit that can be used as an audio pre-amplifier, with a passband gain of 10 and cutoff frequencies at 20 Hz and 20 kHz. Verify the design using Multisim.




SOLUTION:



                Our design uses a cascade connection of first-order low- and high-pass building blocks. The required transfer function has the form in
                Eq. (12-11)
                with the following constraints
              





                Inserting these numerical values in
                Eq. (12-11)
                allows us to write the required transfer function as
              




                This transfer function can be realized using the three-stage cascade circuit in
                Figure 12-20
                (a). The first stage is the
                RC
                high-pass circuit from
                Example 12-6
                and the third stage is the
                RL
                low-pass circuit from
                Example 12-2
                . The noninverting OP AMP circuit in the second stage serves two purposes: (1) It isolates the first and third stages so the chain rule applies and (2) it supplies the mid-band gain. Using the chain rule, the circuit transfer function is
              











FIGURE 12-20








                Comparing the circuit transfer function to the required transfer function leads to the constraints and stage designs listed in
                Table 12-5
                . As always, many other solutions are possible.
              






Table 12-5









Stage


Constraint


Stage Design





High pass

R
C
C
                        =l/40π
                      

                        Let
                        R
C
                        = 100 kΩ; then
                        C
                        = 0.0796 µF
                      


Gain

                        1+
                        R
2
                        /
                        R
1
                        = 10
                      

                        Let
                        R
1
                        = 10 kΩ; then
                        R
2
                        =90 kΩ
                      


Low pass

L
                        /
                        R
L
                        = 1/40,000π
                      

                        Let
                        R
L
                        = 200 kΩ; then
                        L
                        = 1592 H
                      





                The circuit was designed in Multisim using the values from
                Table 12-5
                . The Grapher View of the design is shown in
                Figure 12-20
                (b). The corner frequencies are exactly as required.
              








FIGURE 12-20








■

















Exercise 12-17




                Select the element values in
                Figure 12-20
                (a) so that the passband gain is 6 dB and the cutoff frequencies are 1 and 50 krad/s. Validate your design using Multisim.
              
Answers:

R
C
                = 5 kΩ
                C
                = 02 µF;
                R
1
                =
                R
2
                ;
                R
L
                = 20 kΩ;
                L
                =400 mH
              



            The Multisim results are shown in
            Figure 12-21
            .
            

Note:


            The peak value does not quite reach 6 dB because the effect of the pole at 50 krad/s occurs before the effect of the pole at 1 krad/s was complete. If reaching 6 dB is critical, the gain of the amplifier needs to be increased to compensate for the effect of the second pole. A gain of 2.035 (6.17 dB should accomplish the task.
          








FIGURE 12-21













Exercise 12-18

Two first-order circuits in a cascade connection have the following transfer functions.



What are the cutoff frequencies and the passband gain? Assume that the chain rule applies.
Answers:

                ω
                C1
                = 40 rad/s; ω
                C2
                = 2000 rad/s; passband gain = 20
              




Bandstop Response

            The input signal to the bandpass cascade must pass through both a high-pass and a low-pass stage to reach the output. In the parallel connection in
            Figure 12-22
            , an input can reach the output via either a high-pass or a low-pass path. As a result, the overall transfer function is the sum of the high-pass and low-pass transfer functions.
          




            Since the overall gain is a sum, we must consider each of these paths separately. Replacing
            s
            by
            j
            ω and solving for the individual path gains gives
          









FIGURE 12-22




Parallel connection of high-pass and low-pass circuits.
                (
                a
                )
                Physical construct.
                (
                b
                )
                How the individual filter characteristics combine to produce the bandstop response.






(12-13)





            The overall gain has a bandstop characteristic when the high-pass cutoff frequency is much higher than the low-pass cutoff frequency (α
            2
            ≪ α
            1
            ). To see why, we develop the gain asymptotes of
            Eq. (12-13)
            in three frequency ranges.
          


Low frequency
              (ω ≪ α
              2
              ≪ α
              1
              ): This range falls in the stopband of the high-pass gain and the passband of the low-pass gain. In this range, the low-pass path dominates, so the overall gain approaches |
              T
              (
              j
              ω)| → |
              K
2
              |α
              2
              .
            

High frequency
              (α
              2
              ≪ α
              1
              ≪ ω): This range falls in the passband of the highpass gain and the stopband of the low-pass gain. In this range, the high-pass path dominates, so the overall gain approaches |
              T
              (
              j
              ω)| → |
              K
1
              |.
            


            Thus, there is a low-frequency passband and a high-frequency passband. In a bandstop response, these passbands normally have the same gain, so that |
            K
1
            | = |
            K
2
            |/α
            2
            . A mid-frequency stopband lies in between these two passbands.
          


Mid-frequency
              (α
              2
              ≪ ω ≪ α
              1
              ): This range falls in the stopband of both first order gains. The stopband asymptotes of the low-pass and high-pass gains are |
              K
2
              |/ω and |
              K
1
              |ω/α
              1
              , respectively. These asymptotes intersect when |
              K
2
              |/ω = |
              K
1
              |ω/α
              1
              . Since |
              K
1
              | = |
              K
1
              |/α
              2
              the intersection frequency turns out to be
              
              .
            


Figure 12-23
            is a plot of the low-, mid-, and high-frequency gain asymptotes. The low-pass gain dominates at frequencies below the intersection frequency
            
            and the high-pass gain dominates above the intersection. The straight-line gain plot indicates a stopband between cutoff frequencies at ω
            C1
            = α
            2
            and ω
            C2
            = α
            1
            and two pass-bands: one below ω
            C1
            and the other above ω
            C2
            .
          








FIGURE 12-23




Bandstop gain characteristic.




            This analysis shows that bandpass and bandstop responses can be obtained using first-order circuit building blocks. More importantly, the straight-line gain approximations to the first-order gains help us
            understand
            how the building blocks interact to produce other types of responses. This understanding explains the enduring utility of Bode plots. The Bode plots in
            Figures 12-19
            and
            12-23
            are reasonably good approximations of the actual gains as long as the two first-order cutoff frequencies are widely separated. Although
            widely separated
            has no precise definition, the straight-line gain works fairly well when α
            2
            >10α
            1
            for a bandpass response and α
            1
            >10α
            2
            for a bandstop response.
            

Note:


            Bandstop filters are interchangeably called band-reject filters.
          












                    EVALUATION EXAMPLE 12-10
                    

There is a need for a design of a bandstop filter centered at 100 Hz that has the following transfer function ±2%:




                    A vendor has submitted the circuit of
                    Figure 12-24
                    , claiming that the design meets the specifications within ±1%. Is the vendor's claim accurate? Use software to verify your results.
                  





SOLUTION:


Let us start by calculating the transfer function from the circuit. If the transfer function is as desired then we can determine if the transfer function meets the specifications. The circuit consists of a high-pass filter, a low-pass filter, and an inverting summer. The transfer function of the filter circuits after substituting the values on the circuit are








FIGURE 12-24










The summer adds the two and inverts the signs



The circuit realizes the desired transfer function. Now we need to determine if the transfer function actually meets the desired specifications to ±1%.

                We can determine if the specifications are met graphically by plotting the low-pass and high-pass frequency characteristics and determining where the minimum occurs
                Figure 12-25
                (a) displays the two transfer functions plotted on a log-log plot We know that first-order filters, as these are, will have corner
                
                frequencies at their poles and slopes of positive or negative one, depending on whether they are high-pass or low-pass designs. The low-pass filter has a corner frequency at 100 rad/s, a passband magnitude of 4, a slope of -1, and crosses 10 krad/s at a magnitude of 0.04. The high-pass filter has a corner frequency of 4000 rad/s, also a passband magnitude of 4, a slope of +1, and crosses 40 rad/s at a magnitude of 0.04. The high- and low-pass curves cross at approximately 630 rad/s, which equals 1003 Hz and is well within the ±1% required by the specification and the vendor's claim.
              








FIGURE 12-25







It is useful to use MATLAB's transfer function tf routine to visualize what the transfer function specification requires.

                T = tf (4*[1 200 4e5],[1 4100 4e5]);
   w=logspace(1,4,1000);bodemag(T,w)
   grid on
              

                The resultant magnitude plot is shown in
                Figure 12-25
                (b). Also, we asked MATLAB to display the results in hertz, avoiding the need to convert from rad/s. This, then, is the performance desired. Next, the circuit provided by the vendor was simulated with Multisim. The circuit and its magnitude result are shown in
                Figure 12-25
                (c). There is a very small error in center frequency that is well within the tolerance required. Hence, the vendor's claim is substantiated.
              

                The method employed above was straightforward. For transfer functions with complex poles or multiple poles, the manual analysis requires more effort than one would care or need to do. Additional alternative means for analysis will be covered later in this chapter and in
                Chapter 14
                .
              








FIGURE 12-25















FIGURE 12-25








■

















                  Design
                  Exercise 12-19




                Following the analysis pattern in Example, design a circuit that realizes the following transfer function. Use no resistor smaller than 1 kΩ. What are the passband gain and the cutoff frequencies of the filter?
              



Answers:

                See
                Figure 12-26
                for one design solution. The passband gains are 200 and the low-pass filter's cutoff frequency is 100 rad/s, while the high-pass filter's cutoff frequency is 10 krad/s.
              








FIGURE 12-26













          12-5 The Frequency Response of
          RLC
          Circuits
        


          A second-order circuit can take many forms as long as it has two independent energy storing elements. However, the properties of second-order circuits are traditionally introduced using simple series and parallel
          RLC
          circuits. In
          Chapter 7
          , these circuits were used to highlight the role of ζ and ω
          0
          in the transient response of second-order circuits. In this section, they are used to introduce the role of impedance in second-order circuit frequency response. These canonic circuits are useful introductory vehicles because they give us physical insight into the relationship between circuit parameters and circuit response.
        


            Series
            RLC
            Bandpass Circuit
          

            The transfer function of the
            RLC
            voltage divider in
            Figure 12-27
            is
          



(12-14)












FIGURE 12-27




Series RLC bandpass circuit.




            where Z
            LC
            (
            s
            ) =
            Ls
            + 1/
            Cs
            is the impedance of the series leg of the voltage divider. To describe the frequency response of the circuit, we replace
            s
            by
            j
            ω to obtain
          




            The variation of the impedance
            Z
LC
            (
            j
            ω) is the key to understanding
            RLC
            circuit frequency response.
          

Figure 12-28
            shows how the impedance
            Z
LC
            (
            j
            ω) =
            j
            (ω
            L -
            1/ω
            C
            ) produces a bandpass gain response. At ω = 0(dc), the capacitor acts like an open circuit and
            Z
LC
            (0) = ∞. At ω = ∞, the inductor acts like an open circuit and
            Z
LC
            (∞) = ∞. In either case, the open circuit effectively disconnects the input source, making
            V
2
            = 0 and producing zero-gain stopbands at low and high frequencies.
          











FIGURE 12-28




Effect of Z
LC
on the series RLC bandpass response.




            That is, the inductor and capacitor combine to produce a short circuit that makes a direct connection between the input and the output ports. This connection makes
            V
2
            =
            V
1
            , producing a voltage gain of |
            T
            (
            j
            ω
            0
            )| =
            T
max
            = 1. Clearly
            T
max
            is the maximum voltage gain available from this voltage-divider circuit. The cutoff frequencies occur when
            Z
LC
            (
            j
            ω) =
            j
            (ω
            L
            - 1/ω
            C
            ) = ±
            jR
            , since
          




            so that the voltage gain is reduced by a factor of
            
            from its maximum value at ω = ω
            0
.


            Several parameters are used to describe the bandpass gain response. First, the maximum gain occurs at the
            center frequency
            ω
            0
            located at
          



(12-15)






            Let us look a little closer to the cutoff frequencies. Recall that the cutoff frequencies occur when
            Z
LC
            (
            j
            ω) = ±
            jR,
            which requires that
          



and leads to the quadratic equation



Because of the ± sign, this quadratic has four roots, only two of which have physical meaning, namely



(12-16a)





            where ω
            C1
            and ω
            C2
            are the
            cutoff frequencies
            shown in
            Figure 12-28
            . The product of the two cutoff frequencies in
            Eq. (12-16a)
            is
          



(12-16b)





            In other words, the center frequency ω
            0
            is the geometric mean of the two cutoff frequencies. Finally, using the results in
            Eq. (12-16a)
            , the
            bandwidth
B
            in
            Figure 12-28
            is found to be
          



(12-17a)





            In summary, the descriptive parameters ω
            0
            , ω
            C1
            , ω
            C2
            , and
            B
            are related to the series
            RLC
            circuit parameters by
            Eqs. (12-15)
            -
            (12-17a)
            .
          

            For historical reasons, it is traditional to add a fifth descriptive parameter called the
            quality factor
Q,
            defined as the ratio of center frequency over bandwidth and zeta is the damping ratio studied in
            Chapter 7
            , namely
          



(12-17b)





Figure 12-29
            shows the effect of
            Q
            on the bandpass response characteristics. When
            Q
            ≫ 1, the response is said to be
            narrow band,
            since
            B
            ≪ ω
            0
            . Conversely, when
            Q
            ≪ 1, the response is said to be
            wide band,
            since
            B
            ≫ ω
            0
            . Thus,
            Q =
            1 is the dividing point between narrow-band or high
            -Q
            responses and wide-band or low
            -Q
            responses. But regardless of the value of
            Q,
            the maximum gain is always
            T
max
            - 1(or 0 dB) at ω - ω
            0
            for a passive
            RLC
            series circuit.
          

            A high
            -Q
            bandpass circuit is sometimes called a
            tuned filter.
            This terminology applies when the center frequency is carefully adjusted (tuned) to select a narrow band of frequencies or even a single frequency while rejecting a much broader range of signal frequencies such as in selecting a radio or TV station. At the center frequency
            Z
LC
            (
            j
            ω
            0
            )=0, the filter input impedance is
            R
            +
            j
            0 a condition known as
            resonance,
            first encountered in
            Chapter 8
            . The center frequency, ω
            0
            , is also called the
            resonant frequency.









FIGURE 12-29




Effect of Q on the series RLC bandpass response.





            The denominator of second-order transfer functions can be written in different ways that one can use to specify and design appropriate bandpass or, as we will shortly see, bandstop filters.
            Equation (12-14)
            can be written as
          




            From
            Chapter 7
            , we recall that the denominator of a second-order circuit can be written as
            
            whose roots determine the nature and poles of the response. Similarly, using the results of
            Eqs. (12-14)
            ,
            (12-17a)
            , and
            (12-17b)
            , we can write
          



(12-18)





            Therefore, if we wish to design a circuit with a particular
            Q
            or
            B,
            when written in standard form, that is, as shown in
            Eq. (12-18)
            , we know what the
            s
1
            -term of the denominator must be. And if we need a particular center frequency ω
            0
            , we know what the
            s
0
            -term must be.
          



Note:


            While all second-order filters have the same denominator format as noted in
            Eq. (12-18)
            , the locations of the zeros in the numerator determine if the circuit will behave as a high-pass, low-pass, bandpass, or bandstop filter.
          












EXAMPLE 12-11




                    A series
                    RLC
                    circuit has a center frequency of ω
                    0
                    =20 krad/s, a quality factor of
                    Q
                    = 5, and a resistance
                    R
                    = 50 Ω. Find the values of L, C, B, ω
                    C1
                    , and ω
                    C2
                    . Use Multi-sim and simulate the voltage gain across the resistor. Compare with the results calculated by hand.
                  




SOLUTION:



                Using the definition of
                Q
                , the bandwidth is
                B
                = ω
                0
                /
                Q
                = 4 krad/s. For a series
                RLC
                circuit,
                B
                =
                R
                /
                L
                and the inductance is
                L
                =
                R
                /
                B
                = 50/4000 = 12.5 mH. Using this inductance and the center frequency, the capacitance is found as
                
                . Inserting these results into
                Eq. (12-16a)
                yields the lower cutoff frequency as
              




                Using the definition of bandwidth, we get ω
                C2
                = ω
                C1
                +
                B
                = 22.1 krad/s.
              

                We build our circuit in Multisim and perform an AC sweep. We sweep over one decade and ask Multisim to calculate 1000 points per decade to obtain good accuracy in our simulation. In order to obtain a band-pass response, we ensure that the output is taken across the resistor. Grapher View returns the plot shown in
                Figure 12-30
                . Although not normally required, to demonstrate Multisim's accuracy for this example, we will determine our values to five significant figures. Using the cursors we find the following: the center frequency
                f
0
                = 31842 krad/s, which equals ω
                0
                = 20.007 krad/s; the lower cutoff frequency
                f
C1
                = 2.8813 kHz or ω
                C1
                = 18.104 krad/s; and the upper cutoff frequency
                f
C2
                = 35165 kHz or ω
                C2
                = 22.095 krad/s. From the two cutoff frequencies, we can calculate the bandwidth
                B
                = 22,095-18,104 = 39910 krad/s. Finally, we can calculate the quality factor
                Q
                = ω
                0
                /B = 20,007/3991.0 = 5.0130. All these values are as expected.
              



Note:


                In most circuit design problems, an accuracy of three significant figures is usually sufficient. But when designing very hi
                -Q
                filters, more accuracy is necessary and how much depends on the problem.
              









FIGURE 12-30








■

















Exercise 12-20



                A series
                RL
                C circuit with the output taken across the resistor has a center frequency of ω
                0
                = 500 krad/s, a resistance of 40 Ω, and a bandwidth
                B
                of 50 krad/s. Find
                Q
                ,
                L, C,
                ω
                C1
                , and ω
                C2
                . Verify your results using Multisim.
              
Answers:

Q
                = 10,
                L
                = 08 mH,
                C
                = 5000 pF, ω
                C1
                = 475,625 rad/s, and ω
                C2
                = 525,625 rad/s.
              

                See
                Figure 12-31
                for the Multisim verification.
              








FIGURE 12-31
























                    DESIGN AND EVALUATION EXAMPLE 12-12
                  


                    Design a bandpass circuit using a series
                    RLC
                    circuit that meets the filter requirements in
                    Example 12-9
                    . Compare this
                    RLC
                    design with the circuit developed in
                    Example 12-9
                    .
                  










FIGURE 12-32









SOLUTION:



                The bandpass filter requirements given in
                Example 12-9
                call for passband gain of 10 and cutoff frequencies at 20 Hz and 20 kHz. The series
                RLC
                circuit can produce the required cutoff frequencies. However, we also need a gain stage since the
                RLC
                circuit has a maximum gain of 1. The required bandpass response and gain can be obtained using the cascade connection in
                Figure 12-32
                . The chain rule applies to this circuit since the gain stage has an infinite input impedance that does not load the output of the
                RLC
                stage.
              

                Given that
                f
C1
                = 20 Hz and
                f
C2
                = 20 kHz, the descriptive parameters of the bandpass stage are
              




                Since Q ≪ 1, the design requirements here and in
                Example 12-9
                describe a wideband filter. Selecting
                R
                = 10 kΩ, the inductance in the series
                RLC
                circuit is
                L = R
                /
                B
                = 79.66 mH. Using this inductance and the center frequency gives the capacitance as
                
                . The gain stage is a noninverting amplifier for which a gain of 10 requires 1 +
                R
2
                /
                R
1
                = 10. Selecting
                R
1
                = 10 kΩ makes
                R
2
                = 90 kΩ.
              


Discussion:

The design developed here uses the series
                RLC
                
                  cascade in
                  Figure 12-32
                  . The design developed in
                  Example 12-9
                  uses the cascade of first-order circuits shown in
                  Figure 12-22

                (
                a
                )
                
                  . The element count for the two designs is summarized in
                  Table 12-6
                  .
                







Table 12-6









Figure


Description



R




L




C



OP AMP





12-22(a)
First-order cascade
4
1
1
1


12-32

                        Series
                        RLC
                        cascade
                      
3
1
1
1





                The minor difference in element count is not significant. What is significant is the difference in possible output stage loading. The circuit in
                Figure 12-32
                is not subject to loading since the output is an OPAMP whose output impedance is zero. The first-order cascade in
                Figure 12-22
                (a) is susceptible to loading since its output stage is a passive
                RL
                circuit with a finite output impedance.
                ■















                Design
                Exercise 12-21


                Design a series
                RLC
                bandpass circuit that has a center frequency of ω
                0
                = 10 krad/s, a maximum gain of 20 dB, and a bandwidth of 5 krad/s.
              
Answers:

                Same design as in
                Figure 12-32
                , with
                L
                = 100 mH,
                C
                = 0.1 µF,
                R
                = 500 Ω,
                R
1
                =10 kΩ, and
                R
2
                =90 kΩ. Other answers are possible.
              





            The Series
            RLC
            Bandstop Circuit
          


            The bandpass circuit in
            Figure 12-27
            and the bandstop circuit in
            Figure 12-33
            are both series
            RLC
            circuits. The difference is that the bandpass circuit takes its output across the resistor while the bandstop circuit takes its output across the inductor and capacitor in series. The voltage transfer function of the bandstop voltage-divider circuit in
            Figure 12-33
            is
          


(12-19)




            where
            Z
LC
            (
            s
            ) =
            L
            s
            +
            1/
            Cs
            is the impedance of the shunt leg of the voltage divider. This impedance is the key to understanding the shape of
            RLC
            circuit frequency response.
          








FIGURE 12-33




Series RLC bandstop circuit.




Figure 12-34
            shows how the impedance
            Z
LC
            (
            j
            ω) =
            j
            (ω
            L
            - 1/ω
            C
            ) produces a bandstop gain response. At ω = 0, the capacitor acts like an open circuit so that the output voltage is
            V
2
            =
            V
OC
            =
            V
1
            . At ω = ∞, the inductor acts like an open circuit and again we have
            V
2
            =
            V
OC
            =
            V
1
            . In either case, the condition
            V
2
            =
            V
1
            produces maximum gains of
            T
max
            = 1 in the low- and high-frequency passbands.
          

            At
            
            , the impedance
            Z
LC
            (
            j
            ω) = 0. The resulting short circuit makes
            V
2
            = 0, reducing the gain to zero and producing the null or
            notch
            in the gain response.
          

            The cutoff frequencies occur when
            Z
LC
            (
            j
            ω) =
            ±jR,
            since
          




            so that the voltage gain is reduced by a factor of
            
            from its maximum value in the two passbands. In sum, the values of
            Z
LC
            (
            j
            ω) that produce the bandpass response in
            Figure 12-28
            produce the bandstop response shown in
            Figure 12-34
            . This makes sense since KVL says that the voltage across
            R
            and the voltage across the
            LC
            series combination must always equal the input. As the frequency of the input increases toward ω
            0
            , the voltage across
            R
            approaches a maximum while the voltage across
            LC
            approaches a minimum. After passing ω
            0
            , the voltage across
            R
            decreases while that across
            LC
            increases.
          








FIGURE 12-34




Effect of Z
LC
on the series RLC bandstop response.




            Since
            Z
LC
            controls bandstop gain response, the equations relating the descriptive parameters to circuit parameters are the same as those governing the bandpass case. Specifically, the notch occurs when
            Z
LC
            = 0 at a frequency of
          




            The passband cutoff frequencies occur when
            Z
LC
            = ±
            jR
            at frequencies of
          





            Finally, the width of the stopband is
          




            These equations are the same as
            Eqs. (12-15)
            -
            (12-17a)
            for the bandpass circuit, except that here they describe the location and width of the stopband rather than the passband.
          

            The
            
RLC

            bandstop circuit is best suited to narrow-band applications aimed at eliminating a single frequency. Narrow-band notch circuits are often used to eliminate power line noise at 60 Hz (50 Hz in many other countries), especially in biomedical instrumentation, where signal levels are usually very low.
          












                    DESIGN EXAMPLE 12-13
                    


                    A voltage source with a Thévenin resistance of 50 Ω has a spurious (undesirable) conducted emission at 25 krad/s. Connecting an inductor and capacitor in series across the 50-Ω source produces a bandstop filter that can eliminate the troublesome signal. To avoid reducing nearby useful signals, the stopband bandwidth must be less than 1 krad/s. Select values of
                    L
                    and
                    C
                    . Use MATLAB to view the design and validate the center frequency, the bandwidth, and the depth of the notch in decibels.
                  




SOLUTION:



                The transfer function for this filter can be found using a voltage divider and relating the result to
                Eq. (12-18)





                The stopband bandwidth requires
                B
                =
                R
                /
                L
                < 1 krad/s and the bandstop notch must be located at
                
                rad/s. Knowing
                R
                (50 Ω) we can find
                L
                > 50 mH. Selecting
                L
                = 100 mH allows us to solve for
                C
                = 0.016 µF. This then results in the following transfer function:
              



We can display this result using MATLAB's tf routine as follows:

                T = tf([1 0 625e6], [1 500 625e6]);
   w=logspace(4.3,4.5,100000);bodemag(T,w)
   grid on
              

                The resulting response shows in
                Figure 12-35
                that the center frequency occurs at 25 krad/s. The bandwidth obtained from the plot is
                B
                = 25.3 × 10
                3
                - 24.8 × 10
                3
                = 500 rad/s and is narrower than 1 krad/s requirement. The depth of the notch is -73 dB.
              



Note:


                A word about the depth of the notch. In theory, the depth of the notch for this type of filter is -∞ dB. However, MATLAB calculates the depth at its lowest test point. The more test points one asks for, the closer the minimum will be to the true notch depth. In real circuits, there are always parasitic values associated with inductors and capacitors that truly limit the notch's depth.
              








FIGURE 12-35








■
















                Design
                Exercise 12-22



                Design a bandstop filter to eliminate a 135 kHz signal. The bandwidth of the notch should not exceed 10 kHz.
              
Answers:

                Use a series
                RLC
                bandstop design with
                L =
                0.1 H,
                C =
                1390 pF,
                R ≤
                6.28 kΩ. Other designs are possible.
              





            Parallel
            RLC
            Bandpass Circuit
          

            Using current division, the current transfer function of the parallel
            RLC
            circuit in
            Figure 12-36
            is written as
          



(12-20)





            where
            Y
LC
            (
            s
            ) =
            Cs +
            1/
            Ls
            is the admittance of the inductor and capacitor in parallel. The bandpass features of the parallel
            RLC
            circuit are controlled by this admittance.
          

            The variation of the admittance
            Y
LC
            (
            j
            ω) =
            j
            (ω
            C
            - 1/ω
            L
            ) produces a bandpass response for the following reasons. At ω = 0 and ω = ∞, the admittance
            Y
LC
            (
            j
            ω) is infinite, which is equivalent to a zero-impedance short circuit. This short circuit shunts all of the input current around the resistor in
            Figure 12-36
            , making
            I
2 =
            0 and producing zero-gain stopbands at low and high frequencies.
          

            At
            
            , the admittance
            Y
LC
            (
            j
            ω) = 0, since
          











FIGURE 12-36




Parallel RLC bandpass circuit.





            A zero admittance is the same as an infinite-impedance open circuit. Because of this open circuit, all of the input current passes through the resistor, making
            I
2
            =
            I
1
            . This creates a current gain of |
            T
            (
            j
            ω
            0
            )| =
            T
max
            = 1. Clearly,
            T
max
            is the maximum current gain available from this current-divider circuit.
          

            The cutoff frequencies occur when
            Y
LC
            (
            j
            ω) = ±
            j
            /
            R,
            since
          




            and the current gain is reduced by a factor of
            
            from its maximum value at ω = ω
            0
            . Thus, the current gain of the parallel circuit in
            Figure 12-36
            displays a passband response centered at ω
            0
            with stopbands at both high and low frequencies.
          

            The admittance
            Y
LC
            (
            j
            ω) plays the same role in the parallel
            RLC
            circuit that the impedance
            Z
LC
            (
            j
            ω) plays in the series
            RLC
            circuit. In fact, comparing the transfer functions in
            Eqs. (12-14)
            and
            (12-20)
            reveals that the two circuits are duals. That is, one transfer function can be converted into the other using the following duality interchanges.
          




            Duality also means that these interchanges convert
            Eqs. (12-15)
            -(
            12-17a
            ,
            b
            ) for the series
            RLC
            circuit into the corresponding relationships for the parallel
            RLC
            circuit. Starting with
            Eq. (12-15)
            , the interchange leaves the center frequency unchanged at
          


(12-21)




            The two cutoff frequencies in
            Eq. (12-16a)
            become
          



(12-22)





            It is easy to show that the center frequency
            
            is the geometric mean of these two cutoff frequencies and is the same as we found in the series
            RLC
            case
            Eq. (12-16b)
            . Given these cutoff frequencies, the bandwidth, the damping ratio, and quality factor of the parallel
            RLC
            circuit are related to
            Eqs. (12-17a)
            and
            (12-17b)
            as
          


(12-23)




            Equations (12-21)-(12-23) relate the descriptive parameters of a bandpass response to the circuit parameters of the parallel
            RLC
            circuit.
          


            Finally, the gain plots in
            Figure 12-29
            also apply to the current gain of the parallel
            RLC
            circuit. As we noted with the series circuit, the response is narrow band when
            Q
            ≫ 1 and is wide band when
            Q
            ≪ 1. Thus, high-
            Q
            and narrow-band are synonymous terms in both the series and parallel
            RLC
            circuits. But regardless of the value of
            Q
            , the maximum current gain is always
            T
max
            = 1(or 0 dB) at ω = ω
            0
            .
          

            A high
            -Q
            parallel
            RLC
            circuit is sometimes called a
            tank circuit.
            This terminology apparently comes from the vacuum tube era, when the tunable
            LC
            components in frequency-selective amplifiers were packaged in a metal "tanklike" container. The center frequency is also the resonant frequency of the parallel
            RLC
            circuit, since
          



therefore




            So, again, the passband center frequency is also called the
            resonant frequency.
            Alternatively, using current division, the transfer function for the parallel
            RLC
            circuit in
            Eq. (12-20)
            can be written as
          




            From
            Eq. (12-18)
            , we see that
            B
            = 1/
            RC
            and
            
            . And we calculate
            
            . We can find the key parameters,
            B, Q
            , and ω
            0
            using whichever approach is easier.
          













EXAMPLE 12-14




                    A parallel
                    RLC
                    circuit has a bandwidth of
                    B
                    = 12 krad/s, a quality factor of
                    Q
                    = 3, and a 1-mH inductance. Find the values of
                    R, C
                    , ω
                    0
                    , ω
                    C1
                    , and ω
                    C2
                    .
                  




SOLUTION:



                Using the definition of
                Q
                , we find the center frequency as ω
                0
                =
                BQ
                = 36 krad/s. Using the given inductance and the center frequency, we get the capacitance as
                
                . For a parallel
                RLC
                circuit,
                B =
                1/
                RC
                and the resistance is
                R
                = 1/
                BC
                = 108 Ω. Inserting these results into
                Eq. (12-22)
                yields the lower cutoff frequency as
              




                Then, using the definition of bandwidth, we get ω
                C2
                = ω
                C1
                +
                B
                = 42.5 krad/s.
                ■















Exercise 12-23


                Use Multisim to verify that the circuit designed in
                Example 12-14
                indeed meets the specifications.
              
Answers:

                Simulating the circuit shown in
                Figure 12-37
                using Multisim yields the following Grapher View results:
              

                ω
                0
                = 36.0 krad/s, ω
                C1
                = 30.5 krad/s, ω
                C2
                = 42.5 krad/s,
                B
                = 12.0 krad/s, and
                Q
                = 30. The circuit designed meets all the desired parameters.
              










FIGURE 12-37





















DESIGN EXAMPLE 12-15



                    Design a parallel
                    RLC
                    circuit with cutoff frequencies at 12 kHz and 16 kHz.
                  




SOLUTION:


The descriptive parameters of the required circuit are




                Selecting
                R
                = l kΩ gives
                C
                = 1/RB = 0.0398 µF and
                
                .
                ■















Exercise 12-24



                A series
                RLC
                circuit has cutoff frequencies at 100 rad/s and 10 krad/s. Find the values of
                B
                , ω
                0
                , and
                Q
                . Does the circuit have a wide-band or narrow-band response?
              
Answers:

B
                =9.9 krad/s; ω
                0
                =1 krad/s;
                Q
                = 0101; wide-band
              





12-6 Bode Diagrams
The purpose of this section is to offer a method for understanding the effects of poles and zeros on the frequency response of circuits described by their transfer functions. Since we will focus on having software such as MATLAB and Multisim to draw these diagrams for us, in this section, we will establish some of the basic properties of poles and zeros that explain the behavior of the transfer function. With some practice, one can tell by looking at a Bode plot where poles and zeros are located, and this can help in making changes to improve the performance of a circuit. Finally, understanding the effects of poles and zeros on a Bode plot can help one focus on critical features and aid in further analysis.
Let us begin by studying the effect of single poles and zeros on the real axis. Consider the following transfer function:


(12-24)




          where
          K
          , α
          1
          , α
          2
          , and α
          3
          are all real. In this example, the function has two zeros at
          s =
          0 and -α
          1
          , and poles at
          s =
          -α
          2
          and -α
          3
          . In making Bode plots, the software replaces
          s
          with
          j
          ω and plots
          T
          (
          j
          ω)-|
          T
          (
          j
          ω)| <
          T
          (
          j
          ω) versus ω using the following relationship:
        


(12-25)





          , this is called the scale factor. Then each critical point, that is, pole or zero, has a magnitude and an angle associated with it that is a function of the frequency ω. For example, The first zero has a magnitude of ω and an angle of 90°, the second zero has a magnitude of
          
          and an angle
          
          .
        
Similarly, the software can compute the magnitude and phase of each of the two poles in this example. This results in a transfer function that can be calculated as follows:


(12-26)



The gain in dB and the phase responses are



(12-27)





          The terms in
          Eq. (12-27)
          caused by zeros have positive signs and increase the gain and phase angle, while the pole terms have negative signs and decrease the gain and phase. The summations in
          Eq. (12-27)
          illustrate a general principle. In a Bode plot, the gain and phase responses are determined by the following types of factors:
        



1.
              The scale factor
              K
0




2.
              A factor of the form
              j
              ω due to a zero or a pole at the origin
            



3.
              Factors of the form (1 +
              j
              ω/α
              n
              ) caused by a zero or pole at s = −α
              n



The software uses these three factors as follows.

The scale factor K
0
.
          The gain and phase contributions of the scale factor are constants that are independent of frequency. In dB, the gain contribution 20 log
          10
          |
          K
0
          | is positive when |
          K
0
          | > 1 and negative when |
          K
0
          | < 1. The phase contribution
          
          is 0° when
          K
0
          is positive and ±180° when
          K
0
          is negative.
        

The factor
          (
          j
          ω). If there were no critical points at the origin, the slope of the gain plot would be 0 - that is, a horizontal line - and the phase would be 0°. A simple zero or pole at the origin contributes ±20 log
          10
          ω to the gain or a slope of ±1 and ±90° to the phase, where the plus sign applies to a zero and the minus to a pole. When
          T
          (
          s
          ) has a factor
          
            s
            n

          in the numerator (denominator), it has a zero (pole) of order
          n
          at the origin. Multiple zeros or poles at
          s =
          0 contribute ±20
          n
          log
          10
          ω to the gain or a slope of ±
          n
          and ±
          n
          90° to the phase.
          Figure 12-38
          shows that the gain
          
          factors contributed by zeros and poles at the origin are straight lines that pass through a gain of 1 (0 dB) at ω = 1.
          
3










FIGURE 12-38




Gain responses of poles and zeros at s =
              0.
            



The factor
          (1 +
          j
          ω = α). The
          gain
          contributions of first-order zeros and poles are shown in
          Figure 12-39
          . Like the first-order transfer functions studied earlier in this chapter, these factors produce straight-line gain asymptotes at low and high frequency. In a Bode plot of a low-pass filter, the low-frequency (ω ≪ α) asymptotes are horizontal lines at a gain of 1 or 0 dB. The high-frequency (ω ≫ α) asymptotes are straight lines of the form ± ω/α or ±20 log(ω/α) dB, where the plus sign applies to a zero and the minus to a pole. The high-frequency gain asymptote is proportional to the frequency ω (slope = + 1 absolute or + 20 dB/decade) for a zero and proportional to 1/ω (slope = -1 absolute or -20 dB/decade) for a pole. In either case, the low- and high-frequency asymptotes intersect at the corner frequency ω = α.
          Figure 12-39
          shows the gain responses of poles and zeros at
          s
          = -α.
        








FIGURE 12-39




Gain responses of poles and zeros at s = -α.





          The straight-line approximations of
          phase
          plots are similar to the gain asymptotes except that there are two slope changes. The first occurs a decade below the gain corner frequency, and the second occurs a decade above. The total phase changes by ±90° over this two-decade range, so the straight-line approximations have slopes of ±45° per decade, where the plus sign applies to a zero and the minus to a pole. Poles and zeros at the origin contribute a constant phase angle of ±
          n
          90°, where
          n
          is the order of the critical frequency and the plus (minus) sign applies to zeros (poles).
          Figure 12-40
          shows the phase responses of poles and zeros at
          s
          = -α.
        








FIGURE 12-40




Phase responses of poles and zeros at s = -α.



Critical points (poles and zeros) affect magnitude and angle over two decades of frequency. If a critical point is located at say, 200 rad/s, its effect begins at 20 rad/s and ends at 2000 rad/s. If another critical point occurs inside that range, the two critical points will interact with each other. The next example demonstrates a Bode plot with critical points interaction.












EXAMPLE 12-16




                    (a) Use MATLAB to plot the Bode diagram of the transfer function
                    



(b) Locate the frequencies of the poles and the zeros on the plot and comment on the effects each had on the magnitude and phase of the Bode diagram.





SOLUTION:




                (a) We use the following MATLAB code to generate the Bode diagram:
                
                  T=tf([12500 125000], [1 550 25000]);
w = logspace(0,4,1000);
bode(T,w);grid
                

                  The Bode diagram magnitude plot is shown in
                  Figure 12-41
                  (a) and its phase plot in
                  Figure 12-41
                  (b).
                








FIGURE 12-41










                (b) The magnitude at ω = 0 is (12,500 × 10)/(50 × 500) = 5 or 13.97 dB. From the plot, the magnitude of the function at ω = 1 rad/s is 14 dB. The transfer function tells us that there is a zero at 10 rad/s. A "zero" changes the slope of the plot by +20 dB/dec at the location of the zero. From the plot, we can see that the curve is sloping up at +20 dB/dec. Then the next critical point is a pole at ω = 50 rad/s. A "pole" changes the slope of the plot by -20 dB/dec at the location of the pole. It takes one decade for a pole or zero to complete its effect on the diagram. Since the zero at ω = 10 rad/s had not completed its effect before the pole at 50 rad/s started its effect, the curve did not reach a slope of +20 dB/dec but begins to add a slope of -20 dB/dec caused by the pole at 50 rad/s. Had this been the last critical point, by 500 rad/s the slope of the pole would have completely canceled the effect of the zero at 10 rad/s and the curve would have been a straight horizontal line - its gain at ω = ∞ would have been 12,500 or 81.9 dB and the magnitude at ω = 0 would have been 67.9 dB. However, there is one more pole at 500 rad/s. This pole adds another -20 dB/dec to the curve and results in a total slope of -20 dB/dec that can be seen between 1000 and 10,000 rad/s on the curve. We added the slope lines by hand to the Bode diagram to show the effects of the critical frequencies.
                







FIGURE 12-41








                  The phase plot shows the phase beginning at 0° because there is neither a pole nor a zero at ω = 0. The first critical point is at 10 rad/s. The zero contributes +90° to the phase. Its effect begins at ω = 1 rad/s and ends at 100 rad/s. However, before it can fully contribute its phase change, a pole at 50 rad/s starts its effect at 5 rad/s and it will end at 500 rad/s contributing -90°. This combination causes the phase to reach a maximum and start down. A second pole at 500 rad/s begins its phase contribution of -90° at 50 rad/s and ends it at 5000 rad/s. The total phase shift caused by the transfer function is 0° + 90° - 90° - 90° for a total of - 90°. While it is straightforward to determine the end points of the phase plot, its shape is more challenging to predict than that of the magnitude.
                  ■


















Exercise 12-25




              Use MATLAB to graph the Bode magnitude and phase plots of the transfer function
            



Locate the critical points on both plots.
Answers:

              Bode plot and critical points are shown in
              Figure 12-42
              .
            










FIGURE 12-42






















                  DESIGN EXAMPLE 12-17
                
A transfer function has the following form




                  The Bode magnitude diagram of the transfer function is shown in
                  Figure 12-43
                  (a).
                








FIGURE 12-43









                    (a) Find
                    K
                    in the transfer function then design a circuit that will realize your result.
                  
(b) Compare your design using Multisim with the MATLAB gain response.





SOLUTION:




                (a) We can see from the graph that the magnitude as
                s →
                0 is 0 dB or 1. Evaluating our function at
                s
                = 0 yields
                K
                /2 must equal 1, therefore,
                K
                = 2.
                

                  We can design our circuit by splitting the transfer function into two building blocks.
                
We divide the first function by 10 and the second by 250/50. We get




                  Both of these transfer functions can be realized by voltage dividers. Factoring
                  s
                  out of the denominator of
                  T
1
                  (
                  s
                  ) and equating the result to a voltage divider yields
                




                  Equating the numerators and denominators yields a voltage divider with
                  Z
2
                  = 1/
                  C
1
s
                  and
                  Z
1
                  =
                  R
1
                  , where
                  C
1
                  = 1 F and
                  R
1
                  = 1/10 Ω.
                

                  Factoring
                  s
                  out of the numerator and denominator of
                  T
2
                  (
                  s
                  ) and equating the result to a voltage divider yields
                




                  Equating the numerators and denominators leads to a voltage divider with
                  Z
2
                  =
                  R
2
+
                  1/
                  C
2
s
                  and
                  Z
1
                  =
                  R
3
                  , where
                  R
2
                  = 1/250 Ω,
                  C
2
                  = 1F, and
                  R
3
                  = 4/250 Ω.
                

Figure 12-43
                  (b) shows a cascade circuit using the two voltage dividers separated by a voltage follower to ensure that the chain rule applies. The element values in the prototype version of this circuit are
                  R
1
                  = 1/10 Ω,
                  C
1
                  =
                  C
2
                  = 1
                  F
                  ,
                  R
2
                  = 1/250 Ω, and
                  R
3
                  = 4/250 Ω. Using a magnitude scale factor of
                  k
m
                  = 10
                  6
                  to get practical values produces a final design with
                  R
1
                  = 100 kΩ,
                  C
1
                  =
                  C
2
                  = 1 µF,
                  R
2
                  = 4 kΩ, and
                  R
3
                  = 16 kΩ. Many other designs are possible.
                


                (b) We use Multisim to simulate the circuit in
                Figure 12-43(b)
                using an AC sweep simulation.
                Figure 12-43(c)
                shows the circuit as drawn in Multisim and the
                
                response in Grapher View. To ensure compliance with the specifications, we compared key points with the MATLAB simulation in Figure12-43(a). These key points are tabulated and compared in
                Table 12-7
                . The circuit meets all of the desired specifications.
              









FIGURE 12-43















FIGURE 12-43













Table 12-7









Frequency (rad/s)


Matlab (dB)


Multisim (dB)





0
0
0


10
-3.19
-3.17


50
-17.0
-17.0


250
-39.1
-39.1


1000
-53.7
-53.7





■








Complex Poles and Zeros
The frequency response of transfer functions with complex poles and zeros can best be analyzed using software such as MATLAB or Multisim since complex critical frequencies can and often do produce resonant peaks (or valleys) that are difficult to predict. Let us see how this occurs.
Complex poles and zeros occur in conjugate pairs that appear as quadratic factors of the form


(12-28)




            where ζ and ω
            0
            are the damping ratio and undamped natural frequency. In a Bode diagram, the appropriate standard form of the quadratic factor is obtained by factoring out
            
            and replacing
            s
            by
            j
            ω to obtain
          


(12-29)



In a Bode diagram, this quadratic factor introduces gain and phase terms of the following form for each conjugate pair:


(12-30)





(12-31)




            where the plus sign applies to complex zeros of
            T
            (
            s
            ) and the minus sign to complex poles.
          

Figure 12-44
            shows the gain contribution of complex poles and zeros for several values of the damping ratio ζ. The low-frequency (ω ≪ ω
            0
            ) gain asymptotes for these
            
            plots are unity or 0 dB. The high-frequency (ω ≫ ω
            0
            ) gain asymptotes are of the form (ω/ω
            0
            )
            ±2
            . Expressed in dB, the high-frequency asymptote is ±40 log
            10
            (ω/ω
            0
            ), which in a Bode diagram is a straight line with a slope of ±2 or ±40 dB/dec, where again the plus sign applies to zeros and the minus to poles.
          








FIGURE 12-44




Gain responses of complex poles and zeros.




            These asymptotes intersect at a corner frequency of ω = ω
            0
            . The gains in the neighborhood of the corner frequency are strong functions of the damping ratio. For
            
            . the actual gain lies entirely above the asymptotes for complex zeros and entirely below the asymptotes for complex poles. For
            
            , the gain is a minimum at
            
            for complex zeros and a maximum for complex poles. These valleys (for zeros) and peaks (for poles) are not particularly conspicuous until ζ < 0.5.
          

Figure 12-45
            shows the phase contribution from complex poles or zeros for several values of ζ. The low-frequency phase asymptotes are 0° and the high-frequency limits are ±180°. The phase is always ±90° at ω = ω
            0
            regardless of the value of the damping ratio. The total phase change is ±180°, and most of this change occurs in a two-decade range from ω
            0
            /10 to 10 ω
            0
            . This makes sense because each of the complex poles or zeros contribute ±90°. What is important to note is that the more undamped the complex poles or zeros are the faster (in frequency) their effect. These factors are very useful in the design of more sophisticated filters that are covered in
            Chapter 14
            . There are tradeoffs to be sure, because time domain and frequency domain are intimately entwined and often doing what appears good in one domain causes issues in the other. We will cover a few of these issues in the next section.
          








FIGURE 12-45




Phase responses of complex poles and zeros











Exercise 12-26




                  (a) Use MATLAB to plot the actual Bode diagram for the following transfer function.
                  




                  (b) Find ζ,
                  B, Q,
                  and ω
                  0
                  . Is the function narrow-band or wide-band?
                

Answers:


                  (a) The required MATLAB code is
                  
                    T=tf([20 0], [1 2 2500]);
   w = logspace(0,3,1000);
   bode(T,w);grid
                  

                    The bode diagram displaying both magnitude and phase is shown in
                    Figure 12-46
                    .
                  








FIGURE 12-46









                  (b) ζ = 0.02 (underdamped),
                  B
                  = 2ζω
                  0
                  = 2 rad/s,
                  Q
                  = ω
                  0
                  /
                  B
                  = 25, ω
                  0
                  = 50 rad/s, narrow-band.
                


















DESIGN EXAMPLE 12-18



                    Design a tuned filter such that its center frequency is at 25 krad/s and its
                    Q
                    is 100. The filter is connected to a 50-Ω source resistance that you must include in your design. Validate your transfer function design using MATLAB's bode function. Find
                    B,
                    ζ, ω
                    C1
                    , and ω
                    C2
                    by calculations and off the plot. Then characterize your circuit design using Multisim. Describe how the poles and zeros affected the response.
                  




SOLUTION:



                From our study of the
                RLC
                bandpass filter, we choose a series circuit with the output taken across the resistor. The transfer function is
              




                Using the source resistance as our
                R,
                we can calculate the other parameters.
              




                Knowing
                L
                , we can readily find
                C









                This yields our desired transfer function
              




                We ask MATLAB to allow us to visualize the transfer function's frequency characteristics. Since we are interested in measuring a very narrow bandwidth (high
                Q
                ), we ask MATLAB to do a linear rather than the usual logarithmic sweep.
              

                T = tf([0 250 0], [1 250 625e6]);
   w=linspace(24800,2 52 00,1000000);bode(T,w)
   grid on
              

                The result is shown in
                Figure 12-47
                (a). The plot shows that our transfer function is designed correctly.
              

                We can calculate ω
                C1
                , ω
                C2
                ,
                B
                , and ζ using our data. From
                Eq. (12-16a)












FIGURE 12-47









                And from
                Eqs. (12-17a)
                and
                (12-17b)





                We construct our circuit in Multisim and run an AC sweep. This time we choose a wide logarithmic sweep (100 Hz to 100 kHz) so we can see the tuned effect of our circuit. The Grapher View and our circuit are shown in
                Figure 12-47
                (b).
              








FIGURE 12-47








                We used the cursor tool to measure the bandwidth at 249 rad/s and the center frequency at 25.002 krad/s. We note that the phase response crosses 0
                °
                at 25.000 krad/s. Our design meets all of the requirements.
              

                The poles and zeros of our transfer function help predict the circuit's response. The visible zero is at zero, while the second zero is at infinity. The zero at zero causes the magnitude response to start at a slope of +1. The poles are located at
                s
1
                ,
                s
2
                = -125 ±
                j
                24999.7 rad/s. Each pole causes the slope to change by -1. Since both poles are located at the same frequency, the slope changes by -2 at the resonant frequency of 25 krad/s. We added the asymptotes to the Multisim plot to help characterize the change. The complex poles are very close to the imaginary axis, indicating a very small ζ. That is,
                
                . This causes the actual response to leave the asymptotes and peak in a similar way to what we saw in
                Figure 12-44
                . The high
                Q
                is visible in the sharp response
                
                of the magnitude plot. Frequencies just 1 kHz away from the center frequency are attenuated by about 35 dB.
              

                As expected, the phase starts at 90° caused by the zero at ω = 0 and changes by 180° at ω = 25 krad/s because of the two poles. We drew the asymptotes for the phase as well. The change from +90° to -90° occurs rapidly because of the very small ζ as surmised from
                Figure 12-45
                .
                ■









12-7 Frequency Response and Step Response

          The step response
          g
          (
          t
          ) and frequency response |
          T
          (
          j
          ω)| are alternative ways to describe the performance of a filter. The transient and frequency responses are not independent. In fact, one can be derived from the other. Filter performance is usually specified in terms of frequency response. Hence, it is important to understand the time-domain consequences of frequency-domain specifications, and vice versa.
        
As a starting place, consider the first-order low-pass filter defined by




Section 12-3
          shows that this filter has a passband (dc) gain of
          K
          /
          α
          and a cutoff frequency of ω
          C
          = α. Recall from
          Chapter 11
          that the step response of a circuit is
          Q
          (
          s
          ) =
          T
          (
          s
          )/
          s
          . Hence, the step response of this low-pass filter is
        




          The time-domain step response
          g
          (
          t
          ) is
        




          The time-domain response has a final value (t → ∞) of
          K
          /α and a time constant of
          T
C
          = 1/α.
        

          Specifying the gain and cutoff frequency of the frequency response also determines the amplitude and duration of the transient response, and vice versa. For instance, if the duration of the transient response is specified to be less than then 20 µs then 5
          T
C
          = 5/α = 5/ω
          C
          < 20 × 10
          -6
          and hence ω
          C
          > 250 krad/sor39.8 kHz. This cutoff frequency might not satisfy the frequency-response requirements. In any case, we need to look at the response in both domains.
        

          Today's users of communication technology generally recognize that wide band and high speed are synonymous.
          
4

          The first-order low-pass filter illustrates the connection, since
          
            ω
            C
T
C
            = 1
          
          . If we want a short response time (small
          T
C
          ), then a wide bandwidth (large ω
          C
          ) is required. On the other hand, a fixed bandwidth (given ω
          C
          ) limits the speed of response, since
          T
C
          = 1/ω
          C
          . This illustrates a signal-processing principle called
          reciprocal spreading.
          Shrinking the response in one domain causes the response in the other domain to spread out.
        

          The important point is that evaluating filter performance involves both the frequency domain and the time domain. We will encounter this idea again in
          Chapter 14
          , where we design much more complex filters. In any case, it is clear that it is important to be able to go from one domain to the other. Changing domains involves concepts learned in several previous chapters, as illustrated in the following examples.
        













EXAMPLE 12-19




                  You are given a second-order low-pass filter with the following transfer function:
                



Characterize the effects of changing ζ on the step response and the magnitude of the frequency response.




SOLUTION:



              We will consider three values of ζ, namely 0.25, 1, and 5. These represent the three different damping cases considered in
              Chapter 7
              .
              Figure 12-48
              shows both the step
            








FIGURE 12-48









              responses and the Bode magnitude plots for the three cases. The required MATLAB code to generate the plots is
            

              T1 = tf([10000],[1 1000 10000]);
   T2 = tf([10000],[1 200 10000]);
   T3 = tf([10000],[1 50 10000]);
   step(T1,T2,T3); grid
   figure
   w = logspace(0,3,1000);
   bodemag (T1,T2,T3,w); grid
            
The frequency response is clearly that of a second-order low-pass filter. The undamped natural frequency is 100 rad/s. As ζ decreases, the filter's roll-off becomes steeper near the critical frequency. In many filter applications, a steeper roll-off indicates a "better" filter. The resonant peak that occurs with a small ζ is not always desirable, since signals passing through the filter are amplified unequally in the passband, such as in audio applications. However, in other uses, one would like the steeper roll-off that a smaller ζ offers, such as a faster rise time in digital applications.

              Now consider the step response of the same circuit. The effect of ζ is quite different. As the damping coefficient decreases, the response becomes more underdamped and oscillates more as it approaches its final value. This additional oscillation is not desirable if one is processing an audio signal, since underdamped circuits introduce
              "ringing"
              and distortion. When the circuit is critically damped (ζ = 1), it offers the fastest rise time without an overshoot. It also offers a good compromise regarding filtering, as seen in the frequency response. We will see other characteristics in
              Chapter 14
              , but for now, we can see the effects of ζ on two important circuit behavior properties. A circuit designer must evaluate these competing properties and decide on which is best for the application under consideration.
              ■
















                Evaluation
                Exercise 12-27


There is a need for a passive notch filter at 100 rad/s. The narrower the notch, the better, but there should be minimal ringing of signals passing through. Shown below are the transforms of three filters submitted for consideration. Which would you recommend and why?



Answers:

T
1
              (
              s
              ) offers the best compromise—a relatively narrow notch with only a slight overshoot.
              T
2
              (
              s
              ) would be the best choice if no ringing at all was desired, but the notch would be wider.
            
















EXAMPLE 12-20


                  For
                  t ≥
                  0, the step response of a filter is
                



Is this a low-pass, high-pass, bandpass, or bandstop filter? What is the passband gain and the approximate cutoff frequency? Plot the gain response using MATLAB.




SOLUTION:




              Recall from
              Chapter 11
              that
              T
              (
              s
              ) =
              sG
              (
              s
              ) where
              
              . The filter transfer function is found as follows:
            



Knowing the transfer function, we can use MATLAB to plot the Bode magnitude. We use the following MATLAB code:

              T=tf([20 0 0], [1 240 8000]);
   w = logspace(0,3.2,1000);
   bodemag(T,w);grid
            

              It is clear from the plot in
              Figure 12-49
              that this is a high-pass filter. Since the maximum occurs at 26 dB, the cutoff occurs at -3 dB from that or at 23 dB. Using MATLAB's
              Data Tip,
              we find that it occurs at 205 rad/s.
            








FIGURE 12-49




















Exercise 12-28


              The impulse response of a particular filter is
              h
              (
              t
              ) = 10
              4
te

                -100
                t

u
              (
              t
              ). What type of filter is this? What is its passband bandwidth?
            
Answers:
It is a second-order low-pass filter. Its cutoff frequency is about 64 rad/s; hence, that is also its bandwidth.
















                  DESIGN EXAMPLE 12-21
                


                  The straight-line gain response of a filter is shown in
                  Figure 12-50
                  . What are the initial and final values of the step response? What is the approximate duration of the transient response? Design a circuit to achieve this response.
                










FIGURE 12-50









SOLUTION:



              In this case, we must derive the transfer function from the gain plot. The straight-line gain has corner frequencies at ω = 20 rad/s and another at ω = 100 rad/s. The first corner increases the gain slope by (20-6)/(log 100 - log 20 = ±20 dB/decade, so there is a simple zero at
              s
              = - 20. The second corner decreases the slope by - 20 dB/decade, so there is a simple pole at
              s = -
              100. The two critical frequencies account for all of the corner frequencies shown in the figure, so the necessary transfer function has the form
            




              The infinite frequency gain of this transfer function is
              T
              (∞) =
              K
              . The high-frequency gain in Figure is +20 dB; hence,
              K =
              10. In general, the step response is
              G
              (
              s
              )
              = T
              (
              s
              )/
              s
              ; hence, for this filter we have
            




              The time-domain step response
              g
              (
              t
              ) is
            




              The initial value is
              g
              (0)
              =
              10, the final value is
              g
              (∞) = 2, and the time constant of the transient term is
              T
C
              = 1/100 s. The duration of the transient response is about 5
              T
C
=
              50 ms.
            
We need to design a circuit with the following transfer function




              We can use an inverting OP AMP design found in
              Figure 11-38
              . We scaled it with
              K
m
=
              10
              7
              . We then simulated this design using Multisim. Its circuit and plot are shown in
              Figure 12-51
              . The Grapher View shows that the function has been correctly modeled.
            








FIGURE 12-51








■

















                Evaluation
                Exercise 12-29




              A certain
              RLC
              series bandpass circuit has the following transfer function:
            



Is it possible to alter a circuit element to keep the same center frequency while minimizing the ringing?
Answers:

              Yes. Increasing the resistance will make the middle term in the denominator,
              R
              /
              L
              = 2ζω
              0
              = 200, larger, which will increase ζ but leave the center frequency at 800 rad/s. Multiplying the value of the resistance by 8 will increase the damping ratio to make it equal to 1 and all ringing will stop. Note that the bandwidth will increase with increasing ζ.
            
















EVALUATION EXAMPLE 12-22

Modern piezoelectric pressure transducers are fabricated as an integrated circuit that includes both the sensing crystal and the signal-conditioning electronics. The step response of such a transducer takes the form




                  where υ
                  TR
                  (
                  t
                  ) is the transducer output voltage caused by an abrupt change in pressure
                  p
                  (
                  t
                  ) =
                  P
A
u
                  (
                  t
                  ). The transducer transient response is defined by the sensitivity
                  K
V
                  (usually in mV/psi), and the discharge time constant
                  T
C
                  (usually in seconds). A transducer is to be installed in an environment with sinusoidal pressure variations in the range from 2 mHz to 2 kHz. A vendor offers transducers with the characteristics presented in
                  Table 12-8
                  . Select the model that meets the frequency-response requirements and produces the largest output signal for any given pressure change.
                






Table 12-8









Model


261


265


266


268


269






K
V
                          (mV/psi)
                        
50
10
5
1
0.5



T
C
                          (
                          s
                          )
                        
10
50
100
500
1000








SOLUTION:



              The specified response υ
              TR
              (
              t
              ) is for an input
              P
A
u
              (
              t
              ). The unit step response
              g
              (
              t
              ) is derived from this response by dividing out the amplitude of the input step
              P
A
              .
            




              In the
              s
              domain, the step response is
            



and the pressure-to-voltage transfer function is found to be





              This transfer function has a first-order high-pass characteristic with a passband gain of
              K
V
              and a cutoff frequency of ω
              C
              = 1/
              T
C
              . The specified frequency range from 2 mHz to 2 kHz must fall in the transducer passband, which means that the cutoff frequency must be less than 2 mHz. In equation form this requires
            




              Models 266, 268, and 269 meet the frequency-response requirement, since they have discharge time constants
              T
C
              greater than 79.6 s. Model 266 is the best choice because it has the most sensitivity (passband gain) at
              K
V
              = 5 mV/psi.
              ■








Summary


            The
            electromagnetic spectrum
            gives rise to the understanding that all electric and magnetic waves travel at the speed of light in a vacuum. Frequencies start at dc and go to infinity. While the spectrum is infinite, much of it has been allocated. Certain frequencies are best for some applications such as audio, communications, heat, light, and X-rays.
            Energies
            in eV increase with increasing frequencies.
          

            Basic circuits use frequencies that have wavelengths that are larger than the size of the
            RLC
            elements, which are called
            lumped components.
            When dealing with higher frequencies, one needs to refer to the use of
            distributed elements.


            The
            frequency response
            of a circuit is defined by the variation of the gain |
            T
            (
            j
            ω)| and phase
            
            with frequency. The gain function is usually expressed in dB in frequency-response plots. Logarithmic frequency scales are used on frequency-response plots of the gain and phase functions.
          

            A
            passband
            is a range of frequencies over which the steady-state output is essentially constant with very little attenuation. A
            stopband
            is a range of frequencies over which the steady-state output is significantly attenuated. The
            cutoff frequency
            is the boundary between a passband and the adjacent stopband.
          

            Circuit gain responses are classified as low pass, high pass, bandpass, and bandstop depending on the number and location of the stopbands and passbands. The performance of devices and circuits is often specified in terms of frequency-response descriptors such as
            bandwidth, passband gain,
            and
            cutoff frequency.


            The low- and high-frequency gain
            asymptotes
            of a first-order circuit intersect at a corner frequency determined by the location of its pole. The total phase change from low to high frequency is ±90°. First-order circuits can be connected to produce bandpass and bandstop responses.
          

            Series and parallel
            RLC
            circuits provide bandpass and bandstop gain characteristics that are easily related to the circuit parameters. Two frequency response descriptors
            
Q

, the quality factor,
            and
            
B

, the bandwidth,
            help in characterizing the circuit's behavior.
          

Bode plots
            are graphs of the gain (in dB) and phase angle (in degrees) versus log-frequency scales.
          
Computer-aided circuit analysis programs can accurately generate and plot frequency-response data. The user must have a rough idea of the gain and frequency ranges of interest to use these tools intelligently.

            It is often necessary to relate the time-domain characteristics of a circuit to its frequency response, and vice versa. This is relationship is called
            reciprocal spreading.
            The transfer function provides a link between the frequency-domain and time-domain responses.
          





          Chapter 12 Problems
        






              Objective 12-1 Electromagmetic Spectrum and First-Order Circuit Frequency Response (
              Sects. 12-1
              to
              12-3
              )
            

              Given the relationship between frequency, wavelength, and energy, and the basic uses of the electromagnetic spectrum, Find
              f
              , λ, or
              E
              given two of the variables.
            
Given a first-order circuit or transfer function:

(a) Understand and use frequency-response descriptors.
(b) Find and classify the frequency response.
(c) Plot the gain and phase responses using computer tools.
(d) Design circuits to produce a specified frequency response.


              See
              Examples 12-1
              to
              12-8
              and
              Exercises 12-1
              to
              12-16
              .
            





12-1
            How many 500-MHz 5G channels will be able to fit in the newly allocated C-band spectrum of 3.7 GHz to 4.2 GHz assuming no frequency space between channels (guard bands)?
          

12-2
            The US Navy talks to submerged submarines by using super low frequencies (SLF) that range from 30 to 300 Hz. Electromagnetic waves can penetrate a conducting medium, like seawater, up to a portion of its wavelength called the skin depth or 8. The EM wave attenuates similarly to a time constant. That is, at one 8, the signal is attenuated by 1/
            e
            or 68%. The Navy transmits at 76 Hz, for a δ of 26 m. How long would a quarter-wavelength antenna need to be to broadcast at 76 Hz?
          


12-3
            Blue light has a wavelength of 400 nm. What is its frequency and how much energy does it have?
          

12-4
            Early telephone systems restricted voice signals to 3 kHz and added a 1 kHz guard band to keep signals separated. Those systems (and most land lines even today) use twisted-pair wires with a bandwidth of 1 MHz. How many voice signals could be accommodated?
          


12-5
            Computer Axial Tomography (CAT) scans are invaluable medical diagnosis tools. They use X-rays with wavelengths between 0.1 nm and 10 nm. What are the frequencies they operate at and at what energies?
          

12-6
            A transfer function has a passband gain of 500. At a particular frequency in its stopband, the gain of the transfer function is only 0.00025. By how many decibels does the gain of the passband exceed that of the frequency in the stopband?
          


12-7
            A particular filter is said to be 12 dB down at a desired stop frequency. How many times reduced is a signal at that frequency compared to a signal in the filter's passband?
          

12-8
            A certain low-pass filter has the Bode diagram shown in
            Figure P12-8
            .
            

(a)
                At what frequency is the filter 10 dB down?
              

(b)
                Estimate where the cutoff frequency occurs, then determine how many dB down is the filter at two octaves after the cutoff frequency?
              









FIGURE P12-8












12-9
            Find the transfer function
            T
V
            (
            s
            )
            = V
2
            (
            s
            )/
            V
1
            (
            s
            ) of the circuit in
            Figure P12-9
            .
            


(a)
                Find the dc gain, infinite frequency gain, and cutoff frequency. Identify the type of gain response.
              

(b)
                Use Multisim to plot the Bode magnitude gain response of the circuit. Calculate the gain at ω = 0.1ω
                C
                , ω
                C
                , and 10ω
                C
                .
              

(c)
                How many dB down from the passband is the filter at one octave past the cutoff?
              









FIGURE P12-9









12-10


            Find the transfer function
            T
V
            (
            s
            )
            = V
2
            (
            s
            )/
            V
1
            (
            s
            ) of the circuit in
            Figure P12-10
            .
            

(a)
                Find the dc gain, infinite frequency gain, and cutoff frequency. Identify the type of gain response.
              

(b)
                Calculate the gain at ω = 0.1ω
                C
                , ω
                C
                , and 10ω
                C
                .
              

(c)
                Select values of
                R, C, R
1
                , and
                R
2
                so that the passband gain is 5 and the cutoff frequency is 1 krad/s.
              

(d)
                Use Multisim to plot the Bode magnitude gain response of the circuit.
              









FIGURE P12-10











12-11
            Find the transfer function
            T
V
            (
            s
            )
            = V
2
            (
            s
            )/
            V
1
            (
            s
            ) of the circuit in
            Figure P12-11
            .
            

(a)
                Find the dc gain, infinite frequency gain, and cutoff frequency. Identify the type of gain response.
              

(b)
                Use MATLAB to plot the Bode magnitude gain response of the circuit.
              

(c)
                Calculate the gain at ω = 0.1ω
                C
                , ω
                C
                , and 10 ω
                C
                .
              

(d)
                What element values would you change to increase the passband gain by a factor of five without changing the cutoff frequency?
              









FIGURE P12-11










12-12

            Design a high-pass filter with a cutoff frequency of 15.9 kHz and a passband gain of 5. Find the transfer function of your design and validate your design using MATLAB.
          


12-13


            Design a low-pass filter with a cutoff frequency of 50 krad/s and a passband gain of 200. Validate your design using Multisim. All
            R
            's must be ≥10 kΩ and C's ≤1000 pF.
          

12-14

            Your task is to connect the modules in
            Figure P12-14
            so that the gain of the transfer function is 5 and the cutoff frequency of the filter is 500 rad/s when connected between the source and the load. Repeat if the cutoff frequency is 625 rad/s and the gain did not matter.
            







FIGURE P12-14









12-15


            A young designer needed to design a low-pass filter with a cutoff of 1 krad/s and a gain of - 5. The filter is to fit as an interface between the source and the load. The designer was perplexed when no matter how the stages in
            Figure P12-15
            are connected the results are not what were expected. Explain the problem and suggest a way to achieve the desired results.
            







FIGURE P12-15









12-16

            Design an
            RC
            low-pass first-order filter with a cutoff frequency of 100 krad/s and a passband gain of +50. What is the minimum
            GB
            that the OP AMP must have to not affect the filter's cutoff?
          



12-17
Figure P12-17
            shows the Bode characteristics of three one-pole circuits. Find the transfer functions for each circuit, then determine each circuit's gain and cutoff frequency. System T1 is in blue, T2 in red, and T3 in purple.
            







FIGURE P12-17










12-18
            Find the transfer function
            Ty
            (
            s
            )
            =
V

2

            (
            s
            )/
            V
1
            (
            s
            ) of the circuit in
            Figure P12-18
            .
            
(a) Find the dc gain, infinite frequency gain, and cutoff frequency. Identify the type of gain response.
(b) Use Multisim to plot the Bode magnitude gain response of the circuit.
(c) What one element value would you change to increase the cutoff frequency by one decade?









FIGURE P12-18










12-19



(a)
                Find the transfer function
                T
V
                (
                s
                )
                = V
2
                (
                s
                )/
                V
1
                (
                s
                ) of the circuit in
                Figure P12-19
                .
              

(b)
                What type of gain response does the circuit have?
              

(c)
                What is the passband gain?
              

(d)
                Design a suitable filter using practical, standard values of
                R
                and
                C
                from
                Appendix G
                so that the cutoff frequency is 800 kHz ±5% and the passband gain is 100.
              

(e)
                What is the minimum
                GB
                that the OP AMP must have?
              









FIGURE P12-19










12-20
            A first-order high-pass circuit has a passband gain of 20 dB and a cutoff frequency of 1000 rad/s.
            

(a)
                Find the circuit's transfer function.
              

(b)
                Find the gain (in dB) at ω = 0, 500, 1000, and 5000 rad/s.
              

(c)
                Verify your results using MATLAB.
              





12-21




(a)
                Design a passive
                RC
                first-order low-pass circuit with a passband gain of 0 dB and a cutoff frequency of 5 krad/s.
              

(b)
                Cascade two identical circuits of your designs in (a). Using Multisim, plot the output of both circuits on the same graph using dB for the magnitude. Then discuss what effect on the cutoff frequency and the roll-off (final slope) cascading had on the overall design.
              

(c)
                Suppose we insert a follower between the two stages, will the cutoff be at 5 krad/s? Explain.
              



12-22


            The transfer function of a first-order circuit is
            




(a)
                Identify the type of gain response. Find the cutoff frequency and the passband gain.
              

(b)
                Use MATLAB to plot the magnitude of the Bode gain response.
              

(c)
                Design a circuit to realize the transfer function.
              

(d)
                Use Multisim to validate your circuit design by comparing its frequency response to the MATLAB output.
              









              Objective 12-2 Bandpass and Bandstop Responses (
              Sect. 12-4
              )
            
Given a cascade or parallel connection of two first-order circuits:

(a) Find and classify the frequency response.
(b) Plot the gain and phase responses using straight-line approximations and computer tools.
(c) Design circuits to produce a specified frequency response.


              See
              Examples 12-9
              and
              Exercises 12-17
              to
              12-19
              .
            






12-23
            A circuit has the following transfer function:
            


Use MATLAB to plot the Bode diagram of the transfer function. From the plot, determine the following:


(a)
                The nature of the filter, that is, bandpass or bandstop.
              

(b)
                The center frequency in radians and the maximum gain.
              

(c)
                The cutoff frequencies, the bandwidth, and the
                Q
                of the transfer function.
              

(d)
                The phase angles at ω = 0, ω → ∞, ω = ω
                C1
                , ω = ω
                C2
                , and ω = ω
                0
                .
              



12-24


            Design a circuit with the transfer function in Problem 12-23. Validate your design using Multisim.
          

12-25


            A circuit has the following transfer function:
            



B
              is a constant multiplier that can change the behavior of the circuit. With
              B
              = 50, use MATLAB to plot the Bode magnitude diagram of the transfer function. Repeat for
              B
              = 500 and
              B
              = 5000. From the plot determine the following:
            


(a)
                The nature of the filter, that is, LP, HP, BP, BR. Does changing
                B
                alter the nature of the circuit?
              

(b)
                The cutoff frequency in radians. Does changing
                B
                alter the cutoff frequency of the circuit?
              

(c)
                In the case where
                B
                = 50, at what frequency does the peak value of the transfer function occur? Is it at the cutoff frequency?
              

(d)
                Is an OP AMP required to achieve this transfer function? Explain.
              




12-26

            There is a need to visualize the gain plot of the following transfer function:
            




(a)
                Use MATLAB to determine what type of filter it is (LP, HP, BP, or BR).
              

(b)
                From your plot, determine the cutoff frequency or frequencies, the bandwidth, and the maximum gain and frequency of the maximum gain.
              

(c)
                What is the dc gain and the infinite frequency gain?
              



12-27



            The circuit in
            Figure P12-27
            produces a bandpass response for a suitable choice of element values. Identify the elements that control the two cutoff frequencies. Select the element values so that the passband gain is 100 and the cutoff frequencies are 1000 rad/s and 40 krad/s. Use practical element values with
            R >
            10 kΩ and
            C
            < 1 µF. Use Multisim to validate your design.
            







FIGURE P12-27









12-28


            The circuit in
            Figure P12-28
            produces a bandpass response for a suitable choice of element values. Identify the elements that control the two cutoff frequencies. Select the element values so that the passband gain is 10 k and the cutoff frequencies are 1000 rad/s and 40 krad/s. Use practical element values with
            R ≥
            10 kΩ and
            C ≤
            1 µF Use Multisim to validate your design. The maximum single OP AMP gain is 100.
            







FIGURE P12-28









12-29


            Suppose that the circuits in
            Figures P12-27
            and
            P12-28
            had to feed a 100-Ω instrument. Which circuit would you select and why?
          

12-30


            The circuit in
            Figure P12-30
            produces a bandstop response for a suitable choice of element values.
            

(a)
                Find the circuit's transfer function.
              

(b)
                Identify the elements that control the two cutoff frequencies. Select the element values so that the cutoff frequencies are 50 krad/s and 500 krad/s. Use practical element values with resistances greater than 10 kΩ and capacitances less than 1 µF. Design your passband gain to be +60 dB. After looking at the simulations, can the design specifications be met?
              

(c)
                Use MATLAB to plot the Bode magnitude plot for the values you selected.
              

(d)
                Simulate your circuit using Multisim and compare the results to the MATLAB output.
              









FIGURE P12-30









12-31



            Design an audio amplifier that amplifies signals from 20 Hz to 20 kHz. Your approach should be to use a cascade connection of two first-order passive circuits separated by a noninverting OP AMP. The source has a 50-kΩ series resistor and the output of the filter feeds a 10-kΩ audio transducer. Design a bandpass circuit with the following specifications all ± 5%:
            f
CL
            = 20 Hz,
            f
CH
            = 20 kHz,
            B
            = 19, 980 Hz. Passband gain + 40 dB. What is the minimum
            GB
            of the OP AMP that can be used in this application? Use Multisim to validate your results.
          







              Objective 12-3 The Frequency Response of
              RLC
              Circuits (
              Sect. 12-5
              )
            

              Given an
              RLC
              circuit connected as a bandpass or a bandstop filter:
            


                (a) Find the frequency-response descriptors such as
                Q
                and
                B.

(b) Design circuits to produce a specified frequency response.

                (c) Compare the bandpass and bandstop responses obtained from
                RLC
                filters with similar responses obtained from first-order filters.
              


              See
              Examples 12-11
              to
              12-15
              and
              Exercises 12-20
              to
              12-24
              .
            




12-32


            The circuit in
            Figure P12-32
            is a typical
            RLC
            filter circuit.
            

(a)
                Find the circuit's transfer function
                T
                (
                s
                ) if
                C
                = 33 µF,
                L
                = 47 mH, and
                R
                = 10 Ω.
              

(b)
                Determine the filter type.
              


(c)
                Use MATLAB to plot the filter's gain characteristic.
              

(d)
                Either by hand or from the MATLAB plot, find
                Q, B,
                ω
                C1
                , ω
                C2
                , ω
                0
                , and
                T
MAX
                (
                s
                )
              

(e)
                Select a value of
                R, L
                , or
                C
                that would shift the center frequency to 1 krad/s but not change
                B
                .
              









FIGURE P12-32









12-33


            Design an
            RLC
            bandstop filter with a center frequency of 400 krad/s and a
            Q
            of 20. The passband gain is 0 dB. Use practical values for
            R, L,
            and
            C
            and do not use an OP AMP.
          

12-34

            Design an
            RLC
            bandpass filter with a center frequency of 1000 rad/s and a
            Q
            of 0.1. The passband gain is + 20 dB. Use practical values for
            R, L,
            and
            C.
            Use no more than one OP AMP.
          

12-35

            A series
            RLC
            bandpass circuit with
            R
            = 2 kΩ is designed to have a bandwidth of 150 Mrad/s and a center frequency of 50 Mrad/s. Find
            L, C, Q
            , and the two cutoff frequencies. Could you design this circuit using a cascade connection of two first-order filters separated by a follower? Why or why not?
          

12-36

            A parallel
            RLC
            bandpass circuit with
            C
            = 0.005 µF and
            Q
            = 15 has a center frequency of 500 krad/s. Find
            R, L,
            and the two cutoff frequencies. Could you design this circuit using a cascade connection of two first-order filters separated by a follower? Why or why not?
          

12-37





(a)
                Design a parallel
                RLC
                circuit with
                R
                = 150 kΩ, a center frequency of 50 krad/s, and a
                Q
                of 15.
              

(b)
                Validate your design using Multisim.
              



12-38

            A series
            RLC
            bandpass filter is required to have resonance at
            f
0
            = 50 kHz. The circuit is driven by a sinusoidal source with a Thévenin resistance of 60 Ω. The following standard capacitors are available in the stock room: 1 µF, 068 µF 047 µF, 0.33 µF, 02 µF and 012 µF The inductor will be custom-designed to match the capacitor used. Select the available capacitor that minimizes the filter bandwidth.
          

12-39



            A series
            RLC
            bandstop circuit is to be used as a notch filter to eliminate a bothersome 100-Hz hum in an international audio channel application. The signal source has a Thévenin resistance of 75 Ω. Select values of
            L
            and
            C
            so that the stopband cutoff frequencies are between 70 Hz and 140 Hz. The notch should provide at least 50 dB of attenuation. Use Multisim to verify your design.
          

12-40


            Find the transfer function
            T
V
            (
            s
            ) =
            V
2
            (
            s
            )/
            V
1
            (
            s
            ) for the bandpass circuit in
            Figure P12-40
            . Use MATLAB to visualize the Bode characteristics if
            R
            = 50 Ω,
            L
            = 50 µH, and
            C
            = 2000 pF. Design an active circuit to meet those same characteristics. Verify your design using Multisim.
            







FIGURE P12-40









12-41



            Show that the transfer function
            T
V
            (
            s
            ) =
            V
2
            (
            s
            )/
            V
1
            (
            s
            ) of the circuit in
            Figure P12-41
            has a bandstop filter characteristic. Derive expressions relating the notch frequency and the cutoff frequencies to
            R, L,
            and C. Then select values of
            R, L
            , and
            C
            so that the bandwidth is 50 krad/s and the center frequency is 100 krad/s. Validate your design using Multisim.
            







FIGURE P12-41









12-42

            A professor gave the following quiz to his students: Look at
            Figure P12-42
            . Each curve represents the voltage across an individual element in a series
            RLC
            circuit. Identify which curve belongs to which element, namely,
            R, L, C
            , or
            V
1
            . Then explain how there can be two voltages greater than 1(0 dB when the input
            V
1
            is at 0 dB?
          









FIGURE P12-42













              Objective 12-4 Bode Plots (
              Sects. 12-6
              and
              12-7
              )
            


              Given a linear circuit or transfer function:
            

(a) Plot the gain and phase responses using computer tools.
(b) Develop a transfer function from a straight-line Bode gain plot.
(c) Design a circuit that produces a given straight-line gain plot.


              See
              Examples 12-16
              to
              12-18
              and
              Exercises 12-25
              and
              12-26
              .
            




12-43




(a)
                Using MATLAB, plot the gain and phase of the transfer functions below:
                




(b)
                From the plots, determine which is the high-pass circuit, which is the low-pass, and their respective cutoff frequencies? What is the gain of each?
              

(c)
                Explain why the phase changes from
                s
                = 0 to
                s
                → ∞ in each case?
              



12-44


            The transfer function
            T
V
            (
            s
            ) =
            V
2
            (
            s
            )/
            V
1
            (
            s
            ) for a particular circuit is
            




(a)
                Identify the critical point of
                T
V
                (
                s
                )
                .
                What is the phase of the function at
                s
                = 0 and
                s
                → ∞? What is the maximum gain of the function?
              

(b)
                Use MATLAB to plot the Bode magnitude of the transfer function. Is the gain the same as what you found in (a)?
              

(c)
                Design a circuit using practical values for the components that has the same transfer function.
              

(d)
                Use Multisim to compare the frequency response of your designed circuit with the MATLAB Bode plot.
              



12-45


            Find the transfer function
            T
V
            (
            s
            )
            = V
2
            (
            s
            )/
            V
1
            (
            s
            ) for the circuit in
            Figure P12-45
            .
            

(a)
                Use MATLAB to generate a Bode plot of your transfer function. From the Bode plots, estimate the amplitude and phase of the steady-state output for each of the following input signals
                
                  υ
                  1
                  (
                  t
                  ) = 10 cos 10
                  t
                  V,
                

                  υ
                  1
                  (
                  t
                  ) = 10 cos 100
                  t
                  V, and
                

                  υ
                  1
                  (
                  t
                  ) = 10 cos 1000
                  t
                  V.
                


(b)
                calculate the actual output amplitude and phase for these three inputs and compare the results with your estimates.
              









FIGURE P12-45









12-46


            For the following transfer function
            




(a)
                Use MATLAB to plot the Bode magnitude of the transfer function. Is this a low-pass, high-pass, bandpass, or bandstop function? Estimate the cutoff frequency and passband gain.
              

(b)
                Design a circuit using only one OP AMP and practical values for the components that has the same transfer function.
              

(c)
                Use Multisim to compare the frequency response of your designed circuit with the MATLAB Bode plot.
              



12-47



            For the following transfer function,
            




(a)
                Identify the critical points. What type of filter is this? Estimate the cutoff frequency and the passband gain. What is the phase at
                s
                = 0 and s → ∞?
              

(b)
                Run a MATLAB Bode diagram and compare its results with your estimates in (a).
              

(c)
                Design a circuit using practical values that achieves the transfer function.
              

(d)
                Verify your design with the MATLAB plot.
              



12-48


            For the following transfer function
            




(a)
                Use MATLAB to plot the Bode magnitude and phase of the transfer function. Measure the cutoff frequencies, the bandwidth, and the passband gain. Also find the phase at
                s
                = 0 and
                s
                → ∞ rad/s.
              

(b)
                Design a circuit using practical values for the components that has the same transfer function.
              

(c)
                Use Multisim to compare the frequency response of your designed circuit with the MATLAB Bode plot.
              



12-49


            For the following transfer function
            T
V
            (
            s
            ) =
            V
2
            (
            s
            )/
            V
1
            (
            s
            )
            





(a)
                What are the poles and zeros of the function? Is this a low-pass, high-pass, bandpass, or bandstop function? Estimate the cutoff frequency(ies) and passband gain.
              

(b)
                Use MATLAB to plot the Bode magnitude and phase of the transfer function.
              

(c)
                What is the output υ
                2
                (
                t
                ) if υ
                1
                (
                t
                ) =24 cos (100
                t
                -45°) V?
              



12-50

            For the following transfer function
            T
V
            (
            s
            ) =
            V
2
            (
            s
            )/
            V
1
            (
            s
            )
            




(a)
                Use MATLAB to plot the Bode magnitude and phase of the transfer function.
              

(b)
                Is this a low-pass, high-pass, bandpass, or bandstop function? Estimate the cutoff frequency(ies) and passband gain.
              

(c)
                What is the output υ
                2
                (
                t
                ), if υ
                1
                (
                t
                ) = 20 cos (1000
                t -
                45°) V? Repeat if υ
                1
                (
                t
                ) = 20 cos (10,000
                t
                + 45°)V
              



12-51



            For the following transfer function
            T
V
            (
            s
            )=
            V
2
            (
            s
            )/
            V
1
            (
            s
            )
            




(a)
                Select values of
                B
                and co
                0
                so that the bandwidth and the center frequency are 50 and 10 krad/s, respectively. What is the
                Q
                of your circuit?
              

(b)
                Select
                K
                so that the passband gain is 0 dB.
              

(c)
                Use MATLAB to plot the Bode magnitude and phase of the transfer function.
              

(d)
                Using an appropriate
                RLC
                circuit, design a circuit that produces the transfer function found in part (c).
              

(e)
                Simulate your circuit in Multisim and compare your design's results with those found with MATLAB.
              



12-52


            Consider the gain plot in
            Figure P12-52
            .
            

(a)
                Find the transfer function corresponding to the straight-line gain plot.
              

(b)
                Use MATLAB to plot the Bode magnitude and phase of the transfer function.
              

(c)
                Design a circuit that will realize the transfer function found in part (a).
              

(d)
                Use Multisim to verify your circuit design.
              









FIGURE P12-52









12-53


            Consider the gain plot in
            Figure P12-53
            .
            

(a)
                Find a transfer function corresponding to the straight-line gain plot. Note that the magnitude of the actual frequency response must be exactly 5 at the geometric mean of the two cutoff frequencies (245 rad/s).
              

(b)
                Use MATLAB to plot the Bode magnitude of the transfer function.
              









FIGURE P12-53









12-54


            Consider the gain plot in
            Figure P12-54
            .
            

(a)
                Find the transfer function corresponding to the straight-line gain plot.
              

(b)
                Use MATLAB to plot the Bode magnitude of the transfer function.
              

(c)
                Design a circuit that will realize the transfer function found in part (a).
              

(d)
                Use Multisim to verify your circuit design.
              









FIGURE P12-54









12-55



            Consider the following transfer function:
            




(a)
                Select
                K
                so that the passband gain is +60 dB.
              

(b)
                Using MATLAB plot three different Bode magnitude plots on the same graph with B = 2000, 20,000, and 200,000. (
                Hint
                :
                bodemag (TT1, TT2, TT3,  ww);

                where each different transfer function is separately entered as
                TT1=, TT2=, TT3= .)

(c) Find the cutoff frequency of each plot. How does the bandwidth relate to the actual cutoff frequency?

                (d) Suppose you wanted the cutoff frequency to be ω
                0
                , what value of
                B
                would you select? Verify your choice with MATLAB.
              








Objective 12-5 Frequency Response and Step Response (Sect. 12-8)
Given a circuit or a transfer function:

(a) Find the gain response corresponding to a given step response or vice versa.
(b) Use the relationship between frequency and step responses to choose the best solution for a design specification.


              See
              Examples 12-19
              to
              12-22
              and
              Exercises 12-27
              to
              12-29
              .
            




12-56


            The step response of a linear circuit is
            




(a)
                Find the impulse response waveform,
                h
                (
                t
                )
                .


(b)
                Is the circuit a low-pass, high-pass, bandpass, or bandstop filter?
              

(c)
                Use MATLAB to plot the Bode magnitude and step responses.
              

(d)
                Design a circuit to achieve the transfer function.
              

(e)
                Use Multisim to verify the step and frequency responses.
              



12-57


            A circuit has the following transfer function:
            




(a)
                Use MATLAB to find its Bode magnitude response.
              

(b)
                Use MATLAB to find its step response.
              

(c)
                Determine the filter type, its cutoff frequency, and maximum gain.
              

(d)
                Determine the circuit's ζ and if the circuit is under-damped, critically damped, or overdamped.
              

                (e) Determine the
                B
                and
                Q
                of the circuit. Is the circuit wideband or narrow band?
              



12-58


            Select
            B
            in the following transfer function so that the step response is Case B (two equal roots).
            



              Verify your choice using MATLAB's step routine. Does this bandwidth result in the poles occurring at the value of ω
              0
              ? What is the
              Q
              of the circuit under this condition?
            


12-59



            The following two transfer functions look similar. The difference is that their numerators and denominators are reversed. One is a tuned (narrow bandpass filter), the other is a notch (narrow bandstop) filter. Their frequency responses seem identical except for one being a notch and the other tuned. However, their step responses are quite dissimilar.
            




(a)
                Plot the frequency response of each function. Which is the tuned filter and which is the notch filter? What is the height of the tuned filter and the depth of the notch filter? Are their center frequencies the same?
              

(b)
                Plot the step response of each. Which is underdamped and which is overdamped? For the underdamped case, find α and β from the plot. For the overdamped case, estimate the dominant exponential from the plot.
              

(c)
                Locate the critical points of the numerator and the denominator of each transfer function. Relate the critical points found in the step responses with the critical points found in factoring the transfer functions. Explain why one is overdamped and the other underdamped.
              

(d)
                Suppose that the numerator and denominator in each transfer function were the same. What would the frequency response be?
              



12-60


            There is a need for a passive notch filter at 10 krad/s. The narrower the notch the better, but there should be minimal ringing of the signals passing through. The transforms of three filters were submitted for consideration. Which would you recommend and why?
            




12-61



            There is a need for a filter to reduce the interference from a powerline on radio equipment. The interference is not only at 60 Hz but also at its second harmonic, 120 Hz. Design a filter that is narrow, with a
            Q
            of 60 or better, and removes both frequencies but not the frequencies in between. It should overall provide a passband gain of 1 or 0 dB. Validate your design using Multisim.
          



Integrating Problems


12-62



            Step Response of an
            RLC
            Bandpass Circuit The step response of a series
            RLC
            bandpass circuit is
            





(a)
                Find the passband center frequency, the two cutoff frequencies, and the
                Q
                of the function.
              

(b)
                Design a circuit that would possess the above step response.
              

(c)
                Validate your design using Multisim.
              



12-63

            A Tunable Tank Circuit The
            RLC
            circuit in
            Figure P12-63
            (often called a tank circuit) has
            R
            = 4.7 kΩ,
            C
            = 680 pF, and an adjustable (tunable)
            L
            ranging from 64 to 640 µH.
            







FIGURE P12-63









(a)
                Show that the circuit is a bandpass filter.
              

(b)
                Find the frequency range (in Hz) over which the center frequency can be tuned.
              

(c)
                Find the bandwidth (in Hz) at the end points of this range.
              



12-64


            Filter Design Specification
            

(a)
                Construct a transfer function whose gain response lies entirely within the nonshaded region in
                Figure P12-64
                . Validate your results using MATLAB.
              

(b)
                If in addition to fitting in the shaded region the response must have the smallest overshoot possible, how would that alter, or not, your design?
              









FIGURE P12-64









12-65

            Chip
            RC
            Networks Integrated circuit (chip)
            RC
            networks are used at parallel data ports to suppress radio frequency noise. In a certain application, RF noise at 3.2 MHz is interfering with a 4-bit parallel data signal operating at 1.1 MHz. A chip
            RC
            network is to be used to reduce the RF noise on the parallel bus by at least 7 dB without reducing the data signals by more than 2 dB. A vendor offers a family of chip
            RC
            networks connected as shown in
            Figure P12-65
            . The available circuit parameters are shown in Table P12-65. Select the part number that best meets the noise suppression requirements.
          









FIGURE P12-65












Table P12-65









R
                    (Ω)
                  



C

(pF)


Part No.



R
                    (Ω)
                  



C
                    (pF)
                  


Part No.






220
zaen14

220
zaen34


82
330
zaen15
330
330
zaen35



1000
zaen16

1000
zaen36



220
zaen24

220
zaen44


470
330
zaen25
630
330
zaen45



1000
zaen26

1000
zaen46






12-66


            Design Evaluation Your company issued a request for proposals listing the following design requirements and evaluation criteria.
            
Design Requirements
              : Design a low-pass filter with a passband gain of 9 ± 10% and a cutoff frequency of 90 ±10% krad/s. A sensor drives the filter input with a 1-kΩ source resistance and an open-circuit voltage range of ±1.6V.
            

Evaluation Criteria:
              Filter performance, parts count, use of standard parts, and cost.
            

              The two vendors have responded with the designs shown in
              Figure P12-66
              .
            
As a junior engineer, the project manager asks you evaluate the designs and recommend a vendor. Which vendor would you recommend and why?








FIGURE P12-66









12-67


            Design Evaluation
            

              In a research laboratory, you need a bandpass filter to meet the following requirements:
            

Design Requirements:
              Passband gain: 10 ± 5%,
              B
              = 10 krad/s±
              5%,
              ω
              0
              = 5 krad/s± 2%, ω
              CL
              = 2 krad/s± 10%.
            

Evaluation Criteria:
              Filter performance, parts count, use of standard parts, and cost.
            

              The two vendors have responded with the designs shown in
              Figure P12-67
              .
            
As a research assistant, your supervisor asks you to evaluate the two designs and recommend a vendor. Which vendor would you recommend and why?










FIGURE P12-67









12-68


            Design Evaluation
            In a cable service distribution station, you need a bandstop filter to meet the following requirements:

Design Requirements:
              Passband gain: 10 ± 5%,
              B
              = 3.3 kHz ± 5%,
              f
0
              =500 Hz ±2%,
              f
CL
              =75Hz±10%. Filter must interface with a 50-Ω source and a 500-Ω load.
            

Evaluation Criteria:
              Filter performance including depth of notch, parts count, power usage, ease of maintenance, use of standard parts, and cost.
            

              The two vendors have responded with the designs shown in
              Figure P12-68
              .
            
As an engineering cable guy, your supervisor asks you to evaluate the two designs and recommend a vendor. Which vendor would you recommend and why?








FIGURE P12-68









12-69


            Pole Locations in a Second-Order LPF
            
              The transfer function for a second-order LPF with
              T
max
              = 0dB is
            




              Find the location of the poles that will cause the cutoff frequency ω
              C
              to equal the resonant frequency ω
              0
              . Then for those poles find ζ and Q. One might be tempted to set 2ζω
              0
              =
              B
              = ω
              0
              and hence ζ = 0.5; however, this is not the case. Verify your result using MATLAB; select ω
              0
              = 10
              4
              rad/s.
            


12-70


            Determining the Cutoff Frequency of Two One-Pole Filters in Cascade
            


(a)
                Often one needs a simple cascaded low-pass
                RC
                filter that will achieve -40 dB/dec. Cascading two identical filters separated by a follower would seem to provide the answer. However, each filter will deliver -20 dB/dec at the designed frequency, or -6 dB. The cutoff frequency will not be that of the individual filter but at a lower frequency. Derive an equation that will allow one to design such a filter so that the cutoff is at the desired frequency.
              

(b)
                Test your new equation by designing a cascaded low-pass
                RC
                filter with a desired cutoff frequency of 1000 rad/s.
              



12-71

            Fiber-Optic Versus Cellular Communications Today, 5G communications are necessary to deliver high band-widths and high-speed data to enable streaming of all types of information to control widely distributed items and processes. Recently, cell-phone companies have obtained access to a small portion of C-band frequencies between 3.7 and 4.2 GHz. This small portion of the spectrum will only allow one 1-Gb/s channel - the currently preferred transmission rate. For years, cable companies have used fiber-optic cables to transmit video and Internet data over many miles. The light used in these cables is in the near infrared and transmits at 850 nm, 1300 nm, or 1550 nm.
            

(a)
                Theoretically, how many 1-Gb/s channels can each wavelength of light carry?
              

(b)
                List some advantages and disadvantages of fiber vs cellular communications.
              







Notes




1

            The name of the unit honors Alexander Graham Bell (1847-1922), the inventor of the telephone.
          


2

            There is no fixed symbol for Gain-Bandwidth Product. The literature uses
            GBWP, GBW,
            and
            GB
            . Since we use
            B
            for bandwidth in this text, we use
            GB
            for Gain-Bandwidth.
          


3

            Strictly speaking, a circuit with a natural pole at the origin is unstable and does not have a sinusoidal steady-state response. Nevertheless, it is traditional to treat poles at the origin in Bode diagrams because there are practical applications in which such poles are important considerations.
          


4

            To handle all the communications required to meet today's and tomorrow's technology needs, highspeed and super-wide bandwidths are required. For example, 5G communication technology will eventually require networks capable of handling 1 or more Gb/s speeds and bandwidths of the same or more capacity.
          















CHAPTER 13

FOURIER SERIES





The series formed of sines or cosines of multiple arcs are therefore adapted to represent between definite limits all possible junctions, and the ordinates of lines or surfaces whose form is discontinuous.


          Jean Baptiste Joseph Fourier, 1822,
          
          French Physicist
        






Some History Behind This Chapter
The analysis techniques in this chapter have their roots in the works of the French physicist J. B. J. Fourier (1768-1830). Daniel Bernoulli (circa 1750) described an equation for waves propagating on a vibrating string. He found solutions to the wave equation. But he was unable to prove that he had obtained all the solutions to the problem. This piqued Fourier's interest and he went on to prove not only Bernoulli's equation but also that any discontinuous function could be represented by an infinite series of harmonic sinusoids. Fourier was guided by his physical intuition and presented empirical evidence to support his claim but left the question of series convergence unanswered. This question was later settled by the German mathematician P. G. L. Dirichlet (1805-1859). Fourier's methods were eventually accepted and are now widely used.









Why This Chapter Is Important Today

            The word
            spectrum
            denotes both a natural resource and a mathematical concept. As a natural resource, it is critical to modern communications and its use is regulated by national and international agencies. As a mathematical concept, it describes the range of frequencies needed to reproduce a signal. Fourier theory suggests that perfect reproduction requires an infinite spectrum, a practical impossibility. The theory also shows that a finite range of frequencies carry most of the energy in periodic signals. Intentionally limiting a signal to this range makes the spectrum available to other users and allows today' s profusion of communication systems.
          

            This chapter covers Fourier Series. It discusses the devolution of periodic signals into an infinite series of sines and cosines. Fourier transforms do for aperiodic signals what Fourier series do for periodic ones. Fourier transforms let us understand the frequency content of aperiodic signals and apply that understanding to communication systems and other applications. An introduction to Fourier transforms is available in
            Chapter 18
            .
          









Chapter Sections



13-1 Overview of Fourier Series






13-2 Fourier Coefficients






13-3 Waveform Symmetries






13-4 Circuit Analysis Using the Fourier Series






13-5 RMS Value and Average Power












Chapter Learning Objectives

13-1
            The Fourier Series (
            Sects. 13-1
            to
            13-3
            )
          

(a) Given an equation or graph of a periodic waveform, derive expressions for the Fourier coefficients.

              (b) Given
              a
0

                , a
                n
                ,
              
              and
              
                b
                n
                ,
              
              calculate the Fourier coefficients of a given periodic waveform.
            
(c) Given a Fourier series of a periodic waveform, determine the properties of the waveform and plot its amplitude and phase spectra.


13-2
            Fourier Series and Circuit Analysis (
            Sect. 13-4
            )
          

(a) Given a linear circuit with a periodic input waveform, find the Fourier series of a steady-state response.
(b) Given a network function with a periodic input, find the amplitude and phase spectra of the steady-state output.


13-3
            RMS Value and Average Power (
            Sect. 13-5
            )
          

(a) Given a periodic waveform, find the rms value of the waveform and the average power delivered to a specified load.
(b) Given the Fourier series of a periodic waveform, find the fraction of the average power carried by specified components and estimate the average power delivered to a specified load.







13-1 Overview of Fourier Series


        In this chapter, we develop a method of finding the steady-state response of circuits to periodic signals. Periodic waveforms can be written as a Fourier series consisting of an infinite sum of harmonically related sinusoids.
        Figure 13-1
        provides examples of common periodic signals. If the signal is aperiodic, then a Fourier transform is required to characterize the frequency content of the signal.
        Chapter 18
        will explore Fourier transforms in more detail.
      








FIGURE 13-1



Examples of periodic waveforms.





        Based on the works of Bernoulli and Fourier, it can be proven that every continuous, periodic signal
        f
        (
        t
        ) with period
        T
0
        , can be expressed as an infinite linear combination of sine and cosine functions called a
        Fourier series.
        It takes the following form:
      



(13-1)




or, more compactly,



(13-2)





        The coefficient
        a
0
        is the dc component or average value of
        f
        (
        t
        ). The constants
        
          a
          n

        and
        
          b
          n

        (
        n
        = 1, 2, 3,...) are the
        Fourier coefficients
        of the sinusoids in the ac component. The lowest frequency in the ac component occurs for
        n
        = 1 and is called the
        fundamental frequency,
        defined as
        f
0
        = 1/
        T
0
        . The other frequencies are integer multiples of the fundamental called the second harmonic (2
        f
0
        ), third harmonic (3
        f
0
        ), and, in general, the nth harmonic (
        nf
0
        ).
      

        Since
        Eq. (13-2)
        is an infinite series, there is always a question of convergence. We know that the series converges as long as
        f
        (
        t
        ) is reasonably well behaved. Basically, this means that
        f
        (
        t
        ) is single valued, the integral of |
        f
        (
        t
        )| over a period is finite, and
        f
        (
        t
        ) has a finite number of discontinuities in any one period. These requirements,
        
        called the
        
          Dirichlet conditions
          
1

          ,
        
        are sufficient to assure convergence. Every periodic waveform that meets the Dirichlet conditions has a convergent Fourier series. However, there are waveforms that do not meet the Dirichlet conditions that also have convergent Fourier series. That is, while the Dirichlet conditions are sufficient, they are not necessary and sufficient. This limitation does not present a serious problem because the Dirichlet conditions are satisfied by the waveforms generated in physical systems. All of the periodic waveforms in
        Figure 13-1
        meet the Dirichlet requirements.
      
It is important to have an overview of how a Fourier series is used in circuit analysis. In our previous study, we learned how to find the steady-state responses due to a dc or an ac input. The Fourier series resolves a periodic input into a dc component and an infinite sum of ac components. We treat each of the terms in the Fourier series as a separate input source and use our circuit analysis tools to find the steady-state responses due to each term acting alone. The complete steady-state response is found by superposition, that is, adding up the responses due to each term acting alone. The net result is that the output is a modified version of the Fourier series of the periodic input.

        At first glance, it may seem complicated to find the complete response by finding the individual responses due to infinitely many inputs. However, each step simply involves circuit analysis tools we have already mastered. The end result tells us how the circuit transforms the input series into the output series. The distribution of amplitudes and phase angles in a Fourier series is called the
        spectrum
        of a periodic waveform. Frequency-domain signal processing involves modifying a given input spectrum to produce a desired output spectrum. Thus, finding the Fourier series of periodic waveforms is not an end in itself, but the first step in the study of frequency-domain signal processing.
      



13-2 Fourier Coefficients


        Referring back to
        Eq. (13-2)
        , there are three coefficients that need to be determined, namely,
        a
0
        ,
        
          a
          n

        , and
        
          b
          n
          .
        
        These three Fourier coefficients for any periodic waveform
        f
        (
        t
        ) satisfying the Dirichlet conditions can be obtained from the equations
      



(13-3)





        The integration limits in these equations extend from-
        T
0
        /2 to +
        T
0
        /2. However, the limits can span any convenient interval as long as it is exactly one period or an integral number of periods. For example, the limits could be from 0 to
        T
0
        or-
        T
0
        /4 to 3
        T
0
        /4. We will show where
        Eq. (13-3)
        comes from in a moment, but first we use these equations to obtain the Fourier coefficients of the sawtooth wave.
      








FIGURE 13-2




















EXAMPLE 13-1



                Find the Fourier coefficients for the sawtooth wave in
                Figure 13-2
                (a).
              



SOLUTION:



              An expression for a sawtooth wave on the interval 0 ≤
              t ≤ T
0
              is
            




              For this definition of
              f
              (
              t
              ), we use 0 and
              T
0
              as the limits in
              Eq. (13-3)
              . The first expression in
              Eq. (13-3)
              yields
              a
0
              as
            




              This result states that the average or dc value is
              A
              /2, which is easy to see because the area under one cycle of the sawtooth wave, a triangle, is
              AT
0
              /2. The second expression in
              Eq. (13-3)
              yields
              
                a
                n

              as
            




              Since
              
                a
                n

              = 0 for all
              n
              , there are no cosine terms in the series. The
              
                b
                n

              coefficients are found using the third expression in
              Eq. (13-3)
              :
            




              Given the coefficients
              
                a
                n

              and
              
                b
                n

              found above, the Fourier series for the sawtooth wave is
            


■















FIGURE 13-2














Exercise 13-1



            Find the Fourier coefficients for the rectangular pulse wave in
            Figure 13-2
            (b).
          


Answer:
























EXAMPLE 13-2




                In this example, we use MATLAB to show that a truncated Fourier series approximates a periodic waveform. The waveform is a sawtooth with
                A
                = 10 and
                T
0
                = 2 ms. Calculate the Fourier coefficients of the first 20 harmonics and plot the truncated series representation of the waveform using the first 5 harmonics and repeat for the first 20 harmonics.
              




SOLUTION:



            From
            Example 13-1
            , the Fourier coefficients for the sawtooth wave are
          



The following MATLAB code will create the requested harmonics and generate the required plots:

            
              %Create the symbolic variables
   syms t
   % Define the waveform parameters
   A = 10;
   T0 = 0.002;
   n = 1:20;
   % Calculate the coefficients
   a0 = A/2;
   bn = -A./n/pi;
   an = zeros(size(bn));
   % Create vectors for the cosine and sine terms
   cnt = cos(2*pi*n*t/T0);
   snt = sin(2*pi*n*t/T0);
   % Create the partial sums
   N=5;
   ft5 = a0 + an(1:N)*cnt(1:N)' + bn(1:N)*snt(1:N) ';
   N = 20;
   ft2 0 = a0 + an(1:N)*cnt(1:N)
              1
              + bn(1:N)*snt(1:N) ';
   % Substitute in a time vector
   tt = 0:T0/500:2*T0;
   ftt5 = subs(ft5,t,tt);
   ftt20 = subs(ft20,t,tt);
   % Create the plots
   figure
   plot(tt,ftt5, 'b', 'LineWidth',2)
   xlabel('Time (sec)') ylabel('f(t)')
   title('dc + first 5 harmonics')
   grid on
   figure
   plot(tt,ftt20, 'b', 'LineWidth', 2)
   xlabel('Time (sec)')
   ylabel('f(t)')
   title('dc + first 20 harmonics')
   grid on
            
          








FIGURE 13-3









            In the MATLAB code, note that the partial sums were created using vector multiplication in the second and third terms. For the vector multiplication, the first vector multiplies the transpose of the second vector to complete the multiplication and summation in a single MATLAB operation.
          

Figure 13-3
            displays the resulting waveforms. The waveform generated with the first five harmonics in
            Figure 13-3
            (a) has the correct general shape, amplitude, and period. When we increase the number of harmonics to 20 in
            Figure 13-3
            (b), the shape of the waveform improves and we note that the transition from 10 to 0 in the waveform at
            t
            = 2 ms is steeper and a better approximation of the actual vertical transition. One can conclude that the more harmonics that are added, the closer the series approximates the waveform.
            ■









FIGURE 13-3






















Exercise 13-2




   
            Given a rectangular pulse waveform as shown in  
            Figure 13-1
            , let
            A
            = 10,
            T
0
            = 5 ms, and
            T
            = 2 ms. (a) Use MATLAB to calculate the Fourier coefficients for the first 10 harmonics. (b) Use the 10 harmonics to plot a truncated series representation of the waveform.
          
Answers:


              (a)
              a
0
              = 4,
              a
1
              =6.055,
              a
2
              = 1.871,
              a
3
              =-1.247,
              a
4
              =-1.514,
              a
5
              =0,
              a
6
              = 1.009,
              a
7
              =0.535,
              a
8
              =-0.468,
              a
9
              =-0.673,
              a
10
              =0,
              
                b
                n

              =0 for all
              n.


              (b) See
              Figure 13-3
              (c).
            





        Note that the Fourier coefficients
        
          a
          n

        and
        
          b
          n

        contain all of the information needed to construct the Fourier series in the form of
        Eq. (13-2)
        .
        Figure 13-3
        (d) shows how plots of this information are used to display the spectral content of a periodic waveform
        f
        (
        t
        ) for the waveform in
        Exercise 13-2
        . The plots of
        
          a
          n

        and
        
          b
          n

        versus
        nf
0
        (or
        n
        ω
        0
        ) are collectively called the
        trigonometric spectrum
        . Both plots are
        line spectra
        because spectral content can be represented as a line at discrete frequencies.
      








FIGURE 13-3









          Deriving Equations for
          
            a
            n

          and
          
            b
            n




        The sawtooth wave example shows how to calculate the Fourier coefficients using
        Eq. (13-3)
        . We now turn to the derivation of these equations. An equation for a Fourier coefficient is derived by multiplying both sides of
        Eq. (13-2)
        by the sinusoid associated with the coefficient and then integrating the result over one period. This multiply and integrate process isolates one coefficient because of the orthogonality of sines and cosines it turns out that all of the integrations produce zero except one.
      
The following derivation makes use of the fact that the area under a sine or cosine wave over an integer number of cycles is zero. That is,



(13-4)





        where
        k
        is an integer. These equations state that integrating a sinusoid over
        k
        ≠ 0 cycles produces zero, since the areas under successive half-cycles cancel. The single exception occurs when
        k
        = 0, in which case the cosine function reduces to one and the net area for one period is
        T
0
        .
      

        We derive the equation for the amplitude of the dc component
        a
0
        by integrating both sides of
        Eq. (13-2)
        :
      


(13-5)




        The integrals of the ac components vanish because of the properties in
        Eq. (13-4)
        , and the right side of this expression reduces to
        a
0
T
0
        . Solving for
        a
0
        yields the first expression in
        Eq. (13-3)
        .
      


        To derive the expression for
        
          a
          n
          ,
        
        we multiply
        Eq. (13-2)
        by cos(2
        πmf
0
t
        ) and integrate over the interval from-
        T
0
        /2 to +
        T
0
        /2:
      



(13-6)




All of the integrals on the right side of this equation are zero except one. To show this we use identities




        to change
        Eq. (13-6)
        into the following form:
      



(13-7)





        All of the integrals are now in the form of expressions in
        Eq. (13-4)
        . Consequently, we see all of the integrals on the right side of
        Eq. (13-7)
        vanish, except for one cosine integral when
        m
        = n. This one survivor corresponds to the
        k
        = 0 case in
        Eq. (13-4)
        , and the right side of
        Eq. (13-7)
        reduces to
      




        Solving
        Eq. (13-7)
        for
        
          a
          n

        yields the second expression in
        Eq. (13-3)
        .
      

        To obtain the expression for
        
          b
          n

        , we multiply
        Eq. (13-2)
        by sin (2π
        mf
0
t
        ) and integrate over the interval
        t
        =-
        T
0
        /2 to +
        T
0
        /2. The derivation steps then parallel the approach used to find
        
          a
          n
          .
        
        The end result is that the dc component integral vanishes and the ac component integrals reduce to
        
          b
          n
          T
        
0
        /2, which yields the expression for
        
          b
          n

        in
        Eq. (13-3)
        .
      

        The derivation of
        Eq. (13-3)
        focuses on the problem of finding the Fourier coefficients of a given periodic waveform. Some experience and practice are necessary to understand the implications of this procedure. On the other hand, it is not necessary to go through these mechanics for every newly encountered periodic waveform because tables of Fourier series expansions are available. For our purposes, the
        
        listing in
        Figure 13-4
        on the next page will suffice. For each waveform defined graphically, the figure lists the expressions for
        a
0
,

          a
          n
          ,
        
        and
        
          b
          n

        as well as restrictions on the integer
        n.












EXAMPLE 13-3


                Verify the Fourier coefficients given for the square wave in
                Figure 13-4
                and write the first three nonzero terms in its Fourier series.
              










FIGURE 13-4



Fourier coefficients for some periodic waveforms.







SOLUTION:



            An expression for a square wave on the interval 0 <
            t
            <
            T
0
            is
          




            Using the first expression in
            Eq. (13-3)
            to find
            a
0
            yields
          




            The result
            a
0
            = 0 means that the dc value of the square wave is zero, which is easy to see because the area under a positive half-cycle cancels the area under a negative half-cycle. Using the second expression in
            Eq. (13-3)
            to find
            
              a
              n

            produces
          




            Since
            
              a
              n

            = 0 for all
            n
            , there are no cosine terms in the series. This makes some intuitive sense because a sinewave with the same fundamental frequency as the square wave fits nicely inside the square wave with zeros crossing at the same points, whereas a cosine with the same frequency does not fit at all. The
            
              b
              n

            coefficients for the sine terms are found using the third expression in
            Eq. (13-3)
            :
          




            The term [1-cos (
            nπ
            )] =2 if
            n
            is odd and zero if
            n
            is even. Hence,
            
              b
              n

            can be written as
          



The first three nonzero terms in the Fourier series of the square wave are




            Note that this series contains only odd harmonic terms.
            ■














Exercise 13-3



            The triangular wave in
            Figure 13-4
            has a peak amplitude of
            A
            = 10 and
            T
0
            = 2 ms. Calculate the Fourier coefficients of the first nine harmonics.
          


Answers:



a
0
            =0,
            a
1
            =8.11,
            a
2
            =0,
            a
3
            =0.901,
            a
4
            =0,
            a
5
            = 0.324,
            a
6
            = 0,
            a
7
            = 0.165,
            a
8
            =0,
            a
9
            = 0.100,
            
              b
              
n


            = 0 for all
            n.




Alternative Form of the Fourier Series


        The series in
        Eq. (13-1)
        can be written in several alternative yet equivalent forms. From our study of sinusoids in
        Chapter 5
        , we recall that the Fourier coefficients determine the amplitude and phase angle of the general sinusoid. Thus, we can write a general Fourier series in the form
      






(13-8)




where



(13-9)





        The coefficient
        
          A
          n

        is the amplitude of the
        n
        th harmonic and ϕ
        
n

        its phase angle.
        
2



        Note that the amplitude
        
          A
          n

        and phase angle ϕ
        
n

        contain all of the information needed to construct the Fourier series in the form of
        Eq. (13-8)
        .
        Figure 13-5
        shows how plots of this information are used to display the spectral content of a periodic waveform
        f
        (
        t
        ). The plot of
        
          A
          n

        versus
        nf
0
        (or
        n
        ω
        0
        ) is called the
        amplitude spectrum,
        while the plot of ϕ
        
n

        versus
        nf
0
        (or
        n
        ω
        0
        ) is called the
        phase spectrum.
        Both plots are
        line spectra
        because spectral content can be represented as a line at discrete frequencies.
      








FIGURE 13-5



Amplitude and phase spectra.





        In theory, a Fourier series includes infinitely many harmonics, although the harmonics tend to decrease in amplitude at high frequency. For example, the summary in
        Figure 13-4
        shows that the amplitudes of the square wave decrease as 1/
        n,
        the triangular wave as 1/
        n
2
        , and the parabolic wave as 1/
        n
3
        . The 1/
        n
3
        dependence means that the amplitude of the fifth harmonic in a parabolic wave is less than 1% of the amplitude of the fundamental (actually 1/125th of the fundamental). In practical signals, the harmonic amplitudes decrease at high frequency so that at some point the higher-order components become negligibly small. This means that we can truncate the series at some finite frequency and still retain the essential features of the signal. This is an important consideration in systems with finite bandwidth such as smart phones, satellite TV, and other modern communication systems.
      













EXAMPLE 13-4




                Derive expressions for the amplitude
                
                  A
                  n

                and phase angle ϕ
                
n

                of the Fourier series of the sawtooth wave in
                Figure 13-4
                . Sketch the amplitude and phase spectra of a sawtooth wave with
                A
                = 5 and
                T
0
                = 4 ms.
              




SOLUTION:



Figure 13-4
            gives the Fourier coefficients of the sawtooth wave as
          





            Using
            Eq. (13-9)
            yields
          



and




            For
            A
            = 5 and
            f
0
=
            1/
            T
0
            = 250 Hz, the first four nonzero terms in the series are
          




Figure 13-6
            (a) shows the amplitude and phase spectra for this signal. Note that the lines in the amplitude spectrum are inversely proportional to frequency. As frequency increases, the amplitudes decrease so that the high-frequency components become negligible.
          








FIGURE 13-6




■
















Exercise 13-4


            Derive expressions for the amplitude
            
              A
              n

            and phase angle ϕ
            
n

            for the triangular wave in
            Figure 13-4
            and sketch the first three nonzero terms in the Fourier series using an amplitude-phase plot. Let
          





Answers:









            See
            Figure 13-6
            (b) for the amplitude-phase plot.
          








FIGURE 13-6













13-3 Waveform Symmetries

Many of the Fourier coefficients are zero when a periodic waveform has certain types of symmetries. It is helpful to recognize these symmetries, since they may simplify the calculation of the Fourier coefficients.

        The first expression in
        Eq. (13-3)
        shows that the amplitude of the dc component
        a
0
        is the average value of the periodic waveform
        f
        (
        t
        ). If the waveform has equal area above and below the time axis, then the integral over one cycle vanishes, the average value is zero, and
        a
0
        = 0. The square wave, triangular wave, and parabolic wave in
        Figure 13-4
        are examples of periodic waveforms with zero average value.
      

        A waveform is said to have
        even symmetry
        if
        f
        (-
        t
        ) =
        f
        (
        t
        ). The cosine wave, rectangular pulse, and triangular wave in
        Figure 13-4
        are examples of waveforms with even symmetry. The Fourier series of an even waveform is made up entirely of cosine terms: that is, all of the
        
          b
          n

        coefficients are zero. To show this, we write the Fourier series for
        f
        (
        t
        ) in the form
      



(13-10)





        Given the Fourier series for
        f
        (
        t
        ), we use the identities cos(-
        x
        ) = cos(
        x
        ) and sin (-
        x
        ) =-sin (
        x
        ) to write the Fourier series for
        f
        (-
        t
        ) as follows:
      



(13-11)





        For even symmetry
        f
        (
        t
        ) =
        f
        (-
        t
        ) and the right sides of
        Eqs. (13-10)
        and
        (13-11)
        must be equal. Comparing the Fourier coefficients term by term, we find that
        f
        (
        t
        ) =
        f
        (
        -t
        ) requires
        
          b
          n

        =-
        
          b
          n

        . The only way this can happen is for
        
          b
          n

        = 0 for all
        n
        .
      

        A waveform is said to have
        odd symmetry
        if -
        f
        (-
        t
        ) =
        f
        (
        t
        ). The sine wave, square wave, and parabolic wave in
        Figure 13-4
        are examples of waveforms with this type of symmetry. The Fourier series of odd waveforms are made up entirely of sine terms: that is, all of the
        
          a
          n

        coefficients are zero. Given the Fourier series for
        f
        (
        t
        ) in
        Eq. (13-10)
        , we use the identities cos(-
        x
        ) =cos (
        x
        ) and sin(-
        x
        ) =-sin (
        x
        ) to write the Fourier series for -
        f
        (-
        t
        ) in the form
      



(13-12)





        With odd symmetry
        f
        (
        t
        ) =-
        f
        (
        -t
        ) and the right sides of
        Eq. (13-10)
        and
        (13-12)
        must be equal. Comparing the Fourier coefficients term by term, we find that odd symmetry requires
        a
0
        = -
        a
0
        and
        
          a
          n

        = -
        
          a
          n

        . The only way this can happen is for
        
          a
          n

        =0 for all
        n
        , including
        n
        =0.
      

        A waveform is said to have
        half-wave symmetry
        if -
        f
        (
        t
        -
        T
0
        /2) =
        f
        (
        t
        ). This requirement states that inverting the waveform [-
        f
        (
        t
        )] and then time shifting by half a cycle (
        T
0
        /2) must produce the same waveform. Basically, this means that successive half-cycles have the same waveshape but opposite polarities. In
        Figure 13-4
        , the sine wave, cosine wave, square wave, triangular wave, and parabolic wave have half-wave symmetry. The sawtooth wave, half-wave sine, rectangular pulse train, and full-wave sine do not have this symmetry.
      


        With half-wave symmetry, the amplitudes of all even harmonics are zero. To show this, we use the identities cos (
        x
        - nπ) = (-1)
        
n

        cos(
        x
        ) and sin (
        x- n
        π) = (-1)
        
n

        sin (
        x
        ) to write the Fourier series of -
        f
        (
        t-T
0
        /2) in the form
      



(13-13)





        For half-wave symmetry, the right sides of
        Eqs. (13-10)
        and
        (13-13)
        must be equal. Comparing the coefficients term by term, we find that equality requires
        
        . The only way this can happen is for
        a
0
        = 0 and for
        
          a
          n

        =
        
          b
          n

        = 0 when
        n
        is even. In other words, the only nonzero Fourier coefficients occur when
        n
        is odd.
      

        A waveform may have more than one symmetry. For example, the triangular wave in
        Figure 13-4
        has even symmetry and half-wave symmetry, while the square wave has both odd and half-wave symmetries. The sawtooth wave in
        Figure 13-4
        is an example where an underlying odd symmetry is masked by a dc component. A symmetry that is not apparent until the dc component is removed is sometimes called a
        hidden symmetry.


        Finally, whether a waveform has even or odd symmetry (or neither) depends on where we choose to define
        t
        = 0. For example, the triangular wave in
        Figure 13-4
        has even symmetry because the
        t
        = 0 vertical axis is located at a local maximum. If the axis is shifted to a zero crossing, the waveform has odd symmetry and the cosine terms in the series are replaced by sine terms. If the vertical axis is shifted to a point between a zero cross and a maximum, then the resulting waveform is neither even nor odd and its Fourier series contains both sine and cosine terms.
      












EXAMPLE 13-5



                Given that
                f
                (
                t
                ) is a square wave of amplitude
                A
                and period
                T
0
                , use the Fourier coefficients in
                Figure 13-4
                to find the Fourier coefficients of
                g
                (
                t
                ) =
                f
                (
                t
                +
                T
0
                /4).
              




SOLUTION:



Figure 13-7
            compares the square waves
            f
            (
            t
            ) and
            g
            (
            t
            ) =
            f
            (
            t
            +
            T
0
            /4). The square wave
            f
            (
            t
            ) has odd symmetry (sine terms only) and half-wave symmetry (odd harmonics only). Using the coefficients in
            Figure 13-4
            , the Fourier series for
            f
            (
            t
            ) is
          








FIGURE 13-7











            The Fourier series for
            g
            (
            t
            ) =
            f
            (
            t
            +
            T
0
            /4) can be written in the form
          





Figure 13-7
            shows that
            g
            (
            t
            ) has even and half-wave symmetry, so its Fourier series has only cosine terms and odd harmonics. The Fourier coefficients for
            g
            (
            t
            ) are
          




            Shifting the time origin alters the even or odd symmetry properties of a periodic waveform because these symmetries depend on values of
            f
            (
            t
            ) on opposite sides of the vertical axis at
            t
            = 0. The half-wave symmetry of a waveform is not changed by time shifting because this symmetry only requires successive half-cycles to have the same form but opposite polarities.
            ■















Exercise 13-5



            (a) Identify the symmetries in the waveform
            f
            (
            t
            ) whose Fourier series is
          




            (b) Write the corresponding terms of the function
            g
            (
            t
            ) =
            f
            (
            t- T
0
            /4).
          
Answers:
(a) Even symmetry; half-wave symmetry; zero average value.

            (b)
            





Discussion:

It may appear that Fourier series are simply a way to create a facsimile of a periodic waveform. But it is much more than that. The various sinusoids that are found in the decomposition of the waveform using the Fourier series process are actually in the waveform itself. The periodic signal is composed of the sum of all those sinusoids. As we will see in the next section, the circuit response to a periodic waveform is equivalent to processing each individual sinusoid separately and then summing them together.




13-4 Circuit Analysis Using the Fourier Series


        Up to this point, we have concentrated on finding the Fourier series description of periodic waveforms. We are now in a position to address circuit analysis problems of the type illustrated in
        Figure 13-8
        . This first-order
        RL
        circuit is driven by a periodic sawtooth voltage, and the objective is to find the steady-state current
        i
        (
        t
        ).
      








FIGURE 13-8



Linear circuit with a periodic input.






        We begin by using the results in
        Example 13-4
        to express the input voltage as a Fourier series in the form
      



(13-14)





        This result expresses the input driving force as the sum of a dc component plus ac components at harmonic frequencies
        n
        ω
        0
        = 2π
        nf
0
        ,
        n
        = 1, 2, 3,,... Since the circuit is linear, we find the steady-state response caused by each component acting alone and then obtain the total response by superposition.
      

        In the dc steady state, the inductor acts like a short circuit, so the steady-state current due to the dc input
        V
A
        /2 is simply
        I
0
        =
        V
A
        /(2
        R
        ). The amplitude and phase angle of the
        n
        th harmonic of the sawtooth input are
      




        In
        Chapter 11
        , we found that the sinusoidal steady-state response at frequency ω
        A
        can be found directly from a network function
        T
        (
        s
        ) as
      




        In the present case, the input is the nth harmonic at ω
        A
        =
        n
        ω
        0
        , the output is the current
        I
        (
        s
        ) =
        V
        (
        s
        )/
        Z
        (
        s
        ), and hence the network function of interest is
        T
        (
        s
        ) = 1/(
        Ls
        +
        R
        ). Applying the
        Chapter 11
        method here yields the amplitude and phase of the
        n
        th harmonic current as
      




        Defining θ
        
n

        = tan
        -1
n
        ω
        0
L
        /
        R
        ), we get the waveform of the steady-state response to the
        n
        th harmonic input.
      




        We have now found the steady-state response of the circuit due to the dc component acting alone and the
        n
        th harmonic ac component acting alone. Since the circuit is linear, superposition applies and we find that the steady-state response caused the sawtooth input by summing the contributions of each of these sources:
      



(13-15)






        The Fourier series in
        Eq. (13-15)
        represents the steady-state current due to a sawtooth driving force whose Fourier series is in
        Eq. (13-14)
        .
      













EXAMPLE 13-6



                Find the first four nonzero terms of the Fourier series in
                Eq. (13-15)
                for
                V
A
                = 25 V,
                R
                = 50 Ω,
                L
                = 40 µH, ω
                0
                = 1 Mrad/s. Use Multisim to simulate the circuit's response using a sawtooth input and compare it to an input made up of the first four terms of the Fourier series representing the sawtooth input.
              




SOLUTION:



Equation (13-15)
            gives a Fourier series of the form
          



where



Inserting the numerical values leads to




            The first four nonzero terms in the Fourier series include the dc component plus the first three harmonics. For
            n=
            0, 1, 2, 3, we have
          



Hence, the desired expression is




            Multisim has a sawtooth voltage source available. It is under "signal voltage sources" and is called a
            triangular voltage.
            We adjusted the period to 1/
            f
0
            or 6.2832 µs and the fall time to a fast 0.1 ps. For the Fourier series simulation, we placed
            
            four sources in series that correspond to the first four Fourier series components, such as 125 V dc, 7.9577 sin (2π × 159, 155) V, 3.9789 sin (2π × 318, 310) V, and 2.6526 sin (2π × 477,465 V. The two circuits and their responses are shown in
            Figure 13-9
            .
          








FIGURE 13-9








            We used Multisim's Grapher View to plot the results of two cycles of the voltage input and the current output under two conditions. We started our plot at 6 µs well after the initial transient died down. The time constant is τ =
            L
            /
            R
            = 0.8 µs. Waiting greater than 5 time constants or 4 µs, let us see the steady-state results. In the first case, we used Multisim's sawtooth containing (ideally) all the harmonics—the triangular voltage. In the second case, we constructed an input using dc and ac sources corresponding to the first four terms of the Fourier series. Note that in Multisim the individual voltage sources are sine waves (not cosine waves) and need to be connected to produce a negative sine wave for the series. On the Grapher View, the input sawtooth wave is labeled Sawtooth voltage input and is reproduced well by Multisim. The current response due to the sawtooth wave is labeled Sawtooth current output.
          

            Replacing the sawtooth with its first four terms yields the input curve labeled as Fourier 4-term voltage input. It is only a modest representative of the sawtooth. It would take more terms to obtain a more reasonable approximation to an ideal sawtooth, as was shown in
            Example 13-2
            . The resulting current is labeled Fourier 4-term current output and is a good approximation for the actual current response.
            ■








        The results in
        Example 13-6
        require some additional scrutiny to appreciate fully the Fourier analysis.
      

        First note that if
        L
        = 0,
        Eq. (13-15)
        reduces to
      




        which is the Fourier series of a sawtooth wave of amplitude
        V
A
        /
        R
        . This makes sense because without the inductor the circuit in
        Figure 13-8
        is a simple resistive circuit in which
        i
        (
        t
        ) = υ
        s
        (
        t
        )/
        R
        , so the input and response must have the same waveform.
      

        When
        L
        ≠ 0, the response is not a sawtooth, but we can infer some features of its waveform if we examine the amplitude spectrum. At high frequency [(
        n
        ω
        0
L
        /
        R
        ) ≫ 1]
        Eq. (13-15)
        points out that the amplitudes of the ac components are approximately
      


(13-16)




        In the steady-state response, the amplitudes of the high-frequency ac components decrease as 1/
        n
2
        , whereas the ac components in the input sawtooth decrease as 1/
        n.
        In other words, the relative amplitudes of the high-frequency components are much smaller in the response than in the input. This makes sense because the inductor's impedance increases with frequency and thereby reduces the amplitudes of the high-frequency ac currents. We would expect the circuit to filter out the high-frequency components in the input and produce a response without the sharp corners and discontinuities in the input sawtooth.
      

        This is exactly the response we see in
        Figure 13-9
        with the plot of the truncated series from
        Example 13-6
        labeled as Fourier 4-term voltage input. The plot approximates a rounded version of the sawtooth waveform, which indicates the high-frequency components have been removed. The high-frequency components are responsible for the sharp transitions, which appear in the original sawtooth waveform, but not in the waveform representing the steady-state current
        i
        (
        t
        ) in the circuit. It would take an infinite number of harmonics to exactly reproduce the sharp transitions.
      
The next example demonstrates the fact that a square wave, for example, really consists of individual sinusoids that add together to form the periodic waveform. The subsequent example illustrates how the Fourier components of a waveform allow us to better understand the performance of a realistic circuit application.














DESIGN EXAMPLE 13-7



                Design a series
                RLC
                tuned filter to pass only the third harmonic of a 5-V 200 kHz square wave. Show that only the third harmonic is the dominant frequency at the output of the filter. Validate the design using Multisim.
              




SOLUTION:


A 5-V 200 kHz square wave can be represented by the following Fourier series




            For a 5-V square wave with odd symmetry,
            Figure 13-4
            indicates that
          





            Substituting the values for
            V
A
            ,
            f
0
            , and
            n
            , we can write the series of the first three terms as
            
            .
          

            A properly designed tuned filter would allow the third harmonic to exit the filter with no attenuation while severely attenuating the other frequencies. Higher harmonics will be increasingly attenuated since they are naturally weaker (magnitude divided by
            n
            ) and the filter attenuates these frequencies more as they are further removed from the tuned frequency. The transfer function of a series
            RLC
            tuned filter is
          




            We know we want the center frequency (ω
            0
            ) to be equal to the frequency of the third harmonic, namely 3.770 Mrad/s. For a series
            RLC
            circuit, the center frequency is given as
            
            . In order to select out just the third harmonic, we will need a modestly high
            Q
            . Again for a series
            RLC
            tuned filter,
            
.
            Since
            L
            and
            C
            will be selected to meet the center or resonant frequency,
            R
            will be chosen to create the
            Q
            . Selecting
            L
            = 1 mH, a standard value, results in a
            C
            = 70.362 pF, a value obtained using a standard 50-100 pF trimmer capacitor. A standard value
            R
            of 100 Ω yields a
            Q
            of 37.7, a reasonably high
            Q
            .
          
The resulting transfer function is



We will now calculate the resulting magnitudes of the sinusoidal steady-state output of the fundamental and the third and fifth harmonics.




            Multiplying the magnitude of each term of the input sinusoid υ
            1
            (
            t
            ) by the magnitude of the transfer function evaluated at the same frequency, yields
          




            Simulating this circuit in Multisim requires the use of the
            Bipolar Voltage
            from the "Signal Voltage Sources." We set the source at 200 kHz, + 5 V, -5 V, 100% duty cycle, and very fast rise and fall times of 1 ps. We then asked Grapher View to plot
            
            the input square wave and the output of the filter. The fundamental has been attenuated by 40 dB and the fifth harmonic by 32 dB. The desired third harmonic was only attenuated by 0.0087 dB.
            Figure 13-10
            shows the Multisim circuit and the Grapher View plots.
          








FIGURE 13-10








            One could increase the attenuation of both the fundamental and the third harmonic by increasing the
            Q
            of the circuit. Note that high values of
            Q
            require accurate values of
            L
            and
            C
            to ensure that the tuned frequency is exactly where it is desired since even a tiny error might cause the desired frequency to be significantly attenuated.
            ■
















              Design
              Exercise 13-6



            Design a first-order low pass filter to allow only the fundamental of the square wave of
            Design Example 13-7
            to pass with an attenuation of ≤ 3 dB. Verify your results by calculating the magnitude of the fundamental and of the third harmonic.
          


Answers:



            Select ω
            C
            = 1.256 Mrad/s, the frequency of the fundamental. Use a series
            RC
            circuit with the output taken across
            C
            . Select
            R
            = 1 kΩ,
            C
            = 796 pF. Magnitude of fundamental = 4.50 V(-3dB). Magnitude of third harmonic = 0.671 V (-10 dB).
            

Note:


            A first-order filter has a roll-off of-20 dB per decade. A third harmonic is only half a decade on a log scale. If better isolation is desired, then a higher-order filter is needed, which is the topic of
            chapter 14
            .
          

















                  APPLICATION
                  EXAMPLE 13-8



Figure 13-11
                shows a block diagram of a dc power supply. The ac input is a sinusoid that is converted in to a full-wave sine by the rectifier. The filter passes the dc component in the rectified sine and suppresses the ac components. The result is an output consisting of a small residual ac ripple riding on top of a much larger dc signal.
              









FIGURE 13-11








                Calculate and plot the first 10 harmonics in amplitude spectra of the filter input and output for
                V
A
                = 23.6 V,
                T
0
                = 1/60 s and a low-pass filter transfer function of
              



Derive an expression for the first three nonzero terms in the Fourier series of the steady-state output voltage.




SOLUTION:



            The amplitude spectrum of the filter input is obtained using the Fourier coefficients for the full-wave rectified sine in
            Figure 13-4
            :
          



(13-17)




The magnitude of the transfer function at each of these discrete frequencies is



(13-18a)




The phase of the transfer function at each of these discrete frequencies is



(13-18b)





            To obtain the specified output spectrum, we must generate the product of the input amplitude times the transfer function magnitude for
            n
            = 0,1,2,3...10. Similarly, we must generate the sum of the phase of the input function plus the angle of the transfer function at those same values of
            n.


            Spreadsheets are ideally suited for making repetitive calculations of this type.
            Figure 13-12
            shows an Excel spreadsheet that implements the required calculations. Column A gives the index
            n
            and Column B gives the corresponding frequencies in Hz. Column C calculates the frequencies in rad/s. Column D calculates the input amplitudes using
            Eq. (13-17)
            . Column E calculates the magnitude of the transfer
            
            function at the frequency in question—the Excel equation for the calculation in
            Eq. (13-18(a))
            is
          




            Column F computes the output amplitudes by taking the product of the input amplitude and the magnitude of the transfer function for each frequency. Finally, Column G computes the phase at the corresponding frequency—the Excel equation for the calculation in
            Eq. (13-18(b))
            , noting that the function ATAN() returns the angle in radians is
          




            Excel then is used to produce the bar graph of the magnitudes shown in
            Figure 13-12
            . Since the low-pass filter has unity gain at zero frequency, the dc components in the input and output are equal. The second harmonic at 120 Hz is the first nonzero component at the output. It has a 10-V input amplitude but only a 754-mV output amplitude. By the fourth harmonic at 240 Hz, the 2-V input amplitude has been reduced to less than 36 mV. This and subsequent harmonics are entirely negligible.
          








FIGURE 13-12







To write the expression for the first three nonzero terms of the steady-state output voltage, we need to know the magnitude and phase at dc and at the second and the forth harmonics. Excel calculated these values for us and are shown in white on black on the spreadsheet. We can then write the output as


■
















Exercise 13-7




            Use Excel to calculate the tuned filter attenuation in dB for
            n
            = 1, 3, 5, and 7 for
            Example 13-7
            .
          


Answer:



            See
            Figure 13-13
            .
          








FIGURE 13-13












13-5 RMS Value and Average Power


        In
        Chapter 5
        , we introduced the rms value of a periodic waveform as a descriptor of the average power carried by a signal. In this section, we relate the rms value of the waveform to the amplitudes of the dc and ac components in its Fourier series. The rms value of a periodic waveform is defined as
      



(13-19)





        The waveform
        f
        (
        t
        ) can be expressed as a Fourier series in the amplitude and phase form as
      




        Substituting this expression into
        Eq. (13-19)
        , we can write
        
        as
      


(13-20)



Squaring and expanding the integrand on the right side of this equation produces three types of terms. The first is the square of the dc component:


(13-21)





        The second is the cross product of the dc and ac components, which takes the form
      


(13-22)



These terms all vanish because they involve integrals of sinusoids over an integer number of cycles. The third and final type of term is the square of the ac components, which can be written as



(13-23)





        This rather formidable expression boils down to a simple sum of squares because all of the integrals vanish except when
        m
        =
        n
        .
      

        Combining
        Eqs. (13-19)
        through
        (13-23)
        , we obtain the rms value as
      



(13-24)





        Since the rms value of a sinusoid of amplitude
        A
        is
        
        , we conclude that
      



The rms value of a periodic waveform is equal to the square root of the sum of the square of the dc value and the square of the rms value of each of the ac components.




        In
        Chapter 5
        ,
        Eq. (5-35)
        , we found that the average power delivered to a resistor is related to its rms voltage or current as
      




        Combining these expressions with the result in
        Eq. (13-24)
        , we can write the average power delivered by a periodic waveform in terms of the average power delivered by each of its Fourier components:
      

(13-25)



        where
        P
0
        is the average power delivered by the dc component and
        
          P
          n

        the average power delivered by the
        n
        th ac component. This additive feature is important because it means we can find the total average power by adding the average power carried by the dc component to that carried by each of the ac components.
      



Caution:


        In general, we cannot find the total power by adding the power delivered by each component acting alone because the superposition principle does not apply to power. However, the average power carried by harmonic sinusoids is additive because they belong to a special class called
        orthogonal signals.













EXAMPLE 13-9



                Derive an expression for the average power delivered to a resistor by a sawtooth voltage of amplitude
                V
A
                and period
                T
0
                . Then calculate the fraction of the average power carried by the dc component plus the first three ac components.
              




SOLUTION:




            An equation for the sawtooth voltage is υ(
            t
            ) =
            V
A
t
            /
            T
0
            for the range 0<
            t
            <
            T
0
            . The square of the rms value of a sawtooth is
          



The average power delivered to a resistor is




            This result is obtained directly from the sawtooth waveform without having to sum an infinite series. The same answer could be obtained by summing an infinite series. The question this example asks is, how much of the average power is carried by the first four components in the Fourier series of the sawtooth wave? The amplitude spectrum of the sawtooth wave (see
            Example 13-4
            ) is
          




            From
            Eq. (13-25)
            , the average power in terms of amplitude spectrum is
          



which can be arranged in the form




            The infinite series within the braces sums to 0.333 and matches the average power we calculated directly from the waveform itself. The dc component plus the first three ac terms contribute 0.319 to the infinite sum. In other words, these four components alone deliver 96% of the average power carried by the sawtooth wave.
            ■















Exercise 13-8



            The full-wave rectified sine wave shown in
            Figure 13-4
            has an rms value of
            
            . What fraction of the average power that the waveform delivers to a resistor is carried by the first two nonzero terms in its Fourier series?
          


Answer:



            Fraction = 88/9π
            2
            or 99.07%
          

















EXAMPLE 13-10


Figure 13-14
                (a) shows a series
                RL
                circuit driven by a sawtooth voltage source.
              


                  (a) Estimate the average power delivered to the resistor for
                  V
A
                  =25V,
                  R=
                  50, Ω,
                  L
                  = 40 µH,
                  T
0
                  = 5 µs, and ω
                  0
                  = 2π/
                  T
0
                  = 1.26 Mrad/s.
                
(b) Build the circuit in Multisim. Use the triangular source and set the amplitude to 25 V and zero offset. Also set the fall time to 1 ps to simulate a sawtooth wave. Show the power variation through the resistor. Then measure the average power. Comment on the results.











FIGURE 13-14









SOLUTION:



            The Fourier series of the current in a series
            RL
            circuit is given in
            Eq. (13-15)
            as
          



where



We cannot directly calculate the rms value of this current without a closed-form expression for its waveform. However, we can get an estimate of the average power from the Fourier series. In terms of its Fourier series, the average power delivered by the current is




            When
            
            , the amplitude
            
              I
              n

            decreases as 1/
            n
2
            and its contribution to the average power falls off as 1/
            n
4
            . In other words, the infinite series for the average power converges very rapidly. To show how rapidly the series converges, we calculate the first few terms using the specified numerical values
          




            These results indicate that
            P
            = 3.48 W is a reasonable estimate of the average power, an estimate obtained using only four terms in the infinite series. The important point is that the high-frequency ac components are not important contributors to the average power carried by a signal.
          

            Multisim shows the power in the resistor starts at zero then grows to follow the increasing sawtooth wave input. But it does not grow instantaneously, rather it has an
            L
            /
            R
            time constant. Before it can reach its final value, the triangular wave falls back to zero and the power in the resistor decays toward zero. Again, before the power in the resistor can decay to zero, the sawtooth wave begins to increase. Thus,
            
            the power waveform repeats for every cycle, as shown in
            Figure 13-14
            (b). If we ask Multisim to calculate the average power, we need to use "Add expression", namely "avg(P(R1))." The result is still an oscillation that takes many cycles for the average power to stabilize. See
            Figure 13-14
            (c). From the inset, Multisim measures the peak as 3.48452 W and the minimum as 3.48446 W or an average of 3.48449 W which is in good agreement with what was calculated by hand.
          








FIGURE 13-14








■















Exercise 13-9


            In the rectangular-pulse waveform shown in
            Figure 13-4
            , the width of the pulse is one-third the period,
            T
            =
            T
0
            /3. The waveform is to pass through a low-pass filter and then through a resistive load. The load must receive at least 97% of the average power in the original waveform. Determine the minimum value of
            N
            such that if the filter passes components
            V
0
            ,
            V
1
            ,
            V
2
            ,...,
            
              V
              N

            , the load will receive the required amount of power.
          

            (
            Hint
            : You may want to use MATLAB to perform the calculations.)
          


Answer:



N
            = 10.
          











            APPLICATION
            EXAMPLE 13-11

The Fourier series serves as an introduction to the concept that a signal can be described by a spectrum that gives the distribution of amplitudes (and sometimes phases) of the sinusoidal components in a waveform. Radio, television, cell phones, satellite communication, and radar systems must confine their signal spectra to an allocated portion of the available electromagnetic spectrum. Spectral allocations are regulated by various governmental agencies since there are many potential users and a limited spectral resource. The International Telecommunication Union (ITU) provides global guidance, while specific national regulators such as the Federal Communication Commission (FCC) in the United States control the spectrum within its borders. As a result, users must design their systems to operate within specified spectral limitations.

            These limitations are often specified using the concept of
            signal bandwidth
            , defined as the frequency interval outside of which the amplitude spectrum is less than some specified value. Accordingly, signal bandwidth (B) can be quantified by the expression
          




            where
            f
U
            and
            f
L
            are the upper and lower limits on the bandwidth interval. Bandwidth is a partial signal descriptor that places an upper bound on the spectral content outside of the interval
            f
L
            <
            f
            <
            f
U
            .
            

Caution:


            The spectral content inside the interval can be less than this upper bound at some frequencies but must be less at every frequency outside the interval.
          

            For a periodic waveform, the lower frequency bound is
            f
L
            =
            f
0
            when there is no dc component (
            a
0
            = 0) and is
            f
L
            = 0 when
            a
0
            is not zero. The upper bound is another matter. In general, the Fourier series is an infinite series, so that in theory its spectral content extends to infinite frequency. However, we have seen the amplitudes of the higher
            harmonics
            become negligibly small and make little contribution to the waveform's energy content. In other words, an acceptable approximation to a periodic waveform is obtained when its Fourier series is terminated at some designated
            f
U
            =
            nf
0
            .
          

            One simple way to select
            nf
0
            is to compare the amplitudes of the high-frequency harmonics with the amplitude of the largest ac component, usually the fundamental. Harmonics whose amplitudes are less than a specified fraction (say 5%) of the fundamental are ignored. Applying a 5% criterion to waveforms whose Fourier coefficients decrease as 1/
            n
            (square wave, rectangular pulse, and sawtooth wave; see
            Figure 13-4
            ) yields
            f
U
            = 20
            f
0
            . Waveforms whose harmonics fall off as 1/
            n
2
            (triangular wave and rectified sine waves) meet a 5% bound at about
            f
U
            =5
            f
0
            . Regardless of the criteria used, the basic idea is that signal bandwidth is an important design consideration that in turn influences the bandwidth required in system components.
          
For example, accurate representation of arterial blood pressure waveforms requires the first eight harmonics of the pressure signal. To get a useful record of the arterial pressure waveform, the bandwidth (in Hz) of a measurement system must be at least eight times the maximum heart rate (in beats/second). Thus, designing a recording system for a maximum heart rate of 180 beats/minute requires a minimum bandwidth of 24 Hz (180 beats/min/60 s/min = 3 beats/s × 8 = 24 Hz).











              APPLICATION
              EXAMPLE 13-12



            Digital signal processing uses samples of an analog waveform, as contrasted with analog processing, which operates on the entire waveform. Sampling refers to the process of selecting discrete values of a time-varying analog waveform for further
            
            processing. By far, the most common method of sampling is to record the waveform amplitudes at equally spaced time intervals. The set of samples υ
            
k

            {
            k
            = 1,2,3,...} of an analog waveform υ(
            t
            ) is defined as
          




            where
            k
            is an integer and
            
              T
              S

            the time interval between successive samples.
            Figure 13-15
            shows an example of sampling an analog waveform.
          
The digitized samples can be stored in a computer or some other medium such as a flash drive. These samples become the only means of describing the original analog signal. How good of a description can they be? From our experience, we know that a reasonable facsimile can be obtained if the samples are closely spaced. Intuitively, it might seem that exact reconstruction of the analog waveform would require the time between samples to approach zero. Surprisingly, exact reproduction is possible from samples taken at finite intervals.




An analog waveform
                  υ(
                  t
                  )
                  
                    whose spectral content falls below f
                    max
                    can be reproduced exactly from samples
                  
                  υ
                  k
                  =
                  υ
                  (
                  kT
S
                  ) if the sampling rate f
                  S
                  = 1/
                  T
S
is greater than
                  2
                  f
max
                  .
                




            This statement, known as the
            sampling theorem,
            is one of the key principles of signal processing. The theorem states that exact recovery requires a minimum sampling rate of 2
            f
max
            .
            
3

            Analog waveforms are usually sampled at a rate higher than the minimum. For example, the industry standard sampling rate for recording digital audio signals is
            
              f
              S

            =44.1 kHz, which is slightly more than twice the generally accepted upper limit on human hearing at
            f
max
            = 20 kHz.
          

            The important point is that the minimum sampling rate is determined by the spectral content of the original analog waveform. Waveforms whose sinusoidal components all fall in the band 0 ≤
            f ≤ f
max
            are said to be
            strictly band-limited.
            For example, the waveform
          




            is strictly band-limited with
            f
max
            = 1.2 kHz and can be reproduced exactly from samples taken at any
            f
S
            > 2.4 kHz.
          

            Most analog signals are not strictly band limited but usually have an upper frequency limit beyond which the spectral content is of no interest. For example, a periodic waveform is not strictly band-limited because its Fourier series is an infinite sum of harmonics at
            nf
0
.
            However, the amplitudes of the higher harmonic become negligibly small as
            n →
            ∞. A band-limited approximation to a periodic waveform is obtained by defining
            f
max
            =
            nf
0
            , where
            nf
0
            is the harmonic beyond which the spectral amplitudes are less than some specified value.
          
Examples of the maximum frequency of interest for some biomedical signals are:











FIGURE 13-15



Sampled signal.






            For these signals, the spectral content above the listed
            f
max
            does not contain useful diagnostic information and can be ignored. As a result, biomedical signals have minimum sampling rates ranging from
            f
S
            =20 Hz to
            f
S
            = 20 kHz.
          

            But we cannot simply ignore the spectral content above
            f
max
            . It turns out that sampling signals that are not strictly band-limited causes
            aliasing,
            a process by which seemingly negligible out-of-band spectral content reappears as in-band distortion. The answer to the aliasing problem is to filter the analog signal prior to sampling. These
            anti-aliasing filters
            must pass spectral content up to the
            highest frequency of interest, f
max
            and suppress the spectral content above the
            lowest aliasing frequency
            at
            f
S
            -
            f
max
            where
            f
S
            is the sampling frequency.
          

Figure 13-16
            shows the gain response of an anti-aliasing filter used in telecommunication. This low-pass filter has 0 dB gain at dc, -3 dB gain at
            f
max
            =3.3 kHz, and less than-60 dB gain at 2
            f
max
            . This type of gain response cannot be achieved by the first- and second-order filters studied in
            Chapter 12
            . This type of performance calls for higher-order filters of the type discussed in
            Chapter 14
            .
          








FIGURE 13-16



Antialiasing filter.















Exercise 13-10



            What is the minimum sampling rate for the filtered signal in
            Example 13-7
            .
          


Answer:



            The only signal emanating from the filter in
            Example 13-7
            is at 600 kHz. Hence, the minimum Nyquist sampling rate is two times the highest frequency or 1.2 MHz.
          










Exercise 13-11


            What is the maximum frequency that can be adequately sampled with the filter shown in
            Figure 13-16
            ? What is the minimum sampling frequency for those signals?
          


Answer:



f
max
            = 3.3 kHz.
            f
S
            = 6.6 kHz.
          




Summary


          The
          Fourier series
          resolves a periodic waveform into a dc component plus an ac component containing an infinite sum of harmonic sinusoids. The dc component is equal to the average value of the waveform. The amplitudes of the sine and cosine terms in the ac component are called Fourier coefficients. A plot of the Fourier coefficients
          
            a
            n

          and
          
            b
            n

          is called a
          trigonometric
          line plot.
        

Waveform symmetries
          cause the amplitudes of some terms in a Fourier series to be zero. Even symmetry causes all of the sine terms in the ac component to be zero. Odd symmetry causes all of the cosine terms to be zero. Half-wave symmetry causes all of the even harmonics to be zero.
        

          An
          alternative form
          of the Fourier series represents each harmonic in the ac component by its amplitude and phase angle. A plot of amplitudes versus frequency is called the
          amplitude spectrum.
          A plot of phase angles versus frequency is called the
          phase spectrum.


          The
          steady-state response
          of a linear circuit for a periodic driving force can be found by first finding the steady-state response due to each term in the Fourier series of the input. The Fourier series of the steady-state response is then found by adding (superposing) responses due to each term acting alone. The individual responses can be found using either phasor or
          s
          -domain analysis.
        

          The
          rms value of a periodic waveform
          is equal to the square root of the sum of the square of the dc value and the square of the rms value of each of the ac components. The
          average power delivered by a periodic waveform
          is equal to the average power delivered by the dc component plus the sum of average power delivered by each of the ac components.
        





Chapter 13
        Problems
      






            Objective 13-1 The Fourier Series (
            Sects. 13-1
            to
            13-3
            )
          

(a) Given an equation or graph of a periodic waveform, derive expressions for the Fourier coefficients.

              (b) Given ao,
              
                a
                n
                ,
              
              and
              
                b
                n
                ,
              
              calculate the Fourier coefficients of a given periodic waveform.
            
(c) Given a Fourier series of a periodic waveform, determine properties of the waveform and plot its amplitude and phase spectra.


            See
            Examples 13-1
            to
            13-5
            and
            Exercises 13-1
            to
            13-5
            .
          





13-1
          Find the first four terms of the Fourier series of an offset square wave waveform shown in
          Figure 13-4
          in the text if
          a
0
          = A.
        



13-2
          A sine wave has an amplitude of 311.2 V, a radian frequency of 314 rad/s, and a phase shift of 90°. Find the Fourier series expression for this waveform.
        





13-3
          Derive expressions for the Fourier coefficients of the periodic waveform in
          Figure P13-3
          .
          







FIGURE P13-3











13-4
          Derive expressions for the Fourier coefficients of the periodic waveform in
          Figure P13-4








FIGURE P13-4












13-5
          The equation for the first cycle (0 ≤
          t ≤ T
0
          ) of a periodic pulse train is
          




(a)
              Sketch the first two cycles of the waveform.
            

(b)
              Derive expressions for the Fourier coefficients
              
                a
                n

              and
              
                b
                n

              .
            






13-6
          Derive expressions for the Fourier coefficients of the periodic waveform in
          Figure P13-6
          . Use MATLAB to find the coefficients.
          







FIGURE P13-6












13-7
          Find the first five nonzero Fourier coefficients of the shifted and offset square wave in
          Figure P13-7
          . Use your results to write an expression for the corresponding Fourier series.
          







FIGURE P13-7











13-8
          Use the results in
          Figure 13-1
          in the text to calculate the Fourier coefficients of the shifted triangular wave in
          Figure P13-8
          . Write an expression for the first four nonzero terms in the Fourier series.
          







FIGURE P13-8












13-9
          Derive expressions for the Fourier coefficients of the periodic waveform in
          Figure P13-9
          .
          

(a)
              Write an expression for the first four nonzero terms in the Fourier series.
            

(b)
              Plot the line spectrum of the Fourier coefficients
              
                A
                n

              and ϕ
              
n

              .
            









FIGURE P13-9











13-10
          A particular periodic waveform with a period of 10 ms has the following Fourier coefficients
          




(a)
              Write an expression for the terms in the Fourier series up to
              n
              = 8.
            

(b)
              Plot its trigonometric line spectrum
            

(c)
              Convert your expression into amplitude and phase form and plot its line spectrum.
            







13-11
          A half-wave rectified sine wave has an amplitude of 171 V and a fundamental frequency of 60 Hz. Use the results in
          Figure 13-4
          to write an expression for the first four nonzero terms in the Fourier series. Use MATLAB to plot the amplitude spectrum of the signal.
        




13-12
          The waveform
          f
          (
          t
          ) is a 10-kHz triangular wave with a
          peak-to-peak
          amplitude of 15 V and a + 7.5-V dc offset. Use the results in
          Figure 13-1
          in the text to write an expression for the first four nonzero terms in the Fourier series of
          f
          (
          t
          ) and plot its amplitude spectrum. Use MATLAB to plot two periods of
          f
          (
          t
          ) and an estimate for
          f
          (
          t
          ) using the first four nonzero terms in the Fourier series. Comment on the differences between the two waveforms.
        





13-13
          A sawtooth wave has
          peak-to-peak
          amplitude of 5 V and a fundamental frequency of 100 Hz. Use the results in
          Figure 13-4
          in the text to write an expression for the first four nonzero terms in the Fourier series and plot the amplitude spectrum of the signal. Use MATLAB to plot two periods of the original signal and an estimate for the signal using the first four nonzero terms in the Fourier series. Comment on the differences between the two waveforms.
        




13-14
          The equation for a periodic waveform is
          




(a)
              Sketch the first two cycles of the waveform and identify a related signal in
              Figure 13-4
              in the text.
            

(b)
              Use the Fourier series of the related signal to find the Fourier coefficients of υ(
              t
              )
              .


(c)
              Use MATLAB to sketch an estimate for the signal using the Fourier coefficients for
              n ≤
              6.
            







13-15
          The first four terms in the Fourier series of a periodic waveform are
          




(a)
              Find the period and fundamental frequency in rad/s and Hz. Identify the harmonics present in the three sinusoidal terms.
            

(b)
              Identify the symmetry features of the waveform.
            

(c)
              Plot the waveform using MATLAB.
            






13-16
          The first five terms in the Fourier series of a periodic waveform are
          




(a)
              Find the period and fundamental frequency in rad/s and Hz. Identify the harmonics present in the first five terms.
            

(b)
              Use Excel to plot two periods of
              υ
              (
              t
              ).
            

(c)
              Identify the symmetry features of the waveform.
            







13-17
          The equation for a full-wave rectified cosine is υ(
          t
          ) =
          V
A
          |cos(2π
          t
          /
          T
0
          )|V.
          

(a)
              Hand Sketch υ(
              t
              ) for-
              T
0
≤ t ≤ T
0
.


(b)
              Compute the Fourier coefficients for υ(
              t
              ).
            

(c)
              Use the Fourier coefficients and MATLAB to plot an estimate for υ(
              t
              ).
            

(d)
              What, if any, symmetries are therein υ(t)?
            









            Objective 13-2 Fourier Series and Circuit Analysis (
            Sect. 13-4
            )
          

(a) Given a linear circuit with a periodic input waveform, find the Fourier series of a steady-state response.
(b) Given a network function with a periodic input, find the amplitude and phase spectra of the steady-state output.


            See
            Examples 13-6
            to
            13-8
            and
            Exercises 13-6
            and
            13-7
            .
          





13-18
          An
          RC
          series circuit is driven by the following periodic source:
          




(a)
              Find the output taken across the capacitor when
              R
              = 50 Ω and
              C
              = 2 µF
            

(b)
              Simulate the output using Multisim and compare it to the input when
              C
              varies from 0.1 to 10 µF Perform a "Parameter sweep" analysis on the capacitor over that range using a decade sweep, 2 points per decade. Comment on the output waveform, with respect to the input. What function is the circuit performing?
            







13-19
          The periodic pulse train in
          Figure P13-19
          is applied to the
          RL
          circuit shown in the figure.
          

(a)
              Use the results in text
              Figure 13-4
              to find the Fourier coefficients of the input for
              V
A
              = 12 V,
              T
0
              = 2π ms, and
              T
              =
              T
0
              /4.
            

(b)
              Find the first four nonzero terms in the Fourier series of υ
              0
              (
              t
              ) for
              R
              = 470 Ω and
              L
              = 220 mH.
            









FIGURE P13-19












13-20
          The periodic sawtooth wave in
          Figure P13-20
          drives the OP AMP circuit shown in the figure.
          

(a)
              Use the results in
              Figure 13-4
              in the text to find the Fourier coefficients of the input for
              V
A
              = 3 V and
              T
0
              =4π ms.
            

(b)
              Find the first four nonzero terms in the Fourier series of υ
              O
              (t).
            

(c)
              Simulate the circuit using Multisim. Use the triangular source and make the fall time very short (0.1 ps). Plot three cycles of the output. The voltage limit for the OP AMP is
              V
CC
              = ± 15 V. Explain why the plot looks like it does.
            









FIGURE P13-20













13-21

(a)
          Design a low-pass OP AMP circuit to pass only the fundamental and the next nonzero harmonic of a 2π ms square wave. The gain of the OP AMP should be +10.
          

(b)
              Find the first four nonzero terms in the Fourier series of the output of your filter.
            

(c)
              Validate your design using Multisim. The OP AMP's
              V
CC
              =± 15 V.
            






13-22
          The periodic triangular wave in
          Figure P13-22
          is applied to the
          RLC
          circuit shown in the figure.
          

(a)
              Use the results in
              Figure 13-4
              in the text to find the Fourier coefficients of the input for
              V
A
              = 5 V and
              T
0
              = 400π µs.
            

(b)
              Find
              T
              (
              s
              ) =
              V
C
              (
              s
              )/
              V
S
              (
              s
              ).
            

(c)
              Find the amplitude of the first five nonzero terms in the Fourier series for υ
              
C

              (
              t
              ) when
              R
              = 1 Ω,
              L
              = 8 mH, and
              C
              = 0.2 µF What term in the Fourier series tends to dominate the response? Explain.
            

(d)
              Build the circuit but use a simple ac source. Do an ac sweep and verify why the circuit responds as it does. Multiply the input
              
                a
                n

              at 25 krad/s and verify that
              υ
C
              (
              t
              ) is correct.
            









FIGURE P13-22












13-23
          The Fourier coefficients of a periodic input signal are:
          



            The signal has
            V
A
            = 10 V and
            T
0
            = 20π ms and drives a circuit with a transfer function of
          



Find the amplitude of the first four nonzero terms in the Fourier series of the steady-state output. construct plots of the amplitude and phase spectra for the input and output waveforms and comment on any differences.




13-24
          Repeat Problem 13-23 for
          







13-25

          Design a tuned
          RLC
          filter to pass the third harmonic of a triangular wave.
          

(a)
              Use the results in
              Figure 13-4
              in the text to find the Fourier coefficients of the input for
              V
A
              = 15 V and
              T
0
              = 10π ms. Design your filter with a
              Q
              of 10.
            

(b)
              compare the magnitudes of the fundamental and of the fifth harmonic with that of the third harmonic at the input and output of the tuned filter.
            






                  
          13-26

          Design a notch
          RLC
          filter to block the third harmonic of a triangular wave.
          

(a)
              Use the results in
              Figure 13-4
              in the text to find the Fourier coefficients of the input for
              V
A
              = 12 V and
              T
0
              = 5π ms. Design your filter with a
              Q
              of 15.
            

(b)
              Compare the magnitudes of the fundamental and of the fifth harmonic with that of the third harmonic at the input and output of the tuned filter.
            






13-27
          The current through a 1-H inductor is a triangular wave with
          I
A
          = 25 mA and
          f
0
          = 500 Hz. Construct plots of the amplitude spectra of the inductor voltage and current. Discuss any differences in spectral content.
        




13-28

          A triangular wave with
          V
A
          = 10 V and
          T
0
          = 20π ms drives a circuit whose transfer function is
          




(a)
              Find the amplitude of the first four nonzero terms in the Fourier series of the steady-state output. What term in the Fourier series tends to dominate the response? Explain.
            

(b)
              Repeat Part (a) for a new transfer function
              X
              (
              s
              ) =
              T
              (
              s
              )/s.
            

(c)
              Plot the frequency response of each transfer function and explain the key differences.
            









            Objective 13-3 RMS Value and Average Power (
            Sect. 13-5
            )
          


(a)
              Given a periodic waveform, find the rms value of the waveform and the average power delivered to a specified load.
            

(b)
              Given the Fourier series of a periodic waveform, find the fraction of the average power carried by specified components and estimate the average power delivered to a specified load.
            


            See
            Examples 13-9
            to
            13-12
            and
            Exercises 13-8
            to
            13-10
            .
          





13-29
          The voltage across a 1-kΩ resistor is
          




(a)
              Find the rms value of the voltage and the average power delivered to the resistor.
            

(b)
              Find
              i
              (
              t
              )
              .






13-30
          The voltage across a 200-Ω resistor is given by the
          
            a
            n

          Fourier coefficients shown in volts in
          Figure P13-30
          . All
          b
n
          coefficients are zero, as is
          a
0
          . The fundamental frequency is 500π rad/s.
          

(a)
              Find expressions for the current through the resistor and the power dissipated by the resistor.
            

(b)
              Find the average of the power expression by integrating over one period of the waveform and dividing by the period.
            









FIGURE P13-30












13-31
          Find the rms value of a square wave. Find the fraction of the total average power carried by the first three nonzero ac components in the Fourier series.
        



13-32
          Find the rms value of a sawtooth wave. Find the fraction of the total average power carried by the first three nonzero ac components in the Fourier series. Compare with the results found in Problem 13-31.
        




13-33
          Find the rms value of a parabolic wave. Find the fraction of the total average power carried by the first three nonzero ac components in the Fourier series. Compare with the results found in Problem 13-31.
        



13-34
          Find the rms value of the periodic waveform in
          Figure P13-34
          and the average power the waveform delivers to a resistor. Find the dc component of the waveform and the average power carried by the dc component. What fraction of the total average power is carried by the dc component? What fraction is carried by the ac components?
          







FIGURE P13-34












13-35
          Repeat Problem 13-34 for the periodic waveform in
          Figure P13-35
          .
          







FIGURE P13-35












13-36
          A first-order low-pass filter has a cutoff frequency of 5 krad/s and a passband gain of 20 dB. The input to the filter is υ(t) = 10 + 20 cos 5000
          t
          + 12 cos 15 k
          t
          V. Find the rms value of the steady-state output.
        





13-37

          There is a need for a simple first-order anti-aliasing filter prior to digitizing the EKG signal shown in
          Figure P13-37
          .
          

(a)
              Determine the fundamental frequency of the EKG signal shown.
            

(b)
              To faithfully capture all of the signal characteristics, your filter must pass all harmonics up to the 200th harmonic. Design an appropriate filter.
            

(c)
              What is the minimum sampling rate needed to avoid aliasing?
            









FIGURE P13-37












13-38
          The input to the circuit in
          Figure P13-38
          is:
          




(a)
              Find the transfer function
              T
              (
              s
              )
              = V
O
              (
              s
              )/
              V
S
              (
              s
              ).
            

(b)
              Calculate the average power delivered to the 1-kΩ load resistor.
            

(c)
              Use Multisim to find the magnitude of the voltage across the load resistor for each of the two inputs. Then apply
              Eq. (13-24)
              to find
              V
              rms and
              Eq. (13-25)
              to find the average power delivered to the load.
            

(d)
              Do a transient analysis with both sources connected and have Multisim calculate the average power, "avg(P(R2)), " dissipated in the 1-kΩ load (R2). Be sure to let the circuit reach steady state before measuring the average power. Compare your answer with that found in Part (b).
            









FIGURE P13-38












13-39
          Find an expression for the average power delivered to a resistor
          R
          by a rectangular pulse voltage with amplitude
          V
A
          , period
          T
0
          , and pulse width
          T
          =
          T
0
          /4. How many components of the Fourier series are required to account for 98% of the average power carried by the waveform?
        



Integrating Problems



13-40

          Frequency Multiplier
          
            The only ac source available is a 1-V peak 200-kHz oscillator. You need a 600-kHz source. Your task is to convert your 200-kHz source so that it can supply a 600-kHz sinusoidal output. (
            Hint:
            Use a ±5-V comparator.) Use Multisim to prove your design.
          




13-41

          Spectrum of a Periodic Impulse Train
          A periodic impulse train can be written as




            Find the Fourier coefficients of
            x
            (
            t
            ). Plot the amplitude spectrum and comment on the frequencies contained in the impulse train.
          




13-42

          Power Supply Filter Design
          
            The input to a power supply filter is a full-wave rectified sine wave with
            f
0
            = 60 Hz. The filter is a first-order low pass with unity dc gain. Select the cutoff frequency of the filter so that the ac components in the filter output are all less than 1% of the dc component.
          




13-43

          Spectrum Analyzer Calibration
          A certain spectrum analyzer measures the average power delivered to a calibrated resistor by the individual harmonics of periodic waveforms. The calibration of the analyzer has been checked by applying a 1-MHz square wave and the following results reported:




            The reported power in dBm is
            P
            = 10 log(
            P
n
            ), where
            P
n
            is the average power delivered by the
            n
            th harmonic in mW. Is the spectrum analyzer correctly calibrated?
          




13-44

          Virtual Keyboard Design
          Electronic keyboards are designed using the following equation that assigns particular frequencies to each of the 88 keys in a standard piano keyboard:




            where
            n
            is the key number. There is a need for an amplifier that can pass Tenor C, key 52, but block keys 5 and 53. Design such a filter using an
            RLC
            -tuned circuit with a gain
            K
            of 100.
          





13-45

          Fourier Series Using Multisim
          

            Multisim has a useful Fourier analysis option. In this problem, you are to use this option to estimate the average power delivered to a 1
            -
            Ω resistor by the fundamental and the next two nonzero harmonics of a triangular wave. First construct two circuits, one using the triangular wave provided by Multisim. The wave should have ±1 V amplitude and a period of 1 ms, you will need to add an appropriate offset. Compute the Fourier coefficients for the triangular wave described. The second circuit is constructed using three ac sources, each at the appropriate Fourier frequency and amplitude connected in series. Note that Multisim uses sines rather than cosine so that a-90° phase shift must be added to each source. Each circuit should be connected to a series 1
            -
            Ω resistor. Run a transient response of the voltage across each resistor to ensure both signals fall atop each other. Next select the Multisim "Fourier" analysis option. Select the voltage across the resistor and run the option using only the triangular source. Grapher View displays the fundamental and the first 8 harmonics making up the triangular source both as a plot and as a table. Make note of the amplitudes of each nonzero component. Next, selecting the power delivered to the resistor output shows the total power the source delivers under the "DC component" entry on the table. Then repeat the problem using the three-source circuit. Selecting the voltage across the resistor shows the fundamental and the next two nonzero harmonics. Compare these values with the corresponding ones in the triangular wave. Selecting the power delivered to the resistor will show the amount of power delivered by the three components together. To determine the contribution by each component, start by connecting only the fundamental source. Measure the DC component from the table and determine what percentage of the total power (from the triangular source) it provides. Add the next nonzero harmonic and determine what percentage the two together provide. Finally, add the third source and repeat the problem. Comment on how much each additional harmonic contributes to the total power delivered by the triangular source.
          





Notes




1

            Named after Johann Peter Gustav Lejeune Dirichlet, a German mathematician who made contributions to the theory of Fourier series; he is also credited with developing the modern definition of a function.
          


2

            There is a 180° ambiguity in the value returned by the inverse tangent function in most computational tools. The ambiguity is resolved by the following rule:
            
              b
              n

            > 0 implies that the angle is in the range 0 to-180°, while
            
              b
              n

            < 0 implies the 0 to +180° range.
          


3

            This minimum sampling rate is called the
            Nyquist rate.
            The name honors Harry Nyquist, who along with Claude Shannon and others made several key breakthroughs in signal processing in the era from 1920 to 1950 while working at the Bell Telephone Laboratories.
          















CHAPTER 14

ACTIVE FILTER DESIGN




In its usual form the electric wave-filter transmits currents of all frequencies lying within one or more specified ranges, and excludes currents of all other frequencies.


            George A. Campbell, 1922,
            
            American Engineer
          









Some History Behind This Chapter
The electric filter was independently invented during World War I by George Campbell in the United States and by K. W. Wagner in Germany. Electric filters and vacuum tube amplifiers were key technologies that triggered the growth of telephone and radio communication systems in the 1920s and 1930s. The emergence of semiconductor electronics in the 1960s, especially the integrated circuit OP AMP, allowed the functions of filtering and amplification to be combined into what are now called active filters.









Why This Chapter Is Important Today
This is a fun chapter dedicated to the design of practical filters. After studying this chapter, you will be able to design a wide range of analog filters that find applications in instrumentation systems, audio systems, communication systems, and even digital systems. You will also learn how to evaluate different solutions to a filter design problem.









Chapter Sections



14-1 Active Filters






14-2 Second-Order Low-Pass and High-Pass Filters






14-3 Second-Order Bandpass and Bandstop Filters






14-4 Low-Pass Filter Design






14-5 Low-Pass Filter Evaluation






14-6 High-Pass Filter Design and Evaluation






14-7 Bandpass and Bandstop Filter Design












Chapter Learning Objectives

14-1
              Second-Order Filter Analysis (
              Sects. 14-1
              to
              14-3
              )
            

(a) Given a second-order filter circuit, find a specified transfer function.
(b) Given the transfer function of a second-order circuit, develop a method of selecting the element values to achieve specified filter characteristics.


14-2
              Second-Order Filter Design (
              Sects. 14-2
              and
              14-3
              )
            

(a) Construct a second-order transfer function with specified filter characteristics.
(b) Design a second-order circuit with specified filter characteristics.


14-3
              Low-Pass Filter Design (
              Sects. 14-4
              and
              14-5
              )
            
Given a low-pass filter specification:

(a) Construct a transfer function that meets the specification.
(b) Design a cascade of first- and second-order circuits that implements a given transfer function.
(c) Select the best design from competitive filter approaches based on specified frequency and step response criteria.


14-4
              High-Pass, Bandpass, and Bandstop Filter Design (
              Sects. 14-6
              and
              14-7
              )
            
Given a high-pass, bandpass, or bandstop filter specification:

(a) Construct a transfer function that meets the specification.
(b) Design a cascade or parallel connection of first- and second-order circuits that implements a given transfer function.
(c) Select the best design from competitive filter approaches based on specified frequency and step response criteria.







14-1 Active Filters

An electric filter is a signal processor that amplifies, attenuates, or otherwise reshapes the frequency content of input signals. There is a multitude of applications for filters. Engineers use filters in communication systems for noise suppression, to isolate a single communication band from many, to keep signals from one communication band from spilling over onto an adjacent band, and to recover modulated signals. In instrumentation systems, engineers use filters to select desired frequency components or eliminate undesired ones. In addition, instrumentation systems require filters to bandwidth-limit analog inputs prior to converting them in to digital signals. They also need filters to convert digital signals back in to analog representations. In audio systems, audio engineers use filters in crossover networks to send frequencies to different speakers or in recording and playback applications where fine control of frequency components is crucial to the music industry. Biomedical systems use filters to interface physiological sensors with data-logging and diagnostic equipment.

          Filters are classified as passive or active depending on the components used in their physical realization.
          Passive filter
          circuits contain only resistors, capacitors, and inductors. The
          RLC
          bandpass and bandstop circuits studied in
          Chapter 12
          are passive filters. These circuits can be highly selective when losses are low, and the response is highly resonant. However, they cannot supply passband gains greater than one and suffer from loading effects that can nullify the chain rule in a cascade design.
        

          In this chapter, we emphasize an
          active filter
          as a circuit that contains only resistors, capacitors, and OP AMPs. These filters offer several advantages:
        


            • They allow for the shape of the response to be tailored with steep roll-offs (high
            Q
            ) and frequency selectivity comparable to passive
            RLC
            circuits.
          


• They have OP AMP outputs, which means that the chain rule applies in a cascade design and can be designed with passband gains greater than one.


• They do not require inductors, which can be large, lossy, and expensive in low-frequency applications.


          Our study of active filter design will begin by building on our introductory knowledge from
          Chapter 12
          . We will introduce filter prototypes that easily can be designed and cascaded. We will look at the low-pass and high-pass Sallen-Key
          
1

          configurations and learn how to design each using two different approaches. We will also look at some
          RC
          stand-alone, active tuned and notch filter configurations that can rival the
          RLC
          filters studied in
          Chapter 12
          . After gaining confidence on designing first- and second-order filters, we will learn how to cascade them to achieve steep roll-offs using three common cascade algorithms for active, multi-pole filter design.
        

Active filter design
          involves devising circuits that realize a given transfer function
          T
          (
          s
          ). Our design strategy is based on the familiar cascade connection first introduced in
          Chapter 4
          and in more detail in
          Chapter 11
          as shown in
          Figure 14-1
          . Under the chain rule, the overall transfer function is
        








FIGURE 14-1



A cascade connection.








          The stages in the cascade are either first-order or second-order active filters. The real poles in
          T
          (
          s
          ) are produced using the first-order building block developed in
          Chapter 12
          . The complex poles are produced by second-order building blocks developed
          
          in the next two sections. The complex pole locations are specified by the customary second-order parameters—our old friends, the damping ratio ζ and undamped natural frequency ω
          0
          . Thus, we design an active filter by controlling the location of the poles introduced by each stage in a cascade connection.
        
In a second-order transfer function, the denominator controls the location of the poles and thus the critical frequencies. The numerator controls the zeros and thus determines if a transfer function is a low-pass, high-pass, band-pass, or band-reject filter. Hence, the following transfer functions summarize the different filter types. Low-pass filters have the following form



(14-1)




High-pass filters have the following form



(14-2)




Bandpass filters have the following form



(14-3)




Finally, bandstop filters have the following form



(14-4)





          It is also useful to recall from
          Chapter 12
          ,
          Eq. (12-18)
          , that the denominator of all of the different second-order filters can be written using different parameters as
        




          where ζ is the damping ratio,
          B
          the bandwidth, and
          Q
          the quality factor of the circuit. Different types of filter circuits are specified using different parameters. All filters specify critical frequencies and passband gains. In addition, high-pass and low-pass filters often specify damping ratios ζ, notch and tuned filters require certain
          B
          and
          Q
          , and wide bandpass filters often insist on a particular
          B
          . We will discuss these parameters in more detail as we cover each filter type.
        

          For future reference, note that replacing
          s
          /ω
          0
          by ω
          0
          /
          s
          converts the low-pass transfer function
          T
          (
          s
          ) in
          Eq. (14-1)
          into the high-pass transfer function
          T
          (
          s
          ) in
          Eq. (14-2)
          . We will make good use of this low-pass to high-pass transformation in a later section.
        



14-2 Second-Order Low-Pass and High-Pass Filters


          The second-order building blocks developed in this section are the counterparts of the first-order low-pass and high-pass filters in
          Chapter 12
          . These second-order circuits all have the following features: (1) an OP AMP output (to avoid loading), (2) two capacitors (to get two poles), and (3) at least one feedback path (to make the poles complex). We begin our development with the low-pass case.
        

Second-Order Low-Pass Filters


          From
          Eq. (14-1)
          , the transfer function of a second-order low-pass filter has the form
        





          The gain response is found by substituting
          j
          ω for
          s
          to obtain
        


(14-5)




          At low frequency (ω ≪ ω
          0
          ) the gain approaches |
          T
          (
          j
          ω
          )|→|
K
          | = |
          T
          (0)|. At high frequency (ω ≫ ω
          0
          ) the gain approaches |
          T
          (
          j
          ω)| → |
          K
          |(ω
          0
          /ω)
          2
          .
          Figure 14-2
          presents Bode plots of these gain asymptotes (solid lines) and the actual gain (dashed curves) for several values of ζ. We first saw these in
          Chapter 12
          - The key points to remember are the following:
        








FIGURE 14-2



Second-order low-pass gain responses.






            • The low- and high-frequency gain asymptotes intersect at ω = ω
            0
            .
          



            • For ω < ω
            0
            , the asymptotic gain equals the dc gain |
            T
            (0)| = |
            K
            |
            .




            • For ω > ω
            0
            , the slope of the asymptotic gain is -40 dB/decade.
          



            • The actual gain at ω = ω
            0
            is |
            T
            (
            j
            ω
            0
            )| = |
            K
            |/2ζ.
          


          From a design perspective, we say that ω
          0
          locates the corner frequency and ζ controls the gain in the vicinity of the corner.
        

          The circuit in
          Figure 14-3
          (a) is analyzed in
          Chapter 11
          (
          Example 11-6
          ), where its voltage transfer function is shown to be
        



(14-6)




This is a second-order low-pass function with a dc gain of |T(0)| = µ.








FIGURE 14-3



Second-order low-pass circuits.





          An OP AMP
          RC
          filter is obtained by replacing the dependent source in
          Figure 14-3
          (a) by the OP AMP circuit in
          Figure 14-3
          (b). The gain of this noninverting amplifier gain is 1 +
          R
A
          /
          R
B
          . Thus, modification simulates the dependent source when 1 +
          R
A
          /
          R
B
          = µ or, equivalently,
          R
A
          = (µ-1)
          R
B
          . The modified circuit is our first second-order building block. Note that it has an OP AMP output, two capacitors, and a feedback path.
        

          Our objective is to find methods of determining the gain µ and the four element values that produce specified values of ω
          0
          and ζ. Comparing the denominators in
          Eqs. (14-1)
          and
          (14-6)
          gives
        




          Using the first equation to eliminate ω
          0
          from the second equation leads to
        



(14-7)





          Two methods of selecting element values to meet these design goals are the
          
equal element

          and the
          
unity gain.




          The
          
equal element method

          requires that
          R
1
          =
          R
2
          =
          R
          and
          C
1
          =
          C
2
          =
          C
          . Inserting these conditions into
          Eq. (14-7)
          leads to
        



(14-8)





          Using this method, we select values of
          R
          (or
          C
          ) and
          R
B
          , then solve for
          C
          (or
          R
          ) and
          R
A
          = (µ-1)
          R
B
          . The dc gain achieved by this method is |
          T
          (0)| = µ = 3-2ζ, and the method is valid for ζ < 1.5.
        

          The
          
unity gain method

          requires that
          R
1
          =
          R
2
          =
          R
          and µ = 1. Inserting these conditions in
          Eq. (14-7)
          leads to
        



(14-9)





          Using this method, we select a value of
          C
1
          and calculate
          C
2 
          = ζ 
          2
C
1   
          and  
          R   
          =   
          
          . To get a gain µ = 1, we make the noninverting OP AMP circuit a voltage follower. That is, we replace
          R
A 
          by a short circuit and 
          R
B   
          by an open circuit. This eliminates the need for 
          R
A  
          and   
          R
B    
          but requires two different capacitors. Obviously, the dc gain achieved by this design method is |
          T  
          (0)| = µ = 1. The unity gain method does not place any restrictions on the value of the damping coefficient, ζ.
        
   
          The equal element and unity gain methods provide alternative ways to design an active low-pass filter with prescribed values of ω
          0 
          and ζ.    
          

Note,

  
          that the dc gains produced by these methods are predetermined and are not adjustable design parameters. An additional gain correction stage may be needed when ω
          0   
          , ζ, and the dc gain are all three prescribed. 
        














                  DESIGN AND EVALUATION EXAMPLE 14-1
                

                  Develop a second-order low-pass transfer function with a corner frequency at ω
                  0
                  = 1 krad/s and with corner frequency gain equal to the dc gain. Use MATLAB to help visualize the Bode plots of the desired transfer function. Then design two competing circuits using the equal element and unity gain design techniques. Use Multisim to simulate the frequency responses of the designed circuits. Compare the results and comment on any differences.
                




SOLUTION:


The required transfer function has the form




              The requirement that the corner frequency gain equal the dc gain results in |
              T
              (
              j
              1000)| =
              K
              /2ζ. These two gains are equal when ζ = 0.5.
            


Equal element design:

              Inserting ω
              0
              = 1 krad/s and ζ = 0.5 into
              Eq. (14-8)
              yields
              RC
              = 10
              -3
              s and µ = 2. The resulting transfer function then is
            




              Selecting
              R
              =
              R
B
              = 10 kΩ requires
              C
              = 0.1 µF and
              R
A
              = (
              µ-
              1)
              R
B
              = 10 kΩ. The resulting circuit is shown in
              Figure 14-4
              (a) and has a dc gain of |
              T
              (0)| = µ = 2.
            


Unity gain design:

              Inserting ω
              0
              = 1 krad/s and ζ = 0.5 into
              Eq. (14-9)
              yields the following transfer function:
            











FIGURE 14-4








              With the recognition that
              
              and
              C
2
              = ζ
              2
C
1
              =0.25
              C
1
              , selecting
              C
1
              =01 µF dictates that
              C
2
              = 0.025 µF and
              R
              = 20 kΩ. The dc gain in this circuit is always 1 (note the follower), and is why it is called the
              
                "
                unity gain
                "
              
              design.
              Figure 14-4
              (b) shows the resulting circuit.
            


              We can visualize our transfer function designs by using the bodemag function of MATLAB. The code shown in
              Figure 14-5
              (a) will generate the Bode magnitude plots:
            

              MATLAB returns the graphs shown in
              Figure 14-5
              (a), plotted in dB versus Hz.
            

              The circuits were built in Multisim and simulated using AC analysis. Grapher View returned the results shown in
              Figure 14-5
              (b), which are also plotted in dB versus Hz. The designs accurately implement the transfer functions.
            
Comparing the two circuit designs shows that the equal element design has a greater gain and uses equal-value components, but requires two extra resistors. The unity gain design is simpler but requires two different capacitors. The preferred design depends on the application and other nonstated requirements.








FIGURE 14-5








■
















                  Design
                  Exercise 14-1



Develop a second-order low-pass transfer function with a corner frequency of 50 rad/sor 7.96 Hz, a dc gain of 2, and a gain of 4 at the corner frequency. Validate your result by using MATLAB to plot the transfer function's absolute gain versus frequency.


Answers:


The desired transfer function is




Figure 14-6
              shows the MATLAB results.
            








FIGURE 14-6


















              Design
              Exercise 14-2


              Design circuits using both the equal element design and unity gain design techniques to realize the transfer function in
              Exercise 14-1
              . Use Multisim to simulate your designs and compare them to the MATLAB results shown in
              Figure 14-6
              .
            


Answers:



              The two designs are shown in
              Figure 14-7
              along with the Grapher View output. Note that both designs required adjustments to their gains to get an overall gain of 2. The filter from the equal element design required a dc gain of 2.5 to achieve the necessary damping ratio. To get the overall circuit gain of 2, a voltage divider was connected to the
              
              output of the filter. In the unity gain design, a second amplifier stage was required to boost the overall gain to 2. Either design provides the desired output, but the equal element design uses only one OP AMP and requires less power.
            








FIGURE 14-7










Second-Order High-Pass Filters


          The transfer function of a second-order high-pass filter from
          Eq. (14-2)
          has the form
        




          This transfer function has two poles and a double zero at
          s
          = 0. Substituting
          j
          ω for
          s
          yields the gain response as
        


(14-10)




          At high frequency (ω ≫ ω
          0
          ) the gain approaches |
          T
          (
          j
          ω)| → |
          K
          | = |
          T
          (∞)|. At low frequency (ω ≪ ω
          0
          ) the gain approaches |
          T
          (
          j
          ω)| →
          K
          |(ω/ω
          0
          )
          2
          .
          Figure 14-8
          presents Bode plots of these gain asymptotes (solid lines) and the actual gain (dashed curves) for several values of ζ. The key points to remember are the following:
        








FIGURE 14-8



Second-order high-pass gain responses.






            • The high- and low-frequency gain asymptotes intersect at ω = ω
            0




            • For ω > ω
            0
            , the asymptotic gain equals the infinite frequency gain |
            T
            (∞)| = |
            K
            |.
          



            • For ω < ω
            0
            , the slope of the asymptotic gain is + 40 dB/decade.
          



            • The actual gain at ω = ω
            0
            is |
            T
            (
            j
            ω
            0
            )| = |
            K
            |/2ζ.
          


          As in the low-pass case, the design parameter ω
          0
          locates the corner frequency and ζ controls the actual gain around the corner frequency.
        

          The circuit in
          Figure 14-9
          (a) has a transfer function of the form
        



(14-11)





          This is a second-order high-pass function with an infinite-frequency gain of |
          T
          (∞)| = µ. The high-pass circuit in
          Figure 14-9
          (a) is obtained from the low-pass
          
          circuit in
          Figure 14-3
          (a) by interchanging the locations of the resistors and capacitors. In Problem 14-2, the student will discover how this interchange converts the low-pass
          T
          (
          s
          ) in
          Eq. (14-6)
          into the high-pass
          T
          (
          s
          ) in
          Eq. (14-11)
          .
        








FIGURE 14-9



Second-order high-pass circuits.





          As in the low-pass case, we replace the dependent source in
          Figure 14-9
          (a) by the noninverting OP AMP circuit in
          Figure 14-9
          (b). The OP AMP circuit simulates the dependent source when 1 +
          R
A
          /
          R
B
          = µ or, equivalently,
          R
A
          = (µ-1)
          R
B
          . The modified high-pass circuit is a second-order building block with an OP AMP output, two capacitors, and a feedback path.
        

          Again our goal is to find methods of determining the gain μ and the four element values that produce specified values of ω
          0
          and ζ. Comparing the denominators in
          Eqs. (14-2)
          and
          (14-11)
          gives
        




          Using the first equation to eliminate ω
          0
          from the second equation leads to
        



(14-12)





          To select the element values in
          Eq. (4-2)
          , we use methods similar to those used to design our low-pass building block.
        

          The
          
equal element method

          requires that
          R
1
          =
          R
2
          =
          R
          and
          C
1
          =
          C
2
          =
          C
          . Inserting these conditions in
          Eq. (14-12)
          leads to
        



(14-13)





          Under this method, we select values of
          R
          (or
          C
          ) and
          R
B
          and solve for
          C
          (or
          R
          ) and
          R
A
          = (µ-1)
          R
B
          . The infinite-frequency gain achieved by this method is |
          T
          (∞)| = µ = 3-2ζ, and the method is valid for ζ<1.5.
        

          The
          
unity gain method

          requires that
          C
1
          =
          C
2
          =
          C
          and µ = 1. Inserting these conditions in
          Eq. (14-12)
          gives
        



(14-14)





          Using this method, we select a value of
          R
2
          and calculate
          R
1
          = ζ
          2
R
2
          and
          
          . To get a gain µ = 1, we make the noninverting OP AMP circuit into a voltage follower. That is, we replace
          
            R
            A

          by a short circuit and
          
            R
            B

          by an open circuit, thereby eliminating the need for these two resistors. Obviously, the infinite-frequency gain achieved by this method is |
          T
          (∞)| = µ = 1. As with the low-pass filter, the unity gain method does not place any restrictions on the value of the damping coefficient, ζ.
        

          The equal element and unity gain methods are alternative ways to design an active high-pass filter with prescribed values of ω
          o
          and ζ. As we found in the low-pass case, the passband gains produced by these methods are predetermined and are not adjustable design parameters. An additional gain correction stage may be needed when ω
          o
          , ζ, and the infinite-frequency gain are all three prescribed.
        













                  DESIGN EXAMPLE 14-2
                

                  Develop a second-order high-pass transfer function with a corner frequency at ω
                  0
                  =20 krad/s, an infinite-frequency gain of 0 dB, and a corner frequency gain of-3 dB. Use MATLAB to help visualize the Bode magnitude plot of the desired transfer function. Then design two competing circuits using the equal element and unity gain design techniques. Use Multisim to simulate the frequency responses of the designed circuits. Compare the results and comment on the differences.
                





SOLUTION:


The required transfer function has the form




              The infinite-frequency gain is T(∞) =
              K
              and the corner frequency gain is |
              T
              (
              j
              20,000)| =
              K
              /2ζ. A gain of 0 dB at infinite frequency requires
              K
              = 1. A gain of-3 dB at the corner frequency requires
              
              , which in turn requires that
              
              . Therefore, the desired transfer function is
            



We can visualize our transfer function design by using the bodemag function of MATLAB as follows:

T=tf([1 0 0],[1282804 0 0e6]);


w = logspace(3,5,10000);


bodemag(T,w);


grid


Figure 14-10
              shows the resulting plot. We changed the frequency axis to hertz to better compare our design results.
            








FIGURE 14-10









Equal element design:

              Inserting ω
              0
              =20 krad/s and ζ = 0707 into
              Eq. (14-13)
              yields
              RC
              = 5 × 10
              -5
              s and µ = 3-
              
              = 1.586. Selecting
              C
              = 0.005 µF and
              R
B
              =50 kΩ requires
              R
              = 10 kΩ and
              R
A
              = (µ - 1)
              R
B
              =29.3 kΩ. The high-frequency gain of this design is |
              T
              (∞)| = µ =1.586, which is more than the specified value of 1 (0 dB). We add a gain correction stage with a gain of 1/1.586 = 0.6305 to bring the overall gain down to 0 dB.
              Figure 14-11
              (a) shows the resulting two-stage design.
            


Unity gain design:

              Inserting ω
              0
              = 20 krad/s and ζ = 0707 into
              Eq. (14-14)
              yields
              
              and
              R
1
              = ζ
              2
R
2
              =0.5
              R
2
              . Selecting
              R
2
              = 10 kΩ requires that
              R
1
              = 5 kΩ and
              C
              = 7071 pF. The |
              T
              (∞)| gain of this circuit is 1, which matches the desired 0 dB. The resulting single-stage design is shown in
              Figure 14-11
              (b).
            








FIGURE 14-11









              The circuits were created in Multisim and simulated using AC sweep. Their Grapher View results are shown in
              Figure 14-11
              (c). Clearly, both circuit designs implement the transfer function extremely well and meet all three design specifications.
            








FIGURE 14-11








              Comparing the two circuit designs shows that the
              
equal element design

              requires an extra OP AMP used as a buffer and four more resistors than the
              
unity gain design

              because its gain is greater than 1. The voltage divider could be placed after the filter thereby eliminating the need for the buffer, but raising a concern about loading at the output. Regardless, the unity gain design appears to be the better choice in this case.
              ■













              Design
              Exercise 14-3

Construct a second-order high-pass transfer function with a corner frequency of 20 rad/s, an infinite-frequency gain of 4, and a gain of 2 at the corner frequency. View your results on a MATLAB bodemag plot.








FIGURE 14-12









Answers:




              See
              Figure 14-12
              .
            




          The design requirements for the Sallen-Key second-order filters studied are summarized in
          Table 14-1
          and is repeated in
          Appendix G
          , G-6:
        







Table

                    14-1
                  










Equal Element




Unity Gain








R
1
                  =
                  R
2
                  =
                  R


R
1
                  =
                  R
2
                  =
                  R




Low Pass


C
1
= C
2
= C

µ = 1




                  ω
                  0
                  =
                  1
                  /
                  
RC








µ = 3- 2ζ







R
1
                  =
                  R
2
                  =
                  R


C
1
                  =
                  C
2
                  =
                  C





C
1
                  =
                  C
2
                  =
                  C

µ=1



High Pass


                  ω
                  0
                  =
                  1
                  /
                  
RC








µ = 3-2ζ










14-3 Second-Order Bandpass and Bandstop Filters


          The active
          RC
          filters in this section are the counterparts of the passive
          RLC
          circuits studied in
          Chapter 12
          . These active filters achieve the frequency selectivity of the passive
          RLC
          circuits without the need for inductors. We continue our development of active filter building blocks with the bandpass case.
        

Second-Order Bandpass Filters


          The transfer function of a second-order bandpass filter from
          Eq. (14-3)
          has the form
        





          This transfer function has two poles and a zero at
          s
          = 0. The gain response is found in the usual way as
        



(14-15)





          At low frequency (ω ≪ ω
          0
          ) the gain approaches |
          T
          (
          j
          ω)|→|
          K
          |(ω/ω
          0
          ). At high frequency (ω ≫ ω
          0
          ), the gain approaches |
          T
          (
          j
          ω)| → |
          K
          (ω
          0
          /ω).
          Figure 14-13
          presents Bode plots of these gain asymptotes (solid lines) and the actual gain (dashed curves) for several values of ζ. The key points to remember are the following:
        








FIGURE 14-13



Second-order bandpass gain responses.






            • The low- and high-frequency gain asymptotes intersect at ω = ω
            0
            .
          



            • For ω < ω
            0
            , the slope of the asymptotic gain is + 20 dB/decade.
          



            • For ω > ω
            0
            , the slope of the asymptotic gain is -20 dB/decade.
          



            • The actual gain at ω = ω
            0
            is |
            T
            (
            j
            ω
            0
            )| = |
            K
            |/2ζ.
          


          Note again that the design parameter ω
          0
          locates the center frequency and ζ controls the actual gain near the center frequency.
        

          The circuit in
          Figure 14-14
          has a transfer function of the form
        



(14-16)





          This circuit produces a second-order bandpass function. It has an OP AMP output, two capacitors, and two feedback paths—one via resistor
          R
2
          and the other through the capacitor
          C
2
          . The dual feedback identifies this circuit as a member of the multiple-feedback family of active filters.
          
2










FIGURE 14-14



Second-order bandpass circuit.





          Derivation of
          Eq. (14-16)
          using node analysis is easy, as the student can readily verify.
        

          Our design goal is to select element values to achieve specified values of ω
          0
          and ζ. Comparing the denominators in
          Eqs. (14-3)
          and
          (14-16)
          gives
        




          Using the first equation to eliminate ω
          0
          from the second equation produces
        



(14-17)





          In this case, there are two design constraints and four unknown element values. An
          
equal-capacitor method

          (
          C
1
          =
          C
2
          =
          C
          ) can be used to reduce the number of unknowns. Inserting
          C
1
          =
          C
2
          =
          C
          into
          Eq. (14-17)
          yields
        



(14-18)





          Under this method, we select a value of
          R
2
          and solve for
          R
1
          = ζ
          2
R
2
          and
          C
          =
          
          . Since this method uses
          C
1
          =
          C
2
          , the center frequency gain found from
          Eq. (14-16)
          is |
          T
          (
          j
          ω
          0
          )|=
          R
2
          /2
          R
1
          =1/2ζ
          2
          . Note that the center frequency gain is
          
          greater than 1 when
          
          . For example, when ζ = 01, the gain is 50. This contrasts with the passive
          RLC
          bandpass circuit, whose center frequency gain is always 1.
        

          The key descriptive parameters of a second-order bandpass filter are its
          center frequency
          ω
          0
          and
          bandwidth
B
          = 2ζω
          0
          . It is customary to add a third parameter called the
          quality factor,
          defined as
          Q
          = ω
          0
          /
          B
          . From this definition, it is clear that
          Q
          and ζ are both dimensionless parameters related as
          Q
          = 1/2ζ. Either parameter can be used to characterize filter bandwidth. When
          Q
          >1 (ζ < 0.5), the filter is said to be
          narrow-band
          because the bandwidth is less than the center frequency. When
          Q
          < 1 (ζ >0.5), the filter is said to be
          wide-band.
          The active bandpass building block developed here is best suited to narrow-band applications. Filters with a high
          Q
          are also referred to as
          tuned
          filters. The design of wide-band active bandpass filters is discussed in
          Sect. 14-7
          .
        













DESIGN EXAMPLE 14-3


                  Use the active
                  RC
                  circuit in
                  Figure 14-14
                  to design a bandpass filter with a center frequency at 10 kHz and a bandwidth of 4 kHz. Find the center frequency gain for the design. Use MATLAB to show the filter's gain characteristics.
                




SOLUTION:


The specified filter parameters define the center frequency and bandwidth as




              The required damping ratio is ζ =
              B
              /2ω
              0
              =0.2. Inserting the values of ω
              0
              and ζ into
              Eq. (14-18)
              yields
              R
1
              =0.04
              R
2
              and
              
              Selecting
              R
2
              = 100 kΩ requires
              R
1
              =4 kΩ and
              C
              = 796 pF. The center frequency gain for this design is |
              T
              (
              j
              ω
              0
              )| =1/2ζ
              2
              = 12.5. The transfer function for the design is
            



The required MATLAB code is

T=tf([-314e3 0],[125.1e3 3.9456e9]);


w = logspace(4,6,10000);


bodemag(T,w);grid


              The Bode magnitude plot is shown in
              Figure 14-15
              (a).
            








FIGURE 14-15








■













              Design
              Exercise 14-4


              Rework the design in
              Example 14-3
              , starting with
              C
              = 2000 pF.
            


Answers:



R
1
              =1.59 kΩ;
              R
2
              = 39.8 kΩ
            










              Design
              Exercise 14-5

Construct a second-order bandpass transfer function with a center frequency of 50 rad/s, a bandwidth of 10 rad/s, and a center frequency gain of 4. Validate your design using MATLAB.


Answers:




              . See
              Figure 14-15
              (b).
            








FIGURE 14-15










Second-Order Bandstop Filters


          The transfer function of a second-order bandstop filter from
          Eq. (14-4)
          has the form
        




          This transfer function has two zeros at
          s
          = ±
          j
          ω
          0
          along with the two poles defined by ζ and ω
          0
          . The resulting gain response is
        



(14-19)






          At low frequency (ω ≪ ω
          0
          ) and high frequency (ω ≫ ω
          0
          ), the gain approaches |
          T
          (0) = |
          T
          (∞)|→
          K
          |. At ω = ω
          0
          , the gain is
          T
          (
          j
          ω
          0
          )|=0.
          Figure 14-16
          shows the gain predicted by
          Eq. (14-19)
          for some representative values of ζ. Key points to remember are the following:
        








FIGURE 14-16



Second-order bandstop gain responses.






            • The low- and high-frequency gains are |
            T
            (0)| = |
            T
            (∞)| = |
            K
            |.
          



            • At ω = ω
            0
            there is a zero-gain notch in the gain response.
          


          Second-order bandstop filters that have very narrow bandwidths are often referred to as
          notch
          filters. It is customary to describe their characteristics in terms of the
          notch frequency
          ω
          0
          and the
          notch bandwidth
B
          = 2ζω
          0
          . The notch is caused by the
          j
          -axis zeros in
          T
          (
          s
          ). From a design perspective, we say that the zeros at
          s
          = ±
          j
          ω
          0
          locate the notch and ζ controls the width of the notch.
        

          The bandstop circuit in
          Figure 14-17
          is best suited for narrow-band applications aimed at eliminating a narrow range of frequencies or even a single frequency. In this section, we discuss narrow-band bandstop filters.
          Section 14-7
          addresses the design of wide-band bandstop filters.
        








FIGURE 14-17



Second-order bandstop circuit.





          The circuit in
          Figure 14-17
          is a modification of the bandpass circuit in
          Figure 14-14
          . The modified circuit retains the two feedback paths and adds a second input path via the voltage divider
          R
A
          and
          R
B
          . The two input and feedback paths combine to produce an overall circuit transfer function of
        



(14-20)




Derivation of this transfer function involves straightforward (if laborious) node analysis and is left for the enjoyment of the student in Problem 14-3.

          The denominator in
          Eq. (14-20)
          is the same as the denominator of the bandpass filter in
          Eq. (14-15)
          . Hence, the design constraints in
          Eq. (14-16)
          apply here as well, namely
        



(14-21)





          These constraints control the locations of the bandstop filter poles. Comparing the numerators in
          Eqs. (14-4)
          and
          (14-20)
          gives
        



(14-22)





          This constraint ensures that the circuit has the requisite
          j
          -axis zeros to produce the bandstop notch. Taken together,
          Eqs. (14-21)
          and
          (14-22)
          give us three design constraints and six unknown element values.
        

          The
          
equal-capacitor method

          (
          C
1
          =
          C
2
          =
          C
          ) reduces the number of unknowns in the design constraints. When
          C
1
          =
          C
2
          =
          C
          , the pole location constraints in
          Eq. (14-21)
          reduce to
        



(14-23)






          Using this design method, we select a value of
          R
2
          and solve for
          R
1
          = ζ
          2
R
2
          and
          
          . When
          C
1
          =
          C
2
          =
          C
          , the bandstop notch requirement in
          Eq. (4-22)
          reduces to
        



(14-24)





          An obvious way to meet this requirement is to let
          R
A
          = 2
          R
1
          and
          R
B
          =
          R
2
          .
        
Narrow-band notch circuits are often used to eliminate power line noise at 60 Hz (50 Hz in many countries). The next example illustrates such an application.













DESIGN EXAMPLE 14-4


                  Use the active
                  RC
                  circuit in
                  Figure 14-17
                  to design a bandstop filter with a notch frequency at 60 Hz and a notch bandwidth of 12 Hz. Find the circuit's transfer function and use MATLAB to plot the filter's gain characteristic and to estimate the attenuation of the notch. Then, use Multisim to simulate the circuit and compare the results.
                




SOLUTION:


The specified filter parameters define the notch frequency and bandwidth as




              The required damping ratio is ζ =
              B
              /2ω
              0
              = 01. Using equal capacitors (
              C
1
              =
              C
2
              =
              C
              ) and selecting
              R
2
              = 100 kΩ, we use
              Eqs. (14-23)
              and
              (14-24)
              to calculate the remaining values as follows:
            



The transfer function for the design is



The required MATLAB code is

              T = tf([0.98 0 0.98*142.4e3],[1 75.47 142.4e3]);
              w =logspace(2,3,10000);
              bodemag(T,w);grid
            

Figure 14-18
              (a) shows the Bode magnitude plot from MATLAB. The center frequency is at 60.1 Hz, and the bandwidth is approximately 12.6 Hz. An estimate of the notch attenuation is-84.4 dB.
              Figure 14-18
              (b) shows the Grapher View results of the Multisim simulation. The center frequency is 60.1 Hz, and the bandwidth is 12.6 Hz. These values match the MATLAB results. The Multisim notch depth is estimated to be-81.4 dB. Note that the simulated attenuation at the center frequency will depend on the number of calculations selected for the frequency variable. That is, since the calculations are evenly spaced across the frequency variable, one needs to be very lucky to have a calculation fall right on the minimum; otherwise, the software will not return the true minimum. One way to increase the accuracy of finding the minimum is to ask MATLAB or Multisim to make a lot of calculations. With more calculations, a more accurate notch depth (or peak in a tuned response) will be found. We used 10,000 points over 1 decade.
            








FIGURE 14-18








■













              Design
              Exercise 14-6


              Rework the circuit design in
              Example 14-4
              starting with
              C
1
              =
              C
2
              =
              C
              = 0.2 µF.
            


Answers:



R
1
              =1.33 kΩ;
              R
2
              = 133 kΩ;
              R
A
              = 2.66 kΩ;
              R
B
              = 133 kΩ
            










              Design
              
                Exercise 14-7
                


Construct a second-order bandstop transfer function with a notch frequency of 50 rad/s, a notch bandwidth of 10 rad/s, and passband gains of 5. Validate your design using MATLAB.


Answer:




              See
              Figure 14-18
              (c).
            








FIGURE 14-18










          The tuned and notch filters in
          Figures 14-14
          and
          14-17
          are efficient circuits that are easy to design and simulate. However, prototyping the notch filter in the laboratory requires components with very small tolerances since the zeros in the transfer function must be accurately located to produce the notch.
        

          Let us analyze another pair of realizations for tuned and notch filters. Consider the circuit in
          Figure 14-19
          .
        








FIGURE 14-19







This circuit consists of a tuned circuit inside a notch circuit. We have labeled three nodes to help us write node equations.





          We note that
          V
B
          (
          s
          ) = 0 by the OP AMP
          i-
          υ relationship. Using the Node B equation, we find
        



Substituting this back into the Node A equation yields


(14-25)



This, then, is the basic equation for designing a tuned filter. Note that the filter's gain is not a controllable parameter; rather, it is a result of selecting a particular damping coefficient and resonant frequency. If one needs a particular gain, it needs to be adjusted with either a cascading gain stage or a voltage divider.

          The notch filter takes the output of the tuned filter and adds the input in such a way as to create the bandstop characteristic in
          Eq. (14-4)
          . The output of the overall circuit
          V
2
          (s) is found as
        



With some effort, we find that this reduces to




          By making the coefficient of the
          s
          term zero, we force the poles to lie on the
          j
          ω axis creating the notch. Setting those terms to zero and solving for α yields
        




          This relationship is a gain condition applied to resistors that enables the inverting summer to eliminate the
          s
          -term in the numerator and turn the tuned filter into a notch
          
          filter. Note that the overall gain
          K
2
          is controllable for the notch filter case. The transfer function for the notch filter is
        


(14-26)

















DESIGN AND EVALUATION EXAMPLE 14-5


                  Use the active
                  RC
                  circuit in
                  Figure 14-19
                  to design a bandstop filter with a notch frequency at 60 Hz and a notch bandwidth of 12 Hz. Find the circuit's transfer function and use Multisim to plot the filter's gain characteristic and to estimate the attenuation of the notch. Compare your results with that of
                  Example 14-4
                  .
                




SOLUTION:


The specified filter parameters define the notch frequency and bandwidth as




              Equating the
              s
              -term and the last term in the denominator to these parameters yields
            




              Solving for
              RC
              in the first equation and substituting it into the second equation allows for
              K
1
              to be found.
            




              We can now find
              R
              and
              C
              by substituting back into one of the equations
            




              Selecting
              C
              = 1 µF, results in
              R
              = 177 Ω
            

              We have just designed the tuned filter. However, our task is to design a notch filter and compare it with the notch filter designed in
              Example 14-4
              . We, therefore, need to find the parameter α that will eliminate the
              s
              -term in the numerator.
            




              One last thing before we design the circuit. Unlike the circuit designed in
              Example 14-4
              , we can control the gain of the notch filter. In order to compare it, we need to make the gain of this filter
              K
2
              equal to the gain of the filter in
              Example 14-4
              . The pass-band gain of that circuit simulates to 0.98. The Multisim circuits used in this comparison are shown in
              Figure 14-20
              .
            

              We asked Multisim to perform an AC sweep from 59.90 to 60.10 Hz using 100,000 calculations over one decade for accuracy in our comparison. Grapher View returned the results shown in
              Figure 14-20
              (a). The filter in
              Example 14-4
              had a considerably deeper and narrower notch at-147.5 dB at a frequency of 59.991 Hz than
              Example 14-5
              that had a rounded notch at-51.83 dB at 59.999 Hz. The simulation
              
              data appears to favor the simpler circuit; namely, it has fewer parts and a narrower and a deeper notch. One clear advantage of the filter in
              Example 14-5
              is the ability to provide gain and a closer notch to 60 Hz. This filter is also easier to prototype in the laboratory. A second stage could be added to the circuit in
              Example 14-4
              to provide gain, but this would mitigate the parts-count advantage. However, simulations are only one, albeit significant, comparison. A laboratory comparison would help one decide which circuit is easier and more stable to build and test.
            








FIGURE 14-20








              One last item. If we look at the output of the tuned filter and that of the notch filter shown in
              Figure 14-20
              (b), one can observe that both occur at 60 Hz, as expected, but the notch is very deep at-51.8 dB, while the tuned filter is shallower and only 37.4 dB. But both share the same bandwidth of 12 Hz because that is set by the middle term of the denominator, namely
              









FIGURE 14-20








■












              Design
              Exercise 14-8


              Design a notch filter using the realization in
              Figure 14-19
              to achieve a notch at 200 krad/s, a
              B
              of 20 krad/s, and a passband gain of 10.
            



Answers:



K
1
              =899,
              K
2
              = 10,
              C
              = 1000 pF,
              R
              = 167 Ω,
              K
1
R
              = 149.8 kΩ, α = 299.7,
              R
X
              = 299.7 kΩ,
              
                R
                X

              /
              α
              = 1 kΩ,
              K
2

                R
                X

              /
              α
              = 10 kΩ. These values simulate to an ω
              
0

              of 200.7 krad/s, a notch of-34.1 dB, and a passband gain of + 20 dB or 10. Other design options are possible.
            





14-4 Low-Pass Filter Design


          Having developed a number of filter-building blocks in
          Chapter 12
          and thus far in this chapter, we can now undertake the study of cascaded filter design. There are many different types of active filters.
          
3

          Among the most useful are the First-Order Cascade, Butterworth, Chebyshev types 1 and 2, Elliptical or Cauer, Biquad, and Bessel.
          Figure 14-21
          shows the basic gain characteristics of five of these filters. These can be designed to provide low-pass, high-pass, band pass, bandstop, or all-pass
          
          responses. Most filters are designed with their magnitude (gain) response being paramount. However, there are applications where the phase response might be essential as in phased arrays used in communications. The all-pass filter is one in which the magnitude of the signal is not affected but its phase is. Also, while we will concentrate on the filter's frequency-response characteristics, there are applications where the filter's time-domain characteristics are equally or even more important to the design, such as in instrumentation or audio systems. For these applications, First-Order Cascade and Bessel filters are often used.
        








FIGURE 14-21







The purpose of this section is to look at three of the most common cascaded filter types (First-Order Cascade, Butterworth, and Chebyshev type 1) and to provide a design methodology for determining the best low-pass filter to use based on its magnitude (gain) characteristics.

          The First-Order Cascade filter is very simple in its design but requires a very high order filter to achieve significant selectivity. It does have excellent transient response characteristics making it useful in applications that do not require high selectivity. Butterworth filters, named after British engineer Stephen Butterworth, are also called "maximally flat" filters because they have an excellent passband response. They have much better selectivity than First-Order Cascade filters and a moderate transient response. Chebyshev filters, named after Russian mathematician Pafnuty Chebyshev, are also called "equiripple" filters because they trade-off a steep selectivity with adding a ripple in either the pass-band, type 1, or in the stop-band, type 2. They have a very complex transient response and phase response. Elliptic or Cauer filters, named after German network theorist Wilhelm Cauer, offer the steepest rolloff but at the expense of equiripples in both the pass- and stop-bands. A Bessel filter has a maximally flat frequency-response closer to the First-Order Cascade than Butterworth but has a transient response without an overshoot. Its phase characteristics makes it very useful for audio applications allowing for no phase distortion. The Biquad filter, also called the Tow-Thomas filter, has the advantage of being able to adjust ω
          0
          ,
          Q
          , and
          K
          , by simply adjusting three separate resistors in the circuit. Its response is shown and discussed in Application
          Example 14-15
          .
        
In general, if a steep cutoff response is required, then a high-order filter is needed. A higher order filter requires a more complex and costly circuit. High-order filters also have the most complex transient and phase responses. As a relative example, a particular design specification that might require a fifth-order Elliptic filter would require a 10th-order Chebyshev or a 35th-order Butterworth. It would not even be possible with a First-Order Cascade regardless of the order. In this chapter, we will focus on the design of the first three types, namely First-Order Cascade, Butterworth, and Chebyshev type 1. You should gain sufficient understanding of cascaded active filter design to apply it to any filter type.

          In this section, we learn how to design multi-pole filters with prescribed low-pass characteristics. The Bode plot in
          Figure 14-22
          shows how low-pass filter characteristics are specified. To satisfy the specification, the filter must be designed so that its gain response lies within the transition region. There are many different gain responses that meet this requirement, as illustrated by the two shown in the figure. All such gain responses are constrained by the conditions imposed in three adjacent frequency bands. As an example, the filter whose response is labeled "Filter fails specs" fails to meet all of the specifications while the other one with the labeled "Filter passes specs" meets all of the specifications.
        

          In the
          passband
          (0 ≤ ω ≤ ω
          C
          ), the gain response must be in the range
        




          In the
          stopband
          (ω
          MIN
          ≤ ω) the gain response must be in the range |
          T
          (
          j
          ω)| ≤
          T
MIN
          .
        








FIGURE 14-22



Low-pass filter specification and responses.






          In this chapter on filters, we want to define a new band between the passband and the stopband. Specifying the response in the
          transition band
          (ω
          C
          ≤ ω ≤ ω
          MIN
          ) is the most significant part of filter design. The main filtering action occurs here. It is in this region that a filter designer wants the gain response to change dramatically with frequency. Two ratios describe this change:
          T
MAX
          /
          T
MIN
          (magnitude ratio not a dB ratio) defines how much the gain must change, and ω
          MIN
          /ω
          C
          specifies how rapidly the change must occur. As we study varying approaches to filter design, we will see that there are design approaches that can increase the filter's attenuation rate but possibly at a price, both in the "flatness" of the passband and in the filter's transient performance— its step response. For some applications, these consequences are a small price to pay for better filter performance, while in other cases these compromises are not acceptable.
        

          In summary, a low-pass filter design problem is defined by specifying the four parameters:
          T
MAX
          , ω
          C
          ,
          T
MIN
          , and ω
          MIN
          . Transfer functions (there may be several) that meet these requirements are of the form
        




          where
          
            q
            n

          (
          s
          ) is an
          n
          th-order polynomial whose roots define the poles of
          T
          (
          s
          ). From our previous design experience, we can see that filter design involves two related tasks: (1) selecting
          
            q
            n

          (
          s
          ) and
          K
          so that the |
          T
          (
          j
          ω)| meets the filter specification and (2) devising a circuit that realizes the transfer function
          T
          (
          s
          ). We will discuss three methods of dealing with the first task. The second task is accomplished using our active filter building blocks to design a cascade circuit.
        

First-Order Cascade Filters


          A simple way to produce a multi-pole low-pass filter is to connect
          n
          identical firstorder low-pass filters in cascade. The transfer function of such a cascade connection is written as
        



(14-27)






          To design such a filter, we must select
          K,
          α, and
          n
          such that the gain response of this transfer function meets a filter specification defined by
          T
MAX
          ,
          T
MIN
          , ω
          C
          , and ω
          MIN
          .
        

          The gain response of the transfer function in
          Eq. (14-27)
          is
        



(14-28)





          The maximum gain in
          Eq. (14-28)
          occurs at ω = 0, where the gain is |
          T
          (0)| = |
          K
          |
          
n

          . To meet the passband requirement of the specification, we set |
          K
          |
          
n

          =
          T
MAX
          and evaluate the gain in
          Eq. (14-28)
          at the prescribed cutoff frequency ω
          C
          .
        



Equating the denominators in this equation and then solving for α yields



(14-29)





          This equation relates the cutoff frequency of each first-order stage (α) to the desired cutoff frequency of a cascade connection (ω
          C
          ) of
          n
          first-order stages. Each of these stages has a gain of
          
          and a cutoff frequency of α. To complete a design, we need to know the number of stages required.
        

Figure 14-23
          shows normalized gain responses defined by
          Eq. (14-28)
          for
          n
          = 1 to
          n
          = 10 where
          T
MAX
          = |
          K
          |
          
n

          and α is given by
          Eq. (14-29)
          . All of these responses
          
          meet the passband requirements, and, more importantly, the transition band gain decreases as we increase
          n.
          Obviously, we can improve the transition band performance of
          T
          (
          s
          ) by increasing
          n
          , but this increase adds more stages to the cascade circuit that realizes
          T
          (
          s
          ). There is a trade-off between transition band performance and circuit complexity. What we need to know is the smallest value of
          n
          that meets the filter specification.
        








FIGURE 14-23



First-order low-pass cascade filter responses.





Note:



                All of the filter response curves used in this chapter are summarized in
                Appendix G
                , G-7.
              




          We can estimate the smallest value of
          n
          from the gain plots in
          Figure 14-23
          . For example, suppose that the transition band gain must decrease by 40 dB (
          T
MAX
          /
          T
MIN
          = 100) in the decade above cutoff (ω
          MIN
          /ω
          C
          = 10). In
          Figure 14-23
          we see that at ω/ω
          C
          = 10, the normalized gain |
          T
          (
          j
          ω)|/
          T
MAX
          is-32 dB for
          n
          = 2 and-42 dB for
          n=
          3. The
          n=
          3 curve identifies the smallest value of
          n
          that reduces the gain by at least 40 dB in a one-decade transition band.
        

          In summary, given values of
          T
MAX
          ,
          T
MIN
          , ω
          C
          , and ω
          MIN
          , we construct a first-order cascade transfer function as follows. We use
          Figure 14-23
          (or trial and error) to find the smallest integer
          n
          that meets the transition band requirements defined by
          T
MAX
          /
          T
MIN
          , and ω
          MIN
          /ω
          C
          . Given
          n
          and ω
          C
          , we calculate α using
          Eq. (14-29)
          ,
          K
          = (
          T
MAX
          )
          
            1/
            n

          and use
          Eq. (14-27)
          to get the required transfer function. The transfer function is partitioned into a product of
          n
          identical first-order functions, each of which is realized using a first-order low-pass circuit. The next example illustrates this design procedure.
        













                  DESIGN EXAMPLE 14-6
                


                    (a) Construct a first-order cascade transfer function that meets the following requirements:
                    
T
MAX
                      = 10 dB, ω
                      C
                      = 200 rad/s,
                      T
MIN
                      = -10 dB, and ω
                      MIN
                      = 800 rad/s. Use MATLAB to visualize the gain plot.
                    


                    (b) Design a cascade of active
                    RC
                    circuits that realizes the transfer function developed in (a). Use Multisim to simulate the expected frequency response. Compare your result with the MATLAB plot.
                  





SOLUTION:




                (a) The specification requires the gain to decrease by 20 dB in a transition band with ω
                MIN
                /ω
                C
                = 4.
                Figure 14-23
                shows that at ω/ω
                C
                = 4, the normalized gain is about-17 dB for
                n
                = 2 and about-22 dB for
                n
                = 3. Thus,
                n
                = 3 is the smallest integer that meets the transition band requirement. Given
                n
                and ω
                C
                , we calculate α using
                Eq. (14-29)
                :
                



                  Since
                  T
MAX
                  = 10 dB (factor of 3.162, we write
                  K
                  =(3.162)
                  1/3
                  = 1.468. So, finally, the required first-order cascade transfer function is
                




                  Note that the cutoff frequency of each stage (α = 392 rad/s) is greater than the cutoff frequency of the
                  n
                  -stage transfer function (ω
                  C
                  = 200 rad/s). A quick look at
                  Eq. (14-29)
                  reveals that α > ω
                  C
                  for all
                  n
                  > 1.
                
We expand the transfer function to place it in MATLAB as follows:











FIGURE 14-24









                  MATLAB's bodemag returns the plot shown in
                  Figure 14-24
                  . The filter has the desired cutoff at 200 rad/s, and at 800 rad/s it is down 2.14 dB from the passband gain, which exceeds the requirement. We can now proceed to design our filter.
                


                (b) The transfer function developed in part (a) can be partitioned into a product of three identical first-order functions of the form 1.468/(
                s
                /392 + 1). Each of these can be realized using the first-order low-pass circuit in
                Figure 14-25
                (a). The transfer function of this circuit is
                







FIGURE 14-25



                        (
                        a
                        )
                        First-order low-pass circuit.








                  The design constraints for each stage are 1+
                  R
A
                  /
                  R
B
                  =1.468 and
                  RC
                  = 1/392. Selecting
                  R
B
                  =
                  R
                  = 100 kΩ leads to
                  R
A
                  = 46.8 kΩ and
                  C
                  = 0.0255 µF.
                

                  The Multisim simulation of three cascaded stages produces the low-pass frequency response characteristic shown in
                  Figure 14-25
                  (b). The Grapher View results show that the design meets the target specifications.
                








FIGURE 14-25



                        (
                        b
                        )
                        Circuit realization and response.







■














              Design
              Exercise 14-9


              Construct a first-order cascade transfer function that meets the following requirements:
              T
MAX
              = 0 dB,
              T
MIN
              =-30 dB, ω
              C
              = 200 rad/s, and ω
              MIN
              = 1 krad/s. Validate your results using MATLAB.
            


Answers:




              . See
              Figure 14-26
              .
            








FIGURE 14-26










Butterworth Low-Pass Filters


          All Butterworth low-pass filters have transfer functions of the form
          T
          (
          s
          ) =
          K
          /
          
            q
            n

          (
          s
          ), whose gain response is
        



(14-30)





          where ω
          C
          is the cutoff frequency and
          n
          the order of the denominator polynomial, that is, the number of poles. By inspection, the maximum gain occurs at dc, where |
          T
          (0)| = |
          K
          | =
          T
MAX
          . At the cutoff frequency, the gain is
          
          for all values of
          n
          . When we make
          K
          =
          T
MAX
          , the gain response in
          Eq. (14-30)
          meets the passband requirements of a filter specification for all values of
          n
          . At high frequency (ω ≫ ω
          C
          ) the gain approaches an asymptote of |
          K
          |(ω
          C
          /ω)
          
n

          , which has a slope of-20
          n
          dB/dec. Thus, we can decrease the gain in the transition band by increasing the number of poles.
        

Figure 14-27
          compares Butterworth and first-order cascade gain responses for
          n
          = 4. Both responses have high-frequency asymptotes whose slopes are-80 dB/dec. However, the Butterworth gain approaches its asymptote at a lower frequency, so it has less gain in the transition band. The reduced gain means
          
          that the Butterworth response has better transition band performance than the first-order cascade.
        








FIGURE 14-27



First-order cascade and Butterworth low-pass filter responses for n = 4.





Figure 14-28
          shows normalized plots of the Butterworth gain responses defined by
          Eq. (14-30)
          , where
          T
MAX
          = |
          K
          |. Clearly, the transition band gain decreases rapidly as we increase
          n
          , the filter order. Increasing
          n
          means that
          T
          (
          s
          ) =
          K
          /
          
            q
            n

          (
          s
          ) has more poles, which in turn means more stages in a cascade circuit realizing
          T
          (
          s
          ). As we discovered with the first-order cascade filter, there is a trade-off between reducing the transition band gain and circuit complexity. What we need to know is the smallest value of
          n
          that meets a given filter specification.
        

          Evaluating the gain in
          Eq. (14-30)
          at ω = ω
          MIN
          with
          T
MAX
          = |
          K
          | produces the inequality
        




          Solving the inequality for
          n
          yields the constraint
        



(14-31)





          The right side of this equation is a lower bound on the filter order
          n.
          Note that the lower bound is determined by the transition band ratios
          T
MAX
          /
          T
MIN
          and ω
          MIN
          /ω
          C
          . In other words, the smallest
          n
          depends on how much and how rapidly the gain must change in the transition band.
        

          For example, if the transition band gain must decrease by 30 dB (
          T
MAX
          /
          T
MIN
          = 10
          3
          /
          2
          ) in the two octaves above cutoff (ω
          MIN
          /ω
          C
          = 4), then
          Eq. (14-31)
          yields
        








FIGURE 14-28



Butterworth low-pass filter responses.









          Since filter order must be an integer, the smallest value is
          n
          = 3. The gain plots in
          Figure 14-28
          confirm this result, since a normalized gain below-30 dB at ω/ω
          C
          =4 cannot be achieved by any order less than
          n
          = 3. For Butterworth low-pass filters, the smallest value of
          n
          can be determined analytically using
          Eq. (14-31)
          or graphically using
          Figure 14-28
          .
        

          Once the required value of
          n
          is known, we need an
          n
          th-order polynomial
          
            q
            n

          (
          s
          ) to construct a transfer function with Butterworth gain characteristics. A method of obtaining such polynomials is given in
          Appendix B
          and using that method we generated the normalized (ω
          C
          = 1) polynomials
          
            q
            n

          (
          s
          ) in
          Table 14-2
          . All of these polynomials have the property that
          
            q
            n

          (
          0
          ) = 1. This table is repeated in
          Appendix G
          , G-6.
        







Table

                    14-2
                  
NORMALIZED POLYNOMIALS THAT PRODUCE BUTTERWORTH RESPONSES








Order


Normalized Denominator Polynomials





1

                  (
                  s
                  + 1)
                


2

                  (
                  s
2
                  +1.414
                  s
                  + 1)
                


3

                  (
                  s
                  + 1) (
                  s
2
                  +
                  s
                  + 1)
                


4

                  (
                  s
2
                  + 0.7654
                  s
                  + 1) (
                  s
2
                  + 1.848
                  s
                  + 1)
                


5

                  (
                  s
                  + 1) (
                  s
2
                  + 0.6180
                  s
                  + 1) (
                  s
2
                  + 1.618
                  s
                  + 1)
                


6

                  (
                  s
2
                  + 0.5176
                  s
                  + 1) (
                  s
2
                  + 1.414
                  s
                  + 1) (
                  s
2
                  + 1.932
                  s
                  + 1)
                


7

                  (
                  s
                  + 1) (
                  s
2
                  + 0.4450
                  s
                  + 1) (
                  s
2
                  + 1.247
                  s
                  + 1) (
                  s
2
                  + 1.802
                  s
                  + 1)
                






          Using these polynomials, we obtain an
          n
          th-order Butterworth transfer function with a dc gain of
          K
          and cutoff frequency of ω
          C
          as
        



(14-32)





          where
          
            q
            n

          (
          s
          /ω
          C
          ) is the
          n
          th-order polynomial in
          Table 14-2
          with
          s
          replaced by
          s
          /ω
          C
          . Since
          
            q
            n

          (0) = 1, the dc gain of this transfer function is |
          T
          (0)| = |
          K
          | and the poles of
          T
          (
          s
          ) are roots of the equation
          
            q
            n

          (
          s
          /ω
          C
          ) = 0.
        

          For example, for
          n
          = 3, the polynomial in
          Table 14-2
          is
          q
3
          (
          s
          ) = (
          s
          + 1) (
          s
2
          +
          s
          + 1). A third-order Butterworth low-pass transfer function with a dc gain of 0 dB (
          K
          = 1) and a cutoff frequency of ω
          C
          = 1 krad/s is written as
        




Figure 14-29
          shows how the Butterworth realization works. The first-order low-pass filter's transfer function is multiplied by the second-order filter's transfer function to produce the desired response.
        

          This transfer function has a real pole at
          s
          =-1000 rad/s and a pair of complex poles with ω
          0
          = 1000 rad/s and ζ = 05. The three poles are all located a distance of ω
          C
          = 1000 from the origin in the
          s
          plane. This illustrates a general principle of Butterworth poles—
          Butterworth poles are all located on a circle of radius

            ω
            C

          in the left-half of the s plane. See
          Figure 14-29
          (a).
        








FIGURE 14-29



How a third-order Butterworth response is constructed.
                (
                a
                )
                pole-zero diagram
                (
                b
                )
                Bode diagram.





          Once we have a transfer function
          T
          (
          s
          ) whose gain meets the filter specification, we partition it into a product of first- and second-order functions. Each of these functions is then realized using one of our active filter building blocks. A cascade connection of these building blocks then produces the required transfer function. The next example illustrates the procedure. See
          Figure 14-29
          (b).
        








FIGURE 14-29




















DESIGN EXAMPLE 14-7




                    (a) Construct a Butterworth low-pass transfer function that meets the following requirements:
                    
T
MAX
                      = 20 dB, ω
                      C
                      = 1 krad/
                      s
                      ,
                      T
MIN
                      =-20 dB, and ω
                      MIN
                      = 4 krad/s.
                    


                    (b) Design a cascade of active
                    RC
                    circuits that realizes the transfer function found in part (a). Validate your design using Multisim.
                  





SOLUTION:




                (a) The specification requires the gain to decrease by 40 dB in the transition band between ω
                C
                = 1 krad/s and ω
                MIN
                =4 krad/s. The transition band ratios for this specification are
                T
MAX
                /
                T
MIN
                = 100 and ω
                MIN
                /ω
                C
                = 4. Inserting these ratios in
                Eq. (14-31)
                yields
                



                  Thus,
                  n
                  = 4 is the lowest-order Butterworth filter that meets the filter specification. Using
                  K
                  =
                  T
MAX
                  = 10 and
                  q
4
                  (s) from
                  Table 14-2
                  , the required fourth-order Butterworth low-pass transfer function is
                





                (b) The fourth-order Butterworth transfer function in part (a) can be partitioned as
                



                  where
                  K
1
                  and
                  K
2
                  are to be determined. This partitioning calls for a cascade of two second-order low-pass building blocks.
                

Figure 14-30
                  shows a design sequence for circuits that realize these transfer functions. The first two rows in the figure show the required transfer functions and the stage parameters ω
                  0
                  and ζ. The stage protoype in the third row is the low-pass building block circuit in
                  Figure 14-3
                  . Using the equal element design method for this circuit [see
                  Eq. (14-8)
                  ] leads to the design constraints in the fourth row. The element values selections in the fifth row produce the two-stage design in the last row of
                  Figure 14-30
                  .
                

                  As discussed in
                  Sect. 14-2
                  , the equal element design method does not allow us to control
                  K
1
                  and
                  K
2
                  . The values achieved in our two-stage design are
                  K
1
                  =2.235 and
                  K
2
                  = 1.152. Together, the two stages produce an overall dc gain of
                  K
                  =
                  K
1
K
2
                  = 2.235 × 1.152 = 2.575, which is less than the
                  K
                  = 10 required by
                  
                  the specification. We deal with this shortfall by adding a gain correction stage with a gain of 10/2.575 = 3.883.
                  Figure 14-31
                  (a) shows the final three-stage design with the added gain correction stage.
                










FIGURE 14-30




                      Design sequence for
                      Example 14-7
                      .
                    












FIGURE 14-31















FIGURE 14-31









              The Multisim simulation of the circuit in
              Figure 14-31
              (a) is shown in
              Figure 14-31
              (b). The circuit meets or exceeds all of the design requirements.
              ■












              Design
              Exercise 14-10


              The circuit design in
              Example 14-7
              used the
              
equal element

              method. Rework the problem using the
              
unity gain

              technique. Use Multisim to validate your design. Comment on the two approaches.
            


Answers:



Figure 14-32
              shows the unity gain redesign of the fourth-order low-pass Butterworth filter. The Grapher View results in
              Figure 14-32
              show that the design meets all of the specifications.
            








FIGURE 14-32









              The unity gain technique requires fewer resistors but requires precise capacitors that may be difficult to find.
            











              Design
              Exercise 14-11


              Construct a Butterworth low-pass transfer function that meets the following requirements:
              T
MAX
              = 0 dB,
              T
MIN
              =-40 dB, ω
              C
              = 250 rad/s, and ω
              MIN
              = 15 krad/s. Validate your design with MATLAB.
            


Answers:




              See
              Figure 14-33
              .
            








FIGURE 14-33










Chebyshev Low-Pass Filters

All Chebyshev type 1 low-pass filters have a gain response of the form



(14-33)





          where
          
            C
            n

          (
          x
          ) is an
          n
          th-order Chebyshev polynomial defined by
        



(14-34a)




and



(14-34b)





          In the passband (
          x
          = ω/ω
          C
          ≤ 1),
          
            C
            n

          (
          x
          ) is the cosine function in
          Eq. (14-34a)
          , and the term
          
          in the denominator of
          Eq. (14-33)
          varies between 1 (when
          
            C
            n

          = 0) and 2 (when
          
            C
            n

          = ±1). This means that in the passband the gain |
          T
          (
          j
          ω)| in
          Eq. (14-33)
          varies between
          
          . Thus, the Chebyshev gain variation remains within standard passband bounds for all values of
          n
          . However, the passband gain variation is oscillatory rather than smooth and steady like the Butterworth response.
        


Figure 14-34
          shows plots of
          Eq. (14-33)
          for
          n
          = 4 and
          n
          = 5. The oscillatory variation of the term
          
          produces a sequence of resonant peaks and valleys given the descriptive name
          ripple.
          The gain at the top of every peak is |
          K
          | and the gain at the bottom of every valley is
          
          . The Chebyshev passband gain is called an
          equal-ripple response
          because the upper bound is always |
          K
          | and the lower bound
          
          . Because of the equal-ripple response, the Chebyshev gain has
          
          for all values of
          n
          .
          
4










FIGURE 14-34



Chebyshev passband gain responses.





          However, the Chebyshev dc gain is |
          K
          | when
          n
          is odd and
          
          when
          n
          is even. In other words,
          T
MAX
          does not occur at dc when
          n
          is even. We must account for this difference in dc gain when constructing low-pass transfer functions with Chebyshev poles.
        

Figure 14-35
          compares the Butterworth and Chebyshev gain responses for
          n
          = 4. Both responses have high-frequency asymptotes with slopes of-80 dB/dec. The Butterworth response is relatively flat in the passband and sedately approaches its high-frequency asymptote in the transition band. In contrast, the last resonant peak in the Chebyshev passband produces an initial slope in the transition band that is steeper than-80 dB/dec.
          
5

          As a result, a Chebyshev response has less gain in the transition band than a Butterworth response of the same order.
        








FIGURE 14-35



Butterworth and Chebyshev low-pass filter responses for n = 4.






Figure 14-36
          shows normalized plots of the Chebyshev gain responses with
          T
MAX
          = |
          K
          |. As with Butterworth responses, the Chebyshev transition band gain decreases rapidly as we increase
          n,
          the filter order. Again to minimize circuit complexity, we need to know the smallest value of
          n
          that meets a given filter specification. Evaluating the Chebyshev gain in
          Eq. (14-33)
          at ω = ω
          MIN
          with
          T
MAX
          = |
          K
          | produces the inequality
        








FIGURE 14-36



Chebyshev low-pass filter responses.






          Solving this constraint for
          
            C
            n

          (ω
          MIN
          /ω
          C
          ) yields
        




          In the stopband (
          x
          = ω/ω
          C
          ≥ 1), the function
          
            C
            n

          (
          x
          ) is defined by the hyperbolic cosine function in
          Eq. (14-34b)
          . Inserting this definition into the preceding inequality and then solving for
          n
          yields
        



(14-35)





          The right side of this equation is a lower bound on the filter order
          n.
          As might be expected, the lower bound is determined by the transition band ratios
          T
MAX
          /
          T
MIN
          and ω
          MIN
          /ω
          C
          . Based on our experience with first-order cascade, Butterworth, and now Chebyshev filters, it seems reasonable to infer the following general principle of filter design.
        



Filter order is determined by how much and how rapidly the gain must decrease in the transition band.




          The smallest order for a Chebyshev filter can be determined analytically using
          Eq. (14-35)
          or graphically using the gain plots in
          Figure 14-36
          . Once the required order is known, we need an
          n
          th-order polynomial
          
            q
            n

          (
          s
          ) to construct a transfer function with a Chebyshev gain response. A method of obtaining such a polynomial is given in
          Appendix B
          . Using the method given there, we can generate the normalized (ω
          C
          = 1) polynomials
          
            q
            n

          (
          s
          ) in
          Table 14-3
          . Note that these polynomials all have the property that
          
            q
            n

          (0) = 1. This Table is repeated in
          Appendix G
          , G-6.
        







Table

                    14-3
                  
NORMALIZED POLYNOMIALS THAT PRODUCE CHEBYCHEV TYPE 1 RESPONSES








Order


Normalized Denominator Polynomials





1

                  (
                  s
                  + 1)
                


2

                  [(
                  s
                  /0.8409)
                  2
                  + 0.7654(
                  s
                  /0.8409) + 1]
                


3

                  [(
                  s
                  /0.2980) + 1][(
                  s
                  /0.9159)
                  2
                  + 0.3254(
                  s
                  /0.9159) + 1]
                


4

                  [(
                  s
                  /0.9502)
                  2
                  + 0.1789(s/0.9502) + 1)][(
                  s
                  /0.4425)
                  2
                  + 0.9276(
                  s
                  /0.4425) + 1]
                


5

                  [(
                  s
                  /0.1772) + 1][(
                  s
                  /0.9674)
                  2
                  + 0.1132(
                  s
                  /0.9674) + 1][(
                  s
                  /0.6139)
                  2
                  + 0.4670(
                  s
                  /0.6139) + 1]
                


6

                  [(
                  s
                  /0.9771)
                  2
                  + 0.0781(
                  s
                  /0.9771) + 1][(
                  s
                  /0.7223)
                  2
                  + 0.2886(
                  s
                  /0.7223) + 1][(
                  s
                  /0.2978)
                  2
                  + 0.9562(
                  s
                  /0.2978) + 1]
                


7

                  [(
                  s
                  /0.1265) + 1][(
                  s
                  /0.9831)
                  2
                  + 0.0572(
                  s
                  /0.9831) + 1][(
                  s
                  /0.7920)
                  2
                  + 0.1992(
                  s
                  /0.7920) + 1][(
                  s
                  /0.4519)
                  2
                  + 0.5045(
                  s
                  /0.4519) + 1]
                





          Using these polynomials, an
          n
          th-order Chebyshev transfer function with a dc gain of
          K
          and cutoff frequency of ω
          C
          is written as
        



(14-36a)




or


(14-36b)





          where
          
            q
            n

          (
          s
          /ω
          C
          ) is the
          n
          th-order polynomial in
          Table 14-3
          with
          s
          replaced by
          s
          /ω
          C
          . Since
          
            q
            n

          (0)=1, the scale factors in Eqs. (14-36a) and (14-36b) ensure that the dc gains are
          T
          (0) = |
          K
          | when
          n
          is odd and
          
          when
          n
          is even. These scale factor adjustments are required to ensure that
          T
MAX
          = |
          K
          | whether
          n
          is even or odd. Without these adjustments, we cannot use
          Eq. (14-35)
          or
          Figure 14-36
          when
          n
          is even. In either case, however, the poles of
          T
          (
          s
          ) are roots of the equation
          
            q
            n

          (
          s
          /ω
          C
          ) = 0.
        

          As an example of using
          Table 14-3
          , we write a second-order Chebyshev low-pass transfer function with a dc gain of 20 dB (
          K
          = 10) and a cutoff frequency of ω
          C
          = 1 krad/s as
        




          This transfer function has
          T
MAX
          = 10, a cutoff frequency at ω
          C
          = 1000 rad/s, and a pair of complex poles with ω
          0
          = 840.9 rad/s and ζ = 0.3827. This illustrates two important properties of Chebyshev poles: (1) Their natural frequencies are less than the filter cutoff frequency (ω
          0
          < ω
          C
          ) and (2) their damping ratios are less than those of Butterworth poles of the same order. As a result, the Chebyshev poles produce resonant peaks in the gain response at frequencies below ω
          C
          . Put differently, Chebyshev poles are specifically located to produce an equal-ripple response in the passband.
        

          Once we have a
          T
          (
          s
          ) that meets the filter specification, we realize it using a cascade of first- and second-order building blocks. The next example illustrates the design of a Chebyshev low-pass filter.
        












DESIGN EXAMPLE 14-8



                    (a) Construct a Chebyshev low-pass transfer function that meets the following requirements:
                    T
MAX
                    = 20 dB, ω
                    C
                    = 10 rad/s,
                    T
MIN
                    =-30 dB, and ω
                    MIN
                    = 50 rad/s.
                  

                    (b) Design a cascade of active
                    RC
                    circuits that produces the transfer function found in part (a).
                  





SOLUTION:




                (a) This specification requires the gain to decrease by 50 dB in the transition band between ω
                C
                = 10 rad/sand ω
                MIN
                = 50 rad/s. The corresponding transition band ratios are
                T
MAX
                /
                T
MIN
                = 10
                5/2
                and ω
                MIN
                /ω
                C
                = 5. Using these ratios in
                Eq. (14-35)
                yields
                



                  The smallest integer meeting the specification is
                  n
                  = 3. Using the polynomial
                  q
3
                  (
                  s
                  ) from
                  Table 14-3
                  , we construct the required Chebyshev low-pass transfer function using
                  Eq. (14-36a)
                  .
                




                  No scale factor adjustment is needed here because
                  n
                  = 3 is odd.
                



                (b) The Chebyshev transfer function in (a) can be partitioned as
                





              where
              K
1
              and
              K
2
              are to be determined. This partition calls for a cascade of a first-order and a second-order low-pass filter.
            

              The first row in the design sequence in
              Figure 14-37
              shows the required transfer functions. The second, third, and fourth rows show the stage parameters, stage prototypes, and design constraints. The second-order prototype is the low-pass circuit in
              Figure 14-3
              . The design constraints for this circuit use the equal element design method [see
              Eq. (14-8)
              ]. The
              equal element
              method produces a dc gain of
              K
2
              =3-2ζ = 2.675. The first-order prototype is
              
              the low-pass circuit in
              Figure 14-25
              . Its pole location is determined by the
              RC
              product and its gain
              K
1
              can be adjusted without changing the pole location, so we are free to set
              K
1
              =10/
              K
2
              = 3.738, which makes
              K
              =
              K
1
K
2
              = 10 as required. The assigned element values in the fifth row produce the final design in the last row. A cascade connection of these two stages meets all design requirements without an added gain correction stage.
            








FIGURE 14-37




                      Design sequence for
                      Example 14-8
                      .
                    





Figure 14-38
              demonstrates the effects of the Chebyshev polynomial in building a filter with a steeper roll-off than the order of the filter in the transition band. The pole-zero diagram of a Chebyshev transfer function as seen in
              Figure 14-38
              (a) is different from that of the Butterworth transfer function (
              Figure 14-29
              (a)). The Butterworth's poles were all located on a circle of radius equal to the resonant frequency. The Chebyshev's poles lie on the left-hand side of an ellipse. The distance to the poles is the resonant frequency of that pair. ζ for this pair is 0.163 indicating a set of poles near to the imaginary axis and capable of producing a high peak in the response. We have used MATLAB, as seen in
              Figure 14-38
              (b), to plot the effects of combining a first-order and a second-order stage to produce the composite third-order result. Note that the first-order filter crosses the-3dB (0.707) point at 3 rad/s while the second-order filter has a cutoff at 14 rad/s. The composite, however, reaches the-3 dB point exactly at the desired 10 rad/s. The absolute and normalized scale highlights the ripple nature of the Chebyshev realization.
            










FIGURE 14-38



How a third-order Chebyshev response is constructed.
                    (
                    a
                    )
                    Pole-zero diagram,
                    (
                    b
                    )
                    Bode diagram.





■














              Design and Evaluation
              Exercise 14-12


              Rework the design in
              Example 14-8
              using the
              unity gain
              method in
              Sect. 14-2
              to design the required third-order low-pass circuit. Use Multisim to validate your design. Which method is likely the better design?
            


Answers:



Figure 14-38
              (c) shows the Multisim circuit and the Grapher View output. Comparing the performance of this design with the equal-element method shows the same results. Both designs use five different part values. However, since the unity-gain method uses two less components (resistors), the unity-gain design is likely the better choice in this case.
            












              Design
              Exercise 14-13



              Construct a Chebyshev low-pass transfer function that meets the following requirements:
              T
MAX
              = 0 dB,
              T
MIN
              = -30 dB, ω
              C
              =250 rad/s, and ω
              MIN
              = 1.5 krad/s. Validate your design using MATLAB.
            


Answers:




              . See
              Figure 14-39
              .
            








FIGURE 14-39












14-5 Low-Pass Filter Evaluation



          We have described low-pass filter design methods for three responses, the first-order cascade, the Butterworth, and the Chebyshev type 1. At this point, we want to compare the methods and discuss how we might choose among them. In filter applications the gain response is obviously important.
          Figure 14-40
          shows three straight-line asymptotes (solid lines) for components of the three filter types and the total gain responses (dashed curves) for
          n
          = 3. All three of the total responses meet the same passband requirements, have the same cutoff frequency, and have high-frequency asymptotes with slopes of-20
          n
          =-60 dB/decade. However, the three response components use different corner frequencies to achieve the same total response. At one extreme, the corner frequency of the first-order cascade response is above the cutoff frequency, so its actual gain response approaches its asymptote very gradually. At the other extreme, the Chebyshev corner frequency lies below the cutoff frequency and the actual response has a resonant peak that fills the gap between the corner frequency and the cutoff frequency. This resonance causes the Chebyshev response to decrease rapidly in the neighborhood of the cutoff frequency. The Butterworth response has its corner frequency at the cutoff frequency, so its gain response falls between these two extremes.
        








FIGURE 14-40



First-order cascade, Butterworth, and Chebyshev gain responses for n = 3.





          The differences in gain response can be understood by examining the pole-zero diagram in
          Figure 14-41
          . The Butterworth poles are evenly distributed on a circle of radius ω
          C
          . The Chebyshev poles lie on an ellipse whose minor axis is much smaller than ω
          C
          . As a result, the Chebyshev poles are closer to the
          j
          -axis, have lower damping ratios, and produce a gain response with pronounced resonant peaks. These resonant peaks lead to the equal-ripple response in the passband and the steep gain slope in the neighborhood of the cutoff frequency. At the other extreme, the first-order cascade response has a third-order pole (triple pole) located on the negative real axis. The distance from the
          j
          -axis to the first-order cascade poles is much
          
          larger than ω
          C
          , which explains the rather leisurely way its gain response transitions from the passband to stopband asymptote. As might be expected, the Butterworth poles fall between these two extremes.
        








FIGURE 14-41



First-order cascade, Butterworth, and Chebyshev pole locations for n = 3.





          This discussion illustrates the following principle. For any given value of
          n,
          the Chebyshev response produces more transition band attenuation than the Butterworth response, which, in turn, produces more than the firstorder cascade response. If transition band performance is the only consideration, then we should choose the Chebyshev response. However, the Chebyshev response comes at a price.
        

Figure 14-42
          shows the step response of these three low-pass filters for
          n
          = 3. The step response of the Chebyshev filter has lightly damped oscillations that produce an overshoot and a long settling time. These undesirable features of the Chebyshev step response are a direct result of the low-damping-ratio complex poles that produce the desirable features of its gain response. At the other extreme, the step response of the first-order cascade filter rises rapidly to its final value without overshooting. This result should not be unexpected since the remote poles of the first-order cascade produce exponential waveforms that have relatively short durations. In other words, the desirable features of the first-order cascade step response are a direct result of the remote real poles that produce the undesirable features of its gain response. Not surprisingly, the step response of the Butterworth filter lies between these two extremes.
        

          Finally, consider the element values in the circuit realizations of these filters. Examination of
          Table 14-3
          reveals that each pair of complex poles in a Chebyshev filter has a different ω
          0
          and a different ζ. These parameters define the constraints on the element values for each stage in the filter. As a result, each stage in a cascade realization of a Chebyshev filter has a different set of element values. In contrast, the stages in a first-order cascade filter can be exactly the same. From a manufacturing point of view, it may be better to produce and stock identical circuits rather than uniquely different circuits.
        








FIGURE 14-42



First-order cascade, Butterworth, and Chebyshev step responses for n = 3.






          The essential point is that transition band attenuation is important, but it does not tell the whole story. Filter design, and indeed all design, involves trade-offs between conflicting requirements. The choice of a design approach is driven by the weight assigned to conflicting requirements.
        














                  DESIGN AND EVALUATION EXAMPLE 14-9
                
A low-pass filter is required that will process high-fidelity audio signals meeting the following criteria:



The filter should have less than ±1.5 dB gain variation over most of the passband. Design an appropriate circuit and justify your choice.




SOLUTION:



              We have three possible design approaches: first-order cascade, Butterworth, and Chebyshev. We need to determine the filter order of each design that will accomplish the task. The filter will need to provide 70 dB of attenuation from the passband to
              f
MIN
              . It will have one decade from the cutoff frequency to accomplish it. From
              Figure 14-23
              , we determine that the filter order for a first-order cascade to achieve the desired response is
              n
              = 7. From
              Figure 14-28
              , we can determine that a fourth-order Butterworth filter will accomplish the same task. Finally, from
              Figure 14-36
              , a third-order Chebyshev filter will meet the roll-off requirement.
            

              Although it appears that the Chebyshev solution is the most efficient, we need to look at other factors as well. The application is for an audio system. Ringing caused by a poor step response is a major consideration for an audio system. Chebyshev filters have different small damping ratios, which cause a tortured step response with multiple ringing frequencies. Furthermore, for an audio application, the 3-dB ripple in the passband would result in varying gains for different audio frequencies —a real concern for serious audiophiles, who can detect signal differences of ±1.5 dB. A Butterworth filter has a maximally flat response in the passband— a desirable quality for audio applications. However, it has a step response that is less than ideal. Since a first-order cascade has only real poles, it will have the best step response characteristic. The decision, then, focuses on the trade-off between simplicity in design and a very flat passband, favoring the Butterworth solution or the better step response of the first-order cascade. To see how each performs, both circuits are designed and simulated in Multisim.
              Figure 14-43
              shows the circuit designs used.
            

              The gain characteristics shown in
              Figure 14-44
              (a) favor the Butterworth solution. The first-order cascade begins to roll off well before reaching the cutoff frequency; for example, it is 15 dB down at 14 kHz while the Butterworth solution does not reach 1.5 dB down until about 18 kHz. The roll-off is more rapid for the Butterworth filter than the first-order cascade in the transition band— a better performance for a low-pass filter. They both reach-60 dB at about 200 kHz, as required.
              Figure 14-44
              (b) shows the step response of both circuits. The first-order cascade has a very fast rise time without any overshoot— good for reproducing sounds from percussion instruments. The Butterworth filter has an 11% overshoot, a somewhat slower rise time, and a damped natural frequency of about 19 kHz—within the filter's passband. These qualities tend to diminish the overall audio performance.
              Table 14-4
              summarizes the differences.
            









FIGURE 14-43















FIGURE 14-44















FIGURE 14-44














Table

                        14-4
                      
COMPARISONS BETWEEN TWO DESIGN APPROACHES








Parameter



First-Order Cascade




Butterworth







Frequency Response





Pass band
Fair: Exceeds 1.5 dB error > 14 kHz
Excellent: Exceeds 1.5 dB error > 18 kHz


Transition band
Good: Reaches-60 dB at 200 kHz
Excellent: Reaches-64 dB at 200 kHz



Step Response





Rise time
Excellent: Fast risetime ~12 µs
Good: Moderate risetime ~16 µs


Percussion response
Excellent: No ringing
Poor: 11% Overshoot and 19 kHz β (ringing)


Power requirement
Poor: 7 OP AMPs
Good: 3 OP AMPs


Parts: Number
Poor: 16 Passive, 7 active
Fair: 14 passive, 3 active


Parts: Different
Excellent: 3 Different passive, 1 active
Good: 5 different passive, 1 active


Costs and size
Fair: 23 Parts, large size
Good: 17 parts, modest size






              The Butterworth filter is cheaper, uses less power, and has better frequency response characteristics. The first-order cascade has a better step response. Before one decides, it would be better to build breadboards of both circuits and expose the results to an audiophile to see which performs better. The final decision would include that result along with costs and manufacturing issues. Technology alone is often not an obvious or sufficient basis for determining which of two or more competing solutions is best.
              ■







14-6 High-Pass Filter Design and Evaluation


          An ideal high-pass filter has a constant gain above a cutoff frequency ω
          C
          and zero gain below ω
          C
          . Filter design specifications define the degree to which real filters are required to approach the ideal.
          Figure 14-45
          is a Bode plot specifying the allowable region for high-pass filter gain responses. The allowable region is defined by four familiar parameters:
          T
MAX
          ,
          T
MIN
          , ω
          C
          , and ω
          MIN
          . We are acquainted with the definitions and use of these parameters from our study of low-pass filter design.
        








FIGURE 14-45



High-pass filter specification and responses.





          The difference here is that ω
          MIN
          < ω
          C
          , that is, the transition band and stopband are below the passband. In fact, if we look carefully, we see that
          Figure 14-45
          is the mirror image of
          Figure 14-22
          for low-pass filters including how a filter can fail specifications. This suggests that low-pass filter design methods apply to high-pass filter design when we interchange the positions of the passband and the stopband. Mathematically, the interchange is called a low-pass to high-pass transformation. The transformation is carried out by inverting the frequency variables in the low-pass filter relationships. We demonstrate this first for first-order cascade responses.
        

First-Order Cascade


          First-order cascade low-pass gain responses are defined in
          Eq. (14-28)
          using the normalized frequency variable ω/α. Using the inverted frequency variable α/ω in
          Eq. (14-28)
          produces the definition of first-order cascade high-pass responses:
        


(14-37)



Following the same process as for the low-pass case, the cutoff frequency α for the cascaded filter is found as



(14-38)





          This equation relates the cutoff frequency of each first-order stage (α) to the desired cutoff frequency of the cascade connection (ω
          C
          ) of
          n
          first-order stages. Each of these stages has again of
          K
          = (
          T
MAX
          )
          
            1/
            n

          and a cutoff frequency of a. To determine the number of stages required to obtain a particular roll-off, we can use the normalized gain responses for
          n
          =1 to
          n
          = 11 in
          Figure 14-46
          .
        








FIGURE 14-46



First-order high-pass cascade filter responses.


















                  DESIGN EXAMPLE 14-10
                

                  Design a cascade of active
                  RC
                  high-pass filter circuits to create a filter with a
                  K
                  of 0 dB, a cutoff frequency of 500 rad/s, a
                  T
MIN
                  of-40 dB, and a ω
                  MIN
                  of 100 rad/s. Simulate the output using Multisim to verify your design.
                




SOLUTION:



              From
              Figure 14-16
              , we find that the filter order to meet our requirement is 8. Using
              Eq. (14-38)
              , we find that the cutoff frequency of each filter is 150422 rad/s. If we select
              R
              = 10 kΩ,
              C
              is 06648 µF.
              Figure 14-47
              (a) shows the circuit constructed in
            








FIGURE 14-47









              Multisim overlaid on the Grapher View of the AC analysis. The simulation shows that the cutoff frequency is at 79.7 Hz or 500 rad/s as required, and the attenuation is 41.1 dB, exceeding the-40 dB requirement.
              ■













              Design
              Exercise 14-14



                (a) Design a high-pass first-order cascade filter with a cutoff frequency of 100 krad/s, a
                T
MIN
                of-65 dB, a ω
                MIN
                of 10 krad/s, and a passband gain of 17 dB.
              

                (b) Find the transfer function
                T
                (
                s
                )
                .

(c) Use MATLAB to plot the dB magnitude of the frequency response.

Answers:


                (a) From
                Figure 14-46
                ,
                n
                = 9. Use 9 stages of a first-order
                RC
                high-pass filter consisting of a 10-kΩ resistor and a 3534-pF capacitor. Separate the stages using noninverting OP AMPs, each with a gain of 1.2429.
              

                (b)
                


                (c) Use MATLAB to expand and plot the response, see
                Figure 14-47
                (b).
              









FIGURE 14-47










Butterworth High-Pass Filters


          Butterworth low-pass gain responses are defined in
          Eq. (14-30)
          using the normalized frequency variable ω/ω
          C
          . Using an inverted frequency variable ω
          C
          /ω in
          Eq. (14-30)
          produces the definition of Butterworth high-pass gain responses:
        



(14-39)





          where
          n
          is the filter order.
          Figure 14-48
          shows normalized plots of
          Eq. (14-39)
          for
          n
          = 1 to 7, where
          T
MAX
          = |
          K
          |. These plots confirm that the inverted variable ω
          C
          /ω
          
          does in fact interchange the passband and stopband while leaving the cutoff frequency unchanged at ω/ω = 1. The inversion causes low-pass gain responses that occur below ω
          C
          to occur as high-pass responses above ω
          C
          , and vice versa. In particular,
          Figure 14-48
          shows that gains in the high-pass transition band decrease rapidly as
          n
          increases.
        








FIGURE 14-48



Butterworth high-pass filter responses.





          To limit circuit complexity, we need to know the smallest
          n
          that meets a given high-pass filter specification. For Butterworth low-pass filters,
          Eq. (14-31)
          provides a lower bound on
          n
          in terms of the transition band ratios. For Butterworth high-pass filters, the lower bound is found by substituting the inverted variable ω
          C
          /ω in the derivation of
          Eq. (14-31)
          . The modified derivation is straightforward and leads to the following equation:
        



(14-40)





          The lower bound on the right side of this equation depends on two transition band ratios, namely
          T
MAX
          /
          T
MIN
          and ω
          C
          /ω
          MIN
          . There is no real surprise here. We have seen several times that filter order depends on how much and how abruptly the transition band gain must decrease to meet a given specification.
        

          To give a concrete example, suppose the transition band gain of a Butterworth high-pass filter must decrease by 40 dB (
          T
MAX
          /
          T
MIN
          = 10
          2
          ) when ω
          C
          /ω
          MIN
          = 5.
          Equation (14-40)
          yields a lower bound of
        




          The smallest integer meeting this bound is
          n
          = 3. This result is confirmed by the plots in
          Figure 14-48
          , which show that a normalized gain below-40 dB at ω/ω
          C
          = 0.2 cannot be produced by any order less than
          n
          = 3.
        


          Given the value of
          n
          , we need to construct a high-pass transfer function with a Butterworth gain response. A Butterworth low-pass transfer function is constructed using a polynomial
          
            q
            n

          (
          s
          ) from
          Table 14-2
          in
          Eq. (14-32)
          . An
          n
          th-order high-pass transfer function is found by inverting the frequency variable in
          Eq. (14-32)
          to get
        



(14-41)





          where
          
            q
            n

          (ω
          C
          /
          s
          ) is a normalized Butterworth polynomial in
          Table 14-2
          with
          s
          replaced by ω
          C
          /
          s
          .
        

          To see how the inversion process actually works, let us develop a second-order Butterworth high-pass transfer function with ω
          C
          = 1 krad/s and
          T
MAX
          =20 dB. For
          n
          = 2, the normalized polynomial in
          Table 14-2
          is
          q
2
          (s) =
          s
2
          + 1.414
          s
          + 1. Using ω
          C
          = 1000 rad/s and
          K
          = 10 (20 dB) in
          Eq. (14-41)
          produces
        




          This transfer function has a double zero at
          s =
          0 and a pair of Butterworth poles with ω
          0
          = 1000 rad/s and ζ =1.414/2 = 0.707. The double zero makes the dc gain |
          T
          (0)|=0 and the infinite-frequency gain |
          T
          (∞)| = 10. The gain at the cutoff frequency ω
          C
          = 1 krad/s is
        




          as required. In sum, the transfer function
          T
          (
          s
          ) has the properties of a second-order Butterworth high-pass filter.
        

          Designing an
          n
          th-order Butterworth high-pass filter to meet prescribed values of
          T
MAX
          ,
          T
MIN
          , ω
          C
          , and ω
          MIN
          involves the following steps.
        


            • We first determine the smallest
            n
            that meets the specification using
            Eq. (14-40)
            or the graphs in
            Figure 14-48
            .
          

            • Taking the polynomial
            
              q
              n

            (
            s
            ) from
            Table 14-2
            and using
            K = T
MAX
            , we obtain
            T
            (
            s
            ) using
            Eq. (14-41)
            . The polynomial
            
              q
              n

            (ω
            C
            /
            s
            ) in the denominator of
            T
            (
            s
            ) supplies
            n
            Butterworth poles and
            n
            zeros at the origin.
          

            • We then partition
            T
            (
            s
            ) into a product of first- and second-order high-pass functions and use a cascade of high-pass building blocks to get the overall filter circuit.
          

The next example illustrates the Butterworth high-pass design process.













DESIGN EXAMPLE 14-11




                      (a) Determine the minimum order required for a Butterworth high-pass filter to meet the following requirements:
                      T
MAX
                      = 20 dB, ω
                      C
                      = 10 rad/s,
                      T
MIN
                      =-10 dB, and ω
                      MIN
                      -3 rad/s.
                    


(b) Construct the corresponding transfer function and use MATLAB to plot the gain response.



                      (c) Partition the transfer function into a product of first- and second-order high-pass functions. Design a cascade of active
                      RC
                      circuits that realizes the transfer function. Validate your design using Multisim.
                    






SOLUTION:





                (a) The specification requires the gain to decrease by 30 dB in the transition band between ω
                MIN
                = 3 rad/s and ω
                C
                = 10 rad/s. The transition band ratios for this specification are
                T
XMAX
                /
                T
MIN
                = 10
                3//2
                and ω
                C
                /ω
                MIN
                =3.33. Inserting these ratios in
                Eq. (14-40)
                yields
                




                (b) Hence,
                n
                = 3 is the lowest-order Butterworth response that meets the transition band requirement. For
                n
                = 3,
                Table 14-2
                lists
                q
3
                (s) = (
                s
                + 1) (
                s
2
                +
                s
                + 1). Using ω
                C
                = 10 and
                K
                = 10(20 dB) in
                Eq. (14-41)
                gives the required high-pass transfer function:
                



                  This third-order high-pass function has
                  
three

                  zeros at
                  s
                  = 0, a real pole at
                  s
                  =-10 rad/s, and a pair of complex poles with ω
                  0
                  = 10 rad/s and ζ = 05. Note that these high-pass poles all lie on a circle of radius ω
                  C
                  , as did the poles in Butterworth low-pass filters. Also note, that the order of the zeros equals the order of the polynomial, three in this case.
                

                  The transfer function was expanded for use in MATLAB, and the code below was used to produce the gain curve shown in
                  Figure 14-49
                  . The result shows that the transfer function meets the required specifications.
                

                  T=tf([10 0 0 0],[1 20 200 1000]);
                  w = logspace(0,2,10000);
                  bodemag(T,w);grid
                








FIGURE 14-49










                (c) The Butterworth high-pass function developed in part (b) can be partitioned as follows:
                





              In this partition, all of the passband gain
              T
MAX
              =10(20 dB) has been assigned to the
              first-order
              transfer function. This makes the passband gain of the second-order transfer function 1(0 dB) so that it can be realized using the
              unity gain
              design method [see
              Eq. (14-14)
              ].
            

Figure 14-50
              shows a design sequence based on this partitioning. The stage transfer functions in the first row lead to the stage parameters in the second row. The two stage prototypes are a second-order high-pass circuit with unity gain and a first-order high-pass circuit with an adjustable gain. The design constraints for the second-order stage use the unity gain design method. The design constraints for the first-order stage locate the real pole using the
              RC
              product and
              
              adjust the OP AMP's feedback to get the required gain. Using these constraints together with the element value assignments in the fifth row produces the final designs in the last row of
              Figure 14-50
              . The required passband gain is provided by the first-order stage, so no additional gain correction stage is needed in this example.
            








FIGURE 14-50




                      Design sequence for
                      Example 14-11
                      .
                    





              The final design in
              Figure 14-50
              was built in Multisim and is shown in
              Figure 14-51
              .
            

              The circuit was simulated using AC analysis, and the Grapher View plot is also shown superimposed over the circuit in
              Figure 14-51
              . The design meets or exceeds the specifications for the filter.
            








FIGURE 14-51








■
















                  Design
                  Exercise 14-15




              Design a Butterworth high-pass filter using the
              equal element
              configuration that meets the following conditions: passband gain 100, ω
              0
              = 5 krad/s, ω
              MIN
              = 500 rad/s,
              T
MIN
              =-40 dB± 1dB. You must use 10-kΩ resistors as much as possible. Use Multisim to validate your design.
            


Answers:



              The solution requires a fourth-order filter. Use two second-order equal element, high-pass filters followed by a non-inverting gain stage. See
              Figure 14-52
              (a) for a working design and Multisim simulation.
            













              Design and Evaluation
              Exercise 14-16


              Repeat
              Exercise 14-15
              , but design a Butterworth high-pass filter using the
              unity gain
              configuration. You must use 001 µF capacitors. Compare the results with
              Exercise 14-15
              .
            


Answers:



              Like the previous exercise, the solution requires a fourth-order filter and a noninverting amplifier.
              Figure 14-52
              (b) shows a working design. in comparing this design with the prior, there are several advantages/disadvantages with each design. The equal-element approach uses only five different values of components simplifying ordering parts. It, however, uses 14 components, 3 of which are not standard values plus 3 OP AMPs. The unity-gain design uses fewer components, only 10, plus the 3 OP AMPs. However, five of the parts are nonstandard which could increase manufacturing costs. The performance of both approaches is similar, with the equal-element design having a larger corner-frequency error than the unity-gain design, but both are less than 0.5%.
            








FIGURE 14-52










Chebyshev High-Pass Filters



          Our treatment of Chebyshev high-pass filters can be brief because the low-pass to high-pass transformation used to develop Butterworth high-pass filters works equally well here. The Chebyshev low-pass gains are defined in
          Eq. (14-33)
          in terms of a frequency variable ω/ω
          C
          . Using the inverted variable ω
          C
          /ω in this definition produces the definition of chebyshev high-pass gain responses.
        


(14-42)




          where
          
            C
            n

          (
          x
          ) is an
          n
          th-order type 1 Chebyshev polynomial. The normalized plots of the Chebyshev high-pass gains in
          Figure 14-53
          show that the passband and stopband have been interchanged. These Chebyshev high-pass responses have equal-ripple responses in the passband above ω
          C
          and transition band gains below ω
          C
          that decrease rapidly as
          n
          increases.
        

Equation (14-35)
          provides a lower bound on
          n
          for Chebyshev low-pass filters. Using the inverted variable ω
          C
          /ω in the derivation of this equation yields a lower bound on the Chebyshev high-pass order as
        



(14-43)





          Once again we see that the lower bound on filter order depends on how much (
          T
MAX
          /
          T
MIN
          ) and how abruptly (ω/ω
          MIN
          ) the transition band gain must decrease to meet the specification.
        








FIGURE 14-53



Chebyshev highpass filter responses.






          For any given
          n
          , a Chebyshev low-pass transfer function is obtained using a polynomial
          
            q
            n

          (
          s
          /ω
          C
          ) in
          Eq. (14-36a)
          or
          (14-36b)
          . To obtain a Chebyshev high-pass transfer function, we invert the frequency variable and write
        



(14-44a)




or


(14-44b)




          where
          
            q
            n

          (ω
          C
          /
          s
          ) is a normalized Chebyshev denominator polynomial in
          Table 14-3
          with
          s
          replaced by ω
          C
          /
          s
          . Thus, the polynomials in
          Table 14-2
          and
          Table 14-3
          serve two purposes. They are used as
          
            q
            n

          (
          s
          /ω
          C
          ) in the design of low-pass filters and as
          
            q
            n

          (ω
          C
          /
          s
          ) in the design of high-pass filters. For the Chebyshev high-pass case, the order of the polynomial is found analytically using
          Eq. (14-43)
          or graphically using the normalized gain plots in
          Figure 14-53
          .
        
The next example illustrates constructing Chebyshev high-pass transfer functions to meet a given specification.














                  DESIGN AND EVALUATION EXAMPLE 14-12
                


                    (a) Determine the minimum order required for a Chebyshev high-pass filter to meet the requirements of
                    Example 14-11
                    . That is,
                    T
MAX
                    = 20 dB, ω
                    C
                    = 10 rad/s,
                    T
MIN
                    =-10 dB, and ω
                    MIN
                    =-3 rad/s.
                  
(b) Construct the corresponding transfer function and use MATLAB to plot the gain response.

                    (c) Design a cascade of active
                    RC
                    circuits that realizes the transfer function. Validate your design using Multisim. Compare the gain performance of this filter versus the Butterworth filter designed in
                    Example 14-11
                    .
                  





SOLUTION:




              Following the same steps as for the Butterworth design, we first determine the smallest
              n.



                (a) The transition band gain must decrease by 30 dB (
                T
MAX
                /
                T
MIN
                = 10
                3/2
                ) on the range ω
                C
                /ω
                MIN
                = 333. Inserting these ratios in
                Eq. (14-43)
                yields
                




                (b) Hence,
                n=
                3 is the lowest-order chebyshev response that meets the design requirement. The third-order polynomial in
                Table 14-3
                is
                



                  Using ω
                  C
                  = 10 and
                  K
                  = 10(
                  T
MAX
                  = 20 dB) in
                  Eq. (14-44a)
                  gives the required highpass transfer function:
                




                  In
                  Example 14-11
                  , we meet this specification using a third-order Butterworth high-pass function with poles located on a circle of radius ω
                  C
                  = 10 rad/s. The third-order chebyshev high-pass function constructed here has three zeros at
                  s
                  = 0 a real pole at
                  s
                  =-3355 rad/s, and a pair of complex poles with
                  
                  rad/s and ζ = 01627. These poles all lie outside of a circle of radius ω
                  C
                  = 10 rad/s. The reason for this is easy to understand. A chebyshev high-pass function has an equal-ripple response in the passband
                  above
                  ω
                  C
                  . Hence, the chebyshev poles that produce the ripple must have natural frequencies greater than ω
                  C
                  .
                


                (c)
                Figure 14-54
                (a) displays the Bode magnitude plot derived using MATLAB. The design meets or exceeds all of the specifications. A circuit for the filter was designed using the equal-element method. The design and the Grapher View simulation are shown in
                Figure 14-54
                (b).
                
                  In both the MATLAB and Multisim plots, ω
                  MIN
                  of the chebyshev approach has a far greater attenuation (- 22.7dB) than the Butterworth approach (- 11.4dB). The price for this better filtering is the ripple in the passband. Furthermore, exceeding a specification generally does not offer a significant advantage over simply meeting it.
                










FIGURE 14-54








■















              Evaluation and Design
              Exercise 14-17


              Construct Butterworth and Chebyshev high-pass transfer functions that meet the following requirements:
              T
MAX
              = 10 dB, ω
              C
              = 50 rad/s,
              T
MIN
              =-40 dB, and ω
              MIN
              = 10 rad/s. Plot the two transfer functions and comment on the results. Which is better?
            


Answers:





              Both meet the requirements. The major differences are that the Chebyshev plot has ripple in the passband, an initial steeper roll-off in the transition region, it requires a lower order, and fewer parts. Unless the ripple is an issue, the Chebyshev design is better. See
              Figure 14-54
              (c).
            








FIGURE 14-54












14-7 Bandpass and Bandstop Filter Design Bandpass Filter Design


          In
          Chapter 12
          , we found that the cascade connection in
          Figure 14-55
          can produce a bandpass filter. When the cutoff frequency of the low-pass filter (ω
          CLP
          ), is higher than the cutoff frequency of the high-pass filter (ω
          CHP
          ), the interval between the two frequencies is a passband separating two stopbands. The low-pass filter provides the high-frequency stopband and the high-pass filter the low-frequency stopband. Frequencies between the two cutoffs fall in the passband of both filters and are transmitted through the cascade connection, producing the passband of the resulting bandpass filter.
        

          When ω
          CLP
          ≫ ω
          CHP
          , two bandpass cutoff frequencies are approximately ω
          C1
          ≈ ω
          CHP
          and ω
          C2
          ≈ ω
          CLP
          . Under these conditions, the center frequency and bandwidth of the bandpass filter are
        





          and the ratio of the center frequency over the bandwidth is approximately
        








FIGURE 14-55



Cascade connection of high-pass and low-pass filters.








          Since the quality factor is less than 1, this method of bandpass filter design produces a wide-band filter, as contrasted with the narrowband response (
          Q
          >1) produced by the active RC bandpass circuit studied earlier in
          Sect. 14-3
          .
        













DESIGN EXAMPLE 14-13


                  Use second-order Butterworth low-pass and high-pass functions to obtain a fourth-order bandpass function with a passband gain of 0 dB and cutoff frequencies at ω
                  C1
                  =10 rad/s and ω
                  C2
                  = 50 rad/s. Use MATLAB to show a complete Bode plot of the transfer function.
                




SOLUTION:


The upper cutoff frequency at 50 rad/s is produced by a low-pass function. Using second-order Butterworth poles, the required low-pass function is



The lower cutoff frequency at 10 rad/s is to be produced by a second-order high-pass function. Using second-order Butterworth poles, the required high-pass function is



When circuits realizing these two transfer functions are connected in cascade, the overall transfer function is




              We can use MATLAB to plot a complete Bode diagram of our transfer function. We use the following code to generate the plots shown in
              Figure 14-56
              :
            

              T=tf([2500 0 0],...
                [1 60*sqrt(2) 3600 30000*sqrt(2) 250000]);
              w = logspace(0,3,10000);
              bode(T,w);
              grid
            

              The gain response shows that the transfer function indeed has a bandpass characteristic. The phase shifts over 360°, from 180° at low frequencies to-180° at high frequencies, passing through 0
              °
              at the center frequency of
              
              rad/s. At 10 and 50 rad/s, the cutoffs are as desired, but the gain is shy of 0 dB, reaching a maximum of-0341 dB. This small error is probably insignificant. As the cutoff
              
              frequencies get closer together and the bandwidth decreases, the two filter components interact to decrease the gain at the center frequency. This interaction will cause the gain to fail to attain the desired value. The
              Q
              of this filter is ω
              0
              /
              B
              = 22.36/40 = 056. As the
              Q
              approaches 1, a different design approach is needed, such as the tuned filter design shown in
              Figure 14-14
              or
              Figure 14-19
              .
            








FIGURE 14-56








■













              Design
              Exercise 14-18

Construct Butterworth low-pass and high-pass transfer functions whose cascade connection produces a bandpass function with cutoff frequencies at 20 and 500 rad/s, a passband gain of 0 dB, and a stopband gain less than-20 dB at 5 and 2000 rad/s.


Answers:








Bandstop Filter Design


Figure 14-57
          shows the dual situation in which a high-pass and a low-pass filter are connected in parallel to produce a bandstop filter. When ω
          CLP
          ≪ ω
          CHP
          , the region between the two cutoff frequencies is a stopband separating two passbands. The low-pass filter provides the low-frequency passband via the lower path and the high-pass filter provides the high-frequency passband via the upper path. Frequencies between the two cutoffs fall in the stopband of both filters and are not transmitted through either path in the parallel connection. As a result, the two filters produce the stopband of the resulting bandstop filter. When ω
          CHP
          ≫ ω
          CLP
          , two cutoff frequencies are approximately ω
          C1
          ≈ ω
          CLP
          and ω
          C2
          ≈ ω
          CHP
          .
        








FIGURE 14-57



Parallel connection of high-pass and low-pass filters.

















                  DESIGN EXAMPLE 14-14
                

                  Use second-order Butterworth low-pass and high-pass functions to obtain a fourth-order bandstop function with passband gains of 0 dB and cutoff frequencies at ω
                  C1
                  =10 rad/s and ω
                  C2
                  =50rad/s. Use MATLAB to show a complete Bode plot of the transfer function.
                





SOLUTION:



              In
              Example 14-13
              , we obtained a Butterworth bandpass response using a cascade connection of a second-order high-pass function and a low-pass function with ω
              CLP
              = 50 ≫ ω
              CHP
              = 10. To obtain a bandstop response, we interchange the cutoff frequencies and write the two functions as
            




              We now have ω
              CLP
              = ≪ ω
              CHP
              =50, which leads to a bandstop response. For the parallel connection, the overall transfer function is the sum of the two transfer functions.
            




              As with the bandpass example, we can use MATLAB to plot a complete Bode diagram of our transfer function. We use the following code to generate the plots shown in
              Figure 14-58
              :
            

              T=tf([1 10*sqrt(2) 200 5000*sqrt(2) 250000],...
                 [1 60*sqrt(2) 3600 30000*sqrt(2)250000]);
              w =logspace(0,3,10000);
              bode(T,w);
              grid
            

              The gain response shows that the transfer function indeed has a bandstop characteristic. The phase shifts from 0
              °
              at low frequencies to-360° at high frequencies, passing
              
              through 180° at the center frequency of
              
              rad/s. At 10 rad/s and 50 rad/s, the cutoffs are as desired, with the filter reaching a maximum attenuation of 102 dB. As the cutoff frequencies get closer together and the bandwidth of the stopband decreases, the two components of the filter will interact to decrease the amount of attenuation at the center frequency. In other words, as the bandwidth decreases, the filter's notch will not be as deep. The
              Q
              of this filter is ω
              0
              /
              B
              = 22.36/40 = 0.56. As the
              Q
              approaches 1, a different design approach is needed, such as the notch filter design shown in
              Figure 14-17
              or
              Figure 14-19
              .
            








FIGURE 14-58








■




When the two cutoff frequencies are widely separated, we can realize wide-band bandpass and bandstop filters using a cascade or parallel connection of low-pass and high-pass filters. The design problem reduces to designing separate low-pass and high-pass filters and then connecting them in cascade or parallel to obtain the required overall response.









              Design
              Exercise 14-19

Develop Butterworth low-pass and high-pass transfer functions whose parallel connection produces a bandstop filter with cutoff frequencies at 2 and 800 rad/s, passband gains of 20 dB, and stopband gains less than-30 dB at 20 and 80 rad/s.


Answer:
















                APPLICATION
                EXAMPLE 14-15



              Biquad Filters,
              
6

              first suggested by J. Tow in 1968 in an
              IEEE Proceedings
              article, have the distinctive properties of being able to alter the circuit's gain
              K,
              critical frequency ω
              0
              , and
              Q
              independently by simply varying a particular resistor. The filter is pictured in
              Figure 14-59
              (a).
            








FIGURE 14-59









              The filter is adjusted in a particular manner. First the critical frequency ω
              0
              is adjusted, then the
              Q
              , and finally, the gain
              K
              . To demonstrate its performance, using Multisim, we did a frequency sweep of the circuit using four values (1 kΩ,4 kΩ, 15 kΩ, and 100 kΩ) of each of the three controlling resistors (
              R
1
, R
2
,
              and
              R
3
              ) to demonstrate the circuit's behavior. In all cases,
              C
1
              =
              C
2
              = 0.1 µF and
              R
4
              =
              R
5
              = 10 kΩ.
              Figure 14-59
              (b) shows how adjusting
              R
2
              alters the desired critical frequency.
              Figure 14-59
              (c) shows how adjusting
              R
1
              changes the
              Q
              of the filter, and
              Figure 14-59
              (d) demonstrates how changing
              R
3
              affects the gain.
            

              Also, if we take the output immediately after the first OP AMP, we obtain a bandpass filter rather than a low-pass filter.
              Figure 14-59
              (e) shows the output for both a bandpass and a low-pass filter from the same circuit.
            
The purpose of this Application Example on Biquad filters is not to study them in depth like those we already studied, but to demonstrate the rich variety of useful active and passive filters that have been developed and usefully applied.








FIGURE 14-59








■







Summary


            A filter design problem is defined by specifying attributes of the gain response such as a straight-line gain plot, cutoff frequency, passband gain, and stopband attenuation. The first step in the design process is to construct a transfer function
            T
            (
            s
            ) whose gain response meets the specification requirements.
          

            In the
            cascade design
            approach, the required transfer function is partitioned into a product of first- and second-order transfer functions, which can be independently realized using basic active
            RC
            building blocks.
          

            Transfer functions with real poles and zeros can be realized using the voltage divider, noninverting amplifier, or inverting amplifier building blocks. Transfer functions with complex poles can be realized using second-order active
            RC
            circuits.
          

            Transfer functions meeting low-pass filter specifications can be constructed using
            first-order cascade, Butterworth,
            or Chebyshev poles. First-order cascade filters are easy to design but have poor stopband performance. Butterworth responses produce
            maximally flat
            passband responses and more stopband attenuation than a first-order cascade with the same number of poles. The Chebyshev responses produce
            equal-ripple
            passband responses and more stopband attenuation than the Butterworth response with the same number of poles.
          

            Filter designers should also consider the transient or
            step response behavior
            of the filters they design. First-order cascade filters generally have better step response performance than either Butterworth or Chebyshev filters because the latter's complex poles give rise to ringing and an overshoot.
          

            A high-pass transfer function can be constructed from a low-pass prototype by replacing
            s
            with ω
            C
            /s. Bandpass (bandstop) filters can be constructed using a cascade (parallel) connection of a low-pass and a high-pass filter.
          

            There are many other types of active and passive filters,
            Biquad
            being a useful example of one.
          





Chapter 14
          Problems
        






              Objective Second-Order Filter Analysis (
              Sects. 14-1
              to
              14-3
              )
            

(a) Given a second-order filter circuit, find a specified transfer function.
(b) Given the transfer function of a second-order circuit, develop a method of selecting the element values to achieve specified filter characteristics.


              See
              Examples 14-1
              to
              14-5
              and
              Exercises 14-1
              to
              14-8
              .
            





14-1
            The transfer function of a second-order low-pass filter has the form
            



              Show by replacing s/ω
              0
              by ω
              0
              /s, you obtain a transfer function of a second-order high-pass filter.
            




14-2
            Interchanging the positions of the resistors and capacitors converts the low-pass filter in
            Figure 14-3
            (a) into the high-pass filter in
            Figure 14-9
            (a). This
            CR-RC
            interchange involves replacing
            R
k
            by 1/
            C
k
s
            and
            C
k
s
            by 1/
            R
k
            . Show that this interchange converts the low-pass transfer function in
            Eq. (14-6)
            into the high-pass function in
            Eq. (14-11)
            .
          




14-3
            Show that the circuit in
            Figure 14-17
            has the bandstop transfer function in
            Eq. (14-20)
            .
          




14-4
            Find the transfer function of the active filter in
            Figure P14-4
            . Then using
            R
1
            =
            R
2
            =
            R
3
            =20 kΩ,
            C
1
            = 0.3 µF, and
            C
2
            = 0.0333 µF, find the filter's type and roll-off, its cutoff frequency and its ζ. Use MATLAB to plot the filter's Bode diagram. Build and simulate your circuit in Multisim and compare the results with MATLAB's. Determine the location in rad/s and magnitude in dB of the peak in the frequency response.
            







FIGURE P14-4













14-5
            Find the transfer function of the active filter in
            Figure P14-5
            . Then using
            R
1
            = 10 kΩ,
            R
2
            = 40 kΩ, and
            C
1
            =
            C
2
            =0.05 µF, find the filter's type and roll-off, its cutoff frequency and its ζ. Use MATLAB to plot the filter's Bode diagram. Build and simulate your circuit in Multisim and compare the results with MATLAB's.
            







FIGURE P14-5












14-6
            For the filter in
            Figure P14-4
            , replace the three resistors with three capacitors, maintaining the same subscripts, and the two capacitors with two resistors, again maintaining the same subscripts. Show that the circuit's transfer function is
            




(a)
                Find the filter's type, its cutoff frequency and its ζ in terms of the
                R
                s and
                C
                s.
              

(b)
                Then using
                C
1
                =
                C
2
                =
                C
3
                = 0.2 µF,
                R
1
                = 3.33 kΩ and
                R
2
                = 7.5 kΩ, find the filter's type and roll-off, its cutoff frequency and its ζ. Use MATLAB to plot the filter's Bode diagram. Build and simulate your circuit in Multisim and compare the results with MATLAB's.
              







14-7

            The circuit in
            Figure 14-9
            (b) has a high-pass transfer function given in
            Eq. (14-11)
            and repeated below
            



              In
              Section 14-2
              , we developed
              equal-element
              and
              unity-gain
              design methods for this circuit. This problem explores an
              equal-time constant
              design method. Using
              R
1
C
1
              =
              R
2
C
2
              and µ = 2, develop a method of selecting values for
              C
1
, C
2
, R
1
,
              and
              R
2
              . Then select values so that the filter has a time constant of 1 µs and a ζ of 0.25. Use MATLAB to plot the filter's Bode diagram.
            





14-8
            Find the transfer function of the active filter in
            Figure P14-8
            . Then using
            R
1
            =
            R
2
            = 10 kΩ,
            R
3
            = 20 kΩ, and
            C
1
            =
            C
2
            = 001 µF, find the filter's type and roll-off, its cutoff frequency, and its ζ. Use MATLAB to plot the filter's Bode diagram. Build and simulate your circuit in Multisim and compare the results with MATLAB's. Determine the location in rad/s and magnitude in dB of the peak in the frequency response.
            







FIGURE P14-8













14-9



            Aircraft use 400 Hz power for electrical systems. However, sometimes the power radiates and affects some critical instruments. There is a need for a 400-Hz notch filter with a ζ = 1. A manufacturer offers the device shown in
            Figure P14-9
            and claims that by properly selecting
            R
            and
            C
            in the following transfer function one can notch any frequency.
            



              Select the values of
              R
              and
              C
              and run a MATLAB check of the transfer function and determine if the device works as promised.
            








FIGURE P14-9











14-10
            For the circuit in
            Figure P14-10
            find its transfer function. Then determine the circuit's gain and its pole-zero diagram. Is this a first- or second-order circuit? What would be the circuit's response if we selected
            R
1
            =
            R
2
            and
            C
1
            =
            C
2
            ?
            







FIGURE P14-10















              Objective 14-2 Second-Order Filter Design (
              Sects. 14-2
              and
              14-3
              )
            

(a) Construct a second-order transfer function with specified filter characteristics.
(b) Design a second-order circuit with specified filter characteristics.


              See
              Examples 14-2
              to
              14-4
              and
              Exercises 14-1
              to
              14-8
              .
            






14-11

            Design a second-order low-pass filter with a cutoff frequency of 2 krad/s, a ζ of 1, and a gain of 20. Use the unity-gain approach. Use Multisim to verify your design.
          




14-12

            Design a second-order high-pass filter with a cutoff frequency of 100 kHz, a ζ of 0.02, and a gain of 40 dB. Use the equal-element approach. Use Multisim to verify your design.
          





14-13


            The transfer functions of three different second-order low-pass filter design approaches shown in
            Figure P14-13
            are as follows:
            


The filter specifications are a cutoff frequency of 100 krad/s and a ζ of 0.2. Using Multisim, build your three designs and select the best one based on how well each meets the specs, the number of parts, and the gain.








FIGURE P14-13








              For Problems 14-14 to 14-17, construct second-order transfer functions that meet the following requirements. Use MATLAB
              
              to plot the transfer function's Bode diagram and validate the requirements.
            






Problem


Type



                        ω
                        0
                        (rad/s)
                      

ζ

|

T

(

J


                        ω
                        0
                        )|
                        dB



Constraints









14-14

Low pass
200,000
*
50
dc gain of 20 dB




14-15

High pass
2513
0.5

*

Infinite frequency gain of 200




14-16

Bandstop
200
0.001
*
pass-band gain of 20 dB






14-17

Bandpass
1000
20
*
pass-band gain of 40 dB




* Not specified.


              For Problems 14-18 to 14-25, design second-order active filters that meet the following requirements. Simulate your designs in Multisim to validate the requirements
            






Problem


Type



                        ω
                        0
                        (rad/s)
                      


ζ


Constraints








                        14-18
                        


Low pass
100 k
0.5
Use 10-kΩ resistors







                        14-19
                        


Low pass
50 k
1
dc gain of 60 dB





                        14-20
                        


High pass
10 k
0.2
Use 0.2-µF capacitors







                        14-21
                        


High pass
250
0.25
High-frequency gain of 6 dB





                        14-22
                        


Bandpass
20 k
*

B
                      = 2000 rad/s
                    







                        14-23
                        


Bandstop
1000
*

Q
                      = 20
                    





                        14-24
                        


Tuned
3.45 M
0.001
Use 200-pF capacitors







                        14-25
                        


Notch
314
0.01
Use 0.01-µF capacitors




* Not specified.








              Objective 14-3 Low-Pass Filter Design (
              Sects. 14-4
              and
              14-5
              )
            
Given a low-pass filter specification:

(a) Construct a transfer function that meets the specification.
(b) Design a cascade of first- and second-order circuits that implements a given transfer function.
(c) Select the best design from competitive filter approaches based on specified frequency and step response criteria.


              See
              Examples 14-6
              to
              14-9
              and
              Exercises 14-9
              to
              14-13
              .
            




          For Problems 14-26 to 14-29, construct the lowest-order transfer functions that meet the following low-pass filter specifications. Calculate the gain (in dB) of the transfer function at ω = ω
          C
          and ω
          MIN
          . Use MATLAB to validate that your transfer function meets the design specifications.
        





Problem
Pole Type

                  ω
                  C
                  (rad/s)
                

T
MAX
                  (dB)
                

                  ω
                  MIN
                  (rad/s)
                

T
MIN
                  (dB)
                






14-26

First-order cascade
5000
60
50 k
-20






14-27

Butterworth
2000
0
20 k
-100




14-28

Chebyshev
25 k
60
250 k
-80






14-29

Butterworth
60 k
10
120 k
-30







14-30

            Design an active low-pass filter to meet the specification in Problem 14-26. Use Multisim to verify that your design meets the specifications.
          





14-31

            Design an active low-pass filter to meet the specification in Problem 14-27. Use Multisim to verify that your design meets the specifications.
          




14-32


(a)
            Design an active low-pass filter to meet the specification in Problem 14-29. Use Multisim to verify that your design meets the specifications.
          

(b)
            Now design a Chebyshev filter to meet the same specification. Use Multisim to verify your design.
          

(c)
            Compare the designs and give pros and cons for each design.
          





14-33

            A low-pass filter is needed to suppress the harmonics in a periodic waveform with
            f
0
            = 1 kHz. The filter must have unity passband gain, less than-60 dB gain at the third harmonic, and less than-90 dB gain at the fifth harmonic. Since power is at a premium, choose a filter approach that minimizes the number of OP AMPs. Design a filter that meets these requirements. Verify your design using Multisim.
          




14-34

            Design a low-pass filter with 6 dB passband gain, a cutoff frequency of 2 krad/s, and a stopband gain of less than-14 dB at 6 krad/s. The filter must be most efficient in parts and power usage. It must not have an overshoot greater than 12%. Verify your design using MATLAB.
          





14-35

            Design a low-pass filter with 10 dB passband gain, a cutoff frequency of 10 kHz, and a stopband gain of less than-20 dB at 20 kHz. Overshoot is not a problem, but a low filter order, least number of parts, and a maximum of two OP AMPs are desired. Verify your design using Multisim.
          




14-36

            A pesky signal at 45 kHz is interfering with a desired signal at 20 kHz. A careful analysis suggests that reducing the interfering signal by 75 dB will eliminate the problem, provided the desired signal is not reduced by more than 3 dB. Design an active
            RC
            filter that meets these requirements. Verify your design using Multisim.
          





14-37

            A 50 kHz square wave must be bandwidth-limited by attenuating all harmonics after the third. Design a low-pass filter that attenuates the fifth harmonic and greater by at least
            
            20 dB. The fundamental and third harmonic should not be reduced by more than 3 dB, and the overshoot cannot exceed 13%.
          




14-38


            There is a need for a fifth-order low-pass Butterworth filter with a cutoff frequency of 100 rad/s to use in a medical instrumentation system with frequencies below 100 rad/s. However, there was no power available for the filter. A young engineer went to the library and found an old textbook on passive filter design.
            
6

            Curious, he found the filter shown in
            Figure P14-38
            that he felt could work.
            

                (
                a)
                The circuit is a prototype for a 1-rad/s response. The textbook states that one can scale the frequency of the circuit by:
                L
new
                =
                L
old
                /
                
                  k
                  f

                ,
                C
new
                =
                C
old
                /
                k

f

                , and
                R
old
                =
                R
new
                , where
                k

f

                is the increase in frequency. Find the circuit's transfer function.
              

(b)
                For a fifth-order Butterworth, the nominal values of the components are:
                L
1
                = 0.8944 H,
                L
2
                = 1.694 H,
                C
1
                = 0.3090 F,
                C
2
                = 1.382 F,
                C
3
                = 1.545 F, and
                R
1
                = 1 Ω. Modify the circuit for the 100 rad/s cutoff frequency. Then scale the components to more reasonable values using
                R
1
                = 100 Ω.
                Validate, or not, the engineer's research claim using Multisim.








FIGURE P14-38

















              Objective 14-4 High-Pass, Bandpass, and Bandstop Filter Design (
              Sects. 14-6
              and
              14-7
              )
            
Given a high-pass, bandpass, or bandstop filter specification:

(a) Construct a transfer function that meets the specification.
(b) Design a cascade or parallel connection of first- and second-order circuits that implements a given transfer function.
(c) Select the best design from competitive filter approaches based on specified frequency and step response criteria.


              See
              Examples 14-10
              to
              14-14
              and
              Exercises 14-14
              to
              14-19
              .
            




          Construct the lowest order, high-pass transfer functions that meet the following filter specifications. Calculate the gain (in dB) of the transfer function at ω = ω
          C
          and ω
          MIN
          . Use MATLAB to validate that your transfer function meets the design specifications.
        






Problem


Pole Type



                    ω
                    C
                    (rad/s)
                  



T
MAX
                    (dB)
                  



                    ω
                    MIN
                    (rad/s)
                  



T
MIN
                    (dB)
                  









14-39

First-order cascade
200 k
20
10 k
-50




14-40

Butterworth
100 k
40
10 k
-30






14-41

Chebyshev
100 k
0
10 k
-100




14-42

You Decide
100 k
10
20 k
-50








14-43

            Design an active high-pass filter to meet the specification in Problem 14-39. Use Multisim to verify that your design meets the specifications.
          




14-44

            Design an active high-pass filter to meet the specification in Problem 14-40. Use Multisim to verify that your design meets the specifications.
          





14-45


            Consider the specifications given in Problem 14-42.
            

(a)
                Design an active Butterworth filter to meet the specification.
              

(b)
                Design an active Chebyshev filter to meet the specification.
              

(c)
                Use Multisim to verify that both your designs meet the specifications.
              

(d)
                Comment on the pros and cons of each design.
              






14-46

            A certain instrumentation system for a new hybrid car needs a bandpass filter to limit its output bandwidth prior to digitization. The filter must meet the following specifications:
            



              Two vendors have submitted proposed solutions in the form of Multisim graphics, shown in
              Figure P14-46
              . As the requirements engineer on the project, you need to select the best one. You must check whether each circuit meets or fails every specification. You should also consider (1) parts count, (2) ease of maintainability and implementation (fewer parts, number of similar parts, adjustments of potentiometers, standard values), (3) frequency-domain response, and (4) cost. You should address each item for each design at least qualitatively. Attach whatever software output you think will support your decision.
            








FIGURE P14-46













14-47


            You are working at an aircraft manufacturing plant on an altitude sensor that eventually will be used to retrofit dozens of similar sensors on an upgrade to a current airframe. You are required to find a quality notch filter to eliminate an undesirable interference at 400 Hz. You find a vendor and ask for a suitable product specification and a bid.
            The specifications you require are as follows:

1.
Must block signals at
              400 Hz
              ±
              2% Hz
            

2.
Passband gain should be
              0dB ± 1 dB
            

3.
Bandwidth should be
              20 Hz ±5% Hz
            

              The vendor's proposal, shown as a Multisim drawing in
              Figure P14-47
              , claims to meet all of the design requirements. Determine if it passes all of the stated requirements. Then explain if you would buy the filter and why or why not?
            








FIGURE P14-47












14-48

            An amplified portion of the radio spectrum is shown in
            Figure P14-48
            . You need to hear all of the signals from 1.0 to 2.0 MHz, but there is an interfering signal at 1.8 MHz. Design a notch filter to reduce that signal by at least 50 dB and not reduce the desired signal at 1.7 MHz by more than 6 dB. Use Multisim to validate your design.
            







FIGURE P14-48













14-49

            The portion of the radio spectrum known as the AM broadcast band ranges from 540 kHz to 1700 kHz. You want to design a suitable filter and amplifier. The passband gain desired is 80 dB and the "shoulders" of your filter should have a roll-off of-100 dB per decade. Design a wide-band filter and amplifier that is flat in the passband and has an upper cutoff frequency of 1.7 MHz and as lower cutoff frequency of 540 kHz and meets all of these criteria. Use Multisim to validate your design.
          



Integrating Problems



14-50


            Bessel Filter
            
              Bessel filters are in the category of maximally flat filters similar to Butterworth but have a critically damped time-domain
              
              response similar to a First-Order Cascade filter. Bessel filters have a linear phase response over the filter's passband, which makes them useful in audio applications.
              Figure P14-50
              shows a fourth-order Bessel filter with a 20-kHz cutoff and a 0-dB passband gain. Design a fourth-order First-Order Cascade and a fourth-order Butterworth filter with the same cutoff frequency and gain. Compare the frequency and time responses of the three filters and comment on their strengths and weaknesses.
            








FIGURE P14-50












14-51

            Design Evaluation and Improvement
            
              You are the head engineer for a small start-up and a client asked for a filter with the following specifications: a third-order Butterworth low-pass filter with a cutoff frequency of 2 krad/s and a dc gain of 0 dB. Three of your junior engineers were tasked to design the product that your company will manufacture. Their designs are shown in
              Figure P14-51
              . Which would you select and why? Of important consideration is performance, number of parts, fewer distinct parts, fewer non-standard parts, power usage, and anything else that would win your company the contract.
            








FIGURE P14-51











14-52

            Modifying an Existing Circuit
            
              One of your company's products includes the passive
              RLC
              filter and OP AMP buffer circuit in
              Figure P14-52
              . The supplier of the inductor is no longer in business and a suitable replacement is not available, even on
              eBay,
              Amazon, or
              Craig's List.
              You have been asked to design a suitable inductorless replacement. To minimize production changes, your design must use the existing OP AMP as is and either the 1-kΩ resistor or the 0.1 µF capacitor or both, if possible.
            








FIGURE P14-52











14-53


            What's a High-Pass Filter
            
              Ten years after earning a BSEE, you return for a master's degree and sign on as the laboratory instructor for the basic circuit analysis course. One experiment asks the students to build the active filter in
              Figure P14-53
              and measure its gain response over the
              
              range from 150 Hz to 15 kHz. The lab instructions say the circuit is a high-pass filter with ω
              0
              = 10 krad/s and an infinite frequency gain of 0 dB. Everything goes well until a student, intrigued by the concept of infinite frequency, inputs 1 MHz and measures a gain of only 0.7. The student then inputs 2 MHz and measures a gain of 0.45. The high-pass filter appears to be a bandpass filter! Motivated by an insatiable thirst for understanding, the student asks you for an explanation. You first check the student's circuit and find it to be correct. You next replace the OP AMP and get almost the same results. Desperate for an explanation (your credibility is on the line here), you read the course textbook (it is Thomas, Rosa, and Toussaint) and find the answer in
              Chapter 12
              (Examples 12-5 and 12-7). What do you tell the student?
            








FIGURE P14-53











14-54

            Bandpass to Bandstop Transformation
            
              The three-terminal circuit in
              Figure P14-54
              (a) has a bandpass transfer function of the form
            








FIGURE P14-54








              Show that the circuit in
              Figure P14-54
              (b) has a bandstop transfer function of the form
            



That is, show that interchanging the input and ground terminals changes a unity-gain bandpass circuit into a unity-gain bandstop circuit.





14-55


            Third-Order Butterworth Circuit
            
              Show that the circuit in
              Figure P14-55
              produces a third-order Butterworth low-pass filter with a cutoff frequency of ω
              C
              = 1/
              RC
              and a passband gain of
              K
              = 4. Then, design a third-order Butterworth low-pass filter using the filter in
              Figure P14-55
              with a cutoff frequency of 20 krad/s. Verify your design using Multisim.
            








FIGURE P14-55












14-56



            Biquad Filter Design
            
              A biquad filter has the unique properties of having the ability to alter the filter's parameters, namely, gain
              K,
              quality factor
              Q,
              and resonant frequency ω
              0
              . This is done in each case by simply adjusting one of the circuit's resistors. Furthermore, adjusting any of the three parameters leaves the others unchanged. Derive the transfer function for the biquad circuit in
              Figure P14-56
              and determine which resistors influence each parameter. Show from the transfer function how you can adjust three resistors in a specific order to set all three parameters. Then design a biquad filter with an ω
              0
              = 1 krad/s, a
              Q
              of 10, and a
              K
              of-5. Verify your design using Multisim.
            








FIGURE P14-56












14-57

            Crystal Filters
            
              Although not an active filter, crystal (Quartz) filters are very high
              -Q
              filters. Some can have
              Q
              's approaching 100,000. High
              Q
              means high selectivity; hence, crystal filters are used extensively in communications where fine-tuning is essential. In its simplest form, a quartz crystal is a rectangular cut crystal with metal plates attached to its flattest sides—imagine a parallel-plate capacitor with the crystal as the dielectric. An electronic equivalent of a quartz filter is shown in
              Figure P14-57
              .
              C
              O is called the shunt capacitance, and
              C
1
, L
1
              , and
              R
1
              are the mechanical
              
              capacitance, inductance, and resistance of the crystal, respectively. A particular crystal has
              C
O
              = 1.2 pF,
              C
1
              = 2.3 fF,
              L
1
              = 6.2 mH, and
              R
1
              = 32 Ω. Assume
              R
L
              = 10 Ω. Analyze this filter and determine its
              Q
              and ω
              0
              . Use MATLAB or Multisim to examine this circuit and help calculate the requested parameters.
            








FIGURE P14-57












            14-58
            

            Amateur Satellite Frequency Band Butterworth Filter Design
            A scientist has a need for a bandpass filter for an Amateur Satellite band in the HF frequency band. It must have a center frequency of 89.4 Mrad/s and a 32 Mrad/s bandwidth. It must have a-85 dB per decade roll-off on both shoulders to avoid interference with other nearby users and a center frequency gain of 20 dB. Design a cascaded Butterworth bandpass filter. Use MATLAB to prove your results.







Notes





1

            Both circuits belong to a family of circuits originally proposed by R. P. Sallen and E. L. Key in "A Practical Method of Designing
            RC
            Active Filters, "
            IRE Transactions on Circuit Theory,
            Vol. CT-2, pp. 74-85, 1955. Sallen and Key were working at the MIT, Lincoln Labs in Cambridge MA at the time. In 1955 the controlled sources were designed using vacuum tubes.
          


2

            For an extensive discussion of the multiple-feedback family, see Wai-Kai Chen, Ed.,
            The Circuits and Filters Handbook,
            CRC Press, 1995, Chapter 76, pp. 2372 ff. The bandpass circuit in
            Figure 14-14
            is sometimes called the Delyannis-Friend circuit. See M. E. Van Valkenburg,
            Analog Filter Design,
            Holt, Rinehart & Winston, Inc, 1982, p. 203.
          


3

            For addition information on filter design see "Linear Circuit Design Handbook", Analog Devices Engineering Staff,
            Chapter 8
            Analog Filter, Elservier, 2008. Or "Analog Filter Design" M.E. Van Valkenburg, Holt, Rinehart and Winston, 1982.
          


4

            In this text, we use a ripple of 3 dB; however, there are other ripples that can be used. Chebyshev polynomials can be derived for any ripple, with 0.1, 1, 3, and 6 dB being the most common.
          


5

            It can be shown that at ω = ω
            C
            the slope of a Chebyshev gain is
            n
            times as steep as a Butterworth gain. See Aram Budak,
            Passive and Active Network Analysis and Synthesis,
            Houghton Mifflin, 1974, p. 516.
          


6

"Analog Filter Design"
            M.E. Van Valkenburg, Holt, Rinehart and Winston, 1982, Chapter 5.2, 5.3, 5.4.
          















CHAPTER 15

MUTUAL INDUCTANCE AND TRANSFORMERS





From the foregoing facts, it appears that a current of electricity is produced, for an instant, in a helix of copper wire surrounding a piece of soft iron whenever magnetism is induced in the iron; also that an instantaneous current in one or the other direction accompanies every change in the magnetic intensity of the iron.


          Joseph Henry, 1831,
          
          American Physicist
        








Some History Behind This Chapter
The discovery of electromagnetic induction led Michael Faraday to wind two separate insulated wires around an iron ring. One winding was connected to a battery via a switch and the other to a galvanometer. He observed that the current in the first winding did indeed induce a current in the second, but only during the instant when the switch was opened or closed. From this, he correctly deduced that it was the change in current that produced the inductive effect. Faraday's coils and iron ring were actually a crude transformer. In 1876, Lucien Gaulard and John Gibbs, respectively, from France and England, devised a transformer and secondary generator in England that revolutionized ac power. In 1886, William Stanley created a practical ac transformer based on Gaulard's invention. American George Westinghouse bought Gaulard's invention and competed the ac system against Thomas Edison's dc approach to determine which would deliver electrical power from Niagara Fall's hydroelectric station to New York City. Westinghouse's system won and the United States based its electric grids on ac. Eventually, the whole world adopted the ac standard.









Why This Chapter Is Important Today
Coupled coils are found in applications such as electric power distribution systems, communications, wireless smartphone, and electric vehicle charging systems, magnetic-levitation trains, and high-quality audio. In this chapter, you will learn how to model the magnetic coupling between coils using the concept of mutual inductance. This concept leads to a new circuit element called a transformer, which provides impedance matching, electrical isolation, and changes in the voltage level in power systems. The large power transformers used in such systems are very efficient, with internal losses often less than 1%.









Chapter Sections



15-1 Coupled Inductors






15-2 The Dot Convention






15-3 Energy Analysis






15-4 The Ideal Transformer






15-5 Linear Transformers












Chapter Learning Objectives

15-1
              Mutual Inductance (
              Sects. 15-1
              to
              15-3
              )
            
Given the current through or voltage across two coupled inductors, find other currents or voltages.

15-2
              The Ideal Transformer (
              Sect. 15-4
              ) Given a circuit containing ideal transformers:
            

(a) Find specified voltages, currents, powers, and equivalent circuits.
(b) Select the turns ratio to meet prescribed conditions.


15-3
              Linear Transformers (
              Sect. 15-5
              )
            
Given a linear circuit with a transformer operating in the sinusoidal steady-state, find phasor voltages and currents, average powers, and equivalent impedances.




15-1 Coupled Inductors


          The
          i-υ
          characteristic of the inductor results from the magnetic field produced by current through a coil of wire. A non-varying or dc current produces a constant magnetic field or flux ϕ that emanates from the wire and forms closed loops of magnetic flux lines in and around the vicinity of the inductor. If, for example, one takes a battery (dc) and connects a wire to its terminals and wraps the wire around a nail, the nail will become magnetized by the flux enabling it to pick up other ferrous items. In contrast, a changing or ac current causes these closed loops of magnetic flux lines to expand and contract with the frequency of the current, thereby "cutting" the turns in the winding that makes up the inductor. Faraday's law states that voltage across the inductor is equal to the time rate of change of the total flux linkage X. In
          Chapter 6
          , we expressed this relationship between a time-varying current and an induced voltage in terms of a circuit parameter called inductance
          L.


          Now suppose that a second inductor is brought close to the first so that the flux from the first inductor links with the turns of the second inductor. If the current in the first inductor is changing, then this flux linkage will generate a voltage in the second inductor. The magnetic coupling between the changing current in one inductor and the voltage generated in a second inductor produces
          mutual inductance.



I - υ
            Characteristics
          

            The
            i-υ
            characteristics of coupled inductors unavoidably involve describing the effects observed in one inductor due to causes occurring in the other. We will use a double-subscript notation because it clearly identifies the various cause-and-effect relationships. The first subscript indicates the inductor in which the effect takes place, and the second identifies the inductor in which the cause occurs. For example,
            υ
12
            (
            t
            ) is the voltage across inductor 1 due to causes occurring in inductor 2, whereas
            υ
11
            (
            t
            ) is the voltage across inductor 1 due to causes occurring in inductor 1 itself.
          

            We begin by assuming that the inductors are far apart, as shown in
            Figure 15-1
            (a). Under these circumstances, there is no magnetic coupling between the two. A current
            i
1
            (
            t
            ) passes through the
            N
1
            turns of the first inductor and
            i
2
            (
            t
            ) through
            N
2
            turns in the second. Each inductor produces a flux
          



(15-1)





            where
            k
1
            and
            k
2
            are proportionality constants. The flux linkage in each inductor is proportional to the number of turns:
          


(15-2)




            By Faraday's law, the voltage across an inductor is equal to the time rate of change of the flux linkage. Using
            Eqs. (15-1)
            and
            (15-2)
            together with the relationship between voltage and time rate of change of flux linkage gives
          


(15-3)




Equation (15-3)
            provides the
            i-υ
            relationships for the inductors when there is no mutual coupling. These results are the same as previously found in
            Chapter 6
            .
          

            Now suppose that the inductors are brought close together so that part of the flux produced by each inductor intercepts the other, as indicated in
            Figure 15-1
            (b). That is, part (but not necessarily all) of the fluxes ϕ
            1
            (
            t
            )  and ϕ
            2
            (
            t
            ) in
            Eq. (15-1)
            intercept
            
            the opposite inductor. We describe the cross coupling using the double-subscript notation:
          







FIGURE 15-1



(a) Inductors separated, only self-inductance present. (b) Inductors coupled, both self- and mutual inductance present.





(15-4)




            The quantity ϕ
            12
            (
            t
            ) is the flux intercepting inductor 1 due to the current in inductor 2, and ϕ
            21
            (
            t
            ) is the flux intercepting inductor 2 due to the current in inductor 1. The total flux linkage in each inductor is proportional to the number of turns:
          


(15-5)




            By Faraday's law, the voltage across a winding is equal to the time rate of change of the flux linkage. Using
            Eqs. (15-4)
            and
            (15-5)
            together with derivative relationship, the time rate of change of flux linkages and voltages gives
          



(15-6)





            The expressions in
            Eq. (15-6)
            are the
            i-υ
            relationships describing the cross coupling between inductors when there is mutual coupling.
          

            When the magnetic medium supporting the fluxes is linear, the superposition principle applies, and the total voltage across the inductors is the sum of the results in
            Eqs. (15-3)
            and
            (15-6)
            :
          



(15-7)




We can identify four inductance parameters in these equations:



(15-8)




and



(15-9)





            The two inductance parameters in
            Eq. (15-8)
            are the
            self-inductance
            of the inductors. The two parameters in
            Eq. (15-9)
            are the
            mutual inductances
            between the two inductors. In a linear magnetic medium,
            k
12
            =
            k
21
            =
            k
M
            . As a result, we can define a single mutual inductance parameter
            M
            as
          


(15-10)




            Using the definitions in
            Eqs. (15-8)
            and
            (15-10)
            , the
            i-υ
            characteristics of two coupled inductors are
          



(15-11)





            Coupled inductors involve three inductance parameters, the two self-inductances
            L
1
            and
            L
2
            and the mutual inductance
            M.


            The preceding development assumes that the cross coupling is additive. Additive coupling means that a positive rate of change of current in inductor 2 induces a
            
            positive voltage in inductor 1, and vice versa. The additive assumption produces the positive sign on the mutual inductance terms in
            Eq. (15-11)
            . Unhappily, it is possible for a positive rate of change of current in one inductor to induce a negative voltage in the other. To account for additive and subtractive coupling, the general form of the coupled inductor
            i-υ
            characteristics includes a ± sign on the mutual inductance terms:
          



(15-12)




When applying these element equations, it is necessary to know when to use a plus sign and when to use a minus sign.



15-2 The Dot Convention

          The parameter
          M
          is positive, so the question is: Whatsign should be placed in front of this positive parameter in the
          i-υ
          relationships in
          Eq. (15-12)
          ? The correct sign depends on two things: (1) the spatial orientation of the two windings and (2) the reference marks given to the currents and voltages.
        

Figure 15-2
          shows the additive and subtractive spatial orientation of two coupled inductors. In eithercase, the direction ofthe flux produced by a currentis found using the right-hand rule treated in physics courses. In the additive case, currents
          i
1
          and
          
            i
            2

          both produce clockwise fluxes ϕ
          1
          and ϕ
          2
          . In the subtractive case, the currents produce opposing fluxes because ϕ
          1
          is clockwise and ϕ
          2
          is counterclockwise. The sign for the mutual inductance term is positive for the additive orientation and negative for the subtractive case.
        







FIGURE 15-2



Winding orientations and corresponding reference dots.




          In general, it is awkward to show the spatial features ofthe windings in circuit diagrams. The dots shown near one terminal of each winding in
          Figure 15-2
          are special reference marks indicating the relative orientation of the windings. The reference directions for the currents and voltages are arbitrary. They can be changed as long as we follow the passive sign convention. However, the dots indicate physical attributes of the windings that make up the coupled inductors. They are not arbitrary. They cannot be changed.
        

          The correct sign for the mutual inductance term hinges on how the reference marks for currents and voltages are assigned relative to the dots. For a given winding orientation,
          Figure 15-3
          shows all four possible current and voltage reference assignments under the passive sign convention. In cases A and B, the fluxes are additive, so the mutual inductance term is positive. In cases C and D, the fluxes are subtractive and the mutual inductance term is negative. From these results, we derive the following rule:
        







FIGURE 15-3



All possible current and voltage reference marks for a fixed winding orientation.





          Because the current reference directions can be changed, a corollary of this rule is that we can always assign reference directions so that the positive sign applies to the mutual inductance. This corollary is important because a positive sign is built into the mutual inductance models in circuit analysis programs like Multisim.
        

          The following examples and exercises illustrate selecting the correct sign and applying the
          i-υ
          characteristics in
          Eq. (15-12)
          .
        













EXAMPLE 15-1



                  For the coupled inductors in
                  Figure 15-4(a)
                  :
                


                    (a)  Write the
                    i-υ
                    characteristics using the reference marks shown in the figure.
                  

                    (b)  For
                    υ
S
                    (
                    t
                    ) = 200 sin 400
                    t
                    V, find
                    υ
2
                    (
                    t
                    ) and
                    i
1
                    (
                    t
                    ) when the output terminals are open-circuited (
                    i
2
                    = 0).
                  
(c)  Verify your answers using Multisim.










FIGURE 15-4








SOLUTION:




                (a)  The two current references directions both point toward the dotted terminals. Therefore, the mutual inductance is additive and the
                i-υ
                equations are
                








                (b)  For
                υ
1
                (
                t
                ) =
                υ
S
                (
                t
                ) = 200 sin 400
                t
                and
                i
2
                (
                i
                ) = 0, these equations reduce to
                







                      Solving the first equation for
                      di
1
                      (
                      t
                      )/
                      dt
                      yields
                    







Substituting this result in the second equation produces








                      To find
                      i
1
                      (
                      t
                      ), we need to solve the following equation:
                    









                (c)  We can solve the same problem using Multisim. We build the coupled coils using the "Coupled_Inductors" found under "Transformers" in the "Basic" library. The Multisim model requires that one knows the coupling coefficient,
                k
                . In this problem,
                k
                is given; however, it can be calculated from
                Eq. (15-22)
                covered in the next
                
                section. Note that
                υ
2
                (
                t
                ) has to be calculated as "V(2)-V(3)" from the diagram in
                Figure 15-4(b)
                since the transformer's output is not connected to ground. Also note that a very tiny resistor has to be placed in series with the source to allow Multisim to avoid an "Inductor-voltage source loop" since inductors are short circuits during the DC bias point calculation.
              








FIGURE 15-4






Asking Multisim to perform a Single Frequency AC Analysis yields the following output:



Single Frequency AC Analysis @ 63.66 Hz


Variable
Frequency (Hz)Magnitude
Phase (deg)




v(2)-v(3)
63.66 40
-9.568e-11


i(r2)
63.66 50
-90



    
              From the table, the voltage  
              υ
2 
              (   
              t   
              ) = 40 sin(63.66 × 2π   
              t  
              ) = 40 sin(400
              t
              ) V. Note that the phase is essentially zero. The current is
              i
1
              (
              t
              ) = 50 sin(400
              t
              - 90°) or -50 cos (400
              t
              ) A. These are the same answers as calculated above.
              ■















Exercise 15-1



              In
              Figure 15-4(a)
              ,
              i
1
              (
              t
              ) = -20 cos 8000
              t
              mA and
              i
2
              (
              t
              ) = 0. Find
              υ
1
              (
              t
              ) and
              υ
2
              (
              t
              ). Validate in Multisim.
            







FIGURE 15-4








Answers:



υ
1
              (
              t
              ) = 1.6 sin 8000
              t
              V;
              υ
2
              (
              t
              ) = 0.32 sin 8000
              t
              V. See
              Figure 15-4(c)
              and Table.
            



Single Frequency AC Analysis @ 1273.2 Hz


Variable
Frequency (Hz)
Magnitude (V)
Phase (deg)




v(1)
1273.2
0.320
0


v(2)-v(3)
1273.2
1.6
0

















EXAMPLE 15-2


                  For the coupled inductors in
                  Figure 15-5(a)
                  :
                


                    (a)  Write the
                    i-υ
                    characteristics using the reference marks shown in the figure.
                  

                    (b)  For
                    i
S
                    (
                    t
                    ) = 2cos500
                    t
                    A, find
                    υ
1
                    (
                    t
                    ) and
                    i
2
                    (
                    t
                    ) when the output terminals are short-circuited (
                    υ
2
                    (
                    t
                    ) = 0).
                  
(c)  Simulate the responses using Multisim.










FIGURE 15-5








SOLUTION:




                (a)  The
                i
1
                (
                t
                ) reference points toward and the
                i
2
                (
                t
                ) reference points away from the dotted terminals, so the mutual inductance is subtractive and the
                i-υ
                equations are
                









                (b)  For
                i
1
                (
                t
                ) =
                i
S
                (
                t
                ) = 2 cos 500
                t
                and
                υ
2
                (
                t
                ) = 0, these equations reduce to
                







                      Solving the second equation for
                      di
2
                      /
                      dt
                      yields
                    







or







Substituting this result in the first equation produces









                (c) Using coupled coils in Multisim requires knowing
                k,
                the coupling coefficient. Since
                k
                was not provided, we calculated it from
                Eq. (15-22)
                as 0.9798. We will explain this equation shortly. Using Multisim to simulate the short circuit output requires the use of a small resistor. However, where we were able to use a 1-pΩ resistor to eliminate the "Inductor-voltage source loop" during the dc bias-point calculation, a somewhat larger resistor needs to be used across the output of the coupled coils. A 10-πΩ resistor (R2) worked. Note that since we were driving the circuit with a current source, there was no need to use the small resistor in the input loop. Note also that sources in Multisim default to sine waves and since our input is a cosine, we need to add 90° to our source
                Figure 15-5(b)
                . And since the output current
                i
2
                (
                t
                ) is into the transformer at the top, we need to use -I(R2) to obtain the correct sign. Multisim returns -I(R2) as 1.6 cos (500
                t
                + 90°) V, which equals 1.6 sin 500
                t
                V. Finally, the voltage V(1) is returned as a 2-V sine with a 180° phase shift which is the same as our hand calculations of -2 sin 500
                t
                V.
              








FIGURE 15-5









Single Frequency AC Analysis @ 79.577 Hz


Variable
Frequency (Hz)
Magnitude (V)
Phase (deg)




v(1)
79.577
2.0
180


-i(r2)
79.577
1.6
90




■














Exercise 15-2


              Find
              υ
1
              (
              t
              ) and
              υ
2
              (
              t
              ) for the circuit in
              Figure 15-6(a)
              . Then using superposition, verify your answers using Multisim.
            







FIGURE 15-6






Answers:

υ
1
              (
              t
              ) = -10 sin 10
              4
t
              -3 cos 5 × 10
              3
t
              V
            

υ
2
              (
              t
              ) = -15 sin 10
              4
t
              -5 cos 5 × 10
              3
t
              V
            

              See
              Figure 15-6(b)
              and the resulting table.
            







FIGURE 15-6















              APPLICATION
              EXAMPLE 15-3

Wireless Energy Transmission


              In the late 1800s, Nikola Tesla, pioneered the ability to transmit electricity through the airby creating a magneticfield between two inductive circuits, a transmitterand a receiver. He demonstrated his invention called the Tesla coil in 1897 by lighting up phosphorescent and incandescentbulbs wirelessly. Butonly recentlyhas this technology begun to flourish.
              Inductive coupling
              can be used to charge devices, like cell phones, the energy receiver, without a hard-wire connection. In order for this to occur, the device to be charged must have an inductor coil built in to it and lie close, usually less than 1.5 cm, to the transmitter. The charging station, the energy transmitter, has a similar coil built-in. The transmitter coil usually is powered by an external power source. The receiver coil is generally wound flat in one or two layers 1.2 cm to 3.8 cm in diameter and resulting in an inductance ranging from 2.5 to 50 μH, depending on the application. The transmitter, generally can be heftier, handling more current. While still flat, the coil is one or more layers thick and depending on the application, can be 5.0 cm or more in diameter with inductances of 3.0 mH or larger. Coupling coefficients unfortunately are low, about
              k
              = 0.2 for sitting on the charger and smaller values as one moves away from the charging surface. The amount of power transmitted varies from 5 W (slow charging) to 30 W (fast charging) for cell-phone chargers. In spite of the convenience of wireless charging, this technique currently is slower than equivalent direct plug-in charging. An exploded view of a cell-phone charging system is shown in
              Figure 15-7
              .
            







FIGURE 15-7







              Some new types of chargers use
              resonant inductive coupling
              and have evolved as a better alternative to simple inductive coupling. In this technology, the inductor is
              
              coupled with a capacitor and allows for energy transmission at a greater distance using resonance. There are several standards for resonant inductive coupling systems, the one most employed by cell-phone manufacturers is called Qi (pronounced "chee"). There is a considerable amount of research in extending the range and the amount of power that can be transmitted, especially for fast charging of electric vehicles. One concept is to place transmitter coil pads in the garage or even bury them in the center of roadways with the receiver coil in the bottom of the vehicle.
            




15-3 Energy Analysis

          Calculating the total energy stored in a pair of coupled inductors reveals a fundamental limitation on allowable values of the self- and mutual inductances. To uncover this limitation, we first calculate the total power absorbed. Multiplying the first equation in
          Eq. (15-12)
          by
          i
1
          (
          t
          ) and the second equation by
          i
2
          (
          t
          ) produces
        


(15-13)




          The quantities
          p
1
          (
          t
          ) and
          p
2
          (
          t
          ) are the powers absorbed with inductors 1 and 2. The total power is the sum of the individual inductor powers:
        



(15-14)





          Each of the bracketed terms in
          Eq. (15-14)
          is a perfect derivative. Specifically,
        


(15-15)




          Therefore, the total power in
          Eq. (15-14)
          is
        



(15-16)





          Because power is the time rate of change of energy, the quantity inside the brackets in
          Eq. (15-16)
          is the total energy stored in the two inductors. That is,
        



(15-17)





          In
          Eq. (15-17)
          , the self-inductance terms are always positive. However, the mutual inductance term can be either positive or negative. At first glance, it appears that the total energy could be negative. But the total energy must be positive; otherwise, the coupled inductors could deliver net energy to the rest of the circuit which is not a physical possibility.
        


          The condition
          w
          (
          t
          ) ≥ 0 places a constraint on the values of the self- and mutual inductances. First, if
          i
2
          (
          t
          ) = 0, then
          w
          (
          t
          ) ≥ 0 in
          Eq. (15-17)
          requires
          L
1
          > 0. Next, if
          i
1
          (
          t
          ) = 0, then
          w
          (
          t
          ) ≥ 0 in
          Eq. (15-17)
          requires
          L
2
          > 0. Finally, if
          i
1
          (
          t
          ) ≠ 0 and
          i
2
          (
          t
          ) ≠ 0, then we divide
          Eq. (15-17)
          by [
          i
2
          (
          t
          )]
          2
          and define a variable
          x
          =
          i
1
          /
          i
2
          . With these changes, the energy constraint
          w
          (
          t
          ) > 0 becomes
        



(15-18)





          The minimum value of
          f
          (
          x
          ) occurs when
        


(15-19)




          The value
          x
min
          yields the minimum of
          f
          (
          x
          ) because the second derivative of
          f
          (
          x
          ) is positive. Substituting
          x
min
          back into
          Eq. (15-18)
          yields the condition
        



(15-20)





          The constraint in
          Eq. (15-20)
          means that the stored energy in a pair of coupled inductors is positive if
        



(15-21)




Energy considerations dictate that in any pair of coupled inductors, the product of the self-inductances must exceed the square of the mutual inductance.

          The constraint in
          Eq. (15-21)
          is usually written in terms ofa new parameter called the
          coupling coefficient
k
          .
          

Note:


          This "
          k
          " is not the proportionality constants
          ks
          introduced in Eqs. (15-1) and (15-4). Those ks are included as part of the inductance,
          L
          or
          M.




(15-22)





          The parameter
          k
          ranges from 0 to 1. If
          M
          = 0, then
          k
          = 0 and the coupling between the inductors is zero. The condition
          k
          = 1 requires
          perfect coupling
          in which all of the flux produced by one inductor links the other. Perfect coupling is physically impossible, although careful design can produce coupling coefficients of 0.99 and higher.
        












EXAMPLE 15-4



                  A pair of coupled inductors have self-inductances
                  L
1
                  = 2.5 H,
                  L
2
                  = 16 H, and a coupling coefficient of
                  k
                  = 0.8. When the terminals of
                  L
2
                  are short-circuited (
                  υ
2
                  (
                  t
                  ) = 0) the short-circuit current is observed to be
                  i
2
                  (
                  t
                  ) = -50sin(2000
                  t
                  ) mA. Find the input voltage
                  υ
1
                  (
                  t
                  ) for additive coupling.
                




SOLUTION:


The given self-inductances and coupling coefficient yield the mutual inductance as




              For additive coupling, the
              i-υ
              equations are
            





              For
              υ
2
              (
              t
              ) = 0 and
              i
2
              (
              t
              ) = -50 × 10
              -3
              sin 2000
              t
              , these equations reduce to
            




              Solving the second equation for
              di
1
              (
              t
              )/
              dt
              yields
            



Substituting this result into the first equation produces


■














Exercise 15-3



              A pair of coupled inductors have self-inductances
              L
1
              = 4.5 mH and
              L
2
              = 8 mH. What is the maximum possible mutual inductance?
            


Answer:



M
              = 6 mH
            




15-4 The Ideal Transformer

          A
          transformer
          is an electrical machine
          
1

          that utilizes magnetic coupling between two inductors. Transformers find application in virtually every type of electrical system, but especially in power supplies and commercial power grids. Some example devices from these applications are shown in
          Figure 15-8
          .
        







FIGURE 15-8



Photos of transformers: (a) Typical powerline distribution (step-down) transformer. (b) Large power (step-up) transformer. (c) Common iron-core (step-up or step-down) transformer.




          In
          Figure 15-9
          , the transformer is shown as an interface device between a source and a load. The winding connected to the source is called the
          primary winding
          ,and the one connected to the load is called the
          secondary winding.
          In most applications, the transformer is a coupling device that transfers signals (especially power) from the source to the load. The basic purpose of the device is to change voltage and current levels so that the conditions at the source and load are compatible.
        







FIGURE 15-9



Transformer connected at a source-load interface.




          Transformer design involves two primary goals: (1) to maximize the magnetic coupling between the two windings and (2) to minimize the power loss in the windings. The first goal produces nearly perfect coupling (
          k
          ≈ 1) so that almost all of the flux in one winding links the other. The second goal produces nearly zero power loss so that almost all of the power delivered to the primary winding transfers to the load. The
          ideal transformer
          is a circuit element in which coupled inductors are assumed to have
          
perfect coupling

          and
          
zero power loss.

          Using these two idealizations, we can derive the
          i-υ
          characteristics of an ideal transformer.
        

Perfect Coupling


Perfect coupling

            means that all of the flux in the first winding links the second, and vice versa. Equation (15-1) defines the total flux in each winding as
            
            where
            k
1
            and
            k
2
            are proportionality constants. Equation (15-4) defines the cross coupling using the double subscript notation:
          


(15-23)





(15-24)




            In this equation, ϕ
            12
            (
            t
            ) is the flux intercepting winding 1 due to the current in winding 2, and ϕ
            21
            (
            t
            ) is the flux intercepting winding 2 due to the current in winding 1. Perfect coupling means that
          


(15-25)




            Comparing Eqs. (15-23) and (15-24) shows that perfect coupling requires
            k
1
            -
            k
21
            and
            k
2
            -
            k
12
            . But in a linear magnetic medium
            k
12
            -
            k
21
            -
            k
M
            , so perfect coupling implies
          



(15-26)





            Substituting the perfect coupling conditions in
            Eq. (15-26)
            into the
            i-υ
            characteristics in
            Eq. (15-7)
            gives
          


(15-27)




            Factoring
            N
1
            out of the first equation and ±
            N
2
            out of the second produces
          


(15-28)



Dividing the second equation by the first shows that perfect coupling implies



(15-29)




where the plus sign applies for additive mutual inductance and the minus sign for subtractive.

            The parameter
            n
            in
            Eq. (15-29)
            is called the
            turns ratio.
            When
            n
            > 1, the secondary voltage is larger than the primary voltage and the device is called a
            step-up transformer.
            Conversely, when
            n
            < 1, the primary voltage is larger than the secondary voltage and the device is called a
            step-down transformer.
            The ability to increase or decrease ac voltages is a dominant feature and application of transformers. In commercial power systems, ac voltages are stepped up to several hundred kilovolts for transmission and then stepped down to safer levels for use by customers.
          












EXAMPLE 15-5


                    A transformer with perfect coupling has
                    N
1
                    = 250 turns and
                    N
2
                    = 25 turns. The voltage across the primary winding is
                    υ
1
                    (
                    t
                    ) = 120 sin 377
                    t
                    V, and a resistive load
                    R
L
                    = 50 Ω is connected across the secondary winding. Find the current, voltage, and average power delivered to the load. Assume additive coupling. Validate the solution using Multisim.
                  




SOLUTION:




                For additive coupling
                Eq. (15-29)
                gives
              



The current delivered to the load across the secondary is



and the average power delivered to the load is




                Use the Multisim transformer as shown in
                Figure 15-10(a)
                . Click on the transformer and enter the turns for each coil. For negative coupling, change the sign on the output turns. Use the "Single Frequency AC Analysis" to have Multisim calculate the desired parameters. Grapher View returns the results shown in
                Figure 15-10(a)
                . These are the same as found by hand.
              







FIGURE 15-10






■














Exercise 15-4



                For a transformer with perfect coupling, find the secondary voltage
                υ
2
                (
                t
                ) when the primary voltage is
                υ
1
                (
                t
                ) = 50 cos 3000
                t
                V,
                n
                = 50, and the mutual inductance is subtractive. Validate your answer using Multisim.
              


Answer:



υ
2
                (
                t
                ) = -2500 cos 3000
                t
                V
              

                The Multisim circuit and results are shown in
                Figure 15-10(b)
                and they validate the calculations.
              







FIGURE 15-10










Zero Power Loss

            The ideal transformer model also assumes that there is
            zero power loss
            in the transformer. With the passive sign convention, the quantity
            υ
            (
            t
            )
            i
1
            (
            t
            ) is the power in the
            
            primary winding and
            υ
2
            (
            t
            )
            i
2
            (
            t
            ) is the power in the secondary winding. Zero power loss requires
          


(15-30)



This equation states that whatever power enters the transformer on one winding immediately leaves via the other winding. This not only means that there is no energy lost in the ideal transformer but also that there is no energy stored within the element. The zero-power-loss constraint can be rearranged as


(15-31)




            But under the perfect coupling assumption,
            υ
2
            (
            t
            )/
            υ
1
            (
            t
            ) = ±
            n
            . With zero power loss and perfect coupling, the primary and secondary currents are related as
          



(15-32)




The correct sign in this equation depends on the orientation of the current reference directions relative to the dots describing the transformer structure.

            With both perfect coupling and zero power loss, the secondary current is inversely proportional to the turns ratio. A step-up transformer (
            n
            > 1) increases the voltage and decreases the current, which improves transmission line efficiency because the
            i
2
R
            losses in the conductors are smaller.
          



i-v
            Characteristics
          

Equations (15-29)
            and
            (15-32)
            define the
            i-υ
            characteristics of the ideal transformer circuit element and can be rearranged as:
          



(15-33)




Rules for selecting the correct sign in these equations are discussed below.

Equation (15-33)
            applies to time-varying signals since only the changes in one coupled inductor have any effect on the other. Transformers do not pass constant voltages or currents since coupled inductors act like short circuits to dc signals. The sinusoid is the most common time-varying signal of interest. For the purpose of ac circuit analysis, it is convenient to convert
            Eq. (15-33)
            into the phasor domain as
          



(15-34)




These equations are based on the passive sign convention. Under this convention, the rules for selecting the signs in these equations are




When the reference directions for the currents are both toward or both away from the dotted terminals, then
                  V
                  2
                  = +
                  n
                  V
                  1
and
                  I
                  2
                  = -I
                  2
                  = -I
                  1
n; otherwise
                  V
                  2
                  = -
                  n
                  V
                  1
and
                  I
                  2
                  = + I
                  1
                  /
                  n.





Figure 15-11
            shows the circuit symbol for the ideal transformer and several examples of the application of these rules. When using these rules remember that the dots represent physical features of a transformer; they are part of the circuit symbol and cannot be changed. However, the reference directions for the currents and voltages can be changed as long as the assignment follows the passive convention. This means that the current reference directions can always be assigned so that both are toward a dotted terminal.
          







FIGURE 15-11



Dot convention for transformers using phasors.





            In the typical application shown in
            Figure 15-12
            , an ac source is connected across the primary (input) side of the transformer and a load
            Z
L
            across the secondary (output) side. An important feature of this arrangement is that the transformer input impedance
            Z
IN
            is related to the load impedance
            Z
L
            on the output. On the primary side we have
          




            On the secondary side, the reference marks for
            Z
L
            do not follow the passive sign convention, so
          




            The current reference directions in
            Figure 15-12
            are both toward dotted terminals, so according to our rule for selecting signs
            V
2
            = +
            n
V
1
            and
            I
2
            = -
            I
1
            /
            n
            . Hence
          



Therefore, the transformer input impedance is



(15-35)





            Thus,
            Eq. (15-33)
            or
            (15-34)
            shows how an ideal transformer changes the voltage and current levels, while
            Eq. (15-35)
            shows how the impedance level is changed. Taken together, these equations allow us to analyze ac circuits containing ideal transformers.
          












EXAMPLE 15-6


                    The turns ratio of the ideal transformer in
                    Figure 15-12
                    is
                    n
                    = 5. The source and load impedance are
                    Z
S
                    = 2.5 +
                    j
                    1.5Ω and
                    Z
L
                    = 75 +
                    j
                    10Ω. Find
                    I
1
                    ,
                    V
1
                    ,
                    I
2
                    , and
                    V
2
                    when the input is
                    V
S
                    = 220 <0° V. Verify your answer using Multisim.
                  









FIGURE 15-12



Typical transformer application using phasors.





SOLUTION:



                Using
                Eq. (15-35)
                , the transformer input impedance is
              




                The impedance seen by the voltage source is
                Z
S
                +
                Z
IN
                ; hence
              



The voltage on the primary side is




                The reference directions for both
                I
1
                and
                I
2
                are toward dotted terminals, so the correct signs in
                Eq. (15-34)
                are
                V
2
                = +
                n
V
1
                and
                I
2
                = -
                I
1
                /
                n
                . Hence, we get
              



and





                In order to solve this Example using Multisim, we need to convert the phasor quantities to time-domain quantities. Since no frequency was given, we will assume one. Any frequency will do, but since 220 V is a common 60 Hz voltage, we will use 60 Hz. We convert each of the two impedances into a resistor and an inductor.
                Z
S
                = 2.5 +
                j
                377 ×
                L
1
                and
                Z
L
                = 75 +
                j
                377 ×
                L
2
                . We find that
                L
1
                = 3.98 mH and
                L
2
                = 26.5 mH. We build our circuit as shown in
                Figure 15-13
                .
                I
1
                is the current through
                R
1
                , and
                I
2
                is the current through
                R
2
                .
                V
1
                is simply the voltage across the input of the transformer, while
                V
                2 is the difference across the two nodes at the output of the transformer. Running a single frequency analysis yields the table shown in
                Figure 15-13
                .
              







FIGURE 15-13









Single Frequency AC Analysis @ 60 Hz


Variable
Frequency (Hz)
Magnitude
Phase (deg)




V(l)
60
114.4244
-11.470


V(2)-V(3)
60
572.1221
-11.470


-I(2)
60
7.5615
160.941


I(l)
60
37.8075
-19.058




■














Exercise 15-5


                The turns ratio of the ideal transformer in
                Figure 15-12
                is
                n
                = 1/4 and the source and load impedances are
                Z
S
                = 50 +
                j
                0 Ω and
                Z
L
                = 50-
                j
                2 Ω. Find the impedance seen by the voltage source. Is the transformer a step-up or step-down transformer?
              


Answer:



Z
S
                +
                Z
IN
                = 130-
                j
                32 Ω. Step-down.
              

















                    APPLICATION DESIGN
                    EXAMPLE 15-7


                    Electric power is generated by a power plant and transmitted to a distribution station using very high voltage power lines to significantly reduce power line
                    i
2
R
                    losses. From the distribution station, the electricity is reduced to lower, but still high, voltages for final distribution to commercial and residential users. A new home is being constructed that requires a 240-V (rms) voltage supply with a 200-A (rms) maximum service to the home power distribution panel. The local power arriving from the distribution station is at 138 kV (rms) with an effective series line resistance of 5 Ω. It is necessary to design a step-down transformer to provide the necessary power. Determine the equivalent minimum home-load resistance that will ensure that the maximum current is not exceeded. Validate the design using Multisim.
                  




SOLUTION:



                We can find the load resistance under maximum current conditions. The secondary of the transformer must output 240 V(rms). At
                I
2
                = -
                I
L
                = -200 A (rms) the equivalent resistance is
                R
L
                =
                V
2
                /
                I
L
                = 240/200 = 12 Ω. The next task is to find the turns ratio n.
                Figure 15-14
                (a) diagrams the problem.
              







FIGURE 15-14






We can write a KVL around the input loop





                And the output loop
              




                From
                Eq. (15-34)
                ,
                V
2
                =
                n
V
1
                and
                I
2
                = -
                I
1
                /
                n
                . Substituting these into the input loop equation yields
              




                Using the assumption of maximum output current, we can substitute directly for
                V
2
                and
                I
2





                Expanding and solving for
                n





                Both values of
                n
                yield a correct solution to the quadratic equation, but only one is practical. The first value of
                n
                = 13.782 would create a
                step-up
                transformer that requires the voltage at the primary to be very small if the output is to be what is desired. This, then, would require that there be a huge voltage drop across the line and large power losses in the line, which are not physically realizable or practical. Only the second value of
                n
                = 0.0174, or a turns ratio of
                1:
                00174, which could be better written as 57431, is realizable. This is a
                step-down
                transformer and is the desired solution. To clearly demonstrate the issue, both solutions were simulated using Multisim. The results are shown in
                Figure 15-14
                (b) with the problem, the voltage across
                R
4
                , highlighted. While both solutions produce the correct
                V
2
                and
                I
2
                values, only the solution with
                n
                = 0.0174 produced a practical one.
              
■


















DESIGN EXAMPLE 15-8



                    Since a transformer changes impedance levels, it can be used to match a source and load to achieve maximum power transfer.
                    Figure 15-15
                    shows a circuit model of an audio amplifier with an output impedance of 600 Ω feeding an 8-Ω speaker. Find the transformer turns ratio needed to achieve maximum power transfer.
                  









FIGURE 15-15








SOLUTION:



                The maximum power transfer theorem states that power transfer is maximized when the source and load resistance are equal (matched). The purpose of the transformer is to create matched conditions at the output of the amplifier. Using
                Eq. (15-35)
                , the input resistance on the primary side of the transformer is
              




                To achieve matched conditions we need
                R
IN
                = 600 = 8/
                n
2
                , which means that the required turns ratio is
                

■













Exercise 15-6


The input impedance on the primary side of an ideal transformer is 1250 Ω when the load connected to the secondary is 50 Ω. What is the transformer turns ratio?


Answer:



n
                = 1/5
              










                APPLICATION
                
EXAMPLE 15-9



                In a transformer, the primary and secondary windings are magnetically coupled but are usually electrically isolated. Transformer performance in some applications can be improved by electrically connecting the two magnetically coupled windings in a configuration called an
                autotransformer.
Figure 15-16
                shows a two-winding ideal transformer connected in an autotransformer step-up configuration.
              







FIGURE 15-16



The autotransformer connection.




                The rating of the ideal transformer when connected in the usual electrically isolated two-winding configuration is
                P
rated
                =
                υ
1
                (
                t
                )
                i
1
                (
                t
                ) = -
                υ
2
                (
                t
                )
                i
2
                (
                t
                ). Connected in the autotransformer configuration in
                Figure 15-16
                , the power delivered to the load is
              




                For an ideal transformer
                υ
2
                (
                t
                ) =
                nυ
1
                (
                t
                ) and
                i
2
                (
                t
                ) = -
                i
1
                (
                t
                )/
                n
                , where
                n
                =
                N
2
                /
                N
1
                . Hence the power delivered to the load is
              



The autotransformer configuration delivers more power to the load than the power rating of the two-winding transformer. Put differently, the autotransformer can supply a specified load power using a transformer with a lower power rating. Autotransformers are normally used when the turns ratio is less than 3:1, so this advantage can be significant. A disadvantage is that the electrical isolation provided by the usual transformer configuration is lost.




15-5 Linear Transformers


            By far, the most common application of transformers occurs in electric power systems, where they operate in the sinusoidal steady state. In this context, we describe transformers in terms of phasors and impedances and deal with average power transfer. The ac analysis of a transformer begins with the time-domain element equations for a pair of coupled inductors
          




            Transforming these equations into the phasor domain involves replacing waveforms by phasors using the derivative property to obtain the phasors for
            di
1
            /
            dt
            and
            di
2
            /
            dt
            :
          



(15-36)




where


V
1
              and
              I
1
              are the phasors representing ac voltage and current of the first winding, and
              j
              ω
              L
1
              is the impedance of the self-inductance of the first winding.
            

V
2
              and
              I
2
              are the phasors representing ac voltage and current of the second winding, and
              j
              ω
              L
2
              is the impedance of the self-inductance of the second winding.
            

j
              ω
              M
              is the impedance of the mutual inductance between the two windings.
            

The self-inductance impedances relate phasor voltage and current at the same pair of terminals, while the mutual inductance impedance relates the phasor voltage at one pair of terminals to the phasor current at the other pair. The phasor-domain equations can also be written in terms of reactances as




            where the three reactances are
            X
1
            = ω
            L
1
            ,
            X
2
            = ω
            L
2
            , and
            X
M
            = ω
            M
            . The degree of coupling between windings is indicated by the coupling coefficient, which can be written in terms of reactances as
          




            In either form, energy considerations dictate that 0 ≤
            k
            ≤ 1.
          

Figure 15-17
            shows the phasor-domain version of transformer coupling between a source and a load. Following our previous notation, the winding connected to the source is called the
            primary,
            and the winding connected to the load is called the
            secondary.
            Although the transformer is a bilateral device, we normally think of signal and power transfer as passing from the primary to the secondary winding.
          







FIGURE 15-17



Phasor circuit model of the two-winding transformer.





            Our immediate objective is to write circuit equations for the transformer using the mesh currents
            I
A
            and
            I
B
            in
            Figure 15-17
            . Applying KVL around the primary circuit (mesh A) and secondary circuit (mesh B), we obtain the following equations:
          



(15-37)





            The reference directions for the inductor currents in
            Figure 15-17
            are both into the dotted terminals, so the mutual inductance coupling is additive and the plus signs in
            Eq. (15-36)
            apply. Using KCL we see that the reference directions for the currents lead to the relations
            I
1
            =
            I
A
            and
            I
2
            = -
            I
B
            . The
            I-V
            relationships of the coupled inductors in terms of the mesh currents are
          



(15-38)





            Substituting the inductor voltages from
            Eq. (15-38)
            into the KVL equations in
            Eq. (15-37)
            yields
          



(15-39)




This set of mesh equations provides a complete description of the circuit ac response. Once we solve for the mesh currents, we can calculate every phasor voltage and current using Kirchhoff's laws and element equations.












EXAMPLE 15-10



                    The source circuit in
                    Figure 15-17
                    has
                    Z
S
                    = 0 +
                    j
                    20 Ω and
                    V
S
                    = 2500 <0° V at ω = 377 rad/s. The transformer has
                    L
1
                    = 2H,
                    L
2
                    = 0.2 H, and
                    M
                    = 0.6H. The load impedance is
                    Z
L
                    = 2.5 +
                    j
                    15 ω. Find
                    I
A
                    ,
                    I
B
                    ,
                    V
1
                    ,
                    V
2
                    ,
                    Z
IN
                    , and
                    
                    the average power delivered by the source at input interface.
                  




SOLUTION:


The transformer impedances are




                Using these impedances in
                Eq. (15-39)
                yields the following mesh equations:
              



The result is two linear equations in the two unknown mesh currents. Routine analysis yields



Given the mesh currents, the winding voltages are found to be



The input impedance seen by the source circuit is



The average power delivered by the source at the input interface is


■














Exercise 15-7



                Using the values of the mesh currents found in
                Example 15-10
                , find the average power delivered to the load
                Z
L
                . How much of the power delivered by the source is actually received by the load? Why?
              


Answer:


5.491 kW. All of it because the transformer is ideal.


The method used in the preceding example illustrates a general approach to the analysis of transformer circuits. The steps in the method are as follows:

STEP 1
Write KVL equations around the primary and secondary circuits using assigned mesh currents, source voltages, and inductor voltages.


STEP 2

              Write the
              I-V
              characteristics of the coupled inductors in terms of the mesh currents using the dot convention to determine whether the coupling is additive or subtractive.
            


STEP 3

              Use the
              I-V
              relationships from step 2 to eliminate the inductor voltages from the KVL equations obtained in step l to obtain mesh-current equations.
            

The next two examples illustrate this method of formulating mesh equations.












EXAMPLE 15-11



                      (a)  Find
                      I
A
                      ,
                      I
B
                      ,
                      V
1
                      ,
                      V
2
                      , and the impedance seen by the voltage source in
                      Figure 15-18(a)
                      .
                    
(b)  Solve the problem using Multisim.










FIGURE 15-18








SOLUTION:



STEP 1
The KVL equations around meshes A and B are





STEP 2

                  For the assigned reference directions, the coupling is additive. By KCL we have
                  I
1
                  =
                  I
A
                  and
                  I
2
                  = -
                  I
B
                  . Hence, the element equations for the coupled inductors in terms of the mesh currents are
                





STEP 3
Using these equations to eliminate the inductor voltages from the KVL equations found in step 1 yields the following mesh equations:




Solving these equations for the mesh currents produces




                Given the mesh currents, we find the inductor voltages from the
                I-V
                relations:
              





                Finally, the impedance seen by the input voltage source is
              




                Since no frequency is stated, we will choose 60 Hz. We will then calculate the capacitance and inductances, both self and mutual. We need to calculate the coupling coefficient
                k
                using
                Eq. (15-22)
                . The input inductance is 26.5 mH, the output inductance is 265 mH, the mutual inductance is 53 mH, and the capacitance is 35.4 μF. We calculate
                k
                as 0.632. Next, we build the circuit in Multisim (see
                Figure 15-18(b)
                ) and run a Single Frequency AC Analysis at 60 Hz.
              







FIGURE 15-18






Multisim returns the data on the following table. The values compare favorably with the hand calculations.



Single Frequency AC Analysis @60 Hz


Variable
Real
Imaginary





                      V(1)-V(2) =
                      V
1

-10.4
5.98



                      V(3)-V(2) =
                      V
                      2
                    
-25.1
7.21



                      V(4)/I(R1) =
                      Z
IN

55.0
-65.2



                      I(R1) =
                      
                        I
                        A


0.757
0.896



                      I(R2) =
                      I
B

0.0790
-0.0726




■




















EXAMPLE 15-12



Figure 15-19(a)
                    shows an ideal transformer connected as an autotransformer. Find the voltage and average power delivered to the load
                    Z
L
                    for
                    V
S
                    = 500 <0° V,
                    Z
S
                    =
                    j
                    10 Ω,
                    Z
L
                    = 50+
                    j
                    0 Ω,
                    N
1
                    = 200, and
                    N
2
                    = 280.
                  









FIGURE 15-19








SOLUTION:


The three-step method of writing mesh equations can be used here with a modification to the second step:

STEP 1
The KVL equations around meshes A and B are





STEP 2
For the assigned reference directions, the coupling is additive so the ideal transformer voltages and currents are related as






                  By KCL we have
                  I
1
                  =
                  I
A
                  −
                  I
B
                  and
                  I
2
                  = −
                  I
B
                  . Hence, the ideal transformer constrains the two mesh currents as
                





STEP 3

                  Using these results to eliminate
                  I
A
                  and
                  V
2
                  from the KVL equation in step 1 yields
                





                Notice that we cannot eliminate both
                V
1
                and
                V
2
                from the KVL equations since voltage and current are independent in an ideal transformer. Substituting the numerical values produces
              





                Solving these equations for
                I
B
                and
                V
1
                yields
              




                Given the
                I
B
                , we find the output quantities as
              



■













Exercise 15-8


                Using the results in
                Example 15-12
                , find the input impedance seen by the source in
                Figure 15-19(a)
                . Verify your solution using Multisim.
              







FIGURE 15-19








Answer:



                8.66+
                j
                10.0 Ω. See Multisim output and circuit layout in
                Figure 15-19(b)
                .
              



Variable
Real
Imaginary
Units





                      V(VS) =
                      V
S

500
0
V



                      V(VS)/l(L1) = Z
                      IN

8.68
10.00
Ω



                      l(L1) =
                      I
A

24.75
-28.51
A


















EXAMPLE 15-13



                    The linear transformer in
                    Figure 15-20
                    is in the sinusoidal steady state with reactances of
                    X
1
                    = 25 Ω,
                    X
2
                    = 16 Ω,
                    X
M
                    = 18 Ω, and a load impedance of
                    Z
L
                    = 25 -
                    j
                    10 Ω. Find
                    V
2
                    and
                    I
2
                    when
                    V
S
                    = 100 <0° V.
                  









FIGURE 15-20








SOLUTION:


This problem can be solved without the formal use of standard mesh equations.

STEP 1

                  The coupling is additive so the
                  i-υ
                  equations for the transformer are
                





STEP 2
By KVL, the two coil voltages are





STEP 3

                  Substituting these expressions for
                  V
1
                  and
                  V
2
                  into the
                  i-υ
                  equations in STEP 1 gives
                





which can be rearranged as






Solving these two equations in two unknowns yields





and finally




■













Exercise 15-9



                Using the results found in
                Example 15-13
                , find the input impedance seen by the source in
                Figure 15-20
                .
              


Answer:



                12.26 +
                j
                22.10 Ω
              










                APPLICATION
                EXAMPLE 15-14


                A transformer transfers signals or power from one circuit to another strictly by magnetic induction without conductive paths between the circuits. Such circuits are said to be
                electrically isolated
                since there is no electric current flowing directly from one to the other. Any transformer provides isolation, as well as the common functions of changing voltage levels or matching impedances. Transformers that have isolation as their primary purpose are called
                isolation transformers.


                One such purpose is the elimination of what are called
                ground loops.
                In a circuit diagram, all ground symbols are assumed to be at the same potential because of an implied zero-resistance connection between them. In reality, this may not be the case and
                Figure 15-21
                illustrates how this results in a ground loop. A ground loop is a closed conductive path formed in part by an intentional connection between the two circuits and in part by an unintentional (and uncontrolled) connection formed when two "grounds" are not at the same potential.
              







FIGURE 15-21



A ground loop.



For example, if circuit B in the figure is a metal ship moored in port and supplied with ac power from an onshore source in circuit A. The ship's ground (its metal structure) may not be at the same potential as the "earth" ground of the onshore source. This forms a ground loop and allows an errant return current to flow through an uncontrolled path. This current causes undesirable galvanic corrosion when it passes through the interface between the water and the ship's metal hull. One solution is to introduce isolation transformers in the intentional ship-to-shore connections thus electrically isolating the ship and eliminating the conductive paths needed to form ground loops.

                There are many types of isolation transformers and they come in many sizes for different applications. They are often one-to-one (
                n
                = 1) transformers since their purpose is electrical isolation rather than changing voltage or current levels. They can be very small so they can be surface mounted on a printed circuit board, as seen in the photo in
                Figure 15-22
                (a) and its circuit in
                Figure 15-22
                (b). Many are mid-sized so they can be used to eliminate ground loops caused by wide-band RF transmission lines, as seen in
                Figure 15-22
                (c). Mid-sized isolation transformers also could be
                
                inserted in-line between components in a TV studio to eliminate hum caused by different grounds—these are similar in design to the wide-band transformer. They can also be quite large, as described next.
              







FIGURE 15-22



Isolation transformers. (a) Surface mount. (b) Circuit diagram for (a). (c) Wide-band or in-line.




                The typical transmission mast antenna in
                Figure 15-23
                offers an interesting application of an isolation transformer. The mast is made of conductive metal and is mounted on a nonconductive base that isolates it from earth ground. The mast is driven by a radio frequency (RF) source that may raise its metal structure to several hundred kilovolts above ground potential. Because of its height, a mast antenna is equipped with attached air-traffic obstacle warning lamps that are powered by ordinary 60-Hz ac power. The wires carrying ac power to the lamps are of necessity exposed to the antenna's radiated fields.
                
                The RF currents induced in these wires naturally seek a conductive path to earth ground in the lamp power source. To avoid this diversion of RF radiated power, an isolation transformer is inserted between the lamp power source and the circuit bringing power to the lamps. This type of isolation transformer requires special design features and is usually called an Austin transformer, so named for an early patent holder, Arthur O. Austin. Usually, the transformer is quite large and consists of two ring-like windings linked, and at 90° to each other with a large air space between the winding and the magnetic core that provides the isolation. See
                Figure 15-24
                .
              







FIGURE 15-23



A mast antenna.










FIGURE 15-24



An Austin transformer.













                  APPLICATION
                  EXAMPLE 15-15



                Electric machines include transformers, motors, and generators. All three of these basic machines work on the principles of Faraday s Law of Electromagnetic Induction. Faraday s Law states that the voltage is given by the negative time derivative of the magnetic flux:
                υ
                (
                t
                ) = − dϕ/
                dt
                .
              
Faraday s theory is the core of all electric machines. A transformer is a non-rotational machine, whereas motors and generators are rotational machines. Faraday s Law is equally applied to all three of these machines.

                Transformers are electrical machines that input electrical energy at a particular voltage and current and output electrical energy at a different voltage and current. Importantly, in ideal transformers, the power in equals the power out. Motors are a form of electric machines that convert electrical energy to rotational energy. Like transformers, motors require two coils. One that rotates, called the
                rotor,
                and the one that is stationary, called the
                stator.
                Generators are the third form of electric machinery. Generators convert rotational motion into electricity. Generators also include a rotor coil and a stator coil.
              
Interestingly, all three are bilateral devices. Reversing the input and output of a transformer will reverse the step-up to a step-down or vice versa. Similarly, rotating the stator on a motor produces electricity at its output. Likewise, placing electricity at the output of a generator will cause the rotor to turn. Of course, all three machine types are designed optimally for their intended purposes.




Summary


Mutual inductance
              describes magnetic coupling between two inductors. The mutual inductance parameter relates the voltage induced in one inductor to the rate of change of current in the other inductor. The induced voltage can be either positive (additive coupling) or negative (subtractive coupling).
            

              The
              dot convention
              describes the physical orientation of the two magnetically coupled inductors. Mutual inductance coupling is additive when both current reference arrows point toward or away from dotted terminals; otherwise, it is subtractive. The reference directions for the currents can always be selected so that the coupling is additive.
            

              The degree of coupling is indicated by the
              coupling coefficient.
              Energy analysis shows that the coupling coefficient must lie between zero and one. A coupling coefficient of unity is called perfect coupling and means that all of the flux produced by first winding links with a second winding, and vice versa. A coupling coefficient of zero indicates no magnetic linkage between the windings.
            

Inductive coupling
              is finding increased usage in wireless energy transmission.
            

              A
              transformer
              is an electrical device based on the mutual inductance coupling between two windings. Transformers find applications in almost all electrical systems, especially in power supplies and the electrical power grid. The transformer winding connected to the power source is called the
              primary winding,
              and the winding connected to the load is called the
              secondary winding.



              The
              ideal transformer
              is a circuit element in which the primary and secondary windings are assumed to be perfectly coupled and to have no power loss. In an ideal transformer, the voltages and currents in the primary and secondary windings are related by the turns ratio, which is the ratio of the number of turns in the secondary winding to that in the primary winding.
            
In the sinusoidal steady state, transformers can be analyzed using phasors to determine steady-state currents, voltages, impedances, and average power transfer. The phasor analysis of transformers is carried out using a modified mesh-current approach.





            Chapter 15 Problems
          






                Objective 15-1 Mutual Inductance (
                Sects. 15-1
                to
                15-3
                )
              

                Given the current through or voltage across two coupled inductors, find other currents or voltages. See
                Examples 15-1
                to and
                Exercises 15-1
                to
                15-3
                .
              






15-1
              In
              Figure P15-1
              ,
              L
1
              = 10 mH,
              L
2
              = 50 mH,
              k
              = 0.4 and
              υ
S
              (
              t
              ) = 200 sin 100
              t
              V.
              

(a)
                   Write the
                  i-υ
                  relationships for the coupled inductors using the reference marks in the figure.
                

(b)
                   Solve for
                  υ
2
                  (
                  t
                  ) when the output terminals are open circuited (
                  i
2
                  (
                  t
                  ) = 0).
                

(c)
                   Use Multisim to verify your results.
                










FIGURE P15-1








15-2
              In
              Figure P15-1
              ,
              L
1
              = 10 mH,
              L
2
              = 5 mH,
              M
              = 7 mH, and
              υ
S
              (
              t
              ) = 100 sin 1000
              t
              V.
              

(a)
                   Write the
                  i-υ
                  relationships for the coupled inductors using the reference marks in the figure.
                

(b)
                   Solve for
                  i
1
                  (
                  t
                  ) and
                  i
2
                  (
                  t
                  ) when the output terminals are short-circuited (
                  υ
2
                  (
                  t
                  ) = 0 V).
                

(c)
                   What is the largest value
                  M
                  can be?
                




15-3
              In
              Figure P15-1
              ,
              L
1
              = 10 mH,
              L
2
              = 5 mH,
              M
              = 7 mH, and the outputs are
              υ
2
              (
              t
              ) = 0 and
              i
2
              (
              t
              ) = 35 sin 1000
              t
              A.
              

(a)
                   Write the
                  i-υ
                  relationships for the coupled inductors using the reference marks given.
                

(b)
                   Solve for the source voltage
                  υ
S
                  (
                  t
                  ).
                




15-4
              In
              Figure P15-4
              ,
              L
1
              =
              L
2
              = 5 mH,
              M
              = 2 mH,
              k
              = 0.4, and
              i
S
              (
              t
              ) = 120 sin 377
              t
              A.
              

(a)
                   Solve for
                  υ
1
                  (
                  t
                  ) and
                  υ
2
                  (
                  t
                  ) when the output terminals are open circuited (
                  i
2
                  (
                  t
                  ) = 0).
                

(b)
                   Find the Thévenin Equivalent looking into the output terminals.
                

(c)
                   Use Multisim to verify your results.
                










FIGURE P15-4









15-5
              In
              Figure P15-4
              ,
              L
1
              =
              L
2
              = 4 mH,
              M
              = 3 mH, and
              i
2
              (
              t
              ) = 10 sin 1000
              t
              mA when the output terminals are short circuited. Solve for
              υ
1
              (
              t
              ) and
              i
1
              (
              t
              ).
            


15-6
              In
              Figure P15-6
              ,
              L
1
              = 2 H,
              L
2
              = 6 H,
              M
              = 3 H, and
              υ
X
              (
              t
              ) = 70 cos(1000
              t
              ) V. Find the input current
              i
1
              (
              t
              ) and the voltages
              υ
1
              (
              t
              ) and
              υ
2
              (
              t
              ) using Multisim.
            








FIGURE P15-6









15-7
              In
              Figure P15-7
              show that
              L
EQ
              =
              L
1
              (1 −
              k
2
              ), where
              k
              is the coupling coefficient.
            








FIGURE P15-7








15-8
              In
              Figure P15-8
              show that the indicated open-circuit voltage is
              



                where
                k
                is the coupling coefficient.
              









FIGURE P15-8









15-9
              Because of the numerous windings, transformers are likely to have a parasitic resistance associated with each coil.
              Figure P15-9
              shows a pair of coupled coils with a series resistance associated with each inductance. Rewrite
              Eq. (15-12)
              to include the effects of the parasitic resistances.
            








FIGURE P15-9












                Objective 15-2 The Ideal Transformer (
                Sect. 15-4
                )
              


                Given a circuit containing ideal transformers:
              


(a)
                   Find specified voltages, currents, and powers.
                

(b)
                   Select the turns ratio to meet prescribed conditions.
                


                See
                Examples 15-4
                to
                15-8
                and
                Exercises 15-4
                to
                15-6
                .
              





15-10

              A perfectly coupled (ideal) transformer is used to provide electricity to a 1-kΩ, 12-V doorbell from house voltage 169.7 sin 377
              t
              V. Design the transformer's turn-ratio to meet this requirement. Then validate your design using Multisim. Assume additive coupling.
            



15-11
              In Figure P15-ll
              R
S
              = 50 Ω,
              R
L
              = 1250 Ω, the turns ratio is
              n
              = 5, and the source voltage is
              υ
S
              (
              t
              ) = 240 cos 377
              t
              V. Find expressions for
              i
1
              (
              t
              ) and
              i
2
              (
              t
              ). Validate your answer using Multisim.
            








FIGURE P15-11








15-12
              The turns ratio of the ideal transformer in
              Figure P15-12
              is
              n
              = 10. The source and load impedances are
              Z
S
              = 50 Ω and
              Z
L
              = 500 -
              j
              500 Ω. Find
              I
1
              ,
              I
2
              , and
              V
O
              when
              V
S
              = 200<90° V.
            








FIGURE P15-12










15-13

              Design the turns ratio of the ideal transformer in
              Figure P15-12
              so that
              V
O
              = 708 <7.973° V when
              V
S
              = 440<0° V. The source and load impedances are
              Z
S
              = 50 +
              j
              0 Ω and
              Z
L
              = 5 +
              j
              2 Ω. Validate your design using Multisim.
            


15-14
              In
              Figure P15-14
              , the turns ratio is
              n
              = 5,
              L
              = 120 mH, and
              R
L
              = 1.5 kΩ. Find
              i
IN
              (
              t
              ) and
              v
2
              (
              t
              ) when
              v
1
              (
              t
              ) = 100 sin 377
              t
              V. Use Multisim to verify your results.
            








FIGURE P15-17










15-15



(a)
                  Design the turns ratio in
                  Figure P15-14
                  if
                  V
1
                  = 100 <0° V,
                  V
2
                  = 300 <0° V,
                  X
L
                  = 10 Ω, and
                  R
L
                  = 50 Ω.
                

(b)
                   Then find
                  I
IN
                  .
                

(c)
                   Verify your answer using Multisim.
                



15-16
              The primary voltage of an ideal transformer used in a home furnace to connect to a thermostat is a 120-V, 60-Hz sinusoid. The secondary voltage is a 24-V, 60-Hz sinusoid. The secondary winding is connected to a 150-Ω resistive load thermostat.
              

(a)
                   Find the transformer turns ratio.
                

(b)
                   Write expressions for the primary and secondary currents.
                

(c)
                   If the source can only deliver a maximum of 8 W, how many identical thermostats can be connected in parallel and still operate properly?
                




15-17
              In
              Figure P15-17
              the impedances are
              Z
1
              = 20 −
              j
              45 Ω,
              Z
2
              = 45 +
              j
              30 Ω, and
              Z
3
              = 300 +
              j
              250 Ω. Find
              I
1
              ,
              I
2
              , and
              I
3
              .
            








FIGURE P15-17








15-18

              The solenoid in
              Figure P15-18
              needs 24 V to operate properly. The source
              V
S
              = 170 <0° V,
              Z
S
              = 50 <0° Ω,
              R
sol
              = 50 Ω, and
              X
sol
              = 50 Ω. Design the ideal transformer that can operate the solenoid. Then find
              I
sol
              .
            








FIGURE P15-18









15-19
              The primary winding of an ideal transformer with
              N
1
              = 100 and
              N
2
              = 250 is connected to a 480-V source. A 1-kΩ load is connected across the secondary windings. Find amplitudes of the primary and secondary currents.
            







                Objective 15-3 The Linear Transformer (
                Sect.15-5
                )
              

                Given a linear transformer operating
                
                in the sinusoidal steady state, find phasor voltages and currents, average powers, and equivalent impedances.
              

                See
                Examples 15-9
                to
                15-13
                and
                Exercises 15-7
                to
                15-9
                .
              




15-20
              The input voltage to the transformer in
              Figure P15-20
              is a sinusoid
              υ
S
              (
              t
              ) = 339 sin (314
              t
              ) V. With the circuit operating in the sinusoidal steady state, transform the circuit into the phasor domain and write mesh-current equations. Solve for the mesh currents and find the output voltage
              V
2
              and the input impedance
              Z
IN
              .
            








FIGURE P15-20









15-21
              Repeat Problem 15-20 with
              υ
S
              (
              t
              ) = 10 cos 2000
              t
              V.
            

15-22
              A transformer has self-inductances
              L
1
              = 200 mH,
              L
2
              = 200 mH, and a coupling coefficient of
              k
              = 0.5. The transformer is operating in the sinusoidal steady state with ω = 500 rad/s and a 50-Ω resistive load connected across the secondary winding. Find the transformer input impedance. Assume additive coupling.
            


15-23
              Repeat Problem 15-22 when a 20-mH inductive load is connected across the secondary winding.
            

15-24
              The linear transformer in
              Figure P15-24
              is operating in the sinusoidal steady state with
              V
S
              = 500 V and
              Z
L
              = 10 +
              j
              10 Ω. Use mesh-current analysis to find the input impedance seen by the source and the average power delivered by the source.
            








FIGURE P15-24









15-25


(a)
                   Repeat Problem 15-24 with
                  Z
L
                  = 10 −
                  j
                  10 Ω.
                

(b)
                   What is the largest value of mutual inductance reactance
                  X
M
                  possible for the transformer shown in
                  Figure P15-24
                  ?
                



15-26
              Find the phasor current
              I
              and the input impedance seen by the source in
              Figure P15-26
              .
            








FIGURE P15-26









15-27
              Find
              I
A
              and
              I
B
              in
              Figure P15-27
              and the input impedance seen by the voltage source.
            








FIGURE P15-27









15-28
              If
              f
              = 50 Hz, find
              V
1
              and
              V
2
              in
              Figure P15-27
              using Multisim.
            


15-29
              A transformer operating in the sinusoidal steady state has inductances
              L
1
              = 800 mH,
              L
2
              = 320 mH, and
              M
              = 500 mH. A load
              Z
L
              = 6 +
              j
              0 Ω is connected across the secondary. The 60-Hz voltage source connected to the primary side has a peak amplitude of 250 V. Find the impedance seen by the voltage source and the average power delivered to the load.
            

15-30
              A transformer operating in the sinusoidal steady state has inductances
              L
1
              = 510 mH,
              L
2
              = 2 H, and
              M
              = 1 H. The load connected across the secondary is
              Z
L
              = 200 +
              j
              150 Ω. The 50-Hz voltage source connected to the primary side has a peak amplitude of 2.5 kV. Find the amplitudes of the secondary winding voltage and current.
            


15-31
              The linear transformer in
              Figure P15-31
              is in the sinusoidal steady state with reactances of
              X
1
              = 32 Ω,
              X
2
              = 50 Ω,
              X
M
              = 40 Ω, and a load impedance of
              Z
L
              = 150 -
              j
              50 Ω. Find the input impedance seen by the voltage source.
            








FIGURE P15-31








Integrating Problems


15-32


              Equivalent Inductance
              
                An inductor
                L
                is connected across the secondary of an ideal transformer whose turns ratio is 1:
                n
                .
              


(a)
                   Derive an expression for the equivalent inductance
                  L
EQ
                  seen looking into the primary winding.
                

(b)
                   Suppose you added a capacitor in parallel with the inductor. At what frequency would
                  Z
IN
                  = ∞?
                




15-33

              Transformer Thévenin Equivalent In the time domain, the
              i-υ
              equations for a linear transformer are
              



                Assuming zero initial conditions, transform these equations into the
                s
                -domain and show that the
                s
                -domain parameters of the Thévenin equivalent at the output are
              




                where
                k
                is the coupling coefficient.
              


15-34

              Perfectly Coupled Transformer
              
Figure P15-34
              is an equivalent circuit of a perfectly coupled transformer. This model is the basis for the transformer equivalent circuits used in the analysis of power systems. The inductance
              L
m
              is called the magnetizing inductance. The current through this inductance represents the current needed to establish the magnetic field in the transformer at no load (
              i
2
              = 0). Show that the
              i-υ
              equations for this circuit are as follows:
              



                Use these equations to show that
                k
                = 1.
              









FIGURE P15-34









15-35

              Equivalent T-Circuit Transformer Model
              
              The transformer model shown in
              Figure 15-17
              can also be modeled using an Equivalent T-Circuit as shown in
              Figure P15-35
              . The three inductors are related to the transformer inductances as follows:
              



                where the upper sign applies for additive coupling and the lower sign for subtractive coupling. Solve
                Example 15-10
                using the Equivalent T-Circuit and Multisim. Compare your results with those in the example.
              









FIGURE P15-35









15-36

              Effect of
              k
              on Transient Behavior of Coupled Coils.
              
              Consider the circuit shown in
              Figure P15-36
              . The 5-V dc source switches from 5 V to 0 V at
              t
              = 0. Find the output
              υ
C
              (
              t
              ) for six different values of the coupling coefficient
              k
              (0, 0.2, 0.4, 0.6, 0.8, and 0.999). Build your circuit in Multisim using the step source and the coupled coils part. Then perform a Parameter sweep on
              k
              listing the desired values. What you should observe is similar to what Faraday observed—explain. Identify the maximum or minimum and the voltage and time when it occurs.
            








FIGURE P15-36









15-37

              Three-Winding Ideal Transformer
              

(a)
                   
                  Figure P15-37
                  shows a three-winding transformer that can be treated as ideal.
                  
                  Perfect coupling between all windings implies that
                  
                  and
                  

                  Show that zero power loss means that
                  N
1
i
1
                  (
                  t
                  ) +
                  N
2
i
2
                  (
                  t
                  ) +
                  N
3
i
3
                  (
                  t
                  ) = 0.
                

(b)
                   Prove the result by simulating it using Multisim. Let
                  N
1
                  = 1,
                  N
2
                  = 2, and
                  N
3
                  = 3. Put a 1-kΩ resistor as a load on each output and feed the input
                  
i
1
                    (
                    t
                    )
                  
                  with a 1000-Hz 1-A source.
                










FIGURE P15-37









Note




1

                See Application
                Example 15-15
                on electric machines.
              

















CHAPTER 16

AC POWER SYSTEMS





George Westinghouse was in my opinion, the only man on the globe who could take my alternating current (power) system under the circumstances then existing and win the battle against prejudice and money power.


          Nikola Tesla, 1932
          
          American Engineer
        








Some History Behind This Chapter
The 1890s saw a competition between the dc power system developed by Thomas Edison and the newly emerging ac system. Initially the main drawback of the ac approach was a lack of practical motors. The Serbian immigrant Nikola Tesla (1856-1943) invented the three-phase ac induction motor that met this need. In 1887, Tesla founded a company to develop his inventions, eventually producing some 40 patents on three-phase equipment. George Westinghouse recognized the importance of this work and purchased the rights to Tesla's patents. The ac-versus dc-competition was settled when an ac system was chosen for a large hydroelectric power station at Niagara Falls, New York.









Why This Chapter Is Important Today
Until recently, the tried and proven power systems have withstood decades of relatively stable and reliable performance with only modest innovations—it was not very exciting to go into the power field. However, the last several years are seeing a renaissance in the generation, storage, and distribution of power. Utility companies as well as automobile companies are investing heavily in renewable energy from photoelectrics and windmills as well as the ability to store increasing large amounts of energy in batteries. These innovations have brought this area of electrical engineering back to the forefront. It is increasingly likely that your future work will be impacted by the generation, storage, transmission, and utilization of electricity. Hence, some understanding ofits concepts and limitations is important regardless of where your work takes you. Among these concepts are complex power, single-phase and three-phase circuits, and power flow. Have you ever wondered why the electric transmission lines marching across the countryside have three wires each suspended from a large insulator? You will find the answer here.









Chapter Sections



16-1 Average and Reactive Power






16-2 Complex Power






16-3 Single-Phase Circuit Analysis






16-4 Single-Phase Power Flow






16-5 Balanced Three-Phase Circuits






16-6 Three-Phase Circuit Analysis






16-7 Three-Phase Power Flow












Chapter Learning Objectives

16-1
              Complex Power (
              Sects. 16-1
              and
              16-2
              )
            
Given a linear circuit in the sinusoidal steady state:

(a) Find the average, reactive, and instantaneous power for a specified voltage and current.
(b) Find the load impedance for a specified load power flow.


16-2
              Single-Phase Circuit Analysis (
              Sect. 16-3
              )
            
Given a single-phase circuit operating in the ac steady state, find the power produced by sources or delivered to specified loads.

16-3
              Single-Phase Power Flow (
              Sect. 16-4
              )
            
Given a specified load power in a single-phase circuit:

(a) Find the required source outputs.
(b) Find the parallel capacitance needed to produce a specified power factor.


16-4
              Balanced Three-Phase Circuits (
              Sect. 16-5
              )
            
For a balanced three-phase circuit:

(a) Find all of the phase and line voltage phasors for a given phase reference.
(b) Find equivalent Y- or Δ-connected sources and loads.


16-5
              Three-Phase Circuit Analysis (
              Sect. 16-6
              )
            
For a given balanced three-phase circuit:

(a) Find the line and phase current phasors for a specified phase reference.

                (b) Find the source or load power using the scalars
                V
1
                and
                I
1
                .
              


16-6
              Three-Phase Power Flow (
              Sect. 16-7
              )
            
Given a single-line diagram of a balanced three-phase system, find the source outputs and bus voltages that produce a prescribed load power flow.



16-1 Average and Reactive Power


            We begin our study of electric power circuits with the two-terminal interface in
            Figure 16-1
            (a). In power applications, we normally think of one circuit as the source and the other as the load. Our objective is to describe the flow of power across the interface when the circuit is operating in the sinusoidal steady state. To this end, we write the interface voltage and current in the time domain as sinusoids of the form
          







FIGURE 16-1



(a) A two-terminal interface.






(16-1)





            In
            Eq. (16-1)
V
A
            and
            I
A
            are real, positive numbers representing the peak amplitudes of the voltage and current, respectively.
          

            In
            Eq. (16-1)
            , we have selected the
            t
            = 0 reference at the positive maximum of the current
            i
            (
            t
            ) and assigned a phase angle to
            υ
            (
            t
            ) to account for the fact that the voltage maximum may not occur at the same time. In the phasor domain, the angle θ = ϕ
            V
            - ϕ
            I
            is the angle between the phasors
            V
            =
            V
A
            <(ϕ
            V
            and
            I
            =
            I
A
            <ϕ
            I
            and is called the
            power factor
            angle. In effect, choosing
            t
            = 0 at the current maximum shifts the phase reference by an amount -ϕ
            I
            so that the voltage and current phasors become
            V
            =
            V
A
            <θ and
            I
            =
            I
A
            <0. See
            Figure 16-1
            (b)
          







FIGURE 16-1



(b) Relationship between current and voltage phase angles.



A method of relating power to phasor voltage and current will be presented in the following section, but at the moment we write the instantaneous power in the time domain.


(16-2)





            This expression for instantaneous power contains dc and ac components. To separate the components, we first use the identity cos (
            x
            +
            y
            ) = cos
            x
            cos
            y
            - sin
            x
            sin
            y
            to write
            p
            (
            t
            ) in the form
          


(16-3)




            Using the identities cos
            2
x
            = ½(1 + cos 2
            x
            ) and cos
            x
            sin
            x
            = ½sin2
            x
            , we write
            p
            (
            t
            ) in the form
          



(16-4)




Written this way, we see that the instantaneous power is the sum of a dc component and a double-frequency ac component.

            Note that instantaneous power in
            Eq. (16-4)
            is periodic. In
            Chapter 5
            , we defined the average value of a periodic waveform as
          




            where
            T
            = 2π/2ω is the period of
            p
            (
            t
            ). In
            Chapter 5
            , we also showed that the average value of a sinusoid is zero. Therefore, the
            average value
            of
            p
            (
            t
            ), denoted as
            P
            , is equal to the constant or dc term in
            Eq. (16-4)
            :
          



(16-5)





            The amplitude of the sin2ω
            t
            term in
            Eq. (16-4)
            has a form much like the average power in
            Eq. (16-5)
            , except it involves sin θ rather than cos θ. This amplitude factor is called the
            reactive power
            of
            p
            (
            t
            ), where reactive power
            Q
            is defined as
          



(16-6)




and has the units of Volt-Amperes Reactive or VAR.

            Substituting
            Eqs. (16-5)
            and
            (16-6)
            into
            Eq. (16-4)
            yields the instantaneous power in terms of the average power and reactive power:
          



(16-7)





            The energy transferred across the interface during one cycle
            T
            = 2π/2ω of
            p
            (
            t
            ) is
          


(16-8)




            The unipolar term in
            Eq. (16-7)
            provides a net energy transfer of
            P
            ×
            T
            per cycle. The bipolar term is a sinusoidal power oscillation of amplitude
            Q
            that provides no net energy transfer. The average power
            P
            indicates a unidirectional flow of energy while the reactive power
            Q
            indicates bidirectional interchange of energy.
          


            The flow of average and reactive power is the central issue in ac power systems. Although these two kinds of power have the same dimensions (volts x amperes), they represent quite different effects. For this reason, they are given different unit names: average power is measured in watts (W) and reactive power in Volt-Amperes Reactive (VAR).
          












EXAMPLE 16-1



                    The ac steady-state inputs to the load in
                    Figure 16-1
                    are
                  



Find the average power, reactive power, and instantaneous power carried by these waveforms.




SOLUTION:


The power factor angle for this case is



The average and reactive powers are




                Using
                Eq. (16-7)
                , the instantaneous power is
              




                Since
                P
                > 0, a net energy of
                P
                ×
                T
                per cycle is transferred into the load.
                ■















Exercise 16-1



                Using the reference marks in
                Figure 16-1
                (a), calculate the average and reactive power for the following voltages and currents.
              


                  (a)  
                  υ
                  (
                  t
                  ) = 168cos(377
                  t
                  + 45°) V,
                  i
                  (
                  t
                  ) = 0.88 cos 377
                  t
                  A
                

                  (b)  
                  υ
                  (
                  t
                  ) = 285 cos(2500
                  t
                  + 68°) V,
                  i
                  (
                  t
                  ) = 0.66cos (2500
                  t
                  + 10°) A
                

Answers:


                  (a)  
                  P
                  = +52.3 W,
                  Q
                  = +52.3 VAR
                

                  (b)  
                  P
                  = +49.8 W,
                  Q
                  = +79.8 VAR
                





16-2 Complex Power
It is important to relate average and reactive power to phasor quantities because steady-state analysis is conveniently carried out using phasors. In our previous work, the magnitude of a phasor represented the peak amplitude of a sinusoid. However, in power circuit analysis, it is convenient to express phasor magnitudes in rms (root-mean-square) values. In this chapter, phasor voltages and currents are expressed as



(16-9)





            Notice that the phasor magnitudes are the rms amplitude of the corresponding sinusoid not their peak values
            V
A
            and
            I
A
            .
          

Equations (16-5)
            and
            (16-6)
            express average and reactive power in terms of peak amplitudes
            V
A
            and
            I
A
            . In
            Chapter 5
            , we showed that the peak and rms values of a
            
            sinusoid are related by
            
            . The expression for average power can be easily converted into rms amplitudes since we can write
            Eq. (16-5)
            as
          



(16-10)




 
            where θ = ϕ 
            V 
            - ϕ  
            I   
            is the angle between the voltage and current phasors. By similar reasoning,
            Eq. (16-6)  
            becomes   
          


(16-11)



   
            We now introduce a new variable called  
            complex power   
            (
            S    
            ). Complex power at a two-terminal interface is defined as follows:
          



(16-12)




  
            That is, the complex power at an interface is the product of the voltage phasor times the conjugate of the current phasor. Substituting
            Eq. (16-9)
            into this definition yields   
          


(16-13)




            Using Euler's relationship and the fact that the angle is θ = ϕ
            V
            - ϕ
            I
            , we can write complex power as
          


(16-14)




            The real part of the complex power
            S
            is the average power, and the imaginary part is the reactive power. Although
            S
            is a complex number, it is not a phasor. However, it is a convenient variable for keeping track of the two components of power when the voltage and currents are expressed as phasors. Its units are volt-amperes.
          

            The power triangles in
            Figure 16-2
            provide a convenient way to remember complex power relationships and terminology. We confine our study to cases in which net energy is transferred from source to load. In such cases
            P
            > 0 and the power triangles fall in the first or fourth quadrant, as indicated in
            Figure 16-2
            .
          







FIGURE 16-2



Power triangles.




            The magnitude |
            S
            | =
            V
rms
I
rms
            is called
            apparent power
            and is expressed using the unit volt-ampere (VA). The ratio of the average power to the apparent power is called the
            power factor
            (pf). Using
            Eq. (16-10)
            , we see that the power factor is
          


(16-15)




            Since pf = cos θ, the angle θ is called the
            power factor angle.


            When the power factor is unity, the phasors
            V
            and
            I
            are in phase (θ = 0°) and the reactive power is zero since sin θ = 0. When the power factor is less than unity, the reactive power is not zero and its sign is indicated by the modifiers
            lagging
            or
            leading.
            The term
            lagging power factor
            means the current phasor lags the voltage phasor so that θ = ϕ
            V
            - ϕ
            I
            > 0. For a lagging power factor,
            S
            falls in the first quadrant in
            Figure 16-2
            and the reactive power is positive since sin θ > 0. The term
            
              leading power
              
              factor
            
            means the current phasor leads the voltage phasor so that θ = ϕ
            V
            - ϕ
            I
            < 0. In this case,
            S
            falls in the fourth quadrant in
            Figure 16-2
            and the reactive power is negative since sin θ < 0. Most industrial and residential loads have lagging power factors because of the high use of inductive loads, e.g., motors. Large arc-furnaces, on the other hand, are capacitive loads causing leading power factors.
          











EXAMPLE 16-2

Find the average power, reactive power, and apparent power for the following voltage and current phasors. Find the power factor and state whether it is lagging or leading.







SOLUTION:






                The average, reactive, and apparent powers are
                P
                = 1973 W,
                Q
                = -718 VAR, and |
                S
                | = 2100 VA, respectively. The power factor is
              




                The power factor is leading since
                Q
                is negative.
                ■














Exercise 16-2

Determine the average power, reactive power, and apparent power for the following voltage and current phasors. State whether the power factor is lagging or leading.


                  (a)  
                  V
                  = 208<-90° V(rms),
                  I
                  = 1.75<-75° A(rms)
                

                  (b)  
                  V
                  = 277< + 90° V(rms),
                  I
                  = 11.3<0° A(rms)
                

Answers:


                  (a)  
                  P
                  = 352 W;
                  Q
                  = -94.2 VAR; |
                  S
                  | = 364 VA; leading
                

                  (b)  
                  P
                  = 0 W;
                  Q
                  = +3.13 kVAR; |
                  S
                  | = 3.13 kVA; lagging
                




Complex Power and Load Impedance

Figure 16-3
              shows the general case for a two-terminal load. For the assigned reference directions, the load produces the element constraint
              V
              =
              ZI
              . Using this constraint in
              Eq. (16-12)
              , we write the complex power of the load as
            







FIGURE 16-3



A two-terminal impedance.







              where
              R
              and
              X
              are the resistance and reactance of the load, respectively. Since
              S
              =
              P
              +
              jQ,
              we conclude that
            



(16-16)




The load resistance and reactance are proportional to the average and reactive power of the load, respectively.


Equation (16-16)
              reveals several important properties of loads made up of passive resistors, capacitors, and inductors:
            



a.

                The load resistance requires
                R
                ≥ 0, which means that
                P
                is nonnegative.
              


b.

                For an inductive load
                X
                = ω
                L
                > 0, which means that
                Q
                is positive.
              


c.

                For a capacitive load
                X
                = -1/ω
                C
                < 0, which means that
                Q
                is negative.
              


              The terms
              inductive load, positive reactive power,
              and
              lagging power factor
              are equivalent statements, as are the terms
              capacitive load, negative reactive power,
              and
              leading power factor.













EXAMPLE 16-3


At 440 V(rms) a two-terminal load draws 3 kVA of apparent power at a lagging power factor of 0.9. Find


                        (a)  
                        I
rms


                        (b)  
                        P


                        (c)  
                        Q

(d)  the load impedance

Draw the power triangle for the load.




SOLUTION:




                    (a)  
                    I
rms
                    = |
                    S
                    |/
                    V
rms
                    = 3000/440 = 682 A (rms)
                  

                    (b)  
                    P
                    =
                    V
rms
                    /
                    I
rms
                    cos θ = 3000 × 0.9 = 2.7 kW
                  

                    (c)  For cos θ = 0.9 lagging, θ = cos
                    -1
                    0.9 = 25.8°, sinθ = 0.436, and
                    Q
                    =
                    V
rms
                    /
                    I
rms
                    sin θ = 1.31 kVAR
                  

                    (d)  
                    Z
                    = (
                    P
                    +
                    jQ
                    )/(
                    I
rms
                    )
                    2
                    = (2700 +
                    j
                    1310)/46.5 = 58.0 +
                    j
                    28.2 Ω.
                  


Figure 16-4
                  shows the power triangle for this load.
                







FIGURE 16-4







■
















Exercise 16-3


Find the impedance of a two-terminal load under the following conditions.


                    (a)  
                    V
                    = 120<30° V (rms) and I = 20<75° A (rms)
                  

                    (b)  |S| = 3.3 kVA,
                    Q
                    = -1.8 kVAR, and
                    I
rms
                    = 7.5 A
                  

Answers:


                    (a)  
                    Z
                    = 4.24 -
                    j
                    4.24 Ω
                  

                    (b)  
                    Z
                    = 49.2 -
                    j
                    32 Ω
                  






16-3 Single-Phase Circuit Analysis

            Single-phase circuit analysis deals with linear circuits in the sinusoidal steady state. The term
            single-phase
            means that all of the ac sources have the same phase angle. The analysis objective is to find the complex power produced by the sources or delivered to specified loads. Our analysis strategy is straightforward. We use the methods of linear ac circuit analysis from
            Chapter 8
            to find the voltage across and current through an element. We then calculate complex power as
            S
            =
            VI*
            or, in the case of a load impedance,
            S
            = |
            I
            |
            2
Z.
            In terms of circuit analysis concepts, the only thing new here is that the final result is complex power rather than current and voltage phasors.
          

            We can sometimes make good use of the principle of the
            conservation of complex power,
            which states that
          




In a linear circuit the sum of the complex powers produced by all the sources is equal to the sum of the complex powers delivered to all of the passive loads.






            To apply this principle, we must be clear on the meaning of "produced by" and "delivered to." In ac power systems, we modify our practice of always using the passive sign convention. We continue to use the passive convention (current directed in at the + voltage reference) for all passive loads, but switch to the active convention (current directed out at the + voltage reference) for all sources. In either case we calculate complex power as
            S
            =
            VI*
            =
            P
            +
            jQ.
            The net result is that the average power "produced by" a source or "delivered to" a load has the same sign.
          













EXAMPLE 16-4


A load consisting of a 2.5-kΩ resistor in parallel with a 2-μF capacitor is connected across a 440-V(rms), 60-Hz voltage source. Find the complex power delivered to the load and the load power factor. State whether the power factor is leading or lagging. Validate your answers using Multism.




SOLUTION:


The source angular frequency is ω = 2π60 = 377 rad/s. The impedance of the load is



The magnitude (rms value) of the current through the load is found as



The complex power delivered to the load and the load power factor are




                The power factor is leading since
                Q
L
                is negative.
                ■






One can use Multisim to find the desired results as follows:

            Build the circuit in Multisim. Use the ac power source set at 440 V(rms). Select "Single Frequency AC Analysis" and set the frequency parameters to 60 Hz and "Real/ Imaginary" for the Complex number format. Then under the "Output" tab ask Multisim to calculate the desired parameters. Note that none of the desired parameters are readily selectable but need to be constructed using "Add Expression." To calculate the complex load
            Z
L
            , we add the expression "V(1)/-" where V(1) is the source voltage and is the source current. Note that is negative because of the passive sign convention, that is, we want the current into the load not into the source. To calculate the complex power
            S
L
            , we add the expression:
            S
L
            = |
            I
L
            |
            2
Z
L
            , which is written as "(mag(-I(V1))^2)*V(1)/-I(1)". And finally, to calculate the power factor pf, we add the expression pf =
            P
L
            /|
            S
L
            | =
            Re
            {
            S
L
            }/|
            S
L
            |, which we can enter as
            
            "real((mag(- I(V1))^2) *V(1)/-I(1))/mag((mag(-I(V1))^2)*V(1)/-I(1))". Running the simulation, Grapher View returns the following as shown in
            Figure 16-5
            :
          



These are the same results calculated above by hand.







FIGURE 16-5

















EXAMPLE 16-5


                    In
                    Figure 16-6
                    (a), the two parallel loads are connected across a 15-V (rms) source.
                  

(a)  Find the complex power delivered to each load.
(b)  Find the complex power produced by the source.










FIGURE 16-6








SOLUTION:




                  (a)  The voltage across each load is 15<0° V and the load impedances are Z
                  1
                  = 100 Ω and
                  Z
2
                  = 60−
                  j
                  200 Ω. The load currents shown in the figure are
                  


The complex power delivered to each load is





                  (b)  We could calculate the source power by first finding
                  I
                  =
                  I
1
                  +
                  I
2
                  and then calculating
                  S
                  =
                  VI*
                  . However, the conservation of complex power allows us to calculate the power "produced by" the source as the sum of the powers "delivered to" the loads.
                  


The power factor of the source is




                    The power factor is leading since
                    Q
                    is negative.
                    ■

















Exercise 16-4




                A load consisting of a 50-Ω resistor in parallel with an inductor whose reactance is 75 Ω is connected across a 500-V(rms) source (
                Figure 16-6
                (b)). Find the complex power delivered to the load and the load power factor. State whether the power factor is leading or lagging. Validate your results using Multisim.
              


Answers:



S
L
                = 5 +
                j
                3.33 kVA, pf = 0.832, lagging
              



Single Frequency AC Analysis @60Hz


Variable
Real
Imaginary





                      V(1)/-I(V1) =
                      Z
IN

34.6
23.1



                      (mag(-I(V1))^2)*V(1)/-I(V1) =
                      S
L

5000
3332


real((mag(-I(V1))^2)*V(1)/-I(V1))/mag((mag(-I(V1))^2)*V(1)/-I(V1))=pf
0.832
0












FIGURE 16-6

















EXAMPLE 16-6


                    In
                    Figure 16-7
                    the load
                    Z
L
                    is a 100-Ω resistor in series with a capacitor whose reactance is - 60 Ω. The source voltage is 880 V(rms). Find the complex power delivered to the load and the load power factor. Is the power factor leading or lagging?
                  




SOLUTION:


By inspection the node-voltage equation at node A is




                Solving for
                V
L
                with
                V
S
                = 880<0°V and
                Z
L
                = 100 -
                j
                60 Ω yields
                V
L
                = 411 +
                j
                309 V (rms). The magnitude of the load current is
              



The complex power delivered to the load and the load power factor are




                The power factor is leading since
                Q
L
                is negative.
                ■
















Exercise 16-5



                In
                Figure 16-7
                , the load
                Z
L
                is an 80-Ω resistor and the source voltage is 220 V(rms). Find the complex power produced by the
                source.
                Assuming 60 Hz for the source, validate your answer using Multisim. Repeat for the complex power delivered to the
                load.



Answer:



S
S
                = 594 +
                j
                288 VA,
                S
L
                = 144 +
                j
                0 VA
              









FIGURE 16-7














EVALUATION EXAMPLE 16-7



Figure 16-8
                shows the residential power distribution circuit used in the United States. The circuit is called three-wire, single-phase service. The term
                three-wire
                refers to the three lines (A, B, and neutral) connecting the sources to the loads
                Z
1
                ,
                Z
2
                , and
                Z
3
                . The term
                single-phase
                means that the two voltage sources
                V
S1
                = 110<0° and
                V
S2
                = 110<0° are in phase. The loads
                Z
1
                and
                Z
2
                are connected between line A or B and the neutral line. These impedances represent small-appliance and lighting loads that require 110 V (rms) service. The load
                Z
3
                is connected between line A and line B and represents heavier loads that require 220 V(rms) service. The impedances
                Z
W
                and
                Z
N
                are line impedances that are normally much smaller than the load impedances.
              







FIGURE 16-8



Residential power distribution circuit.




                Many older US homes have a 100-A, 220-V service delivering 22 kVA. Suppose each 110-V source has a rated output capacity of 11 kVA and the three loads are
                Z
1
                = 30 +
                j
                12 Ω,
                Z
2
                = 24 +
                j
                8 Ω, and
                Z
3
                = 3 +
                j
                2 Ω. In addition, the two line impedances are
                Z
W
                = 0.05 +
                j
                0 Ω and
                Z
N
                = 0.14 +
                j
                0 Ω. The evaluation problem is to determine whether the two sources can supply these loads without exceeding their rated output. The mesh current
                I
A
                in
                Figure 16-8
                is the current out of the + terminal of the upper source
                V
SI
                ; hence the complex power produced by this source is
                S
upper
                =
                V
S1
                (
                I
A
                )*. Similarly, mesh current
                I

B

                is the current out of the + terminal of the lower source
                V
S2
                ; hence it produces
                V
lower
                =
                V
S2
                (
                I

B

                )*. To complete the evaluation we need to find
                I
A
                and
                I
B
                .
              

                By inspection, mesh-current equations for the circuit in
                Figure 16-8
                are
              



Using MATLAB to solve for the mesh currents, we first assign values to the known circuit parameters.




                We formulate the problem in matrix form using the
                Ax
                =
                B
                structure as follows:
              





                We now have the mesh currents I
                

a


                and I
                

b


                and can calculate the required complex powers as
              



The corresponding MATLAB output is



In round numbers, the apparent powers produced by the two sources are



Both apparent power outputs are within the 11-kVA rating.

                Suppose that you purchase an electric vehicle (EV) and want to install a level 2 charger (220 V, 40 A) that allows fast charging of about 30-40 miles of range per hour of charge versus 3-5 miles per hour for a level 1 charger (120 V, 12 A). To see how the electric service responds, place a 5.5-Ω resistor (220 V/40 A) in parallel with
                Z
3
                in
                Figure 16-8
                and repeat the problem.
              
MATLAB returns



The apparent powers produced by the two sources are




                While both lines are below the 11 kVA maximum, the system is dangerously close to triggering circuit breakers. If, for example, you turn on the air conditioner, or a clothes dryer, or even an iron or a toaster oven, you could easily exceed the breakers. If you want to use a level 2 charger, you will likely need to upgrade your service to allow for the additional load.
                ■





16-4 Single-Phase Power Flow

            In the previous section, the analysis objective was to find the voltages and currents needed to calculate an
            unknown
            complex power delivered to a load. In a
            power flow problem,
            the complex power delivered to a load is specified, and the unknowns are the voltages and currents that will make this power flow happen. The power flow problem is completely different from maximum power transfer. In the latter situation, the source is fixed and the load is adjusted to produce maximum power transfer. In a power system, the load power is fixed by customer demand and the system operator adjusts the source output to meet the demand.
          

            We illustrate power flow analysis using the
            two-wire, single-phase
            power system in
            Figure 16-9
            . This system consists of ac source
            V
S
            supplying power to a load
            Z
L
            through a two-wire transmission line with an impedance of
            Z
W
            in each wire. The analysis objective is to find the source outputs required to deliver a prescribed complex power to the load.
          







FIGURE 16-9



A simple electrical power system.




            There are several ways to specify the complex power at the load. The most obvious is simply to specify the average power
            P
L
            and reactive power
            Q
L
            . We can also specify the apparent power |
            S
L
            | and the power factor pf = cosθ, in which case the complex load power is
          



(16-17)






            where the plus sign in
            Eq. (16-17)
            applies to lagging power factors and the minus sign to leading power factors. Given the average power
            P
L
            and the power factor, we calculate the apparent power as |
            S
L
            | =
            P
L
            /pf and use the equation above to obtain
            S
L
            . Finally, the complex power delivered by a given current
            I
L
            through a load
            Z
L
            is
          















EXAMPLE 16-8



                    The average power delivered to the load in
                    Figure 16-9
                    is 20 kW at a lagging power factor of 0.8. The load voltage magnitude is 480 V (rms) and the two-wire line has an impedance of
                    Z
W
                    = 0.1 +
                    j
                    0.6 Ω per wire. Find the required apparent power output and rms voltage of the source.
                  




SOLUTION:




                For
                P
L
                = 20 × l0
                3
                W at a power factor of pf = 0.8, the complex power delivered to the load using
                Eq. (16-17)
                is
              




                Given |
                V
L
                | = 480 V, the magnitude (rms value) of the load current is
              




                The single-phase system in
                Figure 16-9
                has a
                two-wire
                transmission line, so the total complex power absorbed by the line is
              




                The source in
                Figure 16-9
                supplies both
                S
W
                and
                S
L
                ; hence by complex power conservation,
              




                The required source apparent power is |
                S
S
                | = 27.5 kVA. The rms value of the source voltage is
              




■





















EXAMPLE 16-9



                    Repeat
                    Example 16-8
                    when the load power factor is increased to 0.95 and all other conditions remain the same.
                  




SOLUTION:



                For
                P
L
                = 20 × 10
                3
                Wat a power factor of pf = 0.95, the complex power delivered to the load is
              




                For |
                V
L
                | = 480 V the magnitude (rms value) of the load current is
              



The total complex power absorbed by the two-wire line is



The power produced by the source is




                and the required source power is |
                S
S
                | = 22.24 kVA. The required rms source voltage is
              




                In
                Example 16-8
                , the load power factor and reactive power are pf = 0.8 and
                Q
L
                = 15 kVAR. In this example, the load power factor and reactive power are pf = 0.95 and
                Q
L
                = 657 kVAR. The decrease in the load reactive power reduces the required source output from 27.5 kVA to 222 kVA. The apparent power capacity of the source is a limiting factor in a power system. The reactive power of the load affects the system-generating capacity even though it transfers no net energy to the load.
                ■















Exercise 16-6



                A single-phase source supplies a load through a two-wire line with an impedance of
                Z
W
                =2 +
                j
                10 Ω per wire. The rms load voltage is 2.4 kV and the load receives an apparent power of 25 kVA at a lagging power factor of 0.85. Find the required source power and rms voltage.
              


Answer:


26.6 kVA and 2.55 kV(rms)



Power Factor Correction

              An ac power system generally operates at a lagging power factor since most loads are inductive. The system sources must have the kVA capacity to furnish both the average power and the positive reactive power the inductive loads demand. As we saw in
              Example 16-9
              , this reactive power flow increases the kVA demand on the source. For this reason, large industrial customers may pay a premium for the average power consumed by inductive loads with low power factors.
            


Power factor correction
              is a process that increases the power factor without changing the power flow to an inductive load. The correction is achieved by adding capacitance in parallel with the inductive load
              Z
L
              , as shown in
              Figure 16-10
              . You may have noticed capacitors on all types of motors from garage-door openers, to air conditioning compressors, to power tools. To see how this improves the power factor, we first find the reactive power of the capacitor. The voltage across the capacitor is
              V
L
              since it is in parallel with the load
              Z
L
              . The capacitor current is
              I
C
              =
              j
              ω
              C
V
L
              , so the reactive power delivered to the capacitor is
            




              The reactive power
              Q
C
              is always negative while
              Q
L
              for an inductive load is always positive. The reactive power supplied to the parallel combination is
              Q
L
              +
              Q
C
              , which means that
              Q
C
              can cancel part (or all) of
              Q
L
              . The net decrease in reactive power means that the power factor of the parallel combination is higher than the power factor of the inductive load acting alone.
            

              The parallel capacitor does not change the power flow to the inductive load since voltage
              V
L
              and current
              I
L
              in
              Figure 16-10
              are unchanged. In terms of power flow, the local capacitor "supplies" part (or all) of the reactive power required by the inductive load. Physically, reactive power represents a periodic interchange of energy. With power factor correction, this interchange occurs between an inductive load and a local capacitor rather than between the inductive load and a distant power source.
            







FIGURE 16-10



Circuit used for power factor correction.














EXAMPLE 16-10


                      The inductive load
                      Z
L
                      in
                      Figure 16-10
                      draws an apparent power of 5 kVA at a lagging power factor of 0.75 when the load voltage is 1.2 kV (rms) at 60 Hz. Find the power factor of the parallel combination when
                      C
                      = 5 μF.
                    




SOLUTION:



                  For |
                  S
L
                  | = 5 kVA at a lagging power factor of 0.75, the complex power delivered to
                  Z
L
                  is
                




                  When |
                  V
L
                  | = 1200 V(rms) at 60 Hz, the reactive power of a 5-μF capacitor is
                



The total complex power delivered to the parallel combination is



and the "corrected" power factor of the parallel combination is




■





















DESIGN EXAMPLE 16-11



                      The inductive load
                      Z
L
                      in
                      Figure 16-10
                      draws an apparent power of 2 kVA at a lagging power factor of 0.8 when the rms load voltage is 880 V(rms) at 60 Hz. Find the value of the capacitance
                      C
                      needed to raise the power factor of the combination to 0.95 lagging.
                    




SOLUTION:



                  For |
                  S
L
                  | = 2 kVA at a lagging power factor of 0.8, the complex power delivered to
                  Z
L
                  is
                




                  Since
                  P
L
                  = 1600 W, the parallel combination must draw an average power of 1600 W because the capacitor does not draw any average power. To deliver 1600 W at a power factor of 0.95, the complex power delivered to the parallel combination must be
                




                  The capacitive reactive power needed to produce this result is the difference between the reactive power in
                  S
P
                  and
                  S
L
                  . That is,
                




                  Since
                  Q
C
                  = -2π
                  fC
                  |
                  V
L
                  |
                  2
                  , the required capacitance is found to be
                




■


















Design Exercise 16-7



                  A machine shop has purchased a new power lathe that runs on 220 V and 60 Hz. The shop's owner wants to reduce the power costs by improving its power factor. The input impedance to the lathe is 50 +
                  j
                  45.2 Ω.
                

(a)  Find the current power factor.
(b)  Select an appropriate compensating capacitor to improve the power factor to 0.98.
(c)  Verify your results using Multisim.



Answers:



                  (a) pf = 0.742. (b)
                  C
                  = 20.5 μF. (c) See Multisim output.
                



Single Frequency AC Analysis @60 Hz


Variable


f

                        (Hz)
                      
Real
Imaginary





                        V(1)/-I(V1) =
                        Z
IN (before)

60
50 Ω
45.24 Ω



                        V(3)/-I(V2) = Z
                        IN (compensated)

60
87.35 Ω
17.68 Ω



                        (mag(-I(V1))^2)*V(1)/-I(V1) =
                        S
L

60
532.3 W
481.6 VAR



                        (mag(-I(V2))^2)*V(3)/-I(V2) =
                        S
P

60
532.3 W
107.7 VAR



                        real((mag(-I(V1))^2)*V(1)/-I(V1))/mag((mag (-I(V1))^2)*V(1)/-I(V1)) = pf
                        before

60
0.742
0



                        real((mag(-I(V2))^2)*V(3)/-I(V2))/mag((mag (-I(V2))^2)*V(3)/-I(V2)) = pf
                        compensated

60
0.980
0







16-5 Balanced Three-Phase Circuits


              Global demand for electric power is increasing dramatically. Most electricity today is generated via ac generators essentially the same way it has been for over a century. However, new methods are evolving. In most cases, a generator, an electric machine, is mechanically turned to produce ac electricity. What is used to turn the generator's shaft is quite varied. In many cases, heat energy is generated by burning fossil fuels (coal, natural gas, oil, wood, peat, and methane). This energy then is used to heat a liquid, usually water, until it produces pressurized steam which is directed into a turbine's blades that turn an electric generator. Nuclear reactors use radioactive fission energy to heat fluids to drive the turbine. Geothermal plants use several techniques but a common one forces water into hot geothermal energy areas and use the steam forced upward to drive the turbines. Hydroelectric and tidal plants use gravity to force water pressure directly into turbines. And today increasingly, windmills generate ac electricity directly from wind power, the blades themselves are the turbine that turns the generator. A small fraction of total electric generation comes from dc sources, but the amount is increasing. Namely, photovoltaic (solar) cells and electrochemical cells (batteries). There are also many other sources of energy, for example, hydrogen fuel cells, but they currently only contribute a very small amount of the total power used. Nuclear fusion is on the horizon and could ultimately supplant many of our conventional energy sources. Once created, ac power can be converted to dc power using rectifiers and dc power converted into ac power using inverters. For our discussion, we will focus only on ac power systems.
            
Most electricity is generated at a fixed location: a power station, hydroelectric or geothermal plant, a windmill, or solar farm. Once generated, the power must be distributed to the users. The electric ac power is transferred from the generating sources, boosted by step-up transformers to very high voltages and distributed using transmission lines that one can see marching across the landscape. Along the line, substations located near users, such as major factories, population centers, and the like, take the high voltage and reduce it to lower, but still high levels using step-down transformers. Subsequently, the electricity is transferred from the substations to the end users via a distribution network and a second step-down transformer, often seen as canisters on power poles for residential distribution or larger-sized transformers sitting on the ground near shopping centers and small factories or industrial complexes.

              Transmission lines typically use three-phase alternating current (ac) at high-voltages and are carried on towers similar to that pictured in
              Figure 16-11
              . Smaller towers at lower voltages are used for the distribution network that delivers electricity to industrial users using three-phase power. Residential and small commercial consumers use split-phase 120V/240V power. In this section, we will concentrate on three-phase power.
            







FIGURE 16-11



Three-phase power transmission tower.




              In a single-phase circuit, all of the voltage sources have the same phase angle. A three-phase circuit contains three singlephase circuits with each source at a different phase angle.
              
Figure 16-12
              shows a three-phase power circuit made up of three single-phase circuits. The power flows from the sources to the loads though three lines labeled A, B, and C. The phasor currents in these lines, labeled
              I
A
              ,
              I
B
              , and
              I
C
              , are called line currents. There is also a neutral line labeled N shown carrying a current
              I
N
              . As we shall see,
              I
N
              = 0 in balanced three-phase circuits, so this line plays no role in the power flow from source to load.
            







FIGURE 16-12



Voltages and currents associated with three-phase circuits.




Balanced Three-Phase Voltages

                There are six voltages associated with the three-phase sources in
                Figure 16-12
                , namely three line-to-line voltages and three line-to neutral voltages. These six voltages are defined using two subscripts to identify the two points across which the voltage is measured. In this double subscript notation there is an implied + reference mark at the first subscript and an implied - at the second.
                
1

                For example,
                V
AB
                is the voltage between line A and line B with an implied + at A and a - at B. Using this convention, the other two line-to-line voltages are denoted
                V
BC
                and
                V
CA
                . Collectively, these three line-to-line voltages are called simply the
                line voltages.
                Using the same convention, the three line-to-neutral voltages are denoted
                V
AN
                ,
                V
BN
                , and
                V
CN
                and are collectively called the
                phase voltages.


                These two sets of voltages are not independent since they are constrained by KVL. Applying KVL in
                Figure 16-12
                around the closed path from point N to A to B and back to N yields -
                V
AN
                +
                V
AB
                +
                V
BN
                = 0 or
              



(16-18a)




Applying the same logic to the paths N to B to C to N and N to C to A to N leads to



(16-18b)




These equations show that the line and phase voltages are not independent.

                The balanced three-phase source in
                Figure 16-12
                produces phase voltages of the form
              



(16-19)





                That is, a balanced source produces phase voltages that are (1) separated in phase by 120° and (2) have the same magnitude
                V
P
                , where the scalar
                V
P
                is the rms value of each phase voltage.
                Figure 16-13
                (a) is the phasor diagram of the phase voltages in
                Eq. (16-19)
                . This arrangement is called the
                positive phase sequence
                or ABC sequence since
                V
AN
                leads
                V
BN
                by 120° and
                V
BN
                in turn leads
                V
CN
                by 120°.
              







FIGURE 16-13



Two possible phase sequences (a) Positive. (b) Negative.




Figure 16-13
                (b) shows the ACB or
                negative phase sequence
                obtained by interchanging the positions of
                V
BN
                and
                V
CN
                in the ABC sequence. Physically, the negative phase (ACB) sequence merely switches the labels on lines B and C in
                Figure 16-12
                .
                
2

                In what follows we will always use the positive
                
                (ABC) sequence, except in a few homework problems where the negative sequence is specifically called for.
              

                The sum of the phase voltages in
                Eq. (16-19)
                is
              




                This zero-sum property is also evident graphically in
                Figure 16-13
                , where we see that the sum of any two of the phasors is the exact opposite of the third. Any set of three phasors is said to be
                balanced
                when the phasors have equal amplitudes and 120° phase separation. The sum of any balanced set of phasors is always zero.
              

                Inserting the phase voltages
                V
AN
                and
                V
BN
                from
                Eq. (16-19)
                into
                Eq. (16-18a)
                yields the line voltage
                V
AB
                .
              



(16-20a)





                Similarly, inserting
                Eq. (16-19)
                into
                Eq. (16-18b)
                gives the other two line voltages:
              



(16-20b)





                The three line voltages in
                Eqs. (16-20a
                and
                b
                ) are balanced since they are separated in phase by 120° and all have a magnitude of
                
                .
                Figure 16-14
                shows the phasor diagram of the three line voltages and the phase voltages in
                Eq. (16-19)
                .
              







FIGURE 16-14



Phasor diagram showing phase and line voltages for the positive phase sequence.



Note that each line voltage leads a corresponding phase voltage by 30°. We will often make use of this 30° phase lead.

                In a balanced system, the scalar
                V
L
                denotes the magnitude (rms value) of the line voltages. Obviously,
                V
L
                is related to the phase voltage magnitude
                V
P
                as
              


(16-21)




                In a three-phase circuit, the line-to-line voltages are
                
                times as large as the line-to-neutral voltages. This ratio appears in three-phase equipment ratings, such as 120/208 V, where 120 is the phase voltage and 208 the line
                
                .
              

                It may seem that keeping track of six voltages all at different phase angles makes three-phase circuits much more complicated than single-phase circuits. Actually,
                balanced
                three-phase circuits are not that complicated because the six voltages are not independent and their phasors have a great deal of symmetry. In fact, given the phase sequence and any one of the six voltages, we can get the other five.
              












EXAMPLE 16-12



                        In a balanced three-phase circuit, the line voltages have an rms value of
                        V
L
                        = 480 V(rms). Using <
                        V
AB
                        as the phase reference, find all of the line and phase voltages for a positive phase sequence.
                      





SOLUTION:



                    The specified phase reference means that we arbitrarily assign <
                    V
AB
                    = 0°. This assignment together with
                    V
L
                    = 480 allows us to write
                    V
AB
                    = 480<0° V(rms). The other two line voltages have the same rms value,
                    V
L
                    = 480, and phase angles that lag <
                    V
AB
                    at 120° intervals. For a positive (ABC) phase sequence, these voltages are
                    V
BC
                    = 480< - 120° V(rms) and
                    V
CA
                    = 480< - 240° V(rms). The rms value of the phase voltages is
                    
                    . In
                    Figure 16-14
                    , we see that the line voltage
                    V
AB
                    leads the phase voltage
                    V
AN
                    by 30°. Since <
                    V
AB
                    = 0° is the phase reference, we can write
                    V
AN
                    = 277< - 30° V(rms). The other two phase voltages have the same rms value and lag <
                    V
AN
                    = -30° at 120° intervals. For a positive phase sequence, these voltages are
                    V
BN
                    = 277< -150° V(rms) and
                    V
CN
                    = 277< - 270° V(rms).
                  

                    There is nothing absolute about assigning <
                    V
AB
                    = 0° as the phase reference. A three-phase circuit has an abundance of voltages and currents all with different phase angles. We have to start somewhere by choosing one of the phasors as the phase reference. The choice is arbitrary, but we often use <
                    V
AN
                    = 0 as a phase reference. Had we done so in this example, the phasor magnitudes
                    V
P
                    and
                    V
L
                    would be unchanged but all phase angles would increase by 30°.
                    ■















Exercise 16-8



                    In a balanced three-phase circuit, the rms line voltage is
                    V
L
                    = 7.2 kV(rms). Find all of the phase and line voltages for a positive phase sequence using <
                    V
AN
                    = 0° as the phase reference.
                  


Answers:



                    Phase voltages:
                    V
AN
                    = 4160<0° V(rms),
                    V
BN
                    = 4160<-120° V(rms),
                    V
CN
                    = 4160<-240° V(rms).
                  

                    Line voltages:
                    V
AB
                    = 7200< + 30
                    0
                    V(rms),
                    V
BC
                    = 7200<-90° V(rms),
                    V
CA
                    = 7200<-210° V(rms).
                  










Exercise 16-9


                    In a balanced three-phase circuit
                    V
BC
                    = 480<-120° V(rms). Find the phase voltages for a positive phase sequence.
                  


Answer:



                    Phase voltages:
                    V
AN
                    = 277< - 30° V(rms),
                    V
BN
                    = 277< -150° V(rms),
                    V
CN
                    = 277< - 270° V(rms).
                  




Balanced Three-Phase Connections

                A balanced three-phase source can be represented by three voltage sources. The sources can be either Y
                
3

                -connected, as in
                Figure 16-15
                (a), or Δ-connected, as in
                Figure 16-15
                (b). Similarly, a balanced three-phase load can be represented by three equal impedances that can be either Y-connected as in
                Figure 16-16
                (a) or Δ-connected as in
                Figure 16-16
                (b). These connections may be arranged various ways in a circuit diagram, but a Y-connection always involves three (and only three) elements tied together at a single node, while a Δ-connection always involves a loop containing three (and only three) elements.
              







FIGURE 16-15



(a) A Y-connected source. (b) A Δ-connected source.










FIGURE 16-16



(a) A Y-connected load. (b) A Δ-connected load.



Since the source and load can be either Y- or Δ-connected, it may seem that we must deal with four possible circuit configurations.





                      Configuration
                    
Source
Load


Y-Y
Y-connected
Y-connected


Y-Δ
Y-connected
Δ-connected


Δ-Y
Δ-connected
Y-connected


Δ-Δ
Δ-connected
Δ-connected



Keeping track of the various three-phase voltages and currents in four different configurations may look like a daunting task. Fortunately, there is a way to deal with all of these cases using an equivalent Y-Y circuit.

                To develop this equivalence, we start with balanced three-phase sources. The Y-connected sources in
                Figure 16-15
                (a) produce the phase voltages
                V
AN
                ,
                V
BN
                , and
                V
CN
                . The Δ-connected sources in
                Figure 16-15
                (b) produce the line voltages
                V
AB
                ,
                V
BC
                , and
                V
CA
                . In a balanced system, these voltages are not independent. Given any one of them, we can easily calculate the other five. Specifically, if a balanced Δ-connected source produces
                V
AB
                =
                V
L
                <ϕ, then a Y-connected source with
              


(16-22)



would produce the same line-to-line voltages as the Δ-connected source. In other words, a balanced Δ-connected source can be replaced by an equivalent Y-connected source without changing the response of the rest of the circuit.

                Actually, Δ-connected generators are rare because of practical limitations. If the three sources in
                Figure 16-15
                (b) are perfectly balanced, then
                V
AB
                +
                V
BC
                +
                V
CA
                = 0 and KVL is satisfied around the loop of voltage sources. However, even a slight imbalance can produce large losses due to a current circulating in this loop whose magnitude is limited only by the internal impedances of the sources. In addition, in circuit theory, a loop of ideal voltage sources is called a
                pathological circuit
                because there is no unique solution for the current produced by each source. For both practical and theoretical reasons, we will not treat Δ-connected sources further in our study.
              

                An equivalent Y-connected load can replace a Δ-connected load. First, observe that the impedance seen between any two terminals of the Y-connected load in
                Figure 16-16
                (a) is
                Z
Y
                +
                Z
Y
                = 2
                Z
Y
                . Second, note that the impedance seen between any two terminals of the Δ-connected load in
                Figure 16-16
                (b) is
                Z
Δ
                || (
                Z
Δ
                +
                Z
Δ
                ) =
                Z
Δ
                || (2
                Z
Δ
                ). The two loads are equivalent when these impedances are equal, that is, when
              




                Solving for
                Z
Y
                yields
              



(16-23)





                Any balanced Δ-connected load with phase impedance
                Z
Δ
                can be replaced by an equivalent Y-connected load whose phase impedance is
                Z
Y
                =
                Z
Δ
                /3 without changing the response of the rest of the circuit.
              

                The change from a Δ-connected load to an equivalent Y-connected load does not change the angle of the phase impedance. That is,
                Eq. (16-23)
                is a scalar change only so that
              





                This means that equivalent Y- and Δ-connected loads have the same power factor, pf = cos θ.
              












EXAMPLE 16-13



Figure 16-17
                        shows a balanced Δ-connected load in parallel with a balanced Y-connected load. The two-phase impedances are
                        Z
Δ
                        = 120 +
                        j
                        40 Ω and
                        Z
Y
                        = 50 +
                        j
                        30 Ω. Find the phase impedance of an equivalent Y-connected load.
                      









FIGURE 16-17








SOLUTION:



STEP 1

                      We first convert the Y-connected load in
                      Figure 16-17
                      into an equivalent Δ-connected load using
                      Eq. (16-23)
                      . The conversion yields phase impedances of 3
                      Z
Y
                      and produces the circuit configuration in
                      Figure 16-18
                      (a).
                    


STEP 2

                      Each phase impedance 3
                      Z
Y
                      is in parallel with phase impedance
                      Z
Δ
                      . Combining these parallel impedances as
                      Z
Δ
                      || 3
                      Z
Y
                      produces the equivalent Δ-connected load in
                      Figure 16-18
                      (b), where
                    








FIGURE 16-18










STEP 3

                      We use
                      Eq. (16-23)
                      again, this time to convert the load in
                      Figure 16-18
                      (b) into the equivalent Y-connected load in
                      Figure 16-18
                      (c), where
                    





                    In sum, Z
                    
YEQ

                    is the phase impedance of a balanced Y-connected load that is equivalent to the two parallel loads in
                    Figure 16-17
                    .
                    ■
















Exercise 16-10



                    Two balanced Δ-connected loads are connected in parallel. Their phase impedances are
                    Z
Δ1
                    = 50 +
                    j
                    24 Ω and
                    Z
Δ2
                    = 60 +
                    j
                    25 Ω. Find the equivalent Y-connected load for the two parallel loads using MATLAB.
                  


Answers:


The following MATLAB code solves the problem:








16-6 Three-Phase Circuit Analysis

              The analysis of the Y-Y circuit in
              Figure 16-19
              (a) is the key to understanding balanced three-phase circuits. The source and load in this circuit are Y-connected since both involve three elements tied together at a single node represented by the neutral line. This configuration involves three separate single-phase circuits with the source phase angles separated by 120°. The usual analysis objectives are to determine the line currents
              I
A
              ,
              I
B
              , and
              I
C
              and the power delivered to the load.
            







FIGURE 16-19



(a) Balanced Y-Y circuit. (b) Line currents and phase voltages in a Y-Y circuit.





              Each phase of Y-Y circuit has a load connected across a voltage source, so the three line currents are easily seen to be
            




              The line currents
              I
A
              ,
              I
B
              , and
              I
C
              form a balanced set of phasors because the source voltages
              V
CN
              ,
              V
BN
              , and
              V
CN
              are balanced. As a result, the line currents all have the same amplitude and are separated in phase by 120°. By calculating one line current—for example,
              I
A
              —we can easily construct
              I
B
              and
              I
C
              .
            

              Using <
              V
AN
              = 0° as the phase reference, the source voltage is written as
              V
AN
              -
              V
P
              <0°. Writing the phase impedance as
              Z
Y
              - |
              Z
Y
              |<6 leads to the line current
              I
A
              as
            


(16-24)




              The other two line currents lag
              I
A
              at 120° intervals; hence for a positive phase sequence
              I
B
              =
              I
L
              <-θ-120° A(rms) and
              I
C
              =
              I
L
              <-θ-240° A(rms). In general usage, the scalar
              I
L
              denotes the magnitude (rms value) of the line currents in any balanced three-phase circuit. For a balanced Y-connected load,
              I
L
              is defined by
            



(16-25)





Figure 16-19
              (b) shows a phasor diagram of the line currents and phase voltages in a Y-Y circuit.
            







FIGURE 16-19







              Applying KCL at node N in
              Figure 16-19
              (a) yields
              I
A
              +
              I
B
              +
              I
C
              +
              I
N
              = 0. Since the line currents are balanced their sum is
              I
A
              +
              I
B
              +
              I
C
              = 0, hence KCL requires
              I
N
              = 0. There is no current in the neutral connection of a balanced Y-Y circuit. The response of the circuit is not changed when this line is replaced by any impedance whatsoever, including infinite. Put differently, the power flow does not change when the neutral line in
              Figure 16-19
              (a) is removed. As a visual aid, however, we may continue to show the neutral line in Y-Y circuits because it serves as a reference node for the phase voltages.
            













EVALUATION EXAMPLE 16-14


                      In a balanced Y-Y circuit 60-Hz system, the line voltage is
                      V
L
                      - 480 V rms and the phase impedance is
                      Z
Y
                      = 24 +
                      j
                      9 Ω per phase. Using <
                      V
AN
                      = 0° as the phase reference, find the line current and line voltage phasors for a positive phase sequence. Then using Multisim, place a small 1-pΩ resistor in the neutral line, essentially a short circuit. Measure the current through the neutral line. Now, increase the resistance to 1 TΩ, essentially an open circuit, and measure the current again. Comment on the purpose of the neutral line.
                    




SOLUTION:



                  The magnitude of the phase voltage is
                  
                  . For the given phase reference, we have
                  V
CN
                  = 277<0° and the phase A line current is found to be
                





                  The other two line currents have the same magnitude and are separated in phase by 120°. For a positive phase sequence, these currents are
                  I
B
                  = 10.8< - 140.6° A(rms) and
                  I
C
                  = 10.8< - 260.6° A(rms). In a positive phase sequence
                  V
AB
                  leads
                  V
AN
                  by 30°; hence
                  V
AB
                  =
                  V
L
                  <30° = 480<30° V(rms). The other two line voltages are
                  V
BC
                  = 480< - 90° V (rms) and
                  V
CA
                  = 480< - 210° V(rms).
                

                  Knowing the frequency, we can find the inductor's inductance as 23.9-mH. This results in
                  Z
Y
                  being a 24-Ω resistor in series with a 23.9-mH inductor. We ran a single frequency ac analysis, and Grapher View returned the table in
                  Figure 16-20
                  . The results for the line current and line voltage phasors are the same as those calculated by hand. One should note that while there is a very, very small current flowing through the neutral line, the values of the line voltages and currents have not changed. This leads one to believe, correctly, that the neutral line is not necessary.
                







FIGURE 16-20









Single Frequency AC Analysis @ 60 Hz


Variable
Magnitude
Phase (deg)




V(a)-V(b)
479.8
30


V(a_1)-V(b_1)
479.8
30


V(b)-V(c)
479.8
-90


V(b_1)-V(c_1)
479.8
-90


V(c)-V(a)
479.8
150


V(c_1)-V(a_1)
479.8
150



                        I(R1) -
                        I
C
                        N=0
                      
10.8
99.4



                        I(R2) -
                        I
B
                        N=0
                      
10.8
-140.6



                        I(R3) -
                        I
A
                        N=0
                      
10.8
-20.6



                        I(R5) -
                        I
C
                        N=∞
                      
10.8
99.4



                        I(R6) -
                        I
B
                        N=∞
                      
10.8
-140.6



                        I(R7) -
                        I
A
                        N=∞
                      
10.8
-20.6



                        I(R4) -
                        I
N
                        N=0
                      
4.2E-15
58



                        I(R8) -
                        I
N
                        N=∞
                      
2E-26
45




■

















Exercise 16-11



                  A balanced Y-Y circuit operates with
                  V
L
                  = 4160 V(rms) and phase impedances of
                  Z
Y
                  = 100 +
                  j
                  40 Ω per phase. Using <
                  V
AB
                  = 0° as the phase reference, find
                  I
A
                  and
                  V
AN
                  for a positive phase sequence.
                


Answer:



I
A
                  = 22.3<-51.8° A(rms),
                  V
AN
                  = 2400<-30° V(rms)
                



Figure 16-21
              (a) shows a Y-Y circuit with three equal impedances
              Z
W
              added to represent a three-wire transmission line connecting the source to the load. Adding line impedances does not unduly complicate the analysis since the overall Y-Y circuit is still balanced. The line impedances can be treated as part of an augmented Y-connected load whose phase impedance is
              Z
Y
              +
              Z
W
              .
            







FIGURE 16-21



A Y-Y circuit with line impedances.




              The main difference is that the line voltages at the source and at the load are not equal because of the voltage drop in the line. For this reason, the lines are labeled with uppercase letters (ABCN) at the source and with lowercase letters (abcn) at the load. For example, the line voltages are denoted
              V
AB
              ,
              V
BC
              , and
              V
CA
              at the source and
              V
ab
              ,
              V
bc
              , and
              V
ca
              at the load as shown in
              Figure 16-21
              (a).
            












EXAMPLE 16-15


                      In
                      Figure 16-21
                      (a), the load impedance and line impedances are
                      Z
Y
                      = 10 +
                      j
                      5 Ω per phase and
                      Z
W
                      = 0.15 +
                      j
                      0.85 Ω per phase, respectively. The magnitude of the line voltage at the source is
                      V
L
                      = 208 V(rms). Using <
                      V
AN
                      = 0° as the phase reference, find the line current phasors and the line voltage phasors at the load for a positive phase sequence. Validate your results using Multisim. Assume 60 Hz.
                    




SOLUTION:



                  In this example, the line voltage at the source is
                  V
L
                  = 208 V(rms). The phase voltage magnitude at the source is
                  
                  . This phase voltage appears
                  
                  across the combined impedance
                  Z
W
                  +
                  Z
Y
                  , so the line current magnitude is found to be
                




                  The specified phase reference means that
                  V
AN
                  = 120<0° V(rms). For a positive phase sequence, the other two line voltages are
                  V
BN
                  = 120< - 120° V(rms) and
                  V
CN
                  = 120< - 240° V(rms). The phase voltages at the load are balanced and are denoted
                  V
ab
                  ,
                  V
bc
                  , and
                  V
ca
                  . The three line currents are
                  I
A
                  ,
                  I
B
                  , and
                  I
C
                  . The first of these currents is found as
                




                  The remaining two line currents are related by 120°. Hence,
                  I
B
                  = 10.24 <-149.9° A(rms) and
                  I
C
                  = 10.24<-269.9° A(rms).
                

                  The phase voltages at the load are balanced and are denoted
                  V
an
                  ,
                  V
bn
                  , and
                  V
cn
                  . The first one is found as
                




                  Line voltages are
                  
                  times as large as the phase voltages and lead the phase voltages by 30°. Hence, we have
                




                  The other two line voltages are
                  V
bc
                  = 198.4< - 93.4° and
                  V
ca
                  = 198.4<-213.4° V(rms). The line magnitude at the load (198.4 V(rms)) is less than the line voltage at the source (208V(rms)) due to the voltage loss across the line impedances.
                

                  Multisim allows the circuit to be readily analyzed. Draw the circuit as shown in
                  Figure 16-21
                  (b). Note the impedances need to be converted into the time domain. Hence, the line inductance is
                  j
                  0.85 =
                  j
                  2π × 60
                  L
                  or
                  L
                  = 2.25 mH, and the load inductance is
                  j
                  5 =
                  j
                  2π × 60
                  L
                  or
                  L
                  = 13.3 mH. Ask Multisim to perform a Single Frequency AC analysis at 60 Hz. The desired line voltage phasors are the difference between the load voltages
                  V
an
                  ,
                  V
bn
                  , and
                  V
cn
                  . These need to be added as expressions for analysis. The line currents are simply the currents through each of the elements in the lines. We selected the current through the line resistors. Grapher View returned the table shown in
                  Figure 16-21
                  (c). Note that Multisim likes to avoid angles less than -180° by adding
                  
                  360° to the angle. Hence,
                  I
C
                  = 10.24<-269.9° A(rms) results in 10.24<90.1° A(rms), and
                  V
ca
                  = 198.4<-213.4°
                  V
                  (rms) is reported as
                  V
ca
                  = 198.4<146.6°
                  V
                  (rms).
                







FIGURE 16-21







■
















Exercise 16-12


                  In a balanced Y-Y circuit, the load and line impedances are
                  Z
Y
                  = 16 +
                  j
                  12 Ω per phase and
                  Z
W
                  = 0.25 +
                  j
                  15 Ω per phase. The line current is
                  I
L
                  = 14.2 A(rms). Find the line voltage phasors at the source using <
                  V
AN
                  = 0° as the phase reference. Verify your results using Multisim. Assume 60 Hz.
                


Answer:



V
AB
                  = 519.6<30.0° V(rms),
                  V
BC
                  = 519.6<-90.0° V(rms), and
                  V
CA
                  = 519.6<150.0° or 519.6<-210.0°V(rms).
                







Analysis of the Y-Δ Circuit

              We now extend our analysis of three-phase circuits to the Y-Δ circuit in
              Figure 16-22
              (a). In this circuit, the three sources are Y-connected because they are tied together at node N. The three load impedances are Δ-connected since they form a three-element loop. A neutral line is not shown in this case since the delta load has no place to connect a neutral line.
            







FIGURE 16-22



A Y-Δ circuit.




              When the analysis objective is to determine the line currents and the power flow, we replace the Δ-connected load by an equivalent Y-connected load and analyze the resulting Y-Y circuit. However, in some cases, we may also need to know the currents labeled
              I
AB
              ,
              I
BC
              and
              I
CA
              shown in
              Figure 16-22
              (a). These are the
              phase currents
              that exist in each load impedance of the Δ-connected load.
            

              The impedances
              z
Δ
              are connected from line to line so the phase currents are easily seen to be
            




              The phase currents
              I
AB
              ,
              I
BC
              , and
              I
CA
              are balanced because the line voltages
              V
AB
              ,
              V
BC
              , and
              V
CA
              are balanced. Since they are balanced, the phase currents all have the same amplitude and are separated by 120°. Hence, we can calculate one of them, say
              I
AB
              , and use it to get the other two.
            

              For a positive phase sequence using <
              V
AN
              = 0° as the phase reference, we have
              V
AB
              =
              V
L
              <30°. Writing the phase impedance as
              Z
Δ
              = |
              Z
Δ
              |<θ, the phase current
              I
AB
              is
            



(16-26)





              The other two phase currents lag
              I
AB
              at 120° intervals; hence for a positive phase sequence
              I
BC
              =
              I
P
              <-θ-90° A(rms) and
              I
CA
              =
              I
P
              <-θ-210° A(rms). In a balanced Δ-connected load, the scalar
              I
P
              denotes the magnitude (rms value) of the phase currents and is defined as
            



(16-27)





              It turns out that there is a simple relationship between line and phase currents. To show this we calculate the line current
              I
A
              in the equivalent Y-Y circuit. Using <
              V
AN
              = 0° as the phase reference, the appropriate phase voltage is
              
              . Writing the phase impedance in the equivalent Y-connected load as
              Z
Y
              = |
              Z
Δ
              /3|<θ, we express
              I
A
              as
            



(16-28)






              Comparing
              Eqs. (16-26)
              and
              (16-28)
              reveals two important results:
            



                that is, the line currents are
                
                times as large as the phase currents.
              

                <
                I
AB
                = <
                I
A
                + 30°, that is, phase currents lead line currents by 30°.
              


              The
              
              magnitude factor and 30° phase shift provide a simple way to get the phase currents from the line currents, or vice versa. Since both sets are balanced, we really only need to calculate one of them to get the other five.
            

              The next two examples illustrate that phasor responses in a balanced Y-Δ circuit can be found using
              I
A
              in the equivalent Y-Y circuit.
            












EXAMPLE 16-16



                      The line voltage at a Δ-connected load (see
                      Figure 16-22
                      (a)) with
                      Z
Δ
                      = 40 +
                      j
                      30 Ω per phase is
                      V
L
                      = 2.4 kV(rms). Find the line and phase current phasors using <
                      V
AN
                      = 0° as the phase reference. Verify your results using Multisim. Assume 60 Hz.
                    




SOLUTION:



                  We first calculate the line current
                  I
A
                  in the equivalent Y-connected load. The phase voltage at the load is
                  
                  and the load impedance is
                  Z
Y
                  =
                  Z
Δ
                  /3 = 13.33+
                  j
                  10 Ω. For the specified phase reference we have
                  V
AN
                  = 1386<0° V(rms), and the phase A line current is calculated as
                




                  The other two line currents lag
                  I
A
                  at -120° intervals. For a positive phase sequence, these currents are
                  I
B
                  = 83.1<-156.9° A(rms) and
                  I
C
                  = 83.1<-276.9° A(rms). The magnitude of the phase current is
                  
                  . For a positive phase sequence, the phase current
                  I
AB
                  leads
                  I
A
                  by 30°; hence
                  I
AB
                  = 48<-6.9° A(rms) and the other two phase currents are
                  I
BC
                  = 48<-126.9° A(rms) and
                  I
CA
                  = 48<-246.9° A(rms).
                

                  Another approach is to calculate
                  I
AB
                  directly in the Δ-connected load. Using <
                  V
AN
                  = 0° as the phase reference, the appropriate line voltage is
                  V
AB
                  =
                  V
L
                  <30° = 2400<30° V(rms). This voltage appears across the impedance
                  Z
Δ
                  ; hence
                  I
AB
                  is found to be
                




                  which is the same as the result derived using the line current
                  I
A
                  .
                

                  Multisim allows the Δ-circuit to be readily analyzed. Draw the circuit as shown in
                  Figure 16-22
                  (b). Note that the impedances need to be converted into the time domain. Hence, the load inductance is
                  j
                  30=
                  j
                  2π × 60
                  L
                  or
                  L
                  = 79.6 mH. Ask Multisim to perform a Single Frequency AC Analysis at 60 Hz. The desired line current is the current exiting (not entering) the sources
                  V
AN
                  ,
                  V
BN
                  , and
                  V
CN
                  . Hence, add new expressions: -I(V1), -I(V2), and -I(V3). The phase currents are simply the currents through each of the elements in each branch of the delta load. We selected the current through the load resistors: I(R4), -I(R5), and I(R6). Grapher View returned the table shown in
                  Figure 16-22
                  (c). These results are the same as those calculated earlier.
                







FIGURE 16-22







■
















Exercise 16-13


                  The line voltage at a Δ-connected load with
                  Z
Δ
                  = 520 +
                  j
                  400 Ω per phase is
                  V
L
                  = 1300 V(rms). Find
                  I
A
                  and
                  I
AB
                  using <
                  V
AN
                  = 0° as the phase reference. Verify your results using Multisim. Assume 60 Hz.
                


Answer:



I
A
                  = 3.43<-37.57 A(rms),
                  I
AB
                  = 1.98<-757° A(rms)
                















EXAMPLE 16-17


                      A balanced three-phase source with
                      V
L
                      = 200 V(rms) feeds a Δ-connected load with
                      Z
Δ
                      = 12 +
                      j
                      6 Ω per phase through a three-wire line with
                      Z
W
                      = 0.1 +
                      j
                      0.55 Ω per phase. Find the line current and phase current phasors using <
                      I
A
                      = 0° as the phase reference.
                    




SOLUTION:



                  The phase impedance of the equivalent Y-connected load
                  Z
Y
                  =
                  Z
Δ
                  /3 = 4 +
                  j
                  2 Ω. The phase voltage magnitude at the source is
                  
                  . In each phase, the voltage
                  V
P
                  appears across the series combination of
                  Z
W
                  +
                  Z
Y
                  ; hence the line current magnitude is
                




                  Using <
                  I
A
                  as the phase reference means
                  I
A
                  = 23.9<0° A(rms) and the other two line currents lag
                  I
A
                  at -120° intervals. For a positive phase sequence, these currents are
                  I
B
                  = 23.9<-120° A(rms) and
                  I
C
                  = 23.9<-240° A(rms). The phase current magnitude is
                  
                  . The phase current
                  I
AB
                  leads
                  I
A
                  by 30; hence
                  I
AB
                  = 13.8< + 30° A(rms) and the other two phase currents are
                  I
BC
                  = 13.8< - 90° A(rms) and
                  I
CA
                  = 13.7<-210° A(rms).
                

                  Again, we can easily get the phase currents in the Δ-connected load by first finding the line current
                  I
A
                  in the equivalent Y-Y circuit.
                  ■














Exercise 16-14


                  The phase B line current in a Δ-connected load with
                  Z
Δ
                  = 14 +
                  j
                  9Ω per phase is
                  I
B
                  = 26∠-165° A(rms). Find
                  I
AB
                  and
                  V
AB
                  for a positive phase sequence.
                


Answers:



I
AB
                  = 15∠-15° A(rms),
                  V
AB
                  = 250∠17.7° V(rms)
                



              The phasor responses in a balanced three-phase circuit can be found in several ways using various methods of ac circuit analysis. However, the previous examples
              
              suggest a shortcut method based on the phasor symmetries in balanced circuits. Because of these symmetries phasor responses can be derived from
              I
A
              (or
              I
AB
              ) and
              V
AN
              (or
              V
AB
              ) using a
              
              magnitude change and a 30° phase shift. As a matter of analysis strategy, a shortcut method of finding phasor responses is to find first
              I
A
              and
              V
AN
              in the equivalent Y-Y circuit. Then use the inherent phasor symmetries in balanced circuits to find other phasor voltages and currents as needed.
            
These symmetries, however, are lost when the circuit is unbalanced. For example, the line current symmetries are lost when the load is made up of three unequal impedances. Such simple unbalanced circuits can be handled by ac circuit analysis methods, including simulations. However, circuit models for a power system involve levels of complexity that are extremely difficult to manage using ordinary ac circuit analysis. For this reason, unbalanced three-phase circuits are analyzed using symmetrical components.
The method of symmetrical components is treated in detail in courses on power system analysis. Briefly, this method divides an unbalanced circuit into three parts:


                A
                balanced
                three-phase circuit with a positive phase sequence
              

                A
                balanced
                three-phase circuit with a negative phase sequence
              

                Three identical
                single-phase
                circuits
              


              Responses in the unbalanced circuit are then calculated as a superposition of the responses found in each of these parts. Thus, the method of symmetrical components treats unbalanced circuits using methods developed in this chapter, namely the analysis of
              single-phase
              and
              balanced
              three-phase circuits.
            


Analysis of Power in Three-Phase Circuits

              The analysis of power focuses on the flow of complex power rather than the phasor voltages and currents in the circuit. The circuit in
              Figure 16-23
              is used to illustrate the analysis of three-phase power flow. The circuit consists of a balanced three-phase source supplying power to a balanced three-phase load through a three-wire power line with a wire impedance
              Z
W
              in each line. Our immediate objective is to find the complex power delivered to the load for specified conditions at the source or load terminals. The load can be either Y- or Δ-connected but we do not need to know how the source is connected. We only need to know that it is balanced.
            







FIGURE 16-23



A balanced three phase circuit.




              The power delivered to the load in
              Figure 16-23
              can be found using the scalars
              I
L
              and
              V
L
              rather than phasors. The scalar
              I
L
              is the magnitude (rms value) of the current in the lines connecting the source and load. The scalar
              V
L
              is the magnitude (rms value) of the line-to-line voltage at the load. However, remember that the voltages at the source and at the load are not the same due to the voltage drops in the line impedances.
            

              When the load in
              Figure 16-23
              is Y-connected, an rms current
              I
L
              passes through each phase impedance
              Z
Y
              . The complex power delivered to each phase is
              I
L
2
Z
Y
              , so the total load power for the three phases is
            




              Writing the definition of
              I
L
              in
              Eq. (16-25)
              in terms of
              V
L
              as
            





              allows us to express the total complex power as
            




              where θ = <
              Z
Y
              . Thus, the complex power delivered to the Y-connected load depends on the line voltage, line current, and the angle of the phase impedance.
            



(16-29)





              where
              
              and
              
              are the average and reactive powers delivered to the load.
            

              When the load in
              Figure 16-23
              is Δ-connected, an rms current
              I
P
              passes through each phase impedance
              Z
Δ
              . The total complex power delivered to the load is
            




              Using the definition of
              I
P
              in
              Eq. (16-27)
              and the fact the
              
              , the total power can be written as
            




              where θ = <
              Z
Δ
              . The final expression for
              S
L
              found here is the same as
              Eq. (16-29)
              for a Y-connected load. Thus,
              Eq. (16-29)
              applies to the balanced load in
              Figure 16-23
              whether it is Y-connected or Δ-connected.
            

              The generality of
              Eq. (16-29)
              is a key result. We will make frequent use of this result in the analysis of three-phase power flow, especially the fact that the apparent power delivered to any balanced load is
              
              .
            












EXAMPLE 16-18


                      The load in
                      Figure 16-23
                      is Y-connected with a phase impedance of
                      Z
Y
                      = 12 +
                      j
                      5 Ω/ phase and the line voltage at the load is
                      V
L
                      = 440 V(rms). Find the line current
                      I
L
                      and the complex power delivered to the load. Verify your answers using Multisim. Assume 60 Hz.
                    




SOLUTION:



                  Since
                  V
L
                  = 440 V(rms), the phase voltage at the load is
                  
                  . In a Y-connected load, this voltage appears across the phase impedance
                  Z
Y
                  and the line current is found to be
                




                  The scalar
                  I
L
                  is the rms current in all three phase impedances
                  Z
Y
                  . Hence, the total complex power delivered to the load is
                




                  No phasors were needed to solve this problem. The power flow in a balanced three-phase circuit can usually be found using only the scalars
                  V
L
                  and
                  I
L
                  together with the line and load impedances.
                


                  We built the circuit in Multisim. At 60 Hz the inductor is 1326 mH. We can find
                  I
L
                  using any of the three line currents. We selected the current through one of the load resistors and asked for its magnitude: mag(I(R4)). We created a new expression to find the complex power
                




                  which we wrote as 3*mag(I(R3))^2*(V(A)/I(R3)). Grapher View responded with
                  I
L
                  = 19.5 A(rms) and
                  S
L
                  = 13.7 × 10
                  3
                  +
                  j
                  5.73 × 10
                  3
                  VA. These are the same results as calculated by hand. See
                  Figure 16-24
                  .
                







FIGURE 16-24









Single Frequency AC Analysis @60 Hz



Variable
Real
Imaginary





S
L
                        (VA)
                      
3*mag(I(R3))^2*(V(a)/I(R3))
13700
5730



I
L
                        (A)
                      
mag(I(R3))
19.5
0




■















Exercise 16-15


                  In
                  Figure 16-23
                  the load is Δ-connected with a phase impedance of
                  Z
Δ
                  = 26 +
                  j
                  8 Ω/phase and the line voltage at the load is
                  V
L
                  = 1.0 kV(rms). Find the line current
                  I
L
                  and the complex power delivered to the load.
                


Answers:



I
L
                  = 63.7 A(mis),
                  S
L
                  = 105 × 10
                  3
                  +
                  j
                  32.4 × 10
                  3
                  VA
                















EXAMPLE 16-19


                      In
                      Figure 16-23
                      , the load is Y-connected with a phase impedance of
                      Z
Y
                      = 15 +
                      j
                      6 Ω/phase and the line current is
                      I
L
                      = 10 A(rms). Find the line voltage
                      V
L
                      and the complex power delivered to the load.
                    




SOLUTION:




                  In this example, the line current
                  I
L
                  and phase impedance
                  Z
Y
                  are given, hence the complex power delivered to the load is
                




                  The apparent power delivered to any balanced load can be written as
                  
                  . Solving for the line voltage gives
                




                  Again, no phasors are needed to solve this problem.
                  ■














Exercise 16-16

In a balanced three-phase circuit, the line voltage at the load is 4160 V(rms) and the apparent power delivered to the load is 60 kVA. Find the line current.


Answer:



I
L
                  = 8.33 A(rms)
                















EXAMPLE 16-20


                      An average power of 20 kW is delivered to a balanced Δ-connected load with
                      Z
Δ
                      = 30 +
                      j
                      45 Ω/phase. Find the line voltage
                      V
L
                      at the load and the complex power delivered to the load.
                    




SOLUTION:



                  In a balanced Δ-connected load, the phase current
                  I
P
                  passes through all three of the phase impedances. The total average power delivered to the load is
                  
                  , where
                  R
Δ
                  is the resistive part of the phase impedance
                  Z
Δ
                  . Solving for
                  I
P
                  yields
                



The total complex power delivered to a delta load is then found as




                  Given the phase current, the line current is
                  
                  . The apparent power delivered to any balanced load is
                  
                  . Solving for the line voltage gives
                




■





















EXAMPLE 16-21



                      In
                      Figure 16-23
                      , the three-phase source produces an apparent power of 3.5 kVA at a power factor of 0.8 lagging and a line current of
                      I
L
                      = 4.6 A(rms). The three lines connecting the source to the load have impedances of
                      Z
W
                      = 1 +
                      j
                      6 Ω/phase. Find the complex power delivered to the load and the line voltage at the load.
                    





SOLUTION:


The complex power lost in any one wire is




                  The complex power lost in any one wire is
                  
                  , so the total line loss is
                



The complex power delivered to the load equals the power produced by the source minus the line losses. Hence



Accordingly, we get the line voltage at the load as




■















Exercise 16-17


                  In
                  Figure 16-23
                  , the line current is
                  I
L
                  = 10 A(rms), the line impedance is
                  Z
W
                  = 0.6 +
                  j
                  3.7 Ω/phase, and the phase impedance of the load is
                  Z
Y
                  = 15 +
                  j
                  28 Ω/phase. Find the complex power produced by the source.
                


Answer:



S
S
                  = 4.68 +
                  j
                  9.51 kVA
                











Exercise 16-18



                  In
                  Figure 16-23
                  , the line current is
                  I
L
                  = 5 A(rms), the line impedance is
                  Z
W
                  = 2 +
                  j
                  6 Ω/phase and the load absorbs
                  S
L
                  = 3 +
                  j
                  2 kVA. Find the complex power produced by the source.
                


Answer:



S
S
                  = 3.15 +
                  j
                  2.45 kVA
                




Instantaneous Power in Three-Phase Circuits
Earlier in this chapter, we found that the instantaneous power in a single-phase circuit has a dc component and an ac component. The ac components cause the instantaneous power flow to oscillate about an average value. One of the advantages of balanced three-phase circuits is that the total instantaneous power does not have an ac component.

              We previously developed
              Eq. (16-7)
              to relate the instantaneous power
              p
              (
              t
              ) in a single-phase circuit to the two components of complex power
              P
              and
              Q
              . Applying this equation to a balanced three-phase circuit yields the instantaneous power in any phase of a load:
            




              where
              P
              and
              Q
              are the average and reactive powers carried by the phase, and the angle ϕ is 0° for phase A, -120° for phase B, and -240° for phase C.
            


              The total instantaneous power is the sum of the power in each phase.
            



Both bracketed terms in this equation contain three sinusoids with equal amplitudes and separated in phase by 120° (-480° is the same as -120°). Like their phasor counterparts, the sum of a balanced set of three sinusoidal waveforms is zero. Hence, the bracketed terms both vanish, leaving



The fact that the total instantaneous power flow is constant rather than oscillating means that three-phase systems operate smoothly with less vibration at their mechanical inputs and outputs.



16-7 Three-Phase Power Flow

            In ordinary circuit analysis, the goal is to find the power delivered to the load for specified source conditions. In power flow analysis, the power delivered to the load is specified and the source conditions are the unknowns. We illustrate power flow analysis using the three-phase power system in
            Figure 16-25
            . The system consists of two balanced three-phase loads each of which draws a specified complex power from the system. The power is supplied by a balanced source through a pair of three-wire transmission lines with impedances of
            Z
W1
            and
            Z
W2
            . In a power system, a
            bus
            is defined as a set of three nodes at which three-phase elements are tied together. The analysis problem is to determine the system voltages and currents that produce a specified power flow to the loads.
          







FIGURE 16-25



A balanced three-phase power system used for power flow analysis.




            Even in a simple system like
            Figure 16-25
            , it seems clear that showing all three of the phases contributes little to our understanding of the power flow. Actual power systems may have hundreds of sources and loads all interconnected by a web of transmission lines. Including all three of the phases would make the system diagram hopelessly cluttered. In a balanced system, each phase carries the same complex power, so we do not need to show all of them.
          

            A simpler representation is to use a single line to represent all three of the phases.
            Figure 16-26
            is a single-line representation of the power system in
            Figure 16-25
            with the three buses shown as short horizontal lines. In a single-line diagram, a bus can be thought of as a single node at which sources, loads, and lines are tied together. The source at bus 1 is shown as a circle with an arrow indicating power flow into the system. The loads at bus 2 and bus 3 are shown as arrows indicating power flow out of the system. The two transmission lines are represented by their impedances
            Z
W1
            and
            Z
W2
            .
          







FIGURE 16-26




                  A single line representation of the circuit in
                  Figure 16-25
                  .
                




            By power flow, we mean complex power,
            S
            =
            P
            +
            jQ.
            We use a subscript to identify the bus at which power enters or exits the system. In
            Figure 16-26
            , the symbol
            S
1
            is the power supplied to the system by the source at bus 1, while
            S
2
            and
            S
3
            are the powers extracted from the system by the loads at bus 2 and bus 3. In single-line diagrams, the line currents and line voltages are represented by the scalars
            I
l
            and
            V
L
            , with subscripts added for clarity as needed. In general, we do not use load impedances since this information is implicit
            
            in the specified complex power flow. We do not need to know whether sources and loads are Y- or Δ-connected. We need only know that they are balanced.
          

            The line voltage at each of its buses and the impedances of the lines connecting the buses control the power flow in a system. Solving a power flow problem involves finding a set of bus voltages and line currents that produce a prescribed system load flow. Specifically for
            Figure 16-26
            , this would mean finding a set of bus voltages
            V
L1
            ,
            V
L2
            ,
            V
L3
            and line currents
            I
L1
            ,
            I
L2
            that produce the specified load powers
            S
2
            and
            S
3
            .
          
In power systems with several hundred buses, the power flow problem is a very significant computational challenge. Although our examples are very elementary, they do give some insight into the computational methods involved.












EXAMPLE 16-22



                    In
                    Figure 16-27
                    , the source at bus 1 and the load at bus 2 are interconnected by a transmission line with
                    Z
W
                    = 15 +
                    j
                    8.5 Ω/phase. The load at bus 2 draws a complex power of
                    S
2
                    = 70 +
                    j
                    35 kVA. Assuming that
                    V
L2
                    = 2400 V(rms), find the complex power produced by the source and the line voltage at bus 1.
                  









FIGURE 16-27








SOLUTION:



                For the given values of
                V
L2
                and
                S
2
                , we find the line current as
              



The power lost in the line is



The source at bus 1 must supply the load power at bus 1 plus the losses in the line. Hence, the complex power produced by the source is




                Now that we have
                I
L1
                and
                S
1
                , we find the line voltage at bus 1 as
              




                In round numbers, the conditions
                V
L1
                = 2.58 kV(rms),
                I
L1
                = 18.8 A(rms), and
                V
L2
                = 2.4 kV(rms) will produce the required load power flow. This set of conditions is not unique and many other solutions exist.
                ■















Exercise 16-19



                In
                Figure 16-27
                , the load at bus 2 draws a complex power of
                S
2
                = 125 +
                j
                60 kVA. The line current is
                I
L
                = 40 A(mis), and the line impedance is
                Z
W
                = 2 +
                j
                10 Ω/phase. Find the line voltages at bus 1 and bus 2.
              


Answers:



V
L1
                = 249 kV(rms),
                V
L2
                = 200 kV(rms)
              
















EXAMPLE 16-23




                    In
                    Figure 16-28
                    , the source at bus 1 supplies two load buses through transmission lines with
                    Z
W1
                    = 45 +
                    j
                    250 Ω/phase and
                    Z
W2
                    = 50 +
                    j
                    330 Ω/phase. Line 1 connects the source bus to a load at bus 2 that draws a complex power of
                    S
2
                    = 1.5 +
                    j
                    0.5 MVA. Line 2 connects bus 2 to a load at bus 3 that draws a complex power of
                    S
3
                    = 2 +
                    j
                    1.5MVA. Assuming that the line voltage at bus 3 is
                    V
L3
                    = 115 kV(rms), find the bus voltages
                    V
L1
                    and
                    V
L2
                    , the line currents
                    I
L1
                    and
                    I
L2
                    , and the source power output needed to produce the specified load powers
                    S
2
                    and
                    S
3
                    .
                  









FIGURE 16-28








SOLUTION:



                For the given values of
                V
L3
                and
                S
3
                , we find the line current in line 2 as
              



The power lost in the line 2 is




                At bus 2 the input power to line 2 supplies its losses
                S
W2
                plus the bus 3 load
                S
3
                , namely
              




                At bus 2, the line current into line 2 is
                I
L2
                . Since the input power to line 2 is
                S
W2
                +
                S
3
                , the line voltage at bus 2 is found to be
              



At bus 2, the output power of line 1 supplies the bus 2 load plus the input power into line 2, namely




                The line voltage at the output of line 1 is
                V
L2
                , hence the line current in line 1 is
              




                Given the line current
                I
L1
                the total complex power lost in line 1 is
              




                Finally we arrive at bus 1, where the input power to line 1 must equal its losses S
                W1
                , plus its output at the bus 2. This power is supplied by the source at bus 1, hence
              





                At bus 1 the line current is
                I
L1
                , hence the line voltage is found to be
              




                In round numbers, the conditions
                V
L1
                = 126.2 kV(rms),
                I
L1
                = 19.8 A(rms),
                V
L2
                = 120.3 kV (rms),
                I
L2
                = 12.5 A(rms), and
                V
L3
                = 115 kV(rms) will produce the required load power flow. This set of conditions is not unique. For example, the set
                V
L1
                = 153 kV(rms),
                I
L1
                = 15.9  A(rms),
                V
L2
                = 148 kV(rms),
                I
L2
                = 10 A(rms), and
                V
L3
                = 144 kV(rms) will produce the same load power flow.
                ■








Summary


              For sinusoidal voltages and currents, the instantaneous power is the sum of a dc component and an ac component.
              The dc component is the average power that produces a net transfer of energy.
              The ac component produces no net energy transfer.
            

              In ac power analysis, the amplitudes of voltage and current phasors are expressed in rms values.
              Complex power
              is defined as
              S
              =
              VI*
              =
              P
              +
              jQ.
              The real part
              P
              is the
              average power
              in watts (W), the imaginary part
              Q
              is the
              reactive power
              in volt-amperes reactive (VAR), and the magnitude |
              S
              | is the
              apparent power
              in voltamperes (VA).
            

              The
              power factor
              is the ratio of the average power to the apparent power or the cosine of the phase angle between the voltage and current phasors. The power factor is said to be lagging when the current lags the voltage (
              Q
              > 0) and leading when the current leads the voltage (
              Q
              < 0).
            
In a single-phase circuit, all sources have the same phase angle. The objective of single-phase circuit analysis is to find the power delivered to a specified load for given source conditions. The objective of power flow analysis is to find the source conditions needed to deliver a specified power to a load.

Power factor correction
              increases the power factor without changing the power flow to an inductive load. The correction is achieved by adding capacitance in parallel with the inductive load.
            

              A
              balanced three-phase source
              produces line-to-neutral voltages
              V
AN
              ,
              V
BN
              , and
              V
CN
              with 120° phase separation and the same amplitude
              V
P
              . The line-to-line voltages
              V
AB
              ,
              V
BC
              , and
              V
CA
              have 120° phase separation and the same amplitude
              
              . In a positive phase sequence,
              V
AB
              leads
              V
AN
              by 30°.
            

              A
              balanced Y-connected load
              has three equal impedances
              Z
Y
              , and a
              balanced Δ-connected load
              has three equal impedances
              Z
Δ
              . A Δ-connected load can be replaced by an equivalent Y-connected load whose impedances are
              Z
Y
              =
              Z
Δ
              /3.
            
A shortcut way to analyze a balanced three-phase circuit is convert it into an equivalent Y-Y configuration. Analyzing phase A of the Y-Y equivalent yields the phasor responses needed to get the phasor responses in any other phase.

              In a balanced three-phase circuit, (1) the neutral wire carries no current, (2) the line currents
              I
A
              ,
              I
B
              , and
              I
C
              have 120° phase separation and the same amplitude
              I
L
              , (3) in a Δ-connected load the phase currents
              I
AB
              ,
              I
BC
              , and
              I
CA
              have 120° phase separation and the same amplitude
              
              , (4) in a positive phase sequence
              I
AB
              leads
              I
A
              by 30°, and (5) the complex power delivered to a Y- or a Δ-connected load is
              
              , where θ is the angle of the phase impedance.
            

              The
              power flow
              in a balanced three-phase system is determined by the line voltage at each of its buses and the impedances of the lines connecting the buses. The net power flow in all of the lines connected to a bus determines the power flow into or out of a bus. A power flow problem involves finding a set of bus voltages and line currents that produce a prescribed load power flow.
            



Chapter 16 Problems







                Objective 16-1 Complex Power (
                Sects. 16-1
                and
                16-2
                )
              
Given a linear circuit in the sinusoidal steady state:

(a)  Find the average, reactive, and instantaneous powers for a specified voltage and current.
(b)  Find the load impedance for a specified load power flow.


                See
                Examples 16-1
                to
                16-3
                and
                Exercises 16-1
                to
                16-3
                .
              





16-1
              The following sets of
              υ
              (
              t
              ) and
              i
              (
              t
              ) apply to the load circuit in
              Figure P16-1
              . Find the average power, reactive power, and instantaneous power delivered to the load.
              

(a)
                   
                  υ
                  (
                  t
                  ) = 220 cos(ω
                  t
                  - 60°) V,
                  i
                  (
                  t
                  ) = 200 cos(ω
                  t
                  + 30°) mA
                

(b)
                   
                  υ
                  (
                  t
                  ) = 78 cos(ω
                  t
                  - 30°) V,
                  i
                  (
                  t
                  ) = 5.5 cos(ω
                  t
                  - 40°)A
                










FIGURE P16-1









16-2
              The following sets of
              υ
              (
              t
              ) and
              i
              (
              t
              ) apply to the load circuit in
              Figure P16-1
              . Calculate the average power, the reactive power, and instantaneous power delivered to the load.
              

(a)
                   
                  υ
                  (
                  t
                  ) = 100 cos(ω
                  t
                  - 15°) V,
                  i
                  (
                  t
                  ) = 100 sin(ω
                  t
                  ) mA
                

(b)
                   
                  υ
                  (
                  t
                  ) = 1000 cos(ω
                  t
                  ) V,
                  i
                  (
                  t
                  ) = 50 sin(ω
                  t
                  + 30°) A
                




16-3
              The following voltage and current phasors apply to the circuit in
              Figure P16-3
              . Calculate the average power and reactive power delivered to the impedance
              Z
              . Find the power factor and state whether the power factor is lagging or leading.
              

(a)
                   
                  V
                  = 208z45° V (rms),
                  I
                  = 2<-25° A (rms)
                

(b)
                   
                  V
                  = 115<60° V (rms), I = 5<135° A (rms)
                










FIGURE P16-3








16-4
              Given the load circuit in
              Figure P16-3
              , find the complex power delivered to the load impedance
              Z,
              when:
              

(a)
V
                  = 150<45° V (rms),
                  Z
                  = 50 +
                  j
                  50 Ω
                

(b)
                   
                  Z
                  = 30 <75° Ω,
                  I
                  = 10<-25° A (rms)
                

(c)
                   
                  V
                  = 100 <0° V (rms), 50 Hz across a 50-Ω resistor in series with a 100-mH inductor.
                




16-5
              Find the load impedance
              Z
              for the following complex powers.
              

(a)
                   When
                  S
                  = 2000 +
                  j
                  2500 VA and |
                  V
                  | = 1000 V.
                

(b)
                   When |
                  S
                  | = 15 kVA,
                  P
                  = 12 kW,
                  Q
                  > 0, and |
                  I
                  | = 50 A.
                



16-6
              An inductive load draws an apparent power of 50 kVA at a power factor of 0.7 from a 3600-V (rms) source. Find the complex power
              S
              and the load impedance
              Z.



16-7

              Design an appropriate load that will draw 15 A(rms), 6 kW, and 4.5 kVAR from a 60-Hz source. Would the components be larger or smaller if the source was 50 Hz? What is the power factor of your load?
            


16-8

              Design an appropriate load that will draw 28 A (rms), 2.2 kW, at 110 V (rms) from a 400-Hz source. Wha1 is its power factor? Prove your design using Multisim.
            







                Objective 16-2 Single-Phase Circuit Analysis (
                Sect. 16-3
                )
              
Given a single-phase circuit operating in the ac steady state, find the power produced by the sources or delivered to specified loads.

                See
                Examples 16-4
                to
                16-7
                and
                Exercises 16-4
                and
                16-5
                .
              






16-9
              A load made up of a 220-Ω resistor in parallel with a 200-mH inductor is connected across a 240-V (rms), 50-Hz voltage source. Find the complex power delivered to the load and the load power factor. State whether the power factor is lagging or leading. Verify your answers using Multisim.
            


16-10

              An arc welder presents a load made up of a 100-Ω resistor in parallel with a 12-μF capacitor in a 60-Hz, 110-V (rms) supply.
              

(a)
                   Find the complex power delivered to the load and the load power factor. State whether the power factor is lagging or leading. Verify your answers using Multisim.
                

(b)
                   An inductive motor of 100 mH is connected across the same load. How does the power factor change?
                

(c)
                   What would you recommend to the user about adding the induction motor to the arc-welder circuit?
                




16-11
              In
              Figure P16-11
              , the load
              Z
L
              is a 60-Ω resistor in series with a capacitor whose reactance is -30Ω. The source voltage is 440 V (rms). Find the complex power produced by the source and the complex power delivered to the load.
            








FIGURE P16-11









16-12
              Repeat Problem 16-11 when
              Z
L
              is a 30-Ω resistor in parallel with an impedance of 30 -
              j
              30 Ω.
            


16-13
              In
              Figure P16-13
              , the load
              Z
L
              is a 1500-Ω resistor and the source voltage is 440 V (rms). Find the complex power produced by the source.
            








FIGURE P16-13









16-14

              The circuit in
              Figure P16-14
              shows a power line distribution and an intermediate substation and a final user substation. The source
              V
S
              generates and steps up the voltage to 400 kV (rms), 60-Hz power. This power line is routed to an intermediate substation which steps down the voltage to 33 kV (rms). Finally at the user site, a second step-down transformer brings the voltage to 220 V (rms). Assume the source impedance
              Z
S
              and the wire impedance
              Z
W
              to be negligible (1 pΩ). The load impedance is
              Z
L
              = 200 +
              j
              200 Ω.
              

(a)
                   Find the turns ratio
                  n
                  for each transformer if they are considered ideal.
                

(b)
                   Find the complex power
                  S
L
                  delivered to the load.
                

(c)
                   Find the load power factor pf.
                

(d)
                   Verify your answers using Multisim.
                










FIGURE P16-14










16-15
              In
              Figure P16-15
              , the three load impedances are
              Z
1
              = 20 +
              j
              15Ω,
              Z
2
              = 25-
              j
              10Ω, and
              Z
3
              = 75 +
              j
              50Ω. Use MATLAB to solve for the three currents
              I
A
              ,
              I
B
              , and
              I
N
              , then the total complex power produced by the two sources, and finally, the overall circuit power factor.
            








FIGURE P16-15








16-16
              Two loads are connected in parallel across an 880 V (rms) line. The first load draws an average power of 20 kW at a lagging power factor of 0.87. The second load draws 15 kW at a lagging power factor of 0.67. Find the overall power factor of the circuit and the current drawn from the line.
            







                Objective 16-3 Single-Phase Power Flow (
                Sect. 16-4
                )
              
Given a specified load power in a single phase circuit:

(a)  Find the required source outputs.
(b)  Find the parallel capacitance needed to produce a specified power factor.


                See
                Examples 16-8
                to
                16-11
                and
                Exercises 16-6
                and
                16-7
                .
              





16-17
              The average power delivered to the load
              Z
L
              in
              Figure P16-17
              is 46 kW at a lagging power factor of 0.7. The load voltage is 2.4 kV (rms) and the line has an impedance of
              Z
W
              = 1 +
              j
              Ω/wire. Find the apparent power produced by the source and the magnitude of the source voltage.
            








FIGURE P16-17








16-18
              Repeat Problem 16-17 if the load power factor is a leading 0.92.
            


16-19
              The complex power
              S
L
              delivered to the load
              Z
L
              in
              Figure P16-17
              is 20 +
              j
              20 kVA. The source produces an average power of 22 kW and the line has an impedance of
              Z
W
              = 3 +
              j
              15 Ω/wire. Find the magnitude of the source and load voltages.
            

16-20
              In
              
Figure P16-20
              , the voltage across the two loads is |
              V
L
              | = 4.8 kV (rms). The load
              Z
1
              draws an average power of 15 kW at a lagging power factor of 0.8. The load
              Z
2
              draws an apparent power of 12 kVA at a lagging power factor of 0.85. The line has an impedance of
              Z
W
              = 9 +
              j
              50 Ω/wire. Find the apparent power produced by the source and the rms value of the source voltage.
            








FIGURE P16-20









16-21
              The two loads in
              Figure P16-20
              draw apparent powers of |
              S
1
              | = 50 kVA at a lagging power factor of 0.72 and |
              S
2
              | = 25 kVA at unity power factor. The voltage across the loads is 3.8 kV and the line has an impedance of
              Z
W
              = 5 +
              j
              26 Ω/wire. Find the apparent power produced by the source and the rms value of the source voltage.
            

16-22

              In
              Figure P16-22
              , the load voltage is |
              V
L
              | = 4160 V (rms) at 60 Hz and the load
              Z
L
              draws an average power of 12 kW at a lagging power factor of 0.75. Find the overall power factor of the combination if the parallel capacitance is 1 uF. Select the value of the capacitance required to raise the overall power factor of the parallel combination to 0.98.
            








FIGURE P16-22









16-23

              In
              Figure P16-22
              , the load voltage is |
              V
L
              | = 2400 V (rms) at 60 Hz. The load
              Z
L
              draws an apparent power of 25 kVA at a lagging power factor of 07. Select the value of the capacitance required to raise the overall power factor of the parallel combination to 0.90. Repeat for a power factor of unity.
            

16-24

              A load draws 4 A (rms) and 5 kW at a power factor 0.8 (lagging) from a 60-Hz source. Select an appropriate capacitor to be placed in parallel with the load to raise the overall power factor to 0.95.
            


16-25

              A 60-Hz, 200-hp, 240-V (rms) motor draws 160 kW of power with a 0.72 lagging power factor. Compute the complex power drawn by the motor. Then select an appropriate capacitor to improve the power factor to 0.98 and then recalculate the new complex power drawn.
            







                Objective 16-4 Balanced Three-Phase Circuits (
                Sect. 16-5
                )
              
For a balanced three-phase circuit:

(a)  Find all of the phase and line voltage phasors for a given phase reference.
(b)  Find equivalent Y- or Δ-connected sources and loads.


                See
                Examples 16-12
                and
                16-13
                and
                Exercises 16-8
                to
                l6-10
                .
              




16-26
              In a balanced three-phase circuit the line voltage magnitude is
              V
L
              = 9.8 kV (rms). For a positive phase sequence:
              

(a)
                   Find all of the line and phase voltage phasors using V
                  AB
                  as the phase reference.
                

(b)
                   Sketch a phasor diagram of the line and phase voltages.
                




16-27
              In a balanced three-phase circuit
              V
an
              = 500<53.13°V (rms). Find all the line and phase voltage phasors in polar form for a positive phase sequence. Draw the phasor diagram.
            

16-28
              A balanced Y-connected three-phase source has
              V
AN
              = 240<-30° V (rms) and a positive phase sequence. Find the three line voltages in polar form. Draw the phasor diagram.
            


16-29
              In a balanced three-phase circuit
              V
CN
              = 2400<-60° V (rms). Find
              V
BC
              in polar form for a positive phase sequence.
            

16-30
              A three-phase load is configured as shown in
              Figure P16-30
              with
              Z
Y
              = 10 -
              j
              5 Ω and
              Z
Δ
              = 60 -
              j
              15 Ω.
              

(a)
                   Find the equivalent
                  Z
Y
                  load.
                

(b)
                   The combined load is connected to a balanced Y-con-nected three-phase source with
                  V
AN
                  = 300 V (rms). Find the load currents.
                










FIGURE P16-30










16-31
              A balanced Y-connected load with
              Z
Y
              = 100 -
              j
              20 Ω per phase is connected in parallel with a balanced Δ-connected load with
              Z
Δ
              = 120 +
              j
              500 Ω per phase.
              


(a)
                   Find the phase impedance of an equivalent Y-connected load and an equivalent Δ-connected load. Use MATLAB.
                

(b)
                   Which equivalent impedance load has the best power factor?
                



16-32
              An old balanced Δ-Δ circuit needs to be upgraded to a Y-Y system. The current Δ-connected source produces
              V
AB
              = 2400<30° V (rms) and a positive phase sequence. The phase impedance of the load is
              Z
Δ
              = 1200<45° Ω/phase. Convert the Δ-Δ circuit into a balanced Y-Y system. Find the three source voltages and the phase impedance in the equivalent Y-Y circuit.
            







                Objective 16-5 Three-Phase Circuit Analysis (
                Sect. 16-6
                )
              
For a given balanced three-phase circuit:

(a)  Find the line and phase current phasor responses for a specified phase reference.

                  (b)  Find the power delivered to a load using the scalars
                  V
L
                  and
                  I
L
                  .
                


                See
                Examples 16-14
                to
                16-21
                and
                Exercises 16-11
                to
                16-18
                .
              






16-33
              In a balanced Y-Y circuit, the line voltage and phase impedance are
              V
L
              = 480 V (rms) and
              Z
Y
              = 20 +
              j
              10 Ω/ phase. Using <
              V
AN
              = 0° as the phase reference, find the line current and line voltage phasors in polar form for a positive phase sequence. Validate your results using Multisim. Assume 60 Hz.
            

16-34
              In a balanced Y-Y circuit, the line voltage is
              V
L
              = 440 V (rms). The phase impedance is
              Z
Y
              = 30 +
              j
              40 Ω/phase. Using <
              I
A
              = 0° as the phase reference, find
              I
A
              and
              V
AB
              in polar form for a positive phase sequence.
            


16-35
              A physical plant is served by a balanced Y-Δ circuit. The line voltage and phase impedance are
              V
L
              = 440 V (rms) and
              Z
Δ
              = 16 +
              j
              12 Ω/phase. The owner wants to add a new
              Z
Y
              = 15 -
              j
              20 Ω/phase load in parallel with the existing
              Z
Δ
              load.
              

(a)
                   Change the
                  Z
Δ
                  load to a
                  Z
Y
                  load and combine it in parallel with the new
                  Z
Y
                  load to make a balanced Y-Y configuration.
                

(b)
                   Using <
                  V
AB
                  = 0° as the phase reference, find the line current and phase current phasors in polar form for a positive phase sequence.
                




16-36
              In a balanced Δ-Y circuit, the line voltage and phase impedance are
              V
L
              = 4.16 kV (rms) and
              Z
Y
              = 250<30° Ω/phase. Using <
              V
AN
              = 0° as the phase reference, find the line voltage VBC and line current
              I
B
              for a positive phase sequence. Validate your results using Multisim. Assume 60 Hz.
            


16-37
              In a balanced Y-connected load, the line current and phase impedance are
              I
L
              = 4.7 A (rms) and
              Z
Y
              = 20 +
              j
              16 Ω/phase. Using <
              V
AB
              = 0° as the phase reference, find the line current
              I
A
              and phase voltage
              V
AN
              for a positive phase sequence.
            

16-38
              An average power of 5 kW is delivered to a balanced three-phase load with a phase impedance of
              Z
Y
              = 40 +
              j
              30 Ω/phase. Find
              V
L
              and the complex power delivered to the load.
            


16-39

              There is a need to design an appropriate load to connect a three-phase source. The source provides 24 z33.7° kVA at 60 Hz of complex power to a balanced
              Z
Y
              load. Your load needs a line voltage of 3.5 kV (rms) to operate correctly. Design the load.
            

16-40
              A balanced three-phase load has a phase impedance of
              Z
Y
              = 30 +
              j
              40 Ω/phase. The line voltage at the load is
              V
L
              = 440 V (rms). Find
              I
L
              and the complex power delivered to the load.
            


16-41
              A balanced three-phase load has a phase impedance of
              Z
Δ
              = 300 -
              j
              600 Ω/phase. The line voltage at the load is
              V
L
              = 2.4 kV (rms).
              

(a)
                   Convert the Δ load into a Y load.
                

(b)
                   Find
                  I
L
                  and the complex power delivered to the load.
                

(c)
                   What is the power factor delivered to the load?
                



16-42
              In the balanced three-phase system in
              Figure P16-42
              the line and load impedances are
              Z
W
              = 2 +
              j
              12 Ω/phase and
              Z
Y
              = 16 +
              j
              10 Ω/phase. The line current is
              I
L
              = 15A (rms). Find
              V
L
              at the source and the complex power produced by the source.
            








FIGURE P16-42









16-43
              In the balanced three-phase circuit in
              Figure P16-42
              , the line impedance is
              Z
W
              = 1 +
              j
              5 Ω/phase and the average power delivered to the load is 25 kW at a lagging power factor of 0.92. The line voltage at the load is
              V
L
              = 480 V (rms). Find the line voltage at the source and complex power produced by the source.
            

16-44
              In the balanced three-phase circuit in
              Figure P16-42
              , the line impedance is
              Z
W
              = 5 +
              j
              30 Ω/phase. The apparent power delivered to the load is 25 kVA at a lagging power factor of 0.85. The line current is
              I
L
              = 12A (rms). Find the line voltage at the source and complex power produced by the source.
            



16-45

              As a young engineer working for a consulting company, your supervisor gives you the Multisim circuit shown in
              Figure P16-45
              . She asks you to improve the complex power being delivered to the three-phase load by increasing the power factor to as close to 1 as possible. The manufacturer of the load offered to provide 530 μF capacitors. Is the manufacturer's solution sufficient? How would you alter the circuit?
            








FIGURE P16-45









16-46
              Two balanced three-phase loads are connected in parallel. The first load absorbs 25 kW at a lagging power factor of 0.9. The second load absorbs an apparent power of 30 kVA at a leading power factor of 0.1. The line voltage at the parallel loads is
              V
L
              = 880 V (rms). Find the line current into the combined load.
            


16-47
              The average power delivered to a balanced Y-con-nected load is 20 kW at 60 Hz at a lagging power factor of 0.8. The line voltage at the load is
              V
L
              = 480 V (rms).
              

(a)
                   Find the phase impedance
                  Z
Y
                  of the load.
                

(b)
                   Change the load so that the power factor is leading by the same power factor.
                



16-48
              The apparent power delivered to a balanced Δ-connected load is 25 kVA at a lagging power factor of 0.72. The line voltage at the load is
              V
L
              = 20 kV (rms). Find the phase impedance
              Z
Δ
              of the load.
            







                Objective 16-6 Three-Phase Power Flow (
                Sect. 16-7
                )
              
Given a single-line diagram of a balanced three-phase system, find the source outputs and bus voltages that produce a prescribed load power flow.

                See
                Examples 16-22
                and
                16-23
                and
                Exercise 16-19
                .
              




16-49
              In
              Figure P16-49
              , the source and load buses are interconnected by a transmission line with
              Z
W
              = 40 +
              j
              280 Ω/phase. The load at bus 2 draws an apparent power of |
              S
2
              | = 3 MVA at a leading power factor of 0.8 and the line voltage at bus 2 is
              V
L2
              = 230 kV(rms). Find the apparent power produced by the source at bus 1, the source power factor, and the line voltage at bus 1.
            








FIGURE P16-49








16-50
              In
              Figure P16-49
              , the source and load buses are interconnected by a transmission line with wire impedance
              Z
W
              . The load at bus 2 draws an average power of
              P
2
              = 600 kW at a lagging power factor of 0.85 and the line current is
              I
L1
              = 10 A (rms). The source
              S
1
              provides 601.8 +
              j
              387 kVA of complex power. Find
              Z
W
              .
            


16-51

              In
              Figure P16-51
              , the three buses are interconnected by transmission lines with wire impedances of
              Z
W1
              = 100 +
              j
              600 Ω/phase and
              Z
W2
              = 120 +
              j
              800 Ω/phase. The source at bus 2 produces an apparent power of |
              S
2
              | = 300 kVA at a lagging power factor of 0.85. The load at bus 3 draws an apparent power of |
              S
3
              | = 600 kVA at a lagging power factor of 0.8. The line voltage at bus 3 is
              V
L3
              = 161 kV (rms). Find the apparent power produced by the source at bus 1, the source power factor, and the line voltages at bus 1 and bus 2.
            








FIGURE P16-51








16-52
              In
              Figure P16-51
              , the three buses are interconnected by transmission lines with wire impedances of
              Z
W1
              = 150 +
              j
              600 Ω/phase and
              Z
W2
              = 200 +
              j
              1200 Ω/phase. The source at bus 2 produces an apparent power of |
              S
2
              | = 600 kVA at a leading power factor of 0.9. The load at bus 3 draws an apparent power of |
              S
3
              | = 750 kVA at a lagging power factor of 0.85. The line current in line 2 is
              I
L2
              = 3.25 A (rms). Find the apparent power produced by the source at bus 1, the source power factor, and the line voltages at bus 1, bus 2, and bus 3.
            


16-53
              In
              Figure P16-53
              , the source at bus 1 supplies two load buses through transmission lines with wire impedances of
              Z
W1
              = 6 +
              j
              33 Ω/phase and
              Z
W2
              = 3+
              j
              15 Ω/phase. The load at bus 2 draws an apparent power 4 MVA at a lagging power factor of 095. The load at bus 3 draws an apparent power of 3 MVA at a lagging power factor of 0.9. The line voltage at bus 3 is
              V
L3
              = 138kV(rms). Find the apparent power produced by the source at bus 1, the source power factor, and the line voltages at bus 1 and bus 2.
            








FIGURE P16-53









Integrating Problems


16-54

            Three-Phase Line-Voltage Phasors for a Negative Phase Sequence
            
            In a balanced three-phase system
            V
AN
            =
            V
P
            <0°. Find the three line-voltage phasors in polar form when the phase sequence is negative.
          

16-55

            Three-Phase Motor kVA Rating
            
            The power factor of a 50-hp (1 hp = 746 W) three-phase induction motor is 0.8 when it delivers its rated mechanical output. When delivering its rated output, the motor efficiency is 90%. Find the kVA rating of the motor.
          

16-56

            Three-Phase Line Impedance
            
            A balanced three-phase source and a balanced three-phase load are interconnected by a three-phase transmission line. The load draws an average power of
            P
L
            = 45 kW at a lagging power factor of 0.8 and the source produces a complex power of
            S
S
            = (45.2+
            j
            35.4) kVA. Find the transmission line wire impedance when the magnitude of the line current is
            I
L
            = 18 A (rms).
          


16-57

            Neutral Line Role
            
            Consider the Multisim representation of a balanced three-phase Y-Y power system shown in
            Figure P16-57
            . An owner of the plant who wants to install the system is contemplating whether to save money by eliminating the need for the neutral return line. The owner (not an engineer) was told that the line carries no current. As a junior engineer, you learned that while the neutral line indeed carries no current when the system is balanced, it is a safety feature for when the system becomes unbalanced. Use Multisim to demonstrate to the owner that the neutral line plays a key role if, for example, one of the lines becomes an open circuit.
          








FIGURE P16-57









Notes




1

              If we defined all six voltages using the usual + and - reference marks, a three-phase circuit diagram would be hopelessly cluttered and confusing.
            


2

              When connecting real three-phase equipment, it is essential to maintain the identity of lines A, B, and C. For example, reversing any two leads to a three-phase motor changes the phase sequence and causes it to rotate in the opposite direction.
            


3

              In power jargon, "Y" is at times referred to as "Wye"
            
















CHAPTER 17

TWO-PORT NETWORKS





"Among the tools of thought and artifices by which man forces his mind to give him more service, perhaps the most intensely useful are the simple mathematical rules of inversion known as reciprocity theorems"


          Stuart BaUantine, 1928
          
          American Radio Pioneer
        








Some History Behind This Chapter

              The purpose of this chapter is to introduce a special class of network functions that characterize linear two-port circuits. These network functions involve both the driving point and transfer functions first defined in
              Chapter 11
              . The added constraint here is that they are defined under open-circuit and short-circuit conditions. These special functions, collectively known as
              reciprocity theorems,
              have their roots from the earliest days of communications and power transmission and were first derived by Dutch physicist and Nobel laureate, Hendrik A. Lorenz in 1896. These were later applied to communications and power systems by Stuart Ballantine, American electrical engineer and Fellow, Institute of Radio Engineers (IRE).
            









Why This Chapter Is Important Today
Many of today's circuits are analyzed using two-port theorems, including filters, matching networks, microwave transmission lines, transformers, communication systems, and small-signal models for transistors. Each type of application uses a particular set of two-port parameters that help define how each operates and how they are interconnected. This chapter discusses four basic sets of parameters that are most commonly used in these numerous lumped-device applications, namely: Impedance, Admittance, Hybrid, and Transmission parameters. There are other sets of parameters not covered in this chapter, such as those that apply to distributed components like the Scattering parameters used in communications, radar, and other microwave applications.









Chapter Sections



17-1 Introduction






17-2 Impedance Parameters






17-3 Admittance Parameters






17-4 Hybrid Parameters






17-5 Transmission Parameters






17-6 Two-Port Conversions and Connections












Chapter Learning Objectives

17-1
              Impedance and Admittance Parameters (
              Sects. 17-2
              and
              17-3
              )
            

(a)  Given a linear two-port network, find the impedance or admittance parameters.
(b)  Given the impedance or admittance parameters ofa linear two-port network, find responses at the input and output ports for specified external connections.


17-2
              Hybrid and Transmission Parameters (
              Sects. 17-4
              and
              17-5
              )
            

(a)  Given a linear two-port network, find the hybrid or transmission parameters.
(b)  Given the hybrid or transmission parameters of a linear two-port network, find responses at the input and output ports for specified external connections.


17-3
              Two-port Conversions and Connections (
              Sect. 17-6
              )
            

(a)  Given a set of two-port parameters, find other two-port parameters.
(b)  Given the parameters of several two port networks, find the parameters of an interconnection of the two ports.





17-1 Introduction

            We have studied and used two-port networks since
            Chapter 11
            . The transfer function is a two-port network. When we cascade or place known circuits together, we usually know how each circuit behaves. We are interested in how the new combined circuit performs and when we analyze these combined circuits, we do not often look at what is inside each building block, but what occurs at their interfaces. Back in
            Chapter 3
            , we learned about Thevenin and Norton equivalent circuits. We were interested in their short-circuit current,
            I
N
            , open-circuit voltage,
            V
T
            , and Thevenin resistance,
            R
T
            , later expanded to impedance,
            Z
T
            . Once we knew these values, we no longer needed to know or cared what caused that current, voltage, or impedance - just what occurs at the interface. In
            Chapter 12
            and especially
            Chapter 14
            , we cascaded building blocks of filters to achieve frequency domain responses to suit our needs.
          
Today's circuits and networks are immense, but not necessarily in physical size -think of integrated circuits with millions of interconnected devices on tiny substrates, or exceptionally large systems such as our national interconnected power systems with thousands of sources, tens of thousands of miles of powerlines, and hundreds of millions of users. Similarly, our communications systems are very complex and widely distributed. There was a need even as long as a century ago to improve how one analyzes these systems. From these needs two-port theory was created.

            The purpose of this chapter is to begin a study of the methods of characterizing and analyzing two-port networks. A
            port
            as first studied in
            Chapter 11
            , is a terminal pair where energy can be supplied or extracted. A
            two-port network
            is a four-terminal circuit, a transfer-function of sorts, in which the terminals are paired to form an input port and an output port.
            Figure 17-1
            shows thecustomarywayof defining the port voltages and currents. Note that the reference marks for the port variables comply with the passive sign convention. The linear circuit connecting the two ports is assumed to be in the zero state and to be free of any independent sources. In other words, there is no initial energy stored in the circuit and the box in
            Figure 17-1
            contains only resistors, capacitors, inductors, mutual inductance, and dependent sources.
          







FIGURE 17-1



A two-port network.




            A four-terminal network qualifies as a two-port network if
            the net current entering each terminal pair is zero.
            This means that the current exiting the lower port terminals in
            Figure 17-1
            must be equal to the currents entering the upper terminals. One way to meet this condition is to always connect external sources and loads between the input terminal pair or between the output terminal pair.
          

            The first task is to identify circuit parameters that characterize a two-port. In the two-port approach, the only available variables are the port voltages
            V
1
            and
            V
2
            and the port currents
            I
1
            and
            
              I
              2
              .
            
            A set of two-port parameters is defined by expressing two of these four port variables in terms of the other two variables. In this chapter, we study the four ways in
            Table 17-1
            .
          

            Note that each set of parameters is defined by two equations, one for each of the two dependent port variables. Each equation involves a sum of two terms, one for
            
            each of the two independent port variables. Each term involves a proportionality because the two port is a linear circuit and superposition applies. The names given the parameters indicate their dimensions (impedance and admittance), a mixture of dimensions (hybrid), or their original application (transmission lines). With double subscripted parameters, the first subscript indicates the port at which the dependent variable appears and the second subscript the port at which the independent variable appears.
          






Table

17-1


TWO-PORT PARAMETERS







Name
Express
In Terms of
Defining Equations




Impedance

V
1
                    ,
                    V
2


I
1
                    ,
                    I
2


V
1
                    =
                    z
11
I
1
                    +
                    z
12
I
2
                    and
                    V
2
                    =
                    z
21
I
1
                    +
                    z
22
I
2



Admittance

I
1
                    ,
                    I
2


V
1
                    ,
                    V
2


I
1
                    =
                    y
11
V
1
                    +
                    y
12
V
2
                    and
                    I
2
                    =
                    y
21
V
1
                    +
                    y
22
V
2



Hybrid

V
1
                    ,
                    I
2


I
1
                    ,
                    V
2


V
1
                    =
                    h
11
I
1
                    +
                    h
12
V
2
                    and
                    I
2
                    =
                    h
21
I
1
                    +
                    h
22
V
2



Transmission

V
1
                    ,
                    I
1


V
2
                    , -
                    I
2


V
1
                    =
                    AV
2
                    -
                    BI
2
                    and
                    I
1
                    =
                    CV
2
                    -
                    DI
2






            Regardless of their dimensions, all two-port parameters are network functions. In general, the parameters are functions of the complex frequency variable and s-domain circuit analysis applies. For sinusoidal steady-state problems, we replace
            s
            by
            j
            ω and use phasor circuit analysis. For purely resistive circuits, the two-port parameters are real constants and we use resistive (dc) circuit analysis.
          
Before turning to specific parameters, it is important to specify the objectives of two-port network analysis. Briefly, these objectives are:

Determine two-port parameters of a given circuit.
Use two-port parameters to find port variable responses for specified input sources and output loads.

In principle, the port variable responses can be found by applying node or mesh analysis to the internal circuitry connecting the input and output ports. So why adopt the two-port point of view? Why not use straight-forward circuit analysis?
There are several reasons. First, two-port parameters can be determined experimentally without resorting to circuit analysis. Second, there are applications in power systems and microwave circuits in which input and output ports are the only places that signals can be measured or observed. Finally, once two-port parameters of a circuit are known, it is a relatively simple matter to find port variable responses for different input sources and/or different output loads.


17-2 Impedance Parameters

            The impedance parameters are obtained by expressing the port voltages
            V
1
            and
            V
2
            in terms of the port currents
            I
1
            and
            I
2
            .
          



(17-1)





            The network functions
            z
11
            ,
            z
12
            ,
            z
21
            , and
            z
22
            are called the
            impedance parameters
            or simply the
            z
            -
            parameters.
            These equations have the matrix form
          



(17-2)





            where the matrix [
            z
            ] is called the
            impedance matrix
            of a two-port network.
          

            To measure or compute the impedance parameters, we apply excitation at one port and leave the other port open circuited. When we drive at port 1 with port 2 open (
            I
2
            = 0, the expressions in
            Eq. (17-1)
            reduce to one term each and yield the definitions of
            z
11
            and
            z
21
            .
          


(17-3a)





(17-3b)





            Conversely, when we drive at port 2 with port 1 open (
            I
1
            = 0), the expressions in
            Eq. (17-1)
            reduce to one term each that define
            z
12
            and
            z
22
            as
          


(17-4a)





(17-4b)



All of these parameters are impedances with dimensions of ohms.

            A two-port network is said to be
            reciprocal
            when the open-circuit voltage measured at one port due to a current excitation at the other port is unchanged when the measurement and excitation ports are interchanged. A two-port network that fails this test is said to be
            nonreciprocal.
            Circuits containing resistors, capacitors, and inductors (including mutual inductance) are always reciprocal. Adding dependent sources to the mix usually makes the two-port network nonreciprocal.
          

            If a two-port network is reciprocal, then
            z
12
            =
            z
21
            . To prove this we apply an excitation
            I
1
            =
            I
x
            at the input port and observe that
            Eq. (17-1)
            gives the open-circuit (
            I
2
            = 0 voltage at the output port as
            V
2OC
            =
            z
21
I
x
            . Reversing the excitation and observation ports, we find that an excitation
            I
2
            =
            I
x
            produces an open-circuit (
            I
1
            = 0) voltage at the input port of
            V
1OC
            =
            z
12
I
x
            . Reciprocity requires that
            V
1OC
            =
            V
2OC
            , which can only happen if
            z
12
            =
            z
21
            .
          













EXAMPLE 17-1



                    Find the impedance or
                    z 
                    -parameters of the resistive circuit in 
                    Figure 17-2
                    (a). Use Multisim to find the same parameters. Write it as a matrix in the form of
                    Eq. (17-2)
                    . 
                  









FIGURE 17-2








SOLUTION:


    
                We start with an open circuit at port 2( 
                I
2
                = 0. The resistance looking in at port 1 is    
              



   
                To find the forward transfer impedance, we use current division to express the current through the 75-Ω resistor in terms of
                I
1  
                .
              




                By Ohm's law the open-circuit voltage at port 2 is
                V
2
                =
                I
75
                × 75. Therefore, the forward transfer impedance is
              




                Next we assume that port 1 is open (
                I
1
                = 0. The resistance looking in at port 2 is
              




                To find the reverse transfer impedance, we first express the current through the 50-Ω resistor in terms of
                I
2
                . Using current division again
              




                By Ohm's law the open-circuit voltage at port 1 is
                V
1
                =
                I
50
                × 50. Therefore, the reverse transfer impedance is
              




                Note that since
                z
12
                =
                z
21
                = 15 Ω, the two-port network is reciprocal.
              







FIGURE 17-2








                Finding the
                z
                -parameters using Multisim is straightforward. Since we need to open the input and outputs of the circuit, we build two circuits as shown in
                Figure 17-2
                (b). We drive the first circuit with a 1-Vdc source and ask Multisim's DC Operating Point Analysis to calculate using "Add Expression"
                z
11
                : V(1)/-I(V1) and
                z
21
                : V(2)/-I(V1). The minus sign reverses the current through the source. We drive the second circuit using the same source but at the output. We ask Multisim to calculate
                z
12
                : V(3)/-I(V2) and
                z
22
                : V(4)/-I(V2). Grapher View returns the results shown in
                Figure 17-2
                (c).
              

                We can write the
                z
                -parameter matrix as:
              


■















EXAMPLE 17-2


                    A 5-V voltage source is connected at port 1 in
                    Figure 17-2
                    and a 50-Ω, resistor is connected at port 2. Find the port currents
                    I
1
                    and
                    I
2
                    .
                  




SOLUTION:



                Using the impedance parameters found in
                Example 17-1
                , the
                i-υ
                relationships of the two-port network in
                Figure 17-2
                are
              




                The external connections at the input and output port mean that
                V
1
                = 5 and
                V
2
                = − 50
                I
2
                . Substituting these constraints into the two-port
                i−υ
                relationships yields
              




                The result is two linear equations in the two unknown port currents. Solving these equations simultaneously yields
                I
1
                = 132 mA and
                I
2
                = -194 mA. The minus sign here means that the output current
                I
2
                actually flows out of port 2 as you would expect.
                ■












Exercise 17-1




                Find the impedance parameters of the circuit in
                Figure 17-3
                (a). Validate your answers using Multisim.
              


Answers:



z
11
                = 125Ω,
                z
12
                = 75Ω,
                z
21
                =75Ω,
                z
22
                = 175Ω
              







FIGURE 17-3
















Exercise 17-2



                The impedance parameters of the two-port network shown in
                Figure 17-3
                (b) are
                z
11
                = 25 Ω,
                z
12
                = 50 Ω,
                z
21
                = 75 Ω, and
                z
22
                = 75 Ω. Find the port currents
                I
1
                and
                I
2
                when a 15-V voltage source is connected at port 1 and port 2 is short circuited. Is the network reciprocal?
              


Answers:



I
1
                = -0.6 A,
                I
2
                = 0.6 A; No, because
                z
12
                ≠
                z
21
                .
              







FIGURE 17-3









            Look back at these last two exercises. In
            Exercise 17-1
            , we were given a circuit and asked to find its
            z
            -parameters. This was a straightforward dc circuit analysis problem. In
            Exercise 17-2
            , we were simply provided with the
            z
            -parameters of a black box with no evidence of what was inside. Yet, using the parameters, one could find a desired output given a particular input.
          


17-3 Admittance Parameters

            The admittance parameters are obtained by expressing the port currents
            I
1
            and
            I
2
            in terms of the port voltages
            V
1
            and
            V
2
            . The resulting two-port
            i-υ
            relationships are
          



(17-5)





            The network functions
            y
11
            ,
            y
12
            ,
            y
21
            , and
            y
22
            are called the
            admittance parameters
            or simply the
            y
            -
            parameters.
            In matrix form, these equations are
          



(17-6)





            where the matrix [
            y
            ] is called the
            admittance matrix
            of a two-port network.
          

            To measure or compute the admittance parameters, we apply excitation at one port and short circuit the other port. When we drive at port 1 with port 2 shorted (
            V
2
            = 0), the expressions in
            Eq. (17-5)
            reduce to one term each that define
            y
11
            and
            y
21
            as
          


(17-7a)





(17-7b)




            Conversely, when we place a source at port 2 with port 1 shorted (
            V
1
            = 0), the expressions in
            Eq. (17-5)
            reduce to one term each that define
            y
22
            and
            y
12
            as
          


(17-8a)





(17-8b)





            All of these network functions are admittances with dimensions of Siemens. If a two-port network is reciprocal, then
            y
12
            =
            y
21
            . This can be proved using the same thought process applied to the
            z
            -parameters.
          

            The admittance parameters express port currents in terms of port voltages, whereas the impedance parameters express the port voltages in terms of the port currents. In effect, these parameter are inverses. To see this mathematically, we multiply
            Eq. (17-2)
            by [
            z
            ]
            -1
            , the inverse of the impedance matrix.
          



In other words




            Comparing this result with
            Eq. (17-6)
            , we conclude that [
            y
            ] = [
            z
            ]
            -1
            . That is, the admittance matrix of a two-port network is the inverse of its impedance matrix. This means that the admittance parameters can be derived from the impedance parameters, provided [
            z
            ]
            -1
            exists. We will return to this idea in a later section. For the moment remember that admittance and impedance parameters are related and not independent descriptions of a two-port network.
          











EXAMPLE 17-3


                    Find the admittance parameters of the two-port n-type circuit in
                    Figure 17-4
                    .
                  









FIGURE 17-4








SOLUTION:



                A short circuit at port 2 connects admittances
                Y
A
                and
                Y
B
                in parallel. Hence, the admittance looking in at port 1 is
                y
11
                =
                Y
A
                +
                Y
B
                . The short-circuit current at port 2 is
                I
2
                = −
                Y
B
V
1
                , hence
                y
21
                = −
                Y
B
                . A short circuit at port 1 connects
                Y
B
                and
                Y
C
                in parallel so the admittance looking in at port 2 is
                y
22
                =
                Y
B
                +
                Y
C
                . The short-circuit current at port 1 is
                I
1
                = −
                Y
B
V
2
                , which means
                y
12
                = −
                Y
B
                . Thus, the admittance parameters of a general pi-circuit are
              




■





















EXAMPLE 17-4



                    The impedance parameters of a two-port network are zn =30Ω,
                    z
12
                    =
                    z
21
                    =10Ω, and
                    z
22
                    = 20 Ω Find the admittance parameters of the network. Is the resulting
                    y
                    -parameter network reciprocal?
                  




SOLUTION:


The impedance matrix for the two-port network is





                The admittance matrix is the inverse of the impedance matrix and is found as
              




                Hence, the admittance parameters are
                y
11
                = 40 mS,
                y
12
                =
                y
21
                = −20mS, and
                y
22
                = 60 mS. Since
                y
12
                =
                y
21
                , the network is reciprocal.
                ■















Exercise 17-3


                Find the admittance parameters of the circuit in
                Figure 17-5
                (a). Validate your answers using Multisim. Use 60 Hz
              


Answers:



y
11
                = −
                j
                20mS,
                y
21
                =
                y
12
                =
                j
                20mS, and
                y
22
                = 5−
                j
                20mS. See
                Figures 17-5
                (b) and
                (c)
                .
              









FIGURE 17-5















FIGURE 17-5













Exercise 17-4



                The admittance parameters of a two-port network are
                y
11
                = 20 mS,
                y
12
                = 0,
                y
21
                = 100 mS, and
                y
22
                = 40 mS. Find the output voltage
                V
2
                when a 5-V voltage source is connected at port 1 and port 2 is connected to a 100-Ω load resistor.
              


Answer:



V
2
                = -10V
              




17-4 Hybrid Parameters

            The hybrid parameters are defined in terms of a mixture of port variables and are especially useful in analyzing transistor circuits. Specifically, these parameters express
            V
1
            and
            I
2
            in terms of
            I
1
            and
            V
2
            . The resulting two-port
            i-υ
            relationships are
          



(17-9)






            where
            h
11
            ,
            h
12
            ,
            h
21
            , and
            h
22
            are called the
            hybrid parameters
            or simply the
            h-parameters.
            In matrix form, these equations are
          


(17-10)




            where the matrix [
            h
            ] is called the
            h-matrix
            of a two-port network.
          

            The
            h
            -parameters can be measured or calculated as follows. When we drive at port 1 with port 2 shorted (
            V
2
            = 0, the expressions in
            Eq. (17-9)
            reduce to one term each and yield the definitions of
            h
11
            and
            h
21
            .
          


(17-11a)





(17-11b)




            When we drive at port 2 with port 1 open (
            I
1
            = 0, the expressions in
            Eq. (17-9)
            reduce to one term each and yield the definitions of
            h
12
            and
            h
22
            .
          


(17-12a)





(17-12b)




            These network functions have a mixture of dimensions:
            h
11
            is an impedance in ohms,
            h
22
            an admittance in siemens, and
            h
21
            and
            h
12
            dimensionless transfer functions. If a two-port network is reciprocal, then
            h
12
            = -
            h
21
            . This can be proved by the same thought process applied to the
            z
            -parameters.
          












EXAMPLE 17-5



                    The circuit in
                    Figure 17-6
                    is a small-signal model of a standard Complementary Metal-Oxide-Semiconductor or CMOS amplifier cell. Find the h-parameters of the circuit.
                  









FIGURE 17-6








SOLUTION:


The sum of currents at nodes A and B can be written as




                Solving the node A equation for
                V
1
                yields
              





                Comparing this result and
                h
                -parameter definitions we have
                h
11
                =
                R
E
                /(1 -
                g
m
R
E
                ) and
                h
12
                = 0. Inserting the expression for
                V
1
                from node A into the node B equation and solving for
                I
2
                yields
              




                which means that
                h
21
                =
                g
m
R
E
                /(1 -
                g
m
R
E
                ) and
                h
22
                = 1/
                R
D
                . Note that since
                h
12
                ≠ -
                h
12
                this circuit is not reciprocal. The reason being the dependent source.
                ■



















EXAMPLE 17-6



                    The
                    h
                    -parameters of a two-port network are
                    h
11
                    = 2kΩ,
                    h
12
                    = -2,
                    h
21
                    = 10, and
                    h
22
                    = 500 μS. A 10-V voltage source is connected at the input port. Find the Norton equivalent circuit at the output port.
                  




SOLUTION:



                The given
                h
                -parameters give the
                i-υ
                relationships of the two port as
              




                The voltage source connected at the input port makes
                V
1
                = 10 V. Inserting this value into the first
                h
                -parameter equation and solving for
                I
1
                yields
              




                Substituting this into the second
                h
                -parameter equation produces
              




                This equation gives the actual
                i-υ
                relationship at the output port with the 10-V source connected at the input.
                Figure 17-7
                shows the desired Norton equivalent circuit.
              







FIGURE 17-7







                Summing the currents at node A yields the
                i-υ
                relationship of the desired Norton circuit as
              



Comparing the Norton and the actual characteristics we conclude that




■

















Exercise 17-5



                Find the
                h
                -parameters of the circuit in
                Figure 17-8
                (a). Use Multisim.
              


Answers:



                The Multisim circuits are shown in
                Figure 17-8
                (b). The Grapher view output is shown in the table.
              









FIGURE 17-8












Exercise 17-6


                The A-parameters of a two-port network are
                h
11
                =
                j
                200 Ω,
                h
12
                = 1,
                h
21
                = -1 and
                h
22
                = 2 mS. Find the input impedance when the output port is open and the output admittance when the input port is short circuited.
              


Answer:



Z
IN
                = 500 +
                j
                200 Ω,
                Y
OUT
                = 2 -
                j
                5 mS
              





            17-5 Transmission Parameters
            
1



            The transmission parameters express the input-port variables
            V
1
            , and
            I
1
            , in terms of the output-port variables
            V
2
            and -
            I
2
            . The resulting two-port
            i-υ
            relationships are
          



(17-13)





            where
            A
            ,
            B, C,
            and
            D
            are called the
            transmission parameters
            or simply the
            
t
              -parameters.
            
            In matrix form, these equations are
          


(17-14)




            where the matrix [
            t
            ] is called the
            transmission-matrix
            of a two-port network.
          

            The matrix equation explicitly shows that the independentvariables are
            V
2
            and -
            I
2
            . In other words, the minus signs in
            Eq. (17-13)
            are associated with
            I
2
            and not with the parameters
            B
            and
            D.
            In effect, the minus sign reverses the reference direction of the output current in
            Figure 17-1
            . The reason for this convention is partly historical.
            
            The
            t
            -parameters originated in the analysis of power transmission lines, where the traditional positive reference for the receiving end current is defined in the direction of the power flow.
          

            The transmission parameters are measured or calculated with a short circuit or an open circuit at the output port. Applying the conditions for a short-circuit (
            V
2
            = 0) or open-circuit (-
            I
2
            = 0 to
            Eqs. (17-13)
            leads to the following parameter identifications.
          


(17-15a)





(17-15b)





(17-15c)





(17-15d)




            These results are expressed as reciprocals to conform with the transfer function definitions we have previously used. Arranged in this way, we see that the reciprocals of the transmission parameters are all forward (input-to-output) transfer functions. If a two-port network is reciprocal, then
            AD
            -
            BC
            = 1; a result that can be proved using the same method applied to
            z
            -parameters.
          

            The transmission parameters are particularly useful when two-port networks are connected in cascade, as shown in
            Figure 17-9
            . The matrix equations for individual two-port networks
            N
a
            and
            N
b
            are
          







FIGURE 17-9










            Note that the output-port variables for
            N
a
            are the input-port variables for
            N
b
            . This happens because the two networks are connected in an output-to-input cascade, and because the minus signs in
            Eq. (17-13)
            effectively reverse the reference directions of the output currents. Substituting the
            N
b
            equations into the
            N
a
            equations yields
          



Thus, the transmission matrix of the overall network is the matrix product of the transmission matrices of the individual two-port networks in the cascade connection.


(17-16)




            This result can be generalized for any number of two-port networks in cascade. This generalization is quite useful since electrical power systems and communication system are made up of many two-port networks connected in cascade. In such applications, the individual matrices must be placed in the matrix product in the same order that the two-port networks are connected in the cascade. The reason being that matrix multiplication is not necessarily commutative. Although we did not use the
            
            matrix approach, this is essentially the process we used in designing interface circuits in
            Chapters 4
            and
            11
            , and cascading stages for filters in
            Chapters 12
            and
            14
            .
          











EXAMPLE 17-7


                    Find the
                    t
                    -parameters of the two-port network in
                    Figure 17-10
                    .
                  









FIGURE 17-10








SOLUTION:



                With the output open (-
                I
2
                = 0), we use KVL to write
                V
1
                =
                V
2
                and
                V
2
                =
                Z
1
I
1
                . Hence
              




                With the output shorted (
                V
2
                = 0), we use current division and KVL to write
              



hence



Note that this two-port network is reciprocal since




■





















EXAMPLE 17-8



                    The
                    t
                    -parameters of a two-port network are
                    A
                    = -1,
                    B
                    =
                    j
                    50 Ω,
                    C
                    =
                    j
                    20 mS, and
                    D
                    = 0. Find the input impedance when a 50-Ω resistor is connected across the output port.
                  




SOLUTION:



                The
                i-υ
                relationships of the two-port network are
              




                The 50-Ω resistor connected at the output means that
                V
2
                = 50(-
                I
2
                ). Substituting this constraint into the two-port
                i-υ
                characteristics yields the input impedance as
              




■















Exercise 17-7


                The
                t
                -parameters of a two-port network are
                A
                = 2,
                B
                = 200 Ω,
                C
                = 10 mS, and
                D
                = 1.5. Find the Thevenin equivalent circuit at the output port when a 10-V voltage source is connected at the input port.
              


Answers:



V
T
                = 5 V,
                R

                = 100 Ω
              











Exercise 17-8



                Find the
                t
                -parameters of the OP AMP circuit in
                Figure 17-11
                . if
                Z
1
                = 10 + 20
                s
                Ω and
                Z
2
                = 100 Ω. What function does the circuit perform?
              


Answers:



A
                = -(
                s
                + 0.5)/5,
                B
                = 0,
                C
                = -1/100 S,
                D
                = 0. It is a low-pass filter.
              









FIGURE 17-11







17-6 Two-Port Conversions and Connections


              Two-port conversion refers to the process of relating one set of parameters to a different set. We have already seen an example. In Section 17-3, we found that the admittance matrix is the inverse of the impedance matrix. Thus, the
              y
              -parameters are related to the
              z
              -parameters by matrix inversion.
            



(17-17)





              where Δ
              z
              = det[
              z
              ] =
              z
11
z
22
              -
              z
12
z
21
              .
            

              For a second example, we begin with the
              z
              -parameter
              i-υ
              relationships
            




              We now rearrange these equations to conform to
              h
              -parameter equations. First. solving the second
              z
              -parameter equation for
              I
2
              yields
            




              Using this result to eliminate
              I
2
              for the first
              z
              -parameter equation produces
            




              Taken together, the two rearranged equations provide relationships between
              h
              -parameters and
              z
              -parameters that are summarized by the following matrix equation.
            



(17-18)





              The steps used to produce
              Eqs. (17-17)
              and
              (17-18)
              are typical of the derivations used to produce the parameter conversion formulas in
              Table 17-2
              . To convert from one set to another, we enter the table in the column for the given parameters and find the appropriate conversion formulas in the row for the desired parameters. For example, converting from
              y
              -parameters to J-parameters is accomplished by the matrix equation
            




              The derivations of the formulas in
              Table 17-2
              assume that all four sets of parameters exist. Certain two-port parameters do not exist for some circuits. For example, the
              y
              -parameters do not exist for the circuit in
              Figure 17-12
              . By inspection, the
              z
              -parameters exist for this circuit and are
              z
11
              =
              z
12
              =
              z
21
              =
              z
22
              =
              Z
              . As a result
              A
z
              = 0, and mathematically the
              y
              -parameters do not exist because [
              z
              ]
              -1
              does not exist. Physically the
              y
              -parameters don't exist because a short circuit applied at either port in
              Figure 17-12
              produces an infinite driving-point admittance at the other port.
            

              In some applications, it is useful to view a circuit as an interconnection of subcircuits, each of which is treated as a two-port network.
              Figure 17-13
              shows four
              
              possible interconnections of two-port subcircuits
              N
a
              and
              N
b
              . We regard the subcircuits as building blocks that are interconnected to form a composite circuit. We need to relate the two-port parameters of the composite interconnection to the two-port parameters of the subcircuit building blocks.
            






Table

17-2


Two-Port Parameter Conversion Table







              The
              cascade connection
              in
              Figure 17-13
              (a) was addressed in Section 17-5, where we showed that the transmission matrix of the interconnection is
            



(17-19)





              where [
              t
a
              ] and [
              t
b
              ] are the transmission matrices of the subcircuits
              N
a
              and
              N
b
              , respectively. The circuit in
              Figure 17-13
              (b) is called a
              series connection
              of two-ports networks. It is easy to show that the impedance matrix of the interconnection is
            


(17-20)




              where [
              z
a
              ] and [
              z
b
              ] are the impedance matrices of subcircuits
              N
a
              and
              N
b
              , respectively. The circuit in
              Figure 17-13
              (c) is called
              a parallel connection
              of two-port networks. As you might expect from network duality, the admittance matrix of this interconnection is
            


(17-21)




              where [
              y
a
              ] and [
              y
b
              ] are the admittance matrices of
              N
a
              and
              N
b
              , respectively. Finally,
              Figure 17-13
              (d) is called a
              series-parallel connection
              whose hybrid-parameter matrix is
            


(17-22)










FIGURE 17-12







              where [
              h
a
              ] and [
              h
b
              ] are the hybrid matrices of
              N
a
              and
              N
b
              , respectively.
            


Equations (17-19)
              through
              (17-22)
              show how to obtain a two-port matrix of an interconnection using the two-port matrices of subcircuits
              N
a
              and
              N
b
              . These equations assume that the port
              i-υ
              characteristics of
              N
a
              and
              N
b
              are unchanged by their interconnection. One way for this to hold is for
              N
a
              and
              N
b
              to have a "common ground" as indicated by the dashed lines in
              Figure 17-13
              . In what follows we assume these equations always apply.
            







FIGURE 17-13


















EXAMPLE 17-9



                      The networks
                      N
a
                      and
                      N
b
                      in
                      Figure 17-14
                      are connected in parallel and have two-port matrices
                    




                      Find the
                      y
                      -parameters of the parallel connection.
                    







FIGURE 17-14










SOLUTION:



                  To get the desired
                  y
                  -parameters, we use the fact that [
                  y
                  ] = [
                  y
a
                  + [
                  y
b
                  ] in a parallel connection. We are given [
                  z
a
                  ] and [
                  y
b
                  ], so we need to convert the
                  z
                  -matrix of
                  N
a
                  into a
                  y
                  -matrix.
                  Equation (17-17)
                  indicates that [
                  y
                  ] = [
                  z
                  ]
                  -1
                  , so the desired
                  y
                  -matrix is found to be
                




                  Given the
                  y
                  -matrix of the parallel connection, the
                  y
                  -parameters are seen to be
                  y
11
                  = 0.28 S,
                  y
12
                  =
                  y
21
                  = -0.24 S, and
                  y
22
                  = 0.82 S.
                  ■















Exercise 17-9



                  The
                  h
                  -parameter of a two-port network are
                  h
11
                  = 1 kΩ,
                  h
12
                  = 0.02,
                  h
21
                  = -50, and
                  h
22
                  = 10
                  -4
                  S. Find the
                  t
                  -parameters of the two-port network.
                


Answers:



A
                  = 0.022,
                  B
                  = 20 Ω,
                  C
                  = 2μS, and
                  D
                  = 0.02
                



Voltage and Current Gain

                Our study of two-port networks to this point can be summarized as follows. First, we used the port
                i-υ
                characteristics to define four sets of two-port parameters. Next, we used basic circuit analysis to find the two-port parameters of given circuits. We showed that when two-port parameters are known, the defining
                i-υ
                characteristics can be used to find voltage and current responses at the input and output ports. Finally,
                Table 17-2
                allows us to convert from one set of parameters into a different set, while
                Eqs. (17-19)
                through
                (17-21)
                show us how to find a two-port matrix of an interconnection of two-port subcircuits.
              
These results are the basic tools of two-port circuit analysis. They are used at the next level of analysis to study global properties of two-port circuits such as voltage gain, current gain, Thevenin equivalents, and the effects of feedback and loading. We limit our study to voltage and current gain.


                Voltage and current gain are defined in terms of the input port variables (
                V
1
                ,
                I
1
                ) and output port variables (
                V
2
                ,
                I
2
                ) in the same manner first encountered in
                Chapter 11
                ,
                Eq. (11-6)
                . These are
              




                These gains are both forward (input to output) transfer functions for prescribed conditions at the output port. For
                T
V
                the output is open-circuited (
                I
2
                = 0) and for
                T
I
                the output is short-circuited (
                V
2
                = 0).
              

T
V
                and
                T
I
                can be related to two-port parameters by imposing the output conditions
                I
2
                = 0 or
                V
2
                = 0 on the defining
                i-υ
                equations. For example, the
                z
                -parameter
                i-υ
                equations are
              




                For the
                I
2
                = 0 condition, these equations reduce to
                V
1
                =
                z
11
I
1
                and
                V
2
                =
                z
21
I
1
                . Dividing the second reduced equation by the first gives
                T
V
                =
                V
2
                /
                V
1
                =
                z
21
                /
                z
11
                . The
                V
2
                = 0 condition reduces the second
                i-υ
                equation to
              




                Solving for
                I
2
                leads to
                T
I
                =
                I
2
                /
                I
1
                = -
                z
21
                /
                z
22


                As a second example, consider the
                i-υ
                equations of the
                t
                -parameters.
              




                The
                I
2
                = 0 condition reduces the first equation to
                V
1
                =
                AV
2
                , which leads to
                T
V
                =
                V
2
                /
                V
1
                = 1/
                A
                . Imposing
                V
2
                = 0 reduces the second equation to
                I
1
                = -
                DI
2
                , which lead to
                T
I
                =
                I
2
                /
                I
1
                = -1/
                D
                .
              

                These examples illustrate that voltage and current gain can be expressed in terms of two-port parameters by imposing the condition
                V
2
                = 0 or
                I
2
                = 0 on the defining
                i-υ
                equations.
                Table 17-3
                summarizes these relationships for the four parameter sets defined in this chapter. These relationships apply to individual two-port networks or to interconnections of two-port networks when we know the parameters of the interconnection. The next example illustrates this point.
              






Table

17-3


Voltage Gain and Current Gain in Terms of Two-Port Parameters

















EXAMPLE 17-10



                        The networks
                        N
a
                        and
                        N
b
                        in
                        Figure 17-15
                        are connected in cascade and have two-port matrices
                      



Find the current gain of this cascade connection.




SOLUTION:



                    To get a two-port description of this connection, we use the J-parameters since [
                    t
                    ] = [
                    t
a
                    ] [
                    t
b
                    ] in a cascade connection. We are given the
                    t
                    -matrix of
                    N
a
                    and the
                    z
                    -matrix of
                    N
b
                    . Given the matrix [
                    z
b
                    ], the
                    z
                    -parameters of Nb are seen to be
                    z
11b
                    = 200 Ω,
                    z
12b
                    = 0,
                    z
2b
                    = -2000 Ω,
                    z
2b
                    = 20 Ω, and Δ
                    zb
                    =
                    z
11b
z
22b
                    -
                    z
12b
z
21b
                    = 4000. To get the matrix [
                    t
b
                    ], we use the [
                    z
                    ] to [
                    t
                    ] conversion shown in
                    Table 17-2
                    .
                  




                    Now using [
                    t]
                    = [
                    t
a
                    ] [
                    t
b
                    ] yields the transmission matrix of the cascade connection as
                  





                    Given the matrix [
                    t
                    ], the
                    t
                    -parameters of the connection are seen to be
                    A
                    = -0.313,
                    B
                    = -6.25 Ω,
                    C
                    = -0.021 S, and
                    D
                    = -0.420. Using the appropriate relationship in
                    Table 17-3
                    gives us the current gain of the connection.
                  




■















Exercise 17-10


                    The
                    t
                    -matrices of networks
                    N
a
                    and
                    N
b
                    in
                    Figure 17-15
                    are
                  




                    Find the
                    t
                    -parameters of the cascade connection.
                  


Answers:



A
                    = 14,
                    B
                    = 200 Ω,
                    C
                    = 0.1 S, and
                    D
                    = 2
                  









FIGURE 17-15



A two-terminal interface.















EXAMPLE 17-11



                        The two-port network
                        N
a
                        in
                        Figure 17-16
                        is an amplifier with
                        h
                        -parameters
                        h
11a
                        = 500 Ω,
                        h
12a
                        = 0,
                        h
21a
                        = -500, and
                        h
22a
                        = 0.1 S. The two-port
                        N
b
                        is a passive resistance circuit that provides feedback around the amplifier. The purpose of this example is to find the voltage gain of the overall network first without feedback (
                        R
                        = 0 and then with feedback (R = 1 kΩ).
                      









FIGURE 17-16








SOLUTION:



                    To get a two-port description of this connection, we use
                    z
                    -parameters since [
                    z
                    ] = [
                    z
a
                    ] + [
                    z
b
                    ] in a series connection. We are given the
                    h
                    -parameters of
                    N
a
                    , namely
                    h
11a
                    = 500 Ω,
                    h
12a
                    = 0,
                    h
21a
                    = -500,
                    h
22b
                    = 0.1 S, and Δ
                    ha
                    =
                    h
11a
h
22a
                    -
                    h
12a
h
21a
                    = 50. To get the impedance matrix [
                    z
a
                    ], we use the |
                    h
                    | to [
                    z
                    ] conversion in
                    Table 17-2
                    .
                  




                    Given the matrix [
                    z
a
                    ], the
                    z
                    -parameters of
                    N
a
                    are seen to be
                    z
11a
                    = 500 Ω,
                    z
12a
                    = 0,
                    z
21a
                    = 5000 Ω, and
                    z
22a
                    = 10 Ω. Network
                    N
b
                    is a simple shunt resistor
                    R
                    so it is easy to see that its
                    z
                    -parameters are
                    z
11b
                    =
                    z
12b
                    =
                    z
21b
                    =
                    z
22b
                    =
                    R
                    .
                    Table 17-3
                    expresses the voltage gain
                    T
V
                    in terms of
                    z
                    -parameters as
                    T
V
                    =
                    z
21
                    /
                    z
11
                    . Again, since [
                    z
                    ] = [
                    z
a
                    ] + [
                    z
b
                    ] in a series connection, the overall voltage gain is
                  




                    Without feedback (
                    R
                    = 0), the voltage gain is
                    T
V
                    = 5000/500 = 10. With feedback (
                    R
                    = 1000 Ω), the gain is
                    T
V
                    = 600/1500 = 4.
                    ■















Exercise 17-11



                    Using the
                    h
                    -parameters from
                    Example 17-11
                    what is the current gain of the series connection in
                    Figure 17-16
                    when
                    R
                    = 0 and
                    R
                    = 1 kΩ?
                  


Answers:



T
1
                    = -500 and
                    T
1
                    = -5.94
                  





Summary


                A
                port
                is a terminal pair where energy can be supplied or extracted. A
                two-port network
                is a four-terminal circuit with the terminals paired to form an input port and an output port.
              
The two-port method applies to linear circuits with no independent sources, no initial energy storage, and a net current of zero at both ports.

                The only
                accessible variables
                are the port voltages
                V
1
                and
                V
2
                and the port currents
                I
1
                and
                I
2
                . Two-port parameters are defined by expressing two of these four port variables in terms of the other two variables.
              

                The most often used two-port parameters are the
                impedance, admittance, hybrid,
                and
                transmission
                parameters. Each set of two-port parameters defines two simultaneous linear equations in the port variables.
              

                In general,
                two-port parameters are network functions
                of the complex frequency variable s. Setting
                s
                =
                j
                ω yields the sinusoidal steady-state values of two-port parameters. Setting
                s
                = 0 yields the dc values of two-port parameters.
              

                A two-port network is
                reciprocal
                if the voltage response observed at one port due to a current excitation at the other port is unchanged when the response and excitation ports are interchanged.
              

                Every two-port parameter can be calculated or measured by applying excitation at one of the ports and connecting a short circuit or an open circuit at the other port. The relationships between different sets of parameters are given in
                Table 17-2
                .
              
There are simple relationships between the two-port parameters of an interconnection of two-port networks and the two-port parameters of its subcircuits. These relationships assume that the interconnections do not modify the two-port parameters of the subcircuits.

Voltage and current gain
                are defined in terms of the input port variables
                V
1
                ,
                I
1
                and output port variables
                V
2
                ,
                I
2
                .
              





              Chapter 17 Problems
            






                  Objective 17-1 Impedance and Admittance Parameters (
                  Sects. 17-2
                  and
                  17-3
                  )
                

(a)  Given a linear two-port network, find the impedance or admittance parameters.
(b)  Given the impedance or admittance parameters of a linear two-port network, find port responses or network properties.


                  See
                  Examples 17-1
                  to
                  17-4
                  and
                  Exercises 17-1
                  to
                  17-4
                  .
                






17-1
                Find the
                z
                -parameters of the two-port network in
                Figure P17-1
                . Validate your results using Multisim.
              








FIGURE P17-1









17-2
                Find the
                z
                -parameters of the two-port network in
                Figure P17-2
                and provide the results in matrix form. Is the circuit reciprocal? Validate your results using Multisim.
              








FIGURE P17-2










17-3
                Find the
                y
                -parameters of the two-port network in
                Figure P17-3
                . Validate your results using Multisim. Use 60 Hz.
              








FIGURE P17-3








17-4



(a)
                    Find the
                    z
                    -parameters of the two-port network in
                    Figure P17-4
                    .
                  

(b)
                     If β = 50, select values of the resistors so that
                    Z
IN
                    = 52 kΩ.
                  










FIGURE P17-4









17-5
                Find the
                y
                -parameters of the two-port network in
                Figure P17-4
                .
              

17-6

Figure P17-6
                is a simplified model of a voltage amplifier. The
                z
                -parameter matrix of the model is
                
                Select values of the resistors and the voltage gain parameter μ that will match the
                z
                -matrix.
              








FIGURE P17-6









17-7
                The
                y
                -parameters of a two-port circuit are
                y
11
                = 6 mS,
                y
12
                =
                y
21
                = -2 mS, and
                y
22
                = 2 mS. A 10-V voltage source is connected at the input port and a short circuit is connected across the output port. Find the port variable responses
                I
1
                and
                I
2
                .
              

17-8
                The
                y
                -parameters of a two-port circuit are
                y
11
                = 20 +
                j
                20 mS,
                y
12
                =
                y
21
                = 100 -
                j
                20 mS, and
                y
22
                = 40 +
                j
                20 mS. Find the short-circuit (
                V
2
                = 0) current gain
                T
I
                =
                I
2
                /
                I
1
                .
              


17-9
                in
                Figure P17-9
                , a load impedance
                Z
L
                is connected across the output port. Show that the voltage gain
                T
V
                =
                V
2
                /
                V
1
                is
              








FIGURE P17-9












                  Objective 17-2 Hybrid and Transmission Parameters (
                  Sects. 17-4
                  and
                  17-5
                  )
                



                    (a)  Given a linear two-port network, find the hybrid or transmission parameters.
                  
(b)  Given the hybrid or transmission parameters of a linear two-port network, find port responses or network properties.


                  See
                  Examples 17-5
                  to
                  17-8
                  and
                  Exercises 17-5
                  to
                  17-8
                  .
                




17-10
                Find the A-parameters of the two-port networks in
                Figure P17-10
                .
              








FIGURE P17-10









17-11
                Find the
                t
                -parameters of the two-port network in
                Figure P17-10
                .
              

17-12



(a)
                    Find the
                    t
                    -parameters of the two-port network in
                    Figure P17-12
                    .
                  

(b)
                     Select values of
                    R
1
R
2
                    ,
                    R
3
                    , and β, so that the following are achieved:
                    T
I
                    = 75,
                    Z
IN
                    = 2 kΩ, and
                    Z
OUT|V1 = 0
                    = 100 kΩ.
                  










FIGURE P17-12









17-13
                Find the
                t
                -parameters of the two-port network in
                Figure P17-12
                .
              

17-14
                Find the
                h
                -parameters of the two-port network in
                Figure P17-14
                .
              








FIGURE P17-14









17-15



(a)
                    The
                    h
                    -parameters of a two-port network are
                    h
11
                    = 500 Ω,
                    h
12
                    = 1,
                    h
21
                    = -1, and
                    h
22
                    = 2 mS. Find the Thévenin equivalent circuit at the output port when a 20-V voltage source is connected at the input port.
                  

(b)
                    Connect a load
                    R
L
                    across the output to obtain maximum power transfer.
                  



17-16


(a)
                    A model of a BJT (bipolar junction transistor) in a common-emitter mode is shown in
                    Figure P17-16
                    . Find the
                    h
                    -parameters for this particular circuit.
                  

(b)
                    Simplify your results if
                    r
C
                    → ∞.
                  










FIGURE P17-16









17-17
                The
                t
                -parameters of a two-port network are
                A
                = 2,
                B
                = 100 Ω,
                C
                = 3 mS, and
                D
                = 1.
                

(a)
                     Find the output resistance
                    V
2
                    /
                    I
2
                    when the input port is short-circuited.
                  

(b)
                     Find the output resistance
                    V
2
                    /
                    I
2
                    when the input port is open-circuited.
                  



17-18
                The t-parameters of a two-port network are
                A
                = 0,
                B
                = -
                j
                25 Ω,
                C
                = -
                j
                20 mS, and
                D
                = 0.5 -
                j
                0.5. Find the voltage gain
                V
2
                /
                V
1
                when a 500-Ω load resistor is connected across the output port.
              


17-19
                When a voltage
                V
x
                is applied across the input port, the short-circuit current at the output port is
                I
2SC
                . When the same voltage is applied across the output port, the short-circuit current at the input port is
                I
1SC
                . Show that reciprocity (
                I
1SC
                =
                I
2SC
                ) requires that
                h
12
                = -
                h
21
                .
              







                  Objective 17-3 Two-Port Conversions and Connections (
                  Sect. 17-6
                  )
                

(a)  Convert a given set of two-port parameters into a different set of two-port parameters.
(b)  Find two-port parameters and network properties of an interconnection of the two-port circuits.


                  See
                  Examples 17-9
                  to
                  17-11
                  and
                  Exercises 17-9
                  to
                  17-11
                  .
                




17-20
                Starting with the
                h
                -parameter
                i-υ
                relationships in
                Eq. (17-9)
                , show that
                



                  where Δ
                  
h

                  =
                  h
11
h
22
                  -
                  h
12
h
21
                  .
                



17-21
                Starting with the
                t
                -parameter
                i-υ
                relationships in
                Eq. (17-13)
                , show that
                



                  where
                  Δ
t
                  =
                  AD
                  -
                  BC
                  .
                



17-22
                Starting with the
                h
                -parameter
                i-υ
                relationships in
                Eq. (17-9)
                , determine the voltage transfer function
                T
V
                =
                V
2
                /
                V
1
                in terms of the
                h
                -parameters, when the output is open circuited.
              


17-23
                The
                t
                -parameters of the two-port networks
                N
a
                and
                N
b
                in
                Figure P17-23
                are
                



                  Find the
                  t
                  -parameters of the cascade connection.
                









FIGURE P17-23








17-24
                The
                t
                -parameters of the two-port networks
                N
a
                and
                N
b
                in
                Figure P17-23
                are
                



                  Find the impedance looking into the input port of
                  N
a
                  when a resistive load is connected across the output port of
                  N
b
                  .
                





17-25
                The cascade connection in
                Figure P17-23
                is a two-stage amplifier with identical two-port stages each having the
                h
                -parameters
                h
11
                = 1.5 kΩ,
                h
12
                = 0,
                h
21
                = -20, and
                h
22
                = 0.5 mS. Find the
                t
                -parameters of the cascade connection and then calculate the current gain of the two-stage amplifier.
              

17-26
                Find the voltage gain of the two-stage amplifier defined in Problem 17-25.
              


17-27
                The two-port parameters of the series connection in
                Figure P17-27
                are
                



                  Find the
                  z
                  -parameters of the series connection. Is the network reciprocal?
                









FIGURE P17-27








17-28

                In Figure 17-27, the network
                N
a
                is an active device with
                h
                -parameters
                h
11
                = 10 kΩ,
                h
12
                = 0,
                h
21
                = -5 × 10
                3
                , and
                h
22
                = 50 mS. The network
                N
b
                is a resistive feedback circuit with
                z
                -parameters
                z
11
                = 2
                R
                and
                z
12
                =
                z
21
                =
                z
22
                =
                R
                . Find a value of
                R
                such that the voltage gain of the series connection is
                T
V
                = 2.
              



Integrating Problems


17-29

                Unilateral Two-Port Network
                
                  A two-port network is said to be unilateral if excitation applied at the input port produces a response at the output port, but the same excitation applied at the output port produces no response at the input port. Show that a two-port network is unilateral if
                  AD
                  -
                  BC
                  = 0
                


17-30

                Input Impedance of a Two-Port Network
                
                  A load impedance
                  Z
L
                  is connected at the output of a two-port network. Show that the input impedance
                  Z
IN
                  =
                  V
1
                  /
                  I
1
                  =
                  Z
L
                  when
                  A
                  =
                  D
                  and
                  C
                  =
                  B
                  /(
                  Z
L
                  )
                  2
                  .
                


17-31

                Maximum Power
                
                  The
                  y
                  -parameters of a two-port network operating in the sinusoidal steady state are
                  y
11
                  = 20 -
                  j
                  15 mS,
                  y
12
                  =
                  y
21
                  = -
                  j
                  12 mS, and
                  y
22
                  = 10 -
                  j
                  20 mS. The input port is driven by an ac voltage source
                  V
S
                  = 220<25° V(rms). Design an output port load impedance
                  Z
L
                  that will draw the maximum average power from the network.
                


17-32

                No Parameters
                
                  Some two-port networks do not have either
                  z
                  or
                  y
                  parameters. A good example is the ideal transformer shown in
                  Figure P17-32
                  . The equations defining this two-port network were found in
                  Chapter 15
                  as
                




                  Attempt to find the
                  z
                  -parameters and explain why they do not exist.
                









FIGURE P17-32









Note




1

                  These were also called the ABCD parameters.
                


















CHAPTER 18

FOURIER TRANSFORMS





Yesterday was my
          21
          st birthday, at that age Newton and Pascal had already acquired many claims to immortality.


          Jean Baptiste Joseph Fourier, 1789,
          
          French Physicist
        








Some History Behind This Chapter
Jean Baptiste Fourier (1768-1830) claimed that any function of a variable, whether continuous or discontinuous, can be expanded in a series of sines of multiples of the variable. This remarkable result is not correct without additional conditions. While Fourier's observation that some discontinuous functions are the sum of infinite series was a break-through, the question of determining when a Fourier series converges was still unproven. Peter Gustav Lejeune Dirichlet (1805-1859) was the first to give a satisfactory demonstration of it with some restrictions known as the Dirichlet conditions. This work provides the foundation for the Fourier transform as applied to both causal and noncausal signals.









Why This Chapter Is Important Today
Fourier transforms allow one to understand the frequency characteristics of signals from transducers to outputs of networks. This is very useful in audio, communications, instrumentation, and signal processing systems. Fourier transforms produce spectra that are continuous rather than discrete as with Fourier series. These spectra are useful in determining the major ranges of frequencies in signals and are not restricted to sinusoids.









Chapter Sections



18-1 Introduction to Fourier Transforms






18-2 Circuit Analysis Using Fourier Transforms






18-3 Impulse Response and Convolution






18-4 Parseval's Theorem












Chapter Learning Objectives

18-1
              The Fourier Transform (
              Sect. 18-1
              )
            

(a)  Given an equation or graph of an aperiodic waveform, derive an expression for the Fourier transform.
(b)  Given an equation or graph of a Fourier Transform, derive an expression for the corresponding waveform.
(c)  Understand the relationship between Fourier transforms and Laplace transforms and know the conditions under which Laplace transform techniques can be used to compute Fourier transforms.


18-2
              Fourier Transforms and Circuit Analysis (
              Sects. 18-2
              to
              18-4
              )
            

(a)  Given a linear circuit, use Fourier transform techniques to determine the output response for aperiodic input signals.
(b)  Given a linear circuit, use Parseval's theorem to determine the energy content of selected signals.





18-1 Introduction to Fourier Transforms

            We have examined Fourier series in
            Chapter 13
            as a tool to resolve a periodic waveform into an infinite series of sinusoids at discrete harmonic frequencies
            nf
0
            ,
            n
            = 1, 2, ..., ∞. The Fourier series allows us to construct the line spectrum of a periodic waveform from the distribution of amplitudes and phase angles across the harmonic frequencies. Since not all signals are periodic, we now extend the idea of a frequency spectrum to accommodate aperiodic waveforms that occur only once. The Fourier transform of an aperiodic signal is analogous to the Fourier series representation of a periodic waveform. Both representations involve infinitely many frequencies. The difference is that the frequencies in a Fourier series are discrete multiples of
            f
0
            , whereas the frequencies in a Fourier transform span a continuum of values.
          

Definition of Fourier Transforms

              Fourier transforms are integral transforms like Laplace transforms. Like Laplace transforms, the Fourier transforms involve two domains: (1) the time domain in which the signal is represented by its
              waveform
f
              (
              t
              ), and (2) the frequency domain in which the signal is characterized by its Fourier
              transform
F
              (ω). In general,
              F
              (ω) is a complex-valued function of the
              real frequency variable
              co. The magnitude and phase angle of
              F
              (ω) are called the
              amplitude spectrum
              and
              phase spectrum,
              respectively. This is the same name as that given to the line spectra of the Fourier Series, but as we will see these spectra are continuous.
            

              The Fourier transform of a waveform
              f
              (
              t
              ) is defined by the integral
            



(18-1)




As you would expect from our study of Laplace transforms, there is an inverse procedure which converts a Fourier transform into a time-domain waveform. Inverse Fourier transforms are defined by the integral



(18-2)





              which yields
              f
              (
              t
              ) when given
              F
              (ω). The waveform
              f
              (
              t
              ) and transform
              F
              (ω) comprise a
              Fourier transform pair
              . We say that
              F
              (ω) is the Fourier transform of
              f
              (
              t
              ), and conversely,
              f
              (
              t
              ) is the inverse transform of
              F
              (ω). The short-hand notation
              
              is used to denote these operations.
            

              The limits on these integrals indicate important features of Fourier transforms. The direct transform in
              Eq. (18-1)
              is a time integration across the interval -∞ <
              t
              < ∞. This points out that Fourier transforms exist for either causal or noncau-sal waveforms.
              
1

              The inverse transform in
              Eq. (18-2)
              is an integration on the real frequency variable c across the range -∞ < ω < ∞. This points out that ω is a continuous variable that takes on positive and negative values. Thus, Fourier transforms have spectral content across a continuous range of frequencies, whereas the spectral content of a Fourier series exists only at isolated, harmonic frequencies.
            


              The infinite limits in
              Eq. (18-1)
              should also alert the reader to the question of convergence and existence of
              F
              (ω). Existence is assured by the
              Dirichlet conditions,
              which require that the waveform
              f
              (
              t
              ) have a finite number of discontinuities and be absolutely integrable, that is,
            



(18-3)





              A number of useful waveforms meet the Dirichlet conditions, for example, the rectangular pulse [
              u
              (
              t
              ) -
              u
              (
              t
              -
              T
              )](|
              T
              | < ∞) and the causal exponential
              u
              (
              t
              )
              e

                -α
                t

              (α > 0). While the Dirichlet conditions are mathematically sufficient, they are not necessary
              and
              sufficient—there being many useful signals with Fourier transforms that fail to meet them.
            

              Finally, whenever
              F
              (ω) exists there is a unique, one-to-one correspondence between a waveform
              f
              (
              t
              ) and its Fourier transform
              F
              (ω). Uniqueness means that a transform pair can be used to go from waveform to transform or transform to waveform. Once we have developed a basic set of pairs, we will summarize our results in a table of Fourier transform pairs similar to our table of Laplace transform pairs.
            












EXAMPLE 18-1



                      Find the Fourier transform of the rectangular pulse in
                      Figure 18-1
                      (a) and plot its amplitude spectrum.
                    









FIGURE 18-1








SOLUTION:



                  The specified waveform meets the Dirichlet conditions since it is clearly absolutely integrable and has only two isolated discontinuities. For this waveform, the integration limits in
                  Eq. (18-1)
                  are -
                  T
                  /2 and +
                  T
                  /2 since
                  f
                  (
                  t
                  ) is zero everywhere outside this range. As a result,
                  F
                  (ω) is found as
                




Figure 18-1
                  (b) shows a plot of the amplitude spectrum |
                  F
                  (ω)| versus ω.
                  
2

                  The spectrum of a rectangular pulse is a continuous function of a continuous frequency variable. There is some spectral content in every nonzero frequency range no matter how small. The isolated nulls in the spectral plot occur at the discrete frequencies ω = 2
                  k
                  π/
                  T
                  (
                  k
                  = ±1, ±2,...) where sin(ω
                  T
                  /2) = 0.
                







FIGURE 18-1







■












Exercise 18-1



                  Use MATLAB to compute the Fourier transform of the rectangular pulse in
                  Figure 18-1
                  .
                

                  Set
                  A
                  = 1 and
                  T
                  = 1 and plot the magnitude of the Fourier transform versus ω for -20 < ω < 20 rad/s.
                
Answers:
The required MATLAB code is

                  
                    % Create the symbolic variables
                    syms
                    t A T w
                    % Compute the Fourier transform
                    Fw1 = int(A*exp(-1i*w*t),t,-T/2,T/2)
                    % Plot the transfer function response
                    % Substitute in the given values
                    Fw = subs(Fw1, {AT}, {1 1});
ww = -20:0.05:20;
                    % Shift the frequency variable by a small amount to
                    % avoid a division by zero error
                    ww = ww+eps;
Fw = subs(Fw,w,ww);
MagFw = abs(Fw)
                    'r'
                    plot (ww, MagFw,
                    'r'
                    ,
                    'LineWidth'
                    , 2.5)
grid
                    on
                    xlabel(
                    'Frequency, (rad/s)'
                    )
ylabel(
                    'Magnitude, |F(\omega)|'
                    )
                  
                

                  The Fourier transformyields an answer thatagrees with the results in
                  Example 18-1
                  , that is,
                  F
                  (ω) = (2
                  A
                  sin (
                  T
                  ω/2))/ω.
                

                  MATLAB returns the plot shown in
                  Figure 18-2
                  .
                







FIGURE 18-2






















EXAMPLE 18-2



                      Find the Fourier transform of the causal exponential
                      f
                      (
                      t
                      ) =
                      Ae

                        -α
                        t

u
                      (
                      t
                      ) and plot its amplitude and phase spectra. Assume α > 0.
                    




SOLUTION:



                  This waveform also meets the Dirichlet conditions since it has only one isolated discontinuity and is absolutely integrable in the sense of
                  Eq. (18-3)
                  . The waveform is causal, so the integration extends from
                  t
                  = 0 to
                  t
                  = +∞ .
                




                  For α > 0, the integral vanishes at the upper limit and
                  F
                  (ω) becomes
                




                  The amplitude and phase spectra of
                  F
                  (ω) are
                



and




Figure 18-3
                  shows plots of the amplitude and phase spectra. The amplitude spectrum of this aperiodic waveform is a continuous function of a continuous frequency variable. There is some spectral content at every frequency, including negative frequencies.
                







FIGURE 18-3







■











Exercise 18-2


                  Find the Fourier transform of the waveform in
                  Figure 18-4
                  .
                


Answer:












FIGURE 18-4









              Although we have discussed the following topic previously, it is worth saying again. We saw in
              Chapter 13
              that a periodic signal has infinite harmonic frequencies. If one has a receiver that could tune from dc to infinity, one would come across signals that would occur periodically based on the period of the function. As long as the periodic function would last, the strength of each of the harmonics would remain the same according to the Fourier components of the particular periodic function. In between each harmonic, there would be no signal. If a particular harmonic was strong enough to interfere with a desired signal, a notch filter could be used to eliminate the harmonic.
            

              An aperiodic signal, on the other hand, sends a signal across the entire spectrum. If one were to tune the receiver from dc to infinity, the receiver would come across the signal regardless of the frequency selected, unless the particular signal had some nulls like those shown in the frequency response of the square pulse. There would be no way to block the signal if it was interfering with a desired signal. The g∞d news, however, is that the aperiodic signal will only last as long as its time duration. Often it appears as a brief pulse or an audible click. The higher the amplitude of the aperiodic
              
              signal, the larger the pulse. The total energy contained in the pulse is the only energy available and has to be spread out over the entire frequency spectrum. While there are many aperiodic signals giving rise to infinite signals, such as sparks and lightning strikes, many are usually t∞ weak to be detected unless the receiver is very close to the source of the pulse. An electromagnetic pulse or EMP, is an ultra-high intensity pulse of energy that is of very short duration. Its energy spectrum spreads across the entire frequency range and because of its intensity and inability to be filtered out, the energy can couple with electronic devices and severely damage them.
            


Inverse Fourier Transforms
The formal inversion integral for Laplace transforms is difficult to use. In contrast, the inversion integral for Fourier transforms is comparatively easy to use. As an example, consider the transform


(18-4)




              The transform is a frequency-domain impulse located at ω = β with an area of 2π. The inverse transform is found by applying the inversion integral in
              Eq. (18-2)
              . Because
              F
              (ω) is zero everywhere except at ω = β, the integration limits need only span the range from ω = β- to ω = β+, just slightly above and below the frequency ω = β.
            


(18-5)




              Straightforward use of the inversion integral yields
              
              . Because the Fourier transformation is unique, we also know that
              
              .
            

              In particular, if β = 0, then
              f
              (
              t
              ) =
              e
0
              = 1 for all time
              t
              and
              F
              (ω) = 2πδ(ω). In other words, the Fourier transform of a dc waveform with amplitude
              A
              = 1 is an impulse of area 2π at ω = 0.
              Figure 18-5
              shows the waveform and Fourier transform of a dc signal. Note that the dc waveform is noncausal so it cannot be represented by a Laplace transform. Likewise, the dc waveform does not meet the Dirichlet conditions because it is not absolutely integrable.
            







FIGURE 18-5


















EXAMPLE 18-3


Use the inversion integral to find the waveform corresponding to the transform







SOLUTION:


    
                  For this transform, the integration limits on the inversion integral run from ω = -β to ω = +β because
                  F  
                  (ω) is zero everywhere except in this range. Hence, the inverse transform is
                




Figure 18-6
                  shows the given amplitude spectrum |  
                  F
                  (ω)| and the resulting inverse transform
                  f
                  (
                  t
                  ). The waveform
                  f
                  (
                  t
                  ) =
                  A
                  sin(β
                  t
                  )/(β
                  t
                  ) is another example of the function
                  
                  sinc(
                  x
                  ) = sin(
                  x
                  )/
                  x
                  , which plays an important role in Fourier analysis. Note that
                  f
                  (
                  t
                  ) is a noncausal waveform for which there is no Laplace transform.
                







FIGURE 18-6







■











Exercise 18-3


                  Use the inversion integral to find the inverse transform of
                  F
                  (ω) =
                  j
                  ωπ[
                  u
                  (ω + 1) -
                  u
                  (ω - 1].
                


Answer:









Laplace Transforms and Fourier Transforms

              For certain signals, there is a simple relationship between the Laplace and Fourier transforms. In
              Chapter 9
              , the integral definition of Laplace transforms is given as
            



(18-6)





              where
              s
              =
              σ
              +
              j
              ω is the complex frequency variable. The lower limit of this integration reminds us that
              f
              (
              t
              ) must be causal for a unique transform pair to exist. If
              f
              (
              t
              ) is absolutely integrable in the sense defined in
              Eq. (18-3)
              , then the Laplace transform integration converges when
              σ
              = 0, in which case
              Eq. (18-6)
              becomes
            



(18-7)





              On the other hand, when
              f
              (
              t
              ) is causal and absolutely integrable, its Fourier transform exists and is found from
              Eq. (18-1)
              to be
            



(18-8)





              Comparing
              Eqs. (18-7)
              and
              (18-8)
              , we conclude that
            



(18-9)





              provided that
              f
              (
              t
              ) is causal and absolutely integrable.
            

              For
              f
              (
              t
              ) to be absolutely integrable, it must have finite duration or decay to zero as
              t
              → ∞. A sufficient condition for
              f
              (
              t
              ) to decay to zero is that all of the poles of
              F
              (
              s
              ) lie in the left half plane. For example, the Laplace transform of the causal exponential is
              
              . The transform has a pole at
              s
              = -α, which lies in the left half of the
              s
              plane for α > 0. When α > 0, the Fourier transform of the causal exponential is found from its Laplace transform to be
            




              The
              F
              (ω) obtained here using Laplace transforms agrees with
              Example 18-2
              , where the integral definition of Fourier transforms gave the same result.
            

              We can use
              Eq. (18-9)
              to find
              F
              (ω) provided the poles of
              F
              (
              s
              ) avoid both the right half plane and the
              j
              -axis boundary. For example, the Fourier transform of a causal sinusoid cannot be found from its Laplace transform. The reason is that the transform
            




              has poles on the
              j
              axis at
              s
              = ±
              j
              β.
            


              The Laplace transform method can be used to find the Fourier transform of the unit impulse because 8(
              t
              ) is causal and absolutely integrable. Applying
              Eq. (18-9)
              , we obtain
            


(18-10)




Figure 18-7
              shows the impulse waveform δ(
              t
              ) and its constant-amplitude spectrum |Δ(ω)|. Note the duality between
              Figures 18-7
              and
              18-5
              .
              Figure 18-5
              shows that a constant time-domain waveform leads to an impulse in the frequency domain. The dual result in
              Figure 18-7
              shows that an impulse in the time domain leads to a constant in the frequency domain.
            







FIGURE 18-7



Waveform and Fourier transform of the unit impulse signal.




              Laplace transform concepts can be used to find inverse Fourier transforms as well. Given a Fourier transform
              F
              (ω), we form a Laplace transform
              F
              (
              s
              ) by replacing
              j
              ω by
              s
              , or equivalently, replacing co by -
              js
              . If the poles of
              F
              (
              s
              ) all lie in the left half of the
              s
              plane, then by the uniqueness property of Fourier and Laplace transforms, we have
            


(18-11)




              Partial fraction expansion can be used to find the inverse transform of
              F
              (
              s
              ) in this equation. However, keep in mind that the Laplace transform method requires either (1)
              f
              (
              t
              ) to be causal and absolutely integrable, or (2) all of the poles of
              F
              (
              s
              ) to be in the left half of the
              s
              plane.
            






Exercise 18-4

Use Laplace transforms to find the Fourier transforms of the following causal waveforms. Assume that α > 0.



Answers:


















EXAMPLE 18-4

Use Laplace transforms to find the inverse Fourier transform of







SOLUTION:



                  Replacing
                  j
                  ω by
                  s
                  yields
                





F
                  (
                  s
                  ) is a rational function of
                  s
                  with poles at
                  s
                  = -2 and
                  s
                  = -4. Both poles are in the left half plane, so the inverse transform of
                  F
                  (
                  s
                  ) is the inverse transform of
                  F
                  (ω). Expanding
                  F
                  (
                  s
                  ) by partial fractions yields
                




                  The poles are simple so the residues
                  k
1
                  and
                  k
2
                  are
                




                  and the inverse transform of
                  F
                  (ω) is
                




■












Exercise 18-5



                    (a)  Use the Laplace transform method to find the causal waveform corresponding to the following Fourier transform:
                    



(b)  Use MATLAB's ilaplace function to validate your result.

Answers:



MATLAB returns ft = 10*exp(-5*t) - 5*exp(-t)










Exercise 18-6

Explain why Laplace transforms cannot be used to find the Fourier transforms of the following waveforms. Assume α > 0.


                    (a)  
                    f
                    (
                    t
                    ) =
                    A
                    α
                    tu
                    (
                    t
                    )
                  

                    (b)  
                    f
                    (
                    t
                    ) =
                    Ae

                      -α|
                      t
                      |
                    


                    (c)  
                    f
                    (
                    t
                    ) =
                    A
                    sin α
                    t


Answers:


                    (a)  
                    f
                    (
                    t
                    ) is not absolutely integrable or, equivalently,
                    F
                    (
                    s
                    ) has a double pole at
                    s
                    = 0.
                  

                    (b), (c)
                    f
                    (
                    t
                    ) is not causal, or equivalently (b) has a pole in the RHP, and (c) has poles on the
                    j
                    ω axis.
                  











Exercise 18-7

Explain why Laplace transforms cannot be used to find the inverse transforms of the following functions. Assume α > 0.



Answers:


                    (a)  
                    F
                    (
                    s
                    ) has a right half plane pole at
                    s
                    = +α.
                  

                    (b)  
                    F
                    (
                    s
                    ) is not a rational function.
                  






Basic Fourier Transform Properties and Pairs
We will introduce eight properties of the Fourier transformation, and use these properties to derive additional transform pairs.


Linearity
Both Laplace and Fourier transforms are linear transformations, which means that the transform of a sum of waveforms is the sum of their transforms. Stated formally, the linearity property is


(18-12)




              where
              A
              and
              B
              are constants. Proof of this property follows directly from the integral definition of Fourier transforms.
            



The following example is an application of linearity.












EXAMPLE 18-5


                      Find the Fourier transforms of the eternal sinusoids cos β
                      t
                      and sin β
                      t.
                      Repeat using MATLAB's function "
                      fourier.
                      "
                    




SOLUTION:



                  The Laplace transforms method doesn't work here because these waveforms are not causal. We previously found the Fourier transform of complex exponential
                  e

j
                    β
                    t

                  to be
                




                  Using Euler's relationship for cosp
                  t
                  and the linearity property, we can write
                




                  Similarly, for sin β
                  t
                  we have
                



Here we see that the transforms of cos pt and sin pt involve impulses located at ω = ±β. In general, the spectral content of a Fourier transform is distributed across a continuous range of frequencies. The spectral content of a sinusoid is concentrated in frequency-domain impulses.


                  We use MATLAB's
                  fourier
                  function as follows:
                

                  
                    syms
                    B t w
                    Fw_cos = fourier(cos(B*t))
Fw_sin = fourier(sin(B*t))
                  
                
MATLAB returns

                  Fw_cos = pi*(dirac(B + w) + dirac(B - w))
Fw_sin = pi*(dirac(B + w) - dirac(B - w))*1i
                

                  Which is the same as found by hand calculation.
                  ■











Exercise 18-8


                  Use MATLAB to find the Fourier transform of
                  f
                  (
                  t
                  ) =
                  Ae

                    -|α
                    t
                    |
                  
                  cos (β
                  t
                  ) for α > 0.
                
Answers:
The required MATLAB code is

                  syms A B t w real
 syms a positive
 Fw = simplify(fourier(A*exp(-abs(a*t))*cos(B*t),t,w))
 The result is

 Fw = (2*A*a*(B^2 + a^2 + w^2))/(B^4 + 2*B^2*a^2 - 2*B^2*w^2
     + a^4 + 2*a^2*w^2 + w^4)
                




Time Differentiation and Integration

              The
              time differentiation
              property of Fourier transforms states that differentiating
              f
              (
              t
              ) in the time domain corresponds to multiplying
              F
              (ω) by
              j
              ω in the frequency domain. That is,
            


(18-13)



Derivation of this property of Fourier transforms begins with the inversion integral:



We first differentiate both sides of this equation with respect to time:



Assuming the order of integration and differentiation on the right side of this equation can be interchanged, we obtain




              The right side of the last line in this equation implies
              
              . Since
              g
              (
              t
              ) =
              df
              /
              dt
              , we conclude that
            



as expected.


              Given the form of the differentiation property, it is reasonable to expect that integrating
              f
              (
              t
              ) in the time domain corresponds to dividing
              F
              (ω) by
              j
              ω in the frequency domain. This proves to be correct, except that integrating a waveform may produce a constant offset or dc component. As we have seen, the Fourier transform of a dc waveform is an impulse at ω = 0
            

              As a result, the statement of the
              integration property
              is
            


(18-14)




              Integrating
              f
              (
              t
              ) in the time domain leads to division of
              F
              (ω) by
              j
              ω plus an additive term π
              F
              (0)δ(ω) to account for the possibility of a dc component that may appear in the integral of
              f
              (
              t
              ).
            












EXAMPLE 18-6



                      Use the integration property to find the Fourier transform of the step function
                      u
                      (
                      t
                      ).
                    




SOLUTION:



                  The Fourier transform of an impulse was previously found to be
                  
                  . Since the step function is the integral of an impulse, the integration property yields the Fourier transform of the unit step function.
                




■












Exercise 18-9

Use symbolic operations in MATLAB to confirm the time differentiation property of Fourier transforms.


Answer:


The required MATLAB code is

                  syms t w real
 syms f(t)
 Fw = fourier(diff(f(t)),t,w)
                
The result is

                  Fw = w*fourier(f(t), t, w)*1i
                
which confirms the time differentiation property.




Reversal

              The
              reversal
              property states that
            


(18-15)




              Simply stated, reversing
              f
              (
              t
              ) in the time domain reverses
              F
              (ω) in the frequency domain.
            
Deriving this property begins with the integral definition of Fourier transforms.


(18-16)





              Defining
              
              , we can write
            




              Changing the dummy variable of integration to τ = -
              t
              produces
            




              We conclude that
              
              , as stated in the reversal property.
            

              The reversal property is used to derive the Fourier transforms of waveforms of the type in
              Figure 18-8
              . The mathematical expressions for these two waveforms are
            







FIGURE 18-8



Waveforms of the signum and doublesided exponential signals.






(18-17)





              The first waveform is called the
              signum function,
              which is defined as positive 1 for
              t
              > 0, negative 1 for
              t
              < 0, and zero at
              t
              = 0. As a result, sgn(t) can be expressed as the difference between a step
              u
              (
              t
              ) to a reversed step
              u
              (-
              t
              ), as indicated in
              Eq. (18-17)
              .
            

              The second waveform in
              Figure 18-8
              is calleda
              double-sided
              exponential, which is defined as the sum of a causal exponential and a reversed causal exponential. This waveform is 1 at
              t
              = 0 and decays exponentially to zero in both directions along the time axis.
            

              The signum and double-sided exponential are examples of noncausal waveforms that can be written as
              f
              (
              t
              ) =
              g
              (
              t
              )±
              h
              (-
              t
              ), where
              g
              (
              t
              ) and
              h
              (
              t
              ) are causal. If the Fourier transforms of
              g
              (
              t
              ) and
              h
              (
              t
              ) are known, then the reversal property yields
              F
              (ω) =
              G
              (ω) ±
              H
              (-ω).
            











EXAMPLE 18-7


                      Use the reversal property to find the Fourier transform of
                      f
                      (
                      t
                      ) = sgn(
                      t
                      ).
                    




SOLUTION:



                  The signum function is expressed as sgn(
                  t
                  ) =
                  u
                  (
                  t
                  ) -
                  u
                  (-
                  t
                  ). In
                  Example 18-6
                  , we found that
                  
                  . Using the reversal property yields
                




                  In the last line of this equation, we have used the fact that δ(ω) = δ(-ω) since both impulses occur at ω = 0.
                  ■










Exercise 18-10


                  Use the reversal property to find the Fourier transform of
                  f
                  (
                  t
                  ) =
                  e

                    -α|
                    t
                    |
                  
                  . Assume α > 0.
                


Answer:










Duality

              The
              duality property
              states that
            


(18-18)



Proof of this property begins with the inversion integral written in the form




              Replacing
              t
              by -
              t
              yields
            




              Now interchanging
              t
              and ω produces
            




              Thus,
              
              , as stated in the duality property.
            

Figure 18-9
              illustrates the waveforms/transforms duality for rectangular functions. The upper pair comes from
              Example 18-1
              , where we found that a rectangular waveform has an oscillating Fourier transform. The lower pair comes from
              Example 18-3
              , where we found that a rectangular transform produces an oscillating waveform. In sum, a rectangular function in one domain leads to an oscillatory sinc(
              x
              ) function in the other domain.
            







FIGURE 18-9



Example of duality property of Fourier transforms.














EXAMPLE 18-8


                      Given that
                      
                      , use the duality property to find the Fourier transform of
                      g
                      (
                      t
                      ) = α
                      2
                      /(α
                      2
                      +
                      t
2
                      ).
                    





SOLUTION:



                  If we define
                  f
                  (
                  t
                  ) =
                  e

                    -α|
                    t
                    |
                  
                  , then
                  F
                  (ω) = 2α/(α
                  2
                  + ω
                  2
                  ). According to duality,
                



But since



it follows from linearity that


■










Exercise 18-11


                  Use the duality property to find the Fourier transform of
                  g
                  (
                  t
                  ) = 1/
                  t.



Answer:



G
                  (ω) =
                  j
                  π sgn(-ω)
                




Time and Frequency Shifting
There are two shifting properties of the Fourier transforms:


(18-19)




              Proofs of these properties follow directly from the integral definitions in
              Eqs. (18-1)
              and
              (18-2)
              .
            

              The time-domain statement indicates that shifting a waveform by an amount
              T
              is equivalent to multiplying its transform by
              e

                -
                j
                ω
                T

              . One of the results of this is that delaying a waveform
              f
              (
              t
              ) does not change its amplitude spectrum since
            




              The frequency-domain statement says that shifting the location of a transform by an amount β is equivalent to multiplying the waveform by
              e

j
                β
                t

              . The frequency-domain shifting property is the basis for a signal processing operation called
              modulation,
              in which the spectrum of a signal is shifted from one frequency range to another.
            


Scaling

              The
              scaling property
              of the Fourier transformation is
            


(18-20)




              where
              a
              is a real constant.
            

Figure 18-10
              shows the Fourier transforms of two rectangular pulses with different pulse durations. The figure points out that shortening the pulse duration (
              a
              > 1) causes the transform to spread out in the frequency domain, and vice versa. For this reason, the scaling property is sometimes called the
              reciprocal spreading
              property. That is, compressing a signal in one domain causes it to spread out in the other domain. An important implication is that reducing pulse duration to increase data rate will increase the bandwidth requirement since the signal spectrum spreads
              
              out in the frequency domain and the amplitude in the frequency domain shrinks, requiring a stronger pulse to maintain a particular signal strength. In the limit, as the pulse gets narrower approaching an impulse, the signal in the frequency domain will spread to infinity before the first null occurs.
            







FIGURE 18-10



Example of scaling property of Fourier transforms.





Summary Tables

Table 18-1
              lists a basic set of Fourier transform pairs. Because of the uniqueness property, this table can be used in either direction. Additional pairs are easy to derive using the pairs in
              Table 18-1
              together with the transform properties summarized in
              Table 18-2
              .
            






Table

18-1


BASIC FOURIER TRANSFORM PAIRS












Table

18-2


BASIC FOURIER TRANSFORM PROPERTIES












Exercise 18-12



                  Use
                  Tables 18-1
                  and
                  18-2
                  to find the Fourier transforms of
                


                    (a)  
                    f
1
                    (
                    t
                    ) = sgn(
                    t
                    ) + 2
                  

                    (b)  
                    f
2
                    (
                    t
                    ) = cos(2
                    t
                    ) + 2
                  

Answers:


                    (a)
                    


                    (b)
                    












Exercise 18-13


                  Use
                  Tables 18-1
                  and
                  18-2
                  to find the inverse Fourier transforms of
                


                    (a)
                    


                    (b)
                    


Answers:


                    (a)  
                    f
1
                    (
                    t
                    ) =
                    u
                    (
                    t
                    ) + 1
                  

                    (b)  
                    f
2
                    (
                    t
                    ) = 2
                    e

                      -4
                      t

u
                    (
                    t
                    ) - 2δ(
                    t
                    ) + 2e
                    
                      -
                      j
                      2
                      t






18-2 Circuit Analysis Using Fourier Transforms

                Because of our previous study of Laplace transforms, it should come as no surprise that Fourier transforms can be used in linear circuit analysis. Using Fourier transforms follows a similar pattern as we saw in
                Chapter 10
                ,
                Figure 10-1
                , except instead of transforming our signals, circuit elements, and device constraints into the
                s
                domain
                F
                (
                s
                ), we transform them into the
                j
                ω domain
                F
                (ω).
              
Let us start by examining how the Fourier transforms apply to circuit analysis by seeing how they affect connection and device constraints.
In the time domain, a typical KVL constraint might be



Because of the linearity property, the Fourier transform of this equation is





                This example obviously generalizes to any KVL or KCL constraint. The Fourier transformation changes waveforms into transforms but leaves the form of the connection constraints unchanged.
              

                The frequency-domain element constraints are found by transforming the time-domain
                i-υ
                characteristics of the passive elements. Using the differentiation and linearity properties of Fourier transforms, we write the time-domain and frequency-domain element constraints as
              


(18-21)



As might be expected, in the frequency domain the element constraints are algebraic equations similar in form to Ohm's law. The proportionality factors relating the voltage and current transforms are the ac impedances of the passive elements, namely




                The forms of the frequency-domain connection and element constraints have a familiar ring. The key points are: (1) the Fourier transformation does not change the form of the connection constraints; and (2) the element constraints are similar to Ohm's law. We have seen analogous conclusions before in our study ofsinusoidal steady-state (phasor) circuit analysis in
                Chapter 8
                and again in
                s
                -domain circuit analysis in
                Chapter 10
                . As a result, we know that our repertoire of algebraic circuit analysis technique can be applied in the frequency domain.
              
To use Fourier methods in circuit analysis, we represent currents and voltages as transforms and passive elements as ac impedances. We then use analysis techniques such as voltage division, current division, equivalence, or even node/mesh analysis to solve for the unknown current or voltage transforms. Inverse Fourier transforms are then used to obtain the response waveform in the time domain.

                This discussion closely parallels the steps in
                s
                -domain circuit analysis, except for one thing—there is no mention of initial conditions. The reason for this omission is that the lower limit on the defining integral for Fourier transforms is
                t
                = -∞. In other words, Fourier transforms account for the entire history of a circuit beginning at
                t
                = -∞. With Laplace transforms the lower limit on the defining integral is
                t
                = 0, and the circuit's history for
                t
                < 0 is accounted for by the initial conditions at
                t
                = 0.
              

                In summary, the Fourier transform method of circuit analysis explicitly takes into account all inputs including those that happened prior to
                t
                = 0. Fourier transforms exist for noncausal waveforms, and the method yields responses that are valid for -∞ <
                t
                < ∞. As a result, Fourier transform methods cannot handle circuit analysis problems in which initial conditions are used to account for inputs prior to
                t
                = 0.
              












EXAMPLE 18-9



                        Use Fourier transforms to find
                        υ
2
                        (
                        t
                        ) in the circuit in
                        Figure 18-11
                        for
                        υ
1
                        (
                        t
                        ) =
                        u
                        (
                        t
                        ).
                      









FIGURE 18-11








SOLUTION:



                    This example asks us to find the step response of a first-order
                    RC
                    circuit. In
                    Chapter 7
                    , we solved this problem using classical differential equation methods. The problem
                    
                    was revisited in
                    Chapters 9
                    and
                    11
                    using Laplace transforms. From this previous experience, we already know that the answer is
                    υ
2
                    (
                    t
                    ) = [1 -
                    e

                      -
                      t
                      /
                      RC

                    ]
                    u
                    (
                    t
                    ). Our purpose here is simply to show how Fourier transforms produce the same result.
                  

                    The circuit in
                    Figure 18-11
                    is shown in the frequency domain, so we use voltage division to relate the input and output transforms.
                  




                    For a unit step function input
                    
                    and the output transform is
                  



The first term on the right side can be expanded by partial fractions as



The second term on the right side reduces to




                    That is, in general
                    F
                    (ω)δ(ω) =
                    F
                    (
                    0
                    )δ(ω) because the impulse δ(ω) is zero everywhere except at
                    c
                    = 0. Combining these results, the output transform can be arranged as
                  




                    Each term in this expansion is listed in
                    Table 18-1
                    , leading to
                  




                    As expected, the step response waveform is
                    υ
2
                    (
                    t
                    ) = [1 -
                    e

                      -
                      t
                      /
                      RC

                    ]
                    u
                    (
                    t
                    ) V. This example illustrates a rather subtle point. For causal inputs, Fourier transforms inherently yield only the zero-state response, whereas Laplace transforms yield both the zero-state and zero-input responses.
                    ■










Exercise 18-14


                    Use Fourier transforms to find
                    υ
2
                    (
                    t
                    ) in the circuit in
                    Figure 18-11
                    for
                    υ
1
                    (
                    t
                    ) =
                    Ae

                      -α
                      t

u
                    (
                    t
                    ) V.
                  


Answer:




















EXAMPLE 18-10


                        Use Fourier transforms to find
                        υ
2
                        (
                        t
                        ) in the circuit in
                        Figure 18-11
                        for
                        υ
1
                        (
                        t
                        ) = sgn(
                        t
                        ).
                      




SOLUTION:




                    In this example, we find the output of a first-order
                    RC
                    circuit for a noncausal input. From
                    Table 18-1
                    , the input transform is
                    V
1
                    (ω) = 2/
                    j
                    ω. Using the voltage division result from
                    Example 18-9
                    , we write
                  



Expanding by partial fractions,




                    Each term in this expansion is listed in
                    Table 18-1
                    . The inverse transform produces
                  




                    Both a noncausal signum waveform and a causal exponential are required to describe
                    υ
2
                    (
                    t
                    ) on the interval -∞ <
                    t
                    + ∞.
                    Figure 18-12
                    shows how these waveforms combine to produce
                    υ
2
                    (
                    t
                    ). A physical interpretation of this response is that signum waveform applies an input
                    υ
1
                    (
                    t
                    ) = −1 V at
                    t
                    = −∞ (a long time ago). After about five time constants (
                    t
                    = −∞ + 5
                    RC
                    , still a long time ago), the circuit output reaches a steady-state condition of
                    υ
2
                    (
                    t
                    ) = −1 V. Thus, for all practical purposes
                    υ
2
                    (
                    t
                    ) = −1 V for all
                    t
                    < 0. At
                    t
                    = 0, the signum input jumps from
                    υ
1
                    (
                    t
                    ) = -1 to +1 V. This drives the output from
                    υ
2
                    (
                    t
                    ) = −1 V at
                    t
                    = 0 to
                    υ
2
                    (
                    t
                    ) = +1 V for
                    t
                    > 5
                    RC
                    .
                  







FIGURE 18-12







■











Exercise 18-15


                    Use Fourier transforms to find
                    υ
2
                    (
                    t
                    ) in the circuit in
                    Figure 18-11
                    for
                    υ
1
                    (
                    t
                    ) =
                    u
                    (
                    t
                    ) − 1 V.
                  


Answer:



υ
2
                    (
                    t
                    ) = −u(−
                    t
                    ) −
                    e

                      −
                      t
                      /
                      RC

u
                    (
                    t
                    ) V
                  





18-3 Impulse Response and Convolution
The previous section shows that Fourier transforms can be used to analyze linear circuits. The process is straightforward once we acceptthe idea ofnoncausalwaveforms. However, the important applications of Fourier transforms are found in system analysis and signal processing rather than traditional circuit analysis.
Fourier transforms find applications in these areas because they can represent idealized models of signal processors. These ideal models often involve noncausal responses that cannot be represented by Laplace transforms. Of course real physical systems must have causal responses so these models can only be approximated by engineering hardware. Nevertheless, ideal models are useful in feasibility studies and as "gold standards" for evaluating real systems.

              Signal processors are often described in the frequency domain by the Fourier transform equivalent of the
              s
              -domain transfer function. To develop the Fourier equivalent, we begin with the convolution integral from
              Chapter 11
              :
            





              In this expression,
              y
              (
              t
              ) is the output of a system whose impulse response is
              h
              (
              t
              ) when the input is
              x
              (
              t
              ). The limits of integration are τ = 0 to τ =
              t
              because in
              Chapter 11
h
              (
              t
              ) and
              x
              (
              t
              ) are causal waveforms. To remove this limitation, the integration limits are extended backward to τ = -∞ to accommodate a noncausal input
              x
              (τ) and forward to
              t
              = +∞ to accommodate a noncausal
              h
              (
              t
              ). The result is
            



(18-22)




This equation is a general form of the convolution integral that applies to causal and noncausal waveforms alike.

              We now take the Fourier transformation on both sides of
              Eq. (18-22)
              .
            




              Next, we interchange the order of integration and factor out
              x
              (τ), since it does not depend on
              t.





              Using the time-shifting property, the quantity within the bracket is
              
              , and this equation reduces to
            




              By definition, the remaining integral inside the bracket is
              
              . We conclude that
            



(18-23)




Thus, in the frequency domain convolution is accomplished by multiplying the Fourier transform of the system impulse response by the Fourier transform of the input.

Equation (18-23)
              looks suspiciously like the
              s
              -domain relationship
              Y
              (
              s
              ) =
              T
              (
              s
              )
              X
              (
              s
              ), where
              T
              (
              s
              ) is the
              s
              -domain transfer function. Since the two input-output relationships have the same form, we call
              H
              (ω) the
              Fourier-domain transfer function.
              Key differences between
              
              are:
            


H
                (ω) exists for noncausal impulse responses for which
                T
                (
                s
                ) does not exist.
              

T
                (
                s
                ) exists for unstable impulse responses for which
                H
                (ω) does not exist.
              












EXAMPLE 18-11


                      The impulse response of a system is
                      h
                      (
                      i
                      ) =
                      e

                        -|
                        t
                        |
                      
                      . Use Fourier transform convolution to find the output
                      y
                      (
                      t
                      ) when
                      x
                      (
                      t
                      ) = sgn(
                      t
                      ).
                    




SOLUTION:




                  Using transform pairs in
                  Table 18-1
                  , we have
                



Using convolution in the frequency domain, the output transform is




                  Expanding
                  Y
                  (ω) by partial fractions,
                




                  Using
                  Table 18-1
                  , the inverse transform of the first term in the expansion is
                




                  According to the reversal property
                  
                  ; hence, the inverse transform of the second term is
                




                  The inverse transform of the third term is
                  
                  . So finally, the output waveform is
                




                  Notice that we cannot use Laplace transforms here because the input, output, and impulse response are all noncausal waveforms.
                  ■










Exercise 18-16


                  The impulse response of a system is
                  h
                  (
                  t
                  ) = 2
                  e

                    -4
                    t

u
                  (
                  t
                  ). Find the output
                  y
                  (
                  t
                  ) when
                  x
                  (
                  t
                  ) = -2 + 4
                  u
                  (
                  t
                  ).
                


Answer:



y
                  (
                  t
                  ) = sgn(
                  t
                  ) - 2
                  e

                    -4
                    t

u
                  (
                  t
                  )
                



              The Fourier domain transfer function
              H
              (ω) represents the system frequency response, including noncausal systems. For example, consider the
              H
              (ω) shown in
              Figure 18-13
              . In the filter terminology, the gain |
              H
              (ω)| is an
              ideal low-pass/filter
              with a passband gain of 1, a stopband gain of zero, and a bandwidth of p. In
              Example 18-13
              , we found that the waveform corresponding to a rectangular transform is the noncausal
              h
              (
              t
              ) shown in
              Figure 18-13
              . The noncausal
              h
              (
              t
              ) means that an ideal low-pass filter responds
              before
              the impulse is applied at
              t
              = 0. Such anticipatory behavior is physically impossible, which means that we can't actually build an ideal filter using physical hardware. Nevertheless, the ideal low-pass filter model is used in conceptual design work because it is easily implemented in the system simulation software and provides a "gold standard" for evaluating the performance of real systems.
            







FIGURE 18-13



Impulse response of an ideal low-pass filter.




              Fourier transforms highlight the relationship between impulse response and frequency response. Digital filter design involves defining an impulse response
              h
              (
              t
              ) whose Fourier transformH(ω) has a desired frequency response. The signal processing action is actually carried out using software that convolves
              h
              (
              t
              ) and
              x
              (
              t
              ) in the time domain. Fast algorithms for performing time-domain convolution are readily available in commercial software. Thus, Fourier methods play a key role in digital signal processing because they provide a computationally efficient way to implement signal filtering.
            











EXAMPLE 18-12



                      Describe the frequency response of a system whose impulse response is
                    







SOLUTION:



                  The given
                  h
                  (
                  t
                  ) is a two-sided exponential whose transform from
                  Table 18-1
                  is
                




Figure 18-14
                  shows the plot of gain |
                  H
                  (ω)| versus normalized frequency. The system acts like a low-pass filter with a dc gain of
                  H
                  (0) = 1 and the high-frequency gain rolls off α
                  2
                  /ω
                  2
                  , or -40 dB/decade, so to speak. The passband cutoff frequency occurs when
                  
                  , which requires
                







FIGURE 18-14









yielding


■










Exercise 18-17



                    (a)  Find the transfer function of a system whose impulse response is
                    h
                    (
                    t
                    ) = δ(
                    t
                    ) - α
                    e

                      -α|
                      t
                      |
                    
                    .
                  
(b)  Describe the frequency response of the system.

Answers:


                    (a)  
                    H
                    (ω) = (ω
                    2
                    - α
                    2
                    )/ (ω
                    2
                    + α
                    2
                    ).
                  
(b)  System has a bandstop characteristic with a notch at ω = ±α.





18-4 Parseval's Theorem
Parseval's theorem relates the energy carried by a waveform to the amplitude spectrum of its Fourier transform. The total energy carried by any waveform is defined to be




              where
              p
              (
              t
              ) is the power the waveform delivers to a specified load. For a resistive load
              p
              (
              t
              ) =
              υ
2
              (
              t
              )/
              R
              =
              i
2
              (
              t
              )
              R
              , so the energy delivered to a 1-Ω, resistive load can be written in the form
            



(18-24)





              where
              f
              (
              t
              ) can be either a voltage or a current waveform.
              Equation (18-24)
              is often used as the definition of the energy carried by a waveform, although an implied 1-Ω resistance is required for the result to have the dimensions of energy.
            

Parseval's theorem
              states that the total energy carried by a signal can be calculated in either the time domain or the frequency domain.
            



(18-25)






              That is, the total 1-Ω energy can be found from either the waveform
              f
              (
              t
              ) or its transform
              F
              (ω).
            

              Parseval's theorem assumes that the integrals in
              Eq. (18-25)
              converge to a finite value. Signals for which
              W
1Ω
              is finite are called
              energy signals.
              Examples of energy signals are the causal exponential, the two-sided exponential, the rectangular pulse, and the damped sine. Finite energy is a stronger requirement than being absolutely integrable. As a result, not all signals that have Fourier transforms are energy signals. For example, the impulse, step, signum, and eternal sinusoid all have Fourier transforms but are not energy signals.
            

              The derivation of Parseval s theorem begins with energy in the time domain. Assuming the Fourier transform of
              f
              (
              t
              ) exists, this energy can be written in the form
            




              The integration within the brackets does not involve time, so
              f
              (
              t
              ) can be moved inside the second integral and the 1/2π moved outside the first integral to produce
            




              Reversing the order of integration and factoring out
              F
              (ω) produces
            




              By definition, the function inside the bracket is
              F
              (-ω). But
              F
              (-ω) is formed by replacing
              j
              ω by
              j
              (-ω) = -
              j
              ω, which means that
              F
              (-ω) =
              F
              (ω)*, the conjugate of
              F
              (ω). Thus, the product
              F
              (ω)
              F
              (-ω) is the square of the magnitude of
              F
              (ω) and this equation reduces to
            



as stated in Parseval s theorem.

              Since |
              F
              (ω)|
              2
              is an even function, the integral from -∞ to 0 is the same as the integral from 0 to +∞. Hence,
            



and Parseval s theorem can also be written as


(18-26)















EXAMPLE 18-13



                      Derive an expression for the 1-Ω energy in the causal exponential
                      υ
                      (
                      t
                      ) =
                      V
A
e

                        -α
                        t

u
                      (
                      t
                      ) V (a) in the time domain and (b) in the frequency domain.
                    




SOLUTION:





                    (a)  The given waveform is causal, so the time integration extends from
                    t
                    = 0 to
                    t
                    = +∞.
                    


This result applies if α > 0 since for α < 0 the waveform is unbounded and the integral does not converge. In other words, an unbounded exponential is not an energy signal.


                    (b)  The Fourier transform of the signal is
                    V
                    (ω) =
                    V
A
                    /(
                    j
                    ω + α) provided α > 0. In the frequency domain, the 1-Ω energy is found to be
                    



                      which is the same as the result in (a).
                      ■












Exercise 18-18


                  Derive an expression for the 1-Ω energy in the waveform
                  υ
                  (
                  t
                  ) =
                  A
                  [
                  u
                  (
                  t
                  +
                  T
                  ) -
                  u
                  (
                  t
                  -
                  T
                  )] V (a) in the time domain and (b) in the frequency domain.
                
Answers:


                    (a)  
                    W
1Ω
                    = 2
                    A
2
T


                    (b)  
                    W
1Ω
                    = 2
                    A
2
T





Applications of Parseval's Theorem

                The square amplitude spectrum |
                F
                (ω)|
                2
                is called the
                energy spectral density
                because it describes how the total energy carried by
                f
                (
                t
                ) is distributed among the frequencies in its spectrum. In this sense, we think of the integral
              




                as the amount of energy carried by frequencies in the band ω
                1
                < ω < ω
                2
                . Notice that the energy distribution for a Fourier transform is fundamentally different than for a Fourier series. With a Fourier transform the energy carried by
                f
                (
                t
                ) is distributed across all of the frequencies between ω
                1
                and ω
                2
                . With a Fourier series, the energy is located only at the discrete harmonic frequencies.
              











EXAMPLE 18-14



                          (a)  Find the percentage of the energy in
                          υ
                          (
                          t
                          ) =
                          V
A
e

                            -α
                            t

u
                          (
                          t
                          ) V that is carried in the frequency band |ω| < α.
                        
(b)  What frequency band carries 90% of the 1-Ω energy?





SOLUTION:





                      (a)  The energy in the band |ω| < α is
                      



                        In
                        Example 18-13
                        , we found that the total energy is
                        W
1Ω
                        = (
                        V
A
                        )
                        2
                        /2α; hence, the energy ratio is
                      



That is, 50% of the total energy is carried in the frequency band |ω| < α.


                      (b)  Let the frequency band |ω| < β carry 90% of the total energy. The energy in this band is
                      


The equality sign in the last line of this equation requires that




                        Hence, the band |ω| < 6.31 a carries 90% of the total energy.
                        ■












Exercise 18-19


                    Find the percentage of the 1-Ω energy in
                    υ
                    (
                    t
                    ) =
                    A
                    [
                    u
                    (
                    t
                    +
                    T
                    ) -
                    u
                    (
                    t
                    -
                    T
                    )] V that is carried in the frequency band |ω| < π/
                    T
                    , which represents the main lobe of the spectrum.
                  


Answer:


90.28%



                The energy viewpoint offers a way to quantify the selectivity of filters. Since the output of a filter is
                Y
                (ω) =
                H
                (ω)
                X
                (ω), the energy spectral density of the output signal is
              



(18-27)





                Combining
                Eqs. (18-25)
                and
                (18-27)
                yields the energy in the output signal as
              


(18-28)



We can view filtering as a process that shapes the output energy spectral density by accepting input energy at frequencies in the passband and rejecting input energy at frequencies in the stopband. Note that we calculate the energy processing from the Fourier transforms rather than the signal waveforms.












EXAMPLE 18-15



                        The signal
                        x
                        (
                        t
                        ) = 10
                        e

                          -20
                          t

u
                        (
                        t
                        ) is input to an ideal low-pass filter with
                        H
                        (ω) =
                        u
                        (ω  + 100) -
                        u
                        (ω - 100). Find the percentage of the input energy in the output signal.
                      





SOLUTION:


The 1-Ω energy in the input signal is




                    The Fourier transform of the input signal is 10/(20 +
                    j
                    ω). The frequency response of the ideal low-pass filter is |
                    H
                    (ω)| = 1 for |ω| < 100 and |
                    H
                    (ω)| = 0 elsewhere. The 1-Ω energy in the output signal is
                  




                    The fraction of the input energy in the output signal is 2.19/2.5, or about 87.6%.
                    ■










Exercise 18-20



                      (a)  Find the total 1-Ω energy carried by a double-sided exponential
                      f
                      (
                      t
                      ) =
                      Ae

                        -α|
                        t
                        |
                      
                      .
                    
(b)  Find the fraction of the total energy carried by the frequencies band |ω| < α.

Answers:


                      (a)  A
                      2
                      /α
                    
(b)  0.5 + 1/π = 0.818

















EXAMPLE 18-16


                        The transfer function of a first-order low-pass filter is
                        H
                        (ω) = 100/(100 +
                        j
                        ω). The input signal to the filter is
                        x
                        (
                        t
                        ) = 10
                        e

                          -20
                          t

u
                        (
                        t
                        ).
                      

(a)  Find the percentage of the input energy in the filter output signal.
(b)  Find the percentage of the output energy that lies within the filter passband.





SOLUTION:




                      (a)  The input signal is the same as in
                      Example 18-15
                      , where we found
                      W
1Ω,IN
                      = 2.5 J.
                      The following commented MATLAB code performs all of the computations associated with finding the percentage of the input energy in the filter output signal:

                        % Create symbolic variables
    syms t w real
    % Define the input signal and find its Fourier transform
    xt = 10*exp(-20*t)*heaviside(t);
    Xw = fourier(xt,t,w);
    % Define the transfer function
    Hw = 100/(100 + 1i*w);
    % Find the input energy
    Win = double(int(xt^2,t,-inf,inf))
    % Compute the output signal
    Yw = Hw*Xw;
    % Compute the output energy
    Wout = double(int(Yw*conj(Yw),w,0,inf)/pi)
    % Find the percentage of input energy in the output
    Wpercent = double(Wout/Win)
                      


                        The results are
                      

                        Win = 2.5000
    Wout = 2.0833
    Wpercent = 0.8333
                      
Therefore, 83.3% of the input energy is in the filter output signal.


                      (b)  The cutoff frequency of the low-pass filter is 100 rad/s. The following MATLAB code computes the percentage of the output energy in the passband, given that we have already executed the MATLAB code presented in part (a).
                      
                        % Find the output energy in the passband
    Woutpb = double(int(Yw*conj(Yw),w,0,100)/pi)
    % Find the percentage of output energy in the passband
    Wpbpercent = double(Woutpb/Wout)
                      
The results are:

                        Woutpb = 2.0165
    Wpbpercent = 0.9679
                      

                        Therefore, 96.8% of the output energy lies within the filter passband.
                        ■












Exercise 18-21


                    What percentage of the total energy in
                    f
                    (
                    t
                    ) = 5
                    e

                      -10
                      t

u
                    (
                    t
                    ) is carried by the frequency band |ω| > 5 rad/s?
                  


Answer:


70.5%




Summary


                  The Fourier transformation applies to
                  aperiodic waveforms
                  that may be causal or noncausal.
                

                  Sufficient conditions for the existence of
                  F
                  (ω) are that
                  f
                  (
                  t
                  ) be absolutely integrable and have a finite number of discontinuities. Signals not meeting these conditions may still have a Fourier transform. When it exists, a Fourier transform is unique.
                

                  If
                  f
                  (
                  t
                  ) is causal and absolutely integrable, then its Fourier transform can be obtained from its Laplace transform
                  F
                  (
                  s
                  ) by replacing
                  s
                  by
                  j
                  ω. A causal waveform
                  f
                  (
                  t
                  ) is absolutely integrable if all of the poles of
                  F
                  (
                  s
                  ) lie in the left half of the
                  s
                  plane.
                

Circuit analysis
                  using Fourier transforms involves finding the input transform, transforming the circuit into the frequency domain, solving for the unknown response transform, and performing the inverse transform to obtain the response waveform.
                

                  The frequency-domain transfer function
                  H
                  (ω) is the Fourier transform of the
                  system impulse response.
                  The system output transform is
                  Y
                  (ω) =
                  H
                  (ω)
                  X
                  (ω), where
                  X
                  (ω) is the Fourier transform of the input.
                

Parseval's theorem
                  relates the energy carried by a waveform
                  f
                  (
                  t
                  ) to its Fourier transform
                  F
                  (ω). The theorem allows us to find the percentage of the total input energy in the output of a filter and to find the percentage of the output energy carried in specified frequency bands.
                





Chapter 18 Problems





Objective 18-1 The Fourier Trans Form (Sect. 18-1)

(a)  Given an equation or graph of an aperiodic waveform, derive an expression for the Fourier transform.
(b)  Given an equation or graph of a Fourier transform, derive an expression for the corresponding waveform.
(c)  Understand the relationship between Fourier transforms and Laplace transforms and know the conditions under which Laplace transform techniques can be used to compute Fourier transforms.


                  See
                  Examples 18-1
                  to
                  18-8
                  and
                  Exercises 18-1
                  to
                  18-13
                  .
                





18-1
                Use the defining integral to find the Fourier transform of
                f
                (
                t
                ) =
                A
                [
                u
                (
                t
                + 1) -
                u
                (
                t
                - 2)].
              


18-2


(a)
                    Use the defining integral to find the Fourier transform of the following waveform:
                    




(b)
                     Use the MATLAB function fourier to find the same transform.
                  





18-3
                Use MATLAB and the defining integral to find the Fourier transform of the following waveform:
                




18-4
                Use the inversion integral to find the inverse transform of the following function:
                






18-5
                Use MATLAB and the inversion integral to find the inverse transform of the following function:
                




18-6
                First find the transforms of the following functions. Then determine what type of characteristics they possess.
                

(a)
                     
                    f
1
                    (
                    t
                    ) = 100
                    e

                      -100
                      t

u
                    (
                    t
                    )
                  

(b)
                     
                    f
2
                    (
                    t
                    ) = 1.25[
                    e

                      -100
                      t

                    -
                    e

                      -500
                      t

                    ]
                    u
                    (
                    t
                    )
                  

(c)
                     
                    





18-7
                Find the inverse transforms of the following functions:
                

(a)
                     
                    


(b)
                     
                    





18-8
                Use MATLAB's fourier function to find the Fourier transforms of the following waveforms:
                

(a)
                     
                    f
1
                    (
                    t
                    ) = 3
                    u
                    (-
                    t
                    ) - 3
                  

(b)
                     
                    f
2
                    (
                    t
                    ) = -sgn(
                    t
                    ) -
                    u
                    (-
                    t
                    )
                  

(c)
                     
                    f
3
                    (
                    t
                    ) = sgn(
                    t
                    ) + 1
                  




18-9
                Find the Fourier transforms of the following waveforms:
                

(a)
                     
                    


(b)
                     
                    




18-10
                Find the Fourier transforms of the following waveforms:
                

(a)
                     
                    f
1
                    (
                    t
                    ) = 100sin[2π(
                    t
                    - 10)]
                  

(b)
                     
                    f
2
                    (
                    t
                    ) = 5
                    e

j
                      10
                      t

                    sgn(
                    t
                    )
                  




18-11
                Find the inverse transforms of the following functions:
                

(a)
                     
                    F
1
                    (ω) = 6πδ(ω) + 6πδ(ω - 3) + 6πδ(ω - 4)
                  

(b)
                     
                    F
2
                    (ω) = 4πδ(ω) -
                    j
                    6/ω + 4πδ(ω - 2)
                  

(c)
                     
                    F
3
                    (ω) = 10πδ(ω) -
                    j
                    20/ω
                  



18-12
                Use the duality property to find the inverse transforms of the following functions:
                

(a)
                     
                    F
1
                    (ω) = 50cos(100ω)
                  

(b)
                     
                    F
2
                    (ω) = 10
                    u
                    (ω) - 5
                  

(c)
                     
                    F
3
                    (ω) = 6
                    e
-|2ω|





18-13
                Use the time-shifting property to find the inverse transforms of the following functions:
                

(a)
                     
                    F
1
                    (ω) = [6πδ(ω)
                    j
                    6/ω]
                    e

                      -
                      j
                      5ω
                    


(b)
                     
                    F
2
                    (ω) = 50
                    e
                    -
                    
j
                      4ω
                    
                    /(
                    j
                    ω + 5)
                  

(c)
                     
                    F
3
                    (ω) = 2cos(20ω)/
                    j
                    ω
                  



18-14
                Given that the Fourier transform of
                f
                (
                t
                )is
                


Use the integration property to find the waveform






18-15
                Use the reversal property to show that
                





18-16
                Use the frequency shifting property to show that
                










                  Objective 18-2 Fourier Transforms and Circuit Analysis (
                  Sects. 18-2
                  to
                  18-4
                  )
                

(a)  Given a linear circuit, use Fourier transform techniques to determine the output response for aperiodic input signals.
(b)  Given a linear circuit, use Parseval's theorem to determine the energy content of selected signals.


                  See
                  Examples 18-9
                  to
                  18-16
                  and
                  Exercises 18-14
                  to
                  18-21
                  .
                






18-17
                The input in
                Figure P18-17
                is
                υ
1
                (
                t
                ) = 5
                e

                  -|
                  t
                  |
                
                V. Use Fourier transforms to find
                υ
2
                (
                t
                ).
              








FIGURE P18-17








18-18
                The input in
                Figure P18-18
                is
                υ
1
                (
                t
                ) = 10sgn(
                t
                ) V. Use Fourier transforms to find
                υ
2
                (
                t
                ).
              








FIGURE P18-18









18-19
                The input in
                Figure P18-19
                is
                υ
1
                (
                t
                ) = 10
                e

                  10
                  t

u
                (-
                t
                ) V. Use Fourier transforms to find
                υ
2
                (
                t
                ).
              








FIGURE P18-19








18-20
                The input in
                Figure P18-19
                is
                υ
1
                (
                t
                ) = 2sgn(
                t
                ) V. Use Fourier transforms to find
                υ
2
                (
                t
                ).
              


18-21


(a)
                    The input in
                    Figure P18-21
                    is
                    υ
1
                    (
                    t
                    ) = 3
                    u
                    (-
                    t
                    ) V. Use Fourier transforms to find
                    υ
2
                    (
                    t
                    ).
                  

(b)
                     Will the OP AMP saturate?
                  










FIGURE P18-21








18-22
                The input in
                Figure P18-22
                is
                υ
1
                (
                t
                ) = 3
                e

                  -2|
                  t
                  |
                
u
                (-
                t
                ) V. Use Fourier transforms to find
                υ
2
                (
                t
                ).
              








FIGURE P18-22









18-23
                The input in
                Figure P18-23
                is
                i
1
                (
                t
                ) = 10
                e

                  -5|
                  t
                  |
                
                mA. Use Fourier transforms to find
                i
2
                (
                t
                ).
              








FIGURE P18-23








18-24
                The impulse response of a linear system is
                h
                (
                t
                ) = 5
                e

                  -3
                  t

u
                (
                t
                ). Find the output for an input
                x
                (
                t
                ) =
                u
                (-
                t
                ).
              


18-25
                The impulse response of a linear system is
                h
                (
                t
                ) =
                e

                  -2|
                  t
                  |
                
                . Find the output for an input
                x
                (
                t
                ) =
                u
                (-
                t
                ).
              


18-26
                The impulse response of a linear system is
                h
                (
                t
                ) = δ(
                t
                ) - 5
                e

                  -2
                  t

u
                (
                t
                ). Use MATLAB and Fourier transform techniques to find the output for an input
                x
                (
                t
                ) = sgn(-
                t
                ).
              



18-27
                The impulse response of a linear system is
                h
                (
                t
                ) =
                A
                [δ(
                t
                ) - α
                e

                  -α
                  t

u
                (
                t
                )], with α > 0. Let
                A
                = 10 and α = 3 and use MATLAB to plot |
                H
                (ω)|. On the same axes, plot |
                H
                (ω)| for
                A
                = 10 and α = 6. Describe the system frequency response and the influence of the parameter α.
              


18-28
                The impulse response of a linear system is
                h
                (
                t
                ) =
                A
                [δ(
                t
                ) - sin(β
                t
                )/π
                t
                ]. Let
                A
                = 5 and β = 2 and use MATLAB to plot |
                H
                (ω)|. On the same axes, plot |
                H
                (ω)| for
                A
                = 5 and β = 4. Describe the system frequency response and the influence of the parameter β. You may need to use the following equality in your solution:
                
                .
              


18-29
                Use MATLAB's ifourier function to find the system impulse response
                h
                (
                t
                ) if the frequency response of a linear system is shown in
                Figure P18-29
                .
              








FIGURE P18-29









18-30
                Find the 1-Ω energy carried by the signal
                F
                (ω) = 25/(ω
                2
                + 625).
              


18-31
                Compute the 1-Ω energy carried by the signal
                f
                (
                t
                ) = 9
                e

                  4.5
                  t

u
                (-
                t
                ).
              

18-32
                Find the 1-Ω energy carried by the signal
                


Then, find the percentage of the 1-Ω energy carried in the frequency band |ω| ≤ α.




18-33
                The impulse response of a filter is
                h
                (
                t
                ) = 3
                e

                  -200
                  t

u
                (
                t
                ). Find the 1-Ω energy in the output signal when the input is
                x
                (
                t
                ) = 4
                e

                  -20
                  t

u
                (
                t
                ). Verify your result using MATLAB.
              

18-34
                The impulse response of a filter is
                h
                (
                t
                ) = 50
                e

                  -20
                  t

u
                (
                t
                ). Find the 1-Ω energy in the output signal when the input is
                x
                (
                t
                ) =
                u
                (
                t
                ).
              


18-35
                The current in a 50-kΩ resistor is
                i
                (
                t
                ) = -5
                u
                (
                t
                + 1) + 10
                u
                (
                t
                ) − 5
                u
                (
                t
                - 1) A. Find the total energy delivered to the resistor.
              


18-36
                The transfer function of an ideal bandpass filter is (ω) = 1 for 1800 ≤ ω ≤ 2200 rad/s. Use MATLAB to find the 1-Ω energy carried by the output signal when the input is
                x
                (
                t
                ) = 10
                e

                  -2000
                  t

u
                (
                t
                ). What percentage of the input signal energy appears in the output?
              



Integrating Problems



18-37

                Fourier Series and Fourier Transforms
                
                  Given a rectangular pulse as shown in
                  Figure 13-4
                  , with amplitude A, width
                  T
                  , and period
                  T
0
                  , we can compute and plot the coefficients in the corresponding Fourier series. If we allow
                  T
0
                  to increase to infinity, the waveform is a single pulse and the Fourier series approaches a scaled version of the Fourier transform. To see this graphically, use MATLAB to create the following series of plots. Let
                  A
                  = 5,
                  T
                  = 1, and
                  T
0
                  = 2. Compute the Fourier series coefficients for
                  n
                  = 0, 1, 2, ... 10
                  T
0
                  . Create a stem plot of (
                  a

n

                  ×
                  T
0
                  ) on the vertical axis versus the (
                  n
                  /
                  T
0
                  ) on the horizontal axis. Increment
                  T
0
                  by one and repeat the stem plot. Create plots up until
                  T
0
                  = 20 and comment on the behavior of the results. Now compute the Fourier transform of
                  f
                  (
                  t
                  ) =
                  A
                  [
                  u
                  (
                  t
                  +
                  T
                  /2) -
                  u
                  (
                  t
                  -
                  T
                  /2)]. Evaluate
                  F
                  (ω) for ω = 0 to 20π rad/s. On the same axes as your final stem plot, plot 2
                  F
                  (ω) versus ω/2π. Comment on the results.
                


18-38

                Impulse Generator
                Theoretically, an impulse has an amplitude spectrum that is constant at all frequencies. In practice, a constant spectrum across an infinite bandwidth cannot be achieved, nor is it really necessary. What is required is an amplitude spectrum that is "essentially" constant over the frequency range of interest. Under this concept, an impulse generator is a signal source that produces a pulse waveform whose amplitude spectrum does not vary more than a prescribed amount over a specified frequency range.
Consider a rectangular pulse:




                  Find
                  F
                  (ω) and sketch its amplitude spectrum |
                  F
                  (ω)|. Select the pulse duration
                  T
                  such that the amplitude spectrum does not change by more than 10% over a frequency range from 1 MHz to 10 MHz.
                



18-39

                Comparative Spectral Response
                
Figure P18-39
                  shows two similar unit pulse waveforms. The only difference is that the first pulse is positive from -
                  T
                  /2 to
                  T
                  /2, while the second pulse goes from +A to -A at
                  t
                  = 0. Find the Fourier transforms of each signal and plot their respective frequency responses. Explain the null at ω = 0 in the second response.
                









FIGURE P18-39











Notes





1

                Recall from
                Chapter 9
                that unique Laplace transforms exist only for causal waveforms for which
                f
                (
                t
                ) =0 for
                t
                <0.
              


2

                The transform in this example involves a function usually denoted as sinc(
                x
                ) =sin
                x
                /
                x
                . At first glance, it may appear that this function blows up at
                x
                = 0. However, a single application of l'Hôpital 's rule shows that sinc(0) = 1.
              


















Appendix A

SOLUTION OF LINEAR EQUATIONS





          The purpose of this appendix is to review the methods of solving systems of linear algebraic equations that occur commonly in circuit analysis. Substitution is generally the preferred method for solving two equations with two unknowns, while Cramer's rule offers an easy method for solving three-by-three equations with literal or numeric coefficients by hand. Handheld calculators can solve 2 x 2, 3 x 3, or even higher-order equations if the coefficients are numeric. Systems of equations greater than 3x3, especially with literal coefficients, are generally best solved using software tools such as MATLAB. We will discuss how to solve 3x3 equations using Cramer's rule and we will review the matrix algebra approaches for solving more complex systems with software. Actual examples are contained throughout appropriate sections of the text.
          Appendix D
          contains examples on how to use MATLAB to solve linear equations. Circuit analysis often requires solving linear algebraic equations of the type
        



(A-1)





          where
          x
1
          ,
          x
2
          , and
          x
3
          are unknown voltages or currents. Often some of the unknowns may be missing from one or more of the equations. For example, the equations
        



involve three unknowns with one variable missing in each equation. Such equations can always be put in the standard square form by inserting the missing unknowns with a coefficient of zero.



(A-2)





Equations (A-1)
          and
          (A-2)
          will be used to illustrate the different methods of solving linear equations.
        

Cramer's Rule

Cramer's rule
            states that the solution of a system of linear equations for any unknown
            x

k

            is found as the ratio of two determinants
          



(A-3)





            where Δ and
            Δ

k

            are determinants derived from the given set of equations. A
            determinant
            is a square array of numbers or symbols called
            elements.
            The elements are arranged in horizontal rows and vertical columns and are bordered by two vertical straight lines. In general, a determinant contains
            n
2
            elements arranged
            
            in
            n
            rows and
            n
            columns. The value of the determinant is a function of the value and position of its
            n
2
            elements.
          

            The
            system determinant
            Δ in
            Eq. (A-3)
            is made up of the coefficients of the unknowns in the given system of equations. For example, the system determinant for
            Eq. (A-1)
            is
          




            and for
            Eq. (A-2)
            is
          



These two equations are examples of the general 3 x 3 determinant



(A-4)





            where
            
              a
              ij

            is the element in the
            i
            th row and
            j
            th column.
          

            The determinant Δ
            
k

            in
            Eq. (A-3)
            is derived from the system determinant by replacing the
            k
            th column by the numbers on the right side of the system of equations. For example, Δ
            1
            for
            Eq. (A-1)
            is
          




            and Δ
            3
            for
            Eq. (A-2)
            is
          



These examples are 3 x 3 determinants because the system determinants from which they are derived are 3 x 3.
In summary, using Cramer's rule to solve linear equations boils down to evaluating the determinants formed using the coefficients of the unknowns and the right side of the system of equations.


Evaluating Determinants

            The
            diagonal rule
            gives the value of a 2 x 2 determinant as the difference in the product of the elements on the main diagonal (
            a
11
a
22
            ) and the product of the elements on the off diagonal (
            a
21
a
12
            ). That is, for a 2 x 2 determinant
          


(A-5)




            The value of 3 x 3 and higher-order determinants can be found using the method of minors. Every element
            
              a
              ij

            has a
            minor

              M
              ij
              ,
            
            which is formed by deleting the row and column containing
            
              a
              ij
              .
            
            For example, the minor
            M
21
            of the general 3 x 3 determinant in
            Eq. (A-4)
            is
          




            The
            cofactor

              C
              ij

            of the element
            
              a
              ij

            is its minor
            
              M
              ij

            multiplied by (−1)
            
i
              +
              j

            .
          





            The signs of the cofactors alternate along any row or column. The appropriate sign for cofactor
            Cij
            is found by starting in position
            a
11
            and counting plus, minus, plus, minus... along any combination of rows or columns leading to the position
            
              a
              ij
              .
            


            To use the
            method of minors
            we select one (and only one) row or column. The determinant is the sum of the products of the elements in the selected row or column and their cofactors. For example, selecting the first column in
            Eq. (A-4)
            , we obtain A as follows:
          



An identical expression for Δ is obtained using any other row or column. For determinants greater than 3 x 3 the minors themselves can be evaluated using this approach. However, a system of equations leading to determinants larger than 3 x 3 is probably better handled using computer tools.










EXAMPLE A-1

                    Solve for the three unknowns in
                    Eq. (A-1)
                    using Cramer's rule.
                  







SOLUTION:


Expanding the system determinant about the first column yields




                Expanding Δ
                1
                about the first column yields
              




                Expanding Δ
                2
                about the first column yields
              




                Expanding Δ
                3
                about the first column yields
              





                Now, applying Cramer's rule, we solve for the three unknowns.
              



■











Exercise A-1

                Evaluate Δ, Δ
                1
                , Δ
                2
                , and Δ
                3
                for
                Eq. (A-2)
                .
              


Answer:


216; 280; 160; 60





Matrices and Linear Equations

          Circuit equations can be formulated and solved in matrix format. By definition, a
          matrix
          is a rectangular array written as
        



(A-6)





          The matrix
          A
          in
          Eq. (A-6)
          contains
          m
          rows and
          n
          columns and is said to be of order
          m by n
          (or
          m
          x n). The matrix notation in
          Eq. (A-6)
          can be abbreviated as follows:
        


(A-7)




          where
          
            a
            ij

          is the element in the
          i
          th row and
          j
          th column.
        


Some Definitions

          Different types of matrices have special names. A
          row matrix
          has only one row
          (m = 1)
          and any number of columns. A
          column matrix
          has only one column
          (n
          = 1) and any number of rows. A
          square matrix
          has the same number of rows as columns (
          m
          =
          n
          ) .A
          diagonal matrix
          is a square matrix in which all elements not on the main diagonal are zero
          
            (a
            
ij


          = 0 for
          i ≠ j
          . An
          identity matrix
          called
          U
          is a diagonal matrix for which the main diagonal elements are all unity
          
            (a
            ii

          = 1).
        
For example, given




          we say that
          A
          is a 1 x 4 row matrix,
          B
          is a 4 x 1 column matrix,
          C
          is a 3 x 3 square matrix, and
          U
          is a 4 x 4 identity matrix.
        

          The
          determinant
          of a square matrix
          A
          (denoted det
          A)
          has the same elements as the matrix itself. For example, given
        





          The
          transpose
          of a matrix
          A
          (denoted
          A

T

          ) is formed by interchanging the rows and columns. For example, given
        




          The
          adjoint
          of a square matrix
          A
          (denoted adj
          A
          ) is formed by replacing each element
          
            a
            ij

          by its cofactor
          
            C
            ij

          and then transposing.
        


(A-8)



For example, if



and therefore





Matrix Algebra

          The matrices
          A
          and
          B
          are equal if and only if they have the same number of rows and columns, and
          
            a
            ij

          =
          
            b
            ij

          for all
          i
          and
          j
          . Matrix addition is possible only when two matrices have the same number of rows and columns. When two matrices are of the same order, their sum is obtained by adding the corresponding elements; that is,
        


(A-9)



For example, given




          Multiplying a matrix
          A
          by a scalar constant
          k
          is accomplished by multiplying every element by
          k
          ; that is,
          k
A
          = [
          
            ka
            ij

          ]. In particular, if
          k
          = -1 then −
          B
          = [−
          
            b
            ij

          ], and applying the matrix addition rule yields matrix
          subtraction.



(A-10)




Multiplication
          of two matrices
          AB
          is defined only if the number of columns in
          A
          equals the number of rows in
          B.
          In general, if
          A
          is of order
          m
          x
          n
          and
          B
          is of order
          n
          x
          r
          , then the product
          C
          =
          AB
          is a matrix of order 
          m 
          x 
          r  
          . The element   
            
            c   
            ij

          is found by summing the products of the elements in the 
          i 
          th row of 
          A   
          and the 
          j   
          th column of  
          B.



(A-11)



In other words, matrix multiplication is a row-by-column operation.


          Matrix multiplication is not commutative, so usually    
          AB ≠ BA.
          Two important exceptions are (1) the product of a square matrix    
          A  
          and an identity matrix   
          U 
          where the identity matrix is a square matrix with "1''s on the main diagonal and "0''s elsewhere, for which
          UA   
          =   
          AU   
          =  
          A,
          and (2) the product of a square matrix
          A
          and its
          inverse
          (denoted
          
            A
            −

1
          ) for which
          
            A
            −
1
            A
          
          =
          
            AA
            −

1
          =
          U.
          A closed-form formula for the inverse of a square matrix is
        



(A-12)





          That is, the inverse can be found by multiplying the adjoint matrix of
          A
          by the scalar 1/det
          A.
          If det
          A
          = 0, then
          A
          is said to be
          singular
          and
          
            A
            -

1
          does not exist.
          Equation (A-12)
          is useful for deriving properties of the inverse of a matrix. It is not, however, a very efficient way to calculate the inverse of a matrix of order greater than 3 x 3.
        





Exercise A-2
Given:




              Calculate
              AB, BA, A
-1
              , and
              B
-1
              .
            
Answers:







Matrix Solution of Linear Equations

          The three linear equations in
          Eq. (A-1)
          are
        



These equations are expressed in matrix form as follows:



(A-13)





          The left side of
          Eq. (A-13)
          is the product of a 3 x 3 square matrix and a 3 x 1 column matrix of unknowns. The elements in the square matrix are the coefficients of the unknown in the given equations. The matrix product on the left side in
          Eq. (A-13)
          produces a 3 x 1 matrix, which equals the 3 x 1 column matrix on the right side. The elements of the 3 x 1 on the right side are the constants on the right sides of the given equations.
        

          In symbolic form, we write the matrix equation in
          Eq. (A-13)
          as
        



(A-14)






          where
        




          Left multiplying
          Eq. (A-14)
          by
          A
1
          yields
        




          But by definition
          
            A
            -
1
            A
          
          =
          U
          and
          UX
          =
          X;
          therefore
        



(A-15)





          To solve linear equations by matrix methods, we calculate the product
          
            A
            -
1
            B.
          


          To implement the matrix approach, we must first find
          
            A
            -1

          using
          Eq. (A-12)
          . The determinant of the coefficient matrix is
        



The cofactors of the first row of the coefficient matrix are



The cofactors for the second and third rows are




          Now, using
          Eq. (A-12)
          , we obtain
          
            A
            -

1
          as
        




          Using
          Eq. (A-15)
          , we solve for the column matrix of unknowns as
        




          which yields
          
            x
            1

          = 2,
          
            x
            2

          = 24/50, and
          
            x
            3

          = 84/50. These are, of course, the same results previously obtained using Cramer's rule.
        















Appendix B

BUTTERWORTH AND CHEBYSHEV POLES




Transfer functions of low-pass filters have the form



(B-1)





          where
          q

n

          (
          s
          ) is an
          n
          th-order polynomial whose roots define the poles of
          T
          (
          s
          ). The gain response of the filter is found by setting
          s
          =
          j
          ω and forming the magnitude |
          T
          (
          j
          ω)|. The purpose of this appendix is to illustrate how the poles of
          T
          (
          s
          ) are determined for Butterworth and Chebyshev gain responses.
        

          Finding the poles of
          T
          (
          s
          ) involves finding the poles of the squared gain response |
          T
          (
          j
          ω)|
          2
          . The function
          T
          (−
          j
          ω) is the conjugate of
          T
          (
          j
          ω). The product of any function and its conjugate is the square of its magnitude, in this case |
          T
          (
          j
          ω)|
          2
          . Since
          T
          (
          j
          ω) is found by setting
          s
          =
          j
          ω, we can write
        


(B -2)




          Combining
          Eqs. (B-1)
          and
          (B-2)
          , we obtain
        



(B -3)





          The denominator of
          Eq. (B-3)
          indicates that the poles of |
          T
          (
          j
          ω)|
          2
          are either the roots of the polynomial
          q

n

          (
          s
          ) or
          q

n

          (-
          s
          ). The roots of
          q

n

          (
          s
          ) must all lie in the left half plane for
          T
          (
          s
          ) in
          Eq. (B-1)
          to be the transfer function of a stable circuit. If
          s
          = α +
          j
          β is any root of
          q

n

          (-
          s
          ), then the real part α must be negative. The corresponding root of
          q

n

          (−
          s
          ) is
          s
          = −α −
          j
          β, whose real part −α must be positive. In other words, the roots of
          q

n

          (−
          s
          ) all lie in the right half plane. Thus, we can find the poles of
          T
          (
          s
          ) by finding the left half plane poles |
          T
          (
          j
          ω)|
          2
          .
        

          The square of the normalized (ω
          C
          = 1) Butterworth gain response in
          Eq. (14-30)
          is
        



(B -4)





          The
          s
          -plane poles of |
          T
          (
          j
          ω)|
          2
          occur when the denominator of
          Eq. (B-4)
          is zero. The gain response involves setting
          s
          =
          j
          ω. Solving for ω gives ω =
          s/j,
          which means the poles of |
          T
          (
          j
          ω)|
          2
          occur when 1 + (
          s/j
          )
          
2n

          = 0. Combining this result with the denominator of
          Eq. (B-3)
          gives us
        



(B -5)





          Thus, the poles of a normalized (ω
          C
          ) = 1 Butterworth low-pass filter are the left half plane roots of
          Eq. (B-5)
          .
        

          In what follows, we find the left half plane roots of this equation for consecutive values of the integer
          n.
          We do not describe the root-finding process itself since the
          
          widespread availability of math solvers like Mathcad or MATLAB makes polynomial root finding a routine computation.
        

          When
          n
          = 1,
          Eq. (B-5)
          yields the polynomial 1 + (
          s/j
          )
          2
          = 1 −
          s
2
          = 0, whose left half plane root is
          s
          = -1. When
          n
          = 1, the poles of
          T
          (
          s
          ) are defined by
        




          For
          n
          = 2,
          Eq. (B-5)
          yields the polynomial 1 + (
          s/j
          )
          4
          = 1 +
          s
4
          = 0, whose left half plane roots are
          s
          = -0.707 ±
          j
          0.707. When
          n
          = 2, the poles of
          T
          (
          s
          ) are defined by
        




          For
          n
          = 3, we get 1 + (
          s/j
          )
          6
          = 1 -
          s
6
          = 0, whose left half plane roots are
          s
          = -1 and
          s
          = -0.5 ±
          j
          0.866, and the poles of
          T
          (
          s
          ) are defined by
        




          For
          n
          = 4, we get 1 + (
          s/j
          )
          8
          = 1 +
          s
8
          = 0, whose left half plane roots are
          s
          = -0.9239 ±
          j
          0.3827 and
          s
          = -0.3827 ±
          j
          0.9239. In this case, the poles of
          T
          (
          s
          ) are defined by
        




          These calculations illustrate a procedure for finding the poles of a normalized low-pass transfer function with Butterworth gain characteristics for any value of
          n
          . In general, when
          n
          is odd, there is one real pole and
          n
          - 1 pairs of complex conjugate poles. When
          n
          is even, the poles are all complex conjugates. The polynomials
          q
1
          (
          s
          ),
          q
2
          (
          s
          ),
          q
3
          (
          s
          ), and
          q
4
          (
          s
          ) derived above are the first four entries in
          Table 14-2
          . The entries for
          n
          = 5 and
          n
          = 6 are derived using the algorithm given above; that is, by finding the left half plane roots of
          Eq. (B-5)
          for
          n
          = 5 and
          n
          = 6.
        

          The derivation of the poles of a Chebyshev low-pass filter follows a process similar to the Butterworth method described above. We begin with the square of the normalized (ω
          C
          = 1) Chebyshev gain response in
          Eq. (14-33)
          .
        



(B-6)





          where
          C

n

          (ω) = cos[
          n
          cos
          -1
          (ω)] is an
          n
          th-order Chebyshev polynomial. When
          n
          = 0, we have
          C
0
          (ω) = cos[0] = 1, and for
          n
          = 1 we have
          C
1
          (ω) = cos[cos
          -1
          (ω)] = ω. Higher-order polynomials are obtained using the recursion relationship
          C

n

          (ω) = 2ω
          C

n
            -1
          
          (ω) -
          C

n
            -2
          
          (ω). Using these results, the next five Chebyshev polynomials are found to be
        



(B -7)





          As in the Butterworth procedure, our goal is to find the poles of |
          T
          (
          j
          ω)|
          2
          . According to
          Eq. (B-6)
          , these poles occur when 1 +
          
          (ω) = 0. As previously noted, the gain response involves setting
          s
          =
          j
          ω. Solving for ω gives ω =
          s/j,
          which means these
          s
          -plane
          
          poles occur when 1 +
          
          . Combining this result with the denominator of
          Eq. (B-3)
          produces
        



(B -8)





          Thus, the poles of a normalized (ω
          C
          = 1) Chebyshev low-pass filter are the left half plane roots of
          Eq. (B-8)
          . We now show how to find these roots for successive values of the integer
          n.


          For
          n
          - 1, we insert
          C
1
          (ω) = ω into
          Eq. (B-8)
          to get the polynomial
        




          whose left half plane root is
          s
          = -1. When
          n
          = 1, the poles of
          T
          (
          s
          ) are defined by
        




          For
          n
          = 2, we insert
          C
2
          (ω) from
          Eq. (B-7)
          into
          Eq. (B-8)
          to get the polynomial
        




          whose left half plane roots are
          s
          = -0.3218 ±
          j
          0.7769. When
          n
          = 2, the poles of
          T
          (
          s
          ) are defined by
        




          For
          n
          = 3, we use
          C
3
          (ω) from
          Eq. (B-7)
          in
          Eq. (B-8)
          to produce the polynomial
        




          whose left half plane roots are
          s
          = -0.298 and
          s
          = -0.149 ±
          j
          0.9037. When
          n
          = 3, the poles of
          T
          (
          s
          ) are defined by
        




          For
          n
          = 4, we use
          C
4
          (ω) from
          Eq. (B-7)
          in
          Eq. (B-8)
          to get the polynomial
        



 
          whose left half plane roots are 
          s 
          = -0.2052 ±;  
          j   
          0.392 and  
          s   
          = -0.08501 ±   
          j
          0.9464. When 
          n 
          = 4, the poles of 
          T   
          ( 
          s   
          ) are defined by  
        



    
          These calculations illustrate a general procedure for finding the poles of a normalized low-pass transfer function with Chebyshev gain characteristics for any value of
          n   
          .The algorithm involves finding the left half plane roots of 
          Eq. (B-8)    
          using the appropriate 
              
            C
            n
  
          (ω) from   
          Eq. (B-7) 
          , or the recursion formula. When   
          n   
          is odd, there is one real pole and   
          n  
          - 1 complex conjugate poles. When
          n
          is even, the poles are all complex conjugates.
        

          The polynomials
          q
1
          (
          s
          ),
          q
2
          (
          s
          ),
          q
3
          (
          s
          ), and
          q
4
          (
          s
          ) derived above produce the same poles as the corresponding entries in
          Table 14-3
          but do not have the property
          q

n

          (0) = 1. To obtain this property, we factor out the constant term (coefficient of
          s
0
          ) from each of the first- and second-order factors in
          q

n

          (
          s
          ).
          
















Appendix C

BEHAVIORALLY MOTIVATED LEARNING





          Our text takes advantage of one of the most widely used ways of organizing levels of learning first devised by Benjamin Bloom in his
          Taxonomy of Educational Objectives

1

          . Bloom developed three separate taxonomies—The Psychomotor, the Cognitive, and the Affective. Each of these taxonomies is subdivided into levels of achievement in increasing order of complexity.
        

          While an engineering course might include aspects of all three, the most useful associated with learning is the
          Cognitive
          taxonomy or domain. In its original version
          
2

          , this taxonomy has six levels: Knowledge, Comprehension, Application, Analysis, Synthesis (Design), and Evaluation. The last two, Design and Evaluation, are often intertwined. We discuss the other two domains later.
        

Knowledge
          is associated with recall or recognition of terms or formulae. For example: "State Ohm's Law," or "Draw an inverting OP AMP amplifier." Answers are unique and are right or wrong.
        

Comprehension
          requires more than simply stating a theorem or equation but understanding the various parameters or components of the concept. For example: " Given a resistor connected to a constant voltage source, what happens to the current if the resistance is increased?" or "Given an inverting OP AMP with a source resistor
          R
S
          and a feedback resistor
          R
F
          , how does the magnitude of the gain change if
          R
S
          decreases?" Solutions are unique, that is, there is only one correct answer.
        

Application
          requires the application of specific concepts or theorems to a specific situation. For example: "Given three 1-kΩ, resistors in series with a 12-V source, how would one measure 8 V?" or "A 10-V source is connected to a non-inverting OP AMP with a ±
          V
CC
          of 15 V, what is the maximum gain that the OP AMP can produce?" or "Given the following circuit consisting of passive components and an ac voltage source, find the Thevenin equivalent circuit." Solutions are unique, that is, there is only one correct answer. Most problems in circuits courses are at this level.
        

Analysis
          requires one to understand and apply multiple concepts and to be able to separate a complex problem into constituent parts. For example, "Given a three-loop network driven by two sources, determine the contribution of each source on a particular element in the circuit." To solve the problem, it requires the understanding of the concepts of superposition and node- or mesh-analysis. As another example, " Given this cascaded OP AMP filter circuit, determine the output to a particular ac input, the nature of the filter, the
          B
          and
          Q
          of the circuit." To solve the problem, it requires the knowledge of OP AMP building blocks, the understanding of various filter types, and the definitions of
          B
          and
          Q.
          Solutions of Analysis problems are
          
          unique, that is, there is only one correct answer. Since these problems require some thought, they tend to make up the more challenging aspects of most circuits courses.
        

Synthesis
          or
          Design
          requires the ability to create a circuit given an input and a desired output. Unlike the preceding levels, there may be many, one, or no solutions to the problem. Solutions to these problems are creative in nature and are fundamental to engineering. For example: "Design a filter that will attenuate the third harmonic of a 100-kHz square wave by 80 dB and attenuate the other harmonics by less than 3 dB." The solution requires an understanding of notch filters, OP AMP realizations, and how bandwidth and
          Q
          are interrelated. Another synthesis example is to "Design an instrumentation system that will interface a Chromel-Alumel thermocouple over the temperatures from 100°C to 600°C with a 0 to 5 V A/D for processing. The thermocouple can be modeled by an ideal voltage source in series with a 300-Ω resistor." Successful designs will require understanding of active and passive interface instrumentation systems, OP AMP realizations, and loading issues. There are several correct solutions to each of these tasks.
        

Evaluation
          is the highest level of the Cognitive taxonomy since it requires judgment. Realizing that Design often produces several working solutions, Evaluation requires one to use judgment to select the best solution to meet a task. Determining the optimum or best solution requires knowing the conditions and constraints the design must meet. Minimum cost, lowest power required, easiest to manufacture, highest reliability, lowest weight, and most power delivered are some of the criteria that can be applied to help select the best design. Often the designer looks at the constraints and goes back to modify the design. Hence, Design and Evaluation frequently are intertwined. Examples include: "Given a set of specifications, two vendors have provided designs that they purport meet the specifications. Analyze their designs and determine the better design." Both designs need to be analyzed to insure both meet the specifications, then, based on the required constraints, the better one is selected. Or "A professor gave the following design task in a quiz. Three student designs are shown. Grade the designs." A correct working design should be created. Criteria that award a letter grade based on what a good design demonstrated needs to be developed, and then each student design is analyzed, and a grade awarded based on the developed criteria. Or "An off-the-shelf circuit is available to meet a design requirement. The manufacturer is willing to make one component change to the design for free if necessary. Will the design work as presented or can the change of one component cause the circuit to meet the specification. If so, what should be changed or should a totally different design be sought?" The provided circuit is analyzed and, if it does not meet the specifications, can one change of a component be found that will allow the circuit to work? If not, then reject the circuit.
        

          Using the above philosophy, the text is organized into "Chapter Learning Objectives." These objectives follow the taxonomy noted above. Each chapter lists a number of these objectives in a manner that their successful accomplishment can be tested. For example,
          Chapter 3
          on Circuit Analysis Techniques lists five Chapter Learning Objectives. The first objective states:
        

3-1

            General Circuit Analysis (
            Sects. 3-1
            and
            3-2
            )
          


Given a linear resistance circuit:



(a) (Formulation) Write node-voltage or mesh-current equations for the circuit.


(b) (Solution) Solve the equations from (a) for selected signal variables or input-output relationships using classical or software computational techniques.



          This objective contains two parts covered in two sections, 3-1 Node-Voltage Analysis and 3-2 Mesh-Current Analysis. Throughout the two sections, there are Examples and Exercises that help explain these two analysis techniques. The Examples
          
          work out in detail the formulation of node-voltage or mesh-current equations using hand and software techniques applied to different situations. Exercises provide students opportunities to test their understanding of these techniques by solving a problem similar to an example; however, only the answer is provided. If the student becomes stymied, Appendix E contains detailed solutions.
        
At the end of the chapter in the Problems section, the same chapter Learning Objective is repeated. In addition, there are references to Examples and Exercises to which the student can refer if a review is necessary. Again, for Objective 3-1 under Problems:



              OBJECTIVE 3-1 GENERAL CIRCUIT ANALYSIS (
              SECTS. 3-1
              AND
              3-2

            )
          


Given a circuit:



(a) (Formulation) Write node-voltage or mesh-current equations for the circuit.


(b) (Solution) Solve the equations from (a) for selected signal variables or input-output relationships using classical or software computational techniques.







                  Node-voltage method: See
                  Examples 3-1
                  to
                  3-7
                  and
                  Exercises 3-2
                  to
                  3-13
                  .
                







                  Mesh-current method: See
                  Examples 3-8
                  to
                  3-10
                  and
                  Exercises 3-14
                  to
                  3-20
                  .
                





          Following the objective, a number of problems, 21 in this case, generally in increasing level of difficulty—moving up the taxonomy—are presented. Mastery of these problems shows mastery of the objective. Most of the problems listed under each objective are from the Applications level; however, a few comprehension, a few Analysis, and a few Design and Evaluation problems are sometimes included as appropriate for the objective. Some of the problems indicated by an
          
          have answers in "Answers to Selected Problems" that the students can use to check their work.
        
At the end of each problem set are several Integrating Problems. These are more challenging problems that often require understanding of concepts across many objectives from the chapter or from several chapters.

          The
          Psychomotor
          domain describes the ability to use tools or instruments. Most circuit courses have an associated laboratory requirement. Laboratories require additional skills that can require aspects of this domain. These expectations can require students to construct circuits on protoboards or printed circuits; manipulate measuring instruments such as DMMs, oscilloscopes, and spectrum analyzers; or perform simulations on computers using I/O devices such as a mouse or touch screen. Laboratories and the use of modern software are a major accreditation requirement. ABET requirement 5(b) states
          "The curriculum must include:



(b) a minimum of 45 semester credit hours (or equivalent) of engineering topics appropriate to the program, consisting of engineering and computer sciences and engineering design, and utilizing modern engineering tools."



          The
          Affective
          domain describes the way students react emotionally towards things or associate value to knowledge they have acquired. A goal of many courses is to motivate students to not only successfully meet the requirements of the course but also to leave a positive impression on the subject. Engineering students often choose the discipline because they want to create solutions to problems. Including design and evaluation problems in a course can serve as motivators to show students that they can create and evaluate solutions. Such motivators affect how students feel towards a particular course and their major. courses could also include ethical considerations on the topics studied, such as moral, safety, social, and environmental issues that can affect the students' view of the subject.
        



Notes




1

              Bloom, B. S., Englehart, M. D., Fürst, E. J., Hill, W. H., & Krathwohl, D. R. (1956).
              The Taxonomy of Educational Objectives, Handbook I: The Cognitive Domain.
              New York: David McKay Co., Inc.
            


2

              A 2001 revision to the taxonomy renamed the levels as Remember, Understand, Apply, Analyze, Evalüate, and Create. We will retain the original nomenclatüre.
            
















Appendix D

COMPUTATIONAL TOOLS




Computer-Aided Circuit Analysis

          In this text, we use three types of computer programs to illustrate computer-aided circuit analysis: spreadsheets, math solvers, and circuit simulators. Practicing engineers routinely use these tools to analyze and design circuits, so it is important to learn how to use them effectively. The purpose of having computer examples in this book is to help you develop an analysis style that includes the intelligent and essential use of computer tools. As you develop your style, always keep in mind that computer tools are not problem solvers.
          
You

          are the problem solver. Computer tools can be very useful, even essential once you have defined the problem. However, they do not substitute for an understanding of the fundamentals needed to formulate the problem, identify a practical approach, and interpret analysis results. This appendix is to be used as a vehicle for applying these software tools to solving circuit analysis and design problems.
        
There are worked examples throughout the text that use computer tools. The spreadsheet examples use Microsoft Excel, part of Microsoft Office. The math-solver examples use MATLAB Release 2021a by The MathWorks, Inc. The circuit simulation examples use National Instruments Multisim Education Edition 14.2.0.
Our objective is to illustrate the effective use of computer tools rather than develop your ability to operate these specific software programs. Although this book and indeed this appendix provide specific examples as helpful starting points, they do not emphasize the details of how to operate any of these software tools. We assume that you learned how to operate computer tools in previous courses or have enough familiarity with your computer's operating system to learn how to do so using online tutorials or any of a number of commercially available manuals.
This appendix is organized by chapter. That is, relevant problems in each chapter are solved using the appropriate software —occasionally using two different programs. For the most part, the problems are similar to, but not the same as, specific homework problems. This appendix is not designed to be exhaustive, nor a tutorial, however, we believe it will be helpful in understanding circuit behavior and in learning the art of circuit design and evaluation.

          Comments to assist the novice in using MATLAB are inserted in
          
italicized red

          by the code where the comment would be most helpful. Similarly, for Multisim, we used
          
violet.






          Chapter 1
        
Problems in this introductory chapter are easily solvable by hand and a calculator; however, here are a few examples that are solved using MATLAB. Since there are no real circuits in this chapter, there are no Multisim problems solved. For each MATLAB problem, the input code is shown followed by a horizontal line and then the output results.


1-1.

          A wire carries a constant current of 300 μA. How many coulombs flow past a given point in the wire in 2 s?
        


SOLUTION:



          
            format
            short eng
            
              This tells MATLAB to limit numbers to four
            
            coulomb_per_second = 300e-6;
            
              decimal places and use engineering notation.
            
            sec = 2;
coulomb = coulomb_per_second*sec
__________________________________________________________________________________
coulomb =
 600.0000e-006
          
        


Answer:



q
          (
          t
          ) = 600 μC.
        


1-2.

          The net positive charge flowing through a device is
          q
          (
          t
          ) = 10 + 3
          t
          mC. Find the current through the device.
        


SOLUTION:






          
            syms
            t real
            
              
                This tells MATLAB that
                t
                is a real variable.
              
            
            qt = 10 + 3*t;
it = diff(qt,t)
__________________________________________________________________________________
it =
3
          
        


Answer:



i
          (
          t
          ) = 3 mA.
        


1-3.

          When illuminated, the
          i-v
          relationship for a photocell is
          i
          =
          
            e
            v

          - 10 A. For
          υ
          = - 2, 2, and 3 V, find the device power and state whether it is absorbing or delivering power.
        


SOLUTION:



          
            v = [-2 2 3];
iv = exp(v)-10;
p = v.*iv
pAbsorbs = p>0
__________________________________________________________________________________
p =
 19.7293  -5.2219  30.2566
pAbsorbs =
 1x3
            
              logical
            
            array
 1  0  1
          
        


Answers:



          For
          υ
          = -2 V,
          p
          = 19.73 W, absorbing
        

          For
          υ
          = 2 V,
          p
          = -5.22 W, delivering
        

          For
          υ
          = 3 V,
          p
          = 30.26 W, absorbing
        



1-4.

          The figure below shows an electric circuit with a voltage and a current variable assigned to each of the six devices. The device voltages and currents are observed to be
        




          Create a vector for the voltage values,
          υ
          =[15 5 10 - 10 20 20, and a vector for the current values,
          i
          = [-1 1 2 -1 -3 2]. Compute the corresponding vector for the power values,
          p,
          using element-by-element multiplication
          (.*)
          and then use the sum command to verify the power balance.
        


SOLUTION:



          
            v = [15 5 10 -10 20 20];
ia = [-1 1 2 -1 -3 2];
p = v.*ia
Absorbing = p>0
            
              MATLAB can evaluate logical expressions
            
            Balance = sum(p)
            
              and return one for True and zero for False.
            
            __________________________________________________________________________________
p =
 Columns 1 through 3
  -15.0000e+000   5.0000e+000   20.0000e+000
 Columns 4 through 6
   10.0000e+000  -60.0000e+000   40.0000e+000
Absorbing =
    1×6
            
              logical
            
            array
    0    1   1   1   0   1
Balance =
       0.0000e+000
          
        


Answers:





Device


p

                (W)
              
Absorbing or Delivering




1
-15
Delivering


2
5
Absorbing


3
20
Absorbing


4
10
Absorbing


5
-60
Delivering


6
40
Absorbing



Power balance is zero, so the values check.


1-5.

          MATLAB is extremely powerful when linear operations are formatted using vector or matrix notation. The colon operator
          (:)
          is a special MATLAB operator that allows many calculations to be simplified or expressed in a compact form. For example, we can quickly generate a vector of time values ranging from 0 to 1 s with increments of 0.1 s using the following command:
          t = 0:0.1:1.
          We can then substitute this vector into standard MATLAB functions, such as
          sin()
          or
          exp()
          , to generate the results of evaluating those functions for every value in the time vector:
          
v = 5*sin(2*pi*t)
          or
          i = 3*exp(-4*t).
          Create the time vector described above and evaluate
          v = 5*sin(2*pi*t)
          using that time vector. Find the maximum and minimum values for the vector
          v
          using the commands
          max(v)
          and
          min(v)
          , respectively. Repeat the problem with a time increment that is smaller by a factor of 10 and comment on the results.
        


SOLUTION:



          t = 0:0.1:1;
v = 5*sin(2*pi*t);
vMax = max(v)
vMin = min(v)
t2 = 0:0.01:1;
v2 = 5*sin(2*pi*t2);
v2Max = max(v2)
v2Min = min(v2)
__________________________________________________________________________________
vMax =
  4.7553
vMin =
  -4.7553
v2Max =
  5.0000
v2Min =
  -5.0000
        


Answers:



          For ∆
          t
          = 0.1,
          υ
MAX
          = 4.7553 V and
          υ
MIN
          = - 47553 V
        

          For ∆
          t
          = 0.1,
          υ
MAX
          = 5 V and
          υ
MIN
          = - 5 V
        
The smaller time step provides better resolution and allows us to sample the voltage signal at its true maximum and minimum.


Chapter 2
We introduce Multisim in this chapter although all of these circuit problems easily can be solved by hand and a calculator. We also showthatsystems oflinearequations play into the strength of MATLAB. We will show how to solve a few such problems using MATLAB.


Multisim

          In Multisim, one places circuits to be analyzed by drawing them on the Schematic Capture sheet. Schematic Capture is the first stage in developing your design. This is where you choose the components you want to use, place them on the workspace in the desired position and orientation, wire them together, and otherwise prepare your design. Once the circuit is drawn, you can then simulate it and then use one of numerous analyses. In different chapters, we will introduce you to different analyses. The analysis engine is a derivative of SPICE. SPICE, which stands for
          Simulation Program with Integrated Circuit Emphasis,
          was developed at the Electronics Research Laboratory at the University of California—Berkeley in 1973. It is in the public domain. The analyses all depend on the models used for the circuit elements. In our text we assume linear models, but in practice devices are all but linear. The better the models are in mimicking the actual device they represent, the more
          
          accurate the analyses and their results. In selecting the appropriate analysis to run, you have to specify certain desired outputs such as voltage, current, or power. Once that is done, you tell the program to perform the analysis. In Multisim, the output is displayed in a new window called Grapher View. The following is a simple example.
        


2-1.

          Use Multisim to find all of the voltages and currents for the circuit on the right.
        


SOLUTION:


The main steps required to solve this problem using Multisim are as follows:




Create the circuit schematic using Schematic Capture.
Select the appropriate simulation and determine the desired outputs.
Simulate the circuit to see the results in Grapher View.




Create the circuit schematic by placing the appropriate parts (resistors, a dc voltage source, and a ground) onto the workspace using "Place, Component." The DC power source is found under the "Sources—POWER_ SOURCES" as is "GROUND." Note that a ground is necessary for any simulations to run. Resistors are found under the Group "basic." Select any value then adjust the values of the resistors and the voltage source to match the problem statement. This is done by clicking on the component values and opening the Properties window. Orient the devices by right-clicking on the device and choosing "Rotate 90° CW or CCW," at this point it does not matter since resistors are bilateral devices. Connect the parts by starting at the end of a device and holding down the left button on the mouse to draw the wire between the desired elements. The figure displays the resulting Multisim schematic capture drawing. Note that the Multi-sim construction of the layout of the circuit does not appear to match the example figure exactly, because Multisim does not allow for reasonable diagonal part placement. Although they look different, the two circuits have the same connections and are electrically equivalent. You can verify this fact by writing the device and connection equations for both of them.



Under the "Simulate" menu option, you can choose two options for analysis. You can choose the "Analysis and Simulation" tab and then "DC operating point." The DC operating point analysis will determine all of the dc voltages, currents, and powers associated with the circuit. Or you can add appropriate instruments to view the results. For this example, we will choose the former. Select "DC operating point analysis." The following window will open.





          We want all of the voltages and currents, so we selected each and clicked on "Add" to move them from the "Variables in the circuit" column to the "Selected variables for analysis" column. At this point, we are ready to perform the simulation, hence. Select the green triangle on the bottom labeled "Run." Grapher View opens in a new window and lists the results as shown.
        



Alternately, we can add DMMs at the appropriate nodes to determine the desired responses. Under "Simulate," select "Instruments" and then DMM. Place the meters in the circuit as you would in a laboratory. Note that measuring current requires inserting the ammeter in the circuit's path. Once you place the meters, click on each one and select V for a voltmeter and A for an ammeter. After each click, a Multimeter display opens. After you place each of the displays, click on the green triangle (the run button) on the function bar at the top of the panel. The simulation will run and the voltages and currents will be displayed on the appropriate meters. Stop the simulation by clicking on the red square to the right of the run triangle. See the figure. Even for this simple example, it seems impractical to use this approach with so many instruments, although it may be useful for simulations with fewer parameters.
Interpreting the results from the simulation, we have




MATLAB


          The name MATLAB is a contraction of the words "matrix" and "laboratory," because the software was originally designed to manipulate matrices and solve problems that can be cast in terms of matrices and linear algebra. The circuit analysis problems presented in this chapter can be formulated in terms of matrix equations and MATLAB can solve these types of problems very efficiently. If the order (size) of the problem is small, such that there are only a few unknown parameters, then manual calculations are usually sufficient and using MATLAB is probably unnecessary. As the order of the problem grows, increasing the number of unknown parameters, MATLAB offers distinct advantages for accurately computing solutions.
          Appendix A
          offers a simple review of matrix operations.
        
Use MATLAB to find all of the voltages and currents for the circuit in Web Example 2-1 above.


SOLUTION:


The equations describing the element and connection constraints are repeated here for convenience:




          Define a vector of parameter values,
          x
          =[
          υ
1
υ
2
υ
3
υ
A
i
1
i
2
i
3
i
A
          ]
          T
          , where the "T" superscript is the transpose, making
          x
          an [8 × 1] column vector. Rewrite the equations so that they easily can be expressed in matrix form. The extended spacing in the equations below is intentional.
        





          We can now write these equations using standard matrix notation, as
          A x
          =
          b,
          where
          A
          is an [8 x 8] matrix and
          b
          is an [8 × 1] vector.
        



We can enter this information into MATLAB as follows:

          
            A = [1 0 0 0 -100 0 0 0;
            
              Note that there is a single space between entries on a
            
            0 1 0 0 0 -200 0 0;
            
              row followed by a semicolon (;) to indicate the end of
            
            0 0 1 0 0 0 -300 0;
            
              a row.
            
            0 0 0 1 0 0 0 0;
    0 0 0 0 -1 0 -1 -1;
    0 0 0 0 1 -1 0 0;
    0 0 1 -1 0 0 0 0;
    1 1 -1 0 0 0 0 0];
b = [0; 0; 0; 3 0; 0; 0; 0; 0];
          
        
We can now solve these eight equations for the eight variables with the single MATLAB command:

          x = A\b
        
The results are

          x =
  10.0000
  20.0000
  30.0000
  30.0000
   0.1000
   0.1000
   0.1000
  -0.2000
        


          With MATLAB, we were able to simultaneously solve for all of the unknown variables:
        



The answers for the three numbered voltages agree with the solutions solved using Multisim.
In addition to efficiently manipulating matrix equations, MATLAB allows for user-defined functions to expand upon its built-in functions and to simplify repetitive computations.


2-2.

          Create a MATLAB function to compute the equivalent resistance of a set of resistors connected in series. The function has a single input, which is a vector containing the values of all of the resistors in series, and it has a single output, which is the equivalent resistance. Name the function "rseries."
        


SOLUTION:


Create the following MATLAB code and save it in a file named rseries.m:

          
            function
            Req = rseries(Rin)
            % Compute the equivalent resistance of a set of resistors
            % connected in series.
            Req = sum(Rin);
set(0,
            'RecursionLimit'
            ,10)
          
        
To test the code, enter the following commands:

          Rin = [10 20 40 100];
Req = rseries(Rin)
        
The result should be: Req = 170

Comparison of Computer-Aided Techniques


          We applied two computer-based tools to solve the same circuit analysis problem in Example 2-1. Both tools efficiently arrived at a complete and correct solution and may offer some advantages over the manual approaches presented in the remainder of the chapter. As you explore these tools, you will develop the experience and judgment to know when each tool is appropriate to assist in solving a problem. The circuit simulation tools allow for visual representations of the circuits and efficiently compute numerical solutions when all of the parameter values are known. A math solver quickly manipulates a set of equations to find a solution, but you must relate the numerical results back to the original schematic to get a full representation of the answer. Math-solver software can offer distinct advantages over circuit simulation software when the circuit contains parameter values expressed as variables. The circuit simulation software cannot directly handle this type of the problem, but the math-solver software accommodates it with only minor changes, as we will explore
          
          in
          Chapter 3
          . As we develop circuit analysis and design techniques throughout the text, we will continue to emphasize the advantages and disadvantages of the various computer-based tools so that you can expand your judgment, and efficiently apply the appropriate tools for each problem. No matter what technique one uses, good "engineering sense" must predominate. Results that just do not seem right should be challenged and verified. As you grow in knowledge and experience, you will be developing and enhancing this important engineering quality.
        

          Here are additional worked examples from
          Chapter 2
          .
        


2-3.

          The figure on the right shows a resistor with one terminal connected to ground and the other connected to an arrow. The arrow symbol is used to indicate a connection to one terminal of a voltage source whose other terminal is connected to ground. The label next to the arrow indicates the source voltage at the ungrounded terminal. Find the voltage across, current through, and power dissipated in the resistor.
        





SOLUTION:



          By hand: The voltage across the resistor is the voltage on the right side (-15 V) minus the voltage on the left side (0 V), so
          
υ
            x
          
          = -15-0 = -15 V. Using Ohm's law, the current is
          i
x
          =
          υ
x
          /
          R
x
          = -150 μA. The power
          p
x
          =
          υ
x
i
x
          = 2.25 mW.
        
By Multisim: See simulation on the right.
By MATLAB: Code below.

          
            clear
            all
            vx = -15-0
ix = vx/100e3
px = vx*ix
__________________________________________________________________________________
vx =
   -15.0000e+000
ix =
   -150.0000e-006
px =
      2.2500e-003
          
        





Answers:



υ
x  
          = -15 V,   
          i
x
          = -150 μA, and 
          p
x 
          = 2.25 mW.   
        


2-4.

          The    
          i-v  
          characteristic of a nonlinear resistor is    
          υ   
          = 82 
          i    
          + 0.18 
          i
3
          .    
        
   
          Calculate 
          υ   
          and   
          p   
          for  
          i
          = ±0.5, ±1, ±2, ±5, and ±10 A.
        


SOLUTION USING MATLAB:



          
            ii = [-10, -5, -2, -1, -0.5, 0.5, 1, 2, 5, 10];
v = 82*ii + 0.18*ii. ^3;
            
              Results = [ii' v' p']
              the apostrophe following the variable tells
            
            p = v.*ii;
            
              MATLAB to make a list of that variable. Note the single space separating
            
            Results = [ii' v' p']
            
              each variable.
            
            ________________________
Results =
   -10.0000e+000       -1.0000e+003      10.0000e+003
    -5.0000e+000     -432.5000e+000       2.1625e+003
    -2.0000e+000     -165.4400e+000     330.8800e+000
    -1.0000e+000      -82.1800e+000      82.1800e+000
  -500.0000e-003      -41.0225e+000      20.5113e+000
   500.0000e-003       41.0225e+000      20.5113e+000
     1.0000e+000       82.1800e+000      82.1800e+000
     2.0000e+000      165.4400e+000     330.8800e+000
     5.0000e+000      432.5000e+000       2.1625e+003
    10.0000e+000        1.0000e+003      10.0000e+003
          
        


          The first column is the current in amperes, the second the voltage in volts, and the third column is the power in watts.
        


2-5.

          The 1-kΩ load in the figure needs 5 V across it to operate correctly. Where should the wiper on the potentiometer be set (
          R
x
          ) to obtain the desired output voltage?
        


SOLUTION USING MATLAB:



          The potentiometer splits into two separate resistors
          R
x
          and 5k -
          R
x
          settings. Find an equivalent resistance for the parallel combination. Use voltage division to find an expression for the voltage across the parallel combination in terms of
          R
x
          . Solve for
          R
          x when the voltage across the parallel combination is 5 V.
        




          
            clear
            all
            syms
            Rx RL Req positive
            syms
            vL
            Eqn1 = Req - 1/(1/Rx+ 1/1e3);
Eqn2 = 5 - (Req*24/(Req + 5e3 - Rx));
Soln = solve(Eqn1,Eqn2,Req,Rx);
Rx = double(Soln.Rx)
            
              The
              double()
              function converts a symbolic
            
            Req_Check = 1/ (1/Rx + 1/1e3);
            
              expression into a numerical value.
            
            V_Check = Req_Check*24/(Req_Check + 5e3 - Rx)
__________________________________________________________________________________
Rx =
    2.3383e+003
V_Check =
    5.0000e+000
          
        


Answer:



R
x
          = 2.3383 kΩ.
        


2-6.

          Consider the circuit shown. Use MATLAB to find all of the voltages and currents in the circuit.
        





SOLUTION:


Use KVL, KCL, and Ohm's law to create a set of 14 equations to solve for all of the voltages and currents. Also, compute the power for each element. The unknown vector is


x
            = [
            υ
s
            ,
            υ
1
            ,
            υ
2
            ,
            υ
3
            ,
            υ
4
            ,
            υ
5
            ,
            υ
6
            ,
            i
S
            ,
            i
1
            ,
            i
2
            ,
            i
3
            ,
            i
4
            ,
            i
5
            ,
            i
6
            ]
          

The equations and solution are presented in the following MATLAB code.




          
            
              Comments in MATLAB are
            
            clear
            all
            
              shown by placing a percent sign
            
            format
            short eng
            
              (%)
              in front of the line. It turns
            
            % Set the matrix to be all zeros and then assign individual values
            
              the line green and it does not
            
            % directly
            
              affect the calculations.
            
            A = zeros(14,14);

A(1,1) =1;
A(2,2) = 1; A(2,9) = -15e3;
A(3,3) = 1; A(3,10) = -10e3;
A(4,4) = 1; A(4,11) = -33e3;
A(5,5) = 1; A(5,12) = -15e3;
A(6,6) = 1; A(6,13) = -68e3;
A(7,7) = 1; A(7,14) = -22e3;
A(8,8) = 1; A(8,9) = 1;
A(9,9) =1; A(9,10) =-1;A(9,11) =-1;
A(10,11) = 1; A(10,12) = -1; A(10,13) = -1;
A(11,13) = 1; A(11,14) = -1;
A(12,1) = -1; A(12,2) = 1; A(12,3) =1;
A(13,3) = -1; A(13,4) = 1; A(13,5) = 1;
A(14,5) = -1; A(14,6) = 1; A(14,7) =1;
            % Display the A matrix
            %A
            B = zeros(14,1); B(1) =12 0;
            % Display the B matrix
            %B
            % Solve for the output vector
            x = A\B;
Results = x';
            % Create vectors of the voltages and currents
            Voltages = x(1:7)
Currents = x(8:14)
__________________________________________________________________________________
Voltages =
120.0000e+000
 77.5537e+000
 42.4463e+000
 30.5455e+000
 11.9008e+000
  8.9917e+000
  2.9091e+000
Currents =
 -5.1702e-003
  5.1702e-003
  4.2446e-003
925.6198e-006
793.3884e-006
132.2314e-006
132.2314e-006
          
        
Repeat using Multisim to find all of the voltages and currents in the circuit.


SOLUTION:


The results of the Multisim simulation are shown.






Variable
Operating point value




I(R1)
0.00517025


I(R2)
0.00424463


I(R3)
0.00092562


I(R4)
0.000793388


I(R5)
0.000132231


I(R6)
0.000132231


V(1)
120


V(1)-V(2)
77.55372


V(2)
42.44628


V(2)-V(3)
30.54545


V(3)
11.90083


V(3)-V(4)
8.99174


V(4)
2.90909






Answers:


The results are the same as those found using MATLAB.


2-7.

          The current through
          R
L
          in the circuit shown is 100 mA. Use source transformations to find
          R
L
          . Validate your answer using Multisim.
        





SOLUTION:



          Perform a source transformation on the voltage source to get a 1-A current source in parallel with a 100-Ω resistor. Combine the resulting two 100-Ω resistors in parallel to get a 50-Ω resistor. Perform another source transformation to get a 50-V source in series with a 50-Ω resistor, which is also in series with the other 100-Ω resistor and
          R
L
          . The 50-V source produces 100 mA through the circuit, so the equivalent resistance is R
          
EQ

          = 500 Ω. The equivalent resistance is also the sum of the three resistors in series R
          
EQ

          = 50 + 100 +
          R
L
          , so we can solve for
          R
L
          = 350 Ω.
        
The Multisim simulation confirms the solution.






Variable
Operating Point Value




I(R4)
-0.1





In this case, Multisim validated your answer, it did not solve it for you. If you had erred in doing the source transformation, Mul-tisim would still agreed with your answer, but it would be wrong.







2-8.

          The circuit shown is a parallel combination of a 50-Ω linear resistor and a varistor whose
          i-v
          characteristic is
          i
V
          = 2.6 × 10
          -5
υ
3
          . For a small voltage, the varistor current is quite small compared to the resistor current. For large voltages, the varistor dominates because its current increases more rapidly with voltage. Use MATLAB to plot
          i-v
          characteristic of the parallel combination.
        


SOLUTION:



          The total current is
          i
          =
          i
R
          +
          i
V
          . The following MATLAB code plots the
          i-v
          characteristic.
        

          
            % Set the range of voltages to plot
            v = -200:1:200;
            % Compute the current through the
            % resistor
            iR = v/50;
            % Compute the current through the
            % varistor
            iV = 2.6e-5*v.^3;
            % Sum the two path currents to get
            % the total current
            iTotal = iR + iV;
            % Plot the i-v characteristic
            plot(v,iTotal,
            'b', 'LineWidth'
            ,3)
          
        


MATLAB plot (X, Y), in this case "v" vs ""iTotal." The ('b') is the color of the plot, b for blue. "Line-width" is how thick you want your curve to be, and "3" is the width. Thicknesses range from 1 to 20.



          
            xlabel(
            'Voltage (V)'
            )
            
              Once MATLAB provides a plot you can change
            
            ylabel(
            'Current (A)'
            )
            
              the color thickness, add axis labels, grid, etc.
            
            grid
            on
          
        
The corresponding MATLAB output plot is shown.




          Chapter 3
        
Node-voltage and mesh-current equations result in linear systems that easily can be solved using MATLAB. If the networks have numerical values, Multisim can be used to simulate the circuit and find the desired outputs. Furthermore, this chapter introduces several linearity concepts including superposition and Thevenin/Norton equivalent circuits. These essential theorems find use throughout circuit analysis. This chapter also begins the student's journey into the design and evaluation of circuits.


3-1.
            (a)
          
          Formulate node-voltage equations for the circuit below.
        

(b)
          Use MATLAB to find symbolic expressions for the node voltages in terms of the parameters in the circuit.
        

(c)
          Find numeric values for
          υ
A
          ,
          υ
B
          , and
          υ
C
          when
          R
1
          = 1.5 kΩ,
          R
2
          = 22 kΩ,
          R
3
          = 3.3 kΩ,
          R
4
          = 4.7 kΩ, and
          i

S
            1
          
          =
          i

S
            2
          
          = 2 mA.
        

(d)
          Use Multisim to verify your solution to part (c) is correct.
        


SOLUTION:


The following MATLAB code presents the solutions to parts (a), (b), and (c).




          
            clear
            all
            syms
            iS1 iS2 vA vB vC R1 R2 R3 R4 real
            NodeA = -iS1 + (vA-vC)/R4 + (vA-vB)/R1;
NodeB = (vB-vA)/R1+ (vB-0)/R2 - iS2;
NodeC = iS2 + (vC-0)/R3+ (vC-vA)/R4;
vABC = solve(NodeA,NodeB,NodeC,vA,vB,vC);
vA = simplify(vABC.vA)
vB = simplify(vABC.vB)
vC = simplify(vABC.vC)
vANum = subs(vA,(R1,R2,R3,R4,iS1,iS2},...
   {1500,2200,3300,4700,0.002,0.002})
vBNum = subs(vB,{R1,R2,R3,R4,iS1,iS2},...
   {1500,2200,3300,4700,0.002,0.002})
vCNum = subs(vC,{R1,R2,R3,R4,iS1,iS2},...
   {1500,2200,3300,4700,0.002,0.002})
__________________________________________________________________________________
vA =
(R1*R3*iS1 - R1*R3*iS2 + R1*R4*iS1 + R2*R3*iS1 + R2*R4*iS1 + R2*R4*iS2)/(R1 + R2 + R3 + R4)
vB =
(R2*(R1*iS2 + R3*iS1 + R4*iS1 + R4*iS2))/(R1 + R2 + R3 + R4)
vC =
(R3*(R1*iS1 - R1*iS2 + R2*iS1 - R4*iS2))/(R1 + R2 + R3 + R4)
vANum =
   3499/585
vBNum =
   3124/585
vCNum =
   -55/39
          
        


          (d)  Multisim simulation:
        






Variable
Operating Point Value




V(va)
5.9812


V(vb)
5.3402


V(vc)
-1.4102





Answers:



(a)
          The node-voltage equations are presented above in the MATLAB code.
        

(b)
          vA= (R2*iS1*R4+ R4*iS2*R2+ R3*R2*iS1+iS1*R4*R1+ R1*R3*iS1-R1*iS2*R3)/(R2+ R3+ R4+ R1)
        
vB = R2*(iS1*R4+ R4*iS2+ R1*iS2+ R3*iS1)/(R2+ R3+ R4+ R1)
vC = R3*(R1*iS1 + R2*iS1-R1*iS2-R4*iS2)/(R2+ R3+ R4+ R1)

(c)
υ
A
          = 5.9812 V,
          υ
B
          = 5.3402 V, and
          
            v
            C
            =
          
          -14103 V.
        

(d)
          The Multisim results are presented above and they verify the MATLAB results.
        





3-2.
            (a)
          
          Use MATLAB and mesh-current analysis to solve for the mesh currents
          i
A
          ,
          i
B
          ,
          
            i
            C
            ,
          
          and
          i
D
          in the figure.
        

(b)
          Solve for the same currents using node-voltage analysis and compare the effort required with each technique.
        

(c)
          Use Multisim to verify your results in the previous two parts.
        


SOLUTION:


The solutions to Parts (a) and (b) are presented in the following MATLAB code. Tell MATLAB to display results in engineering notation. Find Preferences under "Home," then "Command Window," then "Command Window Preferences," then "Text Display." Finally, "Numeric format." Select "short eng."

          
            syms
            iA iB iC iD vA vB
            % Solve the problem using mesh-current equations
            Eqn1 = 4e3*iA + 10e3*(iA-iB) + 10;
Eqn2 = 1e3*iB + 2e3*(iB-iC) + 10e3*(iB-iA);
Eqn3 = 2e3*(iC-iB) + 8e3*iC + 6e3*(iC-iD);
Eqn4 = -5 - 10 + 6e3*(iD-iC);
Soln = solve(Eqn1,Eqn2,Eqn3,Eqn4,iA,iB,iC,iD);
iA = double(Soln.iA);
iB = double(Soln.iB);
iC = double(Soln.iC);
iD = double(Soln.iD);
            % Solve the problem using node-voltage analysis
            EqnV1 = (vA-5)/4e3+ (vA-15)/10e3 + (vA-vB)/1e3;
EqnV2 = (vB-vA)/1e3 + (vB-15)/2e3 +vB/8e3;
SolnV = solve(EqnV1,EqnV2,vA,vB);
vA = double(SolnV.vA);
vB = double(SolnV.vB);
iA_v = (5-vA)/4e3;
iB_v = (vA-vB)/1e3;
iC_v = vB/8e3;
iD_v = 15/6e3 + iC;
Results = [iA iB iC iD; iA_v iB_v iC_v iD_v]'
__________________________________________________________________________________
Results =
  -1.2565e-003       -1.2565e-003
-759.1623e-006     -759.1623e-006
   1.3482e-003        1.3482e-003
   3.8482e-003        3.8482e-003
          
        


          (c)  The Multisim solution is presented below and it verifies the MATLAB results.
        






MESH CURRENTS
MULTISIM VARIABLE
OPERATING POINT VALUE





i
A

I(R1)
- 0.00125654



i
B

I(R2)
- 0.000759162



i
C

I(R6)
0.00134817



i
D

-I(Vl)
0.00384817





In Grapher View you can ask it to display the results' precision from 0 to 20 decimal places by clicking on the column you want to change and selecting the precision. Default is 5.




Answers:



(a)
i
A
          = -1.2565 mA,
        

i
B
          = -759.1623 μA,
        

i
C
          = 1.3482 mA,
        

          i
          D
          = 3.8482 mA
        

(b)
          The solution for the currents using node-voltage analysis matches the results in part (a), but requires only two equations, instead of the four equations used in mesh-current analysis.
        

(c)
          The Multisim results verify the answers through simulation.
        


3-3.

          Use the superposition principle to find
          i
O
          in the figure below. Verify your answer using Multisim.
        


SOLUTION:


The following MATLAB code presents the solution.




          
            clear
            all
            % Turn on the current source and turn off the voltage source
            % Combine the right two resistors in parallel and use current
            % division
            Req1=1/(1/100+1/100);
101 = 60e-3/Req1/(1/100 + 1/Req1);
            % Turn on the voltage source and turn off the current source
            % Perform a source transformation on the voltage source and use
            % current division
            is2 = 12/100;
102 = is2/100/(1/100+1/100+1/100);
            % Sum the components
            io = io1+io2
_________________________
io =
 80.0000e-003
          
        


          The following Multisim simulation verifies the solution.
        









              The various instruments, multimeters in this case, are found under "Simulate," then "Instruments." Note that the meter
              ;
              defaults to
            
            "V"
            voltage. Once you place the meter in the circuit, across for a voltage measurement, and in-line for a current measurement, a meter face opens as shown. Select
            "A"
            
              for current measurements. Then click the green triangle
              ►
              to start the simulation. Once the simulation starts, the green triangle changes to a red square.
              ■
              Clicking on the red square stops the simulation.
            


Adding the two currents gives 80 mA.


3-4.
            (a)
          
          Use Multisim to find the Norton equivalent at terminals A and B in the circuit below.
          Hint:
          Find the open-circuit voltage and short-circuit current at the requisite terminals.
        

(b)
          Use the Norton equivalent circuit found in (a) to determine the power dissipated in
          R
L
          when it is equal to 37 kΩ.
        

(c)
          Use Multisim to simulate both the original and the Norton
        

          equivalent circuits with
          R
L
          = 37 kΩ. Verify that the power dissipated by the load is the same in both situations.
        


Answers:



(a)
          The Multisim simulations are shown below. The Norton resistance is found by
          R
N
          =
          V
oc
          /
          I
SC
          = 36.9297 kΩ
        




(b)

          Using the Norton equivalent circuit, the following MATLAB code calculates the power dissipated by the load resistor.
        

          
            clear
            all
            iN = 221.6e-6;
RN = 36.9297e3;
RL = 37e3;
iL = iN/RL/(1/RL + 1/RN);
pL = iL^2*RL
__________________________________________________________________________________
pL =
    453.3722e-006
          
        

(c)
          The Multisim simulations for the original circuit and Norton equivalent circuit are shown below. The power dissipated by the load resistor matches the calculations in Part (b).
        





Answers:



(a)
R
N
          = 36.9297 kΩ;
          i
N
          = 221.572 μA;
        

(b)
p
L
          = 453.372 μW
        

(c)
          The Multisim simulations verify the Part (b) answer as shown above.
        





3-5.

          A diode is connected to an interface circuit as shown in the figure connecting a 18-V source to a diode load. The
          i-υ
          characteristic of the diode is
          i
          = 0.5 x 10
          −14
          (
          e
40υ
          - 1). To operate properly, the diode must have a voltage drop of 0.735 V. Use MATLAB to plot the Q-point showing the voltage across and the current through the diode and the required interface resistor,
          R
I
          .
        


Answer:


The following MATLAB code and resulting plot shows the answer.

          
            % Set the voltage source
            vs = 18;
            % Given the diode voltage, find the diode current
            vd =
            
            .735;
id = 0.5e-14*(exp(40*vd)-1)
            % Find the voltage drop across the interface
            v_inter = vs-vd
            % If the interface is a series resistor, find the value of the
            % resistance
            R_series = v_inter/id
            % Also validate the results graphically
            % Create a range of voltages to plot
            v = -0.5:0.0001:1;
            % Plot the i-v characteristic of the source
            vT = 18;
RT = R_series;
i_source = (vT-v)/RT;
            % Plot the i-v characteristic of the diode
            i_D = 0.5e-14*(exp(40*v)-1);
plot(v,i_source,'
            b','LineWidth'
            ,3)
            hold
            
              on
            
            
              "hold on"
              allows MATLAB to retain the
            
            grid
            
              on
            
            
              first plot so that a subsequent plot can be
            
            plot(v,i_D,
            'r','LineWidth'
            , 3)
            
              placed on the same figure.
            
            xlabel(
            'Voltage (V)'
            )
ylabel(
            'Current (A)'
            )
axis([0 1 -0.005 0.05])
__________________________________________________________________________________
id =
  29.3243e-003
v_inter =
  17.2650e+000
R_series =
  588.7607e+000
          
        

          From the graph:
          υ
D
          = 0.735 V and
          i
D
          = 29.32 mA. The series interface resistor is 588.8 Ω
        







          Chapter 4
        
This chapter is an introduction to linear active devices. First, we introduce dependent sources, then OP AMPS. Using MATLAB for dependent sources and OP AMPs is not too much different than in earlier chapters. In Multisim, we introduce both dependent source elements and the ideal OP AMP. Both of these new elements need an introduction. Note that Multisim has a whole library of real OP AMPs such as the uA741, but these are left for electronics courses. Although in this chapter we will deal only with the ideal OP AMP model, Multisim allows one to modify the idealness of their ideal OP AMP. We will discuss later when the need arises.





Before honoring the German engineer Ernst Siemens with the unit of
            Ω
            −1
or
            S,
            it was called a "mho" or ohm spelled backward. Curiously, Multisim retains the old designation.


Multisim provides four dependent source models. These are found in the Sources Library. They are in separate sublibraries named "CONTROLLED_VOLTAGE_ SOURCES" or "CONTROLLED_ CURRENT_SOURCES". These models are shown on the right and labeled (by us) to the more common names given such as voltage-controlled voltage source (VCVS). The individual gains can be easily altered by clicking on the gain label and entering the desired gain, for example, the VCVS has a 1000 gain entered.

          Multisim provides an ideal OP AMP model in the Analog Library under the "ANALOG_VIRTUAL" sublibrary. The most common model is the three-terminal model, namely OPAMP_3T_VIRTUAL. Although ideal, the Open loop gain, the Unity-gain bandwidth, the Input resistance, Output resistance, and ±
          V
CC
          can be easily altered by calling up the Property Editor. The default settings are shown on the left. A more ideal model is shown with the settings altered on the right. Note that many of our Examples, Exercises, and Problems use
          V
CC
          = ± 15 V, however, other values are possible and used in the text and
          V
CC
          = ± 15 V should not be taken for granted. Note especially that
          V
CC
          defaults to ± 12 V.
        





4-1.
            (a)
          
          Find the voltage gain
          u
O
          /u
          S
          and current gain
          i
O
          /
          i
x
          in the figure. Use MATLAB.
        

(b)
          Validate your answers by simulating the circuit in Multisim.
        





SOLUTION:



(a)
          The solution is presented in the following MATLAB code.
        

          
            clear
            all
            syms
            vs ix io vo
            % Find ix
            
            ix = vs/1.5e3;
            % Find io and vo
            io = -50*ix;
vo = io*2.2e3;
            % Find the gains
            Kv = simplify(vo/vs)
Ki = simplify(io/ix)
__________________________________________________________________________________
Kv =
-220/3
Ki =
-50
          
        






Variable
Operating Point Value




V(4)/V(1)
-73.33333


I(R3)/I(R1)
-50




(b)
          The Multisim simulation and results are shown. Note that we had Multisim to calculate
          K
V
          and
          K
I
          by adding the expressions shown to the Output in the DC Operating Point Analysis.
        


Answers:



(a)
K
V
          = -73.33 and
          K
I
          = -50.
        

(b)
          The Multisim simulation verifies the answer in part (a).
        


4-2.
            (a)
          
          Use MATLAB to find the voltage
          υ
O
          in the figure on the left.
        

(b)
          Validate your answer by simulating the circuit in Multisim.
        


SOLUTION:



(a)
          The solution is presented in the following MATLAB code.
        

          
            clear
            all
            syms
            vx vo
            % Use node-voltage analysis
            Eqnl= (vx-10)/2.2e3 +vx/1.5e3 + (vx-vo)/1e3 +1e-3*vx;
Eqn2 = -1e-3*vx + (vo-vx)/1e3 + vo/3.3e3;
            % Solve the equations for vo
            Soln = solve(Eqn1,Eqn2,vx,vo)
vo = double(Soln.vo)
__________________________________________________________________________________
vo =
   4.3980e+000
          
        




(b)
          The Multisim simulation provides the answer to part (a). Note that we had to reorganize the circuit to properly connect the dependent source.
        


Answers:



(a)
υ
o
          = 4.398 V.
        

(b)
          The Multisim simulation verified the results in part (a).
        








4-3.
            (a)
          
          Use MATLAB to find
          υ
s
          in terms of
          υ
s
          in the OP AMP circuit on the right.
        

(b)
          Validate your answer by simulating the circuit in Multisim.
        



SOLUTION:



(a)
          Find the Thévenin equivalent of the input circuit at node
          
A

          and then analyze the circuit as an inverting OP AMP. The solution is presented in the following MATLAB code.
        

          
            clear
            all
            % Find the Thevenin voltage
            syms
            vs vo
            vT = 56e3*vs/(22e3+56e3);
RT = 33e3 + 1/(1/22e3 + 1/56e3);
            % Find the output voltage in terms of vs
            Rf = 330e3;
Kv = -Rf/RT;
            
              MATLAB's
              solution requires us to understand
            
            vo = Kv*vT
            
              how to analyze the OP AMP circuit. Whereas
            
            vo_num = vpa(vo,4)
            
              in this problem with numbers, Multisim solves the problem without much effort. Choosing the best solution technique is part of being a good engineer.
            
            _______________________________

vo =
-(840*vs)/173
vo_num =
-4.855*vs
          
        

(b)
          The following Multisim simulation produces the same results presented in part (a).
        





Answers:



(a)
υ
o
          = - 4.855
          υ
s
          .
        

(b)
          The Multisim simulation verifies the results of part (a).
        


4-4.

          Design the interface circuit in the figure at the right so that 10 mW is delivered to the 100-Ω load. Repeat for a 100-kΩ load. Verify your designs using Multisim.
        





SOLUTION:


Our approach is to use MATLAB to compute the required output voltages for each resistor and then design OP AMP circuits that meet the specifications.

          
            clear
            all
            % Compute the required output voltages for each load p = v^2/R
            R = [100 100e3];
p = 10e-3;
v = sqrt(p*R)
__________________________________________________________________________________
v =
    1.0000e+000    31.6228e+000
          
        


          We need output voltages of 1 V and 31.6228 V. Since the input voltage is 2 V, we can use a voltage divider and a buffer to produce 1 V at the output. For an output voltage of 31.6628, we can use a noninverting amplifier with a gain of 15.8114. The required designs are shown below. Other correct designs are possible.
        






Variable
Operating Point Value




V(7)
31.6


V(1)
1


P(R3)
0.01


P(R7)
0.01






Note:


          For the second circuit, we had to adjust the maximum and minimum output values for the OP AMP voltages to be ± 50 V.
        


Answers:


Presented above.


4-5.

          A photoresistor varies from 100 Ω in bright sunlight to 200 kΩ in total darkness. Design a suitable circuit using the photoresistor so that total darkness produces 5 V, while bright sunlight produces - 5 V, regardless of the load. You have a 5-V source and a ± 15-V source to power any OP AMP you may need.
        


SOLUTION:



          Solve this problem in two stages. First, create a circuit that uses the photoresistor to create known voltages for the bright and dark conditions. Then, create an interface circuit to translate the known voltages into the required voltages. The following circuit uses a voltage divider to produce known voltages with the photoresistor. Since we know the photoresistor varies over several decades, it would be useful to select a series resistor that falls in the geometric mean of the range. Hence, we chose
          
          . The voltage response is shown in the parameter sweep of the photoresistor. How to set up for a parameter sweep is shown from Multisim's Analysis and Simulation window.
        









          We can use the following MATLAB code to calculate the voltages for the bright and dark conditions.
        

          
            clear
            all
            R_bright = 100;
R_dark = 200e3;
R = 4.472e3;
vs = 5;
v_bright = vs*R_bright/(R + R_bright)
v_dark = vs*R_dark/(R + R_dark)
__________________________________________________________________________________
v_bright =
    109.3613e-003
v_dark =
    4.8906e+000
          
        
Now, calculate the gain and bias terms.

          
            syms
            K vBias
            % Bright: 109.3613 mV input maps to a -5 V output
            % Dark: 4.8906 V input maps to a 5 V output
            Eqn1 = -5 - (K*109.3613e-3 +vBias);
Eqn2 = 5 - (K*4.8906 + vBias);
Soln = solve(Eqn1,Eqn2,K,vBias);
K = double(Soln.K)
vBias = double(Soln.vBias)
__________________________________________________________________________________
K=
   2.0915e+000
vBias =
   -5.2287e+000
          
        


Answer:


The following circuit will meet the specifications for the interface. The first stage provides the gain. We avoided loading the amplifier by selecting large resistors. The second stage combines the transducer signal with the bias and corrects the sign of the gain for the transducer signal. Because the bias voltage is greater than 5 V, we need to use the +15 V source and a voltage divider to get the proper bias (not shown). In running the simulation, we used the parameter sweep on the photoresistor as before and asked for both the input V(Vout) and the output V(Vout2). The resulting curves show that the circuit performs as desired.









Chapter 5
This chapter focuses on signals. The value of software tools is readily apparent when circuits are tested using a variety of signals. In this section, we will look at how to use software on a standard set of common signals to better understand the performance ofcircuits thatwe will analyze, design, and evaluate. The Multisim software willallow usto rapidlysimulate a varietyofcases to explore the behaviorofthe circuits. In addition, we will examine both the plotting and integration functions available in MATLAB to create professional graphs and to efficientlycalculate partial waveform descriptors.


Multisim
In Multisim, one can use a wide variety of input signals to analyze circuits. This section discusses a few of the more common signals used and how to create them. All of the following signals are created from the Source Library.

(a)
          There are two constant DC sources where only the DC value needs to be set. The DC voltage source is found under the "POWER_SOURCES" sublibrary, while the DC current source is found under "SIGNAL_CURRENT_SOURCES" sublibrary.
        




(b)
          There are three sinusoidal sources. Two are AC sinusoidal voltage source and one is a sinusoidal current source. The AC_POWER source is set in RMS volts and is primarily used to do phasor analysis. It is important to enter the desired voltage in RMS twice under voltage (RMS) and again under AC analysis magnitude. If the source has a phase shift, it also needs to be entered in degrees. Finally, the source frequency needs also to be entered. One can add a DC offset, thereby shifting the sinusoid up or down. If the source is a general sinusoid signal, rather than a power source, the SIGNAL_VOLTAGE_SOURCES sublibrary has an AC_VOLTAGE source. This source differs from the power source in that the amplitude of the sinusoid is in peak volts. This is the source that is used for
          
          performing frequency response analysis of a circuit. Like the power source, the amplitude is entered twice. The phase and an offset if there are any other than zero need to be entered. The sinusoidal current source is found in the SIGNAL_CURRENT_SOURCES sublibrary that has an AC_CUR-RENT source. Multisim's default sinusoid is a sine wave. If a cosine is desired, add 90°.
        







(c)
          Multisim has easy-to-use step voltage sources. You set the Initial level, Final level, the time from zero you want the source to turn on (Step time), must be 0 or greater, and how fast you want the switch to happen (Output rise/fall time), must be >0, but can be very fast—even in attoseconds.
        




(d)
          Multisim has flexible pulse generators that let you create a pulse train or a squarewave of your own choosing. You can select the Initial and Final values, the delay time to start the signal, the Rise and Fall times (must be > 0 but can be very fast even attoseconds), the Pulse width, and the Period. The figure on the left shows a ± 1 V square wave with a 1 ms period. While the one on the right shows a 0 to 5 mA current pulse train. We delayed the train by 200 μs, gave it a 2 ms period and a pulse width of 100 μs. Some of these parameters are displayed.
        







(e)
          Multisim has exponential pulse generators that can produce a rising or falling exponential. They can also switch from one exponential to another after a period of time has passed. Two examples are shown. In the first example, the voltage starts at 0 at
          t
          = 0 and increases with a 1 ms time constant toward 5 V. However, at
          t
          = 3 ms, it returns toward 0 V with a time constant of 250 μs. The second example has a current
          
          step starting at 100 mA at
          t
          = 500 μs with a time constant of 2 ms decreasing toward - 50 mA. After 10 ms, it returns to 100 mA with a time constant of 1 ms. Note that if there was no interest in the signal switching back, simply use a very long delay for the "Fall delay time."
        




(f)
          A decaying sinusoid, voltage or current, can be constructed using either the signal voltage or current ac source.
        

          For example, shown in the figure is a 1-V peak voltage source running at 1 kHz delayed by 5 ms and decayed using the "Damping factor (1/s) "—really the Napier frequency or 1/
          T
C
          of 500 (
          T
C
          = 2 ms). These parameters did not immediately show when we selected the function. Hence, we double-clicked on the source and opened the Property Editor. Shown is how we did the settings on the ac voltage source.
        








5-1.


          Use Multisim to generate the following waveform
          υ
          (
          t
          ) = (12
          e
−1000
          - 2)
          u
          (
          t
          ) V
        


SOLUTION:


This is an exponential waveform that starts at 10 V and decays to - 2 V with a time constant of 1 ms. To generate this waveform in Multisim, we use the exponential source. Since the source is expecting to start a second exponential, which we do not need, we selected the "Fall delay time" to be large, and hence, we chose 1 s. We ignored the second time constant. The source settings and the generated waveform are shown in the figure on the right.








5-2.

          Use Multisim to generate the following waveform:
          υ
          (
          t
          ) = 5 + 10
          e

            −500
            t

          cos(2π 1000
          t
          -45°)
          u
          (
          t
          ) V
        


SOLUTION:






          This waveform is an offset-decaying sinusoid with a phase shift. To generate this waveform, we chose the AC SIGNAL_VOLTAGE_SOURCE source. We set the amplitude to 10 V, the offset to 5 V, and the frequency to 1 kHz. We still needed to add the exponential decay and the phase shift. We used the Damping factor that is the inverse of the time constant and set it to 500 s
          -1
          . Similarly, we set the Phase to 45°. The source settings and the generated waveform are shown in the figure.
        





5-3.


          Multisim generates the following vaveform:
          υ
          (
          t
          ) =
          u
          (
          t
          ) +
          u
          (
          t
          −1) - 2
          u
          (
          t
          −2) V
        


SOLUTION:



          We use two PULSE_VOLTAGE sources in series. We set both at 0 to 1 V, use fast rise and fall times, turn on the first at
          t
          = 0 and off at
          t
          = 2 s. We delay the second for 1 s, turning it on at
          t
          = 1 s and off at
          t
          = 2 s. We set the pulse width very long since we are only interested in the first set of pulses.
        





MATLAB: Plotting
This section will introduce some of the plotting capabilities available with MATLAB. The plotting functions allow a user to quickly develop professional plots and graphics using a few basic commands. The signals introduced in this chapter can be plotted with minimal effort to better visualize the waveforms. The plotting functions are also extremely flexible and allow advanced users to fully customize the plots as desired.
This section will present a variety of examples to demonstrate some of the capabilities in MATLAB. Review the Help files and tutorials available in MATLAB to learn about more advanced plotting features. Before we develop the examples, we introduce the following MATLAB commands related to the signals presented in this chapter:



MATLAB Command
Function





heaviside(t)


                Step function,
                u
                (
                t
                )
              



dirac(t)


                Impulse function, δ(
                t
                )
              



exp(t)


                Exponential,
                e

t





sin(t) and cos(t)


                Sine and Cosine, sin (
                t
                ) and cos (
                t
                )
              



sinc(t)


                Sinc, sinc(
                t
                ) = sin(π
                t
                )/(π
                t
                )
              



sign(t)


                Signum, sgn(
                t
                )
              




          There is no built-in ramp function,
          r(t
          ), in MATLAB, but we can define our own ramp function.
          r(t) = t*heaviside(t)
          .
        


5-4.

          Use MATLAB to plot the following waveforms:
        

(a)
υ
1
          (
          t
          ) =3 V
        

(b)
υ
2
          (0 = 3
          u
          (
          t
          ) V
        

(c)
υ
3
          (
          t
          ) = 3 [
          u
          (
          t
          + 1) -
          u
          (
          t
          − 1)] V
        

(d)
υ
4
          (
          t
          ) = 3
          r
          (
          t
          ) V
        



SOLUTION TO (a)



          
            % Create a time vector
            t = -5:0.01:5;
            % Create a constant signal with the same length
            % as the time vector
            vlt = 3*ones(length(t));
            % Create a new figure window and plot the signal
            figure
plot(t,v1t)
xlabel(
            'Time (s)'
            )
ylabel(
            'v_1(t) (V)'
            )
title(
            'D5-4 (a)'
            )
axis([-5 5 -1 4])
grid
            on
          
        


SOLUTION TO (b)



          
            % Create a time vector
            t = -5:0.01:5;
            % Create a step function
            v2
            t
            = 3*heaviside(t);
            % Create a new figure window and plot the signal
            % with a red line 'r
            figure
plot(t,v2t,
            'r'
            )
xlabel(
            'Time (s)'
            )
ylabel(
            'v_2(t) (V)'
            )
title(
            'D5-4 (b)'
            )
axis([-5 5 -1 4])
grid
            on
          
        


SOLUTION TO (c)



          
            % Create a time vector
            t = -5:0.01:5;
            % Create a shifted time vector
            t = t + eps;
            % Create the signal
            v3
            t
            = 3*(heaviside(t + 1) - heaviside(t-1));
            % Create a new figure window and plot the signal with a
            % thick blue line 'b', "Linewidth", 5
            figure
plot(t,v3t,
            'b'
            ,
            'LineWidth'
            ,5)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'v_3(t) (V)'
            )
title(
            'D5-4 (c)'
            )
axis([-5 5 -1 4])
          
        


SOLUTION TO (d)



          
            % Create a time vector
            t = -5:0.01:5;
            % Create a constant signal with
            % the same length as the time vector
            v4
            t
            = 3*t.*heaviside (t);
          
        





          
            % Create a new figure window
            % and plot the signal
            figure
plot(t,v4t)
xlabel(
            'Time (s)'
            )
ylabel(
            'v_4(t) (V)'
            )
title(
            'D5-4 (d)'
            )
axis([-5 5 -1 15])
grid
            on
          
        





          In the solution to part (c), we shifted the time vector by a small amount so that the step function was never evaluated at time zero. The MATLAB variable eps is the smallest value MATLAB can represent and was used to make the shift. As you work with MATLAB, there may be situations where a discontinuity or "jump" appears in your plot. You may be able to remove this discontinuity and make the plot continuous by shifting the time vector as shown here. This type of adjustment is purely aesthetic and optional.
        


5-5.

          Use MATLAB to plot the following waveform. Inspect the waveform to determine the amplitude and calculate the time constants from the waveform equation.
        








SOLUTION:



          
            clear
            all
            format
            short eng
            %Plotting linewidth
            LW = 3;
syms
            tv1v2 v3v4
            % Create the signal
            v3 =10*exp(-2*(t-5))*heaviside(t-5);
t3 = 4+3*eps:0.005:8; v3
            t
            = subs(v3,t,t3);
plot(t3,v3t,
            'r','LineWidth'
            ,LW);
xlabel(
            'Time (s)'
            )
ylabel(
            'v_3(t) (V)'
            )
title(
            'D5-5'
            )
grid
            on
          
        


Answers:


Amplitude = 10 V, time constant = 500 ms.


5-6.


          Use MATLAB to plot the waveform
          υ
1
          (
          t
          ) = 120 cos (120 π
          t
          ) + 120 sin (120 π
          t
          ) V
        


SOLUTION:



          
            clear
            all
            t1 = 0:0.0001 :0.05;
v1
            t
            = 120*cos(120*pi*t1)+120*sin(120*pi*t1);
figure
plot(t1,v1t,
            'b','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'v_1(t) (V)'
            )
title(
            'D5-6'
            )
grid
            on
          
        


Answer:


Plot below.





MATLAB: Integration
The partial waveform descriptors of average value and root-mean-square value require the integration of a function to compute the values. Although most of the functions used in this textbook can be integrated manually or with standard integration tables, it can be convenient and efficient to use software tools to perform the integration. MATLAB can perform integration using either numerical or symbolic techniques, depending on the formulation of the problem. We will illustrate both approaches through a series of examples.
If a signal is represented numerically as a MATLAB vector, then we can use numerical techniques to compute the average and root-mean-square values. The approach assumes that the numbers in the vector represent samples of the signal, and that the samples are equally spaced. In addition, without being too rigorous, we assume that the samples are frequent enough to accurately capture the important features in the signal and that we know the time step between the samples. For the numerical case, having a smaller time step or more frequent samples will improve the accuracy of the integration results.


5-7.


          Use MATLAB to numerically calculate the average and root-mean-square values of the following periodic signal:
          υ
          (
          t
          ) =
          u
          (
          t
          ) +
          u
          (
          t
          - 1) - 2
          u
          (
          t
          - 2) V for 0 ≤
          t
          ≤ 4 s. The signal repeats every 4 s. Sample the signal every 100 ms to generate the numerical vector. Repeat the problem with samples every 1 ms and discuss the results.
        


SOLUTION:


The MATLAB code used to solve this problem and the corresponding results follow. For the numerical integration, we used the sum command and then multiplied the sum by the time step to approximate the integration.

          
            % Create a time vector
            tMin = 0;
tMax = 4;
T = tMax - tMin;
tStep = 0.1;
t = tMin:tStep:tMax;
t = t + 3*eps;
            % Create the signal
            vt =heaviside(t) +heaviside(t-l) - 2*heaviside(t-2);
            % Compute the average and RMS values
            vAVGl = sum(vt)*tStep/T
vRMSl = sqrt(sum(vt.^2)*tStep/T)
            % Adjust the time step and repeat the calculations
            tStep = 0.001,-
t = tMin:tStep:tMax;
t = t + 3*eps;
            % Create the signal
            vt =heaviside(t) +heaviside(t-l) - 2*heaviside(t-2);
            % Compute the average and RMS values
            vAVG2 = sum(vt)*tStep/T
vRMS2 = sqrt(sum(vt.^2)*tStep/T)
__________________________________________________________________________________
vAVGl =
    750. 0000e-003
vRMSl =
    l.ll80e+000
vAVG2 =
    750.0000e-003
vRMS2 =
    l.ll80e+000
          
        

          So for Δ
          t
          = 100 ms and Δ
          t
          = 1 ms, we have
          V
avg
          = 0.75 V and
          V
rms
          = 1.118 V. In this case, reducing the time step did not change the results of the numerical integration, because the function is piecewise constant.
        


5-8.

          A periodic waveform can be expressed as
          υ
          (
          t
          ) = 5 + 5 cos 1000 π
          t
          - 3 sin 2000 π
          t
          + cos 4000 π
          t V
          .
        
What is the period of the waveform? What is the average value of the waveform? What is the amplitude of the fundamental (lowest frequency) component? What is the highest frequency in the waveform?


SOLUTION:


Plot the signal to determine the period. Use MATLAB to calculate the average value. The other requested values can be determined by inspection of the waveform.


          
            clear
            all
            t = 0:0.00001:0.008;
vt = 5 + 5*COS(1000*pi*t) - 3*sin(2000*pi*t) + COS(4000*pi*t);
plot(t,vt,
            'b','LineWidth'
            ,5)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D5-8'
            )
          
        



The period is 2 ms.

          
            clear
            all
            syms
            t v
            To = 2e-3;
v = 5 + 5*COS(1000*pi*t) - 3*sin(2000*pi*t) + cos(4000*pi*t);
Vavg = int(v,t,0,To)/To
__________________________________________________________________________________
Vavg =
5
          
        


Answers:



T
0
          = 2 ms,
          V
avg
          = 5 V,
          A
1
          = 5 V, and
          f
H
          = 2000 Hz
        

          The MATLAB command int can be used to integrate functions represented symbolically. The details of the int command and additional options are explained in the MATLAB Help files. The following example illustrates how to use the
          int
          function.
        


5-9.

          Use MATLAB to symbolically calculate the average and root-mean-square values of the sinusoid and sawtooth signals in
          Figure 5-42
          of the text. Compare the results to those of Example 5-17.
        


SOLUTION:



          
            % Create symbolic variables
            syms
            VA T0 t
            % Create one period of the sawtooth signal and the sinusoid
            vSaw = VA*t/T0;
vSin = VA*sin(2*pi*t/T0);
            % Compute the average and RMS values
            vAVGSaw = int(vSaw,t,0,T0)/T0
vRMSSaw = sqrt(int(vSaw^2,t,0,T0)/T0)
vAVGSin = int(vSin,t,0,T0)/T0
            
            vRMSSin = sqrt(int(vSin^2,t,0,T0)/T0)
__________________________________________________________________________________
vAVGSaw =
VA/2
vRMSSaw =
(VA^2/3)^(1/2)
vAVGSin =
0
vRMSSin =
(VA^2/2)^(1/2)
          
        


Answer:


The MATLAB results agree with those in Example 5-17.


Chapter 6

          This chapter introduces energy storage devices— inductors and capacitors. MATLAB is useful in determining
          i
          -υ relationships and the like, while Multisim is useful in simulating OP AMP circuits with integrators and differentiators.
        


6-1.

          For
          t
          ≥ 0, the current through a 0.25-μF capacitor is
          i
C
          (
          t
          ) = 10 sin(2000
          t
          ) mA. Plot
          υ
C
          (
          t
          ) versus time when
          υ
C
          (0) = -10 V. In Multisim use the AC_CURRENT source in the sublibrary with the frequency in hertz and set the other parameters appropriately. Use the Property Editor to set the capacitor's initial condition to -10 V. Then plot the output using the transient function. When identifying an initial voltage on the capacitor, the applied polarity of the voltage is between the number one terminal considered positive and the number two terminal considered negative.
        





SOLUTION:


The solution is presented in the following MATLAB code and then a second time using Multisim.




          
            clear
            all
            syms
            t vc ic tau
            C = 0.25e-6;
vc0 =-10;
ic = 10e-3*sin(2000*t);
vc = vc0 + int(subs(ic,t,tau),tau,0,t)/C;
vc_num = vpa(vc,5)
            % Create a time vector to plot the voltage
            tt = 0:5e-6:8e-3;
vctt = subs(vc,t,tt);
plot(tt,vctt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D6-1 (MATLAB)'
            )
__________________________________________________________________________________
vc_num =
40.0*sin(1000.0*t)^2 - 10.0
          
        
Multisim simulation:


Answers:



υ
C
          (
          t
          ) = 40 sin
          2
          (1000
          t
          ) -10 V. The plots are presented above.
        


6-2.


          The voltage across a 0.1-μF capacitor is shown in the figure. Prepare sketches of
          i
C
          (
          t
          ) and
          
            p
            C
            (t
          
          ). Is the capacitor absorbing power, delivering power, or both?
        






SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            C = 100e-9;
tl = 10e-6; t2 = 30e-6; t3 = 40e-6;
syms
            t vc ic pc
            vc = 1e6*t*heaviside(t) - 1e6*(t-t1)*heaviside(t-tl) - 1e6*(t-t2)*heaviside(t-t2) + 1e6*(t-t3)*heaviside(t-t3);
ic = C*diff(vc,t);
pc = ic*vc;
tt = 0:200e-9:40e-6;
tt = tt + eps;
vctt = subs(vc,t,tt);
ictt = subs(ic,t,tt);
pctt = subs(pc,t,tt);
figure
plot(tt,vctt,
            'b','LineWidth'
            ,3)
grid
            on
            axis([0,40e-6,0,10]),
xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D6-2 (a)'
            )
figure
plot(tt,ictt,
            'b','LineWidth'
            ,3)
grid
            on
            axis([0,40e-6,-0.1,0.1]);
xlabel(
            'Time (s)'
            )
ylabel(
            'Current (A)'
            )
title(
            'D6-2 (b)'
            )
figure
plot(tt,pctt,
            'b','LineWidth'
            ,3)
grid
            on
            axis([0,40e-6,-1,1]);
xlabel(
            'Time (s)'
            )
ylabel(
            'Power (W)'
            )
title(
            'D6-2 (c)'
            )
          
        





Answers:


The plots are shown to the right. The capacitor is both absorbing and delivering power.


6-3.

          For
          t >
          0, the voltage across a 25-mH inductor is
          
            v
            L
            (t
          
          ) =20
          e
-400t
          V. Plot
          
            i
            L
            (i
          
          ) versus time when
          i
L
          (0) = 3 A. Use MATLAB and Multisim. In Multisim, use the EXPONENTIAL_VOLTAGE source. Use the Property Editor to set the inductor's initial condition to 3 A. Then, plot the output using the transient function and check the "User-defined" initial conditions under analysis parameters. Place a tiny, 1-nΩ resistor in series with the inductor to avoid an "inductor loop."
        





SOLUTION:


The solution is presented in the following MATLAB code and then a second time using Multisim.

          
            clear
            all
            syms
            t vL iL tau
            vL = 20*exp(-400*t);
L = 25e-3;
iL0 = 3;
iL = simplify(iL0 + int(subs(vL,t,tau), tau,0,t)/L)
tt = 0:150e-6:15e-3;
iLtt = Subs(iL,t,tt); plot(tt, iLtt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Current (A)'
            )
title(
            'D6-3 (MATLAB)'
            )
__________________________________________________________________________________
iL =
5 - 2*exp(-400*t)
          
        
Multisim simulation:





Answers:


The solutions are presented above.


6-4.

          The OP AMP integrator shown in the figure has
          R
          = 50 kΩ,
          C
          = 100 μF, and
          υ
O
          (0) = -2 V. The input is
          υ
s
          (
          t
          ) = 10
          u
          (
          t
          ) V. Use Multisim to determine how long it takes for the OP AMP to saturate when
          V
CC
          = ± 15 V.
        


SOLUTION:


The solution is presented in the following MATLAB code and then confirmed with the Multisim simulation.




          
            clear
            all
            syms
            t positive
            syms vs
            vo vf tau
            R = 50e3;
C = 100e-6;
vo0 = -2;
vs = 10*heaviside(t);
vo = simplify(vo0 - int(subs(vs,t,tau),tau,0,t)/R/C)
            
            % Solve for the time
            vf = 15+vo
Tf = solve(vf)
            % Plot the output voltage
            tt = 0:80e-5:8;
vott = subs(vo,t,tt);
plot(tt,...
vott,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D6-4 (MATLAB)'
            )
__________________________________________________________________________________
vo =
- 2*t - 2
vf =
13 - 2*t
Tf =
13/2
          
        



We used the cursor in MATLAB to find the time when the output reached -15 V.

          For the Multisim simulation, we set
          V
          CC to ± 15 V and read the graph.
        





Answer:



t
          = 6.5s
        


6-5.

          Design an OP AMP circuit that solves the following second-order differential equation for
          υ
o
          (
          t
          ). Solve forthe response for
          υ
o
          (
          t
          ) using Multisim.
        



Caution:


          Avoid saturating the OP AMPs by distributing the gain across several
        
OP AMPs.





SOLUTION:


Reformulate the equation as an integral equation.






Rewrite the last equation into a form that will be easier to implement with OP AMPs.





          Now create a circuit that will perform the integration.
        



Set the initial voltages on both capacitors to zero. The resulting output voltage is shown in the following plot.



We can verify these results using MATLAB as follows.

          
            clear
            all
            syms
            x(t)
            eqn = 1e-6*diff(x,t,2)+0.5e-3*diff(x,t)+x= = 2;
Dx = diff(x,t);
cond = [x(0)= = 0,Dx(0)= = 0];
vo(t) = dsolve(eqn,cond)
voNum = vpa(vo(t),5);
            % Plot the results
            tt = 0:50e-6:25e-3;
vott = subs(voNum,t,tt);
plot(tt,vott,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D6-5 (MATLAB)'
            )
__________________________________________________________________________________
vo(t) =
2 - (2*15^(l/2)*exp(-25Q*t)*sin(25Q*15^(1/2)*t))/15 - 2*exp (-25Q*t)*C0S (25Q*15*(1/2)*t)
15
          
        






Answers:


Presented above.


Chapter 7

          Thischapterdeals withthe transientresponse offirst- and second-ordercircuits. Both MATLAB and Multisim are useful tools for solving these problems. We will make use of the signals from
          Chapter 5
          .
        


7-1.

          The switch in the circuit on the right is closed at
          t
          = 0. The initial voltage on the capacitor is
          υ
C
          (0) = 20 V. +
        

(a)
          Find
          υ
C
          (
          t
          ) and
          i
O
          (
          t
          ) for
          t
          ≥ 0.
        

(b)
          Use MATLAB to plot the waveforms for
          υ
C
          (
          t
          ) and
          i
O
          (
          t
          ).
        

(c)
          Simulate the problem using Multisim and compare the results to the plots in part (b).
        





SOLUTION:


The solutions to parts (a) and (b) are presented in the following MATLAB code.

          
            % Part (a)
            clear
            all
            syms
            t vc io
            Req = 1/(1/33e3 + 1/15e3);
C = 100e-9; TC = Req*C;
vc0 = 20;
vc = vc0*exp(-t/TC);
            
            vc_num = vpa(vc,5)
io = vc/15e3;
io_num = vpa(io,5)
__________________________________________________________________________________
vc_num =
20.0*exp(-969.7*t) io_num =
0.0013333*exp(-96 9.7*t)
          
        

          
            % Part (b)
            tt = 0:10e-6:6e-3;
vctt = subs(vc,t,tt);
iott = Subs(io,t,tt);
figure
plot(tt,vctt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D7-1 (Voltage)'
            )
            %Part (b)
            figure
plot(tt,iott,
            'g','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Current (A)'
            )
title(
            'D7-1 (Current)'
            )
          
        
(c)  The following Multisim simulation verifies the MATLAB results.



Note:


          It is important to ensure that capacitor terminal 1 is at the top when calling up the Property Editor to apply the initial condition. Multisim's Grapher View allows for two y-axes to be displayed so that curves with differing units can be plotted on the same graph. To accomplish this, once Grapher View opens select Properties and Traces. Then chose the left (or right) traces for Trace 1 and select the left Y-vertical axis. Then select the Trace 2 and the right Y-vertical axis. Then enable the Right axis by opening the tab so labeled by checking the box "Enabled" under Axis. Finally, give the Divisions appropriate values and the axis a label. For the circuit being analyzed, the
          blue
          curve shows the capacitor voltage using the left axis and the
          green
          curve using the right axis shows the output current. The switch is shown OPEN but needs to be CLOSED for the transient analysis to work. Clicking on the switch closes or opens it. Do this before performing the simulation.
        


Answers:



(a)
υ
C
          (
          t
          ) = 20 [
          e

            -969.7
            t

          ]
          u
          (
          t
          ) V and
          i
o
          (
          t
          ) = 1.333 [
          e

            -969.7
            t

          ]
          u
          (
          t
          ) mA.
        

(b)
          Presented above.
        

(c)
          Presented below and the Multisim results agree with the MATLAB simulations.
        









7-2.

          The switch in the circuit on the right has been open long enough for
          i
L
          (0) to reach 0 A and is closed at
          t
          = 0. Use MATLAB and Multisim to find
          υ
L
          (
          t
          ) for
          t
          ≥ 0 if the input is
          υ
s
          (
          t
          ) = 10
          e

            -100
            t

          V.
        





SOLUTION:


First, solve the problems using MATLAB and then simulate the circuit in Multi-sim to verify the results.

          
            clear
            all
            syms
            x(t)
            % Perform a source transformation
            % Find the equivalent resistance
            Req = 1/(1/220 + 1/330);
            
              The differential equation that needs solving is:
            
            L = 1;
            
              (1/132)
              
                di
                La
                (t)/dt + i
                La
                (t)
              
              = (10/220)
              e
              
                −100
                t
              
              and
              i
              La
              (0) = 0.
            
            % Use the equivalent current source as the input
            eqn = (L/Req)*diff(x,t)+x= = 10/220*exp(-100*t);
cond = x(0)==0;
iLa(t) =dsolve(eqn,cond)
vLa = simplify(L*diff(iLa,t))
vLaNum = vpa(vLa,5);
            % Plot the results
            tt = 0:100e-6:80e-3;
vLatt = subs(vLaNum,t,tt);
plot(tt,vLatt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D7-2 (MATLAB)'
            )
__________________________________________________________________________________
iLa(t) =
(3*exp(-132*t)*(exp(32*t) - 1))/16
vLa(t) =
-(3*exp(-132*t)*(25*exp(32*t) - 33))/4
          
        




Multisim simulation:








Answer:







7-3.

          The switch in the figure at the right has been in position A for a long time and is moved to position B at
          t
          = 0, then the switch suddenly returns to position A after 10 ms. Find
          v
c
          (
          t
          ).
        





Multisim simulation
Under the Basic library, select under the SWITCH sublibrary, the TD_SW1 switch. This device lets us select the Time on (we set it at 0 s) and the Time off—when the switch switches (we set it at 10 ms). The switches performance can be improved by increasing the Off resistance to 1 TΩ. and reducing the On resistance to 1 pΩ


Answer:



υ
          c(
          t
          ) = [5 + 4
          e

            −200
            t

          ] [
          u
          (
          t
          ) -
          u
          (
          t
          −0.01)] + [9 - 3.4587
          e

            −1000 (
            t
            −0.001)/9
          
          ] [
          u
          (
          t
          − 0.01)] V.
        




The plot and simulation results are presented above.


7-4.

          Use MATLAB to find the u(t) that satisfies the following differential equation and initial conditions:
        





SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            x(t)
            eqn = diff(x,t,2)+10*diff(x,t)+36*x= = 0;
Dx = diff(x,t);
cond = [x(0)= = 0,Dx(0)= = 10];
v = dsolve(eqn,cond)
v_num = vpa(v,5)
__________________________________________________________________________________
v =
(10*11^(1/2)*exp(-5*t)*sin(11^(1/2)*t))/11 v_num =
3.0151*exp(-5.0*t)*sin(3.3166*t)
          
        


Answer:



υ
          (
          t
          ) = 3.0151e
          
            -5
            t

          sin (3.3166
          t
          ) V for
          t
          ≥ 0.
        


7-5.

          The switch in the
          RLC
          circuit on the right has been open for a long time and is closed at
          t
          = 0. The circuit parameters are
          L
          = 1 H,
          C
          = 0.5 μF,
          R
          = 2 kΩ, and
          υ
          c(0) = 10 V.
        

(a)
          Find
          vc
          (
          t
          ) and
          i
L
          (
          t
          ) for
          t
          ≥ 0 using MATLAB.
        

(b)
          Is the circuit overdamped, critically damped, or underdamped?
        

(c)
          Use Multisim to simulate your results.
        









SOLUTION:



(a)
          The circuit is a series
          RLC
          circuit. The initial capacitor voltage is 10 V and the initial value of the derivative of the capacitor voltage is
          i
c
          (
          t
          )/
          C
          =
          i
L
          (
          t
          )/
          C
          = 0 A/0.5 μF = 0A. The following MATLAB code solves the differential equation for the series
          RLC
          circuit to find
          υ
C
          (
          t
          ) and then
          i
L
          (
          t
          ).
        




          
            clear
            all
            syms
            x(t)
            L=1; C=0.5e-6; R=2e3;
eqn=L*C*diff(x,t,2) + ...
 R*C*diff(x,t) + x= = 0;
Dx = diff(x,t);
cond = [x(0)= = 10, Dx(0)= = 0];
vC = dsolve(eqn,cond);
vCNum = vpa(simplify(vpa(vC,5)),5)
iC = C*diff(vC,t);
            % The inductor current flows in the
            % opposite direction of the capacitor
            % current
            iL = simplify(-iC);
iLNum = vpa(iL,5)
            % Plot the results
            tt = 0:12e-6:6e-3;
vCtt = subs(vC,t,tt);
iLtt = subs(iL,t,tt);
figure
plot(tt,vCtt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D7-5 (Voltage)'
            )
figure
plot(tt,iLtt,
            'g','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Current (A)'
            )
title(
            'D7-5 (Current)'
            )
__________________________________________________________________________________
vCNum =
14.142*exp(-1000.0*t)*cos(1000.0*t - 0.7854)
iLNum =
0.01*exp(-1000.0*t)*sin(1000.0*t)
          
        




(b)
          The circuit response is a damped sinusoid, so the circuit is underdamped.
        

(c)
          The following Multisim simulation verifies the results.
        






Answers:



(a)
υ
C
          (
          t
          ) = 10
          e

            -1000
            t

          [sin(1000
          t
          ) + cos(1000t
          
          )] V and
          i
L
          (
          t
          ) = 10
          e

            -1000
            t

          [sin(1000
          t
          )] mA
        

(b)
          The circuit is underdamped.
        

(c)
          Presented above.
        


7-6.

          A circuit is needed to produce the following step response:
        

υ
c
          (
          t
          ) = 10-13.3
          e

            -200
            t

          + 3.3
          e

            -800
            t

          V
          t
          > 0
        
A vendor has proposed using the circuit shown in the figure on the right to produce the desired response. The vendor realizes that the proposed circuit does not exactly meet the desired response and is willing to make a single change for no extra charge. What change should the vendor make?

Hint: Use MATLAB to generate the desired response and then simulate the vendor's as-is response. Then decide what to change in the vendor's circuit to obtain the desired response. Simulate the corrected circuit using Multisim and verify that the responses match.






SOLUTION:



          The desired step response is overdamped with two distinct real roots. The proposed circuit is a series
          RLC
          circuit and the required characteristic equation is
        



The following MATLAB code computes the relevant values from the vendor's circuit.

          
            clear
            all
            R = 3.3e3;
L = 6.25;
C = 1e-6;
RL = R/L
w02 = 1/L/C
__________________________________________________________________________________
RL =
 528. 0000e + 000
w02 =
 160. 0000e + 003
          
        





          Based on these results, the 1/
          LC
          term is correct, but we need to adjust the
          R/L
          term to get the correct response. If we change only the resistance, then the 1/
          LC
          term will remain the same and still be correct.
        

          
            % Determine the scaling factor for
            % the resistance
            Rscale = 1000/RL
Rnew = R*Rscale
__________________________________________________________________________________
Rscale =
   1.8939e+000
Rnew =
   6.2500e+003
          
        
If we change the resistor to have a value of 6.25 kΩ, the circuit will have the correct type of response. The following MATLAB code will plot the desired response and the Multisim simulation verifies the results.

          
            syms t vc
            vc = 10-13.3*exp(-200*t)+3.3*exp(-800*t);
tt = 0:30e-6:30e-3;
vctt = subs(vc,t,tt);
plot(tt,vctt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D7-6 (MATLAB)'
            )
          
        
The Multisim circuit and simulation are as shown.








Answer:



          The vendor should change the resistor to be
          R
          = 6.25 kΩ.
        




          Chapter 8
        
This chapter begins the treatment of ac circuits. As such, we will use both MATLAB and Multisim to analyze circuits at a particular ac frequency, and in a few cases, at a broad range of frequencies.


8-1.

          Transform the following sinusoids into phasor form and draw a phasor diagram. Use the additive property of phasors to find
          i
1
          (
          t
          ) +
          i
2
          (
          t
          ).
        

(a)
i
1
          (
          t
          ) = 4 sin (ɷ
          t
          ) A
        

(b)
i
2
          (
          t
          ) = 3 cos (ɷ
          t
          - 45°) A
        


SOLUTION:


The following MATLAB code creates the phasors, sums them, and plots the phasor diagram

          
            clear
            all
            % Create the phasors.
            % Convert degrees to radians for the exponential's argument
            % Note that sin(wt) = cos(wt-pi/2) = cos(wt-90)
            i1 = 4*exp(-90*1i*pi/180)
i2 = 3*exp(-45*1i*pi/180)
            % Sum the phasors
            i12 = i1 + i2
            % Find the magnitude and angle of the sum
            [Anglei12,Magi12] = cart2pol(real(i12),imag(i12));
Magi12
Anglei12 = 180*Anglei12/pi
__________________________________________________________________________________
i1 =
   0.0000 - 4.0000i
i2 =
   2.1213 - 2.1213i
i12 =
   2.1213 - 6.1213i
Magi12 =
   6.4785
Anglei12 =
   -70.8864
            % Create the phasor
            plot axis([-4 4 -7 4])
line([-100 100],[0 0],...
            'Color','k'
            ,...
            'LineWidth'
            ,2)
line([0 0],[-100 100],...
            'Color'
            ,'k',...
            'LineWidth'
            ,2)
grid
            on
            hold on
xlabel(
            'Real'
            )
ylabel(
            'Imag'
            )
line([0,real(i12)],[0,imag(i12)],...
            'LineWidth'
            ,3,...
            'Marker'
            ,'o',...
            'MarkerSize'
            ,4,...
            'Color'
            ,'m')
            line([0,real(i1)],[0,imag(i1)],...
            'LineWidth'
            ,3,...
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
            'Color'
            ,'b')
line([0,real(i2)],[0,imag(i2)],...
            'LineWidth'
            ,3,...
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
            'Color','r'
            )
          
        






Answers:




            (a) I
            1

          =4
          e
−
j90
          °=0 -
          j
          4
        


            (b) I
            2

          = 3
          
            e
            −

j45
          ° = 2.1213 -
          j
          2.1213
        

(c)
          Sum:
          i
          (
          t
          ) +
          i
2
          (
          t
          ) = 6.4785 cos(ω
          t
          − 70.8864°) A. The phasor plot is above.
        


8-2.

          Find the equivalent impedance
          Z
          in the circuit on the right when ω = 2000 rad/s. Express the result in both polar and rectangular forms.
        


SOLUTION:


The solution is presented in the following MATLAB code.




          
            clear
            all
            R1 = 10;
R2 = 20;
L = 10e-3;
C = 50e-6;
w = 2000;
ZR1 = R1
ZR2 = R2
ZL = 1i*w*L
ZC = 1/1i/w/C
Zeq = ZR1 + ZL + 1/(1/ZR2 + 1/ZC)
MagZeq = abs(Zeq)
PhaseZeq = angle(Zeq)*180/pi
__________________________________________________________________________________
ZR1 =
 10.0000e+000
ZR2 =
 20.0000e+000
ZL =
 0.0000e+000 + 20.0000e+000i
ZC =
 0.0000e+000 - 10.0000e+000i
Zeq =
 14.0000e + 000 + 12.0000e + 000i
MagZeq =
 18.4391e+000
PhaseZeq =
 40.6013e+000
          
        


Answer:



Z
          = 14 +
          j
          12 = 18.4391 ∠40.6013° Ω
        


8-3.


          The circuit in the figure on the right is driven by a 10-krad/s source and is operating in the sinusoidal steady state. Use Multisim to find the steady-state phasor response V
          
x

          .
        





SOLUTION:


First, use MATLAB to compute the two capacitor values and to determine the output phasor. Then use Multisim to verify the results.

          
            clear
            all
            w = 10e3;
Vs = I00*exp(0*1i*pi/180);
            % Find the capacitor values
            wC1 = 1/20;
C1 = wC1/w
wC2 = 1/50;
C2 = wC2/w
__________________________________________________________________________________
C1 =
 5.0000e-006
C2 =
 2.0000e-006
            % Find the output phasor voltage by collapsing the circuit
            % from right to left using equivalent impedances
            Zeq1 = 50-50i;
Zeq2 =1/(1/100+1/Zeq1);
            % Use voltage division twice to find the output
            % phasor voltage
            V1 = Zeq2*Vs/(Zeq2-20i);
Vx= -50i*V1/(50-50i)
MagVx = abs(Vx)
PhaseVx = angle(Vx)*180/pi
__________________________________________________________________________________
Vx =
 50.0000e+000 - 25.0000e+000i
MagVx =
 55.9017e+000
PhaseVx =
 -26. 5651e + 000
          
        
Now we use Multisim to simulate the circuit and measure the output phasor voltage. You must use the AC_VOLTAGE source under the SIGNAL_VOLTAGE_ SOURCES sublibrary not the AC_POWER source under the POWER_SOURCES, since it uses root-mean-square values not peak values. Recalling that Multisim uses Hz, not rad/s, we convert 10 krad/s into 1592 Hz. Since your source operates only at one frequency, use Multisim's single frequency AC analysis. Grapher View returns a table that can easily be exported to Excel (find it under Grapher View'sTools.) Youcan choose your results to be in Real/Imaginary or Magnitude/Phase. We chose the latter so as to easily compare with the MATLAB results.






Variable
Frequency (Hz)
Magnitude
Phase (deg)




V(3)
1591.5
55.902
- 26.56



The Multisim results match the MATLAB analysis.


Answer:



          V
          
x

          = 50 -
          j
          25 V = 55902 z -26.56° V.
        





8-4.


          Use MATLAB and Multisim to find the Thevenin equivalent of the source circuit to the left of the interface in the figure to the left. Then use the equivalent circuit to find the steady-state voltage
          υ
          (
          t
          ) and current
          i(t
          ) delivered to the load.
        


SOLUTION:



          Convert the source to a cosine, since 30 sin(l0
          6
t
          ) V = 30 cos(l0
          6
t
          - 90°) V. This results in a phasor of V
          
s

          = 30<-90° V. Compute the answers using MATLAB and then use Multisim to check the results using the approach described in the problem.
        

          
            clear
            all
            Vs = 30*exp(-90*1i*pi/180);
w = 1e6;
L = 1e-3;
C = 500e-12;
R1 = 1e3; RL = 500;
ZL = 1i*w*L
ZC = 1/1i/w/C
            % Use voltage division to find the open-circuit voltage
            VT = Vs*ZC/(ZL + ZC)
            % Find the lookback impedance
            ZT = R1 + 1/(1/ZL + 1/ZC)
            % Now solve for the load voltage and current
            VL = VT*RL/(ZT + RL)
MagVL = abs(VL)
PhaseVL = angle(VL)*180/pi
IL = VL/RL
MagIL = abs(IL)
PhaseIL = angle(IL)*180/pi
__________________________________________________________________________________
ZL =
      0.0000e+000+ 1.0000e+003i
ZC =
      0.0000e+000- 2.0000e+003i
VT =
      3.6739e-015 - 60.0000e+000i
ZT =
      1.0000e+003+ 2.0000e+003i
VL =
      -9.6000e+000 - 7.2000e+000i
MagVL =
      12.0000e+000
PhaseVL =
      -143.1301e+000
IL =
      -19.2000e-003 - 14.4000e-003i
MagIL =
      24.0000e-003
PhaseIL =
      -143.1301e+000
          
        
Now use Multisim to find the solution. The following two circuits allow us to find the open-circuit voltage and the short-circuit current associated with the original circuit. We asked Multisim to calculate V(3), I(R2), and V(3)/I(R2), the Thévenin resistance.




The simulation results are shown in the table below. We ran the simulation twice, once for Magnitude and Phase and once for Real and Imaginary.



Variable
Frequency (Hz)
Magnitude
Phase (deg)
Real
Imaginary




V(3)
1591.50
59.99
- 90
- 2.4E - 07
- 59.99


V(3)/I(R2)
159150
2236
63.43
1000
2000


I(R2)
159150
0.02683
-153.4
- 0.024
- 0.012




          The Thévenin equivalent source is a 60-V voltage source with a phase of - 90° and an impedance of 1 +
          j
          2 kΩ. With ɷ = 1 Mrad/s, we can create the Thevenin impedance with a 1-kΩ resistor and a 2-mH inductor. We constructed the new Thevenin circuit and the original circuit with the load applied in both cases. The simulation results show the same results and the same as found using MATLAB.
        





Answers:



υ
          (
          t
          ) = 12 cos(10
          6
t
          -143.1°) V
        

i
          (
          t
          ) = 24 cos(10
          6
t
          -143.1°) mA
        



Variable
Frequency (Hz)
Real
Imaginary




V(11)
159150
-9.60008
-7.2003


V(8)
159150
-9.59965
-7.2004


I(R4)
159150
-0.0192
-0.014401


I(R6)
159150
-0.0192
-0.014401





8-5.

          The circuit in the figure on the right is operating with ɷ = 10 krad/s. Use MATLAB and Multisim to find the node voltage phasors
          V
A
          and
          V
B
          .
        


SOLUTION


We will use MATLAB to find the solution first and then use Multisim to find the answers using an alternative approach. We will set the operating frequency at ω = 10 krad/s so that we can calculate values for the inductor and capacitors.




          
            clear
            all
            syms
            VA VB
            Eqn1 = VA/(-200j) + VA/100 - 2 + (VA-VB)/400;
Eqn2 = (VB-VA)/400 + 2 + VB/200j + VB/(-50j);
Soln = solve(Eqn1,Eqn2,VA,VB);
VA = double(Soln.VA)
MagVA = abs(VA)
PhaseVA = angle(VA)*180/pi
VB = double(Soln.VB)
MagVB = abs(VB)
PhaseVB = angle(VB)*180/pi
__________________________________________________________________________________
            
            VA =
   141.1765e+000 - 35.2941e+000i
MagVA =
   145.5214e+000
PhaseVA =
   -14.0362e+000
VB =
   -23.5294e+000 +105.8824e + 000i
MagVB =
   108.4652e+000
PhaseVB =
   102.5288e+000
            % Calculate the values for the inductor and
            % capacitors for the given operating frequency
            w = 10e3;
wL = 200;
L = wL/w
wC1 = 1/200;
C1 = wC1/w
wC2 = 1/50;
C2 = wC2/w
__________________________________________________________________________________
L =
   20.0000e-003
C1 =
   500.0000e-009
C2 =
   2.0000e-006
          
        
We now simulate the circuit in Multisim. The simulation results are






Variable
Frequency (Hz)
Magnitude
Phase (deg)




V(a)
1591.5
145.5
-14


V(b)
1591.5
108.5
102.5





Answers:



          V
          A
          = 141.2-
          j
          35.29 V = 145.5 ∠-14.04°
        

          V
          B
          = -23.53 +
          j
          105.9 V = 108.5 ∠102.5° V
        


8-6.

          The OP AMP circuit shown on the right is operating in the sinusoidal steady state with ω = 1 krad/s. Find the ratio of the output phasor
          V
O
          to the input phasor
          V
S
          . Repeat for ω = 10 krad/s, ω = 100 krad/s, ω = 1 Mrad/s, and ω = 10 Mrad/s. Use MATLAB to plot the log of the magnitude of
          V
o
          /V
          S
          versus the log of the frequency ω. Comment on the plot.
        





SOLUTION:


Solve this problem with ω as a variable and then substitute in the required values. The OP AMP is connected as an inverting amplifier, so we need to calculate the input and feedback impedances to determine the input-output relationship. The figure has time-domain parameters in black and phasor-domain parameters in blue.


          
            clear
            all
            syms
            w positive
            R = 10e3;
C = 1e-9;
ZC = 1/li/w/C;
Zl = R;
Z2 = 1/(1/R +1/ZC); K = -Z2/Z1;
            % Use the variable ww to represent the specific frequencies
            % at which to evaluate the input-output ratio
            ww = [1e3 10e3 100e3 1e6 10e6];
Kww= subs(K,w,ww);
MagKww = abs(Kww);
PhaseKww = angle(Kww)*180/pi;
            % Present the results in a convenient format
            Results = [ww.
            1
            Kww.
            1
            MagKww.
            1
            PhaseKww.
            1
            ]
__________________________________________________________________________________
Results =
[  1000, -10000/10001+ (100*i)/10001, (100*10001^(1/2))/10001, (180*pi - 80*atan(1/100))/pi]
[ 10000, - 100/101 + (10*i)/101, (10*101^(1/2))/101, (18 0*pi - 8 0*atan(1/10))/pi]
[ 100000, -1/2+i/2, 2^(1/2)/2, 135]
[1000000, - 1/101 + (10*i)/101, 101^(1/2)/101, (180*pi - 80*atan(10))/pi]
[10000000, - 1/10001 + (100*i)/10001, 10001^(1/2)/10001, (180*pi - 80*atan(100))/pi]
            % Plot the log of the magnitude of the voltage
            % ratio versus the log of the frequency
            ww = logspace (2,9,100);
Kww= subs(K,w,ww); MagKww = abs(Kww);
loglog(ww,MagKww,
            'b','LineWidth'
            ,3)
grid
            on
            axis([1e2,1e9,1e-4,1])
xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Magnitude Vo / Vs'
            )
title(
            'D8-6'
            )
          
        






Answers:


The following table summarizes the results for the requested frequencies.



ω RAD/S

                V
                o
                /V
                s


                |V
                o
                /V
                s
                |
              

                ∠V
                o
                /V
                s





1k

                - 9999 +
                j
                9999 m
              
999.95 m
179.43°


10 k

                - 9901 +
                j
                9901 m
              
995.04 m
174.29°


100 k

                - 500 +
                j
                500 m
              
707.11 m
135°


1M

                - 9901 +
                j
                9901 m
              
99.50 m
95.71°


10 M

                - 00999 +
                j
                9999 m
              
9.9995 m
90.57°



The plot of the magnitude of the input-output relationship versus frequency is shown above. The plot is approximately constant with a value near one up until a frequency of approximately 100 krad/s. After this frequency, the plot decreases linearly on the log-log scale. The magnitude of the ratio decreases by a factor of 10 every time the frequency increases by a factor of 10.

          This is the characteristics of a low-pass filter since low frequencies are passed through while high frequencies are increasingly blocked. We cover these types of circuits starting in
          Chapter 12
          .
        


Chapter 9
This chapter deals with Laplace transforms. Although one purpose of using transforms is to simplify the math, there are equally rewarding aspects as gaining a deeper understanding of a circuit's performance. Transforms have resulted in new tools such as pole-zero diagrams and Bode plots that can help a circuit designer understand both the frequency and transient behavior of a circuit. Although in this text we limit ourselves to circuits and their transforms that can generally be easily analyzed using the cover-up method and look-up tables, it does not take too much more complexity to wish for a simplifying software tool.

          There are software applications that can be used to find the Laplace transform ofa given waveform. In particular, MATLAB has the functions laplace and ila-place, which operate on symbolic expressions to take the Laplace transform and inverse Laplace transform, respectively. For these MATLAB functions, if the symbolic expressions are written in terms of the variables
          t
          and s, as appropriate, then the results follow the notation we have been using. You may also specify other variables in the Laplace transform commands, as explained in the MATLAB Help files. The following examples illustrate the commands.
        


Laplace


9-1.

          Use MATLAB to find the Laplace transform of the waveform
        




          Plot the corresponding pole-zero diagram of
          F(s
          ).
        


SOLUTION:


The following commented MATLAB code will generate a solution to this problem:

          
            % Create the symbolic variables
            syms
            t s
            % Define the time-domain waveform
            % MATLAB assumes the waveform is causal, so we do not
            % need to include the step function u(t) inf(t)
            f = 200*t*exp(-25*t) + 10*exp(-50*t)*sin(40*t);
            % Compute the Laplace transform
            
            % Since f(t) is written with the symbolic variable t,
            % MATLAB will create F(s) in terms of the symbolic variable s
            F = laplace(f)
            % Display in a pretty format
            pretty(F)
            % Create the pole-zero diagram
            % Convert F(s) into a state-space system
            clear
            s
            s = tf('s');
            
              The function
              tf('s')
              is discussed
            
            Fs = 200/(s + 25)^2 + 4 0 0/((s+50)^2 + 1600);
            
              briefly below.
            
            % Plot the pole-zero
            diagram pzmap(Fs)
title(
            'D9-1'
            )
          
        
The results displayed in the MATLAB command window from running this code are as follows:





This is the result of
            pretty(F).
          

In addition, the MATLAB command pzmap creates a figure window and generates the pole-zero diagram shown in the figure on the below.




          A few additional comments are required to explain this solution. The function pretty formats an expression so that it may be easier to read in the command window as a rational function. The last part of the code uses the commands
          tf
          and pzmap to create a transfer function and the pole-zero diagram. In simple terms, the command tf allows us to write
          F(s
          ) in a format that MATLAB can interpret for creating the pole-zero diagram with the command pzmap. To get the expression for
          
          the variable Fs in the MATLAB code, we ran the first part of the code and then copied the expression for the variable F from the command window back into the script. We will explore the command
          tf
          in more detail when we discuss transfer functions in
          Chapter 11
          .
        


9-2.

          Use MATLAB to perform all of the calculations required to find the Laplace transform of the following waveform:
        





SOLUTION:



          Write the transform
          F
          (
          s
          ) as a rational function. Create the corresponding pole-zero diagram. The following MATLAB code will generate a solution to this problem:
        

          
            clear
            all
            % Create the symbolic variables
            syms
            t s x
            f = 5*exp(-2 0*t)+5 0*int(exp(-4 0*x)*sin(3 0*x),x,0,t)
F = laplace(f)
            % Display in a pretty format
            pretty(F)
            % Create the pole-zero diagram
            % Convert F(s) into a state-space system
            clear
            s
            s = tf(
            's'
            );
Fs = 5/(s + 20)-(3*(s + 40))/(5*((s + 40)^2 + 900))+3/(5*s)...
 - 24/((s+40)^2+900); % Plot the pole-zero diagram pzmap(Fs)
title(
            'D9-2'
            )
__________________________________________________________________________________
          
        

          The results are
          


          f =
5*exp(-20*t) - (exp(-40*t)*(3*cos(30*t) +4*sin(30*t)))/5 +3/5
        




          F =
5/(s + 20) - (3*(s + 40))/(5*((s + 40)^2 + 900)) + 3/(5*s) -24/((s + 40)^2 + 900)
        





Answers:





The pole-zero diagram is as shown above.
If a transform is specified by its scale factor, K, and its poles and zeros, then we may want to convert this description into a rational function. MATLAB includes built-in commands to handle this task, including the function poly. The following example illustrates an application of the function poly.


9-3.

          A transform has poles located at
          s
          = -1,
          s
          = -2, and
          s
          = -3, and finite zeros located at
          s
          = -8 and
          s
          = - 9. Write
          F(s
          ) as a quotient of polynomials in s.
        


SOLUTION:


To solve this problem using MATLAB, create a vector containing all of the poles and another vector containing all of the zeros. Apply the function poly to each vector. The results of the function will be another vector containing the coefficients for the polynomial associated with multiplying out the corresponding poles or zeros. The required MATLAB code is shown below:

          
            % Create vectors of the poles and zeros
            p = [-1 -2 -3];
z = [-8 -9];
            % Compute the coefficients for the denominator and numerator
            denCoeff = poly(p)
numCoeff = poly(z)
          
        
The results in the command window are as follows:

          denCoeff =
   1.0000e+000 6.0000e+000 11.0000e+000 6.0000e+000
numCoeff =
   1.0000e+000 17.0000e+000 72.0000e+000
        

          To interpretthe list ofcoefficients for the denominator and numerator, start at the right and work to left. The rightmost coefficient corresponds to an exponent of zero for the polynomial variable, which is
          s
          in this case. Each step to the left increases the exponent by one. Using this approach, we have the following denominator:
        



and the following numerator:





          The resulting polynomial is
        



The final expression includes the scale factor, K, which was not specified in the problem statement.


9-4.

          A transform has two poles located at
          s
          = -25, and zeros located at
          s
          = -25 +
          j
          25 and - 25 -
          j
          25.
        


SOLUTION:



          Use MATLAB to find
          F(s
          ) as a quotient of polynomials in s.
        

          
            % Create vectors of the poles and zeros
            p = [-25 -25];
z = [-25 + 25i -25-25i];
            % Compute the coefficients for the denominator and numerator
            denCoeff = poly(p)
numCoeff = poly(z)
__________________________________________________________________________________
denCoeff =
   1.0000e+000 50.0000e+000 625.0000e+000
numCoeff =
   1.0000e+000 50.0000e+000 1.2500e+003
          
        


Answer:







ILAPLACE



          The inverse Laplace transform allows us to recover a time-domain waveform after operating on a system in the Laplace domain. Computing the inverse transformation manually is useful for understanding the relationship between the two domains, but at some point it becomes more efficient to perform the transformation calculations with software. Above, we used the MATLAB command
          laplace
          to compute the Laplace transform of a waveform. Here, we will examine the command
          ilaplace
          , which computes the inverse transformation.
        

          The command
          ilaplace
          operatesona symbolicexpressionand, asa default, it expectsthe expressiontobe intermsofthe variable
          s.
          The commandreturnsasym-bolicexpressionintermsofvariable
          t,
          anditisassumedthattheresultingwaveform is causal. In the results, the command does not include the unit step function, which is the MATLAB function
          heaviside(t)
          , but we can add it to the expression to get the complete answer for the waveform. It is acceptable to use variables other than
          s
          and
          t
          for the
          ilaplace
          command, asexplained inthe MATLAB Helpfiles, but we will keep with the standard notation.
        

          It is possible to create time-domain waveforms and
          s
          -domain transform functions for which MATLAB cannot successfully execute the
          laplace or the ilaplace
          commands. For example, when a waveform includes symbolic parameters that cause a time shift, the command
          laplace
          will not be able to determine ifthe time shift is positive or negative, so it will not successfully complete the operation. In these cases, we must rely on the manual techniques and engineering judgment to complete the Laplace transformation and inverse transformation.
        


          The following example demonstrates how to use MATLAB to compute an inverse transformation and to plot the resulting waveform.
        


9-5.

          Find the inverse transform of the following transform:
        




          Plot the resulting waveform over an appropriate range of values for time
          t.



SOLUTION:



          The following commented MATLAB code will calculate the waveform,
          f
          (
          t
          ), associated with the transform,
          F(s
          ), and plot the waveform versus time.
        

          
            % Create the symbolic variables
            syms
            t s
            % Write the transformation function in terms of variable s
            F = 2e8*(s + 20000)/(s + 100)/(s^2+200^2)^2;
            % Compute the inverse Laplace transform
            f = ilaplace(F)
            % Create a time vector for plotting
            tt = 0:0.0002:0.1;
            % Calculate the waveform along the time vector
            ftt = subs(f,t,tt);
            % Plot the results figure
            plot(tt,ftt,
            'b','LineWidth'
            ,3)
title(
            'D9-5'
            )
xlabel(
            'Time, (s)'
            )
ylabel(
            'f(t)'
            )
grid
            on
          
        
The results displayed in the MATLAB command window are:

          f=
1592/exp(100*t) - 1592*cos(200*t) + 13 06*sin(200*t) -102000*t*cos(200*t) - 199000*t*sin(200*t)
        





          We can write the waveform as
        




          where we have added the unit step function,
          u
          (
          f
          ), for completeness. The plot of
          f
          (
          t
          ) is shown in the above figure. Note that the "t" multiplying the cosine and sine functions causes the system to be unstable because of multiple poles on the
          j
          ɷ axis.
        
Notice how we can accomplish the inverse transformation in just three lines of MATLAB code. A manual calculation for the same problem would require several steps and a variety of computations, which presents many opportunities to make a mistake.


9-6.

          Find the inverse Laplace transform of the following function:
        





SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            t s
            F= (s+10)/s/(s+50)/(s+100);
f = ilaplace(F)
__________________________________________________________________________________
f=
(2*exp(-50*t))/125 - (9*exp(-100*t))/500 + 1/500
          
        


Answer:







9-7.

          Use MATLAB to find the inverse transform of the following function:
        





SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            t s
            F = 16*s/(s + 2)/(s^2 + 12*s + 13);
f = ilaplace(F)
__________________________________________________________________________________
f=
(32*exp(-2*t))/7 - (32*exp(-6*t)*(cosh(23^(1/2)*t) + (23^(1/2)
*sinh(23"(1/2)*t))/46))/7
          
        

          The results for
          f(t
          ) are not presented in a convenient format. The following approach gives a better numerical result. See the MATLAB Help on the residue command to interpret the results.
        

          
            num = [16 0];
den = conv([1 2],[1 12 13]);
[r,p,k]=residue(num,den)
__________________________________________________________________________________
r=
 -2.0474e+000
 4.5714e+000
 -2.5240e+000
p =
            
              Note:
              k
              is nonexistent for a proper rational function. However,
            
            -10.7958e+000
            
              if we have an irrational function of the same order, then
              k
            
            -2.0000e+000
            
              becomes the coefficient of delta function d. If the order of the
            
            -1.2042e+000
            
              numerator is one greater than that of the denominator,
              k
            
            k =
            
              returns the coefficient ofthe doublet
              d'
              and ofthe delta
              d
              functions.
            
            []
            
              Higher order differences are not practical.
            
          
        



Answer:







Solving Differential Equations Using Laplace


9-8.

          Use the Laplace transformation to find the w(J) that satisfies the following first-order differential equation:
        





SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            t s Vs vt
            v0 = 100;
            % Take the Laplace transform of the differential equation
            Eqnl = 500*(s*Vs - v0)+2500*Vs;
            
            % Solve for V(s)
            Vs = solve(Eqn1,Vs)
            % Take the inverse Laplace transform to find v(t)
            vt = ilaplace(Vs)
__________________________________________________________________________________
Vs =
100/(s + 5)
vt =
100*exp(-5*t)
          
        


Answer:



υ
          (
          t
          = [100
          e

            −5
            t

          ]
          u
          (
          t
          ) V
        


9-9.

          Use the Laplace transformation to find the
          υ
          (
          t
          ) that satisfies the following second-order differential equation:
        





SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            t s Vs vt
            v0 = 0;
dv0 = 100;
            % Take the Laplace transform of the differential equation
            Eqn1= (s^2*Vs-s*v0-dv0)+100*(s*Vs-v0)+500*Vs;
            % Solve for V(s)
            Vs = solve(Eqn1,Vs)
            % Take the inverse Laplace transform to find v(t)
            vt = ilaplace(Vs)
            % Also use the residue approach
            num = 100;
den = [1 100 500];
[r,p,k]=residue(num,den)
__________________________________________________________________________________
Vs =
100/(s^2 + 100*s + 500)
vt =
5^(1/2)*exp(-50*t)*sinh(2 0*5^(1/2)*t)
r=
 -1.1180e+000
 1.1180e+000
p=
 -94.7214e+000
 -5.2786e+000
k=
 []
          
        


Answer:







Initial and Final Value Theorems


9-10.

          Use the initial and final value properties to find the initial and final values of the waveforms corresponding to the transforms below. If either property is not applicable, explain why?
        

(a)



(b)



(c)




SOLUTION:



          All transforms are proper rational functions, so the initial value property applies to all. The poles for
          sF(s
          ) have negative real parts for the first two transforms, but not the third. The final value property applies to only the first two transforms. The solution is presented in the following MATLAB code.
        

          
            clear
            all
            syms
            t s
            disp(
            'Part (a)'
            )
F1 =16*s/(s+2)/(s^2+12*s+13);
f10 =limit(s*F1,s,inf);
f1f = limit(s*F1,s,0);
            % Check the results by finding f1(t)
            f1 = ilaplace(F1);
f120 = limit(f1,t,0);
f12f = limit(f1,t,inf);
Results1= [f10,f1f;f120,f12f]
          
        

          
            
            disp(
            'Part (b)'
            )
F2 = (s+10)/s/(s+50)/(s+100);
f20 = limit(s*F2,s,inf);
f2f = limit(s*F2,s,0);
            % Check the results by finding f2(t)
            f2 = ilaplace(F2);
f220 = limit(f2,t,0);
f22f = limit(f2,t,inf);
Results2 = [f20,f2f;f220,f22f]
          
        

          
            disp(
            'Part (c)'
            )
f3 = (3*s"4+10*s"2+4)/s/(s"2+1)/(s"2+4);
f30 = limit(s*F3,s,inf);
f3f = limit(s*F3,s,0);
            % Check the results by finding f3(t)
            f3 = ilaplace(F3);
f330 = limit(f3,t,0);
f33f = limit(f3,t,inf);
Results3 = [f30,f3f;f330,f33f]
__________________________________________________________________________________
Part (a)
Results1 =
[0, 0]
[0, 0]
Part (b)
Results2 =
[0, 1/500]
[0, 1/500]
Part (c)
Results3 =
[3, 1]
[3, NaN]
          
        


Answers:



(a)
f
1
          (0)= 0 and ∞ = 0.
        

(b)
f
2
          (0) = 0 and
          f
2
          (∞) = 0.002.
        

(c)
f
3
          (0) = 3 and
          f
3
          (∞) does not exist, because
          sF
3
          (
          s
          ) has poles with nonnegative real parts.
        


Chapter 10

          The circuit analysis concepts in this chapter are essentially the same as those in
          Chapter 3
          , except using Laplace transforms. There are really no new MATLAB or Multisim applications, but several examples can be useful in practicing these software techniques.
        





10-1.

          Find
          Z
EQ
          (s) in the circuit on the right. Express
          Z
EQ
          (s) as a rational function and locate its poles and zeros for
          R
          = 2 kΩ,
          L
          = 0.4 H, and
          c
          = 0.1 μF.
        


SOLUTION:


The solution is presented in the following MATLAB code.


          
            clear
            all
            syms
            s R L C Zeq ZL ZC
            % The inductor and capacitor are in series
            % The result is in parallel with the resistor ZL = s*L;
            ZC = 1/s/C;
Zeq = simplify(1/(1/(ZL + ZC) + 1/R))
            % Substitute numerical values
            R = 2e3;
L = 0.4;
C = 100e-9;
Zeq_num = simplify(subs(Zeq))
pretty (Zeq_num)
__________________________________________________________________________________
Zeq =
(R*(C*L*s^2 + 1))/(C*L*s^2 + C*R*s + 1)
          
        




          
            % Find the poles and zeros
            p = roots([1 R/L 1/L/C])
z = roots([1 0 1/L/C])
__________________________________________________________________________________
p =
 -2.5000e+003 + 4.3301e+003i
 -2.5000e+003 - 4.3301e+003i
z=
 0.0000e+000+ 5.0000e+003i
 0.0000e+000 - 5.0000e+003i
          
        


Answers:






          The poles are located at
          s
          = - 2500 ±
          j
          4330 rad/s and the zeros are located at
          s
          =±
          j
          5000 rad/s.
        


10-2.

          Transform the circuit on the left into the
          s
          domain and find:
          I
L
          (s),
          i
L
          (
          t
          ),
          
            V
            L
            (s
          
          ), and
          υ
L
          (
          t
          ) when
          υ
1
          (
          t
          ) =
          V
A
u
          (
          t
          ) and
          i
L
          (0) =
          I
A
          .
        





SOLUTION:



          When we convert the circuit into the
          s
          domain, the resistors do not change, the voltage source is replaced by
          V
A
          /
          s
          , and the inductor is replaced by an impedance
          Ls
          in series with a voltage source of magnitude
          LI
A
          , with the positive terminal at the bottom. Use node-voltage analysis to find the inductor voltage and then solve for the inductor current as shown in the following MATLAB code.
        


          
            syms
            s t R L VA IA VLs vLt ILs iLt
            ZL = s*L;
            % Write the node-voltage equation
            Eqn1= (VLs-VA/s)/R + VLs/R + (VLs+ L*IA)/ZL;
VLs = solve(Eqn1,VLs)
vLt = simplify(ilaplace(VLs))
            % Find the inductor current
            ILs = simplify((VLs+ L*IA)/ZL)
iLt = ilaplace(ILs)
Check_vLt =L*diff(iLt,t)
__________________________________________________________________________________
VLs =
(L*VA - IA*L*R)/(R + 2*L*s)
vLt =
(exp(-(R*t)/(2*L))*(VA - IA*R))/2
ILs =
(VA + 2*IA*L*s)/(s*(R + 2*L*s))
iLt =
VA/R - (exp(-(R*t)/(2*L))*(VA - IA*R))/R
Check_vLt =
(exp(-(R*t)/(2*L))*(VA - IA*R))/2
          
        


Answers:







10-3.

          The switch in the circuit shown has been in position B for a long time and is moved to position A at
          t
          = 0.
        

(a)
          Transform the circuit into the
          s
          domain and solve for
          V
C
          (
          s
          ) in symbolic form.
        

(b)
          Find
          υ
C
          (
          t
          ) for
          R
1
          =
          R
2
          = 250 Ω,
          R
3
          = 1 kΩ,
          L
          = 500 mH,
          C
          = 1 μF, and
          V
A
          = 15 V.
        

(c)
          Repeat (b) using Multisim.
        





SOLUTION:



(a)
          With the switch in position B for a long time, the initial inductor current and capacitor voltage are both zero. If we transform the circuit into the
          s
          domain, the voltage source becomes
          
            V
            A
            /s,
          
          the resistors do not change, the inductor is replaced by its impedance Ls, and the capacitor is replaced by its impedance 1/Cs. We can then use voltage division to find the capacitor voltage. The following MATLAB code completes the calculations.
        

          
            clear
            all
            syms
            s t R1 R2 R3 L C VA
            Vs = VA/s;
ZL = s*L;
ZC = 1/s/C;
            
            Zeq = R1 + R2 + ZL + ZC;
VCs = simplify(ZC*Vs/Zeq)
pretty(VCs)
__________________________________________________________________________________
VCs =
VA/(C*s^2*(R1 + R2 + L*s + l/(C*s)))
          
        




(b)
          We can use MATLAB to perform the substitutions and take the inverse Laplace transform.
        

          Rl = 250;
R2 = 250;
R3 = 1e3;
L = 500e-3;
C = le-6;
VA = 15;
VCs = subs(VCs);
vCt = ilaplace(VCs)
__________________________________________________________________________________
vCt =
15 - 15*exp(-500*t)*(cos(500*7^(1/2)*t) + (7*(1/2)*sin (500*7^(1/2)*t))/7)
        

          
            % Plot the voltage
            tt = 0:20e-6:12e-3;
vCtt = subs(vCt,t,tt);
plot(tt,vCtt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title (
            'D10-3 (MATLAB) '
            )
          
        




(c)
          The following Multisim simulation verifies the results found above.
        






Answers:



(a)



(b)



(c)
          The Multisim simulation is presented above and verifies the results.
        


10-4.

          The circuit in the figure on the right is in the zero state. Find the Thévenin equivalent to the left of the interface.
        





SOLUTION:


Use voltage division to find the open-circuit voltage and the lookback method to find the Thévenin impedance.

          
            clear
            all
            syms
            s t VT ZT
            Vs = laplace(100*heaviside(t));
R1 = 2e3;
R2 = 2e3;
C = 1e-6;
ZC = 1/s/C;
            % Use voltage division
            VT = simplify(R2*Vs/(R1 + ZC + R2))
            % Use the look-back method
            ZT = simplify(1/(1/(R1+ ZC) + 1/R2))
__________________________________________________________________________________
VT =
50/(s + 250)
ZT =
(1000*s+500000)/(s+250)
          
        


Answers:







10-5.

          There is no initial energy stored in the bridged-T circuit in the figure on the right.
        





(a)
          Transform the circuit into the
          s
          domain and formulate node-voltage equations.
        

(b)
          Use the node-voltage equations to find the
          s
          -domain relationship between the input
          V
1
          (
          s
          ) and the output
          V
2
          (
          s
          ).
        


SOLUTION:



(a)
          Let the node between the capacitors be Node A and the node to the right of capacitor
          C
2
          be Node 2. We can now write the node-voltage equations as follows:
        




(b)
          We can use MATLAB to find the input-output voltage relationship.
        

          
            clear
            all
            syms
            stVA V1V2R1 R2C1 C2
            Eqn1= (VA-V1)/(1/s/C1) + VA/R1 + (VA-V2)/(1/s/C2);
Eqn2 = (V2-VA)/(1/s/C2) + (V2-V1)/R2;
Soln = solve(Eqn1,Eqn2,VA,V2);
V2 = simplify(Soln.V2)
Ts = V2/V1
pretty(Ts)
__________________________________________________________________________________
V2 =
(V1*(C1*R1*s + C2*R1*s + C1*C2*R1*R2*s^2 + 1))/(C1*R1*s + C2*R1*s + C2*R2*s + C1*C2*R1*R2*s^2 + 1)
Ts =
(C1*R1*s + C2*R1*s + C1*C2*R1*R2*s^2 + 1)/(C1*R1*s + C2*R1*s + C2*R2*s + C1*C2*R1*R2*s^2 + 1)
			2
	C1 R1 s + C2 R1 s + C1 C2 R1 R2 s + 1
 --------------------------------------------
	  				     2
 C1 R1 s + C2 R1 s+ C2 R2 s + C1 C2 R1 R2 s + 1
          
        


Answers:



(a)
          Node A:
          


          Node 2:
          


(b)







10-6.

          There is no external input in the circuit in figure on the left.
        

(a)
          Find the zero-input node voltages
          υ
A
          (
          t
          ) and
          υ
B
          (
          t
          ), and the voltage across the capacitor
          υ
C
          (
          t
          ) when
          υ
C
          (0) = 5 V and
          i
L
          (0) = 0 A.
        

(b)

          Use MATLAB to plot your results in (a).
        

(c)
          Use Multisim to validate your results in (a).
        

(d)
          Compare the MATLAB and Multisim plots. Are they the same?
        


SOLUTION:



(a)
          Convert the circuit into the
          s
          domain by replacing the inductor by its impedance and the capacitor by its impedance in series with a voltage source of magnitude
          υ
C
          (0)
          /s
          = 5/s, with its positive terminal on the left. The node between the new voltage source and the capacitor has a voltage of
          V
B
          (s) + 5/s, and we will use the supernode approach to handle this source. We can now write node-voltage equations to solve for the node voltages.
        

          
            clear
            all
            syms
            s t VA VB VC
            C = 10e-6;
L = 0.1;
ZC = 1/s/C;
ZL = s*L;
            % Write the node-voltage equations for VA and VB
            Eqnl = VA/100 + (VA-(VB + 5/s))/ZC;
Eqn2 = (VB + 5/s-VA)/ZC + VB/100 + VB/ZL;
Soln = solve(Eqn1,Eqn2,VA,VB);
VA= simplify(Soln.VA);
VB = simplify(Soln.VB);
VC = VA-VB; vA = ilaplace(VA)
vB = ilaplace(VB)
vC = ilaplace(VC)
__________________________________________________________________________________
vA =
(5*exp(-500*t)*(cos(500*t) + sin(500*t)))/2
vB =
-(5*exp(-500*t)*(cos(500*t) - sin(500*t)))/2
vC =
5*cos(500*t)*exp(-500*t)
          
        

(b)
          Plot the voltages using MATLAB.
        

          
            tt = 0:20e-6:12e-3;
vAtt = subs(vA,t,tt);
vBtt = subs(vB,t,tt);
vCtt = subs(vC,t,tt);
plot(tt,vAtt,
            'g','LineWidth'
            ,3)
hold
            on
            plot(tt,vBtt,
            'r','LineWidth'
            ,3)
plot(tt,vCtt,
            'm','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
legend(
            'v_A(t)','v_B(t)','v_C(t)'
            )
title (
            'D10-6MATLAB'
            )
          
        





(c)
          The Multisim simulation and results are shown below.
        





Answers:






(a)






(b)
          The MATLAB plots are shown above.
        

(c)
          The Multisim results are shown above.
        

(d)
          The MATLAB and Multisim results agree.
        


10-7.


          Use symbolic operations in MATLAB to solve for the node voltages in the circuit in the figure at the right. The circuit is in the zero state.
        





SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            sVA VBVC VDVSIS R1R2 C1C2 L
            ZL = s*L;
ZC1 = 1/s/Cl;
ZC2 = 1/s/C2;
            % Write the node-voltage equations
            Eqn1 = VA-VS;
Eqn2 = (VB-VA)/ZC1 + (VB-VD)/R1;
Eqn3 = (VC-VA)/ZL + VC/ZC2 + (VC-VD)/R2;
Eqn4 = (VD-VB)/R1 + (VD-VC)/R2 - IS;
            % Solve the equations
            Soln = solve(Eqn1,Eqn2,Eqn3,Eqn4,VA,VB,VC,VD);
VA= simplify(Soln.VA)
VB = simplify(Soln.VB)
VC = simplify(Soln.VC)
VD = simplify(Soln.VD)
pretty(VA)
pretty(VB)
pretty(VC)
pretty(VD)
__________________________________________________________________________________
VA =
VS
VB =
(VS + IS*R2 + IS*L*s + C1*L*VS*s^2 + C1*R1*VS*s + C1*R2*VS*s + C2*IS*L*R2*s^2 + C1*C2*L*R1*VS*s^3 + C1*C2*L*R2*VS*s^3)/ (C1*R1*s + C1*R2*s + C1*L*s^2 + C2*L*s^2 + C1*C2*L*R1*s^3 + C1*C2*L*R2*s^3 +1)
VC =
(VS + IS*L*s + C1*L*VS*s^2 + C1*R1*VS*s + C1*R2*VS*s + C1*IS*L*R1*s^2)/(C1*R1*s + C1*R2*s + C1*L*s^2 + C2*L*s^2 + C1*C2*L*R1*s^3 + C1*C2*L*R2*s^3 + 1)
VD =
(VS + IS*R2 + IS*L*s + C1*L*VS*s^2 + C1*R1*VS*s + C1*R2*VS*s + C1*IS*R1*R2*s + C1*IS*L*R1*s^2 + C2*IS*L*R2*s^2 + C1*C2*L*R2*VS*s^3 + C1*C2*IS*L*R1*R2*s^3)/(C1*R1*s + C1*R2*s + C1*L*s^2 + C2*L*s^2 + C1*C2*L*R1*s^3 + C1*C2*L*R2*s^3 + 1)
          
        

          
            VA = VS
       2    2
VB =
(VS + ISR2 + IS Ls + C1LVS s + C1R1VSs + C1R2VSs + C2ISLR2 s + C1
        3
C2 L R1 VS s +
    3     2    2     3
C1 C2 L R2 VS s) / (C1 R1 s + C1 R2 s + C1 L s + C2 L s + C1 C2 L R1 s + C1 C2
   3
LR2 s +1)
            
            2              2
VS + ISLS + C1LVS S + C1R1VSs + C1R2VSS + C1ISLR1 s
VC=--------------------------------------------------------
                 2    2    3   3
C1 R1 s + C1 R2 s + C1 L s + C2 L s + C1 C2 L R1 s + C1 C2 L R2 s + 1
                 2
VD =
(VS + IS R2 + IS L s + C1 L VS s + C1 R1 VS s + C1 R2 VS s + C1 IS R1 R2 s +
     2           2      3     3
C1 IS L R1 s + C2 IS L R2 s + C1 C2 L R2 VS s + C1 C2 IS L R1 R2 s) /
         2       2          3          3
(C1 R1 s+ C1 R2 s + C1 L s + C2 L s + C1 C2 LR1 s + C1 C2 LR2 s + 1)
          
        


Answer:


The MATLAB solution is presented above.


Chapter 11
This important chapter does not require very sophisticated software tools to solve the various problems covered. Since most of this chapter involve using literals, we will use MATLAB throughout, and it is especially useful in solving the convolution integral. Multisim is most useful in validating transfer function design in the last section of this chapter.


11-1.

          Use MATLAB to find the driving point impedance seen by the voltage source in the OP AMP circuit on the left and the voltage transfer function
          T
V
          (
          s
          ) =
          V
2
          (
          s
          )/
          V
1
          (
          s
          ).
        





SOLUTION:



          The input impedance is the parallel combination of the capacitor and resistor
          R
1
          .We can find the transfer function by treating the OP AMP as an inverting amplifier and finding the input and feedback impedances.
        

          
            clear
            all
            syms
            s R1 R2 R3 C V1 V2
            ZC = 1/s/C;
Zin = simplify(1/(1/R1 + 1/ZC))
Zf = simplify(1/(1/R2 + 1/R3));
Tv = simplify(-Zf/Zin)
__________________________________________________________________________________
Zin =
R1/(C*R1*s + 1) Tv =
-(R2*R3*(C*R1*S + 1))/(R1*(R2 + R3))
          
        





Answers:







11-2.

          Use MATLAB to find the voltage transfer function
          T
V
          (s) =
          
            V
            2
            /V
            1
            s
          
          ) of the cascade connection in the OP AMP circuit on the right. Locate the poles and zeros of the transfer function.
        


SOLUTION:




          The first part of the circuit (to the left of the port connection) can be analyzed as a voltage divider, since the OP AMP will not draw any current from it. The OP AMP is connected as a noninverting amplifier. We can multiply the individual transfer functions together to get the overall transfer function.
        

          
            clear
            all
            syms s T1 T2 Tv
            % R-C circuit
            ZC = 1/s/0.1e-6;
T1 = 20e3/(20e3 + ZC);
            % OP AMP circuit
            Z1 = 10e3;
Z2 = 10e3+1/s/0.2e-6;
T2 = (Z1+ Z2)/Z2;
            
              These very long numbers can obfuscate the transfer
            
            % Combine the results
            
              function. Using the following can shorten the string
            
            Tv = simplify(T1*T2)
            
              and make the function more readable:
              "Tv_num =
            
            Tv_num = vpa(Tv,6)
            
              vpa(Tv,6)."
              The
              "6"
              is the number of digits to
            
            Tv_num2 = simplify(Tv_num)
            
              represent, the rest is written in engineering notation.
            
            pretty(Tv_num)
__________________________________________________________________________________
            Tv =
(2*s*(590295810358705625*s + 147573952589676412928))/(590295810358705625*s^2 + 590295810358705638356*s +
147573952589676412928000)
            Tv_num =
(2.0*s*(5.90296e17*s + 1.47574e20))/(5.902 96e17*s^2 + 5.90296e20*s + 1.47574e23)
Tv_num2 =
(2.0*s*(590295810358706176.0*s + 147573952589676412928.0))/ (590295810358706176.0*s^2 + 5902958103587056 51712.0*s + 147573952589676412928000.0)
          
        




          5.90296e+17 s + 5.90296e+20 s + 1.47574e+23
        


Answers:



          Dividing numerator and denominator by 5.90296 x 10
          17
          yields
        




          There are two poles and both are located at
          s
          = - 500 rad/s. The zeros are located at
          s
          = 0 rad/s and - 250 rad/s.
        


11-3.

          Use MATLAB to find
          h(t
          ) and
          g(t
          ) for the circuit in the figure on the right.
        


SOLUTION:


The solution is presented in the following MATLAB code.





          
            clear
            all
            syms
            s t Ts Hs Gs ht gt
            R = 1e3;
L = 2;
C = 2e-6;
ZL = s*L;
ZC = 1/s/C;
Z1 = R + ZL;
Z2 =1/(1/R +1/ZC);
Ts = Z2/(Z1 + Z2);
ht = ilaplace(Ts);
ht_num = vpa(ht,6)
Gs = Ts/s;
gt = ilaplace(Gs);
gt_num = vpa((vpa(gt,6)),4)
__________________________________________________________________________________
ht_num =
500.0*exp(-500.0*t)*sin(500.0*t) gt_num =
0.5 - 0.5*exp(-500.0*t)*(cos(500.0*t) +1.0*sin(500.0*t))
          
        


Answers:







11-4.

          The step response of a linear circuit is
          g
          (
          t
          ) = 0.5[1 -
          e
−

            100
            t

          ]
          u
          (
          t
          ). Find the output waveform when the input is
          υ
1
          (
          t
          ) = [10
          e

            −200
            t

          ]
          u
          (
          t
          ). Use MATLAB to find the Laplace transforms of
          g
          (
          t
          ) and
          υ
1
          (
          t
          ). Then find
          V
2
          (
          s
          ). Finally, use the inverse Laplace function to find the waveform
          υ
2
          (
          t
          ) and plot the results.
        


SOLUTION:


The solution is presented in the following MATLAB code.




          
            clear
            all
            syms
            s t gt Gs Hs v1t V1s v2t V2s
            gt = 0.5*(1-exp(-100*t));
Gs = laplace(gt);
v1t = 10*exp(-200*t);
V1s = laplace(v1t);
Hs = s*Gs;
V2s = V1s*Hs
V2s2 = simplify(V2s)
v2t = ilaplace(V2s)
__________________________________________________________________________________
V2s =
-(10*s*(1/(2*(s + 100)) - 1/(2*s)))/(s + 200)
V2s2 =
50 0/(s^2 +30 0*s+20000)
v2t =
5*exp(-100*t) - 5*exp(-200*t)
            
            % Plot the output waveform
            tt = 0:50e-6:50e-3;
v2tt = subs(v2t,t,tt);
plot(tt,v2tt,
            'b','LineWidth'
            ,3)
grid
            on
            ;
xlabel(
            'Time (s)'
            );
ylabel(
            'Voltage (V)'
            )
title(
            'D11-4'
            )
          
        


Answer:



υ
2
          (
          t
          ) = 5[
          e

            −100
            t

          -
          e

            −200
            t

          ]
          u
          (
          t
          ) V
        


11-5.

          The Multisim circuit drawn in the figure below is in the steady state with
          i
          (
          t
          ) = 5 cos 1000
          t
          mA,
          R
          = 1 kΩ,
          L
          = 2 H, and
          C
          = 0.5 μF. Use Multisim to find
          i
2SS
          (
          t
          ). Repeat for
          i
1
          (
          t
          ) = 5 cos 10 k
          t
          mA.
        


SOLUTION AND ANSWERS:


Create the circuit in Multisim and run the simulations specified in the problem. Note that the current flows down through the current source in the schematic to follow the passive sign convention.
For a source frequency of 1000 rad/s or 159.15 Hz and for 10 krad/s or 1591.5, the results are






Variable
Frequency (Hz)
Magnitude
Phase (deg)




I(R1)
159.15
0.005
-180


I(R1)
1591.5
0.00099
101.4





Answers:



          At 1000 rad/s, the corresponding output signal is
          i

            2
            SS

          (
          t
          ) = 5 cos (1000
          t
          + 180°) mA. At 10 krad/s the corresponding output signal is
          i

            2
            SS

          (
          t
          ) = 0.990 cos (10 k
          t
          + 101.4°) mA.
        


11-6.

          The impulse response of a linear circuit is
          h
          (
          t
          ) = 400 [
          e

            −100
            t

          -
          e

            −400
            t

          ]
          u
          (
          t
          ). Use MATLAB to find the sinusoidal steady-state output for an input
          x
          (
          t
          ) = 5 cos 200
          t
          . Use MATLAB to plot
          y
          (
          t
          ).
        


SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            s t
            ht = 4 00*(exp(-100*t)-exp(-400*t));
Ts = laplace(ht);
            
            mx = 5;
            % Input Magnitude
            wx = 200;
            % Input Frequency
            px = 0;
            % Input Phase
            Tjw = subs(Ts,s,1i*wx);
Mag_y = mx*abs(Tjw)
Phase_y = px + 180*angle(Tjw)/pi
__________________________________________________________________________________
Mag_y =
6
Phase_y =
-90
            % Examine the results using another approach
            xt = 5*cos(200*t);
Xs = laplace(xt);
Ys = Xs*Ts;
yt = ilaplace(Ys)
__________________________________________________________________________________
yt =
4*exp(-400*t) - 4*exp(-100*t) +6*sin(200*t)
            % Plot the input and the output
            tt = 0:100e-6:100e-3;
xtt = subs(xt,t,tt);
ytt = subs(yt,t,tt);
plot(tt,xtt,
            'b','LineWidth'
            ,3)
hold on
plot(tt,ytt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Output'
            )
legend(
            'x(t)','y(t)'
            )
title(
            'D11-6'
            )
          
        



After the initial transient response (approximately 50 ms), the output signal has the correct amplitude and phase shift compared to the input signal.



Answer:





The MATLAB results are shown above.


11-7.

          The impulse response of a linear circuit is
          h
          (
          t
          ) = [
          u
          (
          t
          ) -
          u
          (
          t
          − 1)]. Use the convolution integral to find the response due to an input
          x
          (
          t
          ) =
          u
          (
          t
          ) -
          u
          (
          t
          − 2).
        


SOLUTION:


The solution is presented in the following MATLAB code.

          
            syms
            s
            syms
            t tau real
            syms
            T positive
            % Create the impulse response and the input signal
            ht = heaviside(t)-heaviside(t-1);
xt = heaviside(t)-heaviside(t-2);
            % Convert the signals to the convolution integral form
            httau = subs(ht,t,T-tau);
xtau = subs(xt,t,tau);
hx = expand(httau*xtau)
            % Perform the convolution integral to generate the output
            yt = int(hx,tau,0,T)
            % Check the results using Laplace techniques
            Hs = laplace(ht);
Xs = laplace(xt);
Ys = Xs*Hs;
ytCheck = ilaplace(Ys)
__________________________________________________________________________________
hx =
heaviside(tau)*heaviside(T - tau) - heaviside(tau)*heaviside (T - tau - 1) - heaviside(tau - 2)*heaviside(T - tau) + heaviside (tau - 2)*heaviside(T - tau - 1)
yt =
T - heaviside(T - 1)*(T - 1) - heaviside(T - 2)*(T - 2) + heaviside (T - 3)*(T - 3) ytCheck =
t - heaviside(t - 1)*(t - 1) - heaviside(t - 2)*(t - 2) + heaviside (t - 3)*(t - 3)
          
        

          The output signal is zero for
          t
          <0.
        


Answer:







11-8.

          The impulse response of a linear circuit is
          h
          (
          t
          ) =2e
          
            −
            t

u
          (
          t
          ). Use the convolution integral to find the response due to an input
          x
          (
          t
          ) =
          tu(t
          ).
        



SOLUTION:


The solution is presented in the following MATLAB code.

          
            clear
            all
            syms
            s
            syms
            t tau real
            syms
            T positive
            % Create the impulse response and the input signal
            ht = 2*exp(-t)*heaviside(t);
xt = t*heaviside(t);
            % Convert the signals to the convolution integral form
            httau = subs(ht,t,T-tau);
xtau = subs(xt,t,tau);
hx = simplify(httau*xtau);
            % Perform the convolution integral to generate the output
            yt = simplify(int(hx,tau,0,T))
            % Check the results using Laplace techniques
            Hs = laplace(ht);
Xs = laplace(xt);
Ys = Xs*Hs;
yt2 = ilaplace(Ys)
__________________________________________________________________________________
yt =
2*T + 2*exp(-T) - 2
yt2 =
2*t + 2*exp(-t) - 2
          
        


Answer:







11-9.

          A circuit is needed that will take an input of
          υ
1
          (
          t
          ) = 2 e
          
            −100
            t

u(t)
          V and produce an output of
          υ
2
          (
          t
          ) = 5
          e

            −1000
            t

u
          (
          t
          ) V. Design such a circuit with practical part values using MATLAB. Validate your design by using Multisim.
        


SOLUTION:


Convert the input and output into the Laplace domain and divide the results to determine the transfer function. We can then design an appropriate circuit.

          
            clear
            all
            syms
            s t
            vlt = 2*exp(-100*t);
v2t = 5*exp(-1000*t);
Vls = laplace(v1t);
V2s = laplace(v2t);
Ts = V2s/V1s
pretty(Ts)
__________________________________________________________________________________
Ts =
            
          
        

The resulting transfer function is expanded in a more convenient format below.




          We can now create a circuit to realize the transfer function. We need to scale the output stage by
          k
          = 10
          4
          to have more practical values. The resulting circuit is shown below.
        





Answers:


The final circuit and its response are above.


Chapter 12

          This chapter deals with the analysis and design of simple filters. Both MATLAB and Multisim find great utility in this chapter. We will look at solving problems using Multisim's ac sweep analysis capabilities and see how to perform logarithmic sweeps in MATLAB using logspace. We will also construct Bode diagrams using MATLAB's
          bode
          and
          bodemag
          routines.
        


12-1.

          Find the transfer function
          T
v
          (
          s
          ) =
          V
2
          (
          s
          )/
          V
1
          (
          s
          ) of the circuit shown using MATLAB.
        

(a)
          Find the dc gain, infinite frequency gain, and cutoff frequency. Identify the type of gain response.
        

(b)
          Plot the actual response using MATLAB and calculate the gain at ω = 0.5ω
          c
          , ω
          c
          , and 2ω
          c


(c)
          Use Multisim to plot the Bode magnitude gain and phase response of the circuit. Validate your answers for part (b).
        





SOLUTION:


The following MATLAB calculations yield the circuit's transfer function.


          
            clear
            all
            syms
            s
            L = 100e-3;
R1 = 50;
R2 = 100;
ZL = S*L;
T = simplify(R2/(R1+ ZL + R2));
pretty(T)
__________________________________________________________________________________
            
          
        

(a)
          By inspection of the transfer function, we can determine the dc gain is 1000/1500 = 2/3 and that the infinite frequency gain is zero. The cutoff frequency is 1500 rad/s. The circuit is a low-pass filter.
        

(b)
          The following MATLAB script plots the actual responses. Note the use of the MATLAB call:
          
            logspace (
            a,b,n
            ),
          
          where
          a
          is the exponent of 10 of the starting frequency, that is, 10
          
a

          , and
          
b

          is the exponent of 10 of the ending frequency, that is, 10
          
b

          , and
          n
          is the number of points or calculations between the start and end points.
        

          
            % Create the gain responses
            ww = logspace(1,5,50 0);
Tjw = subs(T,1,1i*ww);
MagTjw = abs(Tjw);
MagTjwdB = 20*log10(MagTjw);
PhaseTjw = 180*angle(Tjw)/pi;
            % Plot the gain response
            semilogx(ww,MagTjwdB,
            'r','LineWidth'
            ,3)
grid
            on
            hold
            on
            xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Magnitude, (dB)'
            )
title(
            'D12-1 (Magnitude)'
            )
            % Create the phase response
            PhaseTjw = 180*angle(Tjw)/pi;
            % Plot the phase response
            figure
semilogx(ww,PhaseTjw,
            'r','LineWidth'
            ,3)
grid
            on
            hold
            on
            xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Phase, (degrees)'
            )
title(
            'D12-1 (Phase)'
            )
          
        


This tells MATLAB to sweep the variable
            ww
            
              from 10
              1
              or 10, to 10
              5
              or 100,000, using 500 calculations overall.
            










          We can use MATLAB to calculate the gain at ω = 0.5ω
          c
          ,
          ω
c
          , and 2ω
          c
          .
        

          
            % Calculate the requested gains
            wc = 1500;
w2 = wc*[0.5 1 2];
Tw2 = subs(T,s,1i*w2);
MagTw2 = abs(Tw2);
Results = [w2' MagTw2']
__________________________________________________________________________________
 Results =
 [750, (4*45*(l/2))/45]
 [1500, 2*(1/2)/3]
 [3000, (2*45*(1/2))/45]
          
        


Answers:






(c)

          The Multisim simulation and resulting Bode magnitude gain and phase response are shown below.
        
The horizontal axis in the Multisim simulation always has units of hertz, which differs from the MATLAB simulation with units of rad/s. We can adjust the MATLAB simulation to have units of hertz. The resulting plot is shown below and agrees with the Multisim simulation.




          
            % Plot the gain response with frequency units of hertz
            figure
semilogx(ww/2/pi,MagTjwdB,
            'r','LineWidth'
            ,3)
grid
            on
            hold
            on
            xlabel(
            'Frequency, (Hz)'
            )
ylabel(
            'Magnitude, (dB)'
            )
title(
            'Gain Response in Hertz (MATLAB)'
            )
          
        






Answers:






(a)
          |
          T
V
          (0)| = 2/3, |
          T
V
          (∞)| = 0, ω
          c
          = 1500 rad/s, low pass
        

(b)
          The plots are shown above.
        

(c)
          |
          T
V
          (0.5ɷ
          c
          )| = 0.5963, |
          T
V
          (ω
          c
          )| = 0.4714, |
          T
V
          (2ω
          c
          )| = 0.2981
        

(d)
          The Multisim simulation and results are shown above.
        


12-2.

          There is a need for a design of a band-stop filter centered at 100 Hz that has the following transfer function ±2%:
        



A vendor has submitted the circuit shown below claiming that the design meets the specifications within ±1%. Is the vendor's claim accurate?





SOLUTION:


We start by visualizing the frequency response of the desired transfer function using the MATLAB function bode. To do so, we start by expanding the numerator and denominator of the desired transfer function as follows:



We can then use the function tf to define the transfer function in terms of the coefficients in the numerator and the denominator:

          T = tf([4 800 1600000],[1 4100 400000]);
        

          Although not in this case, if a coefficient of
          s
          is a zero, we would include the zero as a term. Since we want to plot the response over several decades, we define a frequency variable w as a log vector using the logspace function. We will sweep the frequencies from 10
          1
          to 10
          5
          rad/s and ask MATLAB to calculate a total of 1000 points, that is,
          w = logspace (1,5,1000);


          Next, we call the bode function. For this problem, we want to display only the magnitude of the frequency response, so we use bodemag. We tell MATLAB to plot
          
          the magnitude of the transfer function over the desired frequency range and turn the grid on.
        

          bodemag(T,w);
grid on
        
MATLAB returns the frequency response plot in dB versus rad/s. Clicking on the horizontal axis allows you to choose "Frequency (Hz)" as the units. The frequency response shown in the MATLAB plot is a visualization of the desired specification. MATLAB shows that the notch occurs at 101 Hz, which is within 1% of the desired value.







We can now build the proposed circuit in Multisim and see if it performs as stated. After we construct the circuit, we do an AC analysis. We swept from 2 Hz to 20 kHz using 1000 points per decade. We then used the cursor to find the 3 dB points and the depth of the notch.
The responses for both the MATLAB plot and the Multisim plots are shown in the figure above and are compared in the table below.
The results show that the vendor's claim was accurate.



Parameter

MATLAB


Multisim





Center frequency (Hz)
101
100.7


Lower cutoff frequency (Hz)
15.3
15.3


Upper cutoff frequency (Hz)
662
661.7


Bandwidth (Hz)
646.7
646.4


Passband gain (dB)
12.00
12.00


Gain at center frequency (dB)
-14.20
-1419


Attenuation (dB)
- 26.20
- 2619





12-3.

          The OP AMP circuit shown produces a bandpass response for a suitable choice of element values. Identify the elements that control the two cutoff frequencies. Select the element values so that the passband gain is 30 and the cutoff frequencies are 100 rad/s and 5000 rad/s, all within 5%. Use practical element values with
          R
          ≥ 10 kΩ and
          C
          ≤ 1 μF. Use Multisim to validate your design.
        





SOLUTION:



          The circuit has three stages: (1) a low-pass filter, (2) a gain stage, and (3) a high-pass filter. Components R
          1
          and
          C
1
          control the cutoff frequency of the low-pass filter, which is responsible for the higher cutoff frequency or 5000 rad/s. Components
          
r
            2
          
          and
          
c
            2
          
          control the cutoff frequency of the high-pass filter, which is responsible for the lower cutoff frequency or 100 rad/s. Components R
          3
          and R
          4
          control the gain through a noninverting amplifier.
        
Select both capacitors to be 001 μF and calculate the required resistor values to realize the desired cutoff frequencies.

          
            clear
            all
            wcLow =100;
wcHigh = 5000;
C = 0.01e-6;
R1= 1/C/wcHigh
R2 = 1/C/wcLow
__________________________________________________________________________________
R1 =
 20.0000e+003
R2 =
 1.0000e+006
          
        





          The circuit drawn in Multisim will meet the specifications within 5%. The simulation results are shown above. Note that the closer the cutoff frequencies are the more difficult, indeed, it is impossible to achieve the desired specifications using first-order circuits. We can get around these limitations by using multiple-order filter designs covered in
          Chapter 14
          or adding a gain stage. The next example shows this in more detail.
        


Answers:


The circuit design and simulation results are shown above.


12-4.

          The following problem involves a cascade connection of two first-order passive circuits separated by a noninverting OP AMP. The source has a 50-Ω, series resistor and the output of the filter feeds a 10-k£2 load. Design a bandpass circuit with the following specifications all ±5%
          f
CL
          = 2 kHz,
          f
CH
          = 10 kHz,
          
B

          = 8 kHz. Passband gain 20 dB. Use Multisim to validate your results. Explain why one cannot achieve the desired specifications.
        


SOLUTION:



          We will design each stage and run a simulation. We will determine where there is a problem and try to compensate for it. Start by making the low-pass filter the first
          
          stage of the circuit. It will be responsible for the upper cutoff frequency of 10 kHz = 20n krad/s, and we will choose the resistance value such that the source resistance is not a significant factor. The noninverting amplifier will provide the gain of 20 dB, which is equivalent to an absolute gain of 10. The high-pass filter will be the third stage and it will use the 10-kΩ2 load as part of its design to achieve the lower cutoff frequency of 2kHz = 4π krad/s. Compute the component values and then construct and simulate the circuit.
        

          
            clear
            all
            disp(
            'Low pass filter'
            )
wcHigh = 2*pi*10e3;
C = 10e-12
R = 1/C/wcHigh
disp(
            'High pass filter'
            )
wcLow = 2*pi*2e3;
R = 10e3
C = 1/R/wcLow
__________________________________________________________________________________
Low pass filter
C=
 10.0000e-012
R=
 1.5915e+006
High pass filter
R=
 10.0000e+003
C=
 7.9577e-009
          
        
Round the calculated values and verify that the resulting filters still meet the specifications.

          R1 = 1.6e6
C1 = 10e-12
fchigh = 1/R1/C1/2/pi
R2 = 10e3
C2 = 8e-9
fclow = 1/R2/C2/2/pi
BW = fchigh-fclow
__________________________________________________________________________________
R1 =
 1.6000e+006
C1 =
 10.0000e-012
fchigh =
 9.9472e+003
R2 =
 10.0000e+003
C2 =
 8.0000e-009
fclow =
 1.9894e+003
BW =
 7.9577e+003
        


          We must meet all specifications within 5%, so establish the acceptable ranges for the frequencies and bandwidth.
        

          range = [0.95 1.05];
fclowRange = 2e3*range
fchighRange = 10e3*range
BWRange = 8e3*range
__________________________________________________________________________________
fclowRange =
 1.9000e+003   2.1000e+003
fchighRange =
 9.5000e+003  10.5000e+003
BWRange =
 7.6000e+003   8.4000e+003
        



All of the frequency values are within specifications. The resulting circuit drawn in Multisim is shown above. The simulation results are shown below.



The simulation shows that the circuit does not meet all of the specifications. The passband gain is not within 5% of 20 dB. If we increase the gain in the noninverting amplifier stage to achieve a passband gain of 20 dB (Gain of 12), then the resulting magnitude gain response is as shown below.

          With this magnitude response, the cutoff frequencies are not correct and the bandwidth is too large. We cannot achieve the specifications because the cutoff
          
          frequencies are too close to each other for a pair of first-order filters. We will see that this problem involves the ratio of the circuit's center frequency and its bandwidth, which we call Q. We can only achieve
          
Q

          values much less than one with second-order circuits. The
          Q
          of this circuit was
          



Answer:



          The circuit design and simulation results are presented above. The circuit cannot meet the specifications because the required
          
Q

          is too large.
        


12-5.

          A series
          
RLC

          bandpass filter is required to have resonance at
          f
0
          = 50 kHz. The circuit is driven by a sinusoidal source with a Thevenin resistance of 60 Ω. The following standard capacitors are available in the stock room: 1 μF, 0.68 μF, 0.47 μF, 0.33 μF, 0.2 μF, and 0.12 μF. The inductor will be custom-designed to match the capacitor used. Select the available capacitor that minimizes the filter bandwidth.
        


SOLUTION:



          In a series
          
RLC

          circuit, the bandwidth is
          
B

          =
          R/L
          , and the center frequency is ɷ
          0
2
          = 1/
          LC
          . To minimize the bandwidth, we need to maximize the value of the inductor. The center frequency is fixed, so to maximize
          L
          , we need to minimize
          C
          . Choose
          
C

          = 0.12 μF.
        
Use MATLAB to verify the results by calculating the bandwidth for all of the possible capacitor values.

          
            clear
            all
            R = 60;
w0 = 2*pi*50e3; w02 = w0*2;
C = [1e-6 680e-9 470e-9 330e-9 200e-9 120e-9];
L = 1/w02./C;
B = R./L;
disp(
            '	C	 L	 B'
            )
            
            Results = [C' L' B']
__________________________________________________________________________________
     C		  L		 B
Results =
  1.0000e-006 10.1321e-006 5.9218e+006
680.0000e-009 14.9002e-006 4.0268e+006
470.0000e-009 21.5577e-006 2.7832e+006
330.0000e-009 30.7034e-006 1.9542e+006
200.0000e-009 50.6606e-006 1.1844e+006
120.0000e-009 84.4343e-006 710.6115e+003
          
        


Answer:



C
          = 0.12 μF
        


12-6.

          Show that the transfer function
          T
V
          (
          s
          ) =
          V
2
          (
          s
          )/V
          1
          (
          s
          ) of the circuit in the figure to the left has a bandstop filter characteristic. Derive expressions relating the notch frequency and the cutoff frequencies to
          R
          ,
          L
          , and
          C
          . Then select values of
          R
          ,
          L
          , and
          C
          so that the bandwidth and the center frequency are both 1 krad/s. Validate your design using Multisim.
        


SOLUTION:


Use MATLAB to determine the transfer function.

          
            clear
            all
            syms
            s
            syms
            R L C positive
            ZL = s*L;
ZC = 1/s/C;
Z1 =1/(1/ZL +1/ZC);
Z2 = R;
Ts = (Z2/ (Z1 + Z2));
Ts2 = simplify(Ts)
__________________________________________________________________________________
Ts2 =
(R*(C*L*s^2 + 1))/(C*L*R*s^2 + L*s + R)
          
        




          The transfer function has the form of a bandstop filter. The notch frequency occurs at the zero of the transfer function, which is at
          s
2
          = -1/
          LC
          . When we substitute
          s
          =
          j
          ɷ, this yields
        




          At both low and high frequencies, the gain of the transfer function is one. To find the cutoff frequencies, we need to find when the transfer function has a gain of 0.7071. Substitute
          s
          =
          j
          ɷ and use MATLAB to find the cutoff frequencies.
        

          
            syms
            wc real
            Tjw = subs(Ts,s,1i*wc);
Eqn2 = Tjw*conj (Tjw)-1/2;
Soln2 =simplify(solve(Eqn2,wc))
__________________________________________________________________________________
            
            Soln2 =
-((4*C*R^2 + L)^(1/2) - L^(1/2))/(2*C*L^(1/2)*R)
 ((4*C*R^2 + L)^(1/2) - L^(1/2))/(2*C*L^(1/2)*R)
-((4*C*R^2 + L)^(1/2) + L^(1/2))/(2*C*L^(1/2)*R)
 ((4*C*R^2 + L)^(1/2) + L^(1/2))/(2*C*L^(1/2)*R)
          
        
Choose the positive solutions since negative frequencies have no physical meaning.



and




          The bandwidth is the difference between the cutoff frequencies,
          
B

          = 11RC. Choose a value for the resistor and calculate the other values.
        

          B = 1e3;
w0 = 1e3;
w02 = w0^2;
R = 1e3
C = 1/R/B
L = 1/C/w02
__________________________________________________________________________________
R=
 1.0000e+003
C=
 1.0000e-006
L=
 1.0000e+000
        



The Multisim circuit is shown above and its simulation results are shown below.






Answers:





The circuit design and simulation results are presented above.


12-7.

          Find the transfer function
          T
V
          (
          s
          ) =
          V
2
          (
          s
          )/
          V
1
          (
          s
          ) for the circuit on the left.
        

(a)
          Use MATLAB to generate a Bode plot of your transfer function.
        

(b)
          Calculate the output amplitude and phase for
          υ
1
          (
          t
          ) = 10 sin 30
          t
          V.
        





SOLUTION:


The following MATLAB calculations determine the transfer function and create the Bode plot.

          
            clear
            all
            syms s
C = 1e-6;
R1 = 100e3;
R2 = 10e3;
ZC = 1/s/C;
Z1 = 1/(1/ZC +1/R1);
Z2 = R2;
T = simplify(Z2/(Z1+ Z2))
pretty(T)
          
        

          
            % Plot the gain response
            ww = logspace(-1,4,500);
Tjw = subs(T,s,1i*ww);
MagTjw = abs(Tjw);
MagTjwdB = 20*log10(MagTjw);
figure
semilogx(ww,MagTjwdB,
            'r','LineWidth'
            ,3)
grid
            on
            hold
            on
            xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Magnitude, (dB)'
            )
title(
            'D12-7 (Magnitude)(MATLAB)'
            )
          
        








          
            % Plot the phase response
            PhaseTjw = 180*angle(Tjw)/pi;
figure
semilogx(ww,PhaseTjw,
            'r','LineWidth'
            ,3)
grid
            on
            
            hold
            on
            xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Phase, (degrees)'
            )
title(
            'D12-7 (Phase) (MATLAB)'
            )
          
        

          
            % Determine the output magnitude and phase
            % for the given input signal
            MagIn = 10;
PhaseIn = -90;
win = 30;
            % Evaluate the transfer function at the
            % input frequency
            Tjin = subs(T,s,1i*wIn);
MagTjIn = abs(TjIn);
MagOut = double(MagIn*MagTjIn)
PhaseOut = double(PhaseIn + 180*angle(TjIn)/pi)
          
        

          MATLAB returns the following
T=
(s + 10)/(s + 110) s + 10
-------
s + 110
        

          MagOut =
 2.7735e+000
PhaseOut =
 -33.6901e+000
        


Answers:






(a)
          The MATLAB plots are shown above.
        

(b)
A
ACTUAL
          = 2.7735 V and
          ϕ
ACTUAL
          = -33.69°.
        


12-8.

          For the following transfer function:
        




(a)
          Use MATLAB to plot the Bode magnitude of the transfer function.
        

(b)
          Design a circuit using practical values for the components that has the same transfer function.
        

(c)
          Use Multisim to compare the frequency response of your designed circuit with the MATLAB Bode plot.
        


SOLUTION:




(a)
          Plot the Bode magnitude of the transfer function.
        




          
            clear
            all
            % Create the gain responses syms s
            T = (s + 100)/(s + 10)/(s + 1000);
ww = logspace(-1,5,1000);
Tjw = subs(T,s,1i*ww);
MagTjw = abs(Tjw);
MagTjwdB = 20*log10(MagTjw);
            % Plot the actual gain response
            semilogx(ww/2/pi,MagTjwdB,
            'r','LineWidth'
            ,3)
grid
            on
            hold
            on
            axis([1e-1 1e4 -100 -40]);
xlabel(
            'Frequency, (Hz)'
            )
ylabel(
            'Magnitude, (dB)'
            )
title(
            'D12-8 (MATLAB)'
            )
          
        
This is a low-pass filter with a cutoff frequency of 10 rad/sec and a passband gain of about -40 dB.

(b)
          To design the circuit we write the transfer function as follows:
        





          Using the techniques from
          Chapter 11
          , we can create the following circuit.
        




(c)
          The Multisim simulation results are shown below and agree with the MATLAB results.
        





Answers:



(a)
          This is a low-pass filter with a cutoff frequency of 10 rad/s and a passband gain of approximately - 40 dB. The MATLAB plot is shown above.
        

(b)
          The circuit is shown above.
        

(c)
          The simulation results are shown above and match the MATLAB results.
        


12-9.


          Consider the gain plot on the right.
        

(a)
          Find the transfer function corresponding to the straight-line gain plot.
        

(b)
          Use MATLAB to plot the Bode magnitude of the transfer function.
        

(c)
          Compare the straight-line gain and the actual gain at ω = 10 and 400 rad/s.
        





SOLUTION:



(a)
          Since the gain plot is horizontal for low frequencies, there are no poles or zeros at 0 rad/s. Based on the changes in the plot, a single pole occurs at 20 rad/s and a single zero at 200 rad/s. The transfer function takes the following form:
        




          The high-frequency gain is 0 dB, which is an absolute gain of one, so
          
k

          = 1.
        

(b)
          Plot the Bode magnitude of the transfer function.
        




          
            clear
            all
            % Create the actual gain response syms s
            T = (s + 200)/(s + 20);
ww = logspace(0,4,1000);
Tjw = subs(T,s,1i*ww);
MagTjw = abs(Tjw);
MagTjwdB = 20*log10(MagTjw);
semilogx(ww,MagTjwdB,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Magnitude, (dB)'
            )
title(
            'D12-9'
            )
          
        

(c)

          The straight-line gain at ɷ = 10 rad/s is 20 dB and the straight-line gain at ɷ = 400 rad/s is 0 dB. Compute the actual gains at ɷ = 10 rad/s and ɷ = 400 rad/s.
        

          ww = [10 400];
Tjww = subs(T,s,1i*ww);
MagTjww = double(abs(Tjww))
MagTjwwdB = double(20*log10(MagTjww))
        
        MATLAB returns
        
          MagTjww =
 8.9554e+000 1.1166e+000
MagTjwwdB =
 19.0417e+000 958.2563e-003
        


Answers:



(a)



(b)
          The MATLAB results are shown above.
        

(c)
          For ɷ = 10 rad/s, the straight-line gain is 20 dB and the actual gain is 19.0417 dB. For ɷ = 400 rad/s, the straight-line gain is 0 dB and the actual gain is 0.9583 dB. The straight-line gain is a reasonably good approximation at these two frequencies.
        


12-10.

          The transfer function of a linear circuit is
          


(a)
          Is the circuit a low-pass, high-pass, bandpass, or bandstop filter?
        

(b)
          Use MATLAB to plot the Bode magnitude and step responses.
        

(c)
          Design a circuit to achieve the transfer function.
        

(d)
          Use Multisim to verify the step and frequency responses.
        


SOLUTION:



(a)
          The circuit is a bandpass filter.
        

(b)
          Plot the Bode magnitude response and the step response using MATLAB.
        

          
            clear
            all
            syms
            s t
            T=7800*s/(s+50)/(s+2000);
            % Create the gain response
            ww = logspace(-1,6,2000);
Tjw = subs(T,s,1i*ww);
          
        

          MagTjw = abs(Tjw);
MagTjwdB = 20*log10(MagTjw);
        





          
            % Plot the gain response
            semilogx(ww/2/pi,MagTjwdB,
            'r','LineWidth'
            ,3)
grid
            on
            hold
            on
            axis([.1,1e5,-40,20]);
xlabel(
            'Frequency, (Hz)'
            )
ylabel(
            'Magnitude, (dB)'
            )
title(
            'D12-10 (frequency response) (MATLAB)'
            )
          
        

          
            % Plot the step response Gs = T/s;
            gt = ilaplace(Gs);
            %close all
            tt = 0:120e-6:120e-3; gtt = subs(gt,t,tt);
figure
plot(tt,gtt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Step Response'
            )
title(
            'D12-10 (step response) (MATLAB)'
            )
          
        
The cutoff frequencies are approximately 50 rad/s and 2000 rad/s. The passband gain is 3.9 = 11.82 dB.





(c)
          To design the circuit rewrite the transfer function as follows:
        



The following circuit will realize the transfer function:




(d)
          The following Multisim simulation results validate the circuit design.
        









Answers:



(a)
          Bandpass filter.
        

(b)
          The plots are shown above. The cutoff frequencies are approximately 50 rad/s and 2000 rad/s. The passband gain is 3.9 = 11.82 dB.
        

(c)
          The circuit is presented above.
        

(d)
          The Multisim results are presented above and they verify the step and frequency responses.
        


12-11.

          The straight-line gain response of a linear circuit is shown on the right. What are the initial and final values of the circuit step response? What is the approximate duration of the transient response?
        





SOLUTION:



          First, find the transfer function corresponding to the straight-line gain response. The circuit has a pole located at 20 rad/s and a zero at 200 rad/s. The high-frequency gain is 0 dB, so we can write the following transfer function as
          

The step response is calculated below.

          
            clear
            all
            syms
            s t
            Ts = (s + 200)/ (s + 20);
Gs = Ts/s;
gt = ilaplace(Gs)
__________________________________________________________________________________
gt =
10 - 9*exp(-20*t)
          
        


          We can find the initial and final values by taking the appropriate limits
        

          IV = limit(gt,t,0)
FV = limit(gt,t,inf)
__________________________________________________________________________________
IV =
1
FV =
10
        

          The time constant for the step response is
          T
C
          = 1/20 s. The duration of the transient response is approximately 5
          T
C
          = 5/20 s = 250 ms.
        


Answers:





The duration of the transient response is approximately 250 ms.


12-12.

          There is a need for a passive notch filter at 10 krad/s. The narrower the notch the better, but there should be minimal ringing of the signals passing through. The transforms of three filters were submitted for consideration. Which would you recommend and why?
        





SOLUTION:


Plot the magnitude response and the step response for each signal.








          
            clear
            all
            syms
            s t
            % Form the transfer functions
            T1 = (s^2+100*s+1e8)/(s^2+1e4*s+1e8);
T2 = (s^2+500*s+1e8)/(s^2+2500*s+1e8);
T3 = (s^2+1e8)/(s^2+5000*s+1e8);
            % Find the step responses
            gl = ilaplace(T1/s);
g2 = ilaplace(T2/s);
g3 = ilaplace(T3/s);
            % Compute the magnitude responses and plot them
            ww = logspace(3,5,2000);
MagTljwdB = 20*log10(abs(subs(T1,s,1i*ww)));
MagT2jwdB = 20*log10(abs(subs(T2,s,1i*ww)));
MagT3jwdB = 20*log10(abs(subs(T3,s,1i*ww)));
            % Plot the actual gain responses
            semilogx(ww,MagT1jwdB,
            'g','LineWidth'
            ,3)
grid
            on
            hold
            on
            semilogx(ww,MagT2jwdB,
            'r','LineWidth'
            ,3)
semilogx(ww,MagT3jwdB,
            'b','LineWidth'
            ,3)
xlabel(
            'Frequency, (rad/s)'
            )
ylabel(
            'Magnitude, (dB)'
            )
legend(
            'T1','T2','T3'
            )
title(
            'D12-11 (frequency response)'
            )
          
        

          
            % Plot the step responses
            tt = 0:2e-6:2e-3;
gltt = subs(g1,t,tt);
g2tt = subs(g2,t,tt);
            
            g3tt = subs(g3,t,tt);
figure
          
        

          
            plot(tt,g1tt,
            'g','LineWidth'
            ,3)
grid
            on
            hold
            on
            plot(tt,g2tt,
            'r','LineWidth'
            ,3)
plot(tt,g3tt,
            'b','LineWidth'
            ,3)
xlabel(
            'Time (s)'
            )
ylabel(
            'Step Response'
            )
legend(
            'T1','T2','T3'
            )
title(
            'D12-11 (step response)'
            )
          
        


Answer:



T
2
          (
          s
          ) has the narrowest notch and the lowest amplitude ringing.
        


Chapter 13
This chapter involves Fourier series. The examples with Fourier series are very useful in understanding why we can filter complex periodic signals and still be able to restore information seemingly lost. This chapter makes excellent use of MATLAB.


13-1.

          The equation for the first cycle (0 ≤
          t
          ≤
          T
0
          ) of a periodic waveform is
          υ
          (
          t
          ) =
          V
A
          e
          
            −5
            t
            /
            T
            0
          
          V
        

(a)
          Sketch the first two cycles of the waveform.
        

(b)
          Derive expressions for the Fourier coefficients
          a
n
          and
          
            b
            n
            .
          



SOLUTION:



(a)
          Use MATLAB to plot the waveform with both
          V
A
          and
          T
0
          normalized to values of one.
        

          
            clear
            all
            VA = 1;
T0 = 1;
syms
            t
            vt = VA*exp(-5*t/T0)*(heaviside(t)-heaviside(t-T0))...
  + VA*exp(-5*(t-T0)/T0)*(heaviside(t-T0) ...
  -heaviside(t-2*T0));
tt = 0:T0/1000:2*T0;
vtt = subs(vt,t,tt + eps);
plot(tt,vtt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D13-1'
            )
          
        

(b)
          Compute the Fourier coefficients
        

          
            syms
            t VA real
            syms
            T0 positive
            syms
            n positive integer
            vt = VA*exp(-5*t/T0);
            
            a0 = int(vt,t,0,T0)/T0
an = simplify(2*int(vt*cos
(2*pi*n*t/T0),t,0,T0)/T0)
bn = simplify(2*int(vt*sin
(2*pi*n*t/T0),t,0,T0)/T0)
__________________________________________________________________________________
a0 =
-(VA*(exp(-5) - 1))/5 an =
(2*VA*exp(-5)*(5*exp(5) -5))/ (4*n^2*pi^2 + 25)
bn =
(4*VA*n*pi*exp(-5)*(exp(5) -1))/ (4*n^2*pi^2 + 25)
          
        




          Since
          n
          is an integer, it is always true that cos (2π
          n
          ) = 1 and sin (2π
          n
          ) = 0. We can use this information to simplify the expressions generated above.
        


Answer:



(a)
          The sketch is shown above.
        

(b)




13-2.

          Use the Fourier coefficients results in
          Figure 13-4
          to calculate the Fourier coefficients of the shifted triangular wave on the right. Write an expression for the first four nonzero terms in the Fourier series.
        


SOLUTION:



          For a nonshifted triangular wave, only the
          a
n
          coefficients are nonzero. The triangular wave is shifted by -
          T
0
          /4 in our figure. We can use the following equivalent expressions to find the coefficients for a shifted version of the triangular wave.
        







          
            clear
            all
            syms
            t real
            A = 40;
T0 = 2e-3;
n = [13 5 7];
bn = 8*A/pi^2./(n.^2).*sin(pi*n/2)
sn = sin(2*pi*n*t/T0)
vn = vpa(bn*sn',5)
__________________________________________________________________________________
            
            bn =
 32.4228 -3.6025 1.2969 -0.6617
sn =
 [sin(1000*pi*t), sin(3000*pi*t),
 sin(5000*pi*t), sin(7000*pi*t)]
vn =
 32.423*sin(3141.6*t) - 0.66169*sin
 (21991.0*t) - 3.6025*sin(9424.8*t) + 1.2969*sin(15708.0*t)
          
        



Plot the results to verify the waveform has the correct form.

          
            tt = 0:4e-6:4e-3;
vtt = subs(vn,t,tt);
plot(tt,vtt,
            'r','LineWidth'
            ,3)
grid
            on
            xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
title(
            'D13-1'
            )
          
        


Answer:







13-3.

          Given a sawtooth wave with amplitude
          
A

          = 16 and period
          T
0
          = 250 μs, use the results in
          Figure 13-4
          to write an expression for the first four nonzero terms in the Fourier series and plot the amplitude spectrum of the signal. Use MATLAB to plot two periods of the original signal and an estimate for the signal using the first four nonzero terms in the Fourier series. Comment on the differences between the two waveforms.
        


SOLUTION:


We can calculate the coefficients as follows:

          
            clear
            all
            syms
            t real
            A = 16;
T0 = 1/4e3;
a0 = A/2;
n = [1 2 3 4];
bn = -A./n/pi
sn = sin(2*pi*n*t/T0)
vn = vpa(a0+bn*sn',5)
__________________________________________________________________________________
bn =
 -5.0930 -2.5465 -1.6977 -1.2732
sn =
[sin(8000*pi*t), sin(16000*pi*t), sin(24000*pi*t), sin
(32000*pi*t)]
            
            vn =
8.0 - 5.093*sin(25133.0*t) - 2.5465*sin (50265.0*t) - 1.2732*sin(100533.0*t) -1.6977*sin(75398.0*t)
          
        
Plot the amplitude spectrum.

          
            % Create vectors for the frequencies
            % and amplitudes
            ff = [0 n/T0];
aa = abs([a0 bn]);
            % Plot the spectrum
            stem(ff,aa,
            'r','LineWidth'
            ,3,...
            'MarkerSize'
            ,10,...
            'MarkerFaceColor','r'
            )
grid
            on
            xlabel(
            'Frequency, (Hz)'
            )
ylabel(
            'Amplitude'
            )
title(
            'D13-2 (amplitude spectrum)'
            )
          
        



Plot the results to verify the waveform has the correct form.

          
            tt = 0:500e-9:500e-6;
vtt = subs(vn,t,tt);
            % Construct the actual signal
            m = A/T0;
gt = m*t*heaviside(t)-...
 A*heaviside(t-T0);
gtt = subs(gt,t,tt+eps);
figure
plot(tt,vtt,
            'b','LineWidth'
            ,3)
grid
            on
            ; hold
            on
            axis([0 5e-4 0 16]);
plot(tt,gtt,
            'r','LineWidth'
            ,3)
xlabel(
            'Time (s)'
            )
ylabel(
            'Voltage (V)'
            )
legend(
            'v(t)','g(t)'
            ,...
            'Location'
            ,
            'SouthEast'
            )
title(
            'D13-2 (waveforms)'
            )
          
        





Answers:


The amplitude spectrum is presented above.
The plot of the original function and its Fourier series estimate are similar. The estimate does not have transitions that are as sharp as the original signal and the estimated linear portions have some fluctuations, but the general shape is correct.
The expression for the waveform is

f
          (
          t
          )≈8-5.0930 sin(2π 4000
          t
          ) - 2.5465 sin(2π 8000
          t
          ) - 1.6977 sin(2π 12,000
          t
          ) - 1.2732 sin(2π 16,000
          t
          ) V
        





13-4.


          The periodic pulse train shown is applied to the
          RL
          circuit also shown in the figure.
        

(a)
          Use the results in
          Figure 13-4
          to find the Fourier coefficients of the input for
          V
A
          = 4 V,
          T
0
          = 2π ms, and
          T
          =
          T
o
          /4.
        

(b)
          Find the first four nonzero terms in the Fourier series of
          υ
O
          (
          t
          ) for
          R
          = 200 Ω, and
          L
          = 100 mH.
        


SOLUTION:



(a)
          Using the results in
          Figure 13-4
          , we have the following coefficients:
        




(b)
          Find the transfer function for the
          RL
          circuit and evaluate it at the frequencies for the sinusoidal components of the input Fourier series.
        

          
            clear
            all
            syms
            s
            syms
            w positive
            VA = 4;
T0 = pi*2e-3;
            % Compute the transfer function
            R = 200;
L = 100e-3;
ZL = s*L;
Ts = simplify(R/(ZL + R));
            % Find the input frequencies
            n=[123];
w = 2*pi*n/T0
            % Evaluate the transfer function at the input frequencies
            Tjw = subs(Ts,s,1i*w);
Tjw2 = Tjw.*conj(Tjw);
MagTjw = double(sqrt(Tjw2))
            % The angle of the transfer function has the following form
            AngleTjw= -180*atan2(w,2000)/pi
            % Find the output coefficients
            a0 = 1;
an = 8*sin(n*pi/4)./n/pi anOut = double(an.*MagTjw)
            % Since we only have an Fourier coefficients, all of the input
            % signals are cosines and the output phase is the phase of the
            % transfer function plus 180 degrees when the input
            % coefficient has a negative sign
            PhaseIn =180*(an<0)
PhaseOut = PhaseIn+ AngleTjw
__________________________________________________________________________________
            
            w =
 1.0e+03 *
 1.0000  2.0000  3.0000
MagTjw =
 0.8944  0.7071  0.5547
AngleTjw =
 -26.5651  -45.0000  -56.3099
an =
 1.8006  1.2732  0.6002
anOut =
 1.6105  0.9003  0.3329
PhaseIn =
 0 0 0
PhaseOut =
 -26.5651 -45.0000 -56.3099
          
        


Answers:



(a)



(b)




13-5.

          Find the rms value of the periodic waveform on the right and the average power the waveform delivers to a resistor. Find the dc component of the waveform and the average power carried by the dc component. What fraction of the total average power is carried by the dc component? What fraction is carried by the ac components?
        





SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t
            syms
            VA T0 R positive
            % Create an expression for the first ramp
            vt = 2*VA/T0*t;
            % Find the rms value. Note the limits of integration.
            Vrms = sqrt(int(vt^2,t,0,T0/2)/T0)
            % Compute the average power
            P = Vrms^2/R
            % The dc component of the waveform is its average value
            Vdc = int(vt,t,0,T0/2)/T0
            % Average power of dc component
            Pdc = Vdc^2/R
            % Fraction of power carried by dc component
            Pdc_ratio = double(Pdc/P)
            % Fraction of power carried by ac components is the remainder
            Pac_ratio = 1-Pdc_ratio
__________________________________________________________________________________
Vrms =
(6^(1/2)*VA)/6
            
            P =
VA^2/(6*R)
Vdc =
VA/4
Pdc =
VA^2/(16*R)
Pdc_ratio =
 0.3750
Pac_ratio =
 0.6250
          
        


Answers:





The dc components carry 37.5% of the total average power and the ac components carry 62.5% of the total average power.


13-6.

          Estimate the rms value of the periodic voltage
        





SOLUTION:



          The Fourier coefficients for the ac components have the form 1/n, for
          n
          odd. We can use a partial sum to estimate the rms value of the voltage.
        

          
            clear
            all
            syms
            VA positive
            % Create the dc component
            A0 = 2*VA;
            % Create the ac components
            N = 10000;
n = 1:2:N;
An = VA./ n;
            % Find the rms value
            Vrms = sqrt(A0^2+ An*An'/2);
Vrms_num = vpa(Vrms,6)
__________________________________________________________________________________
Vrms_num =
2.14868*VA
          
        


Answer:



V
rms
          = 2.1487
          V
A



Chapter 14
This chapter involves the analysis and design of multipole filters. As such, it is useful to use simulation software to validate any design proposed. Hence, we will make extensive use of Multisim. MATLAB will be especially useful in evaluating transfer functions written in literals.


14-1.


          The active filter on the right has a transfer function of the form
        







          Using
          R
1
          =
          R
2
          =
          R
3
          =
          R,
          develop a method of selecting values for
          C
1
          ,
          C
2
          , and
          R.
          Then select values so that the filter has a cutoff frequency of 100 krad/s and a ζ of 0.05. Use MATLAB to plot the filter's Bode diagram. Build and simulate your circuit in Multisim and compare the results with MATLAB's. Determine the location in rad/s and magnitude in dB of the peak in the frequency response.
        


SOLUTION:



          Substitute
          R
1
          =
          R
2
          =
          R
3
          =
          R
          into the transfer function and simplify as follows.
        




          To solve for the component values, select a value for
          C
1
          and then solve for
          R
          and
        

C
2
          , in order, using the following two equations:
          

Use MATLAB to compute component values to meet the specifications.

          
            clear
            all
            w0 = 100e3;
w02 = w0^2;
z = 0.05;
C1= 10e-9
R = 3/2/z/w0/C1
C2 = 1/R^2/C1/w02
__________________________________________________________________________________
C1 =
 10.0000e-009
R =
 30.0000e+003
C2 =
 11.1111e-012
          
        




          Component values of
          R
          = 30 kΩ,
          C
1
          =0.01 μF, and
          C
2
          = 11.11 pF will meet the specifications. Plot the Bode diagram for these component values.
        

          
            syms
            w s
            R1 = R;
R2 = R;
R3 = R;
Ts = -R2/R1/(R2*R3*C1*C2*s^2+...
 (R3*C2+ R2*C2*(1+ R3/R1))*s+1);
Tjw = simplify(subs(Ts,s,1i*w));
ww = logspace(2,7,1000);
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
MagTjwwdB = 20*log10(MagTjww);
semilogx(ww/2/pi,MagTjwwdB,
            'r'
            ,...
            'LineWidth'
            ,3)
grid
            on
            axis([100 1e6 -80 30]);
xlabel(
            'Frequency (Hz)'
            )
ylabel(
            'Amplitude (dB)'
            )
title(
            'D14-1 (MATLAB)'
            )
          
        







The Multisim circuit and simulation results are shown.
The Multisim results closely match the MATLAB results.


Answers:



          To solve for the component values, select a value for
          C
1
          and then solve for
          R
          and
          C
2
          ,in order, using the following two equations:
        




          Component values of
          R
          = 30 kΩ,
          C
1
          = 0.01 μF, and
          C
2
          = 11.11 pF will meet the specifications.
        
The MATLAB Bode amplitude response and the Multisim circuit and simulation are shown above. The peak frequency response occurs at ω = 100 krad/s = 15.84 kHz measured in MATLAB and 15.85 kHz measured in Multisim and both show a magnitude of 20.00 dB.


14-2.

          The circuit in the figure on the left has a high-pass transfer function given in
          Eq. (14-11)
          and repeated below.
        




          In Section 14-2, we developed
          equal-element
          and
          unity-gain
          design methods for this circuit. This problem explores an
          equal-time constant
          design method. Using
          R
1
C
1
          =
          R
2
C
2
          and μ = 2, develop a method of selecting values for
          C
1
          ,
          C
2
          ,
          R
1
          , and
          R
2
          . Then select values so that the filter has a cutoff frequency of 50 krad/s and a ζ of 0.2. Use MATLAB to plot the filter's Bode diagram.
        


SOLUTION:



          Let
          T
          =
          R
1
C
1
          =
          R
2
C
2
          and μ = 2. Substitute into the transfer function.
        



We now have the following equations:





          Select
          C
1
          and then use the first equation to find
          R
1
          . Use the second equation to find
          C
2
          . Use the equality for the time constant to find
          R
2
          .
        
Use MATLAB to find component values that meet the specifications.

          
            clear
            all
            w0 = 50e3;
w02 = w0^2;
z = 0.2;
            % Select a capacitor value for C1
            C1= 5e-9
R1 = 1/C1/w0
C2 = 2*z/R1/w0
R2 = R1*C1/C2
__________________________________________________________________________________
C1 =
 5.0000e-009
R1 =
 4.0000e+003
C2 =
 2.0000e-009
R2 =
 10.0000e+003
          
        

          The following component values will meet the specifications:
          R
1
          =4 kΩ,
          R
2
          = 10 kΩ,
          C
1
          = 5000 pF, and
          C
2
          = 2000 pF.
        
Plot the amplitude response

          
            syms
            w s
            u = 2;
Ts = 2*R1*R2*C1*C2*s^2/...
    (R1*R2*C1*C2*s^2+(R2*C2+...
    R1*C1+ R1*C2-2*R2*C2)*s+1);
Tjw = simplify(subs(Ts,s,j*w));
ww = logspace(3,7,1000);
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
MagTjwwdB = 20*log10(MagTjww);
semilogx(ww,MagTjwwdB,
            'r'
            ,...
            'LineWidth'
            ,3)
grid
            on
            xlabel(
            'Frequency (rad/s)'
            )
ylabel(
            'Amplitude (dB)'
            )
title(
            'D14-2'
            )
          
        





Answers:


The important equations are




          Select
          C
1
          and then use the first equation to find
          R
1
          . Use the second equation to find
          C
2
          . Use the third equation to find
          R
2
          .
        

          The following component values will meet the specifications:
          R
1
          =4 kΩ,
          R
2
          = 10 kΩ,
          C
1
          = 5000 pF, and
          C
2
          = 2000 pF.
        
The Bode plot is shown above.


14-3.


          Construct a second-order transfer function that meets the following requirements. Use MATLAB to plot the transfer function's Bode diagram and validate the requirements.
        



Problem
Type

                ω
                o
                (rad/s)
              
ζ

                |
                T
                (
                j
                ω
                0
                )|
              
Constraints




14-3
Bandpass
10,000
*
5

B
                = 200 rad/s
              





SOLUTION:



          With ω
          o
          = 10 krad/s and
          B
          = 200 rad/s, we can calculate the damping ratio as ζ =
          B/
          2ω
          o
          = 0.01. For a second-order bandpass filter, the gain at ω
          0
          is
          
\k\

          /2ζ,. With ζ = 001 and the gain at ω
          0
          equal to 5, we can find
          K
          = 0.1. We can construct the transfer function as follows:
        







          
            clear
            all
            syms
            w s
            K= 0.1;
w0 = 10000;
w02 = w0^2;
z = 0.01;
Ts = K*w0*s/(s^2 + 2*z*w0*S +w02);
Tjw = subs(Ts,s,1i*w);
ww =logspace(3,5,10000);
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
MagTjwwdB = 20*log10(MagTjww);
loglog(ww,MagTjww,
            'r'
            ,...
            'LineWidth'
            ,3)
grid
            on
            xlabel(
            'Frequency (rad/s)'
            )
ylabel(
            'Amplitude'
            )
MagTjw0 = abs(subs(Tjw,w,w0))
title(
            'D14-3 (wide sweep)'
            )
__________________________________________________________________________________
MagTjw0 =
	5
          
        
Plot the response so that we can verify the bandwidth.

          
            figure
ww = 9800:10200;
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
plot(ww,MagTjww,
            'r'
            ,...
            'LineWidth'
            ,3)
grid
            on
            xlabel(
            'Frequency (rad/s)'
            )
ylabel(
            'Amplitude'
            )
line([min(ww),max(ww)],...
 [5/sqrt(2),5/sqrt(2)],...
            'Color','g','LineWidth'
            ,2)
title(
            'D14-3 (narrow sweep)'
            )
          
        


Answers:





          the Bode diagram is shown above. Its bandwidth is 199 rad/s and the center frequency is 10 krad/s, hence, it meets the specifications.
        





14-4.

          Design a second-order active filter that meets the following requirements. Simulate your design in Multisim to validate the requirements.
        



Problem
Type

                ω
                0
                (rad/s)
              
ζ
Constraints




14-4
Low pass
20,000
0.5
Use 10-kΩ resistors





SOLUTION:


Since all of the resistors are 10-kΩ, use the equal-element design approach for a low-pass filter.

          
            clear
            all
            w0 = 20000;
z = 0.5;
R = 10e3
C = l/w0/R
u = 3-2*Z;
RB = R;
RA = (u-1)*RB
__________________________________________________________________________________
R =
 10.0000e+003
C =
 5.0000e-009
RA =
 10.0000e+003
          
        




The circuit and the Multisim simulation results are shown above.


Answer:


The design and simulation results are presented above.


14-5.

          Design a second-order active filter that meets the following requirements. Simulate your design in Multisim to validate the requirements.
        



Problem
Type

                ɷ
                0
                (rad/s)
              
ζ
Constraints




14-5
Bandstop
5000
0.2
Use 0.2-μF capacitors





SOLUTION:



          Use the equal-capacitor method with
          C
          = 0.2 μF.
        

          
            clear
            all
            w0 = 5000;
w02 = w0^2;
z = 0.2;
C = 0.2e-6
R2 = 1/z/C/w0
R2 =1/z/C/wO
RI = R2*z*2
RA = 2*R1
RB = R2
__________________________________________________________________________________
C =
 200.0000e-009
R2 =
 5.0000e+003
R1 =
 200.0000e+000
RA =
 400.0000e+000
RB =
 5.0000e+003
          
        







          The circuit and the Multisim simulation results are shown at the left. The center frequency is at 5002 rad/s or 796.16 Hz, BW = 319 Hz,
          Q
          = 2.495, and ζ = 0.200.
        


Answer:


The design and simulation meet the specifications.


14-6.
            (a)
          
          Construct the lowest-order transfer function that meets the following low-pass filter specifications. Calculate the gain (in dB) of the transfer function at ω =
          ω
C
          and cumin
          .
          Use MATLAB to validate that your transfer function meets the design specifications
        



Problem
Pole Type

                ω
                c
                (rad/s)
              

T
MAX


                ω
                MIN
                (rad/s)
              

T
MIN





14-6
Butterworth
10,000
0 dB
20,000
- 30 dB




(b)
          Design an active low-pass filter to meet the specification in Problem 14-6(a). Use Multisim to verify that your design meets the specifications.
        


SOLUTION TO PART (A):


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            % Set the filter specifications
            TmaxdB = 0;
TmindB = -3 0;
wC = 10000;
wmin = 20000;
Tmax = 10^(TmaxdB/20);
Tmin = 10^(TmindB/20);
            
              %
              
              Compute ratios of filter specification values
            
            Tratio = Tmax/Tmin;
wratio = wmin/wC;
            % Compute the Butterworth order
            ButterworthOrder = ceil(log(Tratio^2-1)/log(wratio)/2)
__________________________________________________________________________________
ButterworthOrder =
  5
          
        
The filter requires a fifth-order Butterworth filter. The corresponding transfer function is given below.

          
            syms s w
            wc = wC;
K = Tmax;
q5 = (s+1)*(s^2+0.618*s+1) *(s*2+1.618*s+1);
q = subs(q5,s,s/wc);
Ts = simplify(K/q)
__________________________________________________________________________________
Ts =
100000000000000000000/((s + 10000)*(s^2 + 6180*s + 100000000)* (s^2 + 16180*s + 100000000))
          
        




          Find the magnitude of the gain at ω =
          ω
C
          and ω
          MIN
          .
        

          Tjw= subs(Ts,s,1i*w);
MagTjwcdB = double(20*log10(abs(subs(Tjw,w,wC))))
MagTjwmindB = double(20*log10(abs(subs(Tjw,w,wmin))))
__________________________________________________________________________________
MagTjwcdB =
 -3.0096e+000
MagTjwmindB =
 -30.1071e+000
        
Plot the transfer function to verify it meets the specifications.

          
            ww = logspace(2,5,1000);
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
MagTjwwdB = 20*log10(MagTjww);
semilogx(ww,MagTjwwdB,
            'r'
            ,...
            'LineWidth'
            ,3)
grid
            on
            xlabel(
            'Frequency (rad/s)'
            )
ylabel(
            'Amplitude (dB)'
            )
title(
            'D14-6'
            )
          
        



The filter meets the specifications.



ANSWERS TO PART (A):







SOLUTION TO PART (B)


Rewrite the transfer function as follows to identify the three stages of the circuit.



The first stage is a first-order low-pass filter with a gain ofone and a cutofffrequency of 10 krad/s.

          
            clear
            all
            disp(
            'First stage'
            )
w0 =10e3;
C = 10e-9
R = 1/C/w0
__________________________________________________________________________________
First stage
C =
 10.0000e-009
R =
 10.0000e+003
          
        

          Both the second and third stages have ɷ
          0
          = 10 krad/s and damping ratios as calculated below.
        

          w0 = 10e3;
z1 = 6180/2/w0
z2 = 16180/2/w0
__________________________________________________________________________________
z1 =
 309.0000e-003
z2 =
 809.0000e-003
        
Since each stage has unity gain, use the unity-gain method for designing the second-order stages. Determine the component values as calculated below.

          
            disp(
            'Second stage'
            )
z = z1;
C1 = 10e-9
C2 = C1*z*2
R = 1/w0/sqrt(C1*C2)
disp(
            'Third stage'
            )
z = z2;
C1 = 10e-9
C2 = C1*z*2
R = 1/w0/sqrt(C1*C2)
__________________________________________________________________________________
            
            Second stage
C1 =
 10.0000e-009
C2 =
 954.8100e-012
R =
 32.3625e+003
Third stage
C1 =
 10.0000e-009
C2 =
 6.5448e-009
R =
12.3609e+003
          
        
Construct the circuit and verify it meets the specification.



The amplitude response is shown below.






ANSWERS TO PART (B):


The design is described above and the circuit meets the specifications.


14-7.
            (a)
          
          Construct the lowest-order transfer function that meets the following low-pass filter specifications. Calculate the gain (in dB) of the transfer function at ω =
          ω
C
          and
          ω
MIN
          . Use MATLAB to validate that your transfer function meets the design specifications.
        



Problem Pole Type

                ω
                o
                (rad/s)
              

T
MAX


                ω
                MIN
                (rad/s)
              

T
MIN





14-7 Chebyshev
25,000
20 dB
100,000
- 30 dB




(b)
          Design an active low-pass filter to meet the specification in Problem 14-7(a). Use Multisim to verify that your design meets the specifications.
        


SOLUTION TO PART (A):


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            % Set the filter specifications
            TmaxdB = 20;
TmindB = -30;
wC = 25000;
wc = wC;
wmin = 100000;
Tmax = 10^(TmaxdB/20);
Tmin = 10^(TmindB/20);
            % Compute ratios of filter specification values
            Tratio = Tmax/Tmin;
wratio = wmin/wC;
            % Compute the Chebychev order
            ChebychevOrder = ceil(acosh(sqrt(Tratio^2-1))/acosh(wratio))
__________________________________________________________________________________
ChebyshevOrder =
  4
          
        
The filter requires a fourth-order Chebyshev filter. The corresponding transfer function is given below.

          
            syms
            s w
            wc = wC;
K = Tmax;
q4c = ((s/0.9502)*2 + 0.1789*(s/0.9502)+1)*((s/0.4425)*2+ ...
 0.9276*(s/0.4425)+1); q = subs(q4c,s,s/wc);
Ts = K/sqrt(2)/q;
Ts_num = vpa(Ts,6)
__________________________________________________________________________________
Ts_num =
7.07107/((8.17134e-9*s^2 + 0.000083 8508*s + 1.0)*(1.77211e-9*s^2 + 0.00000753105*s + 1.0))
          
        




          Find the magnitude of the gain at ω =
          ω
C
          and
          ω
MIN
          .
        


          Tjw= subs(Ts,S,1i*w);
MagTjwcdB = double(20*log10(...
 abs(subs(Tjw,w,wC))))
MagTjwmindB = double(2 0*log10 (...
 abs(subs(Tjw,w,wmin))))
__________________________________________________________________________________
MagTjwcdB =
 16.9909e+000
MagTjwmindB =
 -45.6699e+000
        
Plot the transfer function to verify it meets the specifications.

          
            ww = logspace(3,5,3000);
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
MagTjwwdB = 20*log10(MagTjww);
__________________________________________________________________________________
semilogx(ww,...
 MagTjwwdB,
            'r','LineWidth'
            ,3)
line([min(ww),max(ww)],[17,17],
            'Color','r','LineWidth'
            ,1)
line([min(ww),max(ww)],[2 0,2 0],
            'Color','r','LineWidth'
            ,1)
grid
            on
            xlabel(
            'Frequency (rad/s)'
            )
ylabel(
            'Amplitude (dB)'
            )
title(
            'D14-7'
            )
          
        



The filter meets the specifications.


Answers:







SOLUTION TO PART (B):


We can rewrite the transfer function as follows:




          For each second-order stage, calculate ɷ
          0
          , ζ, and the component values for the circuit. Use the unity-gain design approach for the second-order stages and then add an amplifier with a gain of 7.071.
        

          
            disp(
            'First stage'
            )
w02 = 0.564229e9;
w0 = sqrt(w02);
z = 4250/2/w0;
C1= 100e-9
C2 = C1*z^2
R = 1/w0/sqrt(C1*C2)
disp(
            'Second stage'
            )
            
            w02 = 0.122379e9;
w0 = sqrt(w02);
z = 10262/2/w0;
C1 = 100e-9
C2 = C1*z^2
R = 1/w0/sqrt(C1*C2)
__________________________________________________________________________________
First stage
C1 =
 100.0000e-009
C2 =
 800.3178e-012
R =
 4.7059e+003
Second stage
C1 =
 100.0000e-009
C2 =
 21.5128e-009
R =
 1.9489e+003
          
        
Construct the circuit and verify it meets the specification.



The amplitude response is shown below.






ANSWERS TO PART (B):


The design is described above and the circuit meets the specifications.


14-8.

          Design a low-pass filter with 6 dB passband gain, a cutoff frequency of 3.2 kHz, and a stopband gain of less than - 20 dB at 9.6 kHz. The filter must not have an overshoot of more than 1.2%. Verify your design using Multisim.
        


SOLUTION:


Since we want an overshoot of less than 12%, we will use a Butterworth design. Determine the required filter order to meet the specifications and then design the component values.

          
            clear
            all
            TmaxdB = 6;
TmindB =-20;
wC = 2*pi*3200;
wmin = 2*pi*9600;
Tmax = 10^(TmaxdB/20);
Tmin =10^(TmindB/20);
            % Compute ratios of filter specification values
            Tratio = Tmax/Tmin;
wratio = wmin/wC;
            % Compute the Butterworth order
            ButterworthOrder = ceil(log(Tratio*2-1)/log(wratio)/2)
__________________________________________________________________________________
ButterworthOrder =
 3
          
        
We will need a third-order filter.

          
            % Design the transfer function
            K = Tmax;
wc = wC;
syms
            s w
            q3 = (s+1)*(s^2+s+1);
q = subs(q3,s,s/wc);
Ts = simplify(K/q)
TsNum = vpa(Ts,6)
__________________________________________________________________________________
Ts =
(140404103409378734375*pi^3)/(268435456*(s + 6400*pi)* (40960000*pi^2 + 6400*pi^s + s^2))
TsNum =
1.62177e + 13/((s + 20106.2)*(s^2 + 20106.2^s + 4.04259e + 8))
          
        



The first stage is a first-order low-pass filter with a gain of two, and the second stage is a second-order low-pass filter. Determine the component values.

          
            disp(
            'First Stage'
            )
w0 = 6400*pi;
C = 10e-9
R = 1/C/w0
disp(
            'Second Stage'
            )
z = 6400*pi/2/w0;
C1 = 10e-9
C2 = C1*z^2
R = 1/w0/sqrt(C1*C2)

First Stage
C=
 10.0000e-009
R=
 4.9736e+003
Second Stage
C1 =
 10.0000e-009
C2 =
 2.5000e-009
R=
9.9472e+003
          
        




Construct the circuit above and verify it meets the specification. Its amplitude and step response responses are shown below. The overshoot is 8%.


Answer:


The design meets the specifications.








14-9.
            (a)
          

          Construct the lowest order, high-pass transfer function that meets the following filter specifications. Calculate the gain (in dB) of the transfer function at
          ω
          =
          ω
C
          and
          ω
MIN
          . Use MATLAB to validate that your transfer function meets the design specifications.
        



Problem
Pole Type
ωc (rad/s)

T
MAX


                ω
                MIN
                (rad/s)
              

T
MIN





14-9
Chebyshev
2000
0 dB
500
- 25 dB




(b)
          Design an active high-pass filter to meet the specification in Problem 14-9 (a). Use Multisim to verify that your design meets the specifications.
        


SOLUTION:



          Determine the filter order and then construct the transfer function. clear
          all


          
            % Set the filter specifications
            TmaxdB = 0;
TmindB =-25;
wC = 2000;
wmin = 500;
Tmax = 10^(TmaxdB/20);
Tmin =10^(TmindB/20);
            % Compute ratios of filter specification values
            Tratio = Tmax/Tmin;
wratio = wC/wmin;
            % Compute the Chebychev order
            ChebychevOrder = ceil(acosh(sqrt(Tratio^2-1))/acosh(wratio))
__________________________________________________________________________________
ChebyshevOrder =
  2
          
        
We will need a second-order Chebyshev filter. Create the transfer function.

          
            K = Tmax;
wc = wC;
syms
            s w
            q2c = ((s/0.8409)^2 + 0.7654*(s/0.8409)+1);
q = subs(q2c,s,wc/s);
Ts = simplify(K/sqrt(2)/q);
Ts_num= (vpa(Ts,6))
__________________________________________________________________________________
Ts_num =
(5.00004e7*s^2)/(7.07113e7*s^2 + 1.28725e11*s + 4.0e14)
          
        

          The transfer function is
          


          Find the magnitude of the gain at
          ω
          =
          ω
C
          and ω
          MIN
          .
        

          Tjw= subs(Ts,s,1i*w);
MagTjwcdB = double(20*log10(abs(subs(Tjw,w,wC))))
MagTjwmindB = double(20*log10(abs(subs(Tjw,w,wmin))))
__________________________________________________________________________________
MagTjwcdB =
 -3.0105e+000
MagTjwmindB =
 -29.8317e+000
        




Plot the transfer function to verify it meets the specifications.

          
            ww =logspace(2,6,1000);
Tjww = subs(Tjw,w,ww);
MagTjww = abs(Tjww);
MagTjwwdB = 20*log10(MagTjww);
semilogx(ww,MagTjwwdB,
            'r'
            ,...
            'LineWidth'
            ,3)
grid
            on
            xlabel(
            'Frequency (rad/s)'
            )
ylabel(
            'Amplitude (dB)'
            )
title(
            'D14-9 (MATLAB)'
            )
          
        
The filter meets the specifications.


ANSWERS TO PART (A):










SOLUTION TO PART (B):


The transfer function is



Design the component values using a second-order filter with unity gain followed by an amplifier.




          
            clear
            all
            w02 = 5656800;
w0 = sqrt(w02);
            % Unity gain approach
            z =1820/2/w0;
R2 =10e3
R1 = R2*z*2
C = 1/w0/sqrt(R1*R2)
__________________________________________________________________________________
R2 =
 10.0000e+003
R1 =
 1.4639e+003
C=
 109.8901e-009
          
        
Construct the circuit above and verify it meets the specification.
The amplitude response is shown at left.



ANSWERS TO PART (B):


The design is described above and the circuit meets the specifications.


14-10.

          You are working at an aircraft manufacturing plant on an altitude sensor that eventually will be used to retrofit dozens of similar sensors on an upgrade to a current airframe. You have a requirement to find a quality notch filter to eliminate an undesirable interference at 400 Hz. You find a vendor and ask for a suitable product specification and a bid. The specifications you require are
        

1.
Must block signals at
          400 ±2%
          Hz


2.
Passband gain should be
          0
          dB
          ±1
          dB


3.
Bandwidth should be
          20
          Hz
          ±5 %
          Hz




The vendor's proposal, shown as a Multisim drawing in the circuit on the right, claims to meet all of the design requirements. Determine if it passes all of the stated requirements. Then explain if you would buy the filter and why or why not?


SOLUTION:


Simulate the circuit in Multisim and analyze its
performance against the specifications.
The amplitude response is shown at the right.





Answer:


The filter has a notch located at 397.9 Hz with a gain of -51.1 dB. The passband gain is 0 dB. The cutoff frequencies occur at 388.0 Hz and 408.1 Hz, so the bandwidth is 20.1 Hz. From the simulation, the filter meets all of the specifications. it appears that the filter is an acceptable choice based on the simulation. One concern with the filter is the 625-Ω resistor at the input. Depending on the nature of the sensor with which the filter will interface, there may be loading issues at the input. We would either have to isolate the filter with a buffer or examine the sensor in more detail to make sure it would not impact the performance of the filter.


Chapter 15
This chapter is on coupled coils and transformers. MATLAB is useful in helping to solve these types of problems. Multisim has several coupled coils and transformer models. We will make use of one of each.


Coupled Coils

          The coupled-coil model is shown on the right. Its default conditions are 0.1 H for each coil and a coupling coefficient of 1. Clicking on the coil lets you select other values. The coupling coefficient
          k
          can be positive or negative and can range from -1 ≥
          k ≥
          +1, where 1 refers to "perfect" or ideal coupling. You can set both coils' inductances by clicking on the model and opening the Property Editor. The following important relationship relates the coil inductances with the mutual inductance and the coupling coefficient
          
          For sinusoidal
          
          steady-state problems, use the single frequency AC analysis. We will cover the transformer model later.
        








15-1.

          In the figure on the left,
          L
1
          =100mH,
          L
2
          =400 mH,
          M
          = 180mH, and υ
          S
          (
          t
          ) = 200 sin 400
          t
          V.
        

(a)
          Write the
          i-v
          relationships for the coupled inductors using the reference marks in the figure.
        

(b)
          Find the voltage υ
          2
          (
          t
          ) and the current
          i
1
          (
          t
          ) when the output terminals are open-circuited (
          i
2
          =0).
        

(c)
          Verify your answers using Multisim.
        


SOLUTION:



(a)
          The coupling is additive, so we have the following equations:
        




(b)
          Use MATLAB to solve for voltage
          
            v
            2
            (t
          
          ).
        

          
            clear
            all
            syms
            t
            L1 = 100e-3;
L2 = 400e-3;
M = 180e-3;
vl = 200*sin(400*t);
dil = vl/Ll;
v2 = M*di1
i1=int(v1)/L1
__________________________________________________________________________________
 v2 =
 360*sin(400*t)
 i1 =
 -5*COS(400*t)
          
        




(c)
          Using Multisim, we find the coupling coefficient
          

          and apply it to the transformer model. Placing a voltage source across an inductor causes an "inductor loop" and violates KVL since an inductor at
          t
          = 0 is a short circuit. Placing a small 1-pΩ resistor in series with the inductor prevents the instantaneous short and is small enough to act like a short circuit after the initial condition.
        


Answers:



(a)






(b)

            υ
            2
            (t)
          
          =360 sin(400
          t
          ) V,
          
            i
            1

          (
          t
          ) =5 sin(400
          t
          -9°) = -5 cos(400
          t
          ) A
        

(c)
          Multisim verification above.
        


15-2.


          In the coupled coil circuit shown below, use MATLAB to show that
          L
EQ
          =
          L
1
          (1 - k
          2
          ), where
          k
          is the coupling coefficient.
        


SOLUTION:



          The output is a short circuit, so we have
          υ
2
          (
          t
          ) = 0. The coupling is additive. Use MATLAB to show the results.
        




          
            syms
            L1 L2 M k vl dil di2
            % Write an equation for M in terms of
            % the coupling coefficient
            Eqn1 = M - k*sqrt(L1*L2);
            % Write the equations for the coupled
            % inductors
            Eqn2 = M*di1 + L2*di2;
Eqn3 = v1 - (L1*di1 + M*di2);
            % Solve the equations
            Soln = solve(Eqn1,Eqn2,Eqn3,v1,M,di2);
v1= simplify(Soln.v1)
__________________________________________________________________________________
v1 =
 -L1*di1*(k^2 - 1)
          
        
We can rewrite the solution as follows:








Answer:



          Based on the expression for
          υ
1
          (
          t
          ), we have
          L

EQ

          =
          L
1
          (1 -
          k

2

          ).
        


15-3.

          In the figure on the right,
          L
1
          = 800 mH,
          L
2
          = 400 mH, and
          M
          = 500 mH. The load is a 600-mH inductor. The source voltage
          υ
s
          (
          t
          ) is -550 cos 1000
          t
          V. Find
          
            v
            2

          (
          t
          ) and i
          2
          (
          t
          ).
        





SOLUTION:


The coupling is additive. Use Multisim to simulate the circuit.


Answers:



υ
2
          (
          t
          ) = 300 sin (1000
          t
          -90°) V,
          i
2
          (
          t
          ) =500 sin(1000
          t
          ) mA
        



Ideal Transformers

          In Multisim, we use the model labeled 1P1S (one primary and one secondary) shown on the right. The model displays the turns on the primary coil to the turns on the secondary coil. The default is shown as 10:1. Clicking on the model lets you select whatever ratio you want. Note that in the text the ratio is 1:
          n,
          so the default transformer is a step-down transformer.
        


15-4.

          In the transformer circuit shown on the next page,
          R
S
          = 40
          
            Ω,
            R
L

          = 1280 Ω, the turns ratio is
          n
          = 8, and the source voltage is
          
            v
            S
            (t
          
          ) =240 cos 377
          t
          V. Use MATLAB to find expressions for
          i
1
          (
          t
          ) and
          i
2
          (
          t
          ).
        






SOLUTION:


Find the equivalent resistance seen by the source and then compute the input current. Use the transformer relationships to compute the output current. Use MATLAB to complete the calculations. Validate your answers using Multisim.

          
            clear
            all
            syms
            t
            RS = 40;
RL = 1280;
n= 8;
            % Find the equivalent load resistance seen by the source
            Req = RL/n^2;
            % Find the total resistance seen by the source
            Rtotal = RS + Req;
vs = 240*cos(377*t);
            % Compute the input current
            11 = vs/Rtotal
            % Compute the output current
            i2 = -il/n
__________________________________________________________________________________
i1 =
4*cos(377*t)
i2 =
-cos(377*t)/2
          
        
We create the circuit shown below using Multisim. Note that the sinusoidal source in Multisim is a sinewave. Hence, we need to add a 90° phase shift to generate a cosine source.


Answers:







15-5.

          The turns ratio of the ideal transformer in the circuit on the right is
          n
          = 5. The source and load impedances are
          Z
S
          =40 +
          j
          45 Ω and
          Z
L
          = 500 -
          j
          350 Ω. Find
          I
1
          ,
          I
2
          , and
          V
O
          when
          V
S
          = 200∠0° V.
        





SOLUTION:


Find the equivalent impedance seen by the source. Compute the input and output currents. Compute the output voltage. Use MATLAB to complete the calculations.


          
            clear
            all
            Vs = 200;
n= 5;
Zs = 40 + 45i;
ZL = 500-350i;
Zeq = Zs + ZL/n^2;
I1= Vs/Zeq
I2 = -I1/n
V2 = -I2*ZL;
Vo = V2
__________________________________________________________________________________
I1 =
   2.6310e+000- 1.3594e+000i
I2 =
 -526.2004e-003 +271.8702e-003i
Vo =
 167.9456e+000 -320.1052e+000i
          
        


Answers:



          
            
              I
              1
            
            =2.6310 -
            j
            1.3594 A
            
              I
              2
            
            = - 526.2004 +
            j
            271.8702 mA
            
              V
              o
            
            = 167.9456 -
            j
            320.1052 V
          
        


15-6.

          In the two-transformer circuit shown, the impedances are
          Z
1
          =20−
          j
          45 Ω,
          Z
2
          = 40 +
          j
          30 Ω, and
          Z
3
          = 360 +
          j
          '270 Ω. Find
          I
1
          ,
          I
2
          , and
          I
3
          .
        





SOLUTION:


Find the equivalent resistance seen by the source and then use the transformer relationships to find the currents.

          
            clear
            all
            n1 = 2;
n2 = 3;
Z1 = 20-45i;
Z2 = 40+30i;
Z3 = 360+270i;
Zt2 = Z3/n2^2;
Zt1= (Z2+ Zt2)/n1^2;
Zeq = Z1+ Zt1 Vs = 200;
11 = Vs/Zeq
12 = I1/n1
13 = I2/n2
__________________________________________________________________________________
Zeq =
 40.0000 -30.0000i
I1 =
 3.2000 + 2.4000i
I2 =
 1.6000 + 1.2000i
I3 =
 0.5333 + 0.4000i
          
        

Answers:


          
            Z
            EQ
            =40-
            j
            30 Ω
            I
            1
            =3.2 +
            j
            2.4A
            I
            2
            = 1.6 +
            j
            1.2A
            I
            3
            = 0.5333 +
            j
            0.4A
          
        





15-7.


          The input voltage to the transformer in the circuit on the left is a sinusoid
          
            υ
            1
            (t)
          
          = 100 cos 4000
          t
          V. With the circuit operating in the sinusoidal steady state, use mesh-current analysis to find the phasor output voltage V
          2
          and the input impedance
          Z
IN
          . Use MATLAB to perform all of the calculations. Validate your answers using Multisim.
        


SOLUTION:


Let the left mesh be mesh A and the right mesh be mesh B. The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            IA IB I1 I2 V1 V2
            % Define the given values
            Vs = 100;
w = 4000;
Rs = 50;
L1 = 30e-3;
L2 =120e-3;
M = 50e-3;
RL = 6 00;
            % Write the mesh-current equations
            Eqn1= -Vs+ IA*Rs+ V1;
Eqn2 = -V2+ IB*RL;
            % Write the equations for the coupled inductors
            Eqn3 = V1-(1i*w*L1*IA + 1i*w*M*(-IB));
Eqn4 = V2-(1i*w*M*IA + 1i*w*L2*(-IB));
            % Solve for the voltages and currents
            Soln = solve(Eqn1,Eqn2,Eqn3,Eqn4,V1,V2,IA,IB);
V2 =double(Soln.V2)
            % Compute the input impedance
            V1 = Soln.V1;
I1 = double(Soln.IA)
Zin = double(Vs/I1)
__________________________________________________________________________________
V2 =
 122.9487e+000 +15.8809e+000i
I1 =
 571.1993e-003 -551.2201e-003i
Zin =
 90.6504e+000 + 87.4797e + 000i
          
        
We create the following circuit in Multisim and do a single frequency AC analysis.






Parameter
Variable
Magnitude
Phase (deg)





Z
IN

v(1)/I(R1)
126
44



v
2

v(2)-v(3)
123.9
97.35






Answers:



          Z
          IN
          = 90.6504 +
          j
          87.4797 Ω = 126.0 ∠44.0° Ω
        

          V
          2
          = 122.9487 +
          j
          15.8809 V = 123.9 ∠7.35° V
        

υ
          (
          t
          ) = 123.9 sin (4000
          t
          + 97.35°)
        

          = 123.9 cos (4000
          t
          + 7.35°) V|
        


15-8.

          The circuit at the right is in the sinusoidal steady state with
          
            v
            S
            (t)
          
          =200 cos 2500
          t
          V. Find the input current
          i(t
          ), the impedance seenbythe voltage source, andthe average powersupplied by the voltage source. Verify your results using Multisim.
        





SOLUTION:


Note that the circuit has negative coupling.

          
            clear
            all
            syms
            V1 V2 I1 I2
            w = 2500;
Vs = 200;
Zs = 2e3;
C = 0.125e-6;
ZC = 1/1i/w/C;
            % Find the equivalent load impedance
            ZL = 1/(1/2e3 + 1/ZC);
L1 = 1/2;
L2 = 1/2;
M = 1/4;
Z1 = 1i*w*L1;
Z2 = 1i*w*L2;
ZM = 1i*w*M;
            % Write the mesh-current equations
            Eqn1 = -Vs + Zs*I1 + V1;
Eqn2 = -V2-ZL*I2;
            % Write the equations for the coupled inductors
            Eqn3 = V1-(1i*w*L1*I1 - 1i*w*M*I2);
Eqn4 = V2-(-1i*w*M*I1 + 1i*w*L2*I2);
            % Solve the equations
            Soln = solve(Eqn1,Eqn2,Eqn3,Eqn4,V1,V2,I1,I2);
            % Find the input current
            I1 = double(Soln.I1);
MagI1 = abs(I1)
PhaseI1= 180*angle(I1)/pi
            % Find the input impedance
            Zin = double(Vs/I1)
            % Find the power supplied by the source
            Pavg = double(abs(I1)^2*real(Zin)/2)
__________________________________________________________________________________
MagI1 =
 78.4405e-003
PhaseI1 =
 -27. 7561e + 000
Zin =
 2.2563e+003+ 1.1874e+003i
Pavg =
 6.9415e+000
          
        


          The following circuit was created in Multisim. Only the real part of the power was used.
        






Variable
Real
Imaginary
Magnitude
Phase (deg)




V(1)/I(R1) I(R1)
2256.3
1187.4
0.07844
62.24


P(V1)
- 6.9415








Answers:



i
          (
          t
          ) = 78.44 cos (2500
          t
          -27.76°) mA = 78.44 sin (2500
          t
          + 62.24°) mA
        

Z
IN
          = 2.2563 +
          j
          1.1874 kΩ
        

P
AVG
          = 6.9415 W
        


Chapter 16
This is a chapter suited to MATLAB analysis more so than Multisim. We will show how a number of complex power, three-phase, and phasor-diagram problems can be solved.





16-1.

          The voltage across and current through the load in the figure shown are
          u
          (
          t
          ) = 150 cos (ω
          t
          - 45°) V,
          i
          (
          t
          ) = 3 cos (ω
          t
          + 20°) A.
        
Find the average power, reactive power, and instantaneous power delivered to the load.


SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            syms
            t w
            vt =150*cos(w*t-pi*45/180);
it = 3*cos(w*t+pi*20/180);
            % Find the amplitudes and relative phases
            % of the voltage and current
            VA = 150;
IA = 3;
vPhase = -45;
iPhase = 20;
theta = pi*(vPhase-iPhase)/180;
            % Find the power components
            P = VA*IA*cos(theta)/2
Q = VA*IA*sin(theta)/2
pt = vpa(P*(1 + cos(2*w*t))-Q*sin(2*w*t),6)
__________________________________________________________________________________
P=
 95.0891
Q=
 -203.9193
pt =
95.0891*cos(2.0*t*w) +203.919*sin(2.0*t*w) +95.0891
          
        


Answers:



P
          = 95.0891 W,
          Q
          = -203.9193 VAR,
        

p
          (
          t
          ) =95.0891 [1 + cos(2ω
          t
          )] + 203.9193 sin(2ω
          t
          ) W
        


16-2.


          The following conditions apply to the circuit at the right. Find the complex power delivered to the impedance Z.
        

(a) V
          = 150∠45° V (rms),
          
Z

          = 50∠15° Ω
        

(b)

Z

          = 30-
          j
          40Ω,
          I
          = 10 ∠- 25° A (rms)
        





SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            disp(
            'Part (a)'
            )
Vrms = 150;
vPhase = 45*pi/180;
Zmag =50;
zPhase = 15*pi/180;
            % Determine the current
            Irms = Vrms/Zmag;
iPhase = vPhase-zPhase;
theta = vPhase-iPhase;
            % Determine the complex power
            S = Vrms*Irms*exp(theta*1i)
disp(
            'Part (b)'
            )
Z = 30-40i;
Zmag = abs(Z);
zPhase = angle(Z);
Irms = 10;
iPhase = -25*pi/180;
            % Determine the current
            Vrms = Irms*Zmag;
vPhase = iPhase+zPhase;
theta = vPhase-iPhase;
            % Determine the complex power
            S = Vrms*Irms*exp(theta*1i)
__________________________________________________________________________________
Part (a)
S=
 434.6666e + 000 +116.4686e + 000i
Part (b)
S=
 3.0000e+003- 4.0000e+003i
          
        


Answers:



(a)

S

          = 434.6666 +
          j
          116.4686 VA
        

(b)

S

          = 3−
          j
          4kVA
        


16-3.

          A load is rated at 440 V (rms), 7.5 A (rms), and 3.3 kW when connected to a 50-Hz source. Find the load impedance.
        


SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            Vrms = 440;
Irms = 7.5;
P = 3.3e3;
            
            pf = P/Irms/Vrms
theta = acos(pf);
Q = Vrms*Irms*sin(theta);
S = P +j*Q;
Z = S/Irms^2
__________________________________________________________________________________
pf =
 1
Z=
 58.6667
          
        


Answer:



Z
L
          = 58.6667 Ω
        


16-4.

          The split-phase circuit on the right has three load impedances that are
          Z
1
          =25 +
          j
          6 Ω,
          Z
2
          = 16 +
          j
          4 Ω, and
          Z
3
          = 100 +
          j
          20 Ω. Use MATLAB to solve the following problems:
        

(a)
          Find the phasor currents in lines A, B, and N.
        

(b)
          Find the complex power produced by each source.
        





SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            Z1 = 25+6i;
Z2 =16+4i;
Z3 =100+20i;
Vs = 110;
disp(
            'Part (a)'
            )
            % Find the current through each load
            11 = Vs/Z1;
12 = Vs/Z2;
13 = 2*Vs/Z3;
IA = I1 + I3
IB = -I2-I3
IN = I2-I1
disp(
            'Part (b)'
            )
S1 = Vs*conj(IA)
S2 = Vs*conj(-IB)
__________________________________________________________________________________
Part (a)
IA=
 6.2757e+000- 1.4216e+000i
IB =
 -8.5860e+000 + 2.0407e+000i
IN=
 2.3102e+000 -619.1599e-003i
Part (b)
S1 =
 690.3322e+000 +156.3720e+000i
S2 =
 944.4570e+000 +224.4796e+000i
          
        



Answers:




            (a) I
            A

          = 6.2757 -
          j
          1.4216 A,
        


            I
            B

          = -8.586 +
          j
          2.0407 A,
        


            I
            N

          = 2.3102 -
          j
          0.6192 A
        

(b)
S
1
          = 690.33 +
          j
          156.37 VA,
        

S
2
          = 944.46 +
          j
          224.48 VA
        


16-5.

          A capacitive plastic welder presents a load made up of a 75-Ω resistor in parallel with a 22-µF capacitor in a 60-Hz, 110-V(rms) supply. Find the impedance seen by the source, the complex power delivered to the load, and the load power factor. State whether the power factor is lagging or leading. Solve using Multisim. Then suppose one were to connect a 300-mH inductor in parallel with the capacitance load,
        



how would the power factor change?


Answers:



          As the tables below show, the input impedance was capacitive reactive without the inductor. The complex power delivered to the load was
          
S

          = 161.33 -
          j
          100.36 VA and the pf was 0.849 leading. After adding the inductor, the input impedance was inductive reactive. The complex power delivered to the load was
          
S

          = 161.6 +
          j
          6.632 VA and the pf was 0.999 lagging.
        



Variable Without Inductor

F
                (Hz)
              
Real
Imaginary




V(v1)/-I(V1)
60
54.08
-33.64


V(v1)/-I(V1)*mag(I(V1))^2
60
161.33
-100.36


real(V(v1)/-I(V1)*mag(I(V1))^2)/mag(V(v1)/-I(V1)*mag(I(V1))^2)
60
0.849
0



Variable with Inductor



F
                  (Hz)
                


Real


Imaginary



V(v1)/-I(V1)
60
74.77
3.076


V(v1)/-I(V1)*mag(I(V1))^2
60
161.6
6.632


real(V(v1)/-I(V1)*mag(I(V1))^2)/mag(V(v1)/-I(V1)*mag(I(V1))^2)
60
0.999
0






16-6.

          In a balanced three-phase circuit, the phase voltage magnitude is
          
V
p

          = 277 V (rms). For a positive phase sequence:
        

(a)
          Find all of the line and phase voltage phasors using
          V
AN
          as the phase reference.
        

(b)
          Sketch a phasor diagram of the line and phase voltages.
        


SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            VP = 277;
            % Positive phase sequence
            VAN = VP*exp(0*1i*pi/l80);
VBN = VAN*exp(-1i*2*pi/3);
VCN = VAN*exp(-1i*4*pi/3);
VAB = sqrt(3)*VAN*exp(1i*pi/6);
VBC = VAB*exp(-1i*2*pi/3);
VCA = VAB*exp(-1i*4*pi/3);
            % Find the magnitude and phase of each voltage
            MagVAN = abs(VAN)
MagVBN = abs(VBN)
MagVCN = abs(VCN)
PhaseVAN =180*angle(VAN)/pi
PhaseVBN =180*angle(VBN)/pi
PhaseVCN =180*angle(VCN)/pi
MagVAB = abs(VAB)
MagVBC = abs(VBC)
MagVCA = abs(VCA)
PhaseVAB = 180*angle(VAB)/pi
PhaseVBC = 180*angle(VBC)/pi
PhaseVCA = 180*angle(VCA)/pi
__________________________________________________________________________________
MagVAN =
 277
MagVBN =
 277
MagVCN =
 277
PhaseVAN =
 0
PhaseVBN =
 -120.0000
PhaseVCN =
 120.0000
          
        

          
            MagVAB =
 479.7781
MagVBC =
 479.7781
MagVCA =
 479.7781
PhaseVAB =
 30.0000
PhaseVBC =
 -90
PhaseVCA =
 150.0000
            % Create the phase diagrams
            line([0,real(VAN)],[0,imag(VAN)],...
            'LineWidth',3,'Color','g'
            ,...
            
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
            'Color','g'
            )
line([0,real(VBN)],[0,imag(VBN)],...
            'LineWidth',3,'Color','b'
            ,...
 'Marker','o',...
            'MarkerSize'
            ,4,...
            'Color','b'
            )
line([0,real(VCN)],[0,imag(VCN)],...
            'LineWidth',3,'Color','r'
            ,...
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
            'Color','r'
            )
grid
            on
            axis(300*[-1 1-11])
xlabel(
            'Real'
            )
ylabel(
            'Imaginary'
            )
title(
            'D16-6 (Phase Voltages)'
            )
legend(
            'V_{an}','V_{bn}','V_{cn}'
            )
figure
line([0,real(VAB)],[0,imag(VAB)],...
            'LineWidth'
            ,3,
            'Color','g'
            ,...
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
            'Color','g'
            )
line([0,real(VBC)],[0,imag(VBC)],...
            'LineWidth'
            ,3,
            'Color','b'
            ,...
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
            'Color','b'
            )
line([0,real(VCA)],[0,imag(VCA)],...
            'LineWidth'
            ,3,
            'Color','r'
            ,...
            'Marker','o'
            ,...
            'MarkerSize'
            ,4,...
 'Color','r')
grid
            on
            axis(500*[-1 1-11])
xlabel(
            'Real'
            )
ylabel(
            'Imaginary'
            )
title(
            'D16-6 (Line Voltages)'
            )
legend(
            'V_{ab}','V_{bc}','V_{ca}'
            )
          
        








Answers:


The phasor diagrams are shown above.



Signal
Amplitude (V)
Angle (deg)





V
AN

277
0



V
BN

277
-120



V
CN

277
120



V
AB

480
30



V
BC

480
- 90



V
CA

480
150





16-7.

          A balanced Y-connected load with
          Z
Y
          =8 +
          j
          6 Ω per phase is connected in parallel with a balanced Δ-connected load with
          
Z
Δ

          = 12-
          j
          18 Ω per phase. Find the phase impedance of an equivalent Y-connected load.
        


SOLUTION:


The equivalent Y-connected load is one-third of the equivalent Δ-connected load of the parallel combination. Use MATLAB to perform the calculations.

          
            clear
            all
            ZY = 8 + 6i;
ZD = 12-18i;
ZDeq = 1/(1/(3*ZY) + 1/ZD);
ZYeq = ZDeq/3
__________________________________________________________________________________
Z
            Yeq
            =
 5.6667 - 2.0000i
          
        



Answer:



          Z
          
YEQ

          = 5.667 -
          j
          2 Ω per phase.
        


16-8.

          In a balanced Y - Δ circuit, the line and load impedances are
          Z
W
          = 1.5 +
          j
          6.5 Ω per phase and
          
z
Δ

          = 15 +
          j
          8 Ω per phase. The line voltage at the source is
          
V
L

          = 250 V (rms) at 60 Hz. Using ∠
          V
AN
          = 0° as the phase reference, find the line current
          I
A
          and phase current
          I
AB
          for a positive phase sequence.
        


SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            ZW = 1.5 + 6.5i;
ZD = 15 + 8i;
VL = 250;
VAN = VL;
VBN = -VL*(.5 + 0.866i);
ZY = ZD/3;
IA = VAN/(ZW + ZY);
IB = VBN/(ZW + ZY);
VD = VAN - IA*ZW;
VE = VBN - IB*ZW;
IAB = (VE - VD)/ZD;
            % Find the magnitude and phase
            MagIA = abs(IA)
PhaseIA =180*angle(IA)/pi
MagIAB = abs(IAB)
PhaseIAB = 180*angle(IAB)/pi
__________________________________________________________________________________
MagIA =
 22.2473
PhaseIA =
 -54.6599
MagIAB =
 12.8444
PhaseIAB =
 155.3394
          
        




          Multisim allows the Δ-circuit to be readily analyzed. Draw the circuit as shown
          
          above. Note that the impedances need to be converted to the time domain. Ask Mul-tisim to perform a Single Frequency AC Analysis at 60 Hz. The desired line current is the current exiting (not entering) the sources
          V
AN
          ,
          V
BN
          , and
          V
CN
          . Hence, select the current through the resistor I(R1). The phase currents are simply the currents through each of the elements in each branch of the delta load. We selected the current through the load resistor I(R5). Grapher View returned the table shown below. These results are the same as those calculated using MATLAB.
        


Answer:





Variable
Frequency (Hz)
Magnitude
Phase (deg)




I(R1)
60
22.248
- 54.658


I(R5)
60
12.845
155.34





16-9.

          In figure on the right, the load at bus 2 draws an average power of
          
p
2

          = 900 kW at a lagging power factor of 0.8. The line current and line impedance are
          I
L
          = 14 A (rms) and
          Z
W
          = 10 +
          j
          75 Ω per phase. Find the source power factor and the line voltages at bus 1 and bus 2.
        






SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            P2 = 900e3;
pf = 0.8;
IL = 14;
ZW = 10+75Ì;
            % Find the complex powers
            S2 = P2/pf*(pf + 1i*sqrt(1-pf^2));
S1 = S2 + 3*abs(IL)^2*ZW;
pf1= real(S1)/abs(S1)
            % Find the line voltages
            VL1 = abs(S1)/sqrt(3)/abs(IL)
VL2 = abs(S2)/sqrt(3)/abs(IL)
__________________________________________________________________________________
pf1 =
 783.2268e-003
VL1 =
 47.6974e+003
VL2 =
 46.3942e+003
          
        


Answers:



          pf
          1
          =0.783,
          

              V
              L1


          =47.6974 kV (rms),
          V
L2
          =46.3942 kV (rms).
        


16-10.

          In the figure shown, the source at bus 1 supplies two load buses through transmission lines with impedances of Z
          W1
          =6 +
          j
          33 Ω per phase and Z
          W2
          = 3 +
          j
          15 Ω per phase. The load at bus 2 draws a complex power of
          
s
2

          = 3.5 +
          j
          1.0 MVA. The load at bus 3 draws a complex power of S
          3
          = 4 +
          j
          1.5 MVA. The line current in line 2 is
          I
L2
          =20 A (rms). Use MATLAB to find the apparent power produced by the source at bus 1; the source power factor; and the line voltages at bus 1, bus 2, and bus 3.
        





SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            ZW1 = 6+33i;
ZW2 = 3+15i;
S2 = 3.5e6 + 1e6i;
S3 = 4e6 + 1.5e6i; IL2 = 20;
pf2 = real(S2)/abs(S2);
pf3 = real(S3)/abs(S3);
VL3 = abs(S3)/sqrt(3)/IL2
SW2 = 3*abs(IL2)^2*ZW2;
VL2 = abs(S3 + SW2)/sqrt(3)/IL2
IL1 = abs(S3 + SW2 + S2)/sqrt(3)/VL2;
SW1 = 3*abs(IL1)^2*ZW1;
S1 = S3 + SW2 + S2+ SW1;
MagS1 = abs(S1)
pf1 = real(S1)/abs(S1)
VL1 = MagS1/sqrt(3)/abs(IL1)
__________________________________________________________________________________
VL3 =
 123.3221e+003
VL2 =
 123.6026e+003
MagS1 =
 7.9821e+006
pf1 =
 943.1357e-003
VL1 =
 124.6534e+003
          
        


Answers:



          |S
          1
          | =7.9821 MVA, = 0.943,
          V
L1
          =124.7 kV (rms),
          V
L2
          = 123.6kV (rms),and
          V
L3
          =123.3 kV (rms)
        


Chapter 17
This is essentially a basic circuit analysis chapter that is very useful for those students studying electronics. Numerical problems can be solved using Multisim. Literal problems need MATLAB.





17-1.

          Find the
          z
          -parameters for the circuit shown.
        


SOLUTION:



          Use Multisim's DC Operating Point Analysis. Select an arbitrary input voltage (1 V, will do) and measure the input current and output voltage to find
          z
11
          and
          z
21
          . Use an arbitrary voltage source between terminal 2 and ground and measure the voltage between terminal 1 and ground and the current through the source at terminal 2 to find
          z
12
          and
          z
22
          .
        






Answers:







17-2.

          Find the
          y
          -parameters for the circuit shown in the figure to the right.
        


SOLUTION:



          Use Multisim's DC Operating Point Analysis. With the output shorted, select an arbitrary input voltage (we used 1 V) and measure the input current and the current entering terminal 2 (it actually exits) to find
          y
11
          and
          y
21
          . Then short the input and use an arbitrary voltage source between terminal 2 and ground and measure the current entering (it actually exits since we shorted out
          V
2
          ) terminal 1 and the current through the source at terminal 2 to find
          y
12
          and
          y
22
          .
        








Answers:







17-3.

          The
          z
          -parameters of a two-port circuit are
          z
11
          =1 kΩ and
          z
12
          =
          z
21
          =
          z
22
          = 500 Ω. Find the port currents
          
I
1

          and
          
I
2

          when a 12-V voltage source is connected at the input port and a 250-Ω resistor is connected at the output port.
        



SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            syms
            V1 V2 I1 I2
            z11 = 1e3;
z12 = 500;
z21 = 500;
z22 = 500;
Rout = 250;
Vin = 12;
Eqn1 = Vin-z11*I1-z12*I2;
Eqn2 = -Rout*I2-z21*I1-z22*I2;
Soln = solve(Eqn1,Eqn2,I1,I2);
I1 = double(Soln.I1)
I2 = double(Soln.I2)
__________________________________________________________________________________
I1 =
 18.0000e-003
I2 =
 -12.0000e-003
          
        


Answers:



I
1
          =18 mA
        

I
2
          = −12 mA
        


17-4.

          Find the h-parameters of the two-port network for the OP AMP circuit shown.
        





SOLUTION:


Use MATLAB to perform the calculations.

          
            clear
            all
            syms
            V1 V2 I1 I2 R1 R2
            % Set V2 = 0 to solve for h11 and h21
            V1 = R1*I1;
h11 = simplify(V1/I1);
I2 = -(V1-0)/R2;
h21 = simplify(I2/I1);
            % Set I1 = 0 to solve for h12 and h22
            I1 = 0;
V1 = R1*I1;
h12 = simplify(V1/V2);
V2 = I2*R2;
h22 = simplify(I2/V2);
h = [h11, h12; h21, h22]
__________________________________________________________________________________
h=
[	    R1,		   0]
[	-R1/R2,		1/R2]
          
        


Answers:



h
11
          =
          R
1
          ,
          h
12
          = 0,
          h
21
          = -
          R
1
          /
          R
2
          ,
          h
22
          = 1/
          R
2



17-5.


          The
          i-v
          relationships of a two-port are
          V
1
          = 2000
          I
1
          - 20
          V
2
          and
          I
2
          = 50
          I
1
          + 10
          −2
V
2
          . Find the
          y
          -parameters of the two-port. Is the two-port reciprocal?
        


SOLUTION:



          The
          i-u
          relationships are given in terms of the
          h
          -parameters. Use the conversions in Table 17-2 to determine the y-parameters. Use MATLAB to perform the calculations.
        

          
            clear
            all
            h11 = 2000;
h12 = -20;
h21= 50;
h22 = 0.01;
y11= 1/h11;
y12 = -h12/h11;
y21 = h21/h11;
y22 = (h11*h22-h12*h21)/h11;
y = [y11, y12; y21, y22]
Reciprocal = y12 = =y21
__________________________________________________________________________________
y =
 500.0000e-006 10.0000e-003
 25.0000e-003 510.0000e-003
Reciprocal =
            
              logical
            
            0
          
        


Answers:



y
11
          = 500 μS
        

y
12
          = 10 mS
        

y
21
          = 25 mS
        

y
22
          = 510 mS
        
The two-port is not reciprocal.




          Chapter 18
        
Fourier transform problems take advantage of the built-in Fourier transform toolbox
in MATLAB.


18-1.

          Use the defining integral to find the Fourier transform of
          f(t
          ) =
          A
          [
          u(t
          ) -
          u(t
          -2)].
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t
            syms
            w A real
            ft = A*(heaviside(t)-heaviside(t-2));
Fw = simplify(int(ft*exp(-1i*w*t),t,0,4))
            % Check the results
            Fw2 = simplify(fourier(ft,t,w))
__________________________________________________________________________________
Fw =
-(A*1i - A*exp(-w*2i)*1i)/w
Fw2 =
(A*(cos(2*w)*1i + sin(2*w) - 1i))/w
          
        


Answer:







18-2.

          Use the defining integral to find the Fourier transform of
          f
          (
          t
          ) =
          At [u(t
          ) -
          u(t
          -
          2)].



SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t w A real
            ft = A*t*(heaviside(t)-heaviside(t-2));
Fw = simplify(int(ft*exp(-1i*w*t),t,0,4))
            % Check the results
            Fw2 = simplify(fourier(ft,t,w))
__________________________________________________________________________________
Fw =
(- A + A*exp(-w*2i) + A*w*exp(-w*2i)*2i)/w^2
Fw2 =
(A*(cos(2*w) - sin(2*w)*1i +w*cos(2*w)*2i+2*w*sin(2*w) -1))/w^2
          
        


Answer:







18-3.

          Use the inversion integral to find the inverse transform of the following function:
        





SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            w t real
            Fw = 5*pi*(heaviside(w+2)-heaviside(w-2));
ft = int(Fw*exp(1i*w*t),w,-4, 4)/2/pi
            % Check the results
            ft2 = simplify(ifourier(Fw,w,t))
__________________________________________________________________________________
ft =
(5*sin(2*t))/t
ft2 =
(5*sin(2*t))/t
          
        


Answer:







18-4.


          Use MATLAB and the inversion integral to find the inverse transform of the following function:
        





SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms wt
Fw = sin(pi*w/4)*(heaviside(w)-heaviside(w-4));
ft = int(Fw*exp(1i*w*t),w,-inf,inf)/2/pi
            % Check the results
            ft2 = simplify(ifourier(Fw,w,t))
__________________________________________________________________________________
ft =
(2*(exp(t*4i) + 1))/(pi^2 - 16*t^2)
ft2 =
(2*cos(4*t) + sin(4*t)*2i + 2)/(pi^2 - 16*t^2)
          
        


Answer:







18-5.

          Use MATLAB to find the inverse transforms of the following functions:
        

(a)



(b)




SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            w t
            disp(
            'Part (a)'
            )
Fw = 800/1i/w/(1i*w+10)/(1i*w+20);
ft = expand(ifourier(Fw,w,t))
disp(
            'Part (b)'
            )
Fw = -(w^2)/(1i*w+10)/(1i*w+20);
ft = simplify(ifourier(Fw,w,t))
__________________________________________________________________________________
Part (a)
ft =
2*exp(-20*t) - 4*exp(-10*t) +2*sign(t)
- 4*exp(-10*t)*sign(t) + 2*exp(-20*t)*sign(t)
Part (b)
ft =
dirac(t) + 5*exp(-2 0*t)*(sign(t)+1)*(exp(10*t)-4)
          
        
Part (a) can also be solved efficiently using partial fraction expansion.





          Then apply the basic Fourier transform pairs to find the result.
        
Part (b) can also be solved efficiently using partial fraction expansion.





Answer:



(a)
f
1
          (
          t
          ) =2sgn(
          t
          ) + 4 (
          e

            −20
            t

          −
          2e
−10t
          )
          u
          (
          t
          )
        

(b)
f
2
          (
          t
          ) = δ(
          t
          ) +(10
          e
−10t
          −40
          e
−20t
          )
          u
          (
          t
          )
        


18-6.

          Find the Fourier transforms of the following waveforms:
        

(a)
f
1
          (
          t
          ) = 2
          u
          (
          -t
          ) -2
        

(b)

            f
            2
            (
          
t
          ) = -2sgn(
          t
          ) -2
          u
          (
          −t
          )
        

(c)
f
3
          (
          t
          ) = - sgn(
          t
          ) -1
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            w t
            disp(
            'Part (a)'
            )
ft = 2*heaviside(-t)-2;
Fw = fourier(ft,t,w)
disp(
            'Part (b)'
            )
ft = -2*sign(t)-2*heaviside(-t);
Fw = fourier(ft,t,w)
disp(
            'Part (c)'
            )
ft = -sign(t)-1;
Fw = fourier(ft,t,w)
__________________________________________________________________________________
Part (a)
Fw =
-2*pi*dirac(w)+2*i/w
Part (b)
Fw =
-2*pi*dirac(w)+2*i/w
Part (c)
Fw =
-2*pi*dirac(w)+2*i/w
          
        
The three waveforms are identical, so they all have the same Fourier transform.


Answer:




            (a)
            




            (b)
            




            (c)
            




18-7.


          Use the duality property to find the inverse transforms of the following functions:
        

(a)
F
1
          (ω) = 3cos(10ω)
        

(b)
F
2
          (ω) = 6
          u
          (ω) -3
        

(c)
F
3
          (ω)
          = 6e
−
          |
          3ω
          |
        


SOLUTION:



          The duality transform property is, given
          


          For each transform, set 2π
          f
          /(-ω) equal to the transformed function and then solve for
          f
          (ω). Substitute
          t
          for ω to find
          f
          (
          t
          ). Take the transform of
          f
          (
          t
          ) to get
          F
          (ω). Substitute
          t
          for ω to find
          F(t).


(a)



(b)



(c)




Answer:



(a)



(b)



(c)




18-8.


          Use the frequency shifting property to prove the modulation property
        





SOLUTION:



          The frequency shifting property is, given
          

We can rewrite the time-domain signal as follows:



We can then take the transform, as follows:





Answer:


The transform is demonstrated above.


18-9.

          The input to the figure below is
          υ
1
          (
          t
          ) =10
          e
4t
u
          (-
          1
          ) V. Use Fourier transforms to find
          v
2
          (
          t
          ).
        


SOLUTION:


The solution is presented in the following MATLAB calculations.





          
            clear
            all
            syms
            t w
            % Find the transform of the input
            v1t = 10*exp(4*t)*heaviside(-t);
V1w = fourier(v1t,t,w);
            % Find the transfer function
            R1 = 10e3;
R2 = 20e3;
C = 1e-6;
ZC = 1/1i/w/C;
Z2 =1/(1/ZC +1/R2);
Tjw = Z2/(R1 + Z2);
            % Compute the output signal transform and waveform
            V2w = Tjw*V1w;
v2t = ifourier(V2w,w,t)
__________________________________________________________________________________
v2t =
-((500*pi*exp(4*t)*(sign(t)-1))/77
- (500*pi*exp(-150*t)*(sign(t)+1))/77)/(2*pi)
          
        


Answer:







18-10.

          The input to the figure below is
          υ
1
          (
          t
          ) = 10sgn(
          t
          ) V. Use Fourier transforms to find
          v
2
          (
          t
          ).
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t w
            % Find the transform of the input
            v1t = 10*sign(t);
V1w= fourier(v1t,t,w);
            % Find the transfer function
            R1 = 10e3;
R2 = 2 0e3;
C = 1e-6;
ZC = 1/1i/w/C;
Z2 = 1/(1/ZC +1/R2);
Tjw = Z2/(R1 + Z2);
            % Compute the output signal transform and waveform.
            V2w = Tjw*V1w;
v2t = ifourier(V2w,w,t)
__________________________________________________________________________________
v2t =
((40*pi*sign(t))/3 - (40*pi*exp(-150*t)*(sign(t)+1))/3)/(2*pi)
          
        





Answer:







18-11.

          The input to the figure below is
          v
1
          (
          t
          ) = 8
          u
          (
          -t
          )V. Use Fourier transforms to find
          
            u
            2
            (t).
          






SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t w
            % Find the transform of the input
            vlt = 8*heaviside(-t);
Vlw= fourier(v1t,t,w);
            % Find the transfer function
            Rl = 10e3;
R2 = 2 0e3;
C = le-6;
ZC = 1/li/w/C;
Zl = Rl + ZC;
Z2 = R2;
Tjw = -Z2/Zl;
            % Compute the output signal transform and waveform.
            V2w = Tjw*Vlw;
v2t = ifourier(V2w,w,t)
__________________________________________________________________________________
v2t =
8*exp(-l00*t)*(sign(t)+l)
          
        


Answer:








18-12.

          The impulse response of a linear system is
          h
          (
          t
          ) =
          
            e
            −2t
            u(t
          
          ). Find the output for an input
          x
          (
          t
          ) =
          u
          (
          -t
          ).
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t w
            % Find the Fourier transform of the impulse response
            ht = exp(-2*t)*heaviside(t);
Hw = fourier(ht,t,w);
            % Find the Fourier transform of the input signal
            xt = heaviside(-t);
Xw = fourier(xt,t,w);
            % Find the Fourier transform of the output signal
            Yw = Hw*Xw;
            % Find the output waveform
            yt = simplify(ifourier(Yw,w,t))
__________________________________________________________________________________
yt =
exp(-2*t)/4-sign(t)/4 + (exp(-2*t)*sign(t))/4 +1/4
          
        


Answer:







18-13.

          The impulse response of a linear system is
          h(t
          ) = -
          Ae

            −α
            t

u(t)
          +
          Ae
−α
          (
          
            −
            t

          )
          u
          (-
          t
          ), with α > 0. Let
          A
          = 5 and α = 2 and use MATLAB to plot |H(ω)|. On the same axes, plot |
          H
          (ω)| for
          A
          = 5 and α = 4. Describe the system frequency response and the influence of the parameter α.
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t w
            syms
            A a positive
            ht = -A*exp(-a*t)*heaviside(t)+ A*exp(a*t)*heaviside(-t);
Hw = fourier(ht,t,w);
            % Solve for with the given values for A and alpha
            H1w = simplify(subs(Hw,(A,a},{5,2}))
H2w = simplify(subs(Hw,{A,a},{5,4}))
            % Compute the responses for values of w
            ww = -10:0.01:10;
H1ww= subs(H1w,w,ww);
H2ww= subs(H2w,w,ww);
MagH1ww = abs(H1ww);
MagH2ww = abs(H2ww);
            % Plot the results
            plot(ww,MagH1ww,
            'b','LineWidth'
            ,3)
hold
            on
            grid
            
              on
              
            
            plot(ww,MagH2ww,
            'g','LineWidth'
            ,3)
xlabel(
            'Frequency'
            )
ylabel(
            'Amplitude'
            )
legend(
            '|H_1(\omega)|','|H_2(\omega)|'
            , ...
            'Location','SouthEast'
            )
__________________________________________________________________________________
H1w =
(w*10i)/(w^2 + 4)
H2w =
(w*10i)/(w^2 +16)
          
        





Answer:


The plot is shown above. The system frequency response is that of a bandpass filter. The parameter a influences the center frequency of the pass band. As α increases, the center frequency increases. In addition, as the parameter increases, the magnitude of the pass band gain decreases.


18-14.

          The frequency response of a linear system is shown in the figure below. Find the system impulse response
          h(t).



SOLUTION:


The solution is presented in the following MATLAB calculations.




          
            clear
            all
            syms
            t w B
            Hw = heaviside(w+2*B)+heaviside(w+ B) ...
 -heaviside(w-B)-heaviside(w-2*B);
ht = simplify(ifourier(Hw,w,t))
__________________________________________________________________________________
ht =
(sin(B*t) +sin(2*B*t))/(t*pi)
          
        



Answer:







18-15.

          Find the 1-Ω energy carried by the signal
          F
          (ω) = 8/(ω
          2
          + 4).
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            w t
            Fw = 8/(w^2 + 4);
            % Compute the integral in the frequency domain
            W = int((abs(Fw))^2,w,-inf,inf)/2/pi
            % Check the results with the time-domain integral
            ft = ifourier(Fw,w,t);
Wt = int(ft^2,t,-inf,inf)
__________________________________________________________________________________
W=
2
Wt =
2
          
        


Answer:







18-16.

          The impulse response of a filter is
          h(t)
          = 20
          
            e
            −40t
            u(t).
          
          Find the 1-Ω energy in the output signal when the input is
          x
          (
          t
          ) = 5 e
          −10t
u
          (
          t
          ).
        


SOLUTION:


The solution is presented in the following MATLAB calculations.

          
            clear
            all
            syms
            t w
            ht = 20*exp(-40*t)*heaviside(t);
xt = 5*exp(-10*t)*heaviside(t);
            % Compute the output signal
            Hw = fourier(ht,t,w);
Xw = fourier(xt,t,w);
Yw = Hw*Xw;
            % Find the energy in the output signal
            W = int((abs(Yw))^2,w,-inf,inf)/2/pi
__________________________________________________________________________________
W=
1/4
          
        


Answer:




















Appendix F

COMPLEX NUMBERS




Using complex numbers to represent signals and circuits is a fundamental tool in electrical engineering. This appendix reviews complex-number representations and arithmetic operations. These procedures, though rudimentary, must be second nature to all who aspire to be electrical engineers. Exercises are provided to confirm your mastery of these essential skills.

F-1 Complex-Number Representations

          A complex number
          z
          can be written in rectangular form as
        


(F-1)




          where
          j
          represents
          
          . Mathematicians customarily use
          i
          to represent
          
          , but
          i
          represents current in electrical engineering, so we use the symbol
          j
          instead.
        

          The quantity
          z
          is a two-dimensional number represented as a point in the complex plane, as shown in
          Figure F-1
          . The
          x
          component is called the
          real part
          and
          y
          (not
          jy
          ) the
          imaginary part
          of z. A special notation is sometimes used to indicate these two components:
        


(F-2)




          where Re{
          z
          } means the real part and Im{
          z
          } the imaginary part of
          z
          .
        

Figure F-1
          also shows the polar representation of the complex number
          z
          . In polar form, a complex number is written
        



(F-3)





          where
          M
          is called the
          magnitude
          and θ the
          angle
          of
          z
          . A special notation is also used to indicate these two components.
        


(F-4)




          where |
          z
          | means the magnitude and
          
          the angle of
          z
          .
        

          The real and imaginary parts and magnitude and angle of
          z
          are all shown geometrically in
          Figure F-1
          . The relationships between the rectangular and polar forms are easily derived from the geometry in
          Figure F-1
          :
        



(F-5)





          The inverse tangent relation for 0 involves an ambiguity that can be resolved by identifying the correct quadrant in the
          z
          -plane using the signs of the two rectangular components.
          

Caution:


          In calculating
          
          hand-held calculators do not recognize if a minus sign belongs to the real or to the imaginary part of the ratio or if the signs cancel. The calculated angle is either in the first or fourth quadrant and may be off by 180°. [See
          Exercise F-1
          (b) and (c).]
        







FIGURE F-1



Graphical representation of complex numbers.



Another version of the polar form is obtained using Euler's relationship:


(F-6)




We can write the polar form as


(F-7)




          This polar form is equivalent to
          Eq. (F-3)
          , since the right side yields the same polar-to-rectangular relationships as
          Eq. (F-5)
          . Thus, a complex number can be represented in three ways:
        


(F-8)




          The relationships between these forms are given in
          Eq. (F-5)
          .
        

          The quantity
          z*
          is called the conjugate of the complex number
          z
          . The asterisk indicates the
          conjugate
          of a complex number formed by reversing the sign of the imaginary component. In rectangular form, the conjugate of
          z
          =
          x
          +
          jy
          is written as
          z
          * =
          x - jy.
          In polar form, the conjugate is obtained by reversing the sign of the angle of
          
          . The geometric interpretation in
          Figure F-2
          shows that conjugation simply reflects a complex number across the real axis in the complex plane.
        







FIGURE F-2



Graphical representation of conjugate complex numbers.








Exercise F-1
Convert the following complex numbers into polar form:





Answers:














Exercise F-2
Convert the following complex numbers into rectangular form:





Answers:














Exercise F-3
Evaluate the following expressions:





Answers:









F-2 Arithmetic Operations:Addition and Subtraction
Addition and subtraction are defined in terms of complex numbers in rectangular form. Two complex numbers


(F-9)




          are added by separately adding the real parts and imaginary parts. The sum
          z
1
          +
          z
2
          is defined as
        


(F-10)



Subtraction follows the same pattern except that the components are subtracted:


(F-11)




Figure F-3
          shows a geometric interpretation of addition and subtraction. In particular, note that
          z
          +
          z*
          = 2
          x
          and
          z - z*
          =
          j
          2
          y
          .
        







FIGURE F-3



Graphical representation of addition and subtraction of complex numbers.






F - 3 Multiplication and Division
Multiplication and division of complex numbers can be accomplished with the numbers in either rectangular or polar form. For complex numbers in rectangular form, the multiplication operation yields



(F-12)




For numbers in polar form, the product is


(F-13)




          Multiplication is somewhat easier to carry out with the numbers in polar form, although both methods should be understood. In particular, the product of a complex number
          z
          and its conjugate
          z*
          is the square of its magnitude, which is always positive.
        


(F-14)



For complex numbers in polar form, the division operation yields


(F-15)



When the numbers are in rectangular form, the numerator and denominator of the quotient are multiplied by the conjugate of the denominator.




          Applying the multiplication rule from
          Eq. (F-l2)
          to the numerator and denominator yields
        


(F-16)



Complex division is easier to carry out with the numbers in polar form, although both methods should be understood.





Exercise F-4

              Evaluate the following expressions using
              






Answers:














Exercise F-5

              Given
              
              , evaluate the following statements:
            





Answers:
















              Exercise F-6
            

              Given
              



Answers:














Exercise F-7

              Evaluate the expression
              



Answers:














Exercise F-8





Answer:



















EXAMPLE F-1

                  Find
                  
                  , when
                







SOLUTION:



              Keep the
              Z
              's intact and simplify the fraction
            




              Convert all the
              Z
              's into polar form and substitute all the values of
              Z
              into the equation
            



Carry out the multiplications



Convert the terms in the denominator to rectangular form to facilitate the addition



Add the real and imaginary parts of the denominator and convert the denominator back to polar form




              Divide the denominator into the numerator to solve for
              Z
EQ



■


















Appendix G

STANDARD VALUES AND REFERENCES





THE RESISTOR COLOR CODE












Some precision resistors have a fifth band. In these cases, the third band is another digit, the multiplier becomes the fourth band, and the tolerance the fifth band.








RESISTOR POWER RATINGS







                Resistor power ratings set the maximum power a resistor can dissipate and remain in its linear region. Typical ratings for electronictype resistors are
                
                and 2 W. Generally, these are distinguished by size.
              





STANDARD VALUES FOR RESISTORS






CAPACITOR STANDARD VALUES





CAPACITOR TOLERANCES AND OTHER CAPACITOR FACTS







Capacitor Tolerances:
                Capacitor values, like those of resistors, are nominal. That is, their stated values are guaranteed within their assigned tolerances. Many capacitors are rated similar to resistors at ± 5%, ± 10%, or ± 20% depending on their
                E
                rating. Hence, capacitors with an E6 rating are ± 20%, those with an E12 rating are rated at ± 10%, and those with an E24 rating are ± 5%. The values above for the first three columns of pF capacitor values are E24, the last pF column lists capacitor values as E12 and the rest of the μF, mF, and F columns are E6. There are other ratings, especially for a class of capacitors called
                electrolytics
                that have unbalance tolerances such as −10% - +50%, or even 0% - +100%. One should look carefully at the ratings when using unbalanced tolerances.
              



Working Voltages:
                The Working Voltage defines the maximum continuous voltage either DC or AC that can be applied to the capacitor without failure during its working life. Generally, the working voltage printed onto the side of a capacitors body refers to its DC working voltage, (WVDC). The AC voltage value refers to the rms voltage applied. Exceeding the working voltage may cause the capacitor to fail. Common working DC voltages are 10 V, 16 V, 25 V, 35 V, 50 V, 63 V, 100 V, 160 V, 250 V, 400 V and 1000 V and are printed onto the body of the capacitor.
              



Polarity:
                Most capacitors are bilateral meaning that it does not matter which way they are inserted into a circuit. However, some capacitors, namely electrolytics, are polarized. This means that the voltage connected to the capacitor terminals must have the correct polarity, i.e., + to + and − to −. Incorrect polarization can cause the oxide layer inside the capacitor to break down resulting in very large destructive currents flowing through the device.
              






INDUCTOR STANDARD VALUES





INDUCTOR TOLERANCE VALUES







Tolerances:
                Inductor tolerances are designated by a letter that is often stamped on the inductor.
              













Current Ratings:
                All inductors have a maximum current rating which specifies the maximum continuous current that can be safely applied to the inductor. Typical current ratings for small inductors are 100 mA, 1A, 2.5A, 5A and 10 A
              





PARASITIC ISSUES







Resistors:
                Most composite resistors behave as expected as long as they are operated in their linear range, Wirewound resistors can display parasitic problems of series capacitance and inductance.
              



Inductors:
                Most inductors have a parasitic resistance
                R
S
                that can alter its frequency characteristics. Even at low frequencies the series resistance needs to be accounted for. At higher frequencies there can also be a parasitic capacitance similar to that exhibited by wirewound resistors, but for most applications these can be small. See Figure (a) at right.
              



Capacitors:
                Most capacitors are true to their values until at high frequencies they begin to exhibit parasitic issues. There is a leakage resistance
                R
L
                that appears across the capacitor. This can be a serious problem with electrolytics. A self-inductance caused by the plates can become a concern at high frequencies. See Figure (b) at right.
              









ELECTRIC QUANTITIES





STANDARD DECIMAL PREFIXES





FUNDAMENTAL RELATIONSHIPS






BASIC OP AMP MODULES






BASIC LAPLACE TRANSFORMATION PROPERTIES





BASIC LAPLACE TRANSFORM PAIRS





SALLEN-KEY FILTER REALIZATIONS





NORMALIZED POLYNOMIALS THAT PRODUCE BUTTERWORTH RESPONSES





NORMALIZED POLYNOMIALS THAT PRODUCE CHEBYSHEV RESPONSES






MULTIPOLE-FILTERS RESPONSES

















Appendix H

ANSWERS TO SELECTED PROBLEMS




CHAPTER 01


1-1


                (a) 3600 s = 3.6 × 10
                3
                s = 3.6 ks = 1 hour
              

                (b) 5 × 10
                13
                W = 50 × 10
                12
                W = 50 TW
              

                (c) 850,000 Hz = 850 × 10
                3
                Hz = 850 kHz
              

                (d) 68 × 10
                -12
                F = 68 pF
              



1-3
            19.44 MC
          

1-5
            In ascending order, the values are 0.1632 Ω, 1.12 Ω, 1.5 Ω, and 1.6 Ω.
          

1-7








1-9
i
            (
            t
            ) = 200 μA
          

1-11



1-13
P
Max
            = 50 mW
          


1-15




Case



υ




i




p



Power Transfer





(a)
+12 V
- 1.2A
- 14.4W
B to A


(b)
+80 V
+10 mA
+800 mW
A to B


(c)
- 240 V
- 12 mA
+ 2.88 W
A to B


(d)
- 15 V
- 300 μA
+4.5 mW
Ato B





1-17
υ
4
            = 5047 V; absorbing power
          

1-21
            60%
          

1-23
            The LED lamp saves $266.50 over the incandescent bulbs, $288.75 over the halogen bulbs, and $79.50 compared to the CFLs.
          



CHAPTER 02


2-1
υ
            = 103.4 V
          

2-3
R
            = 33 kΩ,
            i
            = 151.52 μA
          

2-5


                (a)
                R
x
                = 968 Ω
              
(b) The fuse will not blow



2-7

(a) It is not properly color coded
(b) The stripe sequence is green, blue, orange, and gold.



2-9


                (a) MATLAB code:
                
                  v= [-1.0, -0.8, -0.4, -0.2, -0.1, 00.1,
0.2, 0.4, 0.8, 1.0];
ii = 5e-17*(exp(40*v)-1);
p = v.*ii;
Results = [v' ii' p']
                
MATLAB results:

                  Results =
  -1.0000e+000  -50.0000e-018  50.0000e-018
-800.0000e-003  -50.0000e-018  40.0000e-018
-400.0000e-003  -50.0000e-018  20.0000e-018
-200.0000e-003  -49.9832e-018   9.9966e-018
-100.0000e-003  -49.0842e-018   4.9084e-018
   0.0000e+000    0.0000e+000   0.0000e+000
 100.0000e-003    2.6799e-015 267.9908e-018
 200.0000e-003  148.9979e-015  29.7996e-015
 400.0000e-003  444.3055e-012 177.7222e-012
 800.0000e-003    3.9481e-003   3.1585e-003
   1.0000e+000   11.7693e+000  11.7693e+000
                




(b) The diode is nonlinear and nonbilateral; the power is always positive, so it is passive

                (c)
                i
                = 36.13 × 10
                69
                A and
                p
                = 180.65 χ 10
                69
                W; the model is not valid because the current and power are too large
              

                (d)
                i
                = -50.00 × 10
                -18
                A and
                p
                = 250.00 × 10
                -18
                W; the model is valid because the current and power are both essentially zero
              



2-11

(a) Elements 1 and 2 are in series because they share a connection at Node B with no other elements. Elements 3 and 4 are in parallel because they have Nodes A and C in common.
(b) There are three nodes, namely Nodes A, B, and C. There are three loops with the first formed by Elements 1, 2, and 3; the second by Elements 1, 2, and 4; and the third by Elements 3 and 4.

                (c)
                i
1
                = 6 A;
                i
4
                = -4 A.
              



2-13
i
1
            = 35 mA;
            i
3
            = 15 mA
          

2-15
υ
1
            = 50 V;
            υ
5
            = 24 V;
            υ
6
            = 26 V
          

2-17

(a) None of the elements are in series or parallel

                (b)
                υ
1
                = 25 V;
                υ
3
                = 15 V;
                υ
6
                = 20 V
              
(c) Elements 1 and 2 are in parallel elements 4 and 5 are in parallel
(d) Elements 1 and 2 are in series elements 4 and 5 are in series



2-19


                (a)
                




                (b) If
                υ
5
                = 0 V, then all of the other elements are in parallel. The voltages across elements 1, 2, 3, and 4 will all have the same magnitude, but their signs will vary according to the reference marks given.
              




2-21



KVL connection equation:



KCL connection equations for Nodes A, B, and C:



The element constraints are:




i
x
              = -2 mA;
              υ
x
              = -1.12 V;
              p
S
              = -3.56 mW
            


2-23
            We can connect up to 8 bulbs in parallel across the batteries
          

2-25
p
X
            =
            p
s
            = -603.659 kW;
            i
x
            =
            i
3
            = 1.341 A
          

2-27
υ
x
            = -12 V;
            i
x
            = -363.6 μA;
            p
x
            = 4.364 mW
          

2-29
R
EQ
            = 29.674 kΩ
          

2-31

(a) Switch 1 open and switch 2 closed
(b) Both switches closed
(c) Switch 1 closed and switch 2 open
(d) Both switches open



2-33
            Switch open:
            R
AB
            = 10 kΩ;
            R
AC
            = 15 kΩ;
            R
AD
            = 20 kΩ;
            R
BC
            = 25 kΩ;
            R
BD
            = 10kΩ;
            R
CD
            = 35 kΩ
            
            Switch closed:
            R
AB
            = 5kΩ;
            R
AC
            = 15kΩ;
            R
AD
            = 0kΩ;
            R
BC
            = 20 kΩ;
            R
BD
            = 5kΩ;
            R
CD
            = 15 kΩ
          

2-35




R
EQ
                    (Ω)
                  
Combination of 1-kΩ Resistors




1000

                    One resistor:
                    R



2000

                    Two resistors in series:
                    R
                    +
                    R



500

                    Two resistors in parallel:
                    R
                    ||
                    R



1500

                    One resistor in series with a parallel combination of two resistors:
                    R
                    + (
                    R
                    ||
                    R
                    )
                  


2500

                    Two resistors in series with a parallel combination of two resistors:
                    R
                    +
                    R
                    +
                    R
                    ||
                    R
                    )
                  


3000

                    Three resistors in series:
                    R
                    +
                    R
                    +
                    R



333

                    Three resistors in parallel:
                    R
                    ||
                    R
                    ||
                    R



250

                    Four resistors in parallel:
                    R
                    ||
                    R
                    ||
                    R
                    ||
                    R



1330

                    One resistor in series with three resistors in parallel:
                    R
                    + (
                    R
                    ||
                    R
                    ||
                    R
                    )
                  


2330
Cannot be done with four resistors, but could be done with five


4000

                    Four resistors in series:
                    R
                    +
                    R
                    +
                    R
                    +
                    R






2-37


                (a) A current source in series with a resistor is equivalent to the current source
                




                (b) A voltage source in series with a resistor with
                υ
S
                = 20 V and
                R
                = 1 MΩ
              

                (c) A voltage source in parallel with a resistor is equivalent to the voltage source
                




                (d) Two voltage sources in series combine by summing the voltage values with
                υ
EQ
                = 0 V, so the equivalent circuit is a short circuit
              
(e) There is no simple equivalent for the circuit

                (f) Two current sources in parallel combine by summing the current values with
                i
EQ
                =70 mA
                






2-39
            5kΩ ≤
            R
EQ
            ≤ 20 kΩ
          

2-41
R
EQ 
            = 
            R  
            /3   
          

2-43
i
x 
            = 0.6923 A; 
            i
y   
            = 1.3846 A; 
            i
z  
            = 0.9231 A;   
            i
x    
            +  
            i
y   
            + 
            i
z 
            = 3 A    
          

2-45
υ
O 
            = 4.8 V   
          

2-47




R
X
              is a series combination of a 2.2-kΩ resistor and an 82-Ω resistor
            



2-49




R
P
              = 2kΩ and
              p
              = 1.25 W
            




R
S
              = l kΩ and
              p
              = 0.625 W
            
The design with the series interface draws less power from the source than the design with the parallel interface


2-51
υ
x
            = 7.14 V;
            i
x
            = 286 mA
          

2-53
υ
x
            = 1.0 V;
            i
x
            = -2.0 mA;
            p
x
            = 96 mW
          

2-55




i
x
              = 100 mA
            


2-57
R
L
            = 350 Ω
          

2-59





2-65


                (a)
                



(b) Nonlinear, passive, and bilateral

                (c) |
                υ
                | ≤ 0.5923 V
              

                (d) |
                υ
                | ≥ 5.923 V
              



2-69
            Both circuits exactly meet the specification. In addition, both interface designs use a single, non-standard resistor value when considering resistors at the ±10% tolerance level. With Interface #1, the source experiences an equivalent resistance of 1.25 kΩ and provides
            
            of power. With Interface #2, the source experiences an equivalent resistance of 5 kΩ and provides
            p
s
            = 225/5000 = 45 mW. If we want to minimize the power provided by the source, Interface #2 is a better choice, since all other factors are equal.
          



CHAPTER 03


3-1





3-3


                (a)
                




                (b)
                


                (c)
                





3-5





3-7


                (a)
                


                (b)
                


                (c)
                


                (d)
                






3-9


                (a)
                







                (b)
                υ
A
                = 15.7895 V;
                υ
B
                = 57895 V;
                υ
x
                = -24.2105 V;
                i
x
                = 578.9474 μA
              

                (c)
                






3-11


                (a)
                


                (b)
                i
A
                = 840.3 μA;
                i
B
                = -840.3 μA
              

                (c)
                υ
x
                = -2.773 V;
                i
x
                = -1.681 mA
              



3-13


                (a)
                



                (b)
                


                (c) The node-voltage equations would be easier to solve, because there are only two unknown voltages,
                υ
A
                and
                υ
B


                (d)
                


                (e)
                




3-15


                (a)
                


                (b)
                


                (c)
                υ
x
                = 3.8142 V;
                i
x
                = 3.0261 mA
              

                (d)
                p
S1
                = 45.3918 mW
              

                (e)
                






3-17


                (a)
                


                (b)
                

(c) The node-voltage equation will be easier to solve, because there is only one equation and one unknown value

                (d)
                




3-19


                (a)
                


                (b)
                


                (c)
                




3-21


                (a)
                


                (b)
                


                (c)
                


                (d)
                



                (e)
                









3-23





3-25





3-27


                (a)
                K
                = -0.688
              

                (b)
                K
                = 46.875 μS
              



3-29
υ
O
            = 805.814 V
          

3-31
υ
O
            = 1.25V
          

3-33
υ
x
            = 14.4V;
            i
X
            = 1.2 A
          

3-35
i
O
            = 481.067 μA
            







3-37
υ
O
            = -220V
          

3-39



3-41


                (a)
                υ
T
                = 10 V;
                R
T
                =
                R
N
                = 8.333 KΩ
                i
N
                = 1.2 mA
              

                (b)
                R
L
                = 1.6 KΩ
              



3-43
i
N
            = 3333 mA;
            R
N
            = 15 KΩ
            
            For
            R
L
            = 5kΩ, 10kΩ, and 47 we have
            i
L
            = 2.5 mA, 2 mA, and 806.452 μA, respectively
          

3-45


                (a)
                



R
L
                  = 100 kΩ;
                  p
L
                  = 14.0625 mW
                


                (b)
                R
T
                = 100 kΩ; maximum power is delivered when the load resistance matches the Thévenin resistance
              



3-47
υ
L
            = 26.667 V
          

3-49
υ
O
            =10V
          


3-51


                (a)
                




                (b)
                R
L
                = 4.2857 Ω
              

                (c)
                






3-53
R
T
            = 23.8182 kΩ;
            υ
T
            = 3.07745 V
          

3-55
υ
Q
            = 72.0860 V;
            i
Q
            = 9.7393 A
            




3-57


                (a)
                R
L
                is an open circuit and the voltage will be 50 V
              

                (b)
                R
L
                is an short circuit and the maximum current is 3.333 mA
              

                (c)
                R
L
                =
                R
T
                = 15 kΩ and the power
                p
L
                = 41.667 mW
              



3-59


                (a)
                R
                = 12 kΩ
              

                (b)
                p
L
                = 937.5 mW
              

                (c)
                




                (d)
                p
                = 468.75 mW
              

                (e)
                p
L
                = 833.3 mW
              


                (f) No. The source delivered 937.5 mW to the total load, but only half of that amount went to the right 12-kΩ resistor. Without resistor R, the power delivered to the right 12-kΩ resistor increases to 833.3 mW and the circuit is simplified by one component.
              



3-61


                (a)
                



                  To maximize the power delivered to the 2-kΩ resistor, replace
                  R
S
                  with a short circuit
                


                (b) As
                R
S
                increases in value, the power delivered to the load decreases. For larger values of
                R
S
                , it starts to compete with the load for the source's power. As it approaches infinity, an open circuit, no power is delivered to the load.
              



3-63
            The added resistor
            reduces
            the power delivered to the load. Assuming the load resistance is fixed at 100 Ω, the only way to increase the power delivered to the load from a 10-V source is to reduce the 50-Ω source resistance. Ideally, the source resistance would be zero, in which case the load would have a 10-V voltage drop, and dissipate 1 W of power.
          

3-65
            A 2-kΩ resistor will meet the specification with a small error
          

3-67
            When the 10-kΩ load has a voltage drop of 10 V and with a 20-V source, the required equivalent resistance is
            R
EQ
            = 20 kΩ,
            R
I
            = 9.5 kΩ; choose a resistor in series with the other two resistors as the interface design, with
            R
I
            = 1.3 kΩ + 2 kΩ + 6.2 kΩ = 9.5 kΩ
            
            With 4.3 V across the 10-kΩ load resistor, use the following design:
            



              Select
              R
1
              = 3 kΩ and
              R
2
              = 2 kΩ || 2kΩ; other designs are possible
            


3-69
            The following Multisim simulation shows that the bridge-T attenuation pad meets the requirements:
            


To determine if the load is matched to a 75-Ω equivalent source, analyze two additional circuits to find the open-circuit voltage and short-circuit current from the perspective of the load:








              The open-circuit voltage is 4 V and the short-circuit current is 53.33 mA; the Thévenin resistance seen by the load is
              R
T
              = 75 Ω; the circuit meets all of the specifications
            


3-71
            Let the L-pad be resistor
            R
1
            in series with the 100-Ω source resistor and
            R
2
            in parallel with the 50-Ω load resistor:
            



R
1
              = 66.67 Ω;
              R
2
              = 100 Ω
            


3-73
            Both circuits deliver 5 V to the load; Circuit 1 consumes the least amount of power; the output resistance of Circuit 2 best matches that of the load
          



CHAPTER 04


4-1



4-3


                (a)
                


                (b)
                


                (c)
                


                (d)
                






4-5


                (a)
                


                (b)
                i
O
                /
                i
S
                = -200
              

                (c)
                






4-7


                (a)
                


                (b)
                R
x
                = 20.4286 kΩ
              

                (c)
                










4-9


                (a)
                υ
O
                = 2.35
                g
                = 10 V
              

                (b) For
                υ
O
                = 1 V, 5 V, and 10 V, we have
                g
                = 0.4255 S, 2.1277 S, and 4.255 S, respectively
              

                (c)
                






4-11


                (a)
                


                (b)
                p
L
                = 4623 mW
              



4-13



4-15
            For
            υ
S
            = 0.5 V, cutoff mode,
            i
C
            = 0 mA;
            υ
CE
            = 15 V
            
            For
            υ
S
            = 4 V, saturation mode,
            i
C
            = 4.545 mA;
            υ
CE
            = 0 V
          

4-17
            For
            υ
S
            = 0.8 V, active mode,
            i
C
            = 1 mA;
            υ
CE
            = 3.333 V
            
            For
            υ
S
            = 2.5 V, saturation mode,
            i
C
            = 1.5 mA;
            υ
CE
            = 0 V
          

4-19


                (a)
                K
                = -
                R
2
                /
                R
1
                = -6.3.
              

                (b)
                




4-21


                (a) Circuit 1,
                K
                = (
                R
1
                +
                R
2
                )/
                R
2
                = 100; Circuit 2,
                K
                = -
                R
2
                /
                R
1
                = -100; the claim is true
              

                (b) The claim does not hold true; Circuit 1,
                K
                = 100; Circuit 2,
                K
                = -50
              



4-23


                (a)
                


                (b)
                






4-27


                (a)
                υ
O
                = 11
                υ
S


                (b)
                i
O
                =1.09091 mA
              



4-29


                (a)
                





                (b)
                






4-31


                (a)
                υ
O
                = -3.3
                υ
1
                -3.3
                υ
2


                (b) 3.545 V >
                υ
2
                > -5545 V
              



4-33
            With the switch open,
            υ
O
            = -5
            υ
S1

            With the switch closed,
            υ
O
            = -5
            υ
S1
            - 5
            υ
S2


4-35





4-37


                (a)
                


                (b)
                






4-39


                (a)
                υ
O
                = 100
                υ
1
                - 6 V; to prevent saturation, - 0.18 <
                υ
1
                < 0.30
              

                (b)
                




                (c)
                υ
O
                = 200-3
                υ
2
                V; to prevent saturation 74.67 >
                υ
2
                > 58.67
              

                (d)
                






4-41


                (a)
                υ
O
                = -4
                υ
1
                + 2
                υ
2


                (b)
                






4-43
            We can create the input and output using an inverting amplifier with
            R
1
            = 1 kΩ and
            R
2
            = 1.5 kΩ
            
              For the circuit in
              Figure P4-43
              (b), the student attempted to recreate the exact functions shown in the block diagram, but there are three mistakes; the voltage source
              υ
S
              has a gain of -05 instead of -2 in the first amplifier stage; the second amplifier stage should be a noninverting amplifier, but the OP AMP terminals are swapped; the gain of the noninverting amplifier should be 3, but the resistors are swapped; a grade of D or lower would be appropriate
            

              The circuit in
              Figure P4-43
              (c) is a noninverting amplifier with a gain of -2/7; the approach is sound, but the result is hard to understand without seeing any work the student did; if the student made a simple math error in analyzing the block diagram, the grade would be an A- or B+; if the errors showed the student did not understand the problem, the grade would be lower
            



4-45


                (a)
                




                (b)
                






4-47





4-49





4-51
R
X
            =
            R
Y
            =
            R
Z
            = 12.247 kΩ;
            R
            = 36.741 kΩ
          

4-53





4-55





4-57
            Circuit 3 is the best design if using standard components is a priority and OP AMPs are inexpensive to purchase and operate. An OP AMP will consume power, so a design with three OP AMPs requires more power than a design with two OP AMPs. This factor may be important, especially if the device is battery operated. If OP AMPs are expensive compared to standard components, then choose Circuit 2 over Circuit 1 because Circuit 2 exactly meets the specification.
          

4-59
            Full-scale output is
            υ
O
            = 4.84375 V; when the LSB changes, the output changes by 0.15625 V
          

4-61
υ
O,MAX
            = -9.6875 V; Res = 0.3125 V
          

4-63





4-65





4-67
            The circuit appears to be a reasonable design for the voltage gain, but the bias is wrong. When the transducer's output resistance increases above 220 Ω, or 10% of the input resistance on the first stage, it will load the first OP AMP stage and decrease the gain of the circuit. To mitigate the effect of the transducer's output resistance, we need to place a buffer at the input of the interface circuit. Since there are two issues with the design, do not recommend it.
          


4-69





4-71




υ
s
                    (V)
                  

V
REF
                    = 5 V
                  

                    V
                    REF
                    = 8 V
                  
Status




3.5
(0, 1, 1,1,1)
(0, 0, 0, 1, 1)
Changed


2.3
(0, 0, 0, 1, 1)
(0, 0, 0, 0, 1)
Changed


4.9
(1, 1, 1, 1, 1)
(0, 0, 1, 1, 1)
Changed



All of the codes changed with the new reference voltage




CHAPTER 05


5-1








5-3









5-5


                (a)
                


                (b)
                


                (c)
                




5-7


                (a)
                


                (b)
                




5-9








5-11
            τ = 288.539 ps;
            N
            (1 ns) = 3.125 gm
          

5-13
υ
            (
            t
            ) = 8
            e

              -0.187347
              t

u
            (
            t
            ) V
            




5-15


                (a)
                


                (b)
                





5-17



5-19


                (a)
                


                (b)
                




5-21





5-23



5-25



5-27



5-29
            α = 2 Hz
          

5-31



5-33


                (a)
                


                (b)
                


                (c)
                




5-35



5-35


                (a)
                


                (b)
                




5-39


                (a)
                


                (b)
                




5-41


                (a) Causal and non-periodic
                




                (b) Non-causal and periodic
                





                (c) Non-causal and periodic
                




                (d) Non-causal and periodic
                




                (e) Causal and non-periodic
                








CHAPTER 06


6-1
i
C
            (
            t
            ) = 0 A;
            
              p
              C
              (
              t
              )
            
            = 0 W; neither absorbing nor delivering power
          

6-3
            υ
            C
            (5 ms) = 25 V
          

6-5






The capacitor both absorbs and delivers power



6-7
            υ
            C
            (4s) = 50V; υ
            C
            (6s) = 30 V
          

6-9


                (a)
                i
L
                (
                t
                ) = 0.6682 - 0.5682
                e

                  -200
                  t

                A
                




                (b)
                
                  
                    % Define the variables
                    syms t × real
L = 220e-3;
iL0 = 0.1;
                    % Create the voltage
                    vLt = 25*exp(-200*t);
vLx = subs(vLt,t,x);
                    % Calculate the current
                    iLt = iL0 + int(vLx,x,0,t)/L
iLtnum = vpa(iLt,5)
                    % Determine numerical values
                    t0 = 0;
tf = 30e-3;
ts = tf/1000;
tt = t0:ts:tf;
iLtt = subs(iLt,t,tt);
vLtt = subs(vLt,t,tt);
                  
                
The MATLAB output is shown below and agrees with the calculations made above

                  iLt =147/220 - (25*exp(-200*t))/44
iLtnum = 0.66818 - 0.56818*exp(-200.0*t)
                








6-11





              As
              n
              approaches infinity, the amplitude of the current approaches zero; the inductor acts like an open circuit for high-frequency signals
            


6-13

            ; the expression for the power is always positive, so the capacitor is always absorbing power
          

6-15
i
L
            (
            t
            ) = 120
            e

              -1000
              t

            - 100 mA;
            p
L
            (
            t
            ) = 600
            e

              -1000
              t

            - 720
            e

              -2000
              t

            μW; the inductor is both delivering and absorbing power to the rest of the circuit
          

6-17
            Capacitor;
            C
            = 100 pF; υ
            C
            (0) = 0 V
          

6-19





6-21




              The OP AMP is operating in the linear range for 0 <
              t
              < 7.5 ms, after which it saturates at the lower voltage limit
            


6-23


                (a) Differentiator circuit with
                RC
                =20 s
              

                (b) Inverting amplifier with a gain
                K
                = -10000
              

                (c) Integrator circuit with
                RC
                = 100 ms
              

                (d) Noninverting amplifier with a gain
                K=
                100000
              



6-25



6-27






6-29
R
            = 5.6 kΩ;
            C
            = 0.068 μF
          

6-31
            Let υ
            A
            (
            t
            ) be the voltage at the input terminals of the OP AMP and write node-voltage equations at the two input terminals:
            




6-33





6-35


                (a)
                




                (b)
                




                (c)
                




                (d)
                






6-37
C
EQ
            = 3.5609 μF;
            L
EQ
            = 100 μH
          

6-39





6-41
C
EQ
            = 19.3875 μF; υ
            C
            (0) = 150 V
          

6-43





6-45
            Two inductors can store at least 1 mJ of energy; the 150-μH inductor costs less and is the best choice
          

6-47
w
L
            = 12.5 μJ;
            w
C
            = 25 μJ
          

6-49
            At dc, the overall gain is +4; at high frequencies, the overall gain is also +4
          




CHAPTER 07


7-1
i
            (
            t
            ) = 10
            e

              -5
              t

            mA
          

7-3
T
C1
            = 29.09 ps;
            T
C2
            = 627.27 μs
          

7-5


                (a)
                


                (b)
                




                (c)
                






7-7
            υ
            O
            (
            t
            ) = 25
            e

              -165.29
              t

            V t ≥ 0
          

7-9
i
L1
            (
            t
            ) = 5(
            e

              -200000
              t

            + l) mA;
            i
L2
            (
            t
            ) = 5(
            e

              -200000
              t

            - l) mA
            







7-11
υ
O
            (
            t
            ) =
            V
A
            (1 -
            e

              -
              Rt
              /
              L

            ); the forced component is the constant voltage
            υ
OF
            (
            t
            ) =
            V
A
            and the natural component is the exponential term,
            υ
ON
            (
            t
            ) = −
            V
A
e

              −
              Rt
              /
              L



7-13






7-15






7-17








7-19
t
            = 69.3147 ms
          

7-21


                (a)
                υ
2
                (
                t
                ) =
                υ
C
                (
                t
                ) = 28
                e

                  -500
                  t

                - 20 V
                t
                ≥ 0; the final value in the expression above is - 20 V, so the OP AMP will saturate at -15 V
              

                (b)
                t
                = 672.944 μs
              

                (c) Yes, the OP AMP saturates because the final value for the output would be -20 V if the OP AMP could provide that much voltage; the output is -15 V at
                t
                = 3.44553 ms)
              

                (d)
                






7-23







7-25






7-27





7-29




              The plot shown used a final value of 14 V and a time constant of 4 ms; choose
              C
              = 1 μF and solve for
              R
              =
              T
C
              /
              C
              = (4ms)/(1 μF) = 4 kΩ
            





7-31





7-33
            The Multisim simulation and results below verify the solution with the time shifted by 1 ms to demonstrate the capacitor's initial voltage:
            








7-35
            Choose Vendor B because it is less expensive and meets the specification
          

7-37






7-39



7-41





7-43


                (a)
                

(b) The circuit is underdamped

                (c)
                






7-45
            Purchase the circuit if the vendor will replace the 250-Ω resistor with a 180-Ω resistor
            




7-47


              The resistor
              R
              determines the magnitude of the output or the gain of the circuit
            









7-49

            all parameters affect the damping ratio; we can change the damping ratio without affecting the undamped natural frequency by changing the resistance
          

7-51


                (a)
                υ
2
                (
                t
                ) = 5 - 5
                e

                  -1000
                  t

                - 5000
                te

                  -1000
                  t

                V
              

                (b)
                




                (c)
                



                  The band-pass filter in
                  Figure P7-50
                  responds to the step input, but then returns to zero. In effect, the band-pass filter does not pass the step response from the input to the output. The low-pass filter in
                  Figure P7-51
                  responds to the step input and eventually passes the input signal to the output.
                




7-53


                (a)
                R
                = 690 Ω;
                L
                = 862 mH
              

                (b)
                




7-55
            Replace the 3.3-mH inductor with a 50-mH inductor
            




7-57
            A parallel
            RLC
            circuit with
            R
            = 250 Ω,
            L
            = 25 mH, and
            C
            = 0.1 μF
          

7-59
            The parameter values are
            R
            = 14.333 kΩ,
            L
            = 1.333 H, and
            C
            = 0.1 μF
            




7-61
C
            = 160 pF
          




CHAPTER 08


8-1


                (a)
                


                (b)
                
The phasor diagram is sketched below.







8-3


                (a)
                V
1
                = 480∠−45°V = 339.4−
                j
                3394 V
              

                (b)
                V
2
                = 480∠75°V = 124.2 +
                j
                463.6 V
              

                (c)
                







8-5


                (a)
                υ
1
                (
                t
                ) = 220cos (314.2
                t
                −45°) V
              

                (b)
                υ
2
                (
                t
                ) = 440cos (377
                t
                + 225°) kV
              

                (c)
                i
1
                (
                t
                ) = 4cos(314.2
                t
                − 15°) A
              

                (d)
                i
2
                (
                t
                ) = 440cos (377
                t
                + 180°) μA
              



8-7


                (a)
                υ
1
                (
                t
                ) = 7.07cos(10000
                t
                + 45°) V
              

                (b)
                υ
2
                (
                t
                ) = 14.14cos(200
                t
                + 135°) V
              

                (c)
                i
1
                (
                t
                ) = 20cos(314.2
                t
                ) mA
              

                (d)
                i
2
                (
                t
                ) = 2202cos(100000
                t
                − 112.6°) mA
              



8-9
i
3
            (
            t
            ) = 547.94cos(ω
            t
            + 103.2°) mA
          

8-11



8-13


                (a)
                Z
                = 11.176 +
                j
                35.294Ω = 37.021∠72.43° Ω
              

                (b) Choose
                R
                = 12Ω and use two 8700-μH inductors in series to yield a total inductance of
                L
                = 17.4mH
              



8-15
R
            = 1000 Ω,
            L
            = 2 mH,
            C
            = 1 μF
          

8-17


                (a)
                Z
EQ
                = 75 +
                j
                225 Ω
              
(b) Add a 0.4444-μF capacitor in series with the circuit to put it in resonance

                (c) The circuit is no longer in resonance; we would have to add an inductor with
                L
                = 4.5 mH in series with the circuit to return it to resonance)
              



8-19
Z
            = 15 -
            j
            1.04Ω = 15.04∠ - 3.97° Ω
          

8-21



8-23
Z
            = 88.97 -
            j
            32.41 Ω = 94.69∠ - 20° Ω
          

8-25


                (a)
                




                (b)
                


                (c)
                


The current leads the capacitor voltage by 90°




8-27
Z
            = 10∠ - 85° kΩ = 0.872 -
            j
            9.962 kΩ; the load is equivalent to a 872-Ω resistor in series with a capacitor
            C
            = 0.0502 μF
          

8-29



8.31






8-33




8-35





8-37




Source


                    |
                    V
R
                    |
                  

                    |
                    V
C
                    |
                  

                    |
                    I
                    |
                  

                    |
                    Z
R
                    |
                  

                    |
                    Z
C
                    |
                  





                    Increase/decrease
                    V
A


                    Inc/dec |
                    V
R
                    |
                  

                    Inc/dec |
                    V
C
                    |
                  

                    Inc/dec |
                    I
                    |
                  
none
none


Increase/decrease ω

                    Inc/dec |
                    V
R
                    |
                  

                    Dec/inc |
                    V
C
                    |
                  

                    Inc/dec |
                    I
                    |
                  
none

                    Dec/inc |
                    Z
C
                    |
                  


Increase/decrease ϕ
none
none
none
none
none





8-39



8-41


                (a)
                V
O
                = 4∠90°V = 0 +
                j
                4 V;
                I
O
                = 4∠90° mA
              

                (b)
                V
O
                = 4∠90° V = 0 +
                j
                4 V;
                I
O
                = 8∠180° mA
              


                  (c)
                  V
O
                  =
                  K
V
S
                  = 18∠105° V = -4.659 +
                  j
                  17.39 V;
                

I
O
                  = 18∠105° mA; the amplitude of the output voltage exceeds the
                  V
CC
                  limits of the OP AMP, so the circuit will have a nonlinear response and the peaks and valleys of the sinusoidal signals will be limited to ±15 V; the current through the load impedance will be similarly limited
                




8-43
V
X
            = -
            j
            60 V;
            I
X
            = 600 +
            j
            600 μA
          

8-45


                (a)
                


                (b)
                Z
L
                = -
                j
                26 kΩ
              



8-47
R
            = 500 Ω and
            L
            = 500 mH in a series impedance
            




8-49


                (a)
                



                  The resonant peak occurs at approximately
                  f
                  = 5.0329 kHz and the maximum output voltage has the same magnitude as the input voltage
                

(b) BW = 8 Hz

                (c)
                



                  The minimum output voltage occurs at approximately
                  f
                  = 5.0329 kHz and the minimum voltage approaches zero
                





8-51


                (a)
                V
O
                = 64.62 -
                j
                36.92 V = 74.42∠-29.74° V
              

                (b)
                V
O
                = 64.62 -
                j
                36.92 V = 74.42∠-29.74° V
              
(c) Both methods have the same number of equations and unknowns. The node-voltage method is (arguably) slightly easier in this case, because it solves for the desired unknown voltage directly. The mesh-current approach requires an additional application of Ohm's law to find the output voltage after solving for the mesh currents.



8-53






8-55



8-57


                (a)
                υ
O
                (
                t
                ) = 0.7071 cos(2128
                t
                - 45°) V
              

                (b)
                



                  The gain has a value of 0.5 at a frequency of
                  f
                  = 586.52 Hz, which is equivalent to ω = 3.6852 krad/s
                




8-59
V
S
            = 250 +
            j
            275 V = 371.65∠47.73° V
          

8-61



8-63
I
AB
            = -15.38 -
            j
            123.08 mA = 124.03∠-97.13° mA
          

8-65


                (a)
                Z
X
                = -
                j
                100 Ω
              

                (b)
                Z
OUT
                = 40 +
                j
                20 Ω
              

                (c)
                K
                = 02 -
                j
                0.4
              



8-67


                (a)
                



P
                  = 2.7439 W
                



                  (b)
                  V
T
                  = 24 +
                  j
                  18V = 30∠36.87° V;
                

Z
T
                  = -
                  j
                  80 Ω = 80∠ - 90° Ω
                


                (c) With
                R
                = 80 Ω, the average power delivered to the resistor is
                P
max
                = 2.8125 W
                






8-69


                (a)
                P
MAX
                = 126.56 mW
              

                (b)
                Z
L
                = 2 +
                j
                2 kΩ
              






CHAPTER 09


9-1


                (a)
                
                ; the zero is located at
                s
                = ∞ and the pole is located at
                s
                =0
              

                (b)
                
                ; the zeros are located at s = [∞, ∞] and the poles are located at
                s
                = [0, 0]
              

                (c)
                
                ; the zero is located at
                s
                = ∞ and the pole is located at
                s
                = -20000
              



9-3

            ; the zeros are located at
            s
            = [-5/6, ∞, ∞] and the poles are located at
            s
            = [0, 0, -5]
          

9-5

            ; the zeros are located at
            s
            = [-α(
            B
            + 1)/
            B
            , ∞] and the poles are located at
            s
            = [-α, -α]
          

9-7

            ; the zeros are located at
            s
            = [100, ∞] and the poles are located at
            s
            = ±
            j
            100
          

9-9

            ; the zeros are located at
            
            and the poles are located at
            s
            = [-3, 0]
          

9-11


                (a)
                
                ; the zeros are located at
                s
                = -12±
                j
                8.4853 and the poles are located at
                s
                = [-12, -12]
              

                (b)
                
                ; the zeros are located at
                s
                = [-25 ±
                j
                78.1558, ∞] and the poles are located at
                s
                = [0, -10±
                j
                100]
              



9-13

              syms s t f F
f= (30+4*exp(-10*t))*heaviside(t) +...
      (3*cos(100*(t-0.1)))* ...
      heaviside(t-0.1);
F = simplify(laplace(f))
F = 4/(s + 10) + 30/s + (3*s*cos(10)^2*
      exp(-s/10))/(s^2 +10000)
      + (3*s*exp(-s/10)*sin(10)^2)/
      (s^2 + 10000)
            
The result is:





9-15


                (a)
                


                (b)
                


                (c) Use the definition of the Laplace transform and integration by parts.
                






9-17



9-19


                (a)
                


                (b)
                


                (c)
                




9-21


                (a)
                k
                = -2400
              

                (b)
                k
                = -20
              



9-23


                (a)
                


                (b)
                




9-25


                (a)
                


                (b)
                




9-27


                (a) The following MATLAB code provides the solution:
                
                  syms s t f F
F = (s + 100)^3/(s + 50)^2/(s + 200)^2;
f = ilaplace(F)
                
The corresponding MATLAB output is shown below

                  f= (7*exp(-50*t))/27+ (20*exp(-200*t))/
27+ (50*t*exp(-50*t))/9
- (400*t*exp(-200*t))/9
                
We have the following result:





                (b) The following MATLAB code provides the solution:
                
                  syms s t f F
F = (s + 50)^3/(s + 100)^2/(s + 200)^2;
f = ilaplace(F)
                
The corresponding MATLAB output is shown below

                  f= exp(-100*t) - (25*t*exp(-100*t))/2
- (675*t*exp(-200*t))/2
                
We have the following result:








9-29


                (a)
                


                (b)
                




9-31






9-33

            The following MATLAB code provides the solution:
            
              syms s t f F
F = 5e6*s^2*(s+100)/((s+50)^2+250^2) ...
/((s+100)^2+500^2);
f = simplify(ilaplace(F))
            
The corresponding MATLAB output is shown below

              f=- (760000000*exp(-100*t)*
     ((5*cos(250*t)*sin(250*t))/19
     - 2*cos(250*t)^2 + 1))/113
     - (195000000*exp(-50*t)*(cos(250*t)
     - sin(250*t)/15))/113
            


9-35


                (a)
                υ
                (
                t
                ) = 50
                e

                  -10
                  t

u
                (
                t
                ) V
              

                (b)
                υ
                (
                t
                ) = [1 - 6
                e

                  -150
                  t

                ]
                u
                (
                t
                ) V
              



9-37


                (a)
                


                (b)
                


                (c)
                


                (d)
                


                (e)
                






9-39


                (a)
                


                (b)
                




9-41


                (a)
                


                (b)
                


                (c)
                


The currents through the inductor, the capacitor, and the resistor currents always sum to zero. The capacitor voltage starts at zero and returns to zero as the energy in the circuit is dissipated. The voltage waveform is composed of two exponentials with the same time constant, which is a critically damped response or case B. The capacitor voltage magnitude peaks at about 500 μs and - 368 V.





9-43


                (a)
                


                (b)
                




9-45


                (a)
                


                (b)
                




9-47



9-49


                (a)
                f
1
                (0) = 100;
                f
1
                (∞) = 0
              

                (b)
                f
2
                (0) = 60; the final value property does not apply in this case because
                sF
2
                (
                s
                ) has poles on the
                j
                ω axis, so it does not have a final value
              



9-51


                (a) Using initial and final value properties, we have
                f
1
                (0) = 10 and
                f
1
                (∞) = 0. Evaluate the waveform at
                t
                = 0 and
                t
                → ∞ to get
                f
1
                (0) = 10 and lim
                
t
                  →∞
                
f
1
                (
                t
                ) = 0. The sinusoid does not have a known value as
                t
                → ∞, but it is bounded with a magnitude less than one. Since another term in the expression approaches zero, the overall expression will be zero in the limit. In this case, the initial and final value properties provide accurate answers.
              

                (b) Using the initial and final value properties, we have
                f
2
                (0) = -150 and
                f
2
                (∞) = 0. Evaluate the waveform at
                t
                = 0 and
                t
                → ∞ to get
                f
2
                (0) = -150 and lim
                
t
                  →∞
                
f
2
                (
                t
                ) = 0. In this case, the initial and final value properties provide accurate answers.
              

                (c) Using the initial and final value properties, we have
                f
3
                (0) = 10 and
                f
3
                (∞) = 0. Evaluate the waveform at
                t
                = 0 and
                t
                → ∞ to get
                f
3
                (0) = 10 and lim
                
t
                  →∞
                
f
3
                (
                t
                ) = lim
                
t
                  →∞
                
                [10cos(10
                t
                )]. In this case, the initial value property is accurate, but the final value property is not accurate because the waveform does not have a final value.
              





CHAPTER 10


10-1

            choose
            R
            = 1 kΩ and solve for
            C
            = 0.1 μF
          

10-3


                (a)
                
                the zero is located at
                s
                = -1/
                RC
                and the pole is located at zero
              

                (b) Pick
                R
                = 1 kΩ and solve for
                C
                = 0.00303 μF
              



10-5
R
            = 10 kΩ;
            C
            = 0.01 μF
          

10-7


                (a)
                
                the zeros are located at zero and
                s
                = - 2
                R
                /
                L
                ; the pole is located at
                s
                = -
                R
                /
                L


                (b) Choose
                R
                = 1.5 kΩ and solve for
                L
                = (1.5 kΩ)/(1.5 krad/s) = 1 H; the zeros are located at zero and
                s
                = -3 krad/s
              



10-9


                (a) The zeros are locates at
                s
                = -306.26 rad/s and
                s
                = -3265 rad/s and the pole is located at
                s
                = -3571 rad/s
              

                (b) The pole would be at
                s
                = 1/(10 kΩ)(0.5 μF) = -200 rad/s and the zeros would shift to
                s
                = -100 ±;
                j
                995 rad/s
              



10-11


                (a)
                
                the zeros are located at
                s
                = -
                R
                /2
                L
                and
                s
                = -2
                R
                /
                L
                and the pole is located at
                s
                = -3
                R
                /2
                L


                  ; the zero is located at zero
and the pole is located at s = −3
                  R/2L



                (b) Pick
                R
                = 1 kΩ and solve for
                L
                = 238.7 mH
              



10-13
            With the switch open,
            Z
12
            (
            s
            ) has a zero at the origin,
            Z
34
            (
            s
            ) has a pole at the origin, and
            Z
56
            (
            s
            ) has neither a zero nor a pole and the impedances correspond to pole-zero diagrams B, D, and F, respectively. With the switch closed,
            Z
12
            (
            s
            ) has zeros at the origin and a negative, real value and a complex conjugate pair of poles;
            Z
34
            (
            s
            ) has a zero at a negative, real value and a complex conjugate pair of poles; and
            Z
56
            (
            s
            ) has an imaginary conjugate pair of zeros and a complex conjugate pair of poles. The impedances
            Z
12
            (
            s
            ),
            Z
34
            (
            s
            ), and
            Z
56
            (
            s
            ) correspond to pole-zero diagrams C, E, and A, respectively. The manufacturer's claim is correct.
          

10-15


                (a)
                


                (b) The pole is located at
                s
                = -
                R
                /2
                L
                and the zero is located at
                s
                = 0
                




                (c) The zero is at
                s
                = ∞ and the pole is at
                s
                = -
                R
                /2
                L





                (d) Select
                L
                = 1 mH and solve for
                R
                = 100 Ω; with these component values,
                Z
T
                (
                s
                ) has a pole at
                s
                = -50 krad/s and a zero at
                s
                = 0
              




10-17
            The natural poles are located at
            s
            = -1722 rad/s and
            s
            = -12778 rad/s; the natural zeros are located at
            s
            = -500 rad/s and
            s
            = -2000 rad/s
          

10-19


                (a)
                


                (b)
                υ
LC
                (0) = 1;
                υ
LC
                (∞) = 1; the unit step input causes the 1-V output across the inductor at
                t
                = 0 to transfer to the capacitor at
                t
                = ∞
              



10-21

            the zeros are located at
            s
            = 0 and
            s
            = ∞ the poles are located at
            
            , which equates to
            s
            = -0.382/
            RC
            and
            s
            = -2.618/
            RC
            ; the dominate pole is the one closer to the origin at
            s
            = -0.382/
            RC
            ; select
            R
            = 1 kΩ and compute
            C
            = 1.91 μF; the other pole is then located at 1371 rad/s
          

10-23








10-25



10-27


                (a)
                C
1
                = 0.1 μF; we do not have enough information to calculate a specific value for
                C
2


                (b) The circuit is passive and must be inherently stable; the source introduces a pole in the right half-plane which makes the response for
                V
T
                (
                s
                ) unstable
              

                (c)
                V
S
                (
                s
                ) =
                V
A
e

                  20
                  t

u
                (
                t
                ) V-s
              



10-29
            The transformed circuit is shown below
            




10-31


                (a)
                


                (b) Select
                R
1
                = 1 kΩ and solve for
                L
                = 1 H to place the pole at -1 krad/s; select
                R
2
                = 10 kΩ to achieve a gain of -10
              

                (c) At
                s
                = 0, the gain is -
                R
2
                /
                R
1
                = -10; at
                s
                = ∞, the gain approaches zero; the circuit passes low frequencies with a gain of - 10 and blocks high frequencies, so it is operating as a low-pass filter
              



10-33



10-35


                (a)
                


                (b)
                




10-37
            The missing element is a 1-μF capacitor
          

10-39

            choose
            R
            = 1 kΩ and
            C
            = 1 μF to meet the specifications; there are other valid solutions
          

10-41


                (a)
                

                  The left mesh has current
                  I
A
                  (
                  s
                  ) and the right mesh has current
                  I
B
                  (
                  s
                  )
                






                (b) Solve the second mesh-current equation for
                I
A
                (
                s
                ) and substitute into the first equation
                




                (c) The zeros are located at zero and infinity; the poles are located at
                




                (d)
                





                (e) The Multisim simulation and results in the figure below verify the solution
                






10-43


                (a)
                




                (b)
                


                (c)
                
                The buffer reduced the coefficient of the
                s
                term in the denominator; in general, this change reduces the damping coefficient
              

                (d) Without the OP AMP, pick
                R
1
                =
                R
2
                = 1
                kΩ.
                and solve for
                C
1
                = 0.02298 μF and
                C
2
                = 0.04351 μF. In the OP AMP design, choose
                R
1
                =
                R
2
                = 1 kΩ,
                C
1
                = 0.1 μF, and
                C
2
                = 0.01 μF to place the poles as specified. Both approaches can achieve the same results, but the design with the OP AMP is much easier to analyze and much easier to work with in selecting components to meet a design specification.
              



10-45


                (a)
                



                  Let the node above
                  R
1
                  be node A and the node to the left of
                  C
2
                  be node B
                





                (b)
                


                (c)
                





10-47


                (a)
                


                (b)
                


                (c)
                






10-49


              Overall, the approaches are similar in terms of difficulty. If we were solving for just
              V
X
              (
              s
              ), the node-voltage approach would yield an answer without any additional calculations. If we were solving for just
              I
X
              (
              s
              ), the mesh-current approach would yield the answer with a simple subtraction. Since we are solving for both a voltage and a current, since the circuit has three mesh currents and three node voltages, and since the circuit has one voltage source and one current source, the two solution approaches are balanced.
            


10-51


              Select
              C
1
              = 0.1 μF and solve for
              R
              = 200 Ω and
              C
2
              = 0.025 μF
            


10-53


                (a) The transformedcircuitafterthe switch moves to position B is shown below
                


Write the mesh-current equations by inspection





                (b)
                


                (c)
                


                (d)
                



                  The response for
                  υ
C1
                  (
                  t
                  ) is critically damped or Case B and the response for
                  υ
C2
                  (
                  t
                  ) is overdamped or Case A
                




10-55



10-57
            The pole is located at
            s
            = (μ-2)/
            RC
            ; to maintain stability, the pole must be negative, so μ < 2
          

10-59


                (a)
                




                (b)
                





                (c)
                
                  syms s t R1 R2 L C1 C2 VA VB VC VD IA a
Eqnl = (C1*s + 1/R1)*VB - 1/ ...
    R1*VD - C1*VA;
Eqn2 = (1/L/s+C2*s + 1/R2)*VC- 1/ ...
    R2*VD - VA/L/s^2;
Eqn3 = -1/R1*VB - 1/R2*VC+ ...
    (1/R1 + 1/R2)*VD - IA/(s + a);
Soln = solve(Eqn1,Eqn2,Eqn3, ...
    VB,VC,VD);
VB = simplify(Soln.VB)
VC = simplify(Soln.VC)
VD = simplify(Soln.VD)
VB = (VA*a + VA*S + IA*R2*S +
    IA*L*S^2 + C1*L*VA*S^3 +
    C1*R1*VA*s^2 + C1*R2*VA*s^2 +
    C1*R1*VA*a*s + C1*R2*VA*a*s +
    C2*IA*L*R2*s^3 + C1*L*VA*a*s^2 +
    C1*C2*L*R1*VA*S^4 +
    C1*C2*L*R2*VA*S^4 +
    C1*C2*L*R1*VA*a*s^3 +
    C1*C2*L*R2*VA*a*s^3)/
    (s*(a + s)*(C1*R1*s +
    C1*R2*s + C1*L*s^2 +
    C2*L*s^2 + C1*C2*L*R1*s^3 +
    C1*C2*L*R2*s^3 + 1))
VC = (VA*a + VA*S + IA*L*S^2 +
    C1*L*VA*S^3 + C1*R1*VA*S^2 +
    C1*R2*VA*S^2 + C1*R1*VA*a*S +
    C1*R2*VA*a*S + C1*IA*L*R1*S^3 +
    C1*L*VA*a*S^2)/
    (s*(a + s)*(C1*R1*s + C1*R2*s +
    C1*L*s^2 + C2*L*s^2 + C1*C2* L*R1*s^3 +
    C1*C2*L*R2*s^3 + 1))
VD = (VA*a + VA*s + IA*R2*s +
    IA*L*S^2 + C1*L*VA*S^3 +
    C1*R1*VA*s^2 + C1*R2*VA*s^2 +
    C1*R1*VA*a*s + C1*R2*VA*a*s +
    C1*IA*L*R1*S^3 + C2*IA*L*R2*S^3 +
    C1*IA*R1*R2*s^2 + C1*L*VA*a*s^2 +
    C1*C2*L*R2*VA*S^4 +
    C1*C2*L*R2*VA*a*s^3 +
    C1*C2*IA*L*R1*R2*S^4)/
    (s*(a + s)*(C1*R1*s + C1*R2*s +
    C1*L*s^2 + C2*L*s^2 + C1*C2*
    L*R1*s^3 + C1*C2*L*R2*s^3 + 1))
                






CHAPTER 11


11-1


                (a)
                


                (b) Select
                C
                = 1 μF and solve for the resistance
                R
                = 1 kΩ
              



11-3


                (a)
                


                (b) Select
                R
                = 1 kΩ and solve for
                L
                = 50 mH and
                C
                = 0.2 μF; the zeros are located at
                s
                = 0 rad/s and infinity; other designs are possible
              

                (c)
                


The filter is a band pass filter with a center frequency of 1.5922 kHz, which is equivalent to 10 krad/s




11-5


                (a)
                


                (b)
                




11-7


                (a)
                


                (b)
                C
                = 0.0625 μF;
                R
                = 4 kΩ; the circuit is stable because the poles are in the left half-plane
              



11-9


                (a)
                


                (b)
                


                (c) Pick
                R
1
                =
                R
2
                = 1 kΩ and solve for
                C
                = 0.001 μF
              
(d) The gain factor μ does not influence the pole location, so it can take on any value that the circuit can support



11-11

            both zeros are located at infinity; the poles are located at
            s
            = -10000 rad/s and
            s
            = -2000/3 rad/s
          

11-13


                (a)
                


                (b)
                




11-15


                (a)
                



                (b)
                




11-17

            the step response initial value is 0 V and the final value is -5 V
          

11-19



11-21


                (a)
                


                (b) We can design the circuit as a voltage divider; use a series
                RC
                circuit with the output taken across the capacitor; use
                R
                = 2 kΩ and
                C
                = 1 μF; there are other valid designs
              



11-23



11-25


                (a)
                




                (b)
                


A MATLAB plot of the step response is shown below for comparison





                (c)
                






11-27
y
            (
            t
            ) = 5
            e

              -1000
              t

            (1000
            t
            + 1)
            u
            (
            t
            )
            
              syms s t
Hs = (s + 2000)/(s + 1000)
xt = 5*exp(-1000*t);
Xs =laplace(xt)
Ys = simplify(Hs*Xs)
yt = ilaplace(Ys)
            

              Hs = (s + 2000)/(s + 1000)
Xs = 5/(s + 1000)
Ys = (5*(s + 2000))/(s + 1000)^2
yt = 5*exp(-1000*t) +
5000*t*exp(-1000*t)
            






11-29



11-31


                (a)
                i
2SS
                (
                t
                ) = 24.99cos(25000
                t
                + 128.7°) mA; the pole is located at
                s
                = -20000 rad/s
              

                (b)
                


The maximum output amplitude is approximately -28 dB, so the pole will be located where the amplitude falls to -31 dB; the pole is located at 3179 Hz or 20 krad/s, which is consistent with the results in part (a)




11-33


                (a)
                υ
2SS
                (
                t
                ) = 70.71 cos (5000
                t
                + 45°) V
              

                (b) If we attach a non-inverting amplifier (both resistors are the same) to the output of the circuit in
                Figure P11-32
                , we will achieve the desired response
              



11-35
y
SS
            (
            t
            ) = 35.36cos(1000
            t
            + 45°)
          

11-37
y
SS
            (
            t
            ) = 19.2cos(200
            t
            -90°) = 19.2sin (200
            t
            )
            
              syms s t
xMag = [8];
xPhase = 0;
w = [200];
ht = 800*(exp(-100*t)-exp(-400*t));
Hs = laplace(ht);
Ts = Hs
Tjw = subs(Ts,s,1i*w)
TjwMag = abs(Tjw);
TjwPhase =180*angle(Tjw)/pi;
yssMag = xMag.*TjwMag;
yssPhase = xPhase+TjwPhase;
Results= [w' TjwMag' TjwPhase' yssMag' ... yssPhase']
Ts = 800/(s+ 100) -800/(s+400)
Tjw = -(12*i)/5
Results= [200, 12/5, -90, 96/5, -90]
            





11-39
x
            (
            t
            ) = 25cos (20
            t
            )
          

11-41



11-43



11-45


                (a)
                


                (b)
                
The result matches the one found in part (a)




11-47



11-49

              syms s t
syms tau positive
ht = t*heaviside(t);
xt = t*(heaviside(t)-heaviside(t-2));
httau = subs(ht,t,t-tau);
xtau = subs(xt,t,tau);
yt = int(httau*xtau,tau,0,t)
yt = (t^3*(sign(t)/2+ 1/2))/
6 - (heaviside(t - 2)*(t - 2)^2*(t + 4))/6
            




              where we have used the identity sgn(
              t
              ) + 1 = 2
              u
              (
              t
              ).
            



11-51



11-53




              In the figure, we have plotted
              h
              (
              t
              - τ) =
              u
              (
              t
              - τ) and
              x
              (τ) = δ(τ) on axes where the horizontal axis is τ. The waveforms overlap for values of
              t
              ≥ 0 and they will overlap only at τ = 0. We can find the area of the product of the two functions where they overlap as follows:
            





11-55





11-57





11-59
            The circuit has two stages. The left stage is a voltage divider with a gain of 0.5 and the right stage is an inverting amplifier. As connected, the first stage is loading the second stage. If we swap the order of the stages such that the voltage divider follows the inverting amplifier, then we will have the desired transfer function. The corrected circuit is shown below.
            




11-61
            Use two active low-pass
            RC
            OP AMP filters in cascade. The first filter has an input resistor
            R
1
            = 1 kΩ, a feedback resistor
            R
2
            = 5 MΩ, and a feedback capacitor
            C
2
            = 0.002 μF. The second filter has an input resistor
            R
3
            = 10 kΩ, a feedback resistor
            R
4
            = 10 kΩ, and a feedback capacitor
            C
4
            = 0.01 μF. The design is shown below.
            




11-63


                (a) Use two stages following the design in
                Figure 11-38
                (b) in the textbook. In the first stage, we have
                K
1
                = 1, γ
                1
                = 250, and α
                1
                = 500. Use a scaling factor of
                k
1
                = 10
                6
                to get 1-μF capacitors. In the second stage, we have
                K
2
                = 1, γ
                2
                = 1000, α
                2
                = 2000, and the scaling factor is again
                k
2
                = 10
                6
                . The design is shown below with
                R
1
                =
                k
1
                /(
                K
1
                γ
                1
                ) = 4 kΩ,
                R
2
                =
                k
1
                /α
                1
                = 2 kΩ,
                R
3
                =
                k
2
                /(
                K
2
                γ
                2
                ) = 1 kΩ,
                R
4
                =
                k
2
                /α
                2
                = 500 Ω, and
                C
1
                =
                C
2
                =
                C
3
                =
                C
4
                = 1 μF.
                




                (b) Use two
                RC
                circuits separated by a buffer. The design is shown below with
                R
2
                = 4 kΩ,
                R
4
                = 1 kΩ, and
                C
1
                =
                C
2
                =
                C
3
                =
                C
4
                = 1 μF.
                




                (c) Use the following
                RLC
                circuit with
                R
1
                =
                R
2
                = 12.5kΩ,
                C
1
                = 0.133 μF,
                C
2
                = 0.4 μF, and
                L
2
                = 10 H.
                







11-65


                (a) For the first circuit, we have the following results:
                



                  The first circuit realizes the desired transfer function, since 1/
                  RC
1
                  = 4000 and 1/
                  RC
2
                  = 1000. For the second circuit, we have the following results:
                



The second circuit realizes the desired transfer function.

(b) To drive a 1-kΩ load, use the first circuit, because the output is the output of an OP AMP and there will be no loading issues. There will be loading issues with the second circuit.
(c) Either circuit will be acceptable if the source has an output resistance of 50 Ω. Both circuits have input impedances that are significantly higher than 50 Ω. The second design is passive, so if power usage is a concern, it is a better choice than the first circuit.
(d) The claim is false. If the second circuit is connected in front of the first circuit, there will be loading between the circuits and the resulting transfer function will not be the product of the individual transfer functions.



11-67
            Use an inverting OP AMP design with an input capacitor
            C
1
            = 0.2 μF and a resistor and capacitor in the feedback path with
            R
2
            = 1 kΩ and
            C
2
            = 0.1 μF. The circuit is shown below.
            


In the simulation below, the initial conditions on the capacitors are both zero. The output signal contains some oscillation or ringing until it eventually reaches the final value. The oscillation is an artifact of the simulation.







CHAPTER 12


12-1
            Only one 5G channel will fit in the band
          

12-3



12-5



12-7
            The signal is reduced by a factor of 3.981
          

12-9



                (a) ω
                C
                = 200 rad/s; low-pass filter; |
                T
                (
                j
                0)|  = 0.5; |
                T
                (
                j
                ∞)| = 0
              


                (b)
                



(c) One octave past the cutoff, the filter is approximately 7 dB down from its passband gain, which translates to -13 dB



12-11



                (a) The cutoff frequency is ω
                C
                = 5000 rad/s; low-pass filter; |
                T
                (
                j
                0)| = 2; |
                T
                (
                j
                ∞)| = 0
              

                (b)
                
                  TT = tf(-2*[5000],[1 5000]);
bodemag(TT,ww);
grid on
                





                (c)
                

(d) Replace the 10-kΩ resistor with a 2-kΩ resistor to increase the passband gain by a factor of five without changing the cutoff frequency



12-13





12-15
            If the gain stage is connected before the filter stage, then the load resistor significantly changes the performance of the filter stage in terms of both its gain and its cutoff frequency. If the filter stage is connected before the gain stage, then the input resistor for the gain stage significantly influences the performance of the filter. In both cases, the specifications can be met by adding a buffer between the two stages that are interacting with each other in a negative manner. The design could also be changed to combine the gain and filtering into a single low-pass filter OP AMP circuit by placing a 0.02-pF capacitor in parallel with the 50-kΩ resistor.
          

12-17
            System T1 is a high-pass filter with a passband gain of 0 dB or
            K
            = 1 and a cutoff frequency of
            

              System T2 is a low-pass filter with a passband gain of - 20 dB or
              K
              = 0.1 and a cutoff frequency of
              


              System T3 is a low-pass filter with a passband gain of 20 dB or
              K
              = 10 and a cutoff frequency of
              




12-19


                (a)
                


                (b) The circuit has a low-pass filter gain response with a cutoff frequency of ω
                C
                = 1/
                RC


                (c) The passband gain is (
                R
1
                +
                R
2
                )/
                R
1


                (d) Select
                R
1
                = 1 kΩ and
                R
2
                = 100 kΩ to achieve a gain of 101, which is within 5% of the specified gain; select
                R
                = 1 ka and solve for
                C
                = 200 pF
              

                (e) The gain-bandwidth product should be at least
                GB
                = 80 MHz and a more reasonable gain-bandwidth product would be
                GB
                = 80 GHz, so that the passband would cover approximately three decades of frequency
              



12-21


                (a) Use an
                RC
                voltage divider with the output voltage taken across the capacitor and
                R
                = 2 ka and
                C
                = 0.1 μF
              

                (b)
                



                  The response for the single
                  RC
                  circuit is shown in blue. It has the correct passband gain of 0 dB, a cutoff frequency of 795.6 Hz or 5000 rad/s, and a roll-off of -20 dB/dec. The response for the cascaded circuits is shown in green and it maintained a passband gain of 0 dB. Cascading the circuits together reduced the cutoff frequency from 795.6 Hz (5000 rad/s) to 297.8 Hz (1871 rad/s) and increased the roll-off from -20 dB/dec to -40 dB/dec. We expected the additional roll-off because the circuit has two poles, each of which contributes -20 dB/dec.
                


                (c)
                


The buffer isolates the two stages so that the resulting transfer function is the product of the two individual transfer functions. The response is shown in red and has a passband gain of 0 dB and a roll-off of - 40 dB/dec, as expected. The cutoff frequency has been reduced to 512.1 Hz (3218 rad/s). At the original cutoff frequency, each pole contributes -3 dB, so the gain is - 6 dB at 795.6 Hz (5000 rad/s).




12-23


                (a)
                


The gain response is that of a bandpass filter

(b) From either the magnitude or phase response plots, the center frequency is 1000 rad/s; the maximum gain is 34 dB, which is equivalent to a gain of 50

                (c) ω
                C1
                = 950 rad/s and ω
                C2
                = 1050 rad/s;
                B
                = 100 rad/s;
                Q
                = 10
              

                (d)
                





12-25


                (a)
                



                  The gain response is that of a second-order low-pass filter with different bandwidth values; changing
                  B
                  does not change the nature of the circuit, but it does change the magnitude response
                


                (b) For
                B
                values of 50, 500, and 5000, the cutoff frequencies are 1550 rad/s, 1480 rad/s, and 208 rad/s, respectively; changing the value of
                B
                alters the cutoff frequency of the circuit
              

                (c) From the magnitude response plot for
                B
                = 50, the peak value is 26.02 dB and occurs at 999.3 rad/s; from the transfer function, the corner frequency is at ω
                0
                = 1000 rad/s, so the actual peak occurs at a slightly lower frequency
              

                (d) An OP AMP is not required
                






12-27
            The first
            RC
            stage is a low-pass filter and it controls the upper cutoff frequency; the OP AMP stage controls the gain; the last
            RC
            stage is a high-pass filter and it controls the lower cutoff frequency
            




12-29
            Choose the circuit in
            Figure P12-28
            , since its output is the output of an OP AMP and it will not cause any loading at the output. The circuit in
            Figure P12-27
            will not meet the specifications when connected to a 100-Ω load because the load resistor will change the cutoff frequency of the second
            RC
            stage.
          

12-31




              Use the low-pass filter specifications to determine the required
              GB
              = 2MHz
            


12-33
            Use a series
            RLC
            circuit with the output taken across the series combination of the inductor and capacitor;
            L
            = 100 mH;
            R
            = 2 kΩ;
            C
            = 62.5 pF
            





12-35
R
            = 2 kΩ;
            L
            = 13.3 μH;
            C
            = 30 pF;
            Q
            = 0.333; ω
            C1
            = 15 Mrad/s; ω
            C2
            = 165 Mrad/s; since
            Q
            < 1, the filter could be designed with a cascade connection of first-order filters
          

12-37


                (a)
                R
                = 150 kΩ;
                C
                = 0.002 μF;
                L
                = 200 mH
              

                (b)
                



                  In the magnitude response, the center frequency is 7.9579 kHz or 50 krad/s and the bandwidth is 530.5 Hz or 3.33 krad/s, which yields a
                  Q
                  of 15, as desired
                




12-39



The simulation shows that the cutoff frequencies are at 80 Hz and 125 Hz and that there is -86.7 dB of attenuation at 100 Hz


12-41
            Find the
            LC
            parallel impedance and then determine the transfer function.
            



              The transfer function has the form of a bandstop filter. The notch occurs at the zero of the transfer function or
              
              . The passband gain of the filter is one at both high and low frequencies.
            



From the Multisim plot, the center frequency is 15.915 kHz = 100 krad/s and the bandwidth is (20.385 kHz -12.426 kHz) =7. 959 kHz = 50 krad/s



12-43


                (a)
                




                (b)
                T
1
                (
                s
                ) is the low-pass filter with a cutoff frequency of 1 krad/s and a passband gain of 14 dB or
                K
1
                = 5. Transfer function
                T
                2(
                s
                ) is the high-pass filter with a cutoff frequency of 2 krad/s and a passband gain of 20 dB or
                K
2
                = 10.
              

                (c) Both filters cause a -90° phase change as the frequency increases from zero to infinity. The low-pass filter,
                T
1
                (
                s
                ), starts at 0
                °
                because at zero frequency it is a real number with zero phase. For large frequencies, the numerator is real and the denominator of
                T
1
                (
                s
                ) will have a large imaginary component, which causes the -90° phase change. For the high-pass filter,
                T
2
                (
                s
                ), at very low frequencies, the numerator is imaginary and the denominator is mostly real, so the phase is +90°. As the frequency increases, the numerator stays imaginary and the denominator becomes mostly imaginary, so the phase approaches 0°.
              



12-45



                (a)
                



υ
2
                  (
                  t
                  ) = 708cos(10
                  t
                  - 45°) V
                

υ
2
                  (
                  t
                  ) = 100cos(100
                  t
                  - 78.6°) V
                

υ
2
                  (
                  t
                  ) = 14.1cos(1000
                  t
                  - 45°) V
                



                  (b)
                  υ
2
                  (
                  t
                  ) = 714.21cos(10
                  t
                  - 44.43°) V
                

υ
2
                  (
                  t
                  ) = 100.99cos(100
                  t
                  - 78.64°) V
                

υ
2
                  (
                  t
                  ) = 14.21cos(1000
                  t
                  - 44.71°) V
                
The values estimated from the Bode plots are similar to the calculated values.




12-47


                (a) The transfer function has a zero at
                s
                = -10 rad/s and a pole at
                s
                = - 1000 rad/s. The gain is constant at low frequences, the zero causes the gain to increase above 10 rad/s and the pole causes the gain to be constant again above 1000 rad/s. With this profile, the function is a high-pass filter with a cutoff frequency of 1000 rad/s. The passband gain is 50 or 34 dB. With the negative sign in the transfer function, the phase is 180° at low frequencies. In the middle frequencies, the zero adds 90° and the pole subtracts 90° from the phase, so at high frequencies the phase returns to 180°.
              

                (b)
                


The plots are consistent with the estimates in part (a)


                (c) Use the following circuit to implement the transfer function with
                R
1
                = 20 kΩ,
                C
1
                = 5 μF,
                R
2
                = 10 kΩ, and
                C
2
                = 0.1 μF:
                





                (d)
                






12-49


                (a) The poles are located at -1 rad/s and -1 krad/s.
                The zeros are located at - 10 rad/s and - 100 rad/s. The sequence of poles and zeros with respect to their frequencies is pole-zero-zero-pole, which will yield a bandstop filter with cutoff frequencies at 1 rad/s and 1 krad/s. The passband gain is 20 or 26 dB.


                (b)
                




                (c)
                
                  D
                  2
                  (t)
                
                =67.9cos(100t-10.8°) V
              



12-51


                (a) The bandwidth is B, so
                B
                = 50 krad/s and the center frequency is ω
                0
                , so ω
                0
                =10 krad/ s;
                Q
                = 0.2
              

                (b) Choose
                K
                =
                B
                = 50 krad/s to achieve a gain of 0 dB
              

                (c)
                




                (d) We can use a series
                RLC
                circuit with the output taken across the resistor to achieve the desired response with
                R
                = 50 kQ,
                L
                = 1 H, and
                C
                = 0.01 ΩF
              

                (e)
                






12-53


                (a)
                



                (b)
                






12-55


                (a)
                K
                = 10
                13


                (b)
                




                (c) The cutoff frequencies are 155 krad/s, 154 krad/s, and 64.8 krad/s for
                B
                =2000, 20000, and 200000, respectively. As the value for bandwidth
                B
                increases, the actual cutoff frequency decreases because of the second-order nature of the response.
              

                (d)
                B
                = 141 .42 krad/s
                






12-57


                (a)
                




                (b)
                




                (c) The filter is a high-pass filter with a cutoff frequency of 1.14 krad/s and a passband gain of 0 dB or
                K
                = 1. The maximum gain is 0.922 dB or
                K
                = 1 . 11.
              
(d) The step response has oscillation about the final value, so it is underdamped; ζ = 0 .530

                (e)
                B
                = 1500 rad/s;
                Q
                = 0.943; since
                Q
                < 1, the response is wideband.
              



12-59



                (a)
                



                  Transfer function
                  T

1
                    (s)
                  
                  is the notch filter and transfer function
                  T

2
                    (s)
                  
                  is the tuned filter. The depth of the notch is 20 dB and the height of the tuned filter is also 20 dB. Their center frequencies are the same at 223 rad/s.
                


                (b)
                






T
1

(s)

                  is overdamped and
                  T

2
                    (s)
                  
                  is underdamped. Using MATLAB's data tips, we can find two points on the tail of the overdamped response to calculate the time constant as:
                




                  For the dominant exponential, α = 1/
                  T
c
                  = 146s
                  -1
                  . For the underdamped case, the peaks of the oscillations are 28 ms apart, so the frequency is 35 Hz or β = 220 rad/s. The time constant for the amplitude decay is 39.5 ms, so α =25s
                  -1
                  .
                


                (c) The poles determine the nature of the step response. In the T
                
1
                  (s)
                
                case, the poles are both real resulting in Case A (overdamped) or the two-exponential response. In the T
                
2
                  (s)
                
                case, the result is Case C (underdamped), resulting in a damped sinusoid response. The dominant exponential in T
                1

(s)

                is 138 s
                -1
                and correlates well with that calculated off the step response of 146 s
                -1
                . Similarly, α in the underdamped case is 25 s
                -1
                and β is 222 rad/s. The calculations from the step response plot were α = 25s
                -1
                and β = 220 rad/s.
              
(d) If the numerator and denominator are equal, the transfer function is one and the output will equal the input.



12-61
            For this design we will use two passive
            RLC
            filters with one tuned to 60 Hz and the other tuned to 120 Hz. We will combine the filters in cascade with a buffer separating them so that they do not load each other, but we get the benefit of each notch. To get a
            Q
            of 60 in each case, we will set the bandwidths to be 1 Hz and 2 Hz, respectively.
            







CHAPTER 13


13-1



13-3





13-5


                (a) The sketch is shown below where we have set
                V
A
                = 1 V and
                T
0
                =1 s
              

                (b)
                






13-7





13-9


                (a)
                




                (b)
                



                  Note that in the plot for the phase angles, the values for ϕ
                  η
                  are not defined for even values of
                  n
                  and are plotted as zeros.
                





13-11
υ(t) ≈
            54.43 + 85.5 sin(120π
            t
            ) - 36.287 cos(240π
            t
            ) − 7.257 cos (480π
            t
            ) - 3.110 cos (720π
            t
            ) V
            




13-13
f (t)
            ≈ 2.5 − 1.5915 sin (200π
            t
            ) - 0.7958 sin (400π
            t
            ) −0.5305 sin (600π
            t
            ) −0.3979 sin (800π
            t
            ) V
            





The estimate with only four terms is a fair approximation and captures the general trends in the original signal.


13-15


                (a) The fundamental frequency is the lowest frequency f
                0
                = 1000 Hz or ω
                0
                = 2000π rad/s. The period is T
                0
                = 1/(1 kHz) = 1 ms. Harmonics are present for
                n
                = 1,3, and 5.
              
(b) If we remove the dc offset, the waveform only contains sine terms, so it has hidden odd symmetry. Only the odd harmonics are present, so it has half-wave symmetry.

                (c)
                



                  The waveform is a parabolic wave with an amplitude
                  A
                  = 2 V and an offset
                  
                    a
                    0

                  =5 V.
                





13-17


                (a) The sketch is shown below for
                V
A
                = 1 V and
                T
                0 =1 s.
                




                (b) The results for all
                n
                are:
                




                (c)
                



(d) The waveform has even symmetry.



13-19


                (a)
                


                (b)
                






13-21


                (a)
                



                  Choose
                  C
1
                  = 0.1 μF,
                  R
1
                  = 2.5 kΩ,
                  R
2
                  = 9 kΩ,
                  R
3
                  = 1 kΩ
                


                (b)
                




                (c)
                



                  The circuit is a low-pass filter with a gain
                  K
                  = 10
                





13-23

              Results = n w b_n |b_n| Angle(bn) Results =
            

                  1.0000 100.0000 8.1057 8.1057 0
            

                  3.0000 300.0000 -0.9006 0.9006 180.0000
            

                  5.0000 500.0000 0.3242 0.3242 0
            

                  7.0000 700.0000 -0.1654 0.1654 180.0000
            

              Magnitude Results = Freq |T(jw)| |b_n| Ib_n_Out|
            

              MagResults =
            

                 100.0000 0.7071 8.1057 5.7316
            

                 300.0000 0.9487 0.9006 0.8544
            

                 500.0000 0.9806 0.3242 0.3179
            

                 700.0000 0.9899 0.1654 0.1638
            

              Phase Results = Freq Angle[T(jw)] Angle(b_n) Angle(b_n_Out)
            

              PhaseResults =
            

                 100.0000 45.0000 0 45.0000
            

                 300.0000 18.4349 180.0000 198.4349
            

                 500.0000 11.3099 0 11.3099
            

                 700.0000 8.1301 180.0000 188.1301
            
The filter is a high-pass filter, so the higher frequency signals have less attenuation than the lower frequency signals. The phase contributions from the transfer function are positive and decrease as frequency increases.





13-25


                (a) The Fourier coefficients are all zero except for the
                
                  a
                  n

                terms for odd values of
                n
                . We have:
                



                  Choose
                  R
                  = 60 Ω, solve for
                  L
                  = 1 H, and
                  C
                  = 2.778 ΩF. In the series
                  RLC
                  circuit, the output is taken across the resistor for a bandpass filter.
                


                (b)
                
                  Results = n Freq |T(jw)| a_n a_n_Out Results =
                

                     1.0000 0.2000 0.0375 12.1585 0.4556
                

                     3.0000 0.6000 1.0000 1.3509 1.3509
                

                     5.0000 1.0000 0.0933 0.4863 0.0454
                
The first and fifth harmonics are severely attenuated and the third harmonic is not changed between the input and output. Specifically, the input and output values for the first harmonic are 12.1585 and 0.4556, for the third harmonic are 1.3509 and 1.3509, and for the fifth harmonic are 0.4863 and 0.0454. The bandpass filter is correctly isolating the third harmonic.




13-27





              The harmonics of the current waveform (input) decay at a rate of
              
              but the harmonics in the voltage waveform (output) decay at a rate of
              
              . The higher frequency components of the voltage are more significant than those in the current for reconstructing the waveforms.
            


13-29


                (a)
                V
rms
                =6.894 V;
                P
                = 47.52 mW
              

                (b)
                i
                (
                t
                ) =5 + 6.376 sin (2000π
                t
                ) + 2.122 sin (6000π
                t
                ) mA
              



13-31
            The rms value of a square wave ss V
            rms
            = A; the first three components account for 93.31% of the average power in the signal
          

13-33

            the first three terms of the Fourier series for the parabolic wave carry a very high percentage of the power compared to the same results for the square wave or the sawtooth wave
          

13-35

            The average power delivered to a resistor is VA/3R. The dc component carries 75% of the power and the ac components carry the remaining 25% of the power.
          

13-37


                (a)
                
                  f
                  0

                = 1.25 Hz
              

                (b) We will require a low-pass filter with a cutoff frequency of 250 Hz or w
                c
                = 500π rad/s. We can use a series
                RC
                filter with the output taken across the capacitor. If we choose
                R
                =1 ka, then
                C
                = 0.637 ΩF.
              
(c) The sampling frequency must be at least twice the highest frequency in the signal or 500 Hz.



13-39

            The rms voltage is V
            A
            /2. The average power delivered to a resistor is
            V
A
2
            /4
            R.
            A total of 21 components are required to deliver over 98% of the average power carried by the waveform.
          



CHAPTER 14


14-1




              The new transfer function has the form of a second-order high-pass filter. At
              s
              = 0, the gain is zero and as s ⟶ ∞, the gain approaches the constant
              K
              .
            


14-3
            Use node-voltage analysis. Let the node between
            R
            1 and
            C
2
            be
            V

a
              (s)
            
            . Label the positive and negative terminals of the OP AMP as
            V

p
              (s)
            
            and
            V

n
              (s)
            
            . The relevant equations are:
            




14-5



The transfer function is that of a second-order, highpass filter. The amplitude Bode plot has a maximum roll-off of 40 dB/dec. The poles are located at s = - 250 ±/968.25 rad/s. The passband gain is one and the damping ratio is ζ = 0 .25, which creates the resonant peak near ≤ 0 = 1 krad/s. The cutoff frequency is 673.5 rad/s.




              The circuit in
              Figure P14-5
              is a high-pass filter. If the resistors and capacitors are swapped, then the circuit will perform as a low-pass filter. The transfer functions of the high- and low-pass filters are similar in their general structure, but the high-pass filter has
              
                s
                2

              in the numerator to achieve the correct gain response. The Multisim circuit and simulation results are shown below and agree with the
            
MATLAB results.









14-7




              Select
              C

1

              and solve for
              R

1

              as shown above. Then solve for
              C

2

              and
              R

2

              , in turn. For the specifications given, choose
              C
1
              = 500 pF and solve for
              R

1

              = 2 kΩ,
              C
2
              = 250 pF;
              R
2
              = 4 kΩ
            





14-9
            Pick
            C
            = 0.1 ΩF and solve for
            R
            = 3.9789 kΩ
            


The filter has a notch at 400 Hz and ζ = 1, so the filter performs as expected.


14-11





14-13
            For circuit (a), let
            R

1

            =
            R

2

            = R; select
            C

1

            = 0.001 ΩF and solve for
            C

2

            = 160 ΩF and
            R
            = 25 kΩ
            



The response meets the specifications.

              For circuit (b), the design is the standard second-order, low-pass filter. Use the equal-element approach to determine the component values. Select
              C
              = 0 .001 ΩF and solve for
              R
              = 10 kΩ. The gain with the filter design is 2.6, so select
              
                R
                A

              = 1 .6 kQ and
              
                R
                B

              = 1 kΩ.
            



The response meets the specifications.

              For circuit (c), let
              R
1
              =
              R
2
              =
              R
3
              =
              R
              . Select
              C
1
              = 0.001 ΩF and solve for
              C
2
              = 17.78 ΩF and
              R
              = 75 kΩ.
            



The response meets the specifications.
Circuits (a) and (c) have identical responses and circuit (b) has the same shape, but an additional gain. The following table summarizes the results.





Item


Circuit (a)


Circuit (b)


Circuit (c)





Meets Specs
Yes
Yes
Yes


Low-Frequency Gain
1
2.6
1


OP AMPs
2
1
1


Resistors
2
4
3


Capacitors
2
2
2




If a larger gain is more important, then choose circuit (b). If a lower part count is more important, then choose circuit (c), since it requires only one OP AMP and has fewer components than circuit (b).


14-15








14-17









14-19







              Note that with ζ = 1, the amplitude response has a relatively gradual transition. As noted on the Multisim plot, the response has the correct magnitude of |Κ|/2ζ = 500 = 53.98 dB at ω
              0
              and the correct slope after the transition band.
            


14-21








14-23






The response has the notch at the correct frequency of 159.15 Hz or 1 krad/s and the bandwidth is 7.98 Hz or 50 rad/s.


14-25










The center frequency is 50 Hz or 314 rad/s and the bandwidth is 1 Hz or 6.28 rad/s.


14-27








14-29








14-31





14-33





14-35






14-37



The transfer function's magnitude response provides the correct amount of attenuation and the overshoot is less than 13% in the step response.


14-39








14-41








14-43









14-45


                (a)
                




                (b)
                




                (c)
                



(d) Both designs meet the specifications. (d) The two circuits are similar in terms of their complexity and the effort required to design each one. The Butterworth design offers the advantage of a flat passband response and 100 dB/dec roll-off in the stopband. The Chebyshev response has a 3-dB ripple in the passband and only an 80-dB/dec roll-off in the stopband, but has more attenuation at (MIN.



14-47







Using the cursor tools to explore the response, the filter has a notch located at 397.9 Hz with a gain of -88 2 dB. The passband gain is 0 dB. The cutoff frequencies occur at 388.0 Hz and 408.0 Hz, so the bandwidth is 20 Hz. From the simulation, the filter meets all of the specifications. It appears that the filter is an acceptable choice, based on the simulation. One concern with the filter is the 625-Ω resistor at the input. Depending on the nature of the sensor with which the filter will interface, there may be loading issues at the input. We would either have to isolate the filter with a buffer or examine the sensor in more detail to make sure it would not impact the performance of the filter.


14-47










CHAPTER 15


15-1


                (a)
                




                (b)
                v
                2(t) =178.88 sin (100t) V
              

                (c)
                






15-3


                (a)
                




                (b)
                
                  v
                  S
                  (t)
                
                = -5cos (1000t) V
              



15-5





15-7
            The circuit has additive coupling and
            
              o
              2
              (t)
            
            = 0. We have the following relationships:
            




15-9






15-11

              i
              1
              (t)
            
            =2 .4 cos (377
            t
            ) A;
            
              i
              2
              (t)
            
            = - 480 cos (377t) mA
            




15-13
n
            = 0 .25; assume the operating frequency is ω = 100 rad/s to be able to determine the value of the inductor in the load impedance
            




15-15


                (a)
                n
                = 3
              

                (b)
                I
                in = 20
                .59 ζ
                - 29
                .
                05° A
              

                (c) For the simulation, assume the operating frequency is ω = 100 rad/s to be able to determine the value of the inductor in the source impedance. In addition, a small resistance was added to the source impedance to prevent a singular solution in Multisim.
                






15-17





15-19



15-21



The mesh-current equations are:








15-23
            Z
            IN
            =
            j
            77:27 Ω
          

15-25


                (a)
                




                (b)
                






15-27





15-29





15-31








CHAPTER 16


16-1


                (a)
                P
                = 0 W;
                Q
                = -22 VAR;
                p
                (
                t
                ) =22sin(2wt) W
              

                (b)
                






16-3

(a) ΩF = 0.342; lagging
(b) ΩF = 0.2588; leading



16-5


                (a)
                Z
                = 195 . 1+
                j
                243 .9 Ω
              

                (b)
                Z
                =4 8
                +j
                3 6Q
              



16-7
            The load requires a resistor with
            R
            = 26.67 Ω and an inductor with an impedance of
            jωL
            =
            j
            20 Ω. With a 60-Hz source, the inductance is
            L
            = 20/120π = 53 .05 mH. If we use a 50-Hz source, the resistance remains the same, but the inductance increases to
            L
            = 20/100π = 63.66 mH. The power factor is 0.8.
          

16-9
            S
            L
            = 262 +
            j
            917 = 953.4z74 .I° VA; pF = 0.2746; the reactive power is positive, so the power factor is lagging
            




16-11
S
S
            = 7224
            .
            4+
            j
            2498
            .
            9 V A;
            S
L
            = 1187.6 −
            j
            593.8 VA
          

16-13
S
S
            = 14.3125 +
            j
            2582 V A
          

16-15





16-17
            |
            S
S
            | =72242 V A; pF = 0
            .
            6575; |
            V
S
            | =2638 V (rms)
          

16-19
            |
            V
L
            | = 1549 V (rms); |
            V
S
            | = 2037
            .
            6 V (rms)
          

16-21
            |
            S
S
            | =83056 VA; |
            V
S
            | =4497 V(rms)
          

16-23
C
            = 4. 319 ΩF;
            C
            = 8. 2219 ΩF
          

16-25





16-27








16-29
            V
            BC
            = 4157∠90° V (rms)
          

16-31


                (a)
                



                  ZY1=100-20Í;
                

                  ZD1 = 3*ZY1;
                

                  ZD2 =120+500Í;
                

                  ZDEQ = ZD1*ZD2/(ZD1 + ZD2)
                

                  ZYEQ = ZDEQ/3
                

                  ZDEQ = 244.7351Θ + 000 + 83.6108e+000i
                

                  ZYEQ= 81.5784e+000+27.8703e+000i
                

(b) The load impedances are equivalent and they are related by a factor of three, so they have the same θ and the power factors are the same.



16-33









16-35


                (a) Z
                YEQ
                =5.975+ j2.407 Ω
              

                (b)
                






16-37





16-39

            at 60 Hz, the load for each phase is a 424.6−Ω resistor in series with a 751.2−mH inductor
          

16-41


                (a) Z
                Y
                = 100 −j200 Ω/phase
              

                (b)
                

(c) pf = 0.447



16-43





16-45
            Connect the capacitor provided by the manufacturer in series with each load impedance increased the apparent power delivered to the load. Now consider a capacitor added to the load that also compensates for the inductance in the wires. We require
            C
            = 453.57 ΩF. Using the additional capacitor to cancel the inductance in both the load and the wire increased the apparent power delivered to the load even more. Although the load power factor is not one, the apparent power is larger. We can improve the apparent power delivered to the load by optimizing the capacitance. Choosing
            C
            = 398.24 ΩF will yield
            
S
L

            = 8.3731z −18.39° kVA.
          

16-47


                (a) Z
                Y
                =7
                .
                3728+ j5.5296 Ω
              

                (b) To change the reactance from
                j
                5.5296 to -
                j
                5.5296 we have to introduce -
                j
                11.0592 Ω of reactance. At 60 Hz, we can do this with a capacitor
                C
                = 239.85 ΩF connected in series with each phase.
              



16-49





16-51





16-53





16-55
            52 kVA
          

16-57







              The currents through the non-failed loads have changed in magnitude and phase and are now separated by 180° in phase instead of the normal 120
              °
              . These changes could have a negative effect on the loads or the sources and could cause a cascade of damages throughout the system. Having then neutral line in place could prevent these additional problems.
            




CHAPTER 17


17-1









17-3








17-5






17-7

              I
              1

            = 60 mA;
            
              I
              2

            = - 20 mA
          

17-9
            The load impedance introduces the following constraint:
            


Apply the constraint to the i-υ relationships.





17-11





17-13



17-15


                (a) y
                T
                = 10 V;
                R
T
                =250 Ω
              

                (b) For maximum power transfer to the load, select
                R
L
                =
                R
T
                = 250 Ω
              



17-17


                (a)
                


                (b)
                




17-19
            The
            i
            -υ relationships are:
            V
1
            =
            h
11
I
1
            +
            h
12
            V
            2
            ;
            I
2
            =
            h
21
I
1
            +
            h
22
V
2

              Apply
              V
X
              to the input port and short-circuit the output port.
            




              Apply V
              X
              to the output port and short-circuit the input port.
            




              Comparing the equations for
              I
1SC
              and
              I
2SC
              , for reciprocity to hold, we must have
              h
12
              = -
              h
21
              .
            


17-21
            The
            i
            -υ relationships are:
            V
1
            =
            AV
2
            −
            BI
2
            ;
            
I
1
              =
              CV
2
              -
              DI
2


              Solve the first equation for
              I
              2.
            




              Substitute the results for
              I
2
              into the second
              i
              -υ relationship.
            





17-23




17-25



17-27

            the network is reciprocal since Z
            12
            = z
            21




CHAPTER 18


18-1



18-3

              syms t w
            

              ft = 5*pi*cos(pi*t/4)*(heaviside(t)-heaviside(t-8));
            

              Fw = int(ft*exp(-1i*w*t),t,-inf,inf);
            

              Fw = simplify(Fw)
            

                  
            

              
                Fw = (pi*w*80i - pi*w*exp(-w*8i)*80i)/ (pi
                ^
                2 - 16*w
                ^
                2)
              
            





18-5

              syms t w
            

              Fw = cos(pi*w/4)*(heaviside(w+4)-heaviside(w-4));
            

              ft = 1/2/pi*int(Fw*exp(1i*w*t),w,-inf,inf)
            

              ft = vpa(ft,5)
            

                  
            

              ft = (5734161139222659*t*sin(4*t))/ (1125899906842624*(pi^2 - 16*t^2)) ft=-(5.093*t*sin(4.0*t))/(16.0*t^2 - 9.8696)
            





18-7


                (a)
                


                (b)
                




18-9


                (a)
                


                (b)
                




18-11


                (a)
                f
1
                (
                t
                ) = 3 + 3e
                
j
                  3
                  t

                + 3e
                
j
                  4
                  t



                (b)
                f
2
                (
                t
                ) = 2 + 3sgn(
                t
                ) + 2e
                
j
                  2
                  t



                (c)
                f
3
                (
                t
                ) = 5 + 10sgn(
                t
                )
              



18-13


                (a)
                f
1
                (
                t
                ) = 3 + 3sgn(
                t
                −5) =6
                u
                (
                t
                −5)
              

                (b)
                f
2
                (
                t
                ) =50e
                
                  −5(
                  t
                  −4)
                
u
                (
                t
                - 4)
              

                (c)
                f
3
                (
                t
                ) =
                u
                (
                t
                + 20) +
                u
                (
                t
                −20)−1
              



18-15





18-17



18-19



18-21



18-23





18-25



18-27
            The transfer functions are high-pass filters with the cutoff frequency controlled by the parameter α. Α larger value for α increases the cutoff frequency.
            




18-29

              syms t w
            

              syms B positive
            

              Hw= 2*heaviside(w+2*B)-heaviside(w+B) ...
            

              +heaviside(w-B)-2*heaviside(w-2*B); ht = simplify(ifourier(Hw,w,t))
            

              ht = -(sin(B*t) - 2*sin(2*B*t))/(t*pi)
            


18-31
W
1Ω
            =9 J
          

18-33
            W
            1Ω
            =81.818 μJ
            
              syms t w
            

              ht = 3*exp(-200*t)*heaviside(t);
              xt = 4*exp(-20*t)*heaviside(t);
              
                % Compute the output signal
              
              Hw = fourier(ht,t,w);
              Xw = fourier(xt,t,w);
              Yw = Hw*Xw
              yt = simplify(ifourier(Yw,w,t))
              yt2 = simplify(yt^2)
              
                % Find the energy in the output signal
              
              
                % Use both the frequency and time
              
              
                % integrals
              
              W= int((abs(Yw))^2,w,-inf,inf)/2/pi
              W2 = int(yt^2,t,0,inf)
            

              Yw = 12/((20 + w*1i)*(200 + w*1i))
              yt = (exp(-200*t)*(sign(t) + 1)
              *(exp(180*t) - 1))/30
              yt2 = (exp(-400*t)*(sign(t) +1)^2 *(exp(180*t) -1)^2)/900
              W = 9/110000
              W2 = 9/110000
            


18-35
W
            =2.5 MJ
          














Index






          ABCD parameters,
          see
          Transmission parameters
        

          ABET,
          v
          ,
          Appendix C


          Absorbs power i.e., p>0,
          9
          ,
          17


          ac (alternating current) signal,
          see
          Waveforms
        

          ac steady-state response,
          305


          Accelerometer response curve,
          P-40


          Across variable (voltage),
          9


          Active circuit,
          126


          Active device:
          

              dependent source,
              126


              OP AMP,
              149


              transducer,
              185


              transistor,
              146




          Active filters:
          

              basics,
              636


              Butterworth, LP
              662
              , HP
              684


              Chebyshev, LP
              669
              , HP
              690


              design,
              636
              ,
              see also
              Specific filter
            

              First-Order Cascade, LP
              658
              , HP
              682


              Sallen-Key, LP
              636
              , HP,
              642


              second-order LP
              637
              , HP
              642
              , BP
              646
              , BR
              649




          Adapter, 300Ω to 75Ω, photo,
          120


          ADC,
          see
          Analog-to-digital converter
        

          Additive property (sinusoids),
          225


          Additivity property:
          

              phasors,
              339


              of sinusoids,
              225


              superposition,
              93
              ,
              458




          Admittance (Y) (S):
          

              conductance (G),
              356


              Laplace,
              446


              matrix [
              y
              ],
              772


              parallel connection,
              356
              ,
              452


              parameters,
              768


              phasors,
              356


              susceptance (B),
              356


              transfer (T
              Y
              (s)),
              491


              two-port
              y
              -parameters,
              772



Affective domain, C-3

          Aliasing,
          633


          alpha (α), natural frequencies (s
          -1
          or nepers),
          316


          Ampere (A) (unit),
          6


          Ampère, André-Marie,
          1


          Amplifier:
          

              differential,
              167
              ,
              194
              ,
              195


              ideal OP AMP model,
              152


              inverting,
              161


              inverting summer,
              164


              instrumentation, examples
              174
              ,
              196


              logarithmic,
              P-36


              noninverting,
              153


              noninverting summer,
              166


              real OP AMPs
              (GB),
555


              subtractor-double,
              171


              subtractor-single,
              167


              transistor, application
              146


              voltage follower,
              159




          Amplitude descriptors:
          

V
MAX
              >,
              V
MIN
              >,
              V
p
              ,
              V
pp
              ,
              235


V
avg
              ,
              235
              ,
              see also
              dc value
            

V
rms
              ,
              237


              functions,
              209
              ,
              211
              ,
              215
              ,
              220




          Amplitude spectrum,
          613


          Analog computer, discussion,
          263


          Analog-to-digital (ADC) converter:
          

              flash,
              202
              , photo,
              203


              full-scale input,
              202


              resolution,
              203


              sample-hold,
              248
              , photo,
              248




          Analysis, definition,
          2
          ,
          174


          Angular or radian frequency (to) (rad/s),
          222


          Aperiodic waveform,
          224


          Apparent power (|
          S
          |) (VA),
          733


          Application examples:
          

              ADC to DAC to ADC,
              203


              analog switch,
              19


              analog-to-digital converter (ADC),
              248


              attenuation pad,
              121


              autotransformer,
              718


              band-limited differentiator,
              265


              batteries,
              49


              binary current divider,
              51


              Biquad filter,
              699


              cathode ray tube (CRT),
              7


              clock waveform,
              238


              clock waveform skew,
              539


              damped sinusoidal waveform,
              230


              dc power supply (full-wave rectifier),
              623


              decibels (dB),
              547


              digital clock detection,
              291


              digital clock skew,
              539


              digital multimeters (DMM),
              160


              dynamic OP AMP circuits,
              264


              ECG waveform,
              239


              electric machines,
              726


              exponential waveform,
              217
              ,
              218


              FET amplifier,
              142


              filter LP (using phasors),
              364


              gain-bandwidth product,
              557


              home power distribution,
              716


              home power usage and EV charging,
              739


              ideal vs. real OP AMPs,
              557


              impedance bridge,
              354


              instrumentation amplifier,
              196


              isolation transformer,
              724


              loading,
              120


              Maxwell bridge,
              355


              non-inverting summer,
              166


              oscilloscope,
              217
              ,
              218
              ,
              223
              ,
              226

philosophy, viii, C-1

              potentiometer,
              45


              resonance,
              362


              sample-and-hold circuit,
              248
              ,
              P-69


              signal bandwidth,
              631


              signal sampling theorem,
              631


              sinusoidal waveform,
              223


              step response descriptors,
              510


              strain gauge,
              194


              Thévenin measurements with DMM,
              99


              time-limited integrator,
              265


              wireless energy transmission,
              708




          Assigning reference marks,
          33


          Asymptotes, LP
          550
          ,
          638
          , HP
          559
          ,
          642

 
          Asymptotically stable, 
          504

   
          Average and reactive power,  
          730


          Average power (P), 
          395 
          , 
          731   
          of a periodic signal, 
          626

   
          Attenuator, in-line,
          121    
          , photo,  
          121

 
          Austin, Arthur O.,    
          726


          Austin transformer, photo,    
          725

 
          Autotransformer,   
          718   
          ,   
          722


          Average value:
          

              of a periodic signal (
              a
0
              ),
              604


              of power (
              P
              ),
              731


              of a signal (
              V
avg
              ),
              236


              of sinusoidal signal = 0,
              236








B
          (bandwidth) (Hz, rad/s),
          575
          ,
          580
          ,
          631
          ,
          648
          ,
          695


B
          (susceptance) (S),
          356


          Balanced three-phase:
          

              basics,
              745
              ,
              746
              ,
              748


              Δ-Δ connection,
              749


              Δ-Y connection,
              749


              Y-Δ connection,
              749


              Y-Y connection,
              749




          Ballantine, Stuart,
          767


          Bandpass filter:
          

              basics,
              547
              ,
              566


              cascade design,
              386
              ,
              566
              ,
              694


              narrow band,
              see
              Tuned
            

              parallel
              RLC
              ,
              581


              second order,
              646
              ,
              see also
              RLC
            

              series RLC,
              574


              tuned,
              575
              ,
              583
              ,
              648
              ,
              652


              using first-order circuits,
              566


              using phasor analysis,
              386


              wide band,
              566
              ,
              575
              ,
              695




          Bandstop filter:
          

              basics,
              547
              ,
              569
              ,
              649
              ,
              696


              narrow band,
              see
              Notch
            

              notch,
              579
              ,
              650
              ,
              696


              parallel design,
              579
              ,
              696


              second order,
              579
              ,
              649
              ,
              696


              series
              RLC,
579


              using first-order circuits,
              569




          Bandwidth (Hz, rad/s),
          575
          ,
          582
          ,
          637


          Bardeen, John,
          125


          Basic four filter gain responses,
          546


          Basic OP AMP Building Blocks Table,
          169


          Battery,
          20
          , application
          49
          ,
          P-15

Behaviorally Motivated Learning, C-1

          bel B (unit),
          548


          Bell, Alexander Graham, footnote
          548


          Bernoulli, Daniel,
          603


          Bessel filter,
          657
          ,
          P-138



          beta, β:
          

              current gain,
              126


              radian frequency, damped natural freq,
              316
              ,
              473




          Bilateral, definition,
          16


          Bipolar power,
          731


          Biquad filter,
          657
          ,
          698
          ,
          P-139


          Bipolar Junction Transistor (BJT),
          146


          Black, Harold S,
          125


          Block diagrams:
          

              additivity property,
              93


              differential amplifier,
              167


              differentiator,
              257


              integrator,
              257


              instrumentation system,
              184


              gain,
              89
              ,
              126
              ,
              184


              network function,
              488


              proportionality constant (
              K
              ),
              89


              of sinusoidal steady-stare response,
              512


              subtractor,
              167


              summary tables,
              169
              ,
              258
              ,
              Appendix G-5


              summer,
              164


              summing point,
              93
              ,
              164




          Blocking capacitor,
          508


          Bloom, B.S.,
          ix
          , footnote v, footnote C-1
        

          Bode, Hendrik,
          487
          ,
          543


          Bode diagram:
          

              basics,
              547
              ,
              584


              complex poles and zeros,
              591


              definition,
              547


              real poles and zeros,
              586


              straight-line approximation (SL),
              586


              using Multisim,
              590
              ,
              Appendix D


              using MATLAB,
              587
              ,
              Appendix D




          Brattain, Walter,
          125


          Braun, Ferdinand,
          7


          Braun tube,
          7


          Bridge circuits:
          

              basic,
              90


              bridge-T,
              71
              ,
              77
              ,
              121
              ,
              P-27


              impedance,
              354
              ,
              376


              Maxwell,
              355


              reference bridge,
              191
              ,
              194
              ,
              195


              Wheatstone,
              90




          Bromwich, Thomas John,
          401
          ,
          441


          Brune, Otto,
          487


          Budak, Aram, footnote
          670


          Buffer,
          159
          ,
          see also
          OP AMP circuits
        

          Bus,
          763


          Butterworth, Stephen,
          657
          ,
          P-90


          Butterworth:
          

              discussion of poles,
              665
              ,
              Appendix B


              high-pass response,
              684
              , curves
              685


              low-pass response,
              662
              , curves
              664


              overview,
              662


              pole-zero diagram,
              665
              ,
              678


              polynomials,
              664
              ,
              Appendix G-6


              step response,
              678


              third-order filter,
              P-139


              fifth-order passive,
              P-136








C
          (capacitance) (unit) (F),
          242


          Campbell, George A,
          635


          Capacitance (
          C
          )(F) definition,
          242


          Capacitive load,
          735


          Capacitive reactance (
          X
C
          ),
          351


          Capacitor (
          C
          ) (F):
          

              average power,
              395


              basics,
              242


              blocking,
              508


              bypass (for BJT),
              P-102


              dc response,
              269


              energy (
              w
C
              (
              t
              )),
              244
              ,
              395
              , photos,
              242
              ,
              243


              impedance (
              Z
C
              ),
              346
              ,
              445
              ,
              804


i-υ
              relationships,
              243


              parallel connection,
              266


              power (
              p
C
              (
              t
              )),
              244
              ,
              395


              series connection,
              267


              standard values,
              see
Appendix G-2


              supercapacitor,
              P-59
              ,
              P-69
              , footnote
              532


              tunable capacitor and radio,
              P-59


              two-wire feed through,
              P-57




          Cascade connection,
          157
          ,
          174
          ,
          500
          ,
          525
          ,
          636


          Cascade design:
          

              dc OP AMP,
              174


              first-order filters,
              566
              ,
              636
              , LP
              658
              , HP
              682


              multiple-order filters,
              636


              transfer function,
              525




          Cathode Ray Tube (CRT) application,
          7


          Cauer, Wilhelm,
          487
          ,
          657


          Cauer or Elliptic filter,
          657


          Causal waveform,
          235
          , footnote
          519
          , footnote
          788


          Cell phone generations, 1G to 5G,
          545


          Center frequency (ω
          0
          ),
          574
          ,
          578
          ,
          648
          ,
          651


          Chain rule,
          170
          ,
          500
          ,
          636


          Chapter Learning Objectives (CLOs),
          v
          ,
          3
          ,
          Appendix C


          Characteristic equation:
          

              first order,
              75


              second order, series
              311
              , parallel
              321




          Charge (
          q
          (
          t
          )) (C),
          5
          ,
          242
          , of an electron,
          5


          Charging exponential,
          see
          Exponential rise
        

          Chebyshev Type 1:
          

              discussion of poles,
              Appendix B


              high-pass response,
              690
              , curves
              691


              low-pass response,
              669
              ,
              672
              , curves
              671


              overview,
              656
              ,
              669


              pole-zero diagram,
              678


              polynomials,
              672
              ,
              Appendix G-6


              ripple discussion, footnote
              670


              step response,
              678




          Chebychev Type II,
          656


          Chen, Wai Kai, footnote
          647


          Chirp signals,
          P-50


          Circuit (definition),
          2
          ,
          16
          ,
          22


          Circuit analysis:
          

              combined constraints (dc),
              28


              computer aided,
              11
              ,
              57
              ,
              Appendix D


              definition,
              vi
              ,
              3
              ,
              22


              dependent sources,
              126


              phasor domain,
              350
              , using Multisim
              351
              , using MATLAB
              370


              phasor domain, mesh current,
              380


              phasor domain, node voltage,
              380


              phasor domain, theorems,
              366


s
              domain,
              451


              simulation comparisons,
              61


              single phase power,
              740


              summary of
              s
              -domain analysis,
              482


              three-phase power,
              750


              of transformers (phasors),
              719


              using Fourier series,
              617


              using Fourier transforms,
              803


              using Laplace transforms,
              428
              ,
              433
              ,
              467
              ,
              476


              Y-Δ circuit analysis using Multisim,
              756


              Y-Y circuit analysis using Multisim,
              751
              ,
              753




          Circuit design:
          

              ac voltage divider (phasor),
              351


              analog computer, discussion,
              263


              band-limited differentiator/integrator,
              265


              bandpass filter,
              386
              ,
              567
              ,
              648
              ,
              695


              bandstop filter,
              570
              ,
              651
              ,
              696


              Bode plot,
              590


              Butterworth, LP
              666
              , HP
              686


              Chebyshev, LP
              673
              , HP
              691


              comparator,
              199


              complex poles,
              473


              concepts,
              112
              ,
              174


              DAC,
              181


              dc voltage divider,
              43


              differential equation,
              262
              ,
              264


              digital inverter (BJT),
              146


              discussion,
              vi
              ,
              3
              ,
              113


              driving-point impedance,
              497


              First-Order Cascade, LP
              660
              , HP
              683


              first-order step response,
              295
              ,
              297
              ,
              508
              ,
              536


              first-order voltage divider,
              526


              high-pass filters,
              561
              ,
              563
              ,
              643
              ,
              see also
              First Order Cascade, Butterworth, and Chebyshev
            

              input-output relationship,
              113
              ,
              465


              interface circuits (dc),
              112
              -123
            

              interface circuit (ac) (phasors),
              378


              inverting OP AMP network,
              531
              ,
              535


              home power distribution,
              716


              LED interface,
              115


              lightning pulser,
              P-71


              load design
              (Z
              L) (phasors),
              373


              low-pass filters,
              372
              ,
              553
              ,
              639
              ,
              660
              ,
              666
              ,
              673


              network function,
              497
              ,
              525
              ,
              529
              ,
              530
              ,
              534


              notch filter,
              581
              ,
              651
              ,
              654


              OP AMP inverter,
              161
              ,
              529


              OP AMP interface circuit,
              167
              -173
            

              OP AMP instrumentation,
              183
              -198
            

              OP AMP non-inverter,
              153
              ,
              160


              OP AMP subtractor (difference amp),
              167
              ,
              171


              OP AMP summer,
              164
              ,
              166


              passive notch filter,
              579


              phasor voltage divider,
              351


              philosophy,
              v
Appendix C


              poles and zeros,
              483


              power factor correction,
              744


RC
              circuit,
              272


RL
              circuit,
              272


RLC
              circuits, series,
              309
              , parallel,
              320


              sample-hold,
              248


              second-order active filters, BP
              566
              ,
              648
              , BS
              574
              ,
              651


              second-order network function,
              528
              ,
              534


              second-order step response,
              334
              ,
              536


              step function,
              536


              transfer function,
              528


              transistor inverter,
              149


              transformer maximum power transfer,
              718


              tuned filter in Fourier series analysis,
              621


              using MATLAB,
              456
              ,
              538
              ,
              580
              ,
              589
              ,
              594
              ,
              639
              ,
              643
              ,
              648
              ,
              651
              ,
              660
              ,
              686
              ,
              691
              ,
              695
              ,
              696
              ,
              see also
Appendix D


              using Multisim,
              191
              ,
              193
              ,
              261
              ,
              318
              ,
              379
              ,
              538
              ,
              557
              ,
              561
              ,
              589
              ,
              595
              ,
              621
              ,
              639
              ,
              643
              ,
              651
              ,
              654
              ,
              660
              ,
              666
              ,
              679
              ,
              683
              ,
              691
              ,
              717
              ,
              see also
Appendix D


              voltage divider and OP AMP,
              528
              ,
              530





          Circuit determinant,
          71
          ,
          76
          ,
          469
          ,
          474
          ,
          477
          ,
          481
          ,
          498


          Circuit reduction,
          52
          ,
          344
          ,
          453


          Circuit theorems:
          

              maximum power transfer,
              110
              ,
              396


              maximum signal transfer,
              109


              proportionality,
              89
              ,
              366
              ,
              457


              superposition,
              94
              ,
              367
              ,
              458


              Thévenin/Norton,
              98
              ,
              372
              ,
              464




          Circuit variables,
          5


          Clock waveform,
          238


          Closed loop,
          557


          Cognitive domain,
          C-1
          , footnote
          C-1


              analysis,
              C-1


              application,
              C-1


              comprehension,
              C-1


              design or synthesis,
              C-2


              evaluation,
              C-2


              knowledge,
              C-1




          Color code for resistors,
          G-1


          Collision avoidance radar,
          P-51


          Combined constraints,
          28
          ,
          344
          ,
          451


          Common mode rejection ratio (CMRR),
          196


          Communications,
          544
          , footnote
          596
          ,
          P-125
          ,
          P-139


          Comparator:
          

              basics,
              199


              flash ADC,
              202
              , photo,
              203


              zero-crossing detector,
              200




          Complex frequency (
          s
          = α ±
          j
          β) (rad/s),
          316
          ,
          see also
          footnote
          316


          Complex frequency variable
          s
          (Laplace),
          402


          Complex numbers:
          Appendix F


              arithmetic operations,
              F-2
              ,
              F-3


              complex number representations,
              F-1


              conjugate,
              F-2


              imaginary part,
              F-1


              polar form,
              F-1


              real part,
              F-1


              rectangular form,
              F-1




          Complex poles,
          419
          , on
          s
          plane
          472


          Complex power (S) (VA):
          

              basics,
              732


              conservation of,
              735


              and load impedance,
              734




          Composite waveforms:
          

              basics,
              227


              damped ramp,
              229


              damped sinusoid,
              230


              double exponential,
              233


              double-sided exponential,
              229


              exponential rise,
              228


              sifting property,
              228


              signal's fundamental frequency,
              233


              signal's harmonic frequencies,
              234


              signum function,
              227




          Computer tools:
          

              basics,
              11
              ,
              56
              ,
              Appendix D


              comparison between tools,
              61


              Excel,
              215
              ,
              306
              ,
              471
              ,
              625
              ,
              626


              MATLAB,
              13
              ,
              Appendix D


              Multisim,
              56
              ,
              Appendix D


              philosophy,
              viii




          Conductance (G) (S),
          4
          ,
          16
          ,
          356
          ,
          446


          Conjugate match (max power),
          397


          Connections models:
          

              control line,
              22


              crossover,
              22


              electrical,
              22


              jack connection,
              22


              power supply,
              22




          Connection constraints:
          

              definition,
              21
              ,
              22


              minimum number of equations,
              30


              using phasors,
              344


              using Laplace transforms,
              443


              using Fourier transforms,
              803




          Continuity:
          

              capacitor voltage,
              244
              ,
              294


              inductor current,
              251
              ,
              294




          Convolution:
          

              applications of,
              525


              basics,
              519


              equivalence between
              t
              - and
              s
              -domains,
              521


              Fourier,
              806


              graphical approach,
              523


              integral,
              519


              using MATLAB,
              521
              ,
              Appendix D




          Corner frequency (ω
          C
          ),
          551


          Coulomb C (unit),
          5


          Coupled inductors:
          

              basics,
              702


              dot convention,
              704


              energy,
              709


i-υ
              characteristics,
              702


              Multisim analysis,
              706


              mutual inductance,
              702
              ,
              703


              self-inductance,
              703




          Coupling coefficient (
          k
          ),
          710


          Course learning objectives (CLOs):
          

              basics,
              3
              ,
              Appendix C
              , intro to each chapter and with each problem set
            



          Cover-up algorithm,
          418


          Cramer's rule,
          71
          ,
          469
          ,
          Appendix A


          Critical frequencies (ω
          C
          ),
          414


          Critically damped,
          317


          Crystal filters,
          P-139


          Current:
          

              definition,
              6


              lag, lead,
              345
              ,
              346


              line,
              750


              mesh,
              81


              Norton,
              98


              phase,
              755


              short circuit,
              99




          Current division:
          

              basics,
              47
              ,
              356
              ,
              452


              binary, application
              51


              phasor,
              356


              rule,
              48


              two-path,
              48




          Current gain (β),
          126
          , (
          T
I
          (
          s
          )),
          482


          Current source:
          

              dependent,
              126
              ,
              390
              ,
              444


              Fourier representation of,
              804


              ideal,
              20
              ,
              443


i-v
              characteristics,
              20


              Laplace representation of,
              443


              phasor representation,
              338


              practical,
              21


              symbol,
              20




          Current transfer function (
          T
I
          ),
          491


          Cutoff frequency (ω
          C
          ,
          f
C
          ),
          365
          ,
          546
          ,
          575
          ,
          see also
          Respective filters
        

          Cyclic frequency (
          f
          ) (Hz),
          222






          Δ-connection,
          748


          Δ-Y transformation,
          749


          DAC,
          see
          Digital-to-analog converter
        

          DAC - ADC example
          203


          Damped ramp,
          229


          Damped sinusoid,
          230


          Damping cases
          (RLC),
          series
          317
          , parallel
          321


          Damping ratio (ζ),
          326
          ,
          472
          ,
          473
          ,
          485
          ,
          648
          ,
          651


          Darlington, Sidney,
          487


          D'Arsonval meter,
          P-15


          dc (direct current):
          

              average value (
              V
avg
              ),
              235


              current source,
              20
              ,
              21


              signal,
              208


              voltage source,
              20
              ,
              21




          dc equivalent circuits, of
          C
          and
          L,
269


          dc steady-state response,
          506


          Decade,
          547


          Decibel,
          547


          Decrement property,
          216


          Defibrillation waveform,
          P-50


          Delay time (
          T
D
          ),
          510
          ,
          540


          Delay skew,
          540


          Delivers power i.e., p<0,
          9


          Delyannis-Friend circuit, footnote
          647


          Dependent source:
          

              analysis,
              127


              basics,
              126


              CCCS,
              126
              ,
              135


              CCVS,
              126
              ,
              135


              Laplace representation of,
              444


              in Multisim,
              135


              parameters, μ, β,
              g
              ,
              r
              ,
              126


              Thévenin/Norton,
              144


              VCCS,
              126
              ,
              135


              VCVS,
              126
              ,
              135




          Design, definition,
          vi
          ,
          2
          ,
          see also
          Circuit design
        

          Derivative property, phasors,
          340


          Determinant,
          Appendix A
          circuit,
          71
          ,
          76
          ,
          469
          ,
          474
          ,
          477
          ,
          481
          ,
          498


          Device, definition,
          16


          Differential amplifier or subtractor:
          

              basics,
              167


              definition,
              157


              instrumentation,
              174
              ,
              196


              one-stage,
              167


              two-stage,
              171




          Differential equation:
          

              classical solution first order,
              272


              classical solution second order,
              309
              ,
              320


              solution by Fourier transforms,
              806


              solution by Laplace transforms,
              428




          Differentiator:
          

              band-limited,
              265


              definition,
              257




          Differentiation property:
          

              Fourier,
              797


              Laplace,
              409




          Digital-to-analog converter (DAC):
          

              discussion of,
              181


              full-scale output,
              181


              photos,
              181


R
              -2
              R
              ladder,
              182


              resolution,
              181


              weighted summer,
              183




          Digital Multimeter (DMM),
          99
          ,
          160


          Dirac, Paul, footnote
          211


          Dirichlet, P.G.L.,
          603
          , footnote
          605
          ,
          787
          ,
          792


          Dirichlet conditions,
          605
          ,
          789


          Distributed elements,
          545


          Dot convention,
          704



          Double exponential,
          233


          Double-sided exponential,
          229
          ,
          799


          Doublet (δ'(t)),
          423
          , footnote,
          423


          Driving function,
          20


          Driving-point impedance,
          491


          Duality:
          

              definition,
              255


              examples, footnote
              36
              ,
              255
              ,
              273
              ,
              321
              ,
              582




          Duality property,
          800


          Dynamic OP AMP circuits,
          256






          ECG (EKG) waveform,
          239
          ,
          P-51
          ,
          P-131


          Edison, Thomas,
          701
          ,
          729


          Effective value,
          237
          ,
          see also
          Root-mean-square
        

          Efficiency η
          1
          -21,
          P-3
          ,
          P-82


          Electric field (ℰ) (V/m),
          242
          ,
          see also
          Footnote,
          242


          Electromagnetic spectrum,
          544


          Electron volts eV (unit),
          544


          Element, definition,
          16


          Element constraints:
          

              basics,
              16


              using Fourier transforms,
              803


              using Laplace transforms,
              443


              using phasors,
              344




          Element impedances at dc and ω → ∞, table
          547


          Elliptic or Cauer filter,
          657


          Electromagnetic Pulse (EMP)
          792


          Energy (
          w
          ) (J):
          

              capacitor,
              244


              coupled inductors,
              709


              definition,
              6


              inductor,
              251


              phasors,
              394


              signal,
              810




          Energy spectral density,
          811


          Equal-capacitor method, BP
          647
          , BR
          650


          Equal-element filter method, LP
          639
          , HP
          643


          Equiripple filters,
          657
          ,
          see also
          Chebyshev filters
        

          Equivalent circuits:
          

              admittance,
              351
              ,
              453


              capacitance,
              266


              capacitance at dc,
              269


              conductance,
              35


              definition,
              35


              impedance,
              351
              ,
              452


              inductance,
              267


              inductance at dc,
              269


              other source transformations,
              41


              resistance,
              35


              sources,
              39


              summary of,
              41
              , (figure)
              42


              Thévenin/Norton,
              98
              ,
              372
              ,
              464
              ,
              P-144


              transformer,
              P-144




          Euler's relationship,
          338
          ,
          733
          , App
          F-1


          Evaluation:
          

              bandpass circuits,
              578


              bandstop circuits,
              570
              ,
              654


              basic design concepts,
              112


              block diagram design, examples
              170
              ,
              178
              ,
              180


              cascade connections,
              501
              ,
              503
              ,
              689
              ,
              691


              Chebyshev HPF,
              691


              definition,
              vi
              ,
              2


              design evaluation summary,
              535


              eliminate
              60
              Hz hum,
              514


              high-pass filters (phasors),
              385


              high-pass filters (
              s
              domain),
              563
              ,
              689
              ,
              691


              high fidelity filter,
              679


              input-output relation,
              174
              ,
              178


              interface circuits (active),
              177
              ,
              178
              ,
              180


              interface circuits (passive),
              116
              ,
              118
              ,
              123


              loading,
              501


              low-pass filters (phasors),
              370


              low-pass filters
              (s
              domain),
              679


              notch filter,
              598
              ,
              654


              O-pad,
              123


              philosophy,
              vi
              ,
              Appendix C


              pressure transducers,
              601


RC
              circuits,
              299


              residential power, distribution,
              739
              , EV charging analysis,
              740


RLC
              bandpass filter circuit,
              576
              ,
              583


RLC
              series underdamped response,
              335


              second-order LP filter,
              639


              sinusoidal step response,
              308


              step response designs,
              300
              ,
              536


              T-circuit filter (phasor domain),
              370


              transfer function designs,
              525
              ,
              535




          Even symmetry,
          615


          Examples, use in text,
          3


          Exercises, use in text,
          3


          Exponential order (Laplace),
          403


          Exponential waveform:
          

              basics,
              214


              double,
              233


              double-sided,
              229


              Fourier transform of,
              791
              , table
              802


              Laplace transform of,
              404
              , table
              411
              and Appendix
              G-6


              properties of,
              216


              rise or charging,
              228


              time constant (
              T
C
              ),
              214




          Exponential signal descriptors,
          P-50






          farad (F) (unit),
          242


          Faraday, Michael,
          241
          ,
          271
          ,
          701


          Feedback:
          

              feedback resistor,
              131
              , footnote
              153




          Fiber optics vs. Cellular,
          P-125


          Filter:
          

              active,
              636


              active LP filter overview,
              656


              bandpass,
              386
              ,
              566
              ,
              646
              ,
              694


              bandstop,
              569
              ,
              649
              ,
              664
              ,
              696


              basics,
              545


              Bessel,
              656
              ,
              P-137


              biquad,
              656
              ,
              698
              ,
              P-139


              Butterworth, LP
              662
              , HP
              684


              Chebyshev, LP
              669
              , HP
              690


              Crystal filter,
              P-140


              evaluation of LPF,
              677


              First-Order Cascade, LP
              658
              , HP
              682


              form of second-order filters,
              637


              high pass,
              365
              ,
              559
              ,
              642
              ,
              682


              400 Hz notch,
              P-134


              50 Hz notch,
              P-83


              60 Hz notch,
              654


              low pass,
              365
              ,
              372
              ,
              549
              ,
              637
              ,
              656


              notch,
              581
              ,
              650
              ,
              652


              passive,
              636


              phasor (LP),
              366
              ,
              372


              pole-zero diagram comparison,
              678


              step response comparisons,
              678


              summary of second-order filters,
              677


              tuned,
              648


              using MATLAB,
              371
              ,
              386
              ,
              580
              ,
              587
              ,
              639
              ,
              648
              ,
              651
              ,
              654
              ,
              660
              ,
              686
              ,
              691
              ,
              695
              ,
              696
              ,
              see also
Appendix D


              using Multisim,
              576
              ,
              583
              ,
              589
              ,
              639
              ,
              643
              ,
              651
              ,
              654
              ,
              666
              ,
              679
              ,
              683
              ,
              686
              ,
              691
              ,
              698
              ,
              see also
Appendix D




          Final conditions,
          293


          Final-value property,
          436


          First-order circuit:
          

              basics, LP
              272
              ,
              273
              , HP
              559


              design with (bandpass),
              566


              design with (bandstop),
              569


              design with (high pass),
              561
              ,
              682


              design with (low pass),
              552
              ,
              553
              ,
              658


              differential equation,
              RC
273
              ,
              RL
273


              exponential input transient response,
              300


              frequency response (high pass),
              559


              frequency response (low pass),
              549


              network function design,
              525


RC
              and
              RL
              circuits,
              273
              ,
              274
              ,
              284
              ,
              293
              ,
              300


              sinusoidal input transient response,
              303


              step response,
              284


              zero-input response,
              291
              ,
              459


              zero-state response,
              291
              ,
              459




          First-Order Cascade filters, LP
          658
          , HP
          682


              filter response curves, (LP)
              659
              , (HP)
              683


              pole-zero diagram,
              678


              step response,
              678




          Flash converter (ADC),
          202
          , photo
          203


          Flow diagrams:
          

              classical dynamic analysis,
              272


              Laplace, dynamic circuits,
              402


              Laplace, transformed circuits,
              442


              phasor circuit analysis,
              350




          Flux (ϕ) (Wb),
          249
          ,
          702
          ,
          704
          ,
          711


          Flux linkage (λ) (Wb-t):
          

              basics,
              249


              coupled coils,
              702


              transformers,
              711




          Follower,
          159
          ,
          see also
          OP AMP circuits
        

          Forced pole,
          470
          ,
          483
          ,
          484


          Forced response,
          284
          ,
          465
          ,
          470
          ,
          483
          ,
          484


          Forcing function,
          20


          Foster, Ronald M,
          487


          Fourier, Jean Baptiste,
          603
          ,
          787


          Fourier domain transfer function,
          807


          Fourier series:
          

              alternative form,
              613


              amplitude spectrum,
              613


              average power,
              626


              in circuit analysis,
              617


              coefficients,
              604
              ,
              605


              composite waveforms,
              233


              deriving equations for the Fourier coefficients,
              609


              fundamental frequency,
              604


              line spectra,
              609
              ,
              613


              overview,
              604


              phase spectrum,
              613


              rms value,
              626


              symmetries,
              615


              table of common waveforms,
              611


              trigonometric spectrum,
              609


              using MATLAB,
              607
              ,
              Appendix D




          Fourier transforms (ℱ)
          

              circuit analysis,
              803


              definition,
              788


              difference between T(s) and H(cω),
              807


              duality property,
              800


              impulse response and convolution,
              806


              linearity,
              796


              Parseval's theorem,
              809


              properties,
              796



              relationship to Laplace transforms,
              793


              reversal property,
              798


              scaling property,
              801


              tables of pairs and properties,
              802
              ,
              803


              time and frequency shifting,
              801


              time differentiation,
              797


              time integration,
              797


              transfer function (H(ω)),
              807


              transform pair,
              788
              ,
              802


              uniqueness,
              792




          Frequency:
          

              angular (ω) (rad/s),
              222


              center (
              f
0
              , ω
              0
              ),
              574
              ,
              578
              ,
              648


              complex (
              s
              ),
              316


              corner (
              f
C
              , (ω
              C
              ),
              551


              critical (
              f
C
              , ω
              C
              ),
              414


              cutoff (
              f
C
              , ω
              C
              ),
              546
              ,
              567
              ,
              570


              cyclic (
              f
              ) (Hz),
              222


              damped natural (β),
              316


              fundamental (
              f
0
              , ω
              0
              ),
              233
              ,
              604


              harmonic,
              224
              ,
              604


              natural,
              316


              negative,
              788


              neper (α),
              316


              notch,
              579
              ,
              654


              radian (β, ω),
              316


              resonant (ω
              0
              ),
              347
              ,
              575
              ,
              579


              sixty cycle,
              226


              spectrum, E/M
              544
              ,
              605
              ,
              613


              undamped natural (ω
              0
              ),
              326




          Frequency response:
          

              bode diagrams,
              584


              definition,
              545


              descriptors,
              545


              first-order bandpass,
              566


              first-order bandstop,
              569


              first-order high pass,
              559


              first-order low pass,
              365
              ,
              549


              of four basic gain responses,
              546


RLC
              circuits bandpass,
              386
              ,
              566


RLC
              circuits bandstop,
              569


              and step response,
              596




          Fundamental frequency,
          233
          ,
          604


          Fundamental property of mesh currents,
          81


          Fundamental property of node voltages,
          64


          Full-scale output (DAC),
          181


          Fuse, circuit model,
          18
          , photo,
          18






g,
          transconductance (S),
          126


G
          (
          s
          ) (step response transform),
          506


g
          (
          t
          ) (step response),
          506


          Gain (
          K
          ):
          

              current,
              126


              follower,
              159


              inverter,
              161


              non-inverter,
              153


              proportionality constant,
              89
              ,
              126
              ,
              366
              ,
              457


              two-port
              T
V
              or
              T
I
              ,
              491


              voltage,
              126




          Gain-bandwidth product (
          GB
          ),
          555


          Gain function (|
          T
          (
          j
          ω)|
          dB
          ),
          545


          Gaulard, Lucien,
          701


          Gate function,
          210


          Gibbs, Josiah,
          701


          Grapher View (Multisim),
          60


          Ground:
          

              definition and symbol,
              10


              discussion,
              28




          Ground loop,
          724






H
          (
          s
          ) (impulse response transform),
          503


h
          (
          t
          ) (impulse response),
          503


          Half-life radioactivity,
          P-46


          Half-wave symmetry,
          615


          Harmonic frequency,
          234
          ,
          604


          Heaviside, Oliver, footnotes
          209
          ,
          337
          ,
          401
          ,
          441


"heaviside(t) "
          MATLAB function, footnote
          209


          Helmholtz, Hermann von,
          63


          Henry, Joseph,
          241
          ,
          249
          ,
          701


          henry (H) (unit),
          249


          Hertz, Heindrik,
          543


          hertz (Hz) (unit),
          222


          Hidden symmetry,
          616


          High-pass filter:
          

              basics,
              547
              ,
              682


              Butterworth,
              684


              Chebychev,
              690


              first order,
              559


              First-Order Cascade,
              782


              second order equal element,
              643


              second order unity gain,
              643




h
          -matrix [
          h
          ],
          775


          Home power distribution,
          716
          ,
          739
          ,
          P-82


          Homogeneity,
          88
          ,
          366
          ,
          457


          Homogeneous equation,
          274


          Hybrid
          h
          -parameters,
          774
          , Multisim,
          776






i
          (the current variable) (A),
          6


i-υ
          characteristics, definition,
          16


          Tdeal models:
          

              BJT transistor,
              146


              capacitor,
              243


              current source,
              20


              dependent source,
              126


              inductor,
              250


              OP AMP,
              152
              , and GB
              556


              open circuit,
              18


              resistor,
              16


              short circuit,
              18


              switch,
              18


              voltage source,
              20




          Ideal transformer:
          

              basics,
              711


              input impedance,
              716


i-υ
              relationships,
              714




          Impedance (
          Z
          )(Ω):
          

              bridge,
              354


              concept,
              346
              ,
              445


              driving-point,
              491


              frequency effects on,
              346


              input,
              491


              magnitude scaling,
              531


              matrix [
              z
              ],
              769


              parallel connection Laplace,
              452


              parallel connection phasor domain,
              356


              ratio of phasors
              V
              and
              I,
351


              ratio of
              V
              (
              s
              ) and
              I
              (
              s
              ),
              445


              ratio of
              V
              (ω) and
              I
              (ω),
              804


              resistance and reactance,
              351


              resonance (ω
              0
              ),
              347


              series connection Laplace,
              451


              series connection phasor domain,
              346


              two-port
              z
              -parameters,
              769


              voltage source,
              20
              , footnote
              110




          Improper rational function,
          422


          Impulse function (δ(
          t
          )),
          210
          ,
          794


          Impulse generator,
          P-157


          Impulse response (ℒ)(
          h
          (
          t
          )),
          806


          Impulse response (
          ℒ
          )(
          h
          (
          t
          )),
          504
          , diagram
          507


          Impulse response transform (
          H
          (
          s
          )):
          

              basics,
              504


              and convolution,
              519
              , (H(ω)),
              806


              diagram,
              507


              from network function,
              506


              from step response,
              506




          Independent KCL equations = N-1,
          24


          Independent KVL equations = E-N+1,
          25


          Inductance (
          L
          ) (H):
          

              definition,
              249


              mutual (
              M
              ),
              702
              ,
              719


              self (
              L
              ),
              249
              ,
              703




          Inductive load,
          735


          Inductive reactance (
          X
L
          ) (S),
          351
          power factor correction,
          742


          Inductor (
          L
          ) (H):
          

              air-coil design,
              P-60


              average power,
              394


              basics,
              249


              chokes,
              532


              coupled,
              702


              dc equivalence,
              269


              energy (
              w
L
              (
              t
              )),
              251
              ,
              394


              impedance (
              Z
L
              ) (Fourier),
              804


              impedance (
              Z
L
              ) (Laplace),
              445
              ,
              446


              impedance (phasor domain),
              346


i-υ
              relationships,
              250


              parallel connection,
              267


              photos,
              249
              ,
              250


              power (
              p
L
              (
              t
              )),
              251
              ,
              394


              series connection,
              267


              standard values,
              532
              ,
              see also
              Appendix
              G-3




          Information signals,
          490


          Initial conditions,
          293


          Initial-value property,
          436


          In phase,
          345


          Input,
          89


          Input impedance (
          Z
IN
          ),
          491


          Instantaneous power (
          p
          (
          t
          ))(W):
          

              basics,
              394
              ,
              730


              capacitor,
              244


              inductor,
              251


              three-phase,
              762




          Instantaneous value,
          234


          Instrumentation systems:
          

              active transducers,
              184
              , photos
              186
              ,
              187
              ,
              189


              basics,
              183


              passive transducers,
              190
              , photos
              190
              ,
              191




          Instrumentation amplifier, example
          173
          ,
          196
          , photo and spec
          198


          Integrated circuit (IC),
          2
          ,
          531


          Integrating problems:
          

              description,
              vi
              ,
              3

end of problem sections



          Integration property:
          

              Fourier,
              797


              Laplace,
              408




          Integrator:
          

              description,
              257


              time-limited,
              265




          Interface,
          2
          ,
          22
          ,
          112


          Interface circuit design:
          

              300 Ω to
              75
              Ω adapter,
              120


              attenuation pad,
              121


              basics,
              112


              L-pad
              112
              , photo
              113


              O-pad,
              123



Internet of Things (IoT), iv


          Inverse Fourier transforms (ℱ
          -1
          ),
          792
          ,
          ifourier
          ,
          P-156


          Inverse Laplace transforms (ℒ
          -1
          )
          

              complex poles,
              419


              definition,
              405
              ,
              417


ilaplace
              ,
              427


              improper rational function,
              422


              multiple poles,
              424


              proper rational function,
              417


              simple poles,
              417


              sum of residues,
              421


              table,
              411
              ,
              412
              ,
              see also
              Appendix
              G-6


              using MATLAB,
              427
              ,
              Appendix D




          Inverting amplifier or inverter,
          161


          Inverting input (OP AMP),
          151


          Ion implantation,
          P-2


          Isolation transformer,
          724
          , photos
          724
          ,
          725






          Jack connection,
          22


          Joule (J) (unit),
          6






K
          (proportionality constant for gain),
          see
          Gain (
          K
          )
        

K
          (scale factor in pole-zero diagrams),
          414


k
1
          ,
          k
2
          (proportionality constants for inductors),
          249
          ,
          
            k
            M

703


k
          (coupling coefficient),
          710


          Kilby, Jack,
          125


          Kirchhoff, Gustav,
          22


          Kirchhoff's laws:
          

              basics,
              22


              current (KCL) dc,
              23
              ,
              24


              in Fourier transforms,
              803


              in Laplace transforms,
              443


              phasor domain,
              344


              voltage (KVL) dc,
              24








L
          (inductance) (H),
          249
          ,
          703


          L-pad,
          112
          , photo
          113


          Ladder circuit,
          52


          Lag, lead definitions,
          345
          ,
          346


          Lagging power factor,
          346
          ,
          733


          Laplace, Pierre Simon,
          401


          Laplace transforms (ℒ):
          

              basics,
              402


              circuit response using Laplace,
              428


              definition (ℒ),
              403
              , (ℒ
              -1
              )
              405


              differentiation property,
              409


              inverse,
              405
              ,
              417


              integration property,
              407


              linearity,
              406

philosophy, vii

              poles and zeros,
              414


              properties and pairs,
              406


              relationship to Fourier transforms,
              793


              solving differential/integrodifferential eq,
              428
              ,
              433


              summary of
              s
              -domain analysis,
              482


              table of pairs,
              411
              ,
              Appendix G


              table of properties,
              412
              ,
              Appendix G


              translation properties,
              s,
410
              ,
              412
t


              uniqueness property,
              405


              using MATLAB,
              414
              ,
              Appendix D

why use Laplace for ac circuits, vii



          Leading power factor,
          345
          ,
          735


          Linear:
          

              circuit,
              2


              definition,
              16


              element,
              16


              resistor,
              16
              ,
              see also
              Resistor
            

              transformer,
              719




          Linear dependent sources,
          126


          Linearity properties:
          

              additivity,
              88


              Fourier,
              796


              homogeneity,
              88


              Laplace,
              406


              proportionality,
              89


              superposition,
              89




          Line current,
          746


          Line spectra,
          609
          ,
          613


          Line voltage,
          746


          Load circuit,
          127


          Load-flow problem:
          

              single-phase,
              740


              three-phase,
              758
              ,
              763




          Loading:
          

              definition,
              121
              ,
              491


              follower used to avoid,
              159


              OP AMP,
              157
              ,
              170


s
              domain,
              525




          Load line,
          106


          Logarithmic amplifier,
          P-36


          Lookback impedance (
          Z
T
          ),
          373
          ,
          464


          Lookback resistance (
          R
T
          ),
          105


          Loop:
          

              definition,
              22


              number of independent KVL equations,
              25


              "window pane" analogy,
              25




          Low-pass filter:
          

              basics,
              547
              ,
              549
              ,
              656


              Butterworth,
              662


              Chebyshev,
              669


              comparisons,
              677


              first order,
              549


              First-Order Cascade,
              658


              phasor,
              365
              ,
              372


              second order equal capacitor,
              647


              second order equal element,
              643


              second order unity gain,
              643




          Lorenz, Hendrik,
          767


          Lumped components,
          545






M
          (mutual inductance) (H),
          703
          ,
          719


          Magnitude scaling,
          531


          Marginally stable poles,
          483


          Mast antenna, photo
          725


          Matrix:
          

              admittance or [
              y
              ] matrix,
              772


              basics,
              67
              ,
              69
              ,
              84
              ,
              Appendix A


              hybrid or [
              h
              ] matrix,
              775


              impedance or [
              z
              ] matrix,
              769


              mesh-current analysis,
              81


              node-voltage analysis,
              69


              non-symmetrical,
              133


s
              -domain analysis,
              469


              symmetrical,
              67


              transmission, ABCD, or
              [t]
              matrix,
              777


              using MATLAB,
              Appendix D


              using complex numbers (phasors),
              392




          Matched condition
          

              conjugate,
              397


              dc,
              110
              , footnote
              110




          MATLAB:
          

              applications, throughout text,
              Appendix D


              discussion,
              11
              ,
              56




          Maximally flat filters,
          657
          ,
          see also
          Butterworth
        

          Maximum signal transfer:
          

              basics,
              109


              current,
              109


              max power graph,
              111


              power,
              110
              ,
              396


              theorem (power),
              110


              voltage,
              109




          Maxwell bridge,
          355


          Maxwell, James Clerk,
          207
          ,
          543


          Mesh-current analysis:
          

              basics,
              80


              with current sources,
              85


              with dependent sources,
              139


              fundamental property,
              81


              by inspection,
              83


              non-symmetrical matrix
              Ax=b,
133


              summary of,
              88


              supermesh,
              86
              , example
              86


              symmetrical matrix
              Ax=b
              ,84
            

              using Fourier transform analysis,
              804


              using Laplace transform analysis,
              476


              using MATLAB,
              80
              ,
              82
              ,
              480
              ,
              Appendix D


              using Multisim, example
              86
              ,
              480
              ,
              Appendix D


              using phasor analysis,
              380




          Mho (℧) (unit),
          16
          ,
          135
          ,
          see also
          Siemens
        

          Mid-frequency,
          570


          Modulation,
          801


          mu μ, voltage gain,
          126
          , open-loop gain,
          153
          , permeability,
          249


          Multiple poles,
          424
          , filters
          636


          Multiplexer (MUX),
          19


          Multisim:
          

              applications, throughout text,
              Appendix D


              discussion,
              11
              ,
              getting started
54




          Mutual inductance (
          M
          ) (H),
          703
          ,
          719






N
          (coil turns),
          249
          ,
          702


n
          (turns ratio)
          712


          Napier, John, footnote
          316


          Narrow band,
          575


          Natural frequencies (s, a, p),
          316


          Natural pole,
          470
          ,
          488


          Natural response,
          284
          ,
          450
          ,
          483


          Negative feedback,
          125
          , footnote,
          153


          Neper frequency (s
          −1
          ),
          316
          ,
          also
          footnote
          316


          Netlist,
          57


          Network function:
          

              with current/voltage dividers,
              492
              ,
              526


              definition,
              488


              design and evaluation of,
              525


              design comparison,
              525
              ,
              535


              determining,
              492


              driving-point impedance (Z
              IN
              (
              s
              )),
              491


              importance of cascade connection,
              500


              impulse response,
              506


              with OP AMPs,
              529


              and phasors,
              518


              second-order design,
              533


              sinusoidal steady-state response,
              510


              step response,
              506


              transfer function (
              T
              (
              s
              )),
              491




          Network synthesis,
          487


          Neutral line role in three-phase power,
          P-150


          Node:
          

              definition,
              22


              number of independent KCL equations,
              24




          Node voltage,
          64


          Node-voltage analysis:
          

              basics,
              64


              with dependent sources,
              129


              formulating node-voltage equations,
              65


              fundamental property,
              64


              by inspection,
              68



              with OP AMPs,
              172


              solving Linear Algebraic Equations,
              69


              summary of,
              80


              supernode,
              74
              , example
              79


              symmetrical matrix
              Ax=b
              ,67
            

              using Excel,
              471


              using Cramer's Rule,
              76
              ,
              Appendix A


              using Fourier transform analysis,
              803


              using Laplace transform analysis,
              467


              using MATLAB,
              70
              , examples
              67
              ,
              72
              ,
              Appendix D


              using Multisim, exercises
              73
              ,
              75
              ,
              76
              ,
              382
              ,
              Appendix D


              using phasor analysis,
              380


              with voltage sources,
              73




          Non-causal waveform,
          235
          ,
          788


          Noninverting summer,
          P-29


          Noninverting amplifier,
          153


          Noninverting input (OP AMP),
          151


          Nonlinear:
          

              analysis,
              106


              element,
              16
              , NLE
              106




          Nonreciprocal network,
          770


          Norton equivalent circuit:
          

              applications,
              100


              basics,
              98


              phasor domain,
              373


s
              domain,
              464




          Notch bandwidth,
          579
          ,
          650


          Notch filter,
          579
          ,
          650
          ,
          654


          Notch frequency,
          579
          ,
          650


          Nyquist, Harry, footnote
          632


          Nyquist rate,
          249
          ,
          632






          Object-detection radar,
          P-48


          Octave,
          547


          Odd symmetry, footnote
          16
          ,
          615


          Ohm (Ω) (unit),
          16


          Ohm, Simon Georg,
          15


          Ohm's law,
          16


          O-pad,
          123


          OP AMP:
          

              basics,
              149


              closed-loop gain,
              153


              dependent source model,
              152


              effect of finite gain,
              155


              feedback requirement, footnote
              153


              ideal model,
              152


i-υ
              characteristics,
              152


              node analysis,
              172


              notation,
              150
              ,
              151


              open-loop gain (A), footnote
              152

operating modes, +, − saturation, or

              linear,
              151


              photos,
              150


              in the
              s
              domain,
              444


              transfer characteristics,
              151




          OP AMP circuits:
          

              adder,
              164
              ,
              see also
              Summing amplifier
            

              analog-to-digital (ADC) circuit,
              202


              analysis,
              157


              applications,
              181


              bandpass filter,
              568
              ,
              578
              ,
              647
              ,
              652
              ,
              694


              bandstop filter,
              571
              ,
              650
              ,
              652
              ,
              694


              buffer,
              159
              ,
              see also
              Follower
            

              building blocks,
              168


              cascading observation,
              170

choosing resistors, Note:154

              comparator circuits,
              199


              design,
              174


              differential amplifier,
              167


              differentiator,
              257


              digital-to-analog circuits,
              181
              ,
              182


              follower,
              159
              ,
              see also
              Buffer
            

              high-pass filter,
              561
              ,
              642
              ,
              682
              ,
              684
              ,
              690


              integrator,
              256


              instrumentation systems,
              183


              inverting amplifier,
              161


              log-amp,
              P-36


              low-pass filter,
              553
              ,
              656
              ,
              658
              ,
              662
              ,
              669


              multimeter, application
              160


              noninverting amplifier,
              153


              Sallen-Key realization, LP
              637
              , HP
              642


              subtractor (one-stage),
              167


              subtractor (two-stage), example
              171


              summary of (figure),
              169
              ,
              258
              , Appendix
              G-5


              summing amplifier (inverting),
              164


              summing amplifier (non-inverting),
              166


              voltage follower,
              159




          Open circuit,
          18


          Open-circuit voltage (
          υ
OC
          ),
          99


          Open Loop gain (A) or (μ), footnote
          152


          Operational amplifier,
          see
          OP AMP
        

          Orthogonal signals,
          627


          Oscilloscope,
          217
          ,
          218
          ,
          223
          ,
          226
          ,
          230


          Oscilloscope probe,
          P-102


          Out of phase,
          345


          Output,
          88


          Overdamped response,
          317


          Overshoot,
          510






p
          (the power variable) (W),
          6


          Parallel connection:
          

              admittances,
              356
              ,
              445


              capacitors,
              266


              current sources,
              41


              definition,
              26


              impedances,
              356
              ,
              444
              ,
              804


              inductors,
              267


              resistors,
              36




          Parameter sweep,
          137
          ,
          Appendix D


          Parseval's theorem,
          809


          Partial descriptors:
          

              amplitude descriptors,
              235


              temporal descriptors,
              234




          Partial fraction expansion:
          

              of complex poles,
              419


              of improper rational functions,
              422


              of multiple poles,
              424


              of simple poles,
              417




          Passband,
          546
          ,
          657


          Passive sign convention,
          8


          Passive filter,
          636


          Pathological circuit,
          749


          Peak-to-peak value of a signal (
          V
pp
          ),
          235


          Peak value of a signal (
          V
p
          ),
          235


          Perfect coupling,
          710
          ,
          711


          Period (
          T
0
          ) (s),
          220


          Periodic waveform:
          

              definition,
              235
              ,
              604


              average value of,
              235


              Fourier series of,
              604


              rms value of,
              238
              ,
              626




          Permittivity (ε),
          242
          , footnote,
          242


          Permeability (μ),
          249
          , footnote,
          249


          Phase angle (ϕ)(", rad/s),
          221


          Phase current (A),
          755


          Phase function (θ(ω)),
          545


          Phase sequences, negative, positive,
          746


          Phase spectrum,
          613


          Phase voltage (V),
          746


          Phasor:
          

              definition,
              338


              diagram,
              338


              domain,
              350


              properties,
              338


              representation,
              338


              rotating,
              339


              and sinusoids,
              338


              using MATLAB,
              341
              ,
              Appendix D




          Phasor circuit analysis:
          

              basics,
              344
              ,
              350


              BPF,
              388


              connection constraints,
              344


              current division,
              356


              device constraints,
              344


              energy and power,
              394


              filters,
              365
              ,
              372
              ,
              388


              frequency
              vs.
              impedance,
              346
              ,
              349


              general circuit analysis,
              379


              impedance concept,
              346


              in, or out of phase, lead, lag,
              345
              ,
              346


              LP,
              365
              ,
              372


              and network functions,
              518


              parallel equivalence,
              356


              phasor domain,
              350


              proportionality,
              366


              series equivalence,
              51


              source transformation,
              373


              superposition,
              367


              Thévenin and Norton equivalents,
              372


              using MATLAB,
              370
              ,
              389
              ,
              Appendix D


              using Multisim,
              351
              ,
              360
              ,
              Appendix D


              voltage division,
              351


              Photoresistor:
              

                  example,
                  191


                  photo,
                  190




              Piecewise continuous (Laplace),
              403


              Piezoelectric transducer,
              189
              ,
              P-58
              ,
              601


              Planar circuit,
              25
              ,
              81
              ,
              380
              ,
              476


              Planck's constant
              h
              (eV-s),
              544


              Polarity detector,
              200


              Pole:
              

                  basics,
                  414


                  circuit determinant,
                  483


                  complex,
                  419
                  ,
                  482


                  double real,
                  482


                  forced,
                  449
                  ,
                  460


                  form of filter response,
                  677


                  multiple,
                  424


                  natural,
                  470
                  ,
                  483


                  number of,
                  485


                  simple,
                  417
                  ,
                  482


                  stable,
                  483




              Pole-zero diagram:
              

                  basics,
                  414


                  and circuit response,
                  483


                  finding transforms from,
                  427


                  left half plane,
                  483


                  scale factor (
                  K
                  ),
                  414
                  ,
                  428


                  of second-order filter types,
                  677


                  software applications,
                  Appendix D




              Port,
              112
              ,
              491
              ,
              768


              Potentiometer,
              45
              , photos,
              45
              ,
              46
              , use as a transducer,
              193


              Power:
              

                  apparent (|S|) (VA),
                  733


                  average (
                  P
                  ) (W),
                  395
                  ,
                  626
                  ,
                  730


                  in a capacitor,
                  244



                  complex (
                  S
                  ) (VA),
                  733
                  , Multisim
                  736


                  definition,
                  6


                  flow, single phase,
                  740


                  gain,
                  129


                  in an inductor,
                  251


                  instantaneous (p(t)),
                  394
                  ,
                  731


                  maximum,
                  110
                  ,
                  396


                  phasors,
                  394


                  ratio (
                  PR
dB
                  ),
                  4
                  ,
                  P-2
                  ,
                  548


                  reactive (
                  Q
                  ) (VAR),
                  731


                  in a resistor,
                  17


                  three-phase,745,
                  746
                  ,748
                

                  transmission efficiency (n),
                  P-82


                  two-wire single phase,
                  740




              Power factor (pf):
              

                  angle (θ),
                  733


                  basics,
                  733


                  correction,
                  743


                  leading, lagging,
                  733




              Power triangle,
              733


              Practical sources
              

                  current,
                  21


                  voltage,
                  21




              Primary winding,
              711
              ,
              719


              Proper rational function,
              417


              Proportionality property:
              

                  dc circuits,
                  y
                  =
                  Kx
                  ,
                  89


                  phasor domain,
                  366


s
                  domain,
                  457




              Prototype,
              525
              , and magnitude scaling,
              531


              Psychomotor domain,
              C-3


              Pulse signal,
              see
              Step,
              490








q
          (
          t
          ), unit of charge,
          5


q
E
          (
          t
          ), electron charge = -1.6×10
          -19
          C,
          5


          Quality factor (
          Q
          ),
          575
          ,
          582
          ,
          637
          ,
          648


          Quantities, table of,
          4
          ,
          see also
          Appendix
          G-4


          Quiescent or Q-point,
          108






r
          , transresistance (Ω),
          126


R
          , resistance (Ω),
          16
          ,
          351


R
          (resistor) (Ω),
          16
          , photos,
          16
          ,
          17


          Radians per second (rad/s) (Unit),
          222


          Ragazzini, John R.,
          149


          Radio frequencies,
          544


          Ramp function (
          r
          (t)),
          212


          Range of practical components,
          531
          ,
          see also
Appendix G


          Rational function,
          417


          Reactance (
          X
          ) (Ω):
          

              definition,
              351


              negative,
              351


              positive,
              351




          Reactive power (Q) (VAR),
          730


          Reciprocal network,
          770


          Reciprocal spreading,
          596
          ,
          801


          Reciprocity theorems,
          767


          Reference marks,
          9
          ,
          see
          Discussion
          33


          Relationships between
          s
          and
          t
          domains,
          507
          ,
          520


          Residue,
          417


              sums of,
              421




          Resistance (
          R
          )(Ω)
          

              basics,
              6


              lookback (
              R
T
              ),
              105


              real part of impedance,
              351
              ,
              446




          Resistor (
          R
          )(Ω):
          

              average power,
              395


              circuit symbol,
              16


i-υ
              relationships,
              16


              impedance (
              Z
R
              ),
              351
              ,
              445
              ,
              804


              linear,
              16


              parallel connection,
              36


              photos,
              16
              ,
              17


              power,
              17


              series connection,
              36


              standard values,
              532
              ,
              see also
Appendix G




          Resolution (DAC),
          181


          Resonance (
          f
0
          , ω
          0
          ) (Hz, rad/s),
          346
          ,
          362
          ,
          583


          Resonant frequency (f
          0
          , co
          0
          ),
          347
          ,
          362
          ,
          575
          ,
          583


          Response:
          see also
          Transient and frequency responses
          

              ac steady state,
              305


              dc steady state,
              305
              ,
              506


              critically damped,
              317


              forced,
              284
              ,
              483


              frequency,
              510


              impulse,
              503


              narrow band,
              575


              natural,
              284
              ,
              483


              overdamped,
              317


              sinusoidal steady state,
              305
              ,
              510


              step,
              284
              ,
              325
              ,
              506


              underdamped,
              317


              wide band,
              575


              zero frequency (dc),
              305


              zero input,
              274
              ,
              291
              ,
              459


              zero state,
              291
              ,
              459




          Reversal property,
          798


          Ringing,
          P-70
          ,
          598
          ,
          679
          ,
          681


          Rise time (T
          R
          (s)),
          510


RC
          and
          RL
          circuits:
          

              basics,
              272


              characteristic equations,
              RC
275
              ,
              RL
275


              forced response,
              284


              frequency response, LP
              549
              , HP
              559


              homogeneous equations,
              274


              initial and final conditions,
              293


              natural response,
              284


              step response,
              284


              zero-input response,
              274
              ,
              291


              zero-state response,
              291




RLC
          circuits:
          

              bandpass,
              574


              bandstop,
              579


              basics,
              309
              ,
              313
              ,
              574


              characteristic equation, series
              311
              , parallel
              320


              design,
              318
              ,
              334
              ,
              335
              ,
              578
              ,
              580


              frequency response,
              574
              ,
              579


              parallel,
              320
              ,
              581


              series,
              309
              ,
              574


              zero-input response, series
              311




          Root-mean-square (V
          rms
          ) value,
          237
          ,
          626


          Rotating phasor,
          339






s
          -plane geometry relationships,
          473


          Sallen-Key,
          499
          , footnote
          636
          , table
          646
          , LP
          639
          , HP
          643


          Sample-and-hold circuit,
          248
          ,
          P-69


          Sampling:
          

              ADC,
              248


              aliasing,
              633


              anti-aliasing,
              633


              Nyquist rate, footnote
              632


              strictly band-limited,
              632


              theorem,
              632




          Satellite communications,
          P-140


          Saturation:
          

              BJT,
              147


              OP AMP,
              151




          Scale factor
          K
          (pole-zero),
          414


          Scaling property,
          801


          Schematic capture,
          57


          Secondary winding,
          711
          ,
          719


          Self-inductance,
          249
          ,
          702


          Second-order circuit:
          

              bandpass,
              574
              , prototype,
              646


              bandstop,
              579
              , prototype,
              649


              differential equation,
              309
              ,
              320
              ,
              326


              high-pass prototype,
              642


              integrodifferential equation,
              310


              low-pass prototype,
              637


              network function design,
              533


              parallel RLC,
              320
              ,
              581


              Sallen-Key,
              499
              , footnote
              636


              series
              RLC,
309
              ,
              574


              step response,
              325


              zero-input response,
              313
              ,
              322




          Self-inductance (L) (H),
          249
          ,
          702


          Sensor,
          see
          Transducer
        

          Series connection:
          

              basics,
              26


              capacitors,
              267


              impedances,
              346
              ,
              445
              ,
              804


              inductors,
              267


              resistors,
              35


              table of equivalent circuits,
              42


              voltage sources,
              39




          Shannon, Claude, footnote
          632


          Shockley, William,
          125


          Short circuit,
          18


          Short-circuit current (
          i
SC
          ),
          99


          SI units (International System of Units),
          5


          Siemens (S) (unit),
          4
          ,
          16


          Signals:
          

              ac,
              208
              ,
              236


              amplification,
              126


              bandwidth,
              631


              composite,
              227


              dc,
              208
              ,
              236


              damped ramp,
              229


              damped sinusoid,
              230


              definition,
              2


              double exponential,
              233


              double-sided exponential,
              229
              ,
              799


              exponential,
              214


              exponential rise,
              228


              introduction,
              2
              ,
              208


              inversion,
              129


              impulse,
              211


              orthogonal,
              627


              ramp,
              212


              signum (sgn(
              t
              )),
              227
              ,
              799


              sinc x ((sin x)/x),
              793
              , footnote,
              789


              sinusoidal,
              220


              singularity functions,
              212


              step function,
              209


              waveforms (Laplace),
              402
              ,
              Table G-6




          Signum function (sgn(
          t
          )),
          227
          ,
          799


          Single-line representation of power systems,
          763


          Simple pole(s),
          417


          Simulation software,
          11
          ,
          57
          ,
          see also
          Computer tools,
          Appendix D


          Single-phase circuit analysis,
          735



          Single-phase power flow,
          740


          Singularity functions,
          212


          Sinusoidal steady-state response:
          

              average power,
              237
              ,
              395


              basics,
              305


              from network functions,
              510
              , diagram
              512


              relationship with phasors,
              338
              ,
              518


              using phasors,
              338




          Sinusoidal waveform:
          

              basics,
              220


              damped,
              230


              Fourier transform of,
              802


              Laplace transform of, (sin)
              407
              , (cos)
              410
              ,
              Table G-6


              phasor representation,
              338


              properties of,
              224
              ,
              338




          Slope property,
          217


          Software tools, Introduction
          2
          ,
          11
          ,
          57
          ,
          Appendix D


          Solutions to Exercises,
          Appendix E


          Solving linear algebraic equations:
          

              Cramer's rule,
              70
              ,
              469


              review basics,
              Appendix A


              using MATLAB,
              70
              ,
              469




          Source:
          

              current (ideal),
              20


              dependent,
              126


              equivalent,
              39


              practical (
              i
              and
              u
              ),
              21


              three-phase,
              746


              voltage (ideal),
              20




          Source transformation:
          

              dc,
              39


              phasor domain,
              372


s
              domain,
              464




          Spectrum:
          

              electromagnetic,
              544


              Fourier,
              605


              spectral allocation,
              631




          SPICE,
          57
          ,
          107


          Stability:
          

              asymptotic,
              504


              inherently stable,
              485


              marginally stable,
              483
              ,
              see also
              Footnote,
              483


              marginally unstable, footnote,
              483


              and pole loci,
              484
              ,
              485




          Standard decimal prefixes,
          4
          ,
          see also
table 1-2
          ,
          5
          ,
          G-4


          Standard form (second-order eq.),
          326


          Standard values and references:
          Appendix G


              basic OP AMP modules,
              G-5


              Butterworth and Chebyshev polynomials,
              G-6


              capacitor standard values,
              G-2


              electric quantities,
              G-4


              fundamental relationships,
              G-4


              inductor standard values,
              G-3


              Laplace properties and pairs,
              G-6


              multipole-filter responses,
              G-7


              parasitic issues,
              G-3


              resistor color code,
              G-1


              resistor values,
              G-1


              tolerance, footnote
              44




          Sallen-Key filter realizations,
          636
          ,
          G-6


          Stanley, William,
          701


          State variable,
          244
          ,
          251
          ,
          273


          Steady-state response,
          305
          ,
          489
          ,
          510


          Steinmetz, Charles,
          337


          Step function (
          u
          (
          t
          )),
          209


          Step response (
          g
          (
          t
          )):
          

              definition,
              506


              descriptors (
              T
R
              ,
              T
D
              , Overshoot),
              510


              diagram
              507




          Step-response transform (
          G
          (
          s
          )):
          

              diagram,
              507


              first-order circuit,
              508


              and frequency response,
              596
              ,
              677


              from impulse response,
              507


              from network function,
              507


              second-order circuit,
              507


              using MATLAB, in various sections,
              Appendix D


              using Multisim, in various sections,
              Appendix D




          Step-down transformer,
          712


          Step-up transformer,
          712


          Stopband,
          546
          ,
          657


          Strain gauge:
          

              interfacing,
              194


              photo,
              190




          Strictly band-limited,
          632


          Subtractor,
          see
          Differential amplifier
        

          Summary:
          

              purpose,
              3

end of every chapter



          Summing amplifier or summer:
          

              inverting,
              164


              noninverting, application
              166




          Summing point,
          164
          ,
          166


          Super Capacitor,
          P-59
          ,
          P-69
          , footnote,
          532


          Supermesh,
          86
          ,
          141


          Supernode,
          74
          ,
          468


          Superposition principle:
          

              dc,
              89
              ,
              94
              , example
              95


              in Fourier series analysis,
              620


              phasor domain,
              367


s
              domain,
              458


              using Multisim,
              96




          Susceptance (B) (unit) (S),
          356


          Switch:
          

              analog,
              19


              DPDT,
              19


i-υ
              characteristics,
              18
              ,
              19


              ideal,
              18


              models,
              17


              photos of,
              19


              SPDT,
              19


              SPST,
              18




          Symbols and Units,
          4
          ,
          see also
Table 1-1
          ,
          4
          ,
          G-4






t
          -parameters [
          t
          ],
          777


T
          (
          s
          ) (transfer function),
          see also
          Transfer function
        

          T-circuit,
          370


          Tank circuit,
          583
          ,
          P-60
          ,
          P-123


          Temporal descriptors:
          

              causality,
              235


              periodicity,
              234




          Thermocouple types, curves,
          P-40


          Thermistor,
          P-5
          ,
          190
          , photo
          191
          , footnote,
          191


          Tesla, Nikola,
          729


          Test signals,
          490


          Thévenin, Leon Charles,
          63


          Thévenin equivalent circuit:
          

              applications of,
              99
              ,
              100


              application to non-linear loads,
              106


              basics, dc
              98
              , phasor
              372


              with dependent sources,
              144


              Laplace,
              464


              description,
              98


              derivation of theorem,
              104


              measuring with multimeter,
              99


              with nonlinear loads,
              106


              phasor domain,
              372


              relationship to Norton,
              98


s
              domain,
              464


              of a transformer,
              P-144




          Thévenin resistance (
          R
T
          =
          R
N
          ),
          99


          Thomson, J.J.,
          7


          Three-phase power analysis:
          

              balanced connections,
              747
              ,
              748


              basics,
              745


              instantaneous power,
              762


              power flow,
              758
              ,
              763


              single-line diagram,
              763


              using Multisim,
              751
              ,
              754
              ,
              Appendix D


              Y-Δ analysis,
              755


              Y-Δ connection,
              748


              Y-Δ conversions,
              749


              Y-Y analysis,
              750




          Through variable (current),
          9


          Thermistor,
          190
          , photo,
          191
          , footnote
          191


          Thermocouple,
          187
          , curves
          P-40


          Time constant (
          T
C
          ) (s):
          

              definition,
              214


RC
              circuit,
              275


RL
              circuit,
              276




          Time shift (
          T
S
          ) (s):
          

              effect on exponential,
              217


              effect on impulse,
              211


              effect on ramp,
              212


              effect on sinusoid,
              220


              effect on step function,
              210




          Traffic lights
          1
          -14,
          P-2


          Transconductance (
          g
          ) (S),
          126


          Transducers:
          

              accelerometer,
              P-40
              active,
              185
              , photos
              186
              ,
              187
              ,
              189


              design with,
              183
              -198
            

              input transducer,
              184


              interface circuit,
              184


              output transducer,
              184


              passive,
              190
              photos
              190
              ,
              191


              photodiode, footnote
              185
              , photo
              186


              photoresistor,
              191
              , photo
              190
              , footnote
              190
              , example
              191


              piezoelectric,
              P-58


              pressure, exercise
              189
              ,
              P-40
              ,
              601


              strain gauge,
              194
              ,
              P-43
              , photo
              190
              , example
              194


              thermistors,
              190
              , photo
              191
              , footnote,
              191


              thermocouples,
              187
              , photos
              187
              , example
              187
              ,
              P-14
              ,
              P-39
              ,
              P-41
              , curves
              P-40




          Transfer characteristics:
          

              BJT,
              149


              OP AMP,
              151




          Transfer function (T(s)):
          

              admittance (
              T
Y
              (s)),
              491


              current (T
              T
              (s)),
              491


              definition,
              491


              determining,
              492


              Fourier domain,
              806


              impedance (T
              Z
              (s)),
              491


              with OP AMPs,
              493


              voltage (
              T
V
              (s)),
              491





          Transform pair:
          

              Fourier,
              796
              ,
              see
Table 18-1
              ,
              802


              Laplace,
              403
              ,
              411
              ,
              see also
              Table
              Appendix G




          Transformed circuits (ℒ),
          442


          Transformers:
          

              autotransformer,
              718
              ,
              722


              basics,
              702


              dot convention,
              704


              equivalent T-circuit,
              P-144


              ideal,
              711


              impedance matching,
              718


              isolation transformer,
              724


i-υ
              characteristics,
              702


              linear,
              719


              maximum power transfer,
              718


              perfect coupling,
              714


              phasor model,
              714
              ,
              719


              photos,
              711
              ,
              712
              ,
              724
              ,
              725


              solution using Multisim
              715
              ,
              716
              ,
              721
              ,
              Appendix D


              step down,
              712


              step up,
              712


              turns ratio,
              712


              windings,
              711


              zero power loss,
              714




          Transient response:
          

              first-order (classical),
              RC
284
              ,
              RL
285


              second-order (classical), series
              309
              , parallel,
              320


              using Laplace,
              447
              ,
              448
              ,
              450
              ,
              505
              ,
              507


              using MATLAB,
              Appendix D


              using Multisim,
              Appendix D




          Transition band,
          658


          Transition time,
          209


          Transistor (BJT):
          

              basics,
              146


              bypass capacitor,
              P-102


              driver,
              P-33


              modes (active, saturated, cutoff),
              147


              models,
              147


              photos,
              146
              ,
              147


              threshold voltage (V
              Y
              ),
              146


              transfer characteristics,
              149




          Transistor (FET),
          142


          Translation property (t and co shifts):
          

              Fourier transform,
              801


              Laplace transform,
              410




          Transmission matrix [
          t
          ],
          777


          Transmission
          t
          -parameters,
          777


          Transresistance (
          r
          ) (Ω),
          126


          Through variable (current),
          9


          Tuned filter,
          575
          ,
          621
          ,
          648
          ,
          652


          Turning off sources,
          94


          Turns ratio
          n
          ,
          712


          Two-port network,
          112
          ,
          491
          ,
          768


              admittance or
              y
              -parameters,
              772


              conversion table,
              780


              current gain,
              782
              , table
              783


              definition,
              768


              hybrid or
              h
              -parameters,
              774


              impedance or
              z
              -parameters,
              769


              Multisim
              770


              network,
              768


              no parameters,
              P-153


              transfer function,
              491


              transmission,
              t
              -parameters or ABCD,
              777


              two-port connections or conversions,
              780


              voltage gain,
              782
              , table
              783




          Two-way splitter,
          P-29






          Undamped natural frequency (ω
          0
          ) (rad/s),
          326
          ,
          472
          ,
          483
          ,
          637


          Under-damped response,
          317
          ,
          330
          ,
          331


          Unilateral two-port network,
          P-153


          Unipolar power,
          731


          Uniqueness property:
          

              Fourier transform,
              792


              Laplace transform,
              405




          Unit impulse (5(t)),
          211
          , footnote
          211


          Unit ramp,
          see
          Ramp function
        

          Unit output method:
          

              dc,
              91


              phasors,
              366




          Units, table of,
          4
          ,
          G-4


          Unity gain filter method, LP
          639
          , HP
          643


          Unstable circuit,
          483






υ
          (the voltage variable) (V),
          6


          Van Valkenburg,
          487
          , footnote,
          656


          Virtual keyboard,
          P-131


          Volt (V) (unit),
          6


          Volta, Alessandro, footnote
          6


          Volt-Amperes (VA) (unit),
          732


          Volt-Amperes Reactive (VAR) (unit),
          732


          Voltage (
          υ
          ):
          

              ac measurement,
              P-82


              average value (
              V
avg
              ),
              235
              ,
              a
0
              ,
              604


              definition,
              6


              lag, lead,
              345
              ,
              346


              line,
              746


              maximum value (
              V
MAX
              ),
              235


              minimum value (
              V
MIN
              ),
              235


              node,
              64


              open circuit,
              199


              peak-to-peak value (
              V
pp
              ),
              235


              peak value (
              V
p
              ),
              235


              phase,
              746


              root-mean-square value (
              V
rms
              ),
              237


              root-mean-square value of periodic functions,
              626


              Thévenin (
              V
T
              ),
              199




          Voltage division:
          

              basic,
              43


              dc,
              43


              first-order,
              526


              Laplace,
              451


              with OP AMPs
              527


              phasor,
              351


              rule,
              43




          Voltage follower,
          159


          Voltage gain (μ),
          126
          ,
          T
V
          ,
          491
          , two-port
          T
V
          ,
          783


          Voltage source:
          

              ac source symbol,
              20


              battery symbol,
              20


              dependent,
              126
              ,
              444


              Fourier representation of,
              803


i-υ
              characteristics,
              20


              Laplace representation of,
              451


              phasor representation,
              338


              practical,
              21


              three-phase,
              746




          Voltmeter design,
          P-15






          Wagner, K.W.,
          635


          Watt (W) (unit),
          6


          Watt, James, footnote
          6


          Waveforms:
          

              basics,
              208


              amplitude descriptors,
              235


              aperiodic,
              235


              causal,
              235


              damped ramp,
              229


              damped sinusoid,
              230


              dc signals,
              208
              ,
              792


              definition,
              208


              double exponential,
              233


              double-sided exponential,
              229
              ,
              799


              exponentials (
              e

                -
                t
                /
                TC

              ),
              214
              exponential rise (1 -
              e

                -
                t
                /
                TC

              ),
              228


              generation using MATLAB,
              Appendix D


              generation using Multisim,
              Appendix D


              impulse (δ(
              t
              )),
              210


              instantaneous value,
              234


              MATLAB "heaviside(t) ",
              209


              partial descriptors,
              234


              periodic,
              234


              ramp (
              r
              (
              t
              )),
              212


              signum function (sgn(
              t
              )),
              227
              ,
              799


              sinc ((sin
              x)/x
              ),
              793


              singularity functions,
              212


              sinusoids (cos ω
              t
              + φ),
              220


              step (
              u
              (
              t
              )),
              209
              ,
              506


              temporal descriptors,
              234


              waveform-transform relationship,
              403




          Waveform symmetries:
          

              even
              615


              half-wave
              615


              hidden
              616


              odd
              615




          Wavelength λ (m)
          544


          Weber, Wilhelm,
          249


          Weber (Wb) (unit),
          249
          ,
          702


          Weber-turns (Wb-t) (unit),
          249
          ,
          702


          Westinghouse, George,
          701
          ,
          729


          Wheatstone bridge,
          191


          Wide band filter,
          575


          Window panes,
          25


          Window function,
          210


          Wireless energy transmission,
          708






X
          (reactance) (Ω),
          351


          X-rays,
          544






Y
          (admittance) (S):
          

              Laplace,
              446


              phasors,
              351




          Y-connection,
          748


          Y-Δ circuit analysis,
          755
          , Multisim
          756


          Y-Y circuit analysis,
          750
          , Multisim
          751


y
          -parameters,
          772






Z
          (impedance) (Ω):
          

              Fourier
              Z
              (ω),
              804


              Laplace
              Z
              (
              s
              ),
              445


              phasors
              Z,
346




z
          -parameters,
          769


          Zero,
          414


          Zero crossing detector,
          200


          Zero-input response,
          274
          ,
          311
          ,
          313
          ,
          459


          Zero-frequency response,
          305


          Zero power loss,
          711


          Zero-state response,
          291
          ,
          458


          Zeta (ζ) damping ratio,
          326
          ,
          472
          ,
          483
          ,
          485
          ,
          575
          ,
          637
          ,
          643














WILEY END USER LICENSE AGREEMENT




          Go to
          www.wiley.com/go/eula
          to access Wiley's ebook EULA.
        





